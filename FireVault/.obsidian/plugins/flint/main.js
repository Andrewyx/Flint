/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name5 in all)
    __defProp(target, name5, { get: all[name5], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __accessCheck = (obj, member, msg) => {
  if (!member.has(obj))
    throw TypeError("Cannot " + msg);
};
var __privateAdd = (obj, member, value) => {
  if (member.has(obj))
    throw TypeError("Cannot add the same private member more than once");
  member instanceof WeakSet ? member.add(obj) : member.set(obj, value);
};
var __privateMethod = (obj, member, method) => {
  __accessCheck(obj, member, "access private method");
  return method;
};

// main.ts
var main_exports = {};
__export(main_exports, {
  CloudVaultSelectModal: () => CloudVaultSelectModal,
  currentVaultName: () => currentVaultName,
  default: () => FlintPlugin,
  remoteVaultName: () => remoteVaultName
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// node_modules/@firebase/util/dist/index.esm2017.js
var stringToByteArray$1 = function(str) {
  const out = [];
  let p = 0;
  for (let i = 0; i < str.length; i++) {
    let c = str.charCodeAt(i);
    if (c < 128) {
      out[p++] = c;
    } else if (c < 2048) {
      out[p++] = c >> 6 | 192;
      out[p++] = c & 63 | 128;
    } else if ((c & 64512) === 55296 && i + 1 < str.length && (str.charCodeAt(i + 1) & 64512) === 56320) {
      c = 65536 + ((c & 1023) << 10) + (str.charCodeAt(++i) & 1023);
      out[p++] = c >> 18 | 240;
      out[p++] = c >> 12 & 63 | 128;
      out[p++] = c >> 6 & 63 | 128;
      out[p++] = c & 63 | 128;
    } else {
      out[p++] = c >> 12 | 224;
      out[p++] = c >> 6 & 63 | 128;
      out[p++] = c & 63 | 128;
    }
  }
  return out;
};
var byteArrayToString = function(bytes) {
  const out = [];
  let pos = 0, c = 0;
  while (pos < bytes.length) {
    const c1 = bytes[pos++];
    if (c1 < 128) {
      out[c++] = String.fromCharCode(c1);
    } else if (c1 > 191 && c1 < 224) {
      const c2 = bytes[pos++];
      out[c++] = String.fromCharCode((c1 & 31) << 6 | c2 & 63);
    } else if (c1 > 239 && c1 < 365) {
      const c2 = bytes[pos++];
      const c3 = bytes[pos++];
      const c4 = bytes[pos++];
      const u = ((c1 & 7) << 18 | (c2 & 63) << 12 | (c3 & 63) << 6 | c4 & 63) - 65536;
      out[c++] = String.fromCharCode(55296 + (u >> 10));
      out[c++] = String.fromCharCode(56320 + (u & 1023));
    } else {
      const c2 = bytes[pos++];
      const c3 = bytes[pos++];
      out[c++] = String.fromCharCode((c1 & 15) << 12 | (c2 & 63) << 6 | c3 & 63);
    }
  }
  return out.join("");
};
var base64 = {
  /**
   * Maps bytes to characters.
   */
  byteToCharMap_: null,
  /**
   * Maps characters to bytes.
   */
  charToByteMap_: null,
  /**
   * Maps bytes to websafe characters.
   * @private
   */
  byteToCharMapWebSafe_: null,
  /**
   * Maps websafe characters to bytes.
   * @private
   */
  charToByteMapWebSafe_: null,
  /**
   * Our default alphabet, shared between
   * ENCODED_VALS and ENCODED_VALS_WEBSAFE
   */
  ENCODED_VALS_BASE: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
  /**
   * Our default alphabet. Value 64 (=) is special; it means "nothing."
   */
  get ENCODED_VALS() {
    return this.ENCODED_VALS_BASE + "+/=";
  },
  /**
   * Our websafe alphabet.
   */
  get ENCODED_VALS_WEBSAFE() {
    return this.ENCODED_VALS_BASE + "-_.";
  },
  /**
   * Whether this browser supports the atob and btoa functions. This extension
   * started at Mozilla but is now implemented by many browsers. We use the
   * ASSUME_* variables to avoid pulling in the full useragent detection library
   * but still allowing the standard per-browser compilations.
   *
   */
  HAS_NATIVE_SUPPORT: typeof atob === "function",
  /**
   * Base64-encode an array of bytes.
   *
   * @param input An array of bytes (numbers with
   *     value in [0, 255]) to encode.
   * @param webSafe Boolean indicating we should use the
   *     alternative alphabet.
   * @return The base64 encoded string.
   */
  encodeByteArray(input, webSafe) {
    if (!Array.isArray(input)) {
      throw Error("encodeByteArray takes an array as a parameter");
    }
    this.init_();
    const byteToCharMap = webSafe ? this.byteToCharMapWebSafe_ : this.byteToCharMap_;
    const output = [];
    for (let i = 0; i < input.length; i += 3) {
      const byte1 = input[i];
      const haveByte2 = i + 1 < input.length;
      const byte2 = haveByte2 ? input[i + 1] : 0;
      const haveByte3 = i + 2 < input.length;
      const byte3 = haveByte3 ? input[i + 2] : 0;
      const outByte1 = byte1 >> 2;
      const outByte2 = (byte1 & 3) << 4 | byte2 >> 4;
      let outByte3 = (byte2 & 15) << 2 | byte3 >> 6;
      let outByte4 = byte3 & 63;
      if (!haveByte3) {
        outByte4 = 64;
        if (!haveByte2) {
          outByte3 = 64;
        }
      }
      output.push(byteToCharMap[outByte1], byteToCharMap[outByte2], byteToCharMap[outByte3], byteToCharMap[outByte4]);
    }
    return output.join("");
  },
  /**
   * Base64-encode a string.
   *
   * @param input A string to encode.
   * @param webSafe If true, we should use the
   *     alternative alphabet.
   * @return The base64 encoded string.
   */
  encodeString(input, webSafe) {
    if (this.HAS_NATIVE_SUPPORT && !webSafe) {
      return btoa(input);
    }
    return this.encodeByteArray(stringToByteArray$1(input), webSafe);
  },
  /**
   * Base64-decode a string.
   *
   * @param input to decode.
   * @param webSafe True if we should use the
   *     alternative alphabet.
   * @return string representing the decoded value.
   */
  decodeString(input, webSafe) {
    if (this.HAS_NATIVE_SUPPORT && !webSafe) {
      return atob(input);
    }
    return byteArrayToString(this.decodeStringToByteArray(input, webSafe));
  },
  /**
   * Base64-decode a string.
   *
   * In base-64 decoding, groups of four characters are converted into three
   * bytes.  If the encoder did not apply padding, the input length may not
   * be a multiple of 4.
   *
   * In this case, the last group will have fewer than 4 characters, and
   * padding will be inferred.  If the group has one or two characters, it decodes
   * to one byte.  If the group has three characters, it decodes to two bytes.
   *
   * @param input Input to decode.
   * @param webSafe True if we should use the web-safe alphabet.
   * @return bytes representing the decoded value.
   */
  decodeStringToByteArray(input, webSafe) {
    this.init_();
    const charToByteMap = webSafe ? this.charToByteMapWebSafe_ : this.charToByteMap_;
    const output = [];
    for (let i = 0; i < input.length; ) {
      const byte1 = charToByteMap[input.charAt(i++)];
      const haveByte2 = i < input.length;
      const byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;
      ++i;
      const haveByte3 = i < input.length;
      const byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;
      ++i;
      const haveByte4 = i < input.length;
      const byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;
      ++i;
      if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {
        throw new DecodeBase64StringError();
      }
      const outByte1 = byte1 << 2 | byte2 >> 4;
      output.push(outByte1);
      if (byte3 !== 64) {
        const outByte2 = byte2 << 4 & 240 | byte3 >> 2;
        output.push(outByte2);
        if (byte4 !== 64) {
          const outByte3 = byte3 << 6 & 192 | byte4;
          output.push(outByte3);
        }
      }
    }
    return output;
  },
  /**
   * Lazy static initialization function. Called before
   * accessing any of the static map variables.
   * @private
   */
  init_() {
    if (!this.byteToCharMap_) {
      this.byteToCharMap_ = {};
      this.charToByteMap_ = {};
      this.byteToCharMapWebSafe_ = {};
      this.charToByteMapWebSafe_ = {};
      for (let i = 0; i < this.ENCODED_VALS.length; i++) {
        this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);
        this.charToByteMap_[this.byteToCharMap_[i]] = i;
        this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);
        this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;
        if (i >= this.ENCODED_VALS_BASE.length) {
          this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;
          this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;
        }
      }
    }
  }
};
var DecodeBase64StringError = class extends Error {
  constructor() {
    super(...arguments);
    this.name = "DecodeBase64StringError";
  }
};
var base64Encode = function(str) {
  const utf8Bytes = stringToByteArray$1(str);
  return base64.encodeByteArray(utf8Bytes, true);
};
var base64urlEncodeWithoutPadding = function(str) {
  return base64Encode(str).replace(/\./g, "");
};
var base64Decode = function(str) {
  try {
    return base64.decodeString(str, true);
  } catch (e) {
    console.error("base64Decode failed: ", e);
  }
  return null;
};
function getGlobal() {
  if (typeof self !== "undefined") {
    return self;
  }
  if (typeof window !== "undefined") {
    return window;
  }
  if (typeof global !== "undefined") {
    return global;
  }
  throw new Error("Unable to locate global object.");
}
var getDefaultsFromGlobal = () => getGlobal().__FIREBASE_DEFAULTS__;
var getDefaultsFromEnvVariable = () => {
  if (typeof process === "undefined" || typeof process.env === "undefined") {
    return;
  }
  const defaultsJsonString = process.env.__FIREBASE_DEFAULTS__;
  if (defaultsJsonString) {
    return JSON.parse(defaultsJsonString);
  }
};
var getDefaultsFromCookie = () => {
  if (typeof document === "undefined") {
    return;
  }
  let match;
  try {
    match = document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/);
  } catch (e) {
    return;
  }
  const decoded = match && base64Decode(match[1]);
  return decoded && JSON.parse(decoded);
};
var getDefaults = () => {
  try {
    return getDefaultsFromGlobal() || getDefaultsFromEnvVariable() || getDefaultsFromCookie();
  } catch (e) {
    console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);
    return;
  }
};
var getDefaultEmulatorHost = (productName) => {
  var _a, _b;
  return (_b = (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a.emulatorHosts) === null || _b === void 0 ? void 0 : _b[productName];
};
var getDefaultEmulatorHostnameAndPort = (productName) => {
  const host = getDefaultEmulatorHost(productName);
  if (!host) {
    return void 0;
  }
  const separatorIndex = host.lastIndexOf(":");
  if (separatorIndex <= 0 || separatorIndex + 1 === host.length) {
    throw new Error(`Invalid host ${host} with no separate hostname and port!`);
  }
  const port = parseInt(host.substring(separatorIndex + 1), 10);
  if (host[0] === "[") {
    return [host.substring(1, separatorIndex - 1), port];
  } else {
    return [host.substring(0, separatorIndex), port];
  }
};
var getDefaultAppConfig = () => {
  var _a;
  return (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a.config;
};
var getExperimentalSetting = (name5) => {
  var _a;
  return (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a[`_${name5}`];
};
var Deferred = class {
  constructor() {
    this.reject = () => {
    };
    this.resolve = () => {
    };
    this.promise = new Promise((resolve, reject) => {
      this.resolve = resolve;
      this.reject = reject;
    });
  }
  /**
   * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around
   * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback
   * and returns a node-style callback which will resolve or reject the Deferred's promise.
   */
  wrapCallback(callback) {
    return (error, value) => {
      if (error) {
        this.reject(error);
      } else {
        this.resolve(value);
      }
      if (typeof callback === "function") {
        this.promise.catch(() => {
        });
        if (callback.length === 1) {
          callback(error);
        } else {
          callback(error, value);
        }
      }
    };
  }
};
function createMockUserToken(token, projectId) {
  if (token.uid) {
    throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');
  }
  const header = {
    alg: "none",
    type: "JWT"
  };
  const project = projectId || "demo-project";
  const iat = token.iat || 0;
  const sub = token.sub || token.user_id;
  if (!sub) {
    throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");
  }
  const payload = Object.assign({
    // Set all required fields to decent defaults
    iss: `https://securetoken.google.com/${project}`,
    aud: project,
    iat,
    exp: iat + 3600,
    auth_time: iat,
    sub,
    user_id: sub,
    firebase: {
      sign_in_provider: "custom",
      identities: {}
    }
  }, token);
  const signature = "";
  return [
    base64urlEncodeWithoutPadding(JSON.stringify(header)),
    base64urlEncodeWithoutPadding(JSON.stringify(payload)),
    signature
  ].join(".");
}
function getUA() {
  if (typeof navigator !== "undefined" && typeof navigator["userAgent"] === "string") {
    return navigator["userAgent"];
  } else {
    return "";
  }
}
function isMobileCordova() {
  return typeof window !== "undefined" && // @ts-ignore Setting up an broadly applicable index signature for Window
  // just to deal with this case would probably be a bad idea.
  !!(window["cordova"] || window["phonegap"] || window["PhoneGap"]) && /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA());
}
function isNode() {
  var _a;
  const forceEnvironment = (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a.forceEnvironment;
  if (forceEnvironment === "node") {
    return true;
  } else if (forceEnvironment === "browser") {
    return false;
  }
  try {
    return Object.prototype.toString.call(global.process) === "[object process]";
  } catch (e) {
    return false;
  }
}
function isBrowserExtension() {
  const runtime = typeof chrome === "object" ? chrome.runtime : typeof browser === "object" ? browser.runtime : void 0;
  return typeof runtime === "object" && runtime.id !== void 0;
}
function isReactNative() {
  return typeof navigator === "object" && navigator["product"] === "ReactNative";
}
function isIE() {
  const ua = getUA();
  return ua.indexOf("MSIE ") >= 0 || ua.indexOf("Trident/") >= 0;
}
function isIndexedDBAvailable() {
  try {
    return typeof indexedDB === "object";
  } catch (e) {
    return false;
  }
}
function validateIndexedDBOpenable() {
  return new Promise((resolve, reject) => {
    try {
      let preExist = true;
      const DB_CHECK_NAME = "validate-browser-context-for-indexeddb-analytics-module";
      const request = self.indexedDB.open(DB_CHECK_NAME);
      request.onsuccess = () => {
        request.result.close();
        if (!preExist) {
          self.indexedDB.deleteDatabase(DB_CHECK_NAME);
        }
        resolve(true);
      };
      request.onupgradeneeded = () => {
        preExist = false;
      };
      request.onerror = () => {
        var _a;
        reject(((_a = request.error) === null || _a === void 0 ? void 0 : _a.message) || "");
      };
    } catch (error) {
      reject(error);
    }
  });
}
var ERROR_NAME = "FirebaseError";
var FirebaseError = class extends Error {
  constructor(code, message, customData) {
    super(message);
    this.code = code;
    this.customData = customData;
    this.name = ERROR_NAME;
    Object.setPrototypeOf(this, FirebaseError.prototype);
    if (Error.captureStackTrace) {
      Error.captureStackTrace(this, ErrorFactory.prototype.create);
    }
  }
};
var ErrorFactory = class {
  constructor(service, serviceName, errors) {
    this.service = service;
    this.serviceName = serviceName;
    this.errors = errors;
  }
  create(code, ...data) {
    const customData = data[0] || {};
    const fullCode = `${this.service}/${code}`;
    const template = this.errors[code];
    const message = template ? replaceTemplate(template, customData) : "Error";
    const fullMessage = `${this.serviceName}: ${message} (${fullCode}).`;
    const error = new FirebaseError(fullCode, fullMessage, customData);
    return error;
  }
};
function replaceTemplate(template, data) {
  return template.replace(PATTERN, (_, key) => {
    const value = data[key];
    return value != null ? String(value) : `<${key}?>`;
  });
}
var PATTERN = /\{\$([^}]+)}/g;
function isEmpty(obj) {
  for (const key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      return false;
    }
  }
  return true;
}
function deepEqual(a, b) {
  if (a === b) {
    return true;
  }
  const aKeys = Object.keys(a);
  const bKeys = Object.keys(b);
  for (const k of aKeys) {
    if (!bKeys.includes(k)) {
      return false;
    }
    const aProp = a[k];
    const bProp = b[k];
    if (isObject(aProp) && isObject(bProp)) {
      if (!deepEqual(aProp, bProp)) {
        return false;
      }
    } else if (aProp !== bProp) {
      return false;
    }
  }
  for (const k of bKeys) {
    if (!aKeys.includes(k)) {
      return false;
    }
  }
  return true;
}
function isObject(thing) {
  return thing !== null && typeof thing === "object";
}
function querystring(querystringParams) {
  const params = [];
  for (const [key, value] of Object.entries(querystringParams)) {
    if (Array.isArray(value)) {
      value.forEach((arrayVal) => {
        params.push(encodeURIComponent(key) + "=" + encodeURIComponent(arrayVal));
      });
    } else {
      params.push(encodeURIComponent(key) + "=" + encodeURIComponent(value));
    }
  }
  return params.length ? "&" + params.join("&") : "";
}
function querystringDecode(querystring2) {
  const obj = {};
  const tokens = querystring2.replace(/^\?/, "").split("&");
  tokens.forEach((token) => {
    if (token) {
      const [key, value] = token.split("=");
      obj[decodeURIComponent(key)] = decodeURIComponent(value);
    }
  });
  return obj;
}
function extractQuerystring(url) {
  const queryStart = url.indexOf("?");
  if (!queryStart) {
    return "";
  }
  const fragmentStart = url.indexOf("#", queryStart);
  return url.substring(queryStart, fragmentStart > 0 ? fragmentStart : void 0);
}
function createSubscribe(executor, onNoObservers) {
  const proxy = new ObserverProxy(executor, onNoObservers);
  return proxy.subscribe.bind(proxy);
}
var ObserverProxy = class {
  /**
   * @param executor Function which can make calls to a single Observer
   *     as a proxy.
   * @param onNoObservers Callback when count of Observers goes to zero.
   */
  constructor(executor, onNoObservers) {
    this.observers = [];
    this.unsubscribes = [];
    this.observerCount = 0;
    this.task = Promise.resolve();
    this.finalized = false;
    this.onNoObservers = onNoObservers;
    this.task.then(() => {
      executor(this);
    }).catch((e) => {
      this.error(e);
    });
  }
  next(value) {
    this.forEachObserver((observer) => {
      observer.next(value);
    });
  }
  error(error) {
    this.forEachObserver((observer) => {
      observer.error(error);
    });
    this.close(error);
  }
  complete() {
    this.forEachObserver((observer) => {
      observer.complete();
    });
    this.close();
  }
  /**
   * Subscribe function that can be used to add an Observer to the fan-out list.
   *
   * - We require that no event is sent to a subscriber sychronously to their
   *   call to subscribe().
   */
  subscribe(nextOrObserver, error, complete) {
    let observer;
    if (nextOrObserver === void 0 && error === void 0 && complete === void 0) {
      throw new Error("Missing Observer.");
    }
    if (implementsAnyMethods(nextOrObserver, [
      "next",
      "error",
      "complete"
    ])) {
      observer = nextOrObserver;
    } else {
      observer = {
        next: nextOrObserver,
        error,
        complete
      };
    }
    if (observer.next === void 0) {
      observer.next = noop;
    }
    if (observer.error === void 0) {
      observer.error = noop;
    }
    if (observer.complete === void 0) {
      observer.complete = noop;
    }
    const unsub = this.unsubscribeOne.bind(this, this.observers.length);
    if (this.finalized) {
      this.task.then(() => {
        try {
          if (this.finalError) {
            observer.error(this.finalError);
          } else {
            observer.complete();
          }
        } catch (e) {
        }
        return;
      });
    }
    this.observers.push(observer);
    return unsub;
  }
  // Unsubscribe is synchronous - we guarantee that no events are sent to
  // any unsubscribed Observer.
  unsubscribeOne(i) {
    if (this.observers === void 0 || this.observers[i] === void 0) {
      return;
    }
    delete this.observers[i];
    this.observerCount -= 1;
    if (this.observerCount === 0 && this.onNoObservers !== void 0) {
      this.onNoObservers(this);
    }
  }
  forEachObserver(fn) {
    if (this.finalized) {
      return;
    }
    for (let i = 0; i < this.observers.length; i++) {
      this.sendOne(i, fn);
    }
  }
  // Call the Observer via one of it's callback function. We are careful to
  // confirm that the observe has not been unsubscribed since this asynchronous
  // function had been queued.
  sendOne(i, fn) {
    this.task.then(() => {
      if (this.observers !== void 0 && this.observers[i] !== void 0) {
        try {
          fn(this.observers[i]);
        } catch (e) {
          if (typeof console !== "undefined" && console.error) {
            console.error(e);
          }
        }
      }
    });
  }
  close(err) {
    if (this.finalized) {
      return;
    }
    this.finalized = true;
    if (err !== void 0) {
      this.finalError = err;
    }
    this.task.then(() => {
      this.observers = void 0;
      this.onNoObservers = void 0;
    });
  }
};
function implementsAnyMethods(obj, methods) {
  if (typeof obj !== "object" || obj === null) {
    return false;
  }
  for (const method of methods) {
    if (method in obj && typeof obj[method] === "function") {
      return true;
    }
  }
  return false;
}
function noop() {
}
var MAX_VALUE_MILLIS = 4 * 60 * 60 * 1e3;
function getModularInstance(service) {
  if (service && service._delegate) {
    return service._delegate;
  } else {
    return service;
  }
}

// node_modules/@firebase/component/dist/esm/index.esm2017.js
var Component = class {
  /**
   *
   * @param name The public service name, e.g. app, auth, firestore, database
   * @param instanceFactory Service factory responsible for creating the public interface
   * @param type whether the service provided by the component is public or private
   */
  constructor(name5, instanceFactory, type) {
    this.name = name5;
    this.instanceFactory = instanceFactory;
    this.type = type;
    this.multipleInstances = false;
    this.serviceProps = {};
    this.instantiationMode = "LAZY";
    this.onInstanceCreated = null;
  }
  setInstantiationMode(mode) {
    this.instantiationMode = mode;
    return this;
  }
  setMultipleInstances(multipleInstances) {
    this.multipleInstances = multipleInstances;
    return this;
  }
  setServiceProps(props) {
    this.serviceProps = props;
    return this;
  }
  setInstanceCreatedCallback(callback) {
    this.onInstanceCreated = callback;
    return this;
  }
};
var DEFAULT_ENTRY_NAME = "[DEFAULT]";
var Provider = class {
  constructor(name5, container) {
    this.name = name5;
    this.container = container;
    this.component = null;
    this.instances = /* @__PURE__ */ new Map();
    this.instancesDeferred = /* @__PURE__ */ new Map();
    this.instancesOptions = /* @__PURE__ */ new Map();
    this.onInitCallbacks = /* @__PURE__ */ new Map();
  }
  /**
   * @param identifier A provider can provide mulitple instances of a service
   * if this.component.multipleInstances is true.
   */
  get(identifier) {
    const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);
    if (!this.instancesDeferred.has(normalizedIdentifier)) {
      const deferred = new Deferred();
      this.instancesDeferred.set(normalizedIdentifier, deferred);
      if (this.isInitialized(normalizedIdentifier) || this.shouldAutoInitialize()) {
        try {
          const instance = this.getOrInitializeService({
            instanceIdentifier: normalizedIdentifier
          });
          if (instance) {
            deferred.resolve(instance);
          }
        } catch (e) {
        }
      }
    }
    return this.instancesDeferred.get(normalizedIdentifier).promise;
  }
  getImmediate(options) {
    var _a;
    const normalizedIdentifier = this.normalizeInstanceIdentifier(options === null || options === void 0 ? void 0 : options.identifier);
    const optional = (_a = options === null || options === void 0 ? void 0 : options.optional) !== null && _a !== void 0 ? _a : false;
    if (this.isInitialized(normalizedIdentifier) || this.shouldAutoInitialize()) {
      try {
        return this.getOrInitializeService({
          instanceIdentifier: normalizedIdentifier
        });
      } catch (e) {
        if (optional) {
          return null;
        } else {
          throw e;
        }
      }
    } else {
      if (optional) {
        return null;
      } else {
        throw Error(`Service ${this.name} is not available`);
      }
    }
  }
  getComponent() {
    return this.component;
  }
  setComponent(component) {
    if (component.name !== this.name) {
      throw Error(`Mismatching Component ${component.name} for Provider ${this.name}.`);
    }
    if (this.component) {
      throw Error(`Component for ${this.name} has already been provided`);
    }
    this.component = component;
    if (!this.shouldAutoInitialize()) {
      return;
    }
    if (isComponentEager(component)) {
      try {
        this.getOrInitializeService({ instanceIdentifier: DEFAULT_ENTRY_NAME });
      } catch (e) {
      }
    }
    for (const [instanceIdentifier, instanceDeferred] of this.instancesDeferred.entries()) {
      const normalizedIdentifier = this.normalizeInstanceIdentifier(instanceIdentifier);
      try {
        const instance = this.getOrInitializeService({
          instanceIdentifier: normalizedIdentifier
        });
        instanceDeferred.resolve(instance);
      } catch (e) {
      }
    }
  }
  clearInstance(identifier = DEFAULT_ENTRY_NAME) {
    this.instancesDeferred.delete(identifier);
    this.instancesOptions.delete(identifier);
    this.instances.delete(identifier);
  }
  // app.delete() will call this method on every provider to delete the services
  // TODO: should we mark the provider as deleted?
  async delete() {
    const services = Array.from(this.instances.values());
    await Promise.all([
      ...services.filter((service) => "INTERNAL" in service).map((service) => service.INTERNAL.delete()),
      ...services.filter((service) => "_delete" in service).map((service) => service._delete())
    ]);
  }
  isComponentSet() {
    return this.component != null;
  }
  isInitialized(identifier = DEFAULT_ENTRY_NAME) {
    return this.instances.has(identifier);
  }
  getOptions(identifier = DEFAULT_ENTRY_NAME) {
    return this.instancesOptions.get(identifier) || {};
  }
  initialize(opts = {}) {
    const { options = {} } = opts;
    const normalizedIdentifier = this.normalizeInstanceIdentifier(opts.instanceIdentifier);
    if (this.isInitialized(normalizedIdentifier)) {
      throw Error(`${this.name}(${normalizedIdentifier}) has already been initialized`);
    }
    if (!this.isComponentSet()) {
      throw Error(`Component ${this.name} has not been registered yet`);
    }
    const instance = this.getOrInitializeService({
      instanceIdentifier: normalizedIdentifier,
      options
    });
    for (const [instanceIdentifier, instanceDeferred] of this.instancesDeferred.entries()) {
      const normalizedDeferredIdentifier = this.normalizeInstanceIdentifier(instanceIdentifier);
      if (normalizedIdentifier === normalizedDeferredIdentifier) {
        instanceDeferred.resolve(instance);
      }
    }
    return instance;
  }
  /**
   *
   * @param callback - a function that will be invoked  after the provider has been initialized by calling provider.initialize().
   * The function is invoked SYNCHRONOUSLY, so it should not execute any longrunning tasks in order to not block the program.
   *
   * @param identifier An optional instance identifier
   * @returns a function to unregister the callback
   */
  onInit(callback, identifier) {
    var _a;
    const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);
    const existingCallbacks = (_a = this.onInitCallbacks.get(normalizedIdentifier)) !== null && _a !== void 0 ? _a : /* @__PURE__ */ new Set();
    existingCallbacks.add(callback);
    this.onInitCallbacks.set(normalizedIdentifier, existingCallbacks);
    const existingInstance = this.instances.get(normalizedIdentifier);
    if (existingInstance) {
      callback(existingInstance, normalizedIdentifier);
    }
    return () => {
      existingCallbacks.delete(callback);
    };
  }
  /**
   * Invoke onInit callbacks synchronously
   * @param instance the service instance`
   */
  invokeOnInitCallbacks(instance, identifier) {
    const callbacks = this.onInitCallbacks.get(identifier);
    if (!callbacks) {
      return;
    }
    for (const callback of callbacks) {
      try {
        callback(instance, identifier);
      } catch (_a) {
      }
    }
  }
  getOrInitializeService({ instanceIdentifier, options = {} }) {
    let instance = this.instances.get(instanceIdentifier);
    if (!instance && this.component) {
      instance = this.component.instanceFactory(this.container, {
        instanceIdentifier: normalizeIdentifierForFactory(instanceIdentifier),
        options
      });
      this.instances.set(instanceIdentifier, instance);
      this.instancesOptions.set(instanceIdentifier, options);
      this.invokeOnInitCallbacks(instance, instanceIdentifier);
      if (this.component.onInstanceCreated) {
        try {
          this.component.onInstanceCreated(this.container, instanceIdentifier, instance);
        } catch (_a) {
        }
      }
    }
    return instance || null;
  }
  normalizeInstanceIdentifier(identifier = DEFAULT_ENTRY_NAME) {
    if (this.component) {
      return this.component.multipleInstances ? identifier : DEFAULT_ENTRY_NAME;
    } else {
      return identifier;
    }
  }
  shouldAutoInitialize() {
    return !!this.component && this.component.instantiationMode !== "EXPLICIT";
  }
};
function normalizeIdentifierForFactory(identifier) {
  return identifier === DEFAULT_ENTRY_NAME ? void 0 : identifier;
}
function isComponentEager(component) {
  return component.instantiationMode === "EAGER";
}
var ComponentContainer = class {
  constructor(name5) {
    this.name = name5;
    this.providers = /* @__PURE__ */ new Map();
  }
  /**
   *
   * @param component Component being added
   * @param overwrite When a component with the same name has already been registered,
   * if overwrite is true: overwrite the existing component with the new component and create a new
   * provider with the new component. It can be useful in tests where you want to use different mocks
   * for different tests.
   * if overwrite is false: throw an exception
   */
  addComponent(component) {
    const provider2 = this.getProvider(component.name);
    if (provider2.isComponentSet()) {
      throw new Error(`Component ${component.name} has already been registered with ${this.name}`);
    }
    provider2.setComponent(component);
  }
  addOrOverwriteComponent(component) {
    const provider2 = this.getProvider(component.name);
    if (provider2.isComponentSet()) {
      this.providers.delete(component.name);
    }
    this.addComponent(component);
  }
  /**
   * getProvider provides a type safe interface where it can only be called with a field name
   * present in NameServiceMapping interface.
   *
   * Firebase SDKs providing services should extend NameServiceMapping interface to register
   * themselves.
   */
  getProvider(name5) {
    if (this.providers.has(name5)) {
      return this.providers.get(name5);
    }
    const provider2 = new Provider(name5, this);
    this.providers.set(name5, provider2);
    return provider2;
  }
  getProviders() {
    return Array.from(this.providers.values());
  }
};

// node_modules/@firebase/logger/dist/esm/index.esm2017.js
var instances = [];
var LogLevel;
(function(LogLevel2) {
  LogLevel2[LogLevel2["DEBUG"] = 0] = "DEBUG";
  LogLevel2[LogLevel2["VERBOSE"] = 1] = "VERBOSE";
  LogLevel2[LogLevel2["INFO"] = 2] = "INFO";
  LogLevel2[LogLevel2["WARN"] = 3] = "WARN";
  LogLevel2[LogLevel2["ERROR"] = 4] = "ERROR";
  LogLevel2[LogLevel2["SILENT"] = 5] = "SILENT";
})(LogLevel || (LogLevel = {}));
var levelStringToEnum = {
  "debug": LogLevel.DEBUG,
  "verbose": LogLevel.VERBOSE,
  "info": LogLevel.INFO,
  "warn": LogLevel.WARN,
  "error": LogLevel.ERROR,
  "silent": LogLevel.SILENT
};
var defaultLogLevel = LogLevel.INFO;
var ConsoleMethod = {
  [LogLevel.DEBUG]: "log",
  [LogLevel.VERBOSE]: "log",
  [LogLevel.INFO]: "info",
  [LogLevel.WARN]: "warn",
  [LogLevel.ERROR]: "error"
};
var defaultLogHandler = (instance, logType, ...args) => {
  if (logType < instance.logLevel) {
    return;
  }
  const now = new Date().toISOString();
  const method = ConsoleMethod[logType];
  if (method) {
    console[method](`[${now}]  ${instance.name}:`, ...args);
  } else {
    throw new Error(`Attempted to log a message with an invalid logType (value: ${logType})`);
  }
};
var Logger = class {
  /**
   * Gives you an instance of a Logger to capture messages according to
   * Firebase's logging scheme.
   *
   * @param name The name that the logs will be associated with
   */
  constructor(name5) {
    this.name = name5;
    this._logLevel = defaultLogLevel;
    this._logHandler = defaultLogHandler;
    this._userLogHandler = null;
    instances.push(this);
  }
  get logLevel() {
    return this._logLevel;
  }
  set logLevel(val) {
    if (!(val in LogLevel)) {
      throw new TypeError(`Invalid value "${val}" assigned to \`logLevel\``);
    }
    this._logLevel = val;
  }
  // Workaround for setter/getter having to be the same type.
  setLogLevel(val) {
    this._logLevel = typeof val === "string" ? levelStringToEnum[val] : val;
  }
  get logHandler() {
    return this._logHandler;
  }
  set logHandler(val) {
    if (typeof val !== "function") {
      throw new TypeError("Value assigned to `logHandler` must be a function");
    }
    this._logHandler = val;
  }
  get userLogHandler() {
    return this._userLogHandler;
  }
  set userLogHandler(val) {
    this._userLogHandler = val;
  }
  /**
   * The functions below are all based on the `console` interface
   */
  debug(...args) {
    this._userLogHandler && this._userLogHandler(this, LogLevel.DEBUG, ...args);
    this._logHandler(this, LogLevel.DEBUG, ...args);
  }
  log(...args) {
    this._userLogHandler && this._userLogHandler(this, LogLevel.VERBOSE, ...args);
    this._logHandler(this, LogLevel.VERBOSE, ...args);
  }
  info(...args) {
    this._userLogHandler && this._userLogHandler(this, LogLevel.INFO, ...args);
    this._logHandler(this, LogLevel.INFO, ...args);
  }
  warn(...args) {
    this._userLogHandler && this._userLogHandler(this, LogLevel.WARN, ...args);
    this._logHandler(this, LogLevel.WARN, ...args);
  }
  error(...args) {
    this._userLogHandler && this._userLogHandler(this, LogLevel.ERROR, ...args);
    this._logHandler(this, LogLevel.ERROR, ...args);
  }
};

// node_modules/idb/build/wrap-idb-value.js
var instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);
var idbProxyableTypes;
var cursorAdvanceMethods;
function getIdbProxyableTypes() {
  return idbProxyableTypes || (idbProxyableTypes = [
    IDBDatabase,
    IDBObjectStore,
    IDBIndex,
    IDBCursor,
    IDBTransaction
  ]);
}
function getCursorAdvanceMethods() {
  return cursorAdvanceMethods || (cursorAdvanceMethods = [
    IDBCursor.prototype.advance,
    IDBCursor.prototype.continue,
    IDBCursor.prototype.continuePrimaryKey
  ]);
}
var cursorRequestMap = /* @__PURE__ */ new WeakMap();
var transactionDoneMap = /* @__PURE__ */ new WeakMap();
var transactionStoreNamesMap = /* @__PURE__ */ new WeakMap();
var transformCache = /* @__PURE__ */ new WeakMap();
var reverseTransformCache = /* @__PURE__ */ new WeakMap();
function promisifyRequest(request) {
  const promise = new Promise((resolve, reject) => {
    const unlisten = () => {
      request.removeEventListener("success", success);
      request.removeEventListener("error", error);
    };
    const success = () => {
      resolve(wrap(request.result));
      unlisten();
    };
    const error = () => {
      reject(request.error);
      unlisten();
    };
    request.addEventListener("success", success);
    request.addEventListener("error", error);
  });
  promise.then((value) => {
    if (value instanceof IDBCursor) {
      cursorRequestMap.set(value, request);
    }
  }).catch(() => {
  });
  reverseTransformCache.set(promise, request);
  return promise;
}
function cacheDonePromiseForTransaction(tx) {
  if (transactionDoneMap.has(tx))
    return;
  const done = new Promise((resolve, reject) => {
    const unlisten = () => {
      tx.removeEventListener("complete", complete);
      tx.removeEventListener("error", error);
      tx.removeEventListener("abort", error);
    };
    const complete = () => {
      resolve();
      unlisten();
    };
    const error = () => {
      reject(tx.error || new DOMException("AbortError", "AbortError"));
      unlisten();
    };
    tx.addEventListener("complete", complete);
    tx.addEventListener("error", error);
    tx.addEventListener("abort", error);
  });
  transactionDoneMap.set(tx, done);
}
var idbProxyTraps = {
  get(target, prop, receiver) {
    if (target instanceof IDBTransaction) {
      if (prop === "done")
        return transactionDoneMap.get(target);
      if (prop === "objectStoreNames") {
        return target.objectStoreNames || transactionStoreNamesMap.get(target);
      }
      if (prop === "store") {
        return receiver.objectStoreNames[1] ? void 0 : receiver.objectStore(receiver.objectStoreNames[0]);
      }
    }
    return wrap(target[prop]);
  },
  set(target, prop, value) {
    target[prop] = value;
    return true;
  },
  has(target, prop) {
    if (target instanceof IDBTransaction && (prop === "done" || prop === "store")) {
      return true;
    }
    return prop in target;
  }
};
function replaceTraps(callback) {
  idbProxyTraps = callback(idbProxyTraps);
}
function wrapFunction(func) {
  if (func === IDBDatabase.prototype.transaction && !("objectStoreNames" in IDBTransaction.prototype)) {
    return function(storeNames, ...args) {
      const tx = func.call(unwrap(this), storeNames, ...args);
      transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);
      return wrap(tx);
    };
  }
  if (getCursorAdvanceMethods().includes(func)) {
    return function(...args) {
      func.apply(unwrap(this), args);
      return wrap(cursorRequestMap.get(this));
    };
  }
  return function(...args) {
    return wrap(func.apply(unwrap(this), args));
  };
}
function transformCachableValue(value) {
  if (typeof value === "function")
    return wrapFunction(value);
  if (value instanceof IDBTransaction)
    cacheDonePromiseForTransaction(value);
  if (instanceOfAny(value, getIdbProxyableTypes()))
    return new Proxy(value, idbProxyTraps);
  return value;
}
function wrap(value) {
  if (value instanceof IDBRequest)
    return promisifyRequest(value);
  if (transformCache.has(value))
    return transformCache.get(value);
  const newValue = transformCachableValue(value);
  if (newValue !== value) {
    transformCache.set(value, newValue);
    reverseTransformCache.set(newValue, value);
  }
  return newValue;
}
var unwrap = (value) => reverseTransformCache.get(value);

// node_modules/idb/build/index.js
function openDB(name5, version5, { blocked, upgrade, blocking, terminated } = {}) {
  const request = indexedDB.open(name5, version5);
  const openPromise = wrap(request);
  if (upgrade) {
    request.addEventListener("upgradeneeded", (event) => {
      upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);
    });
  }
  if (blocked) {
    request.addEventListener("blocked", (event) => blocked(
      // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405
      event.oldVersion,
      event.newVersion,
      event
    ));
  }
  openPromise.then((db) => {
    if (terminated)
      db.addEventListener("close", () => terminated());
    if (blocking) {
      db.addEventListener("versionchange", (event) => blocking(event.oldVersion, event.newVersion, event));
    }
  }).catch(() => {
  });
  return openPromise;
}
var readMethods = ["get", "getKey", "getAll", "getAllKeys", "count"];
var writeMethods = ["put", "add", "delete", "clear"];
var cachedMethods = /* @__PURE__ */ new Map();
function getMethod(target, prop) {
  if (!(target instanceof IDBDatabase && !(prop in target) && typeof prop === "string")) {
    return;
  }
  if (cachedMethods.get(prop))
    return cachedMethods.get(prop);
  const targetFuncName = prop.replace(/FromIndex$/, "");
  const useIndex = prop !== targetFuncName;
  const isWrite = writeMethods.includes(targetFuncName);
  if (
    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.
    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) || !(isWrite || readMethods.includes(targetFuncName))
  ) {
    return;
  }
  const method = async function(storeName, ...args) {
    const tx = this.transaction(storeName, isWrite ? "readwrite" : "readonly");
    let target2 = tx.store;
    if (useIndex)
      target2 = target2.index(args.shift());
    return (await Promise.all([
      target2[targetFuncName](...args),
      isWrite && tx.done
    ]))[0];
  };
  cachedMethods.set(prop, method);
  return method;
}
replaceTraps((oldTraps) => ({
  ...oldTraps,
  get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),
  has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop)
}));

// node_modules/@firebase/app/dist/esm/index.esm2017.js
var PlatformLoggerServiceImpl = class {
  constructor(container) {
    this.container = container;
  }
  // In initial implementation, this will be called by installations on
  // auth token refresh, and installations will send this string.
  getPlatformInfoString() {
    const providers = this.container.getProviders();
    return providers.map((provider2) => {
      if (isVersionServiceProvider(provider2)) {
        const service = provider2.getImmediate();
        return `${service.library}/${service.version}`;
      } else {
        return null;
      }
    }).filter((logString) => logString).join(" ");
  }
};
function isVersionServiceProvider(provider2) {
  const component = provider2.getComponent();
  return (component === null || component === void 0 ? void 0 : component.type) === "VERSION";
}
var name$o = "@firebase/app";
var version$1 = "0.9.15";
var logger = new Logger("@firebase/app");
var name$n = "@firebase/app-compat";
var name$m = "@firebase/analytics-compat";
var name$l = "@firebase/analytics";
var name$k = "@firebase/app-check-compat";
var name$j = "@firebase/app-check";
var name$i = "@firebase/auth";
var name$h = "@firebase/auth-compat";
var name$g = "@firebase/database";
var name$f = "@firebase/database-compat";
var name$e = "@firebase/functions";
var name$d = "@firebase/functions-compat";
var name$c = "@firebase/installations";
var name$b = "@firebase/installations-compat";
var name$a = "@firebase/messaging";
var name$9 = "@firebase/messaging-compat";
var name$8 = "@firebase/performance";
var name$7 = "@firebase/performance-compat";
var name$6 = "@firebase/remote-config";
var name$5 = "@firebase/remote-config-compat";
var name$4 = "@firebase/storage";
var name$3 = "@firebase/storage-compat";
var name$2 = "@firebase/firestore";
var name$1 = "@firebase/firestore-compat";
var name = "firebase";
var version = "10.1.0";
var DEFAULT_ENTRY_NAME2 = "[DEFAULT]";
var PLATFORM_LOG_STRING = {
  [name$o]: "fire-core",
  [name$n]: "fire-core-compat",
  [name$l]: "fire-analytics",
  [name$m]: "fire-analytics-compat",
  [name$j]: "fire-app-check",
  [name$k]: "fire-app-check-compat",
  [name$i]: "fire-auth",
  [name$h]: "fire-auth-compat",
  [name$g]: "fire-rtdb",
  [name$f]: "fire-rtdb-compat",
  [name$e]: "fire-fn",
  [name$d]: "fire-fn-compat",
  [name$c]: "fire-iid",
  [name$b]: "fire-iid-compat",
  [name$a]: "fire-fcm",
  [name$9]: "fire-fcm-compat",
  [name$8]: "fire-perf",
  [name$7]: "fire-perf-compat",
  [name$6]: "fire-rc",
  [name$5]: "fire-rc-compat",
  [name$4]: "fire-gcs",
  [name$3]: "fire-gcs-compat",
  [name$2]: "fire-fst",
  [name$1]: "fire-fst-compat",
  "fire-js": "fire-js",
  [name]: "fire-js-all"
};
var _apps = /* @__PURE__ */ new Map();
var _components = /* @__PURE__ */ new Map();
function _addComponent(app2, component) {
  try {
    app2.container.addComponent(component);
  } catch (e) {
    logger.debug(`Component ${component.name} failed to register with FirebaseApp ${app2.name}`, e);
  }
}
function _registerComponent(component) {
  const componentName = component.name;
  if (_components.has(componentName)) {
    logger.debug(`There were multiple attempts to register component ${componentName}.`);
    return false;
  }
  _components.set(componentName, component);
  for (const app2 of _apps.values()) {
    _addComponent(app2, component);
  }
  return true;
}
function _getProvider(app2, name5) {
  const heartbeatController = app2.container.getProvider("heartbeat").getImmediate({ optional: true });
  if (heartbeatController) {
    void heartbeatController.triggerHeartbeat();
  }
  return app2.container.getProvider(name5);
}
var ERRORS = {
  [
    "no-app"
    /* AppError.NO_APP */
  ]: "No Firebase App '{$appName}' has been created - call initializeApp() first",
  [
    "bad-app-name"
    /* AppError.BAD_APP_NAME */
  ]: "Illegal App name: '{$appName}",
  [
    "duplicate-app"
    /* AppError.DUPLICATE_APP */
  ]: "Firebase App named '{$appName}' already exists with different options or config",
  [
    "app-deleted"
    /* AppError.APP_DELETED */
  ]: "Firebase App named '{$appName}' already deleted",
  [
    "no-options"
    /* AppError.NO_OPTIONS */
  ]: "Need to provide options, when not being deployed to hosting via source.",
  [
    "invalid-app-argument"
    /* AppError.INVALID_APP_ARGUMENT */
  ]: "firebase.{$appName}() takes either no argument or a Firebase App instance.",
  [
    "invalid-log-argument"
    /* AppError.INVALID_LOG_ARGUMENT */
  ]: "First argument to `onLog` must be null or a function.",
  [
    "idb-open"
    /* AppError.IDB_OPEN */
  ]: "Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",
  [
    "idb-get"
    /* AppError.IDB_GET */
  ]: "Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",
  [
    "idb-set"
    /* AppError.IDB_WRITE */
  ]: "Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",
  [
    "idb-delete"
    /* AppError.IDB_DELETE */
  ]: "Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."
};
var ERROR_FACTORY = new ErrorFactory("app", "Firebase", ERRORS);
var FirebaseAppImpl = class {
  constructor(options, config, container) {
    this._isDeleted = false;
    this._options = Object.assign({}, options);
    this._config = Object.assign({}, config);
    this._name = config.name;
    this._automaticDataCollectionEnabled = config.automaticDataCollectionEnabled;
    this._container = container;
    this.container.addComponent(new Component(
      "app",
      () => this,
      "PUBLIC"
      /* ComponentType.PUBLIC */
    ));
  }
  get automaticDataCollectionEnabled() {
    this.checkDestroyed();
    return this._automaticDataCollectionEnabled;
  }
  set automaticDataCollectionEnabled(val) {
    this.checkDestroyed();
    this._automaticDataCollectionEnabled = val;
  }
  get name() {
    this.checkDestroyed();
    return this._name;
  }
  get options() {
    this.checkDestroyed();
    return this._options;
  }
  get config() {
    this.checkDestroyed();
    return this._config;
  }
  get container() {
    return this._container;
  }
  get isDeleted() {
    return this._isDeleted;
  }
  set isDeleted(val) {
    this._isDeleted = val;
  }
  /**
   * This function will throw an Error if the App has already been deleted -
   * use before performing API actions on the App.
   */
  checkDestroyed() {
    if (this.isDeleted) {
      throw ERROR_FACTORY.create("app-deleted", { appName: this._name });
    }
  }
};
var SDK_VERSION = version;
function initializeApp(_options, rawConfig = {}) {
  let options = _options;
  if (typeof rawConfig !== "object") {
    const name6 = rawConfig;
    rawConfig = { name: name6 };
  }
  const config = Object.assign({ name: DEFAULT_ENTRY_NAME2, automaticDataCollectionEnabled: false }, rawConfig);
  const name5 = config.name;
  if (typeof name5 !== "string" || !name5) {
    throw ERROR_FACTORY.create("bad-app-name", {
      appName: String(name5)
    });
  }
  options || (options = getDefaultAppConfig());
  if (!options) {
    throw ERROR_FACTORY.create(
      "no-options"
      /* AppError.NO_OPTIONS */
    );
  }
  const existingApp = _apps.get(name5);
  if (existingApp) {
    if (deepEqual(options, existingApp.options) && deepEqual(config, existingApp.config)) {
      return existingApp;
    } else {
      throw ERROR_FACTORY.create("duplicate-app", { appName: name5 });
    }
  }
  const container = new ComponentContainer(name5);
  for (const component of _components.values()) {
    container.addComponent(component);
  }
  const newApp = new FirebaseAppImpl(options, config, container);
  _apps.set(name5, newApp);
  return newApp;
}
function getApp(name5 = DEFAULT_ENTRY_NAME2) {
  const app2 = _apps.get(name5);
  if (!app2 && name5 === DEFAULT_ENTRY_NAME2 && getDefaultAppConfig()) {
    return initializeApp();
  }
  if (!app2) {
    throw ERROR_FACTORY.create("no-app", { appName: name5 });
  }
  return app2;
}
function registerVersion(libraryKeyOrName, version5, variant) {
  var _a;
  let library = (_a = PLATFORM_LOG_STRING[libraryKeyOrName]) !== null && _a !== void 0 ? _a : libraryKeyOrName;
  if (variant) {
    library += `-${variant}`;
  }
  const libraryMismatch = library.match(/\s|\//);
  const versionMismatch = version5.match(/\s|\//);
  if (libraryMismatch || versionMismatch) {
    const warning = [
      `Unable to register library "${library}" with version "${version5}":`
    ];
    if (libraryMismatch) {
      warning.push(`library name "${library}" contains illegal characters (whitespace or "/")`);
    }
    if (libraryMismatch && versionMismatch) {
      warning.push("and");
    }
    if (versionMismatch) {
      warning.push(`version name "${version5}" contains illegal characters (whitespace or "/")`);
    }
    logger.warn(warning.join(" "));
    return;
  }
  _registerComponent(new Component(
    `${library}-version`,
    () => ({ library, version: version5 }),
    "VERSION"
    /* ComponentType.VERSION */
  ));
}
var DB_NAME = "firebase-heartbeat-database";
var DB_VERSION = 1;
var STORE_NAME = "firebase-heartbeat-store";
var dbPromise = null;
function getDbPromise() {
  if (!dbPromise) {
    dbPromise = openDB(DB_NAME, DB_VERSION, {
      upgrade: (db, oldVersion) => {
        switch (oldVersion) {
          case 0:
            db.createObjectStore(STORE_NAME);
        }
      }
    }).catch((e) => {
      throw ERROR_FACTORY.create("idb-open", {
        originalErrorMessage: e.message
      });
    });
  }
  return dbPromise;
}
async function readHeartbeatsFromIndexedDB(app2) {
  try {
    const db = await getDbPromise();
    const result = await db.transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(app2));
    return result;
  } catch (e) {
    if (e instanceof FirebaseError) {
      logger.warn(e.message);
    } else {
      const idbGetError = ERROR_FACTORY.create("idb-get", {
        originalErrorMessage: e === null || e === void 0 ? void 0 : e.message
      });
      logger.warn(idbGetError.message);
    }
  }
}
async function writeHeartbeatsToIndexedDB(app2, heartbeatObject) {
  try {
    const db = await getDbPromise();
    const tx = db.transaction(STORE_NAME, "readwrite");
    const objectStore = tx.objectStore(STORE_NAME);
    await objectStore.put(heartbeatObject, computeKey(app2));
    await tx.done;
  } catch (e) {
    if (e instanceof FirebaseError) {
      logger.warn(e.message);
    } else {
      const idbGetError = ERROR_FACTORY.create("idb-set", {
        originalErrorMessage: e === null || e === void 0 ? void 0 : e.message
      });
      logger.warn(idbGetError.message);
    }
  }
}
function computeKey(app2) {
  return `${app2.name}!${app2.options.appId}`;
}
var MAX_HEADER_BYTES = 1024;
var STORED_HEARTBEAT_RETENTION_MAX_MILLIS = 30 * 24 * 60 * 60 * 1e3;
var HeartbeatServiceImpl = class {
  constructor(container) {
    this.container = container;
    this._heartbeatsCache = null;
    const app2 = this.container.getProvider("app").getImmediate();
    this._storage = new HeartbeatStorageImpl(app2);
    this._heartbeatsCachePromise = this._storage.read().then((result) => {
      this._heartbeatsCache = result;
      return result;
    });
  }
  /**
   * Called to report a heartbeat. The function will generate
   * a HeartbeatsByUserAgent object, update heartbeatsCache, and persist it
   * to IndexedDB.
   * Note that we only store one heartbeat per day. So if a heartbeat for today is
   * already logged, subsequent calls to this function in the same day will be ignored.
   */
  async triggerHeartbeat() {
    const platformLogger = this.container.getProvider("platform-logger").getImmediate();
    const agent = platformLogger.getPlatformInfoString();
    const date = getUTCDateString();
    if (this._heartbeatsCache === null) {
      this._heartbeatsCache = await this._heartbeatsCachePromise;
    }
    if (this._heartbeatsCache.lastSentHeartbeatDate === date || this._heartbeatsCache.heartbeats.some((singleDateHeartbeat) => singleDateHeartbeat.date === date)) {
      return;
    } else {
      this._heartbeatsCache.heartbeats.push({ date, agent });
    }
    this._heartbeatsCache.heartbeats = this._heartbeatsCache.heartbeats.filter((singleDateHeartbeat) => {
      const hbTimestamp = new Date(singleDateHeartbeat.date).valueOf();
      const now = Date.now();
      return now - hbTimestamp <= STORED_HEARTBEAT_RETENTION_MAX_MILLIS;
    });
    return this._storage.overwrite(this._heartbeatsCache);
  }
  /**
   * Returns a base64 encoded string which can be attached to the heartbeat-specific header directly.
   * It also clears all heartbeats from memory as well as in IndexedDB.
   *
   * NOTE: Consuming product SDKs should not send the header if this method
   * returns an empty string.
   */
  async getHeartbeatsHeader() {
    if (this._heartbeatsCache === null) {
      await this._heartbeatsCachePromise;
    }
    if (this._heartbeatsCache === null || this._heartbeatsCache.heartbeats.length === 0) {
      return "";
    }
    const date = getUTCDateString();
    const { heartbeatsToSend, unsentEntries } = extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats);
    const headerString = base64urlEncodeWithoutPadding(JSON.stringify({ version: 2, heartbeats: heartbeatsToSend }));
    this._heartbeatsCache.lastSentHeartbeatDate = date;
    if (unsentEntries.length > 0) {
      this._heartbeatsCache.heartbeats = unsentEntries;
      await this._storage.overwrite(this._heartbeatsCache);
    } else {
      this._heartbeatsCache.heartbeats = [];
      void this._storage.overwrite(this._heartbeatsCache);
    }
    return headerString;
  }
};
function getUTCDateString() {
  const today = new Date();
  return today.toISOString().substring(0, 10);
}
function extractHeartbeatsForHeader(heartbeatsCache, maxSize = MAX_HEADER_BYTES) {
  const heartbeatsToSend = [];
  let unsentEntries = heartbeatsCache.slice();
  for (const singleDateHeartbeat of heartbeatsCache) {
    const heartbeatEntry = heartbeatsToSend.find((hb) => hb.agent === singleDateHeartbeat.agent);
    if (!heartbeatEntry) {
      heartbeatsToSend.push({
        agent: singleDateHeartbeat.agent,
        dates: [singleDateHeartbeat.date]
      });
      if (countBytes(heartbeatsToSend) > maxSize) {
        heartbeatsToSend.pop();
        break;
      }
    } else {
      heartbeatEntry.dates.push(singleDateHeartbeat.date);
      if (countBytes(heartbeatsToSend) > maxSize) {
        heartbeatEntry.dates.pop();
        break;
      }
    }
    unsentEntries = unsentEntries.slice(1);
  }
  return {
    heartbeatsToSend,
    unsentEntries
  };
}
var HeartbeatStorageImpl = class {
  constructor(app2) {
    this.app = app2;
    this._canUseIndexedDBPromise = this.runIndexedDBEnvironmentCheck();
  }
  async runIndexedDBEnvironmentCheck() {
    if (!isIndexedDBAvailable()) {
      return false;
    } else {
      return validateIndexedDBOpenable().then(() => true).catch(() => false);
    }
  }
  /**
   * Read all heartbeats.
   */
  async read() {
    const canUseIndexedDB = await this._canUseIndexedDBPromise;
    if (!canUseIndexedDB) {
      return { heartbeats: [] };
    } else {
      const idbHeartbeatObject = await readHeartbeatsFromIndexedDB(this.app);
      return idbHeartbeatObject || { heartbeats: [] };
    }
  }
  // overwrite the storage with the provided heartbeats
  async overwrite(heartbeatsObject) {
    var _a;
    const canUseIndexedDB = await this._canUseIndexedDBPromise;
    if (!canUseIndexedDB) {
      return;
    } else {
      const existingHeartbeatsObject = await this.read();
      return writeHeartbeatsToIndexedDB(this.app, {
        lastSentHeartbeatDate: (_a = heartbeatsObject.lastSentHeartbeatDate) !== null && _a !== void 0 ? _a : existingHeartbeatsObject.lastSentHeartbeatDate,
        heartbeats: heartbeatsObject.heartbeats
      });
    }
  }
  // add heartbeats
  async add(heartbeatsObject) {
    var _a;
    const canUseIndexedDB = await this._canUseIndexedDBPromise;
    if (!canUseIndexedDB) {
      return;
    } else {
      const existingHeartbeatsObject = await this.read();
      return writeHeartbeatsToIndexedDB(this.app, {
        lastSentHeartbeatDate: (_a = heartbeatsObject.lastSentHeartbeatDate) !== null && _a !== void 0 ? _a : existingHeartbeatsObject.lastSentHeartbeatDate,
        heartbeats: [
          ...existingHeartbeatsObject.heartbeats,
          ...heartbeatsObject.heartbeats
        ]
      });
    }
  }
};
function countBytes(heartbeatsCache) {
  return base64urlEncodeWithoutPadding(
    // heartbeatsCache wrapper properties
    JSON.stringify({ version: 2, heartbeats: heartbeatsCache })
  ).length;
}
function registerCoreComponents(variant) {
  _registerComponent(new Component(
    "platform-logger",
    (container) => new PlatformLoggerServiceImpl(container),
    "PRIVATE"
    /* ComponentType.PRIVATE */
  ));
  _registerComponent(new Component(
    "heartbeat",
    (container) => new HeartbeatServiceImpl(container),
    "PRIVATE"
    /* ComponentType.PRIVATE */
  ));
  registerVersion(name$o, version$1, variant);
  registerVersion(name$o, version$1, "esm2017");
  registerVersion("fire-js", "");
}
registerCoreComponents("");

// node_modules/@firebase/storage/dist/index.esm2017.js
var DEFAULT_HOST = "firebasestorage.googleapis.com";
var CONFIG_STORAGE_BUCKET_KEY = "storageBucket";
var DEFAULT_MAX_OPERATION_RETRY_TIME = 2 * 60 * 1e3;
var DEFAULT_MAX_UPLOAD_RETRY_TIME = 10 * 60 * 1e3;
var DEFAULT_MIN_SLEEP_TIME_MILLIS = 1e3;
var StorageError = class extends FirebaseError {
  /**
   * @param code - A `StorageErrorCode` string to be prefixed with 'storage/' and
   *  added to the end of the message.
   * @param message  - Error message.
   * @param status_ - Corresponding HTTP Status Code
   */
  constructor(code, message, status_ = 0) {
    super(prependCode(code), `Firebase Storage: ${message} (${prependCode(code)})`);
    this.status_ = status_;
    this.customData = { serverResponse: null };
    this._baseMessage = this.message;
    Object.setPrototypeOf(this, StorageError.prototype);
  }
  get status() {
    return this.status_;
  }
  set status(status) {
    this.status_ = status;
  }
  /**
   * Compares a `StorageErrorCode` against this error's code, filtering out the prefix.
   */
  _codeEquals(code) {
    return prependCode(code) === this.code;
  }
  /**
   * Optional response message that was added by the server.
   */
  get serverResponse() {
    return this.customData.serverResponse;
  }
  set serverResponse(serverResponse) {
    this.customData.serverResponse = serverResponse;
    if (this.customData.serverResponse) {
      this.message = `${this._baseMessage}
${this.customData.serverResponse}`;
    } else {
      this.message = this._baseMessage;
    }
  }
};
var StorageErrorCode;
(function(StorageErrorCode2) {
  StorageErrorCode2["UNKNOWN"] = "unknown";
  StorageErrorCode2["OBJECT_NOT_FOUND"] = "object-not-found";
  StorageErrorCode2["BUCKET_NOT_FOUND"] = "bucket-not-found";
  StorageErrorCode2["PROJECT_NOT_FOUND"] = "project-not-found";
  StorageErrorCode2["QUOTA_EXCEEDED"] = "quota-exceeded";
  StorageErrorCode2["UNAUTHENTICATED"] = "unauthenticated";
  StorageErrorCode2["UNAUTHORIZED"] = "unauthorized";
  StorageErrorCode2["UNAUTHORIZED_APP"] = "unauthorized-app";
  StorageErrorCode2["RETRY_LIMIT_EXCEEDED"] = "retry-limit-exceeded";
  StorageErrorCode2["INVALID_CHECKSUM"] = "invalid-checksum";
  StorageErrorCode2["CANCELED"] = "canceled";
  StorageErrorCode2["INVALID_EVENT_NAME"] = "invalid-event-name";
  StorageErrorCode2["INVALID_URL"] = "invalid-url";
  StorageErrorCode2["INVALID_DEFAULT_BUCKET"] = "invalid-default-bucket";
  StorageErrorCode2["NO_DEFAULT_BUCKET"] = "no-default-bucket";
  StorageErrorCode2["CANNOT_SLICE_BLOB"] = "cannot-slice-blob";
  StorageErrorCode2["SERVER_FILE_WRONG_SIZE"] = "server-file-wrong-size";
  StorageErrorCode2["NO_DOWNLOAD_URL"] = "no-download-url";
  StorageErrorCode2["INVALID_ARGUMENT"] = "invalid-argument";
  StorageErrorCode2["INVALID_ARGUMENT_COUNT"] = "invalid-argument-count";
  StorageErrorCode2["APP_DELETED"] = "app-deleted";
  StorageErrorCode2["INVALID_ROOT_OPERATION"] = "invalid-root-operation";
  StorageErrorCode2["INVALID_FORMAT"] = "invalid-format";
  StorageErrorCode2["INTERNAL_ERROR"] = "internal-error";
  StorageErrorCode2["UNSUPPORTED_ENVIRONMENT"] = "unsupported-environment";
})(StorageErrorCode || (StorageErrorCode = {}));
function prependCode(code) {
  return "storage/" + code;
}
function unknown() {
  const message = "An unknown error occurred, please check the error payload for server response.";
  return new StorageError(StorageErrorCode.UNKNOWN, message);
}
function objectNotFound(path) {
  return new StorageError(StorageErrorCode.OBJECT_NOT_FOUND, "Object '" + path + "' does not exist.");
}
function quotaExceeded(bucket) {
  return new StorageError(StorageErrorCode.QUOTA_EXCEEDED, "Quota for bucket '" + bucket + "' exceeded, please view quota on https://firebase.google.com/pricing/.");
}
function unauthenticated() {
  const message = "User is not authenticated, please authenticate using Firebase Authentication and try again.";
  return new StorageError(StorageErrorCode.UNAUTHENTICATED, message);
}
function unauthorizedApp() {
  return new StorageError(StorageErrorCode.UNAUTHORIZED_APP, "This app does not have permission to access Firebase Storage on this project.");
}
function unauthorized(path) {
  return new StorageError(StorageErrorCode.UNAUTHORIZED, "User does not have permission to access '" + path + "'.");
}
function retryLimitExceeded() {
  return new StorageError(StorageErrorCode.RETRY_LIMIT_EXCEEDED, "Max retry time for operation exceeded, please try again.");
}
function canceled() {
  return new StorageError(StorageErrorCode.CANCELED, "User canceled the upload/download.");
}
function invalidUrl(url) {
  return new StorageError(StorageErrorCode.INVALID_URL, "Invalid URL '" + url + "'.");
}
function invalidDefaultBucket(bucket) {
  return new StorageError(StorageErrorCode.INVALID_DEFAULT_BUCKET, "Invalid default bucket '" + bucket + "'.");
}
function noDefaultBucket() {
  return new StorageError(StorageErrorCode.NO_DEFAULT_BUCKET, "No default bucket found. Did you set the '" + CONFIG_STORAGE_BUCKET_KEY + "' property when initializing the app?");
}
function cannotSliceBlob() {
  return new StorageError(StorageErrorCode.CANNOT_SLICE_BLOB, "Cannot slice blob for upload. Please retry the upload.");
}
function serverFileWrongSize() {
  return new StorageError(StorageErrorCode.SERVER_FILE_WRONG_SIZE, "Server recorded incorrect upload file size, please retry the upload.");
}
function noDownloadURL() {
  return new StorageError(StorageErrorCode.NO_DOWNLOAD_URL, "The given file does not have any download URLs.");
}
function missingPolyFill(polyFill) {
  return new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT, `${polyFill} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);
}
function invalidArgument(message) {
  return new StorageError(StorageErrorCode.INVALID_ARGUMENT, message);
}
function appDeleted() {
  return new StorageError(StorageErrorCode.APP_DELETED, "The Firebase app was deleted.");
}
function invalidRootOperation(name5) {
  return new StorageError(StorageErrorCode.INVALID_ROOT_OPERATION, "The operation '" + name5 + "' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').");
}
function invalidFormat(format, message) {
  return new StorageError(StorageErrorCode.INVALID_FORMAT, "String does not match format '" + format + "': " + message);
}
function internalError(message) {
  throw new StorageError(StorageErrorCode.INTERNAL_ERROR, "Internal error: " + message);
}
var Location = class {
  constructor(bucket, path) {
    this.bucket = bucket;
    this.path_ = path;
  }
  get path() {
    return this.path_;
  }
  get isRoot() {
    return this.path.length === 0;
  }
  fullServerUrl() {
    const encode = encodeURIComponent;
    return "/b/" + encode(this.bucket) + "/o/" + encode(this.path);
  }
  bucketOnlyServerUrl() {
    const encode = encodeURIComponent;
    return "/b/" + encode(this.bucket) + "/o";
  }
  static makeFromBucketSpec(bucketString, host) {
    let bucketLocation;
    try {
      bucketLocation = Location.makeFromUrl(bucketString, host);
    } catch (e) {
      return new Location(bucketString, "");
    }
    if (bucketLocation.path === "") {
      return bucketLocation;
    } else {
      throw invalidDefaultBucket(bucketString);
    }
  }
  static makeFromUrl(url, host) {
    let location = null;
    const bucketDomain = "([A-Za-z0-9.\\-_]+)";
    function gsModify(loc) {
      if (loc.path.charAt(loc.path.length - 1) === "/") {
        loc.path_ = loc.path_.slice(0, -1);
      }
    }
    const gsPath = "(/(.*))?$";
    const gsRegex = new RegExp("^gs://" + bucketDomain + gsPath, "i");
    const gsIndices = { bucket: 1, path: 3 };
    function httpModify(loc) {
      loc.path_ = decodeURIComponent(loc.path);
    }
    const version5 = "v[A-Za-z0-9_]+";
    const firebaseStorageHost = host.replace(/[.]/g, "\\.");
    const firebaseStoragePath = "(/([^?#]*).*)?$";
    const firebaseStorageRegExp = new RegExp(`^https?://${firebaseStorageHost}/${version5}/b/${bucketDomain}/o${firebaseStoragePath}`, "i");
    const firebaseStorageIndices = { bucket: 1, path: 3 };
    const cloudStorageHost = host === DEFAULT_HOST ? "(?:storage.googleapis.com|storage.cloud.google.com)" : host;
    const cloudStoragePath = "([^?#]*)";
    const cloudStorageRegExp = new RegExp(`^https?://${cloudStorageHost}/${bucketDomain}/${cloudStoragePath}`, "i");
    const cloudStorageIndices = { bucket: 1, path: 2 };
    const groups = [
      { regex: gsRegex, indices: gsIndices, postModify: gsModify },
      {
        regex: firebaseStorageRegExp,
        indices: firebaseStorageIndices,
        postModify: httpModify
      },
      {
        regex: cloudStorageRegExp,
        indices: cloudStorageIndices,
        postModify: httpModify
      }
    ];
    for (let i = 0; i < groups.length; i++) {
      const group = groups[i];
      const captures = group.regex.exec(url);
      if (captures) {
        const bucketValue = captures[group.indices.bucket];
        let pathValue = captures[group.indices.path];
        if (!pathValue) {
          pathValue = "";
        }
        location = new Location(bucketValue, pathValue);
        group.postModify(location);
        break;
      }
    }
    if (location == null) {
      throw invalidUrl(url);
    }
    return location;
  }
};
var FailRequest = class {
  constructor(error) {
    this.promise_ = Promise.reject(error);
  }
  /** @inheritDoc */
  getPromise() {
    return this.promise_;
  }
  /** @inheritDoc */
  cancel(_appDelete = false) {
  }
};
function start(doRequest, backoffCompleteCb, timeout) {
  let waitSeconds = 1;
  let retryTimeoutId = null;
  let globalTimeoutId = null;
  let hitTimeout = false;
  let cancelState = 0;
  function canceled2() {
    return cancelState === 2;
  }
  let triggeredCallback = false;
  function triggerCallback(...args) {
    if (!triggeredCallback) {
      triggeredCallback = true;
      backoffCompleteCb.apply(null, args);
    }
  }
  function callWithDelay(millis) {
    retryTimeoutId = setTimeout(() => {
      retryTimeoutId = null;
      doRequest(responseHandler, canceled2());
    }, millis);
  }
  function clearGlobalTimeout() {
    if (globalTimeoutId) {
      clearTimeout(globalTimeoutId);
    }
  }
  function responseHandler(success, ...args) {
    if (triggeredCallback) {
      clearGlobalTimeout();
      return;
    }
    if (success) {
      clearGlobalTimeout();
      triggerCallback.call(null, success, ...args);
      return;
    }
    const mustStop = canceled2() || hitTimeout;
    if (mustStop) {
      clearGlobalTimeout();
      triggerCallback.call(null, success, ...args);
      return;
    }
    if (waitSeconds < 64) {
      waitSeconds *= 2;
    }
    let waitMillis;
    if (cancelState === 1) {
      cancelState = 2;
      waitMillis = 0;
    } else {
      waitMillis = (waitSeconds + Math.random()) * 1e3;
    }
    callWithDelay(waitMillis);
  }
  let stopped = false;
  function stop2(wasTimeout) {
    if (stopped) {
      return;
    }
    stopped = true;
    clearGlobalTimeout();
    if (triggeredCallback) {
      return;
    }
    if (retryTimeoutId !== null) {
      if (!wasTimeout) {
        cancelState = 2;
      }
      clearTimeout(retryTimeoutId);
      callWithDelay(0);
    } else {
      if (!wasTimeout) {
        cancelState = 1;
      }
    }
  }
  callWithDelay(0);
  globalTimeoutId = setTimeout(() => {
    hitTimeout = true;
    stop2(true);
  }, timeout);
  return stop2;
}
function stop(id) {
  id(false);
}
function isJustDef(p) {
  return p !== void 0;
}
function isFunction(p) {
  return typeof p === "function";
}
function isNonArrayObject(p) {
  return typeof p === "object" && !Array.isArray(p);
}
function isString(p) {
  return typeof p === "string" || p instanceof String;
}
function isNativeBlob(p) {
  return isNativeBlobDefined() && p instanceof Blob;
}
function isNativeBlobDefined() {
  return typeof Blob !== "undefined" && !isNode();
}
function validateNumber(argument, minValue, maxValue, value) {
  if (value < minValue) {
    throw invalidArgument(`Invalid value for '${argument}'. Expected ${minValue} or greater.`);
  }
  if (value > maxValue) {
    throw invalidArgument(`Invalid value for '${argument}'. Expected ${maxValue} or less.`);
  }
}
function makeUrl(urlPart, host, protocol) {
  let origin = host;
  if (protocol == null) {
    origin = `https://${host}`;
  }
  return `${protocol}://${origin}/v0${urlPart}`;
}
function makeQueryString(params) {
  const encode = encodeURIComponent;
  let queryPart = "?";
  for (const key in params) {
    if (params.hasOwnProperty(key)) {
      const nextPart = encode(key) + "=" + encode(params[key]);
      queryPart = queryPart + nextPart + "&";
    }
  }
  queryPart = queryPart.slice(0, -1);
  return queryPart;
}
var ErrorCode;
(function(ErrorCode2) {
  ErrorCode2[ErrorCode2["NO_ERROR"] = 0] = "NO_ERROR";
  ErrorCode2[ErrorCode2["NETWORK_ERROR"] = 1] = "NETWORK_ERROR";
  ErrorCode2[ErrorCode2["ABORT"] = 2] = "ABORT";
})(ErrorCode || (ErrorCode = {}));
function isRetryStatusCode(status, additionalRetryCodes) {
  const isFiveHundredCode = status >= 500 && status < 600;
  const extraRetryCodes = [
    // Request Timeout: web server didn't receive full request in time.
    408,
    // Too Many Requests: you're getting rate-limited, basically.
    429
  ];
  const isExtraRetryCode = extraRetryCodes.indexOf(status) !== -1;
  const isAdditionalRetryCode = additionalRetryCodes.indexOf(status) !== -1;
  return isFiveHundredCode || isExtraRetryCode || isAdditionalRetryCode;
}
var NetworkRequest = class {
  constructor(url_, method_, headers_, body_, successCodes_, additionalRetryCodes_, callback_, errorCallback_, timeout_, progressCallback_, connectionFactory_, retry = true) {
    this.url_ = url_;
    this.method_ = method_;
    this.headers_ = headers_;
    this.body_ = body_;
    this.successCodes_ = successCodes_;
    this.additionalRetryCodes_ = additionalRetryCodes_;
    this.callback_ = callback_;
    this.errorCallback_ = errorCallback_;
    this.timeout_ = timeout_;
    this.progressCallback_ = progressCallback_;
    this.connectionFactory_ = connectionFactory_;
    this.retry = retry;
    this.pendingConnection_ = null;
    this.backoffId_ = null;
    this.canceled_ = false;
    this.appDelete_ = false;
    this.promise_ = new Promise((resolve, reject) => {
      this.resolve_ = resolve;
      this.reject_ = reject;
      this.start_();
    });
  }
  /**
   * Actually starts the retry loop.
   */
  start_() {
    const doTheRequest = (backoffCallback, canceled2) => {
      if (canceled2) {
        backoffCallback(false, new RequestEndStatus(false, null, true));
        return;
      }
      const connection = this.connectionFactory_();
      this.pendingConnection_ = connection;
      const progressListener = (progressEvent) => {
        const loaded = progressEvent.loaded;
        const total = progressEvent.lengthComputable ? progressEvent.total : -1;
        if (this.progressCallback_ !== null) {
          this.progressCallback_(loaded, total);
        }
      };
      if (this.progressCallback_ !== null) {
        connection.addUploadProgressListener(progressListener);
      }
      connection.send(this.url_, this.method_, this.body_, this.headers_).then(() => {
        if (this.progressCallback_ !== null) {
          connection.removeUploadProgressListener(progressListener);
        }
        this.pendingConnection_ = null;
        const hitServer = connection.getErrorCode() === ErrorCode.NO_ERROR;
        const status = connection.getStatus();
        if (!hitServer || isRetryStatusCode(status, this.additionalRetryCodes_) && this.retry) {
          const wasCanceled = connection.getErrorCode() === ErrorCode.ABORT;
          backoffCallback(false, new RequestEndStatus(false, null, wasCanceled));
          return;
        }
        const successCode = this.successCodes_.indexOf(status) !== -1;
        backoffCallback(true, new RequestEndStatus(successCode, connection));
      });
    };
    const backoffDone = (requestWentThrough, status) => {
      const resolve = this.resolve_;
      const reject = this.reject_;
      const connection = status.connection;
      if (status.wasSuccessCode) {
        try {
          const result = this.callback_(connection, connection.getResponse());
          if (isJustDef(result)) {
            resolve(result);
          } else {
            resolve();
          }
        } catch (e) {
          reject(e);
        }
      } else {
        if (connection !== null) {
          const err = unknown();
          err.serverResponse = connection.getErrorText();
          if (this.errorCallback_) {
            reject(this.errorCallback_(connection, err));
          } else {
            reject(err);
          }
        } else {
          if (status.canceled) {
            const err = this.appDelete_ ? appDeleted() : canceled();
            reject(err);
          } else {
            const err = retryLimitExceeded();
            reject(err);
          }
        }
      }
    };
    if (this.canceled_) {
      backoffDone(false, new RequestEndStatus(false, null, true));
    } else {
      this.backoffId_ = start(doTheRequest, backoffDone, this.timeout_);
    }
  }
  /** @inheritDoc */
  getPromise() {
    return this.promise_;
  }
  /** @inheritDoc */
  cancel(appDelete) {
    this.canceled_ = true;
    this.appDelete_ = appDelete || false;
    if (this.backoffId_ !== null) {
      stop(this.backoffId_);
    }
    if (this.pendingConnection_ !== null) {
      this.pendingConnection_.abort();
    }
  }
};
var RequestEndStatus = class {
  constructor(wasSuccessCode, connection, canceled2) {
    this.wasSuccessCode = wasSuccessCode;
    this.connection = connection;
    this.canceled = !!canceled2;
  }
};
function addAuthHeader_(headers, authToken) {
  if (authToken !== null && authToken.length > 0) {
    headers["Authorization"] = "Firebase " + authToken;
  }
}
function addVersionHeader_(headers, firebaseVersion) {
  headers["X-Firebase-Storage-Version"] = "webjs/" + (firebaseVersion !== null && firebaseVersion !== void 0 ? firebaseVersion : "AppManager");
}
function addGmpidHeader_(headers, appId) {
  if (appId) {
    headers["X-Firebase-GMPID"] = appId;
  }
}
function addAppCheckHeader_(headers, appCheckToken) {
  if (appCheckToken !== null) {
    headers["X-Firebase-AppCheck"] = appCheckToken;
  }
}
function makeRequest(requestInfo, appId, authToken, appCheckToken, requestFactory, firebaseVersion, retry = true) {
  const queryPart = makeQueryString(requestInfo.urlParams);
  const url = requestInfo.url + queryPart;
  const headers = Object.assign({}, requestInfo.headers);
  addGmpidHeader_(headers, appId);
  addAuthHeader_(headers, authToken);
  addVersionHeader_(headers, firebaseVersion);
  addAppCheckHeader_(headers, appCheckToken);
  return new NetworkRequest(url, requestInfo.method, headers, requestInfo.body, requestInfo.successCodes, requestInfo.additionalRetryCodes, requestInfo.handler, requestInfo.errorHandler, requestInfo.timeout, requestInfo.progressCallback, requestFactory, retry);
}
function getBlobBuilder() {
  if (typeof BlobBuilder !== "undefined") {
    return BlobBuilder;
  } else if (typeof WebKitBlobBuilder !== "undefined") {
    return WebKitBlobBuilder;
  } else {
    return void 0;
  }
}
function getBlob$1(...args) {
  const BlobBuilder2 = getBlobBuilder();
  if (BlobBuilder2 !== void 0) {
    const bb = new BlobBuilder2();
    for (let i = 0; i < args.length; i++) {
      bb.append(args[i]);
    }
    return bb.getBlob();
  } else {
    if (isNativeBlobDefined()) {
      return new Blob(args);
    } else {
      throw new StorageError(StorageErrorCode.UNSUPPORTED_ENVIRONMENT, "This browser doesn't seem to support creating Blobs");
    }
  }
}
function sliceBlob(blob, start2, end) {
  if (blob.webkitSlice) {
    return blob.webkitSlice(start2, end);
  } else if (blob.mozSlice) {
    return blob.mozSlice(start2, end);
  } else if (blob.slice) {
    return blob.slice(start2, end);
  }
  return null;
}
function decodeBase64(encoded) {
  if (typeof atob === "undefined") {
    throw missingPolyFill("base-64");
  }
  return atob(encoded);
}
var StringFormat = {
  /**
   * Indicates the string should be interpreted "raw", that is, as normal text.
   * The string will be interpreted as UTF-16, then uploaded as a UTF-8 byte
   * sequence.
   * Example: The string 'Hello! \\ud83d\\ude0a' becomes the byte sequence
   * 48 65 6c 6c 6f 21 20 f0 9f 98 8a
   */
  RAW: "raw",
  /**
   * Indicates the string should be interpreted as base64-encoded data.
   * Padding characters (trailing '='s) are optional.
   * Example: The string 'rWmO++E6t7/rlw==' becomes the byte sequence
   * ad 69 8e fb e1 3a b7 bf eb 97
   */
  BASE64: "base64",
  /**
   * Indicates the string should be interpreted as base64url-encoded data.
   * Padding characters (trailing '='s) are optional.
   * Example: The string 'rWmO--E6t7_rlw==' becomes the byte sequence
   * ad 69 8e fb e1 3a b7 bf eb 97
   */
  BASE64URL: "base64url",
  /**
   * Indicates the string is a data URL, such as one obtained from
   * canvas.toDataURL().
   * Example: the string 'data:application/octet-stream;base64,aaaa'
   * becomes the byte sequence
   * 69 a6 9a
   * (the content-type "application/octet-stream" is also applied, but can
   * be overridden in the metadata object).
   */
  DATA_URL: "data_url"
};
var StringData = class {
  constructor(data, contentType) {
    this.data = data;
    this.contentType = contentType || null;
  }
};
function dataFromString(format, stringData) {
  switch (format) {
    case StringFormat.RAW:
      return new StringData(utf8Bytes_(stringData));
    case StringFormat.BASE64:
    case StringFormat.BASE64URL:
      return new StringData(base64Bytes_(format, stringData));
    case StringFormat.DATA_URL:
      return new StringData(dataURLBytes_(stringData), dataURLContentType_(stringData));
  }
  throw unknown();
}
function utf8Bytes_(value) {
  const b = [];
  for (let i = 0; i < value.length; i++) {
    let c = value.charCodeAt(i);
    if (c <= 127) {
      b.push(c);
    } else {
      if (c <= 2047) {
        b.push(192 | c >> 6, 128 | c & 63);
      } else {
        if ((c & 64512) === 55296) {
          const valid = i < value.length - 1 && (value.charCodeAt(i + 1) & 64512) === 56320;
          if (!valid) {
            b.push(239, 191, 189);
          } else {
            const hi = c;
            const lo = value.charCodeAt(++i);
            c = 65536 | (hi & 1023) << 10 | lo & 1023;
            b.push(240 | c >> 18, 128 | c >> 12 & 63, 128 | c >> 6 & 63, 128 | c & 63);
          }
        } else {
          if ((c & 64512) === 56320) {
            b.push(239, 191, 189);
          } else {
            b.push(224 | c >> 12, 128 | c >> 6 & 63, 128 | c & 63);
          }
        }
      }
    }
  }
  return new Uint8Array(b);
}
function percentEncodedBytes_(value) {
  let decoded;
  try {
    decoded = decodeURIComponent(value);
  } catch (e) {
    throw invalidFormat(StringFormat.DATA_URL, "Malformed data URL.");
  }
  return utf8Bytes_(decoded);
}
function base64Bytes_(format, value) {
  switch (format) {
    case StringFormat.BASE64: {
      const hasMinus = value.indexOf("-") !== -1;
      const hasUnder = value.indexOf("_") !== -1;
      if (hasMinus || hasUnder) {
        const invalidChar = hasMinus ? "-" : "_";
        throw invalidFormat(format, "Invalid character '" + invalidChar + "' found: is it base64url encoded?");
      }
      break;
    }
    case StringFormat.BASE64URL: {
      const hasPlus = value.indexOf("+") !== -1;
      const hasSlash = value.indexOf("/") !== -1;
      if (hasPlus || hasSlash) {
        const invalidChar = hasPlus ? "+" : "/";
        throw invalidFormat(format, "Invalid character '" + invalidChar + "' found: is it base64 encoded?");
      }
      value = value.replace(/-/g, "+").replace(/_/g, "/");
      break;
    }
  }
  let bytes;
  try {
    bytes = decodeBase64(value);
  } catch (e) {
    if (e.message.includes("polyfill")) {
      throw e;
    }
    throw invalidFormat(format, "Invalid character found");
  }
  const array = new Uint8Array(bytes.length);
  for (let i = 0; i < bytes.length; i++) {
    array[i] = bytes.charCodeAt(i);
  }
  return array;
}
var DataURLParts = class {
  constructor(dataURL) {
    this.base64 = false;
    this.contentType = null;
    const matches = dataURL.match(/^data:([^,]+)?,/);
    if (matches === null) {
      throw invalidFormat(StringFormat.DATA_URL, "Must be formatted 'data:[<mediatype>][;base64],<data>");
    }
    const middle = matches[1] || null;
    if (middle != null) {
      this.base64 = endsWith(middle, ";base64");
      this.contentType = this.base64 ? middle.substring(0, middle.length - ";base64".length) : middle;
    }
    this.rest = dataURL.substring(dataURL.indexOf(",") + 1);
  }
};
function dataURLBytes_(dataUrl) {
  const parts = new DataURLParts(dataUrl);
  if (parts.base64) {
    return base64Bytes_(StringFormat.BASE64, parts.rest);
  } else {
    return percentEncodedBytes_(parts.rest);
  }
}
function dataURLContentType_(dataUrl) {
  const parts = new DataURLParts(dataUrl);
  return parts.contentType;
}
function endsWith(s, end) {
  const longEnough = s.length >= end.length;
  if (!longEnough) {
    return false;
  }
  return s.substring(s.length - end.length) === end;
}
var FbsBlob = class {
  constructor(data, elideCopy) {
    let size = 0;
    let blobType = "";
    if (isNativeBlob(data)) {
      this.data_ = data;
      size = data.size;
      blobType = data.type;
    } else if (data instanceof ArrayBuffer) {
      if (elideCopy) {
        this.data_ = new Uint8Array(data);
      } else {
        this.data_ = new Uint8Array(data.byteLength);
        this.data_.set(new Uint8Array(data));
      }
      size = this.data_.length;
    } else if (data instanceof Uint8Array) {
      if (elideCopy) {
        this.data_ = data;
      } else {
        this.data_ = new Uint8Array(data.length);
        this.data_.set(data);
      }
      size = data.length;
    }
    this.size_ = size;
    this.type_ = blobType;
  }
  size() {
    return this.size_;
  }
  type() {
    return this.type_;
  }
  slice(startByte, endByte) {
    if (isNativeBlob(this.data_)) {
      const realBlob = this.data_;
      const sliced = sliceBlob(realBlob, startByte, endByte);
      if (sliced === null) {
        return null;
      }
      return new FbsBlob(sliced);
    } else {
      const slice = new Uint8Array(this.data_.buffer, startByte, endByte - startByte);
      return new FbsBlob(slice, true);
    }
  }
  static getBlob(...args) {
    if (isNativeBlobDefined()) {
      const blobby = args.map((val) => {
        if (val instanceof FbsBlob) {
          return val.data_;
        } else {
          return val;
        }
      });
      return new FbsBlob(getBlob$1.apply(null, blobby));
    } else {
      const uint8Arrays = args.map((val) => {
        if (isString(val)) {
          return dataFromString(StringFormat.RAW, val).data;
        } else {
          return val.data_;
        }
      });
      let finalLength = 0;
      uint8Arrays.forEach((array) => {
        finalLength += array.byteLength;
      });
      const merged = new Uint8Array(finalLength);
      let index = 0;
      uint8Arrays.forEach((array) => {
        for (let i = 0; i < array.length; i++) {
          merged[index++] = array[i];
        }
      });
      return new FbsBlob(merged, true);
    }
  }
  uploadData() {
    return this.data_;
  }
};
function jsonObjectOrNull(s) {
  let obj;
  try {
    obj = JSON.parse(s);
  } catch (e) {
    return null;
  }
  if (isNonArrayObject(obj)) {
    return obj;
  } else {
    return null;
  }
}
function parent(path) {
  if (path.length === 0) {
    return null;
  }
  const index = path.lastIndexOf("/");
  if (index === -1) {
    return "";
  }
  const newPath = path.slice(0, index);
  return newPath;
}
function child(path, childPath) {
  const canonicalChildPath = childPath.split("/").filter((component) => component.length > 0).join("/");
  if (path.length === 0) {
    return canonicalChildPath;
  } else {
    return path + "/" + canonicalChildPath;
  }
}
function lastComponent(path) {
  const index = path.lastIndexOf("/", path.length - 2);
  if (index === -1) {
    return path;
  } else {
    return path.slice(index + 1);
  }
}
function noXform_(metadata, value) {
  return value;
}
var Mapping = class {
  constructor(server, local, writable, xform) {
    this.server = server;
    this.local = local || server;
    this.writable = !!writable;
    this.xform = xform || noXform_;
  }
};
var mappings_ = null;
function xformPath(fullPath) {
  if (!isString(fullPath) || fullPath.length < 2) {
    return fullPath;
  } else {
    return lastComponent(fullPath);
  }
}
function getMappings() {
  if (mappings_) {
    return mappings_;
  }
  const mappings = [];
  mappings.push(new Mapping("bucket"));
  mappings.push(new Mapping("generation"));
  mappings.push(new Mapping("metageneration"));
  mappings.push(new Mapping("name", "fullPath", true));
  function mappingsXformPath(_metadata, fullPath) {
    return xformPath(fullPath);
  }
  const nameMapping = new Mapping("name");
  nameMapping.xform = mappingsXformPath;
  mappings.push(nameMapping);
  function xformSize(_metadata, size) {
    if (size !== void 0) {
      return Number(size);
    } else {
      return size;
    }
  }
  const sizeMapping = new Mapping("size");
  sizeMapping.xform = xformSize;
  mappings.push(sizeMapping);
  mappings.push(new Mapping("timeCreated"));
  mappings.push(new Mapping("updated"));
  mappings.push(new Mapping("md5Hash", null, true));
  mappings.push(new Mapping("cacheControl", null, true));
  mappings.push(new Mapping("contentDisposition", null, true));
  mappings.push(new Mapping("contentEncoding", null, true));
  mappings.push(new Mapping("contentLanguage", null, true));
  mappings.push(new Mapping("contentType", null, true));
  mappings.push(new Mapping("metadata", "customMetadata", true));
  mappings_ = mappings;
  return mappings_;
}
function addRef(metadata, service) {
  function generateRef() {
    const bucket = metadata["bucket"];
    const path = metadata["fullPath"];
    const loc = new Location(bucket, path);
    return service._makeStorageReference(loc);
  }
  Object.defineProperty(metadata, "ref", { get: generateRef });
}
function fromResource(service, resource, mappings) {
  const metadata = {};
  metadata["type"] = "file";
  const len = mappings.length;
  for (let i = 0; i < len; i++) {
    const mapping = mappings[i];
    metadata[mapping.local] = mapping.xform(metadata, resource[mapping.server]);
  }
  addRef(metadata, service);
  return metadata;
}
function fromResourceString(service, resourceString, mappings) {
  const obj = jsonObjectOrNull(resourceString);
  if (obj === null) {
    return null;
  }
  const resource = obj;
  return fromResource(service, resource, mappings);
}
function downloadUrlFromResourceString(metadata, resourceString, host, protocol) {
  const obj = jsonObjectOrNull(resourceString);
  if (obj === null) {
    return null;
  }
  if (!isString(obj["downloadTokens"])) {
    return null;
  }
  const tokens = obj["downloadTokens"];
  if (tokens.length === 0) {
    return null;
  }
  const encode = encodeURIComponent;
  const tokensList = tokens.split(",");
  const urls = tokensList.map((token) => {
    const bucket = metadata["bucket"];
    const path = metadata["fullPath"];
    const urlPart = "/b/" + encode(bucket) + "/o/" + encode(path);
    const base = makeUrl(urlPart, host, protocol);
    const queryString = makeQueryString({
      alt: "media",
      token
    });
    return base + queryString;
  });
  return urls[0];
}
function toResourceString(metadata, mappings) {
  const resource = {};
  const len = mappings.length;
  for (let i = 0; i < len; i++) {
    const mapping = mappings[i];
    if (mapping.writable) {
      resource[mapping.server] = metadata[mapping.local];
    }
  }
  return JSON.stringify(resource);
}
var PREFIXES_KEY = "prefixes";
var ITEMS_KEY = "items";
function fromBackendResponse(service, bucket, resource) {
  const listResult = {
    prefixes: [],
    items: [],
    nextPageToken: resource["nextPageToken"]
  };
  if (resource[PREFIXES_KEY]) {
    for (const path of resource[PREFIXES_KEY]) {
      const pathWithoutTrailingSlash = path.replace(/\/$/, "");
      const reference = service._makeStorageReference(new Location(bucket, pathWithoutTrailingSlash));
      listResult.prefixes.push(reference);
    }
  }
  if (resource[ITEMS_KEY]) {
    for (const item of resource[ITEMS_KEY]) {
      const reference = service._makeStorageReference(new Location(bucket, item["name"]));
      listResult.items.push(reference);
    }
  }
  return listResult;
}
function fromResponseString(service, bucket, resourceString) {
  const obj = jsonObjectOrNull(resourceString);
  if (obj === null) {
    return null;
  }
  const resource = obj;
  return fromBackendResponse(service, bucket, resource);
}
var RequestInfo = class {
  constructor(url, method, handler, timeout) {
    this.url = url;
    this.method = method;
    this.handler = handler;
    this.timeout = timeout;
    this.urlParams = {};
    this.headers = {};
    this.body = null;
    this.errorHandler = null;
    this.progressCallback = null;
    this.successCodes = [200];
    this.additionalRetryCodes = [];
  }
};
function handlerCheck(cndn) {
  if (!cndn) {
    throw unknown();
  }
}
function metadataHandler(service, mappings) {
  function handler(xhr, text) {
    const metadata = fromResourceString(service, text, mappings);
    handlerCheck(metadata !== null);
    return metadata;
  }
  return handler;
}
function listHandler(service, bucket) {
  function handler(xhr, text) {
    const listResult = fromResponseString(service, bucket, text);
    handlerCheck(listResult !== null);
    return listResult;
  }
  return handler;
}
function downloadUrlHandler(service, mappings) {
  function handler(xhr, text) {
    const metadata = fromResourceString(service, text, mappings);
    handlerCheck(metadata !== null);
    return downloadUrlFromResourceString(metadata, text, service.host, service._protocol);
  }
  return handler;
}
function sharedErrorHandler(location) {
  function errorHandler(xhr, err) {
    let newErr;
    if (xhr.getStatus() === 401) {
      if (
        // This exact message string is the only consistent part of the
        // server's error response that identifies it as an App Check error.
        xhr.getErrorText().includes("Firebase App Check token is invalid")
      ) {
        newErr = unauthorizedApp();
      } else {
        newErr = unauthenticated();
      }
    } else {
      if (xhr.getStatus() === 402) {
        newErr = quotaExceeded(location.bucket);
      } else {
        if (xhr.getStatus() === 403) {
          newErr = unauthorized(location.path);
        } else {
          newErr = err;
        }
      }
    }
    newErr.status = xhr.getStatus();
    newErr.serverResponse = err.serverResponse;
    return newErr;
  }
  return errorHandler;
}
function objectErrorHandler(location) {
  const shared = sharedErrorHandler(location);
  function errorHandler(xhr, err) {
    let newErr = shared(xhr, err);
    if (xhr.getStatus() === 404) {
      newErr = objectNotFound(location.path);
    }
    newErr.serverResponse = err.serverResponse;
    return newErr;
  }
  return errorHandler;
}
function getMetadata$2(service, location, mappings) {
  const urlPart = location.fullServerUrl();
  const url = makeUrl(urlPart, service.host, service._protocol);
  const method = "GET";
  const timeout = service.maxOperationRetryTime;
  const requestInfo = new RequestInfo(url, method, metadataHandler(service, mappings), timeout);
  requestInfo.errorHandler = objectErrorHandler(location);
  return requestInfo;
}
function list$2(service, location, delimiter, pageToken, maxResults) {
  const urlParams = {};
  if (location.isRoot) {
    urlParams["prefix"] = "";
  } else {
    urlParams["prefix"] = location.path + "/";
  }
  if (delimiter && delimiter.length > 0) {
    urlParams["delimiter"] = delimiter;
  }
  if (pageToken) {
    urlParams["pageToken"] = pageToken;
  }
  if (maxResults) {
    urlParams["maxResults"] = maxResults;
  }
  const urlPart = location.bucketOnlyServerUrl();
  const url = makeUrl(urlPart, service.host, service._protocol);
  const method = "GET";
  const timeout = service.maxOperationRetryTime;
  const requestInfo = new RequestInfo(url, method, listHandler(service, location.bucket), timeout);
  requestInfo.urlParams = urlParams;
  requestInfo.errorHandler = sharedErrorHandler(location);
  return requestInfo;
}
function getDownloadUrl(service, location, mappings) {
  const urlPart = location.fullServerUrl();
  const url = makeUrl(urlPart, service.host, service._protocol);
  const method = "GET";
  const timeout = service.maxOperationRetryTime;
  const requestInfo = new RequestInfo(url, method, downloadUrlHandler(service, mappings), timeout);
  requestInfo.errorHandler = objectErrorHandler(location);
  return requestInfo;
}
function deleteObject$2(service, location) {
  const urlPart = location.fullServerUrl();
  const url = makeUrl(urlPart, service.host, service._protocol);
  const method = "DELETE";
  const timeout = service.maxOperationRetryTime;
  function handler(_xhr, _text) {
  }
  const requestInfo = new RequestInfo(url, method, handler, timeout);
  requestInfo.successCodes = [200, 204];
  requestInfo.errorHandler = objectErrorHandler(location);
  return requestInfo;
}
function determineContentType_(metadata, blob) {
  return metadata && metadata["contentType"] || blob && blob.type() || "application/octet-stream";
}
function metadataForUpload_(location, blob, metadata) {
  const metadataClone = Object.assign({}, metadata);
  metadataClone["fullPath"] = location.path;
  metadataClone["size"] = blob.size();
  if (!metadataClone["contentType"]) {
    metadataClone["contentType"] = determineContentType_(null, blob);
  }
  return metadataClone;
}
function multipartUpload(service, location, mappings, blob, metadata) {
  const urlPart = location.bucketOnlyServerUrl();
  const headers = {
    "X-Goog-Upload-Protocol": "multipart"
  };
  function genBoundary() {
    let str = "";
    for (let i = 0; i < 2; i++) {
      str = str + Math.random().toString().slice(2);
    }
    return str;
  }
  const boundary = genBoundary();
  headers["Content-Type"] = "multipart/related; boundary=" + boundary;
  const metadata_ = metadataForUpload_(location, blob, metadata);
  const metadataString = toResourceString(metadata_, mappings);
  const preBlobPart = "--" + boundary + "\r\nContent-Type: application/json; charset=utf-8\r\n\r\n" + metadataString + "\r\n--" + boundary + "\r\nContent-Type: " + metadata_["contentType"] + "\r\n\r\n";
  const postBlobPart = "\r\n--" + boundary + "--";
  const body = FbsBlob.getBlob(preBlobPart, blob, postBlobPart);
  if (body === null) {
    throw cannotSliceBlob();
  }
  const urlParams = { name: metadata_["fullPath"] };
  const url = makeUrl(urlPart, service.host, service._protocol);
  const method = "POST";
  const timeout = service.maxUploadRetryTime;
  const requestInfo = new RequestInfo(url, method, metadataHandler(service, mappings), timeout);
  requestInfo.urlParams = urlParams;
  requestInfo.headers = headers;
  requestInfo.body = body.uploadData();
  requestInfo.errorHandler = sharedErrorHandler(location);
  return requestInfo;
}
var ResumableUploadStatus = class {
  constructor(current, total, finalized, metadata) {
    this.current = current;
    this.total = total;
    this.finalized = !!finalized;
    this.metadata = metadata || null;
  }
};
function checkResumeHeader_(xhr, allowed) {
  let status = null;
  try {
    status = xhr.getResponseHeader("X-Goog-Upload-Status");
  } catch (e) {
    handlerCheck(false);
  }
  const allowedStatus = allowed || ["active"];
  handlerCheck(!!status && allowedStatus.indexOf(status) !== -1);
  return status;
}
function createResumableUpload(service, location, mappings, blob, metadata) {
  const urlPart = location.bucketOnlyServerUrl();
  const metadataForUpload = metadataForUpload_(location, blob, metadata);
  const urlParams = { name: metadataForUpload["fullPath"] };
  const url = makeUrl(urlPart, service.host, service._protocol);
  const method = "POST";
  const headers = {
    "X-Goog-Upload-Protocol": "resumable",
    "X-Goog-Upload-Command": "start",
    "X-Goog-Upload-Header-Content-Length": `${blob.size()}`,
    "X-Goog-Upload-Header-Content-Type": metadataForUpload["contentType"],
    "Content-Type": "application/json; charset=utf-8"
  };
  const body = toResourceString(metadataForUpload, mappings);
  const timeout = service.maxUploadRetryTime;
  function handler(xhr) {
    checkResumeHeader_(xhr);
    let url2;
    try {
      url2 = xhr.getResponseHeader("X-Goog-Upload-URL");
    } catch (e) {
      handlerCheck(false);
    }
    handlerCheck(isString(url2));
    return url2;
  }
  const requestInfo = new RequestInfo(url, method, handler, timeout);
  requestInfo.urlParams = urlParams;
  requestInfo.headers = headers;
  requestInfo.body = body;
  requestInfo.errorHandler = sharedErrorHandler(location);
  return requestInfo;
}
function getResumableUploadStatus(service, location, url, blob) {
  const headers = { "X-Goog-Upload-Command": "query" };
  function handler(xhr) {
    const status = checkResumeHeader_(xhr, ["active", "final"]);
    let sizeString = null;
    try {
      sizeString = xhr.getResponseHeader("X-Goog-Upload-Size-Received");
    } catch (e) {
      handlerCheck(false);
    }
    if (!sizeString) {
      handlerCheck(false);
    }
    const size = Number(sizeString);
    handlerCheck(!isNaN(size));
    return new ResumableUploadStatus(size, blob.size(), status === "final");
  }
  const method = "POST";
  const timeout = service.maxUploadRetryTime;
  const requestInfo = new RequestInfo(url, method, handler, timeout);
  requestInfo.headers = headers;
  requestInfo.errorHandler = sharedErrorHandler(location);
  return requestInfo;
}
var RESUMABLE_UPLOAD_CHUNK_SIZE = 256 * 1024;
function continueResumableUpload(location, service, url, blob, chunkSize, mappings, status, progressCallback) {
  const status_ = new ResumableUploadStatus(0, 0);
  if (status) {
    status_.current = status.current;
    status_.total = status.total;
  } else {
    status_.current = 0;
    status_.total = blob.size();
  }
  if (blob.size() !== status_.total) {
    throw serverFileWrongSize();
  }
  const bytesLeft = status_.total - status_.current;
  let bytesToUpload = bytesLeft;
  if (chunkSize > 0) {
    bytesToUpload = Math.min(bytesToUpload, chunkSize);
  }
  const startByte = status_.current;
  const endByte = startByte + bytesToUpload;
  let uploadCommand = "";
  if (bytesToUpload === 0) {
    uploadCommand = "finalize";
  } else if (bytesLeft === bytesToUpload) {
    uploadCommand = "upload, finalize";
  } else {
    uploadCommand = "upload";
  }
  const headers = {
    "X-Goog-Upload-Command": uploadCommand,
    "X-Goog-Upload-Offset": `${status_.current}`
  };
  const body = blob.slice(startByte, endByte);
  if (body === null) {
    throw cannotSliceBlob();
  }
  function handler(xhr, text) {
    const uploadStatus = checkResumeHeader_(xhr, ["active", "final"]);
    const newCurrent = status_.current + bytesToUpload;
    const size = blob.size();
    let metadata;
    if (uploadStatus === "final") {
      metadata = metadataHandler(service, mappings)(xhr, text);
    } else {
      metadata = null;
    }
    return new ResumableUploadStatus(newCurrent, size, uploadStatus === "final", metadata);
  }
  const method = "POST";
  const timeout = service.maxUploadRetryTime;
  const requestInfo = new RequestInfo(url, method, handler, timeout);
  requestInfo.headers = headers;
  requestInfo.body = body.uploadData();
  requestInfo.progressCallback = progressCallback || null;
  requestInfo.errorHandler = sharedErrorHandler(location);
  return requestInfo;
}
var TaskState = {
  /** The task is currently transferring data. */
  RUNNING: "running",
  /** The task was paused by the user. */
  PAUSED: "paused",
  /** The task completed successfully. */
  SUCCESS: "success",
  /** The task was canceled. */
  CANCELED: "canceled",
  /** The task failed with an error. */
  ERROR: "error"
};
function taskStateFromInternalTaskState(state) {
  switch (state) {
    case "running":
    case "pausing":
    case "canceling":
      return TaskState.RUNNING;
    case "paused":
      return TaskState.PAUSED;
    case "success":
      return TaskState.SUCCESS;
    case "canceled":
      return TaskState.CANCELED;
    case "error":
      return TaskState.ERROR;
    default:
      return TaskState.ERROR;
  }
}
var Observer = class {
  constructor(nextOrObserver, error, complete) {
    const asFunctions = isFunction(nextOrObserver) || error != null || complete != null;
    if (asFunctions) {
      this.next = nextOrObserver;
      this.error = error !== null && error !== void 0 ? error : void 0;
      this.complete = complete !== null && complete !== void 0 ? complete : void 0;
    } else {
      const observer = nextOrObserver;
      this.next = observer.next;
      this.error = observer.error;
      this.complete = observer.complete;
    }
  }
};
function async(f) {
  return (...argsToForward) => {
    Promise.resolve().then(() => f(...argsToForward));
  };
}
var textFactoryOverride = null;
var XhrConnection = class {
  constructor() {
    this.sent_ = false;
    this.xhr_ = new XMLHttpRequest();
    this.initXhr();
    this.errorCode_ = ErrorCode.NO_ERROR;
    this.sendPromise_ = new Promise((resolve) => {
      this.xhr_.addEventListener("abort", () => {
        this.errorCode_ = ErrorCode.ABORT;
        resolve();
      });
      this.xhr_.addEventListener("error", () => {
        this.errorCode_ = ErrorCode.NETWORK_ERROR;
        resolve();
      });
      this.xhr_.addEventListener("load", () => {
        resolve();
      });
    });
  }
  send(url, method, body, headers) {
    if (this.sent_) {
      throw internalError("cannot .send() more than once");
    }
    this.sent_ = true;
    this.xhr_.open(method, url, true);
    if (headers !== void 0) {
      for (const key in headers) {
        if (headers.hasOwnProperty(key)) {
          this.xhr_.setRequestHeader(key, headers[key].toString());
        }
      }
    }
    if (body !== void 0) {
      this.xhr_.send(body);
    } else {
      this.xhr_.send();
    }
    return this.sendPromise_;
  }
  getErrorCode() {
    if (!this.sent_) {
      throw internalError("cannot .getErrorCode() before sending");
    }
    return this.errorCode_;
  }
  getStatus() {
    if (!this.sent_) {
      throw internalError("cannot .getStatus() before sending");
    }
    try {
      return this.xhr_.status;
    } catch (e) {
      return -1;
    }
  }
  getResponse() {
    if (!this.sent_) {
      throw internalError("cannot .getResponse() before sending");
    }
    return this.xhr_.response;
  }
  getErrorText() {
    if (!this.sent_) {
      throw internalError("cannot .getErrorText() before sending");
    }
    return this.xhr_.statusText;
  }
  /** Aborts the request. */
  abort() {
    this.xhr_.abort();
  }
  getResponseHeader(header) {
    return this.xhr_.getResponseHeader(header);
  }
  addUploadProgressListener(listener) {
    if (this.xhr_.upload != null) {
      this.xhr_.upload.addEventListener("progress", listener);
    }
  }
  removeUploadProgressListener(listener) {
    if (this.xhr_.upload != null) {
      this.xhr_.upload.removeEventListener("progress", listener);
    }
  }
};
var XhrTextConnection = class extends XhrConnection {
  initXhr() {
    this.xhr_.responseType = "text";
  }
};
function newTextConnection() {
  return textFactoryOverride ? textFactoryOverride() : new XhrTextConnection();
}
var UploadTask = class {
  /**
   * @param ref - The firebaseStorage.Reference object this task came
   *     from, untyped to avoid cyclic dependencies.
   * @param blob - The blob to upload.
   */
  constructor(ref2, blob, metadata = null) {
    this._transferred = 0;
    this._needToFetchStatus = false;
    this._needToFetchMetadata = false;
    this._observers = [];
    this._error = void 0;
    this._uploadUrl = void 0;
    this._request = void 0;
    this._chunkMultiplier = 1;
    this._resolve = void 0;
    this._reject = void 0;
    this._ref = ref2;
    this._blob = blob;
    this._metadata = metadata;
    this._mappings = getMappings();
    this._resumable = this._shouldDoResumable(this._blob);
    this._state = "running";
    this._errorHandler = (error) => {
      this._request = void 0;
      this._chunkMultiplier = 1;
      if (error._codeEquals(StorageErrorCode.CANCELED)) {
        this._needToFetchStatus = true;
        this.completeTransitions_();
      } else {
        const backoffExpired = this.isExponentialBackoffExpired();
        if (isRetryStatusCode(error.status, [])) {
          if (backoffExpired) {
            error = retryLimitExceeded();
          } else {
            this.sleepTime = Math.max(this.sleepTime * 2, DEFAULT_MIN_SLEEP_TIME_MILLIS);
            this._needToFetchStatus = true;
            this.completeTransitions_();
            return;
          }
        }
        this._error = error;
        this._transition(
          "error"
          /* InternalTaskState.ERROR */
        );
      }
    };
    this._metadataErrorHandler = (error) => {
      this._request = void 0;
      if (error._codeEquals(StorageErrorCode.CANCELED)) {
        this.completeTransitions_();
      } else {
        this._error = error;
        this._transition(
          "error"
          /* InternalTaskState.ERROR */
        );
      }
    };
    this.sleepTime = 0;
    this.maxSleepTime = this._ref.storage.maxUploadRetryTime;
    this._promise = new Promise((resolve, reject) => {
      this._resolve = resolve;
      this._reject = reject;
      this._start();
    });
    this._promise.then(null, () => {
    });
  }
  isExponentialBackoffExpired() {
    return this.sleepTime > this.maxSleepTime;
  }
  _makeProgressCallback() {
    const sizeBefore = this._transferred;
    return (loaded) => this._updateProgress(sizeBefore + loaded);
  }
  _shouldDoResumable(blob) {
    return blob.size() > 256 * 1024;
  }
  _start() {
    if (this._state !== "running") {
      return;
    }
    if (this._request !== void 0) {
      return;
    }
    if (this._resumable) {
      if (this._uploadUrl === void 0) {
        this._createResumable();
      } else {
        if (this._needToFetchStatus) {
          this._fetchStatus();
        } else {
          if (this._needToFetchMetadata) {
            this._fetchMetadata();
          } else {
            this.pendingTimeout = setTimeout(() => {
              this.pendingTimeout = void 0;
              this._continueUpload();
            }, this.sleepTime);
          }
        }
      }
    } else {
      this._oneShotUpload();
    }
  }
  _resolveToken(callback) {
    Promise.all([
      this._ref.storage._getAuthToken(),
      this._ref.storage._getAppCheckToken()
    ]).then(([authToken, appCheckToken]) => {
      switch (this._state) {
        case "running":
          callback(authToken, appCheckToken);
          break;
        case "canceling":
          this._transition(
            "canceled"
            /* InternalTaskState.CANCELED */
          );
          break;
        case "pausing":
          this._transition(
            "paused"
            /* InternalTaskState.PAUSED */
          );
          break;
      }
    });
  }
  // TODO(andysoto): assert false
  _createResumable() {
    this._resolveToken((authToken, appCheckToken) => {
      const requestInfo = createResumableUpload(this._ref.storage, this._ref._location, this._mappings, this._blob, this._metadata);
      const createRequest = this._ref.storage._makeRequest(requestInfo, newTextConnection, authToken, appCheckToken);
      this._request = createRequest;
      createRequest.getPromise().then((url) => {
        this._request = void 0;
        this._uploadUrl = url;
        this._needToFetchStatus = false;
        this.completeTransitions_();
      }, this._errorHandler);
    });
  }
  _fetchStatus() {
    const url = this._uploadUrl;
    this._resolveToken((authToken, appCheckToken) => {
      const requestInfo = getResumableUploadStatus(this._ref.storage, this._ref._location, url, this._blob);
      const statusRequest = this._ref.storage._makeRequest(requestInfo, newTextConnection, authToken, appCheckToken);
      this._request = statusRequest;
      statusRequest.getPromise().then((status) => {
        status = status;
        this._request = void 0;
        this._updateProgress(status.current);
        this._needToFetchStatus = false;
        if (status.finalized) {
          this._needToFetchMetadata = true;
        }
        this.completeTransitions_();
      }, this._errorHandler);
    });
  }
  _continueUpload() {
    const chunkSize = RESUMABLE_UPLOAD_CHUNK_SIZE * this._chunkMultiplier;
    const status = new ResumableUploadStatus(this._transferred, this._blob.size());
    const url = this._uploadUrl;
    this._resolveToken((authToken, appCheckToken) => {
      let requestInfo;
      try {
        requestInfo = continueResumableUpload(this._ref._location, this._ref.storage, url, this._blob, chunkSize, this._mappings, status, this._makeProgressCallback());
      } catch (e) {
        this._error = e;
        this._transition(
          "error"
          /* InternalTaskState.ERROR */
        );
        return;
      }
      const uploadRequest = this._ref.storage._makeRequest(
        requestInfo,
        newTextConnection,
        authToken,
        appCheckToken,
        /*retry=*/
        false
        // Upload requests should not be retried as each retry should be preceded by another query request. Which is handled in this file.
      );
      this._request = uploadRequest;
      uploadRequest.getPromise().then((newStatus) => {
        this._increaseMultiplier();
        this._request = void 0;
        this._updateProgress(newStatus.current);
        if (newStatus.finalized) {
          this._metadata = newStatus.metadata;
          this._transition(
            "success"
            /* InternalTaskState.SUCCESS */
          );
        } else {
          this.completeTransitions_();
        }
      }, this._errorHandler);
    });
  }
  _increaseMultiplier() {
    const currentSize = RESUMABLE_UPLOAD_CHUNK_SIZE * this._chunkMultiplier;
    if (currentSize * 2 < 32 * 1024 * 1024) {
      this._chunkMultiplier *= 2;
    }
  }
  _fetchMetadata() {
    this._resolveToken((authToken, appCheckToken) => {
      const requestInfo = getMetadata$2(this._ref.storage, this._ref._location, this._mappings);
      const metadataRequest = this._ref.storage._makeRequest(requestInfo, newTextConnection, authToken, appCheckToken);
      this._request = metadataRequest;
      metadataRequest.getPromise().then((metadata) => {
        this._request = void 0;
        this._metadata = metadata;
        this._transition(
          "success"
          /* InternalTaskState.SUCCESS */
        );
      }, this._metadataErrorHandler);
    });
  }
  _oneShotUpload() {
    this._resolveToken((authToken, appCheckToken) => {
      const requestInfo = multipartUpload(this._ref.storage, this._ref._location, this._mappings, this._blob, this._metadata);
      const multipartRequest = this._ref.storage._makeRequest(requestInfo, newTextConnection, authToken, appCheckToken);
      this._request = multipartRequest;
      multipartRequest.getPromise().then((metadata) => {
        this._request = void 0;
        this._metadata = metadata;
        this._updateProgress(this._blob.size());
        this._transition(
          "success"
          /* InternalTaskState.SUCCESS */
        );
      }, this._errorHandler);
    });
  }
  _updateProgress(transferred) {
    const old = this._transferred;
    this._transferred = transferred;
    if (this._transferred !== old) {
      this._notifyObservers();
    }
  }
  _transition(state) {
    if (this._state === state) {
      return;
    }
    switch (state) {
      case "canceling":
      case "pausing":
        this._state = state;
        if (this._request !== void 0) {
          this._request.cancel();
        } else if (this.pendingTimeout) {
          clearTimeout(this.pendingTimeout);
          this.pendingTimeout = void 0;
          this.completeTransitions_();
        }
        break;
      case "running":
        const wasPaused = this._state === "paused";
        this._state = state;
        if (wasPaused) {
          this._notifyObservers();
          this._start();
        }
        break;
      case "paused":
        this._state = state;
        this._notifyObservers();
        break;
      case "canceled":
        this._error = canceled();
        this._state = state;
        this._notifyObservers();
        break;
      case "error":
        this._state = state;
        this._notifyObservers();
        break;
      case "success":
        this._state = state;
        this._notifyObservers();
        break;
    }
  }
  completeTransitions_() {
    switch (this._state) {
      case "pausing":
        this._transition(
          "paused"
          /* InternalTaskState.PAUSED */
        );
        break;
      case "canceling":
        this._transition(
          "canceled"
          /* InternalTaskState.CANCELED */
        );
        break;
      case "running":
        this._start();
        break;
    }
  }
  /**
   * A snapshot of the current task state.
   */
  get snapshot() {
    const externalState = taskStateFromInternalTaskState(this._state);
    return {
      bytesTransferred: this._transferred,
      totalBytes: this._blob.size(),
      state: externalState,
      metadata: this._metadata,
      task: this,
      ref: this._ref
    };
  }
  /**
   * Adds a callback for an event.
   * @param type - The type of event to listen for.
   * @param nextOrObserver -
   *     The `next` function, which gets called for each item in
   *     the event stream, or an observer object with some or all of these three
   *     properties (`next`, `error`, `complete`).
   * @param error - A function that gets called with a `StorageError`
   *     if the event stream ends due to an error.
   * @param completed - A function that gets called if the
   *     event stream ends normally.
   * @returns
   *     If only the event argument is passed, returns a function you can use to
   *     add callbacks (see the examples above). If more than just the event
   *     argument is passed, returns a function you can call to unregister the
   *     callbacks.
   */
  on(type, nextOrObserver, error, completed) {
    const observer = new Observer(nextOrObserver || void 0, error || void 0, completed || void 0);
    this._addObserver(observer);
    return () => {
      this._removeObserver(observer);
    };
  }
  /**
   * This object behaves like a Promise, and resolves with its snapshot data
   * when the upload completes.
   * @param onFulfilled - The fulfillment callback. Promise chaining works as normal.
   * @param onRejected - The rejection callback.
   */
  then(onFulfilled, onRejected) {
    return this._promise.then(onFulfilled, onRejected);
  }
  /**
   * Equivalent to calling `then(null, onRejected)`.
   */
  catch(onRejected) {
    return this.then(null, onRejected);
  }
  /**
   * Adds the given observer.
   */
  _addObserver(observer) {
    this._observers.push(observer);
    this._notifyObserver(observer);
  }
  /**
   * Removes the given observer.
   */
  _removeObserver(observer) {
    const i = this._observers.indexOf(observer);
    if (i !== -1) {
      this._observers.splice(i, 1);
    }
  }
  _notifyObservers() {
    this._finishPromise();
    const observers = this._observers.slice();
    observers.forEach((observer) => {
      this._notifyObserver(observer);
    });
  }
  _finishPromise() {
    if (this._resolve !== void 0) {
      let triggered = true;
      switch (taskStateFromInternalTaskState(this._state)) {
        case TaskState.SUCCESS:
          async(this._resolve.bind(null, this.snapshot))();
          break;
        case TaskState.CANCELED:
        case TaskState.ERROR:
          const toCall = this._reject;
          async(toCall.bind(null, this._error))();
          break;
        default:
          triggered = false;
          break;
      }
      if (triggered) {
        this._resolve = void 0;
        this._reject = void 0;
      }
    }
  }
  _notifyObserver(observer) {
    const externalState = taskStateFromInternalTaskState(this._state);
    switch (externalState) {
      case TaskState.RUNNING:
      case TaskState.PAUSED:
        if (observer.next) {
          async(observer.next.bind(observer, this.snapshot))();
        }
        break;
      case TaskState.SUCCESS:
        if (observer.complete) {
          async(observer.complete.bind(observer))();
        }
        break;
      case TaskState.CANCELED:
      case TaskState.ERROR:
        if (observer.error) {
          async(observer.error.bind(observer, this._error))();
        }
        break;
      default:
        if (observer.error) {
          async(observer.error.bind(observer, this._error))();
        }
    }
  }
  /**
   * Resumes a paused task. Has no effect on a currently running or failed task.
   * @returns True if the operation took effect, false if ignored.
   */
  resume() {
    const valid = this._state === "paused" || this._state === "pausing";
    if (valid) {
      this._transition(
        "running"
        /* InternalTaskState.RUNNING */
      );
    }
    return valid;
  }
  /**
   * Pauses a currently running task. Has no effect on a paused or failed task.
   * @returns True if the operation took effect, false if ignored.
   */
  pause() {
    const valid = this._state === "running";
    if (valid) {
      this._transition(
        "pausing"
        /* InternalTaskState.PAUSING */
      );
    }
    return valid;
  }
  /**
   * Cancels a currently running or paused task. Has no effect on a complete or
   * failed task.
   * @returns True if the operation took effect, false if ignored.
   */
  cancel() {
    const valid = this._state === "running" || this._state === "pausing";
    if (valid) {
      this._transition(
        "canceling"
        /* InternalTaskState.CANCELING */
      );
    }
    return valid;
  }
};
var Reference = class {
  constructor(_service, location) {
    this._service = _service;
    if (location instanceof Location) {
      this._location = location;
    } else {
      this._location = Location.makeFromUrl(location, _service.host);
    }
  }
  /**
   * Returns the URL for the bucket and path this object references,
   *     in the form gs://<bucket>/<object-path>
   * @override
   */
  toString() {
    return "gs://" + this._location.bucket + "/" + this._location.path;
  }
  _newRef(service, location) {
    return new Reference(service, location);
  }
  /**
   * A reference to the root of this object's bucket.
   */
  get root() {
    const location = new Location(this._location.bucket, "");
    return this._newRef(this._service, location);
  }
  /**
   * The name of the bucket containing this reference's object.
   */
  get bucket() {
    return this._location.bucket;
  }
  /**
   * The full path of this object.
   */
  get fullPath() {
    return this._location.path;
  }
  /**
   * The short name of this object, which is the last component of the full path.
   * For example, if fullPath is 'full/path/image.png', name is 'image.png'.
   */
  get name() {
    return lastComponent(this._location.path);
  }
  /**
   * The `StorageService` instance this `StorageReference` is associated with.
   */
  get storage() {
    return this._service;
  }
  /**
   * A `StorageReference` pointing to the parent location of this `StorageReference`, or null if
   * this reference is the root.
   */
  get parent() {
    const newPath = parent(this._location.path);
    if (newPath === null) {
      return null;
    }
    const location = new Location(this._location.bucket, newPath);
    return new Reference(this._service, location);
  }
  /**
   * Utility function to throw an error in methods that do not accept a root reference.
   */
  _throwIfRoot(name5) {
    if (this._location.path === "") {
      throw invalidRootOperation(name5);
    }
  }
};
function uploadBytesResumable$1(ref2, data, metadata) {
  ref2._throwIfRoot("uploadBytesResumable");
  return new UploadTask(ref2, new FbsBlob(data), metadata);
}
function listAll$1(ref2) {
  const accumulator = {
    prefixes: [],
    items: []
  };
  return listAllHelper(ref2, accumulator).then(() => accumulator);
}
async function listAllHelper(ref2, accumulator, pageToken) {
  const opt = {
    // maxResults is 1000 by default.
    pageToken
  };
  const nextPage = await list$1(ref2, opt);
  accumulator.prefixes.push(...nextPage.prefixes);
  accumulator.items.push(...nextPage.items);
  if (nextPage.nextPageToken != null) {
    await listAllHelper(ref2, accumulator, nextPage.nextPageToken);
  }
}
function list$1(ref2, options) {
  if (options != null) {
    if (typeof options.maxResults === "number") {
      validateNumber(
        "options.maxResults",
        /* minValue= */
        1,
        /* maxValue= */
        1e3,
        options.maxResults
      );
    }
  }
  const op = options || {};
  const requestInfo = list$2(
    ref2.storage,
    ref2._location,
    /*delimiter= */
    "/",
    op.pageToken,
    op.maxResults
  );
  return ref2.storage.makeRequestWithTokens(requestInfo, newTextConnection);
}
function getDownloadURL$1(ref2) {
  ref2._throwIfRoot("getDownloadURL");
  const requestInfo = getDownloadUrl(ref2.storage, ref2._location, getMappings());
  return ref2.storage.makeRequestWithTokens(requestInfo, newTextConnection).then((url) => {
    if (url === null) {
      throw noDownloadURL();
    }
    return url;
  });
}
function deleteObject$1(ref2) {
  ref2._throwIfRoot("deleteObject");
  const requestInfo = deleteObject$2(ref2.storage, ref2._location);
  return ref2.storage.makeRequestWithTokens(requestInfo, newTextConnection);
}
function _getChild$1(ref2, childPath) {
  const newPath = child(ref2._location.path, childPath);
  const location = new Location(ref2._location.bucket, newPath);
  return new Reference(ref2.storage, location);
}
function isUrl(path) {
  return /^[A-Za-z]+:\/\//.test(path);
}
function refFromURL(service, url) {
  return new Reference(service, url);
}
function refFromPath(ref2, path) {
  if (ref2 instanceof FirebaseStorageImpl) {
    const service = ref2;
    if (service._bucket == null) {
      throw noDefaultBucket();
    }
    const reference = new Reference(service, service._bucket);
    if (path != null) {
      return refFromPath(reference, path);
    } else {
      return reference;
    }
  } else {
    if (path !== void 0) {
      return _getChild$1(ref2, path);
    } else {
      return ref2;
    }
  }
}
function ref$1(serviceOrRef, pathOrUrl) {
  if (pathOrUrl && isUrl(pathOrUrl)) {
    if (serviceOrRef instanceof FirebaseStorageImpl) {
      return refFromURL(serviceOrRef, pathOrUrl);
    } else {
      throw invalidArgument("To use ref(service, url), the first argument must be a Storage instance.");
    }
  } else {
    return refFromPath(serviceOrRef, pathOrUrl);
  }
}
function extractBucket(host, config) {
  const bucketString = config === null || config === void 0 ? void 0 : config[CONFIG_STORAGE_BUCKET_KEY];
  if (bucketString == null) {
    return null;
  }
  return Location.makeFromBucketSpec(bucketString, host);
}
function connectStorageEmulator$1(storage2, host, port, options = {}) {
  storage2.host = `${host}:${port}`;
  storage2._protocol = "http";
  const { mockUserToken } = options;
  if (mockUserToken) {
    storage2._overrideAuthToken = typeof mockUserToken === "string" ? mockUserToken : createMockUserToken(mockUserToken, storage2.app.options.projectId);
  }
}
var FirebaseStorageImpl = class {
  constructor(app2, _authProvider, _appCheckProvider, _url, _firebaseVersion) {
    this.app = app2;
    this._authProvider = _authProvider;
    this._appCheckProvider = _appCheckProvider;
    this._url = _url;
    this._firebaseVersion = _firebaseVersion;
    this._bucket = null;
    this._host = DEFAULT_HOST;
    this._protocol = "https";
    this._appId = null;
    this._deleted = false;
    this._maxOperationRetryTime = DEFAULT_MAX_OPERATION_RETRY_TIME;
    this._maxUploadRetryTime = DEFAULT_MAX_UPLOAD_RETRY_TIME;
    this._requests = /* @__PURE__ */ new Set();
    if (_url != null) {
      this._bucket = Location.makeFromBucketSpec(_url, this._host);
    } else {
      this._bucket = extractBucket(this._host, this.app.options);
    }
  }
  /**
   * The host string for this service, in the form of `host` or
   * `host:port`.
   */
  get host() {
    return this._host;
  }
  set host(host) {
    this._host = host;
    if (this._url != null) {
      this._bucket = Location.makeFromBucketSpec(this._url, host);
    } else {
      this._bucket = extractBucket(host, this.app.options);
    }
  }
  /**
   * The maximum time to retry uploads in milliseconds.
   */
  get maxUploadRetryTime() {
    return this._maxUploadRetryTime;
  }
  set maxUploadRetryTime(time) {
    validateNumber(
      "time",
      /* minValue=*/
      0,
      /* maxValue= */
      Number.POSITIVE_INFINITY,
      time
    );
    this._maxUploadRetryTime = time;
  }
  /**
   * The maximum time to retry operations other than uploads or downloads in
   * milliseconds.
   */
  get maxOperationRetryTime() {
    return this._maxOperationRetryTime;
  }
  set maxOperationRetryTime(time) {
    validateNumber(
      "time",
      /* minValue=*/
      0,
      /* maxValue= */
      Number.POSITIVE_INFINITY,
      time
    );
    this._maxOperationRetryTime = time;
  }
  async _getAuthToken() {
    if (this._overrideAuthToken) {
      return this._overrideAuthToken;
    }
    const auth2 = this._authProvider.getImmediate({ optional: true });
    if (auth2) {
      const tokenData = await auth2.getToken();
      if (tokenData !== null) {
        return tokenData.accessToken;
      }
    }
    return null;
  }
  async _getAppCheckToken() {
    const appCheck = this._appCheckProvider.getImmediate({ optional: true });
    if (appCheck) {
      const result = await appCheck.getToken();
      return result.token;
    }
    return null;
  }
  /**
   * Stop running requests and prevent more from being created.
   */
  _delete() {
    if (!this._deleted) {
      this._deleted = true;
      this._requests.forEach((request) => request.cancel());
      this._requests.clear();
    }
    return Promise.resolve();
  }
  /**
   * Returns a new firebaseStorage.Reference object referencing this StorageService
   * at the given Location.
   */
  _makeStorageReference(loc) {
    return new Reference(this, loc);
  }
  /**
   * @param requestInfo - HTTP RequestInfo object
   * @param authToken - Firebase auth token
   */
  _makeRequest(requestInfo, requestFactory, authToken, appCheckToken, retry = true) {
    if (!this._deleted) {
      const request = makeRequest(requestInfo, this._appId, authToken, appCheckToken, requestFactory, this._firebaseVersion, retry);
      this._requests.add(request);
      request.getPromise().then(() => this._requests.delete(request), () => this._requests.delete(request));
      return request;
    } else {
      return new FailRequest(appDeleted());
    }
  }
  async makeRequestWithTokens(requestInfo, requestFactory) {
    const [authToken, appCheckToken] = await Promise.all([
      this._getAuthToken(),
      this._getAppCheckToken()
    ]);
    return this._makeRequest(requestInfo, requestFactory, authToken, appCheckToken).getPromise();
  }
};
var name2 = "@firebase/storage";
var version2 = "0.11.2";
var STORAGE_TYPE = "storage";
function uploadBytesResumable(ref2, data, metadata) {
  ref2 = getModularInstance(ref2);
  return uploadBytesResumable$1(ref2, data, metadata);
}
function listAll(ref2) {
  ref2 = getModularInstance(ref2);
  return listAll$1(ref2);
}
function getDownloadURL(ref2) {
  ref2 = getModularInstance(ref2);
  return getDownloadURL$1(ref2);
}
function deleteObject(ref2) {
  ref2 = getModularInstance(ref2);
  return deleteObject$1(ref2);
}
function ref(serviceOrRef, pathOrUrl) {
  serviceOrRef = getModularInstance(serviceOrRef);
  return ref$1(serviceOrRef, pathOrUrl);
}
function getStorage(app2 = getApp(), bucketUrl) {
  app2 = getModularInstance(app2);
  const storageProvider = _getProvider(app2, STORAGE_TYPE);
  const storageInstance = storageProvider.getImmediate({
    identifier: bucketUrl
  });
  const emulator = getDefaultEmulatorHostnameAndPort("storage");
  if (emulator) {
    connectStorageEmulator(storageInstance, ...emulator);
  }
  return storageInstance;
}
function connectStorageEmulator(storage2, host, port, options = {}) {
  connectStorageEmulator$1(storage2, host, port, options);
}
function factory(container, { instanceIdentifier: url }) {
  const app2 = container.getProvider("app").getImmediate();
  const authProvider = container.getProvider("auth-internal");
  const appCheckProvider = container.getProvider("app-check-internal");
  return new FirebaseStorageImpl(app2, authProvider, appCheckProvider, url, SDK_VERSION);
}
function registerStorage() {
  _registerComponent(new Component(
    STORAGE_TYPE,
    factory,
    "PUBLIC"
    /* ComponentType.PUBLIC */
  ).setMultipleInstances(true));
  registerVersion(name2, version2, "");
  registerVersion(name2, version2, "esm2017");
}
registerStorage();

// datatools.ts
var import_obsidian = require("obsidian");

// node_modules/firebase/app/dist/esm/index.esm.js
var name3 = "firebase";
var version3 = "10.1.0";
registerVersion(name3, version3, "app");

// node_modules/tslib/tslib.es6.js
function __rest(s, e) {
  var t = {};
  for (var p in s)
    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
      t[p] = s[p];
  if (s != null && typeof Object.getOwnPropertySymbols === "function")
    for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
        t[p[i]] = s[p[i]];
    }
  return t;
}

// node_modules/@firebase/auth/dist/esm2017/index-e24386e7.js
function _prodErrorMap() {
  return {
    [
      "dependent-sdk-initialized-before-auth"
      /* AuthErrorCode.DEPENDENT_SDK_INIT_BEFORE_AUTH */
    ]: "Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."
  };
}
var prodErrorMap = _prodErrorMap;
var _DEFAULT_AUTH_ERROR_FACTORY = new ErrorFactory("auth", "Firebase", _prodErrorMap());
var logClient = new Logger("@firebase/auth");
function _logWarn(msg, ...args) {
  if (logClient.logLevel <= LogLevel.WARN) {
    logClient.warn(`Auth (${SDK_VERSION}): ${msg}`, ...args);
  }
}
function _logError(msg, ...args) {
  if (logClient.logLevel <= LogLevel.ERROR) {
    logClient.error(`Auth (${SDK_VERSION}): ${msg}`, ...args);
  }
}
function _fail(authOrCode, ...rest) {
  throw createErrorInternal(authOrCode, ...rest);
}
function _createError(authOrCode, ...rest) {
  return createErrorInternal(authOrCode, ...rest);
}
function _errorWithCustomMessage(auth2, code, message) {
  const errorMap = Object.assign(Object.assign({}, prodErrorMap()), { [code]: message });
  const factory2 = new ErrorFactory("auth", "Firebase", errorMap);
  return factory2.create(code, {
    appName: auth2.name
  });
}
function _assertInstanceOf(auth2, object, instance) {
  const constructorInstance = instance;
  if (!(object instanceof constructorInstance)) {
    if (constructorInstance.name !== object.constructor.name) {
      _fail(
        auth2,
        "argument-error"
        /* AuthErrorCode.ARGUMENT_ERROR */
      );
    }
    throw _errorWithCustomMessage(auth2, "argument-error", `Type of ${object.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`);
  }
}
function createErrorInternal(authOrCode, ...rest) {
  if (typeof authOrCode !== "string") {
    const code = rest[0];
    const fullParams = [...rest.slice(1)];
    if (fullParams[0]) {
      fullParams[0].appName = authOrCode.name;
    }
    return authOrCode._errorFactory.create(code, ...fullParams);
  }
  return _DEFAULT_AUTH_ERROR_FACTORY.create(authOrCode, ...rest);
}
function _assert(assertion, authOrCode, ...rest) {
  if (!assertion) {
    throw createErrorInternal(authOrCode, ...rest);
  }
}
function debugFail(failure) {
  const message = `INTERNAL ASSERTION FAILED: ` + failure;
  _logError(message);
  throw new Error(message);
}
function debugAssert(assertion, message) {
  if (!assertion) {
    debugFail(message);
  }
}
function _getCurrentUrl() {
  var _a;
  return typeof self !== "undefined" && ((_a = self.location) === null || _a === void 0 ? void 0 : _a.href) || "";
}
function _isHttpOrHttps() {
  return _getCurrentScheme() === "http:" || _getCurrentScheme() === "https:";
}
function _getCurrentScheme() {
  var _a;
  return typeof self !== "undefined" && ((_a = self.location) === null || _a === void 0 ? void 0 : _a.protocol) || null;
}
function _isOnline() {
  if (typeof navigator !== "undefined" && navigator && "onLine" in navigator && typeof navigator.onLine === "boolean" && // Apply only for traditional web apps and Chrome extensions.
  // This is especially true for Cordova apps which have unreliable
  // navigator.onLine behavior unless cordova-plugin-network-information is
  // installed which overwrites the native navigator.onLine value and
  // defines navigator.connection.
  (_isHttpOrHttps() || isBrowserExtension() || "connection" in navigator)) {
    return navigator.onLine;
  }
  return true;
}
function _getUserLanguage() {
  if (typeof navigator === "undefined") {
    return null;
  }
  const navigatorLanguage = navigator;
  return (
    // Most reliable, but only supported in Chrome/Firefox.
    navigatorLanguage.languages && navigatorLanguage.languages[0] || // Supported in most browsers, but returns the language of the browser
    // UI, not the language set in browser settings.
    navigatorLanguage.language || // Couldn't determine language.
    null
  );
}
var Delay = class {
  constructor(shortDelay, longDelay) {
    this.shortDelay = shortDelay;
    this.longDelay = longDelay;
    debugAssert(longDelay > shortDelay, "Short delay should be less than long delay!");
    this.isMobile = isMobileCordova() || isReactNative();
  }
  get() {
    if (!_isOnline()) {
      return Math.min(5e3, this.shortDelay);
    }
    return this.isMobile ? this.longDelay : this.shortDelay;
  }
};
function _emulatorUrl(config, path) {
  debugAssert(config.emulator, "Emulator should always be set here");
  const { url } = config.emulator;
  if (!path) {
    return url;
  }
  return `${url}${path.startsWith("/") ? path.slice(1) : path}`;
}
var FetchProvider = class {
  static initialize(fetchImpl, headersImpl, responseImpl) {
    this.fetchImpl = fetchImpl;
    if (headersImpl) {
      this.headersImpl = headersImpl;
    }
    if (responseImpl) {
      this.responseImpl = responseImpl;
    }
  }
  static fetch() {
    if (this.fetchImpl) {
      return this.fetchImpl;
    }
    if (typeof self !== "undefined" && "fetch" in self) {
      return self.fetch;
    }
    debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill");
  }
  static headers() {
    if (this.headersImpl) {
      return this.headersImpl;
    }
    if (typeof self !== "undefined" && "Headers" in self) {
      return self.Headers;
    }
    debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill");
  }
  static response() {
    if (this.responseImpl) {
      return this.responseImpl;
    }
    if (typeof self !== "undefined" && "Response" in self) {
      return self.Response;
    }
    debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill");
  }
};
var SERVER_ERROR_MAP = {
  // Custom token errors.
  [
    "CREDENTIAL_MISMATCH"
    /* ServerError.CREDENTIAL_MISMATCH */
  ]: "custom-token-mismatch",
  // This can only happen if the SDK sends a bad request.
  [
    "MISSING_CUSTOM_TOKEN"
    /* ServerError.MISSING_CUSTOM_TOKEN */
  ]: "internal-error",
  // Create Auth URI errors.
  [
    "INVALID_IDENTIFIER"
    /* ServerError.INVALID_IDENTIFIER */
  ]: "invalid-email",
  // This can only happen if the SDK sends a bad request.
  [
    "MISSING_CONTINUE_URI"
    /* ServerError.MISSING_CONTINUE_URI */
  ]: "internal-error",
  // Sign in with email and password errors (some apply to sign up too).
  [
    "INVALID_PASSWORD"
    /* ServerError.INVALID_PASSWORD */
  ]: "wrong-password",
  // This can only happen if the SDK sends a bad request.
  [
    "MISSING_PASSWORD"
    /* ServerError.MISSING_PASSWORD */
  ]: "missing-password",
  // Sign up with email and password errors.
  [
    "EMAIL_EXISTS"
    /* ServerError.EMAIL_EXISTS */
  ]: "email-already-in-use",
  [
    "PASSWORD_LOGIN_DISABLED"
    /* ServerError.PASSWORD_LOGIN_DISABLED */
  ]: "operation-not-allowed",
  // Verify assertion for sign in with credential errors:
  [
    "INVALID_IDP_RESPONSE"
    /* ServerError.INVALID_IDP_RESPONSE */
  ]: "invalid-credential",
  [
    "INVALID_PENDING_TOKEN"
    /* ServerError.INVALID_PENDING_TOKEN */
  ]: "invalid-credential",
  [
    "FEDERATED_USER_ID_ALREADY_LINKED"
    /* ServerError.FEDERATED_USER_ID_ALREADY_LINKED */
  ]: "credential-already-in-use",
  // This can only happen if the SDK sends a bad request.
  [
    "MISSING_REQ_TYPE"
    /* ServerError.MISSING_REQ_TYPE */
  ]: "internal-error",
  // Send Password reset email errors:
  [
    "EMAIL_NOT_FOUND"
    /* ServerError.EMAIL_NOT_FOUND */
  ]: "user-not-found",
  [
    "RESET_PASSWORD_EXCEED_LIMIT"
    /* ServerError.RESET_PASSWORD_EXCEED_LIMIT */
  ]: "too-many-requests",
  [
    "EXPIRED_OOB_CODE"
    /* ServerError.EXPIRED_OOB_CODE */
  ]: "expired-action-code",
  [
    "INVALID_OOB_CODE"
    /* ServerError.INVALID_OOB_CODE */
  ]: "invalid-action-code",
  // This can only happen if the SDK sends a bad request.
  [
    "MISSING_OOB_CODE"
    /* ServerError.MISSING_OOB_CODE */
  ]: "internal-error",
  // Operations that require ID token in request:
  [
    "CREDENTIAL_TOO_OLD_LOGIN_AGAIN"
    /* ServerError.CREDENTIAL_TOO_OLD_LOGIN_AGAIN */
  ]: "requires-recent-login",
  [
    "INVALID_ID_TOKEN"
    /* ServerError.INVALID_ID_TOKEN */
  ]: "invalid-user-token",
  [
    "TOKEN_EXPIRED"
    /* ServerError.TOKEN_EXPIRED */
  ]: "user-token-expired",
  [
    "USER_NOT_FOUND"
    /* ServerError.USER_NOT_FOUND */
  ]: "user-token-expired",
  // Other errors.
  [
    "TOO_MANY_ATTEMPTS_TRY_LATER"
    /* ServerError.TOO_MANY_ATTEMPTS_TRY_LATER */
  ]: "too-many-requests",
  // Phone Auth related errors.
  [
    "INVALID_CODE"
    /* ServerError.INVALID_CODE */
  ]: "invalid-verification-code",
  [
    "INVALID_SESSION_INFO"
    /* ServerError.INVALID_SESSION_INFO */
  ]: "invalid-verification-id",
  [
    "INVALID_TEMPORARY_PROOF"
    /* ServerError.INVALID_TEMPORARY_PROOF */
  ]: "invalid-credential",
  [
    "MISSING_SESSION_INFO"
    /* ServerError.MISSING_SESSION_INFO */
  ]: "missing-verification-id",
  [
    "SESSION_EXPIRED"
    /* ServerError.SESSION_EXPIRED */
  ]: "code-expired",
  // Other action code errors when additional settings passed.
  // MISSING_CONTINUE_URI is getting mapped to INTERNAL_ERROR above.
  // This is OK as this error will be caught by client side validation.
  [
    "MISSING_ANDROID_PACKAGE_NAME"
    /* ServerError.MISSING_ANDROID_PACKAGE_NAME */
  ]: "missing-android-pkg-name",
  [
    "UNAUTHORIZED_DOMAIN"
    /* ServerError.UNAUTHORIZED_DOMAIN */
  ]: "unauthorized-continue-uri",
  // getProjectConfig errors when clientId is passed.
  [
    "INVALID_OAUTH_CLIENT_ID"
    /* ServerError.INVALID_OAUTH_CLIENT_ID */
  ]: "invalid-oauth-client-id",
  // User actions (sign-up or deletion) disabled errors.
  [
    "ADMIN_ONLY_OPERATION"
    /* ServerError.ADMIN_ONLY_OPERATION */
  ]: "admin-restricted-operation",
  // Multi factor related errors.
  [
    "INVALID_MFA_PENDING_CREDENTIAL"
    /* ServerError.INVALID_MFA_PENDING_CREDENTIAL */
  ]: "invalid-multi-factor-session",
  [
    "MFA_ENROLLMENT_NOT_FOUND"
    /* ServerError.MFA_ENROLLMENT_NOT_FOUND */
  ]: "multi-factor-info-not-found",
  [
    "MISSING_MFA_ENROLLMENT_ID"
    /* ServerError.MISSING_MFA_ENROLLMENT_ID */
  ]: "missing-multi-factor-info",
  [
    "MISSING_MFA_PENDING_CREDENTIAL"
    /* ServerError.MISSING_MFA_PENDING_CREDENTIAL */
  ]: "missing-multi-factor-session",
  [
    "SECOND_FACTOR_EXISTS"
    /* ServerError.SECOND_FACTOR_EXISTS */
  ]: "second-factor-already-in-use",
  [
    "SECOND_FACTOR_LIMIT_EXCEEDED"
    /* ServerError.SECOND_FACTOR_LIMIT_EXCEEDED */
  ]: "maximum-second-factor-count-exceeded",
  // Blocking functions related errors.
  [
    "BLOCKING_FUNCTION_ERROR_RESPONSE"
    /* ServerError.BLOCKING_FUNCTION_ERROR_RESPONSE */
  ]: "internal-error",
  // Recaptcha related errors.
  [
    "RECAPTCHA_NOT_ENABLED"
    /* ServerError.RECAPTCHA_NOT_ENABLED */
  ]: "recaptcha-not-enabled",
  [
    "MISSING_RECAPTCHA_TOKEN"
    /* ServerError.MISSING_RECAPTCHA_TOKEN */
  ]: "missing-recaptcha-token",
  [
    "INVALID_RECAPTCHA_TOKEN"
    /* ServerError.INVALID_RECAPTCHA_TOKEN */
  ]: "invalid-recaptcha-token",
  [
    "INVALID_RECAPTCHA_ACTION"
    /* ServerError.INVALID_RECAPTCHA_ACTION */
  ]: "invalid-recaptcha-action",
  [
    "MISSING_CLIENT_TYPE"
    /* ServerError.MISSING_CLIENT_TYPE */
  ]: "missing-client-type",
  [
    "MISSING_RECAPTCHA_VERSION"
    /* ServerError.MISSING_RECAPTCHA_VERSION */
  ]: "missing-recaptcha-version",
  [
    "INVALID_RECAPTCHA_VERSION"
    /* ServerError.INVALID_RECAPTCHA_VERSION */
  ]: "invalid-recaptcha-version",
  [
    "INVALID_REQ_TYPE"
    /* ServerError.INVALID_REQ_TYPE */
  ]: "invalid-req-type"
  /* AuthErrorCode.INVALID_REQ_TYPE */
};
var DEFAULT_API_TIMEOUT_MS = new Delay(3e4, 6e4);
function _addTidIfNecessary(auth2, request) {
  if (auth2.tenantId && !request.tenantId) {
    return Object.assign(Object.assign({}, request), { tenantId: auth2.tenantId });
  }
  return request;
}
async function _performApiRequest(auth2, method, path, request, customErrorMap = {}) {
  return _performFetchWithErrorHandling(auth2, customErrorMap, async () => {
    let body = {};
    let params = {};
    if (request) {
      if (method === "GET") {
        params = request;
      } else {
        body = {
          body: JSON.stringify(request)
        };
      }
    }
    const query = querystring(Object.assign({ key: auth2.config.apiKey }, params)).slice(1);
    const headers = await auth2._getAdditionalHeaders();
    headers[
      "Content-Type"
      /* HttpHeader.CONTENT_TYPE */
    ] = "application/json";
    if (auth2.languageCode) {
      headers[
        "X-Firebase-Locale"
        /* HttpHeader.X_FIREBASE_LOCALE */
      ] = auth2.languageCode;
    }
    return FetchProvider.fetch()(_getFinalTarget(auth2, auth2.config.apiHost, path, query), Object.assign({
      method,
      headers,
      referrerPolicy: "no-referrer"
    }, body));
  });
}
async function _performFetchWithErrorHandling(auth2, customErrorMap, fetchFn) {
  auth2._canInitEmulator = false;
  const errorMap = Object.assign(Object.assign({}, SERVER_ERROR_MAP), customErrorMap);
  try {
    const networkTimeout = new NetworkTimeout(auth2);
    const response = await Promise.race([
      fetchFn(),
      networkTimeout.promise
    ]);
    networkTimeout.clearNetworkTimeout();
    const json = await response.json();
    if ("needConfirmation" in json) {
      throw _makeTaggedError(auth2, "account-exists-with-different-credential", json);
    }
    if (response.ok && !("errorMessage" in json)) {
      return json;
    } else {
      const errorMessage = response.ok ? json.errorMessage : json.error.message;
      const [serverErrorCode, serverErrorMessage] = errorMessage.split(" : ");
      if (serverErrorCode === "FEDERATED_USER_ID_ALREADY_LINKED") {
        throw _makeTaggedError(auth2, "credential-already-in-use", json);
      } else if (serverErrorCode === "EMAIL_EXISTS") {
        throw _makeTaggedError(auth2, "email-already-in-use", json);
      } else if (serverErrorCode === "USER_DISABLED") {
        throw _makeTaggedError(auth2, "user-disabled", json);
      }
      const authError = errorMap[serverErrorCode] || serverErrorCode.toLowerCase().replace(/[_\s]+/g, "-");
      if (serverErrorMessage) {
        throw _errorWithCustomMessage(auth2, authError, serverErrorMessage);
      } else {
        _fail(auth2, authError);
      }
    }
  } catch (e) {
    if (e instanceof FirebaseError) {
      throw e;
    }
    _fail(auth2, "network-request-failed", { "message": String(e) });
  }
}
async function _performSignInRequest(auth2, method, path, request, customErrorMap = {}) {
  const serverResponse = await _performApiRequest(auth2, method, path, request, customErrorMap);
  if ("mfaPendingCredential" in serverResponse) {
    _fail(auth2, "multi-factor-auth-required", {
      _serverResponse: serverResponse
    });
  }
  return serverResponse;
}
function _getFinalTarget(auth2, host, path, query) {
  const base = `${host}${path}?${query}`;
  if (!auth2.config.emulator) {
    return `${auth2.config.apiScheme}://${base}`;
  }
  return _emulatorUrl(auth2.config, base);
}
var NetworkTimeout = class {
  constructor(auth2) {
    this.auth = auth2;
    this.timer = null;
    this.promise = new Promise((_, reject) => {
      this.timer = setTimeout(() => {
        return reject(_createError(
          this.auth,
          "network-request-failed"
          /* AuthErrorCode.NETWORK_REQUEST_FAILED */
        ));
      }, DEFAULT_API_TIMEOUT_MS.get());
    });
  }
  clearNetworkTimeout() {
    clearTimeout(this.timer);
  }
};
function _makeTaggedError(auth2, code, response) {
  const errorParams = {
    appName: auth2.name
  };
  if (response.email) {
    errorParams.email = response.email;
  }
  if (response.phoneNumber) {
    errorParams.phoneNumber = response.phoneNumber;
  }
  const error = _createError(auth2, code, errorParams);
  error.customData._tokenResponse = response;
  return error;
}
async function deleteAccount(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v1/accounts:delete", request);
}
async function getAccountInfo(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v1/accounts:lookup", request);
}
function utcTimestampToDateString(utcTimestamp) {
  if (!utcTimestamp) {
    return void 0;
  }
  try {
    const date = new Date(Number(utcTimestamp));
    if (!isNaN(date.getTime())) {
      return date.toUTCString();
    }
  } catch (e) {
  }
  return void 0;
}
async function getIdTokenResult(user, forceRefresh = false) {
  const userInternal = getModularInstance(user);
  const token = await userInternal.getIdToken(forceRefresh);
  const claims = _parseToken(token);
  _assert(
    claims && claims.exp && claims.auth_time && claims.iat,
    userInternal.auth,
    "internal-error"
    /* AuthErrorCode.INTERNAL_ERROR */
  );
  const firebase = typeof claims.firebase === "object" ? claims.firebase : void 0;
  const signInProvider = firebase === null || firebase === void 0 ? void 0 : firebase["sign_in_provider"];
  return {
    claims,
    token,
    authTime: utcTimestampToDateString(secondsStringToMilliseconds(claims.auth_time)),
    issuedAtTime: utcTimestampToDateString(secondsStringToMilliseconds(claims.iat)),
    expirationTime: utcTimestampToDateString(secondsStringToMilliseconds(claims.exp)),
    signInProvider: signInProvider || null,
    signInSecondFactor: (firebase === null || firebase === void 0 ? void 0 : firebase["sign_in_second_factor"]) || null
  };
}
function secondsStringToMilliseconds(seconds) {
  return Number(seconds) * 1e3;
}
function _parseToken(token) {
  const [algorithm, payload, signature] = token.split(".");
  if (algorithm === void 0 || payload === void 0 || signature === void 0) {
    _logError("JWT malformed, contained fewer than 3 sections");
    return null;
  }
  try {
    const decoded = base64Decode(payload);
    if (!decoded) {
      _logError("Failed to decode base64 JWT payload");
      return null;
    }
    return JSON.parse(decoded);
  } catch (e) {
    _logError("Caught error parsing JWT payload as JSON", e === null || e === void 0 ? void 0 : e.toString());
    return null;
  }
}
function _tokenExpiresIn(token) {
  const parsedToken = _parseToken(token);
  _assert(
    parsedToken,
    "internal-error"
    /* AuthErrorCode.INTERNAL_ERROR */
  );
  _assert(
    typeof parsedToken.exp !== "undefined",
    "internal-error"
    /* AuthErrorCode.INTERNAL_ERROR */
  );
  _assert(
    typeof parsedToken.iat !== "undefined",
    "internal-error"
    /* AuthErrorCode.INTERNAL_ERROR */
  );
  return Number(parsedToken.exp) - Number(parsedToken.iat);
}
async function _logoutIfInvalidated(user, promise, bypassAuthState = false) {
  if (bypassAuthState) {
    return promise;
  }
  try {
    return await promise;
  } catch (e) {
    if (e instanceof FirebaseError && isUserInvalidated(e)) {
      if (user.auth.currentUser === user) {
        await user.auth.signOut();
      }
    }
    throw e;
  }
}
function isUserInvalidated({ code }) {
  return code === `auth/${"user-disabled"}` || code === `auth/${"user-token-expired"}`;
}
var ProactiveRefresh = class {
  constructor(user) {
    this.user = user;
    this.isRunning = false;
    this.timerId = null;
    this.errorBackoff = 3e4;
  }
  _start() {
    if (this.isRunning) {
      return;
    }
    this.isRunning = true;
    this.schedule();
  }
  _stop() {
    if (!this.isRunning) {
      return;
    }
    this.isRunning = false;
    if (this.timerId !== null) {
      clearTimeout(this.timerId);
    }
  }
  getInterval(wasError) {
    var _a;
    if (wasError) {
      const interval = this.errorBackoff;
      this.errorBackoff = Math.min(
        this.errorBackoff * 2,
        96e4
        /* Duration.RETRY_BACKOFF_MAX */
      );
      return interval;
    } else {
      this.errorBackoff = 3e4;
      const expTime = (_a = this.user.stsTokenManager.expirationTime) !== null && _a !== void 0 ? _a : 0;
      const interval = expTime - Date.now() - 3e5;
      return Math.max(0, interval);
    }
  }
  schedule(wasError = false) {
    if (!this.isRunning) {
      return;
    }
    const interval = this.getInterval(wasError);
    this.timerId = setTimeout(async () => {
      await this.iteration();
    }, interval);
  }
  async iteration() {
    try {
      await this.user.getIdToken(true);
    } catch (e) {
      if ((e === null || e === void 0 ? void 0 : e.code) === `auth/${"network-request-failed"}`) {
        this.schedule(
          /* wasError */
          true
        );
      }
      return;
    }
    this.schedule();
  }
};
var UserMetadata = class {
  constructor(createdAt, lastLoginAt) {
    this.createdAt = createdAt;
    this.lastLoginAt = lastLoginAt;
    this._initializeTime();
  }
  _initializeTime() {
    this.lastSignInTime = utcTimestampToDateString(this.lastLoginAt);
    this.creationTime = utcTimestampToDateString(this.createdAt);
  }
  _copy(metadata) {
    this.createdAt = metadata.createdAt;
    this.lastLoginAt = metadata.lastLoginAt;
    this._initializeTime();
  }
  toJSON() {
    return {
      createdAt: this.createdAt,
      lastLoginAt: this.lastLoginAt
    };
  }
};
async function _reloadWithoutSaving(user) {
  var _a;
  const auth2 = user.auth;
  const idToken = await user.getIdToken();
  const response = await _logoutIfInvalidated(user, getAccountInfo(auth2, { idToken }));
  _assert(
    response === null || response === void 0 ? void 0 : response.users.length,
    auth2,
    "internal-error"
    /* AuthErrorCode.INTERNAL_ERROR */
  );
  const coreAccount = response.users[0];
  user._notifyReloadListener(coreAccount);
  const newProviderData = ((_a = coreAccount.providerUserInfo) === null || _a === void 0 ? void 0 : _a.length) ? extractProviderData(coreAccount.providerUserInfo) : [];
  const providerData = mergeProviderData(user.providerData, newProviderData);
  const oldIsAnonymous = user.isAnonymous;
  const newIsAnonymous = !(user.email && coreAccount.passwordHash) && !(providerData === null || providerData === void 0 ? void 0 : providerData.length);
  const isAnonymous = !oldIsAnonymous ? false : newIsAnonymous;
  const updates = {
    uid: coreAccount.localId,
    displayName: coreAccount.displayName || null,
    photoURL: coreAccount.photoUrl || null,
    email: coreAccount.email || null,
    emailVerified: coreAccount.emailVerified || false,
    phoneNumber: coreAccount.phoneNumber || null,
    tenantId: coreAccount.tenantId || null,
    providerData,
    metadata: new UserMetadata(coreAccount.createdAt, coreAccount.lastLoginAt),
    isAnonymous
  };
  Object.assign(user, updates);
}
async function reload(user) {
  const userInternal = getModularInstance(user);
  await _reloadWithoutSaving(userInternal);
  await userInternal.auth._persistUserIfCurrent(userInternal);
  userInternal.auth._notifyListenersIfCurrent(userInternal);
}
function mergeProviderData(original, newData) {
  const deduped = original.filter((o) => !newData.some((n) => n.providerId === o.providerId));
  return [...deduped, ...newData];
}
function extractProviderData(providers) {
  return providers.map((_a) => {
    var { providerId } = _a, provider2 = __rest(_a, ["providerId"]);
    return {
      providerId,
      uid: provider2.rawId || "",
      displayName: provider2.displayName || null,
      email: provider2.email || null,
      phoneNumber: provider2.phoneNumber || null,
      photoURL: provider2.photoUrl || null
    };
  });
}
async function requestStsToken(auth2, refreshToken) {
  const response = await _performFetchWithErrorHandling(auth2, {}, async () => {
    const body = querystring({
      "grant_type": "refresh_token",
      "refresh_token": refreshToken
    }).slice(1);
    const { tokenApiHost, apiKey } = auth2.config;
    const url = _getFinalTarget(auth2, tokenApiHost, "/v1/token", `key=${apiKey}`);
    const headers = await auth2._getAdditionalHeaders();
    headers[
      "Content-Type"
      /* HttpHeader.CONTENT_TYPE */
    ] = "application/x-www-form-urlencoded";
    return FetchProvider.fetch()(url, {
      method: "POST",
      headers,
      body
    });
  });
  return {
    accessToken: response.access_token,
    expiresIn: response.expires_in,
    refreshToken: response.refresh_token
  };
}
var StsTokenManager = class {
  constructor() {
    this.refreshToken = null;
    this.accessToken = null;
    this.expirationTime = null;
  }
  get isExpired() {
    return !this.expirationTime || Date.now() > this.expirationTime - 3e4;
  }
  updateFromServerResponse(response) {
    _assert(
      response.idToken,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    _assert(
      typeof response.idToken !== "undefined",
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    _assert(
      typeof response.refreshToken !== "undefined",
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    const expiresIn = "expiresIn" in response && typeof response.expiresIn !== "undefined" ? Number(response.expiresIn) : _tokenExpiresIn(response.idToken);
    this.updateTokensAndExpiration(response.idToken, response.refreshToken, expiresIn);
  }
  async getToken(auth2, forceRefresh = false) {
    _assert(
      !this.accessToken || this.refreshToken,
      auth2,
      "user-token-expired"
      /* AuthErrorCode.TOKEN_EXPIRED */
    );
    if (!forceRefresh && this.accessToken && !this.isExpired) {
      return this.accessToken;
    }
    if (this.refreshToken) {
      await this.refresh(auth2, this.refreshToken);
      return this.accessToken;
    }
    return null;
  }
  clearRefreshToken() {
    this.refreshToken = null;
  }
  async refresh(auth2, oldToken) {
    const { accessToken, refreshToken, expiresIn } = await requestStsToken(auth2, oldToken);
    this.updateTokensAndExpiration(accessToken, refreshToken, Number(expiresIn));
  }
  updateTokensAndExpiration(accessToken, refreshToken, expiresInSec) {
    this.refreshToken = refreshToken || null;
    this.accessToken = accessToken || null;
    this.expirationTime = Date.now() + expiresInSec * 1e3;
  }
  static fromJSON(appName, object) {
    const { refreshToken, accessToken, expirationTime } = object;
    const manager = new StsTokenManager();
    if (refreshToken) {
      _assert(typeof refreshToken === "string", "internal-error", {
        appName
      });
      manager.refreshToken = refreshToken;
    }
    if (accessToken) {
      _assert(typeof accessToken === "string", "internal-error", {
        appName
      });
      manager.accessToken = accessToken;
    }
    if (expirationTime) {
      _assert(typeof expirationTime === "number", "internal-error", {
        appName
      });
      manager.expirationTime = expirationTime;
    }
    return manager;
  }
  toJSON() {
    return {
      refreshToken: this.refreshToken,
      accessToken: this.accessToken,
      expirationTime: this.expirationTime
    };
  }
  _assign(stsTokenManager) {
    this.accessToken = stsTokenManager.accessToken;
    this.refreshToken = stsTokenManager.refreshToken;
    this.expirationTime = stsTokenManager.expirationTime;
  }
  _clone() {
    return Object.assign(new StsTokenManager(), this.toJSON());
  }
  _performRefresh() {
    return debugFail("not implemented");
  }
};
function assertStringOrUndefined(assertion, appName) {
  _assert(typeof assertion === "string" || typeof assertion === "undefined", "internal-error", { appName });
}
var UserImpl = class {
  constructor(_a) {
    var { uid, auth: auth2, stsTokenManager } = _a, opt = __rest(_a, ["uid", "auth", "stsTokenManager"]);
    this.providerId = "firebase";
    this.proactiveRefresh = new ProactiveRefresh(this);
    this.reloadUserInfo = null;
    this.reloadListener = null;
    this.uid = uid;
    this.auth = auth2;
    this.stsTokenManager = stsTokenManager;
    this.accessToken = stsTokenManager.accessToken;
    this.displayName = opt.displayName || null;
    this.email = opt.email || null;
    this.emailVerified = opt.emailVerified || false;
    this.phoneNumber = opt.phoneNumber || null;
    this.photoURL = opt.photoURL || null;
    this.isAnonymous = opt.isAnonymous || false;
    this.tenantId = opt.tenantId || null;
    this.providerData = opt.providerData ? [...opt.providerData] : [];
    this.metadata = new UserMetadata(opt.createdAt || void 0, opt.lastLoginAt || void 0);
  }
  async getIdToken(forceRefresh) {
    const accessToken = await _logoutIfInvalidated(this, this.stsTokenManager.getToken(this.auth, forceRefresh));
    _assert(
      accessToken,
      this.auth,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    if (this.accessToken !== accessToken) {
      this.accessToken = accessToken;
      await this.auth._persistUserIfCurrent(this);
      this.auth._notifyListenersIfCurrent(this);
    }
    return accessToken;
  }
  getIdTokenResult(forceRefresh) {
    return getIdTokenResult(this, forceRefresh);
  }
  reload() {
    return reload(this);
  }
  _assign(user) {
    if (this === user) {
      return;
    }
    _assert(
      this.uid === user.uid,
      this.auth,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    this.displayName = user.displayName;
    this.photoURL = user.photoURL;
    this.email = user.email;
    this.emailVerified = user.emailVerified;
    this.phoneNumber = user.phoneNumber;
    this.isAnonymous = user.isAnonymous;
    this.tenantId = user.tenantId;
    this.providerData = user.providerData.map((userInfo) => Object.assign({}, userInfo));
    this.metadata._copy(user.metadata);
    this.stsTokenManager._assign(user.stsTokenManager);
  }
  _clone(auth2) {
    const newUser = new UserImpl(Object.assign(Object.assign({}, this), { auth: auth2, stsTokenManager: this.stsTokenManager._clone() }));
    newUser.metadata._copy(this.metadata);
    return newUser;
  }
  _onReload(callback) {
    _assert(
      !this.reloadListener,
      this.auth,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    this.reloadListener = callback;
    if (this.reloadUserInfo) {
      this._notifyReloadListener(this.reloadUserInfo);
      this.reloadUserInfo = null;
    }
  }
  _notifyReloadListener(userInfo) {
    if (this.reloadListener) {
      this.reloadListener(userInfo);
    } else {
      this.reloadUserInfo = userInfo;
    }
  }
  _startProactiveRefresh() {
    this.proactiveRefresh._start();
  }
  _stopProactiveRefresh() {
    this.proactiveRefresh._stop();
  }
  async _updateTokensIfNecessary(response, reload2 = false) {
    let tokensRefreshed = false;
    if (response.idToken && response.idToken !== this.stsTokenManager.accessToken) {
      this.stsTokenManager.updateFromServerResponse(response);
      tokensRefreshed = true;
    }
    if (reload2) {
      await _reloadWithoutSaving(this);
    }
    await this.auth._persistUserIfCurrent(this);
    if (tokensRefreshed) {
      this.auth._notifyListenersIfCurrent(this);
    }
  }
  async delete() {
    const idToken = await this.getIdToken();
    await _logoutIfInvalidated(this, deleteAccount(this.auth, { idToken }));
    this.stsTokenManager.clearRefreshToken();
    return this.auth.signOut();
  }
  toJSON() {
    return Object.assign(Object.assign({
      uid: this.uid,
      email: this.email || void 0,
      emailVerified: this.emailVerified,
      displayName: this.displayName || void 0,
      isAnonymous: this.isAnonymous,
      photoURL: this.photoURL || void 0,
      phoneNumber: this.phoneNumber || void 0,
      tenantId: this.tenantId || void 0,
      providerData: this.providerData.map((userInfo) => Object.assign({}, userInfo)),
      stsTokenManager: this.stsTokenManager.toJSON(),
      // Redirect event ID must be maintained in case there is a pending
      // redirect event.
      _redirectEventId: this._redirectEventId
    }, this.metadata.toJSON()), {
      // Required for compatibility with the legacy SDK (go/firebase-auth-sdk-persistence-parsing):
      apiKey: this.auth.config.apiKey,
      appName: this.auth.name
    });
  }
  get refreshToken() {
    return this.stsTokenManager.refreshToken || "";
  }
  static _fromJSON(auth2, object) {
    var _a, _b, _c, _d, _e, _f, _g, _h;
    const displayName = (_a = object.displayName) !== null && _a !== void 0 ? _a : void 0;
    const email = (_b = object.email) !== null && _b !== void 0 ? _b : void 0;
    const phoneNumber = (_c = object.phoneNumber) !== null && _c !== void 0 ? _c : void 0;
    const photoURL = (_d = object.photoURL) !== null && _d !== void 0 ? _d : void 0;
    const tenantId = (_e = object.tenantId) !== null && _e !== void 0 ? _e : void 0;
    const _redirectEventId = (_f = object._redirectEventId) !== null && _f !== void 0 ? _f : void 0;
    const createdAt = (_g = object.createdAt) !== null && _g !== void 0 ? _g : void 0;
    const lastLoginAt = (_h = object.lastLoginAt) !== null && _h !== void 0 ? _h : void 0;
    const { uid, emailVerified, isAnonymous, providerData, stsTokenManager: plainObjectTokenManager } = object;
    _assert(
      uid && plainObjectTokenManager,
      auth2,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    const stsTokenManager = StsTokenManager.fromJSON(this.name, plainObjectTokenManager);
    _assert(
      typeof uid === "string",
      auth2,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    assertStringOrUndefined(displayName, auth2.name);
    assertStringOrUndefined(email, auth2.name);
    _assert(
      typeof emailVerified === "boolean",
      auth2,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    _assert(
      typeof isAnonymous === "boolean",
      auth2,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    assertStringOrUndefined(phoneNumber, auth2.name);
    assertStringOrUndefined(photoURL, auth2.name);
    assertStringOrUndefined(tenantId, auth2.name);
    assertStringOrUndefined(_redirectEventId, auth2.name);
    assertStringOrUndefined(createdAt, auth2.name);
    assertStringOrUndefined(lastLoginAt, auth2.name);
    const user = new UserImpl({
      uid,
      auth: auth2,
      email,
      emailVerified,
      displayName,
      isAnonymous,
      photoURL,
      phoneNumber,
      tenantId,
      stsTokenManager,
      createdAt,
      lastLoginAt
    });
    if (providerData && Array.isArray(providerData)) {
      user.providerData = providerData.map((userInfo) => Object.assign({}, userInfo));
    }
    if (_redirectEventId) {
      user._redirectEventId = _redirectEventId;
    }
    return user;
  }
  /**
   * Initialize a User from an idToken server response
   * @param auth
   * @param idTokenResponse
   */
  static async _fromIdTokenResponse(auth2, idTokenResponse, isAnonymous = false) {
    const stsTokenManager = new StsTokenManager();
    stsTokenManager.updateFromServerResponse(idTokenResponse);
    const user = new UserImpl({
      uid: idTokenResponse.localId,
      auth: auth2,
      stsTokenManager,
      isAnonymous
    });
    await _reloadWithoutSaving(user);
    return user;
  }
};
var instanceCache = /* @__PURE__ */ new Map();
function _getInstance(cls) {
  debugAssert(cls instanceof Function, "Expected a class definition");
  let instance = instanceCache.get(cls);
  if (instance) {
    debugAssert(instance instanceof cls, "Instance stored in cache mismatched with class");
    return instance;
  }
  instance = new cls();
  instanceCache.set(cls, instance);
  return instance;
}
var InMemoryPersistence = class {
  constructor() {
    this.type = "NONE";
    this.storage = {};
  }
  async _isAvailable() {
    return true;
  }
  async _set(key, value) {
    this.storage[key] = value;
  }
  async _get(key) {
    const value = this.storage[key];
    return value === void 0 ? null : value;
  }
  async _remove(key) {
    delete this.storage[key];
  }
  _addListener(_key, _listener) {
    return;
  }
  _removeListener(_key, _listener) {
    return;
  }
};
InMemoryPersistence.type = "NONE";
var inMemoryPersistence = InMemoryPersistence;
function _persistenceKeyName(key, apiKey, appName) {
  return `${"firebase"}:${key}:${apiKey}:${appName}`;
}
var PersistenceUserManager = class {
  constructor(persistence, auth2, userKey) {
    this.persistence = persistence;
    this.auth = auth2;
    this.userKey = userKey;
    const { config, name: name5 } = this.auth;
    this.fullUserKey = _persistenceKeyName(this.userKey, config.apiKey, name5);
    this.fullPersistenceKey = _persistenceKeyName("persistence", config.apiKey, name5);
    this.boundEventHandler = auth2._onStorageEvent.bind(auth2);
    this.persistence._addListener(this.fullUserKey, this.boundEventHandler);
  }
  setCurrentUser(user) {
    return this.persistence._set(this.fullUserKey, user.toJSON());
  }
  async getCurrentUser() {
    const blob = await this.persistence._get(this.fullUserKey);
    return blob ? UserImpl._fromJSON(this.auth, blob) : null;
  }
  removeCurrentUser() {
    return this.persistence._remove(this.fullUserKey);
  }
  savePersistenceForRedirect() {
    return this.persistence._set(this.fullPersistenceKey, this.persistence.type);
  }
  async setPersistence(newPersistence) {
    if (this.persistence === newPersistence) {
      return;
    }
    const currentUser = await this.getCurrentUser();
    await this.removeCurrentUser();
    this.persistence = newPersistence;
    if (currentUser) {
      return this.setCurrentUser(currentUser);
    }
  }
  delete() {
    this.persistence._removeListener(this.fullUserKey, this.boundEventHandler);
  }
  static async create(auth2, persistenceHierarchy, userKey = "authUser") {
    if (!persistenceHierarchy.length) {
      return new PersistenceUserManager(_getInstance(inMemoryPersistence), auth2, userKey);
    }
    const availablePersistences = (await Promise.all(persistenceHierarchy.map(async (persistence) => {
      if (await persistence._isAvailable()) {
        return persistence;
      }
      return void 0;
    }))).filter((persistence) => persistence);
    let selectedPersistence = availablePersistences[0] || _getInstance(inMemoryPersistence);
    const key = _persistenceKeyName(userKey, auth2.config.apiKey, auth2.name);
    let userToMigrate = null;
    for (const persistence of persistenceHierarchy) {
      try {
        const blob = await persistence._get(key);
        if (blob) {
          const user = UserImpl._fromJSON(auth2, blob);
          if (persistence !== selectedPersistence) {
            userToMigrate = user;
          }
          selectedPersistence = persistence;
          break;
        }
      } catch (_a) {
      }
    }
    const migrationHierarchy = availablePersistences.filter((p) => p._shouldAllowMigration);
    if (!selectedPersistence._shouldAllowMigration || !migrationHierarchy.length) {
      return new PersistenceUserManager(selectedPersistence, auth2, userKey);
    }
    selectedPersistence = migrationHierarchy[0];
    if (userToMigrate) {
      await selectedPersistence._set(key, userToMigrate.toJSON());
    }
    await Promise.all(persistenceHierarchy.map(async (persistence) => {
      if (persistence !== selectedPersistence) {
        try {
          await persistence._remove(key);
        } catch (_a) {
        }
      }
    }));
    return new PersistenceUserManager(selectedPersistence, auth2, userKey);
  }
};
function _getBrowserName(userAgent) {
  const ua = userAgent.toLowerCase();
  if (ua.includes("opera/") || ua.includes("opr/") || ua.includes("opios/")) {
    return "Opera";
  } else if (_isIEMobile(ua)) {
    return "IEMobile";
  } else if (ua.includes("msie") || ua.includes("trident/")) {
    return "IE";
  } else if (ua.includes("edge/")) {
    return "Edge";
  } else if (_isFirefox(ua)) {
    return "Firefox";
  } else if (ua.includes("silk/")) {
    return "Silk";
  } else if (_isBlackBerry(ua)) {
    return "Blackberry";
  } else if (_isWebOS(ua)) {
    return "Webos";
  } else if (_isSafari(ua)) {
    return "Safari";
  } else if ((ua.includes("chrome/") || _isChromeIOS(ua)) && !ua.includes("edge/")) {
    return "Chrome";
  } else if (_isAndroid(ua)) {
    return "Android";
  } else {
    const re = /([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/;
    const matches = userAgent.match(re);
    if ((matches === null || matches === void 0 ? void 0 : matches.length) === 2) {
      return matches[1];
    }
  }
  return "Other";
}
function _isFirefox(ua = getUA()) {
  return /firefox\//i.test(ua);
}
function _isSafari(userAgent = getUA()) {
  const ua = userAgent.toLowerCase();
  return ua.includes("safari/") && !ua.includes("chrome/") && !ua.includes("crios/") && !ua.includes("android");
}
function _isChromeIOS(ua = getUA()) {
  return /crios\//i.test(ua);
}
function _isIEMobile(ua = getUA()) {
  return /iemobile/i.test(ua);
}
function _isAndroid(ua = getUA()) {
  return /android/i.test(ua);
}
function _isBlackBerry(ua = getUA()) {
  return /blackberry/i.test(ua);
}
function _isWebOS(ua = getUA()) {
  return /webos/i.test(ua);
}
function _isIOS(ua = getUA()) {
  return /iphone|ipad|ipod/i.test(ua) || /macintosh/i.test(ua) && /mobile/i.test(ua);
}
function _isIOSStandalone(ua = getUA()) {
  var _a;
  return _isIOS(ua) && !!((_a = window.navigator) === null || _a === void 0 ? void 0 : _a.standalone);
}
function _isIE10() {
  return isIE() && document.documentMode === 10;
}
function _isMobileBrowser(ua = getUA()) {
  return _isIOS(ua) || _isAndroid(ua) || _isWebOS(ua) || _isBlackBerry(ua) || /windows phone/i.test(ua) || _isIEMobile(ua);
}
function _isIframe() {
  try {
    return !!(window && window !== window.top);
  } catch (e) {
    return false;
  }
}
function _getClientVersion(clientPlatform, frameworks = []) {
  let reportedPlatform;
  switch (clientPlatform) {
    case "Browser":
      reportedPlatform = _getBrowserName(getUA());
      break;
    case "Worker":
      reportedPlatform = `${_getBrowserName(getUA())}-${clientPlatform}`;
      break;
    default:
      reportedPlatform = clientPlatform;
  }
  const reportedFrameworks = frameworks.length ? frameworks.join(",") : "FirebaseCore-web";
  return `${reportedPlatform}/${"JsCore"}/${SDK_VERSION}/${reportedFrameworks}`;
}
async function getRecaptchaConfig(auth2, request) {
  return _performApiRequest(auth2, "GET", "/v2/recaptchaConfig", _addTidIfNecessary(auth2, request));
}
function isEnterprise(grecaptcha) {
  return grecaptcha !== void 0 && grecaptcha.enterprise !== void 0;
}
var RecaptchaConfig = class {
  constructor(response) {
    this.siteKey = "";
    this.emailPasswordEnabled = false;
    if (response.recaptchaKey === void 0) {
      throw new Error("recaptchaKey undefined");
    }
    this.siteKey = response.recaptchaKey.split("/")[3];
    this.emailPasswordEnabled = response.recaptchaEnforcementState.some((enforcementState) => enforcementState.provider === "EMAIL_PASSWORD_PROVIDER" && enforcementState.enforcementState !== "OFF");
  }
};
function getScriptParentElement() {
  var _a, _b;
  return (_b = (_a = document.getElementsByTagName("head")) === null || _a === void 0 ? void 0 : _a[0]) !== null && _b !== void 0 ? _b : document;
}
function _loadJS(url) {
  return new Promise((resolve, reject) => {
    const el = document.createElement("script");
    el.setAttribute("src", url);
    el.onload = resolve;
    el.onerror = (e) => {
      const error = _createError(
        "internal-error"
        /* AuthErrorCode.INTERNAL_ERROR */
      );
      error.customData = e;
      reject(error);
    };
    el.type = "text/javascript";
    el.charset = "UTF-8";
    getScriptParentElement().appendChild(el);
  });
}
function _generateCallbackName(prefix) {
  return `__${prefix}${Math.floor(Math.random() * 1e6)}`;
}
var RECAPTCHA_ENTERPRISE_URL = "https://www.google.com/recaptcha/enterprise.js?render=";
var RECAPTCHA_ENTERPRISE_VERIFIER_TYPE = "recaptcha-enterprise";
var FAKE_TOKEN = "NO_RECAPTCHA";
var RecaptchaEnterpriseVerifier = class {
  /**
   *
   * @param authExtern - The corresponding Firebase {@link Auth} instance.
   *
   */
  constructor(authExtern) {
    this.type = RECAPTCHA_ENTERPRISE_VERIFIER_TYPE;
    this.auth = _castAuth(authExtern);
  }
  /**
   * Executes the verification process.
   *
   * @returns A Promise for a token that can be used to assert the validity of a request.
   */
  async verify(action = "verify", forceRefresh = false) {
    async function retrieveSiteKey(auth2) {
      if (!forceRefresh) {
        if (auth2.tenantId == null && auth2._agentRecaptchaConfig != null) {
          return auth2._agentRecaptchaConfig.siteKey;
        }
        if (auth2.tenantId != null && auth2._tenantRecaptchaConfigs[auth2.tenantId] !== void 0) {
          return auth2._tenantRecaptchaConfigs[auth2.tenantId].siteKey;
        }
      }
      return new Promise(async (resolve, reject) => {
        getRecaptchaConfig(auth2, {
          clientType: "CLIENT_TYPE_WEB",
          version: "RECAPTCHA_ENTERPRISE"
          /* RecaptchaVersion.ENTERPRISE */
        }).then((response) => {
          if (response.recaptchaKey === void 0) {
            reject(new Error("recaptcha Enterprise site key undefined"));
          } else {
            const config = new RecaptchaConfig(response);
            if (auth2.tenantId == null) {
              auth2._agentRecaptchaConfig = config;
            } else {
              auth2._tenantRecaptchaConfigs[auth2.tenantId] = config;
            }
            return resolve(config.siteKey);
          }
        }).catch((error) => {
          reject(error);
        });
      });
    }
    function retrieveRecaptchaToken(siteKey, resolve, reject) {
      const grecaptcha = window.grecaptcha;
      if (isEnterprise(grecaptcha)) {
        grecaptcha.enterprise.ready(() => {
          grecaptcha.enterprise.execute(siteKey, { action }).then((token) => {
            resolve(token);
          }).catch(() => {
            resolve(FAKE_TOKEN);
          });
        });
      } else {
        reject(Error("No reCAPTCHA enterprise script loaded."));
      }
    }
    return new Promise((resolve, reject) => {
      retrieveSiteKey(this.auth).then((siteKey) => {
        if (!forceRefresh && isEnterprise(window.grecaptcha)) {
          retrieveRecaptchaToken(siteKey, resolve, reject);
        } else {
          if (typeof window === "undefined") {
            reject(new Error("RecaptchaVerifier is only supported in browser"));
            return;
          }
          _loadJS(RECAPTCHA_ENTERPRISE_URL + siteKey).then(() => {
            retrieveRecaptchaToken(siteKey, resolve, reject);
          }).catch((error) => {
            reject(error);
          });
        }
      }).catch((error) => {
        reject(error);
      });
    });
  }
};
async function injectRecaptchaFields(auth2, request, action, captchaResp = false) {
  const verifier = new RecaptchaEnterpriseVerifier(auth2);
  let captchaResponse;
  try {
    captchaResponse = await verifier.verify(action);
  } catch (error) {
    captchaResponse = await verifier.verify(action, true);
  }
  const newRequest = Object.assign({}, request);
  if (!captchaResp) {
    Object.assign(newRequest, { captchaResponse });
  } else {
    Object.assign(newRequest, { "captchaResp": captchaResponse });
  }
  Object.assign(newRequest, {
    "clientType": "CLIENT_TYPE_WEB"
    /* RecaptchaClientType.WEB */
  });
  Object.assign(newRequest, {
    "recaptchaVersion": "RECAPTCHA_ENTERPRISE"
    /* RecaptchaVersion.ENTERPRISE */
  });
  return newRequest;
}
var AuthMiddlewareQueue = class {
  constructor(auth2) {
    this.auth = auth2;
    this.queue = [];
  }
  pushCallback(callback, onAbort) {
    const wrappedCallback = (user) => new Promise((resolve, reject) => {
      try {
        const result = callback(user);
        resolve(result);
      } catch (e) {
        reject(e);
      }
    });
    wrappedCallback.onAbort = onAbort;
    this.queue.push(wrappedCallback);
    const index = this.queue.length - 1;
    return () => {
      this.queue[index] = () => Promise.resolve();
    };
  }
  async runMiddleware(nextUser) {
    if (this.auth.currentUser === nextUser) {
      return;
    }
    const onAbortStack = [];
    try {
      for (const beforeStateCallback of this.queue) {
        await beforeStateCallback(nextUser);
        if (beforeStateCallback.onAbort) {
          onAbortStack.push(beforeStateCallback.onAbort);
        }
      }
    } catch (e) {
      onAbortStack.reverse();
      for (const onAbort of onAbortStack) {
        try {
          onAbort();
        } catch (_) {
        }
      }
      throw this.auth._errorFactory.create("login-blocked", {
        originalMessage: e === null || e === void 0 ? void 0 : e.message
      });
    }
  }
};
var AuthImpl = class {
  constructor(app2, heartbeatServiceProvider, appCheckServiceProvider, config) {
    this.app = app2;
    this.heartbeatServiceProvider = heartbeatServiceProvider;
    this.appCheckServiceProvider = appCheckServiceProvider;
    this.config = config;
    this.currentUser = null;
    this.emulatorConfig = null;
    this.operations = Promise.resolve();
    this.authStateSubscription = new Subscription(this);
    this.idTokenSubscription = new Subscription(this);
    this.beforeStateQueue = new AuthMiddlewareQueue(this);
    this.redirectUser = null;
    this.isProactiveRefreshEnabled = false;
    this._canInitEmulator = true;
    this._isInitialized = false;
    this._deleted = false;
    this._initializationPromise = null;
    this._popupRedirectResolver = null;
    this._errorFactory = _DEFAULT_AUTH_ERROR_FACTORY;
    this._agentRecaptchaConfig = null;
    this._tenantRecaptchaConfigs = {};
    this.lastNotifiedUid = void 0;
    this.languageCode = null;
    this.tenantId = null;
    this.settings = { appVerificationDisabledForTesting: false };
    this.frameworks = [];
    this.name = app2.name;
    this.clientVersion = config.sdkClientVersion;
  }
  _initializeWithPersistence(persistenceHierarchy, popupRedirectResolver) {
    if (popupRedirectResolver) {
      this._popupRedirectResolver = _getInstance(popupRedirectResolver);
    }
    this._initializationPromise = this.queue(async () => {
      var _a, _b;
      if (this._deleted) {
        return;
      }
      this.persistenceManager = await PersistenceUserManager.create(this, persistenceHierarchy);
      if (this._deleted) {
        return;
      }
      if ((_a = this._popupRedirectResolver) === null || _a === void 0 ? void 0 : _a._shouldInitProactively) {
        try {
          await this._popupRedirectResolver._initialize(this);
        } catch (e) {
        }
      }
      await this.initializeCurrentUser(popupRedirectResolver);
      this.lastNotifiedUid = ((_b = this.currentUser) === null || _b === void 0 ? void 0 : _b.uid) || null;
      if (this._deleted) {
        return;
      }
      this._isInitialized = true;
    });
    return this._initializationPromise;
  }
  /**
   * If the persistence is changed in another window, the user manager will let us know
   */
  async _onStorageEvent() {
    if (this._deleted) {
      return;
    }
    const user = await this.assertedPersistence.getCurrentUser();
    if (!this.currentUser && !user) {
      return;
    }
    if (this.currentUser && user && this.currentUser.uid === user.uid) {
      this._currentUser._assign(user);
      await this.currentUser.getIdToken();
      return;
    }
    await this._updateCurrentUser(
      user,
      /* skipBeforeStateCallbacks */
      true
    );
  }
  async initializeCurrentUser(popupRedirectResolver) {
    var _a;
    const previouslyStoredUser = await this.assertedPersistence.getCurrentUser();
    let futureCurrentUser = previouslyStoredUser;
    let needsTocheckMiddleware = false;
    if (popupRedirectResolver && this.config.authDomain) {
      await this.getOrInitRedirectPersistenceManager();
      const redirectUserEventId = (_a = this.redirectUser) === null || _a === void 0 ? void 0 : _a._redirectEventId;
      const storedUserEventId = futureCurrentUser === null || futureCurrentUser === void 0 ? void 0 : futureCurrentUser._redirectEventId;
      const result = await this.tryRedirectSignIn(popupRedirectResolver);
      if ((!redirectUserEventId || redirectUserEventId === storedUserEventId) && (result === null || result === void 0 ? void 0 : result.user)) {
        futureCurrentUser = result.user;
        needsTocheckMiddleware = true;
      }
    }
    if (!futureCurrentUser) {
      return this.directlySetCurrentUser(null);
    }
    if (!futureCurrentUser._redirectEventId) {
      if (needsTocheckMiddleware) {
        try {
          await this.beforeStateQueue.runMiddleware(futureCurrentUser);
        } catch (e) {
          futureCurrentUser = previouslyStoredUser;
          this._popupRedirectResolver._overrideRedirectResult(this, () => Promise.reject(e));
        }
      }
      if (futureCurrentUser) {
        return this.reloadAndSetCurrentUserOrClear(futureCurrentUser);
      } else {
        return this.directlySetCurrentUser(null);
      }
    }
    _assert(
      this._popupRedirectResolver,
      this,
      "argument-error"
      /* AuthErrorCode.ARGUMENT_ERROR */
    );
    await this.getOrInitRedirectPersistenceManager();
    if (this.redirectUser && this.redirectUser._redirectEventId === futureCurrentUser._redirectEventId) {
      return this.directlySetCurrentUser(futureCurrentUser);
    }
    return this.reloadAndSetCurrentUserOrClear(futureCurrentUser);
  }
  async tryRedirectSignIn(redirectResolver) {
    let result = null;
    try {
      result = await this._popupRedirectResolver._completeRedirectFn(this, redirectResolver, true);
    } catch (e) {
      await this._setRedirectUser(null);
    }
    return result;
  }
  async reloadAndSetCurrentUserOrClear(user) {
    try {
      await _reloadWithoutSaving(user);
    } catch (e) {
      if ((e === null || e === void 0 ? void 0 : e.code) !== `auth/${"network-request-failed"}`) {
        return this.directlySetCurrentUser(null);
      }
    }
    return this.directlySetCurrentUser(user);
  }
  useDeviceLanguage() {
    this.languageCode = _getUserLanguage();
  }
  async _delete() {
    this._deleted = true;
  }
  async updateCurrentUser(userExtern) {
    const user = userExtern ? getModularInstance(userExtern) : null;
    if (user) {
      _assert(
        user.auth.config.apiKey === this.config.apiKey,
        this,
        "invalid-user-token"
        /* AuthErrorCode.INVALID_AUTH */
      );
    }
    return this._updateCurrentUser(user && user._clone(this));
  }
  async _updateCurrentUser(user, skipBeforeStateCallbacks = false) {
    if (this._deleted) {
      return;
    }
    if (user) {
      _assert(
        this.tenantId === user.tenantId,
        this,
        "tenant-id-mismatch"
        /* AuthErrorCode.TENANT_ID_MISMATCH */
      );
    }
    if (!skipBeforeStateCallbacks) {
      await this.beforeStateQueue.runMiddleware(user);
    }
    return this.queue(async () => {
      await this.directlySetCurrentUser(user);
      this.notifyAuthListeners();
    });
  }
  async signOut() {
    await this.beforeStateQueue.runMiddleware(null);
    if (this.redirectPersistenceManager || this._popupRedirectResolver) {
      await this._setRedirectUser(null);
    }
    return this._updateCurrentUser(
      null,
      /* skipBeforeStateCallbacks */
      true
    );
  }
  setPersistence(persistence) {
    return this.queue(async () => {
      await this.assertedPersistence.setPersistence(_getInstance(persistence));
    });
  }
  async initializeRecaptchaConfig() {
    const response = await getRecaptchaConfig(this, {
      clientType: "CLIENT_TYPE_WEB",
      version: "RECAPTCHA_ENTERPRISE"
      /* RecaptchaVersion.ENTERPRISE */
    });
    const config = new RecaptchaConfig(response);
    if (this.tenantId == null) {
      this._agentRecaptchaConfig = config;
    } else {
      this._tenantRecaptchaConfigs[this.tenantId] = config;
    }
    if (config.emailPasswordEnabled) {
      const verifier = new RecaptchaEnterpriseVerifier(this);
      void verifier.verify();
    }
  }
  _getRecaptchaConfig() {
    if (this.tenantId == null) {
      return this._agentRecaptchaConfig;
    } else {
      return this._tenantRecaptchaConfigs[this.tenantId];
    }
  }
  _getPersistence() {
    return this.assertedPersistence.persistence.type;
  }
  _updateErrorMap(errorMap) {
    this._errorFactory = new ErrorFactory("auth", "Firebase", errorMap());
  }
  onAuthStateChanged(nextOrObserver, error, completed) {
    return this.registerStateListener(this.authStateSubscription, nextOrObserver, error, completed);
  }
  beforeAuthStateChanged(callback, onAbort) {
    return this.beforeStateQueue.pushCallback(callback, onAbort);
  }
  onIdTokenChanged(nextOrObserver, error, completed) {
    return this.registerStateListener(this.idTokenSubscription, nextOrObserver, error, completed);
  }
  authStateReady() {
    return new Promise((resolve, reject) => {
      if (this.currentUser) {
        resolve();
      } else {
        const unsubscribe = this.onAuthStateChanged(() => {
          unsubscribe();
          resolve();
        }, reject);
      }
    });
  }
  toJSON() {
    var _a;
    return {
      apiKey: this.config.apiKey,
      authDomain: this.config.authDomain,
      appName: this.name,
      currentUser: (_a = this._currentUser) === null || _a === void 0 ? void 0 : _a.toJSON()
    };
  }
  async _setRedirectUser(user, popupRedirectResolver) {
    const redirectManager = await this.getOrInitRedirectPersistenceManager(popupRedirectResolver);
    return user === null ? redirectManager.removeCurrentUser() : redirectManager.setCurrentUser(user);
  }
  async getOrInitRedirectPersistenceManager(popupRedirectResolver) {
    if (!this.redirectPersistenceManager) {
      const resolver = popupRedirectResolver && _getInstance(popupRedirectResolver) || this._popupRedirectResolver;
      _assert(
        resolver,
        this,
        "argument-error"
        /* AuthErrorCode.ARGUMENT_ERROR */
      );
      this.redirectPersistenceManager = await PersistenceUserManager.create(
        this,
        [_getInstance(resolver._redirectPersistence)],
        "redirectUser"
        /* KeyName.REDIRECT_USER */
      );
      this.redirectUser = await this.redirectPersistenceManager.getCurrentUser();
    }
    return this.redirectPersistenceManager;
  }
  async _redirectUserForId(id) {
    var _a, _b;
    if (this._isInitialized) {
      await this.queue(async () => {
      });
    }
    if (((_a = this._currentUser) === null || _a === void 0 ? void 0 : _a._redirectEventId) === id) {
      return this._currentUser;
    }
    if (((_b = this.redirectUser) === null || _b === void 0 ? void 0 : _b._redirectEventId) === id) {
      return this.redirectUser;
    }
    return null;
  }
  async _persistUserIfCurrent(user) {
    if (user === this.currentUser) {
      return this.queue(async () => this.directlySetCurrentUser(user));
    }
  }
  /** Notifies listeners only if the user is current */
  _notifyListenersIfCurrent(user) {
    if (user === this.currentUser) {
      this.notifyAuthListeners();
    }
  }
  _key() {
    return `${this.config.authDomain}:${this.config.apiKey}:${this.name}`;
  }
  _startProactiveRefresh() {
    this.isProactiveRefreshEnabled = true;
    if (this.currentUser) {
      this._currentUser._startProactiveRefresh();
    }
  }
  _stopProactiveRefresh() {
    this.isProactiveRefreshEnabled = false;
    if (this.currentUser) {
      this._currentUser._stopProactiveRefresh();
    }
  }
  /** Returns the current user cast as the internal type */
  get _currentUser() {
    return this.currentUser;
  }
  notifyAuthListeners() {
    var _a, _b;
    if (!this._isInitialized) {
      return;
    }
    this.idTokenSubscription.next(this.currentUser);
    const currentUid = (_b = (_a = this.currentUser) === null || _a === void 0 ? void 0 : _a.uid) !== null && _b !== void 0 ? _b : null;
    if (this.lastNotifiedUid !== currentUid) {
      this.lastNotifiedUid = currentUid;
      this.authStateSubscription.next(this.currentUser);
    }
  }
  registerStateListener(subscription, nextOrObserver, error, completed) {
    if (this._deleted) {
      return () => {
      };
    }
    const cb = typeof nextOrObserver === "function" ? nextOrObserver : nextOrObserver.next.bind(nextOrObserver);
    const promise = this._isInitialized ? Promise.resolve() : this._initializationPromise;
    _assert(
      promise,
      this,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    promise.then(() => cb(this.currentUser));
    if (typeof nextOrObserver === "function") {
      return subscription.addObserver(nextOrObserver, error, completed);
    } else {
      return subscription.addObserver(nextOrObserver);
    }
  }
  /**
   * Unprotected (from race conditions) method to set the current user. This
   * should only be called from within a queued callback. This is necessary
   * because the queue shouldn't rely on another queued callback.
   */
  async directlySetCurrentUser(user) {
    if (this.currentUser && this.currentUser !== user) {
      this._currentUser._stopProactiveRefresh();
    }
    if (user && this.isProactiveRefreshEnabled) {
      user._startProactiveRefresh();
    }
    this.currentUser = user;
    if (user) {
      await this.assertedPersistence.setCurrentUser(user);
    } else {
      await this.assertedPersistence.removeCurrentUser();
    }
  }
  queue(action) {
    this.operations = this.operations.then(action, action);
    return this.operations;
  }
  get assertedPersistence() {
    _assert(
      this.persistenceManager,
      this,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    return this.persistenceManager;
  }
  _logFramework(framework) {
    if (!framework || this.frameworks.includes(framework)) {
      return;
    }
    this.frameworks.push(framework);
    this.frameworks.sort();
    this.clientVersion = _getClientVersion(this.config.clientPlatform, this._getFrameworks());
  }
  _getFrameworks() {
    return this.frameworks;
  }
  async _getAdditionalHeaders() {
    var _a;
    const headers = {
      [
        "X-Client-Version"
        /* HttpHeader.X_CLIENT_VERSION */
      ]: this.clientVersion
    };
    if (this.app.options.appId) {
      headers[
        "X-Firebase-gmpid"
        /* HttpHeader.X_FIREBASE_GMPID */
      ] = this.app.options.appId;
    }
    const heartbeatsHeader = await ((_a = this.heartbeatServiceProvider.getImmediate({
      optional: true
    })) === null || _a === void 0 ? void 0 : _a.getHeartbeatsHeader());
    if (heartbeatsHeader) {
      headers[
        "X-Firebase-Client"
        /* HttpHeader.X_FIREBASE_CLIENT */
      ] = heartbeatsHeader;
    }
    const appCheckToken = await this._getAppCheckToken();
    if (appCheckToken) {
      headers[
        "X-Firebase-AppCheck"
        /* HttpHeader.X_FIREBASE_APP_CHECK */
      ] = appCheckToken;
    }
    return headers;
  }
  async _getAppCheckToken() {
    var _a;
    const appCheckTokenResult = await ((_a = this.appCheckServiceProvider.getImmediate({ optional: true })) === null || _a === void 0 ? void 0 : _a.getToken());
    if (appCheckTokenResult === null || appCheckTokenResult === void 0 ? void 0 : appCheckTokenResult.error) {
      _logWarn(`Error while retrieving App Check token: ${appCheckTokenResult.error}`);
    }
    return appCheckTokenResult === null || appCheckTokenResult === void 0 ? void 0 : appCheckTokenResult.token;
  }
};
function _castAuth(auth2) {
  return getModularInstance(auth2);
}
var Subscription = class {
  constructor(auth2) {
    this.auth = auth2;
    this.observer = null;
    this.addObserver = createSubscribe((observer) => this.observer = observer);
  }
  get next() {
    _assert(
      this.observer,
      this.auth,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    return this.observer.next.bind(this.observer);
  }
};
function initializeAuth(app2, deps) {
  const provider2 = _getProvider(app2, "auth");
  if (provider2.isInitialized()) {
    const auth3 = provider2.getImmediate();
    const initialOptions = provider2.getOptions();
    if (deepEqual(initialOptions, deps !== null && deps !== void 0 ? deps : {})) {
      return auth3;
    } else {
      _fail(
        auth3,
        "already-initialized"
        /* AuthErrorCode.ALREADY_INITIALIZED */
      );
    }
  }
  const auth2 = provider2.initialize({ options: deps });
  return auth2;
}
function _initializeAuthInstance(auth2, deps) {
  const persistence = (deps === null || deps === void 0 ? void 0 : deps.persistence) || [];
  const hierarchy = (Array.isArray(persistence) ? persistence : [persistence]).map(_getInstance);
  if (deps === null || deps === void 0 ? void 0 : deps.errorMap) {
    auth2._updateErrorMap(deps.errorMap);
  }
  auth2._initializeWithPersistence(hierarchy, deps === null || deps === void 0 ? void 0 : deps.popupRedirectResolver);
}
function connectAuthEmulator(auth2, url, options) {
  const authInternal = _castAuth(auth2);
  _assert(
    authInternal._canInitEmulator,
    authInternal,
    "emulator-config-failed"
    /* AuthErrorCode.EMULATOR_CONFIG_FAILED */
  );
  _assert(
    /^https?:\/\//.test(url),
    authInternal,
    "invalid-emulator-scheme"
    /* AuthErrorCode.INVALID_EMULATOR_SCHEME */
  );
  const disableWarnings = !!(options === null || options === void 0 ? void 0 : options.disableWarnings);
  const protocol = extractProtocol(url);
  const { host, port } = extractHostAndPort(url);
  const portStr = port === null ? "" : `:${port}`;
  authInternal.config.emulator = { url: `${protocol}//${host}${portStr}/` };
  authInternal.settings.appVerificationDisabledForTesting = true;
  authInternal.emulatorConfig = Object.freeze({
    host,
    port,
    protocol: protocol.replace(":", ""),
    options: Object.freeze({ disableWarnings })
  });
  if (!disableWarnings) {
    emitEmulatorWarning();
  }
}
function extractProtocol(url) {
  const protocolEnd = url.indexOf(":");
  return protocolEnd < 0 ? "" : url.substr(0, protocolEnd + 1);
}
function extractHostAndPort(url) {
  const protocol = extractProtocol(url);
  const authority = /(\/\/)?([^?#/]+)/.exec(url.substr(protocol.length));
  if (!authority) {
    return { host: "", port: null };
  }
  const hostAndPort = authority[2].split("@").pop() || "";
  const bracketedIPv6 = /^(\[[^\]]+\])(:|$)/.exec(hostAndPort);
  if (bracketedIPv6) {
    const host = bracketedIPv6[1];
    return { host, port: parsePort(hostAndPort.substr(host.length + 1)) };
  } else {
    const [host, port] = hostAndPort.split(":");
    return { host, port: parsePort(port) };
  }
}
function parsePort(portStr) {
  if (!portStr) {
    return null;
  }
  const port = Number(portStr);
  if (isNaN(port)) {
    return null;
  }
  return port;
}
function emitEmulatorWarning() {
  function attachBanner() {
    const el = document.createElement("p");
    const sty = el.style;
    el.innerText = "Running in emulator mode. Do not use with production credentials.";
    sty.position = "fixed";
    sty.width = "100%";
    sty.backgroundColor = "#ffffff";
    sty.border = ".1em solid #000000";
    sty.color = "#b50000";
    sty.bottom = "0px";
    sty.left = "0px";
    sty.margin = "0px";
    sty.zIndex = "10000";
    sty.textAlign = "center";
    el.classList.add("firebase-emulator-warning");
    document.body.appendChild(el);
  }
  if (typeof console !== "undefined" && typeof console.info === "function") {
    console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");
  }
  if (typeof window !== "undefined" && typeof document !== "undefined") {
    if (document.readyState === "loading") {
      window.addEventListener("DOMContentLoaded", attachBanner);
    } else {
      attachBanner();
    }
  }
}
var AuthCredential = class {
  /** @internal */
  constructor(providerId, signInMethod) {
    this.providerId = providerId;
    this.signInMethod = signInMethod;
  }
  /**
   * Returns a JSON-serializable representation of this object.
   *
   * @returns a JSON-serializable representation of this object.
   */
  toJSON() {
    return debugFail("not implemented");
  }
  /** @internal */
  _getIdTokenResponse(_auth) {
    return debugFail("not implemented");
  }
  /** @internal */
  _linkToIdToken(_auth, _idToken) {
    return debugFail("not implemented");
  }
  /** @internal */
  _getReauthenticationResolver(_auth) {
    return debugFail("not implemented");
  }
};
async function updateEmailPassword(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v1/accounts:update", request);
}
async function signInWithPassword(auth2, request) {
  return _performSignInRequest(auth2, "POST", "/v1/accounts:signInWithPassword", _addTidIfNecessary(auth2, request));
}
async function signInWithEmailLink$1(auth2, request) {
  return _performSignInRequest(auth2, "POST", "/v1/accounts:signInWithEmailLink", _addTidIfNecessary(auth2, request));
}
async function signInWithEmailLinkForLinking(auth2, request) {
  return _performSignInRequest(auth2, "POST", "/v1/accounts:signInWithEmailLink", _addTidIfNecessary(auth2, request));
}
var EmailAuthCredential = class extends AuthCredential {
  /** @internal */
  constructor(_email, _password, signInMethod, _tenantId = null) {
    super("password", signInMethod);
    this._email = _email;
    this._password = _password;
    this._tenantId = _tenantId;
  }
  /** @internal */
  static _fromEmailAndPassword(email, password) {
    return new EmailAuthCredential(
      email,
      password,
      "password"
      /* SignInMethod.EMAIL_PASSWORD */
    );
  }
  /** @internal */
  static _fromEmailAndCode(email, oobCode, tenantId = null) {
    return new EmailAuthCredential(email, oobCode, "emailLink", tenantId);
  }
  /** {@inheritdoc AuthCredential.toJSON} */
  toJSON() {
    return {
      email: this._email,
      password: this._password,
      signInMethod: this.signInMethod,
      tenantId: this._tenantId
    };
  }
  /**
   * Static method to deserialize a JSON representation of an object into an {@link  AuthCredential}.
   *
   * @param json - Either `object` or the stringified representation of the object. When string is
   * provided, `JSON.parse` would be called first.
   *
   * @returns If the JSON input does not represent an {@link AuthCredential}, null is returned.
   */
  static fromJSON(json) {
    const obj = typeof json === "string" ? JSON.parse(json) : json;
    if ((obj === null || obj === void 0 ? void 0 : obj.email) && (obj === null || obj === void 0 ? void 0 : obj.password)) {
      if (obj.signInMethod === "password") {
        return this._fromEmailAndPassword(obj.email, obj.password);
      } else if (obj.signInMethod === "emailLink") {
        return this._fromEmailAndCode(obj.email, obj.password, obj.tenantId);
      }
    }
    return null;
  }
  /** @internal */
  async _getIdTokenResponse(auth2) {
    var _a;
    switch (this.signInMethod) {
      case "password":
        const request = {
          returnSecureToken: true,
          email: this._email,
          password: this._password,
          clientType: "CLIENT_TYPE_WEB"
          /* RecaptchaClientType.WEB */
        };
        if ((_a = auth2._getRecaptchaConfig()) === null || _a === void 0 ? void 0 : _a.emailPasswordEnabled) {
          const requestWithRecaptcha = await injectRecaptchaFields(
            auth2,
            request,
            "signInWithPassword"
            /* RecaptchaActionName.SIGN_IN_WITH_PASSWORD */
          );
          return signInWithPassword(auth2, requestWithRecaptcha);
        } else {
          return signInWithPassword(auth2, request).catch(async (error) => {
            if (error.code === `auth/${"missing-recaptcha-token"}`) {
              console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");
              const requestWithRecaptcha = await injectRecaptchaFields(
                auth2,
                request,
                "signInWithPassword"
                /* RecaptchaActionName.SIGN_IN_WITH_PASSWORD */
              );
              return signInWithPassword(auth2, requestWithRecaptcha);
            } else {
              return Promise.reject(error);
            }
          });
        }
      case "emailLink":
        return signInWithEmailLink$1(auth2, {
          email: this._email,
          oobCode: this._password
        });
      default:
        _fail(
          auth2,
          "internal-error"
          /* AuthErrorCode.INTERNAL_ERROR */
        );
    }
  }
  /** @internal */
  async _linkToIdToken(auth2, idToken) {
    switch (this.signInMethod) {
      case "password":
        return updateEmailPassword(auth2, {
          idToken,
          returnSecureToken: true,
          email: this._email,
          password: this._password
        });
      case "emailLink":
        return signInWithEmailLinkForLinking(auth2, {
          idToken,
          email: this._email,
          oobCode: this._password
        });
      default:
        _fail(
          auth2,
          "internal-error"
          /* AuthErrorCode.INTERNAL_ERROR */
        );
    }
  }
  /** @internal */
  _getReauthenticationResolver(auth2) {
    return this._getIdTokenResponse(auth2);
  }
};
async function signInWithIdp(auth2, request) {
  return _performSignInRequest(auth2, "POST", "/v1/accounts:signInWithIdp", _addTidIfNecessary(auth2, request));
}
var IDP_REQUEST_URI$1 = "http://localhost";
var OAuthCredential = class extends AuthCredential {
  constructor() {
    super(...arguments);
    this.pendingToken = null;
  }
  /** @internal */
  static _fromParams(params) {
    const cred = new OAuthCredential(params.providerId, params.signInMethod);
    if (params.idToken || params.accessToken) {
      if (params.idToken) {
        cred.idToken = params.idToken;
      }
      if (params.accessToken) {
        cred.accessToken = params.accessToken;
      }
      if (params.nonce && !params.pendingToken) {
        cred.nonce = params.nonce;
      }
      if (params.pendingToken) {
        cred.pendingToken = params.pendingToken;
      }
    } else if (params.oauthToken && params.oauthTokenSecret) {
      cred.accessToken = params.oauthToken;
      cred.secret = params.oauthTokenSecret;
    } else {
      _fail(
        "argument-error"
        /* AuthErrorCode.ARGUMENT_ERROR */
      );
    }
    return cred;
  }
  /** {@inheritdoc AuthCredential.toJSON}  */
  toJSON() {
    return {
      idToken: this.idToken,
      accessToken: this.accessToken,
      secret: this.secret,
      nonce: this.nonce,
      pendingToken: this.pendingToken,
      providerId: this.providerId,
      signInMethod: this.signInMethod
    };
  }
  /**
   * Static method to deserialize a JSON representation of an object into an
   * {@link  AuthCredential}.
   *
   * @param json - Input can be either Object or the stringified representation of the object.
   * When string is provided, JSON.parse would be called first.
   *
   * @returns If the JSON input does not represent an {@link  AuthCredential}, null is returned.
   */
  static fromJSON(json) {
    const obj = typeof json === "string" ? JSON.parse(json) : json;
    const { providerId, signInMethod } = obj, rest = __rest(obj, ["providerId", "signInMethod"]);
    if (!providerId || !signInMethod) {
      return null;
    }
    const cred = new OAuthCredential(providerId, signInMethod);
    cred.idToken = rest.idToken || void 0;
    cred.accessToken = rest.accessToken || void 0;
    cred.secret = rest.secret;
    cred.nonce = rest.nonce;
    cred.pendingToken = rest.pendingToken || null;
    return cred;
  }
  /** @internal */
  _getIdTokenResponse(auth2) {
    const request = this.buildRequest();
    return signInWithIdp(auth2, request);
  }
  /** @internal */
  _linkToIdToken(auth2, idToken) {
    const request = this.buildRequest();
    request.idToken = idToken;
    return signInWithIdp(auth2, request);
  }
  /** @internal */
  _getReauthenticationResolver(auth2) {
    const request = this.buildRequest();
    request.autoCreate = false;
    return signInWithIdp(auth2, request);
  }
  buildRequest() {
    const request = {
      requestUri: IDP_REQUEST_URI$1,
      returnSecureToken: true
    };
    if (this.pendingToken) {
      request.pendingToken = this.pendingToken;
    } else {
      const postBody = {};
      if (this.idToken) {
        postBody["id_token"] = this.idToken;
      }
      if (this.accessToken) {
        postBody["access_token"] = this.accessToken;
      }
      if (this.secret) {
        postBody["oauth_token_secret"] = this.secret;
      }
      postBody["providerId"] = this.providerId;
      if (this.nonce && !this.pendingToken) {
        postBody["nonce"] = this.nonce;
      }
      request.postBody = querystring(postBody);
    }
    return request;
  }
};
async function sendPhoneVerificationCode(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v1/accounts:sendVerificationCode", _addTidIfNecessary(auth2, request));
}
async function signInWithPhoneNumber$1(auth2, request) {
  return _performSignInRequest(auth2, "POST", "/v1/accounts:signInWithPhoneNumber", _addTidIfNecessary(auth2, request));
}
async function linkWithPhoneNumber$1(auth2, request) {
  const response = await _performSignInRequest(auth2, "POST", "/v1/accounts:signInWithPhoneNumber", _addTidIfNecessary(auth2, request));
  if (response.temporaryProof) {
    throw _makeTaggedError(auth2, "account-exists-with-different-credential", response);
  }
  return response;
}
var VERIFY_PHONE_NUMBER_FOR_EXISTING_ERROR_MAP_ = {
  [
    "USER_NOT_FOUND"
    /* ServerError.USER_NOT_FOUND */
  ]: "user-not-found"
  /* AuthErrorCode.USER_DELETED */
};
async function verifyPhoneNumberForExisting(auth2, request) {
  const apiRequest = Object.assign(Object.assign({}, request), { operation: "REAUTH" });
  return _performSignInRequest(auth2, "POST", "/v1/accounts:signInWithPhoneNumber", _addTidIfNecessary(auth2, apiRequest), VERIFY_PHONE_NUMBER_FOR_EXISTING_ERROR_MAP_);
}
var PhoneAuthCredential = class extends AuthCredential {
  constructor(params) {
    super(
      "phone",
      "phone"
      /* SignInMethod.PHONE */
    );
    this.params = params;
  }
  /** @internal */
  static _fromVerification(verificationId, verificationCode) {
    return new PhoneAuthCredential({ verificationId, verificationCode });
  }
  /** @internal */
  static _fromTokenResponse(phoneNumber, temporaryProof) {
    return new PhoneAuthCredential({ phoneNumber, temporaryProof });
  }
  /** @internal */
  _getIdTokenResponse(auth2) {
    return signInWithPhoneNumber$1(auth2, this._makeVerificationRequest());
  }
  /** @internal */
  _linkToIdToken(auth2, idToken) {
    return linkWithPhoneNumber$1(auth2, Object.assign({ idToken }, this._makeVerificationRequest()));
  }
  /** @internal */
  _getReauthenticationResolver(auth2) {
    return verifyPhoneNumberForExisting(auth2, this._makeVerificationRequest());
  }
  /** @internal */
  _makeVerificationRequest() {
    const { temporaryProof, phoneNumber, verificationId, verificationCode } = this.params;
    if (temporaryProof && phoneNumber) {
      return { temporaryProof, phoneNumber };
    }
    return {
      sessionInfo: verificationId,
      code: verificationCode
    };
  }
  /** {@inheritdoc AuthCredential.toJSON} */
  toJSON() {
    const obj = {
      providerId: this.providerId
    };
    if (this.params.phoneNumber) {
      obj.phoneNumber = this.params.phoneNumber;
    }
    if (this.params.temporaryProof) {
      obj.temporaryProof = this.params.temporaryProof;
    }
    if (this.params.verificationCode) {
      obj.verificationCode = this.params.verificationCode;
    }
    if (this.params.verificationId) {
      obj.verificationId = this.params.verificationId;
    }
    return obj;
  }
  /** Generates a phone credential based on a plain object or a JSON string. */
  static fromJSON(json) {
    if (typeof json === "string") {
      json = JSON.parse(json);
    }
    const { verificationId, verificationCode, phoneNumber, temporaryProof } = json;
    if (!verificationCode && !verificationId && !phoneNumber && !temporaryProof) {
      return null;
    }
    return new PhoneAuthCredential({
      verificationId,
      verificationCode,
      phoneNumber,
      temporaryProof
    });
  }
};
function parseMode(mode) {
  switch (mode) {
    case "recoverEmail":
      return "RECOVER_EMAIL";
    case "resetPassword":
      return "PASSWORD_RESET";
    case "signIn":
      return "EMAIL_SIGNIN";
    case "verifyEmail":
      return "VERIFY_EMAIL";
    case "verifyAndChangeEmail":
      return "VERIFY_AND_CHANGE_EMAIL";
    case "revertSecondFactorAddition":
      return "REVERT_SECOND_FACTOR_ADDITION";
    default:
      return null;
  }
}
function parseDeepLink(url) {
  const link = querystringDecode(extractQuerystring(url))["link"];
  const doubleDeepLink = link ? querystringDecode(extractQuerystring(link))["deep_link_id"] : null;
  const iOSDeepLink = querystringDecode(extractQuerystring(url))["deep_link_id"];
  const iOSDoubleDeepLink = iOSDeepLink ? querystringDecode(extractQuerystring(iOSDeepLink))["link"] : null;
  return iOSDoubleDeepLink || iOSDeepLink || doubleDeepLink || link || url;
}
var ActionCodeURL = class {
  /**
   * @param actionLink - The link from which to extract the URL.
   * @returns The {@link ActionCodeURL} object, or null if the link is invalid.
   *
   * @internal
   */
  constructor(actionLink) {
    var _a, _b, _c, _d, _e, _f;
    const searchParams = querystringDecode(extractQuerystring(actionLink));
    const apiKey = (_a = searchParams[
      "apiKey"
      /* QueryField.API_KEY */
    ]) !== null && _a !== void 0 ? _a : null;
    const code = (_b = searchParams[
      "oobCode"
      /* QueryField.CODE */
    ]) !== null && _b !== void 0 ? _b : null;
    const operation = parseMode((_c = searchParams[
      "mode"
      /* QueryField.MODE */
    ]) !== null && _c !== void 0 ? _c : null);
    _assert(
      apiKey && code && operation,
      "argument-error"
      /* AuthErrorCode.ARGUMENT_ERROR */
    );
    this.apiKey = apiKey;
    this.operation = operation;
    this.code = code;
    this.continueUrl = (_d = searchParams[
      "continueUrl"
      /* QueryField.CONTINUE_URL */
    ]) !== null && _d !== void 0 ? _d : null;
    this.languageCode = (_e = searchParams[
      "languageCode"
      /* QueryField.LANGUAGE_CODE */
    ]) !== null && _e !== void 0 ? _e : null;
    this.tenantId = (_f = searchParams[
      "tenantId"
      /* QueryField.TENANT_ID */
    ]) !== null && _f !== void 0 ? _f : null;
  }
  /**
   * Parses the email action link string and returns an {@link ActionCodeURL} if the link is valid,
   * otherwise returns null.
   *
   * @param link  - The email action link string.
   * @returns The {@link ActionCodeURL} object, or null if the link is invalid.
   *
   * @public
   */
  static parseLink(link) {
    const actionLink = parseDeepLink(link);
    try {
      return new ActionCodeURL(actionLink);
    } catch (_a) {
      return null;
    }
  }
};
var EmailAuthProvider = class {
  constructor() {
    this.providerId = EmailAuthProvider.PROVIDER_ID;
  }
  /**
   * Initialize an {@link AuthCredential} using an email and password.
   *
   * @example
   * ```javascript
   * const authCredential = EmailAuthProvider.credential(email, password);
   * const userCredential = await signInWithCredential(auth, authCredential);
   * ```
   *
   * @example
   * ```javascript
   * const userCredential = await signInWithEmailAndPassword(auth, email, password);
   * ```
   *
   * @param email - Email address.
   * @param password - User account password.
   * @returns The auth provider credential.
   */
  static credential(email, password) {
    return EmailAuthCredential._fromEmailAndPassword(email, password);
  }
  /**
   * Initialize an {@link AuthCredential} using an email and an email link after a sign in with
   * email link operation.
   *
   * @example
   * ```javascript
   * const authCredential = EmailAuthProvider.credentialWithLink(auth, email, emailLink);
   * const userCredential = await signInWithCredential(auth, authCredential);
   * ```
   *
   * @example
   * ```javascript
   * await sendSignInLinkToEmail(auth, email);
   * // Obtain emailLink from user.
   * const userCredential = await signInWithEmailLink(auth, email, emailLink);
   * ```
   *
   * @param auth - The {@link Auth} instance used to verify the link.
   * @param email - Email address.
   * @param emailLink - Sign-in email link.
   * @returns - The auth provider credential.
   */
  static credentialWithLink(email, emailLink) {
    const actionCodeUrl = ActionCodeURL.parseLink(emailLink);
    _assert(
      actionCodeUrl,
      "argument-error"
      /* AuthErrorCode.ARGUMENT_ERROR */
    );
    return EmailAuthCredential._fromEmailAndCode(email, actionCodeUrl.code, actionCodeUrl.tenantId);
  }
};
EmailAuthProvider.PROVIDER_ID = "password";
EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD = "password";
EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD = "emailLink";
var FederatedAuthProvider = class {
  /**
   * Constructor for generic OAuth providers.
   *
   * @param providerId - Provider for which credentials should be generated.
   */
  constructor(providerId) {
    this.providerId = providerId;
    this.defaultLanguageCode = null;
    this.customParameters = {};
  }
  /**
   * Set the language gode.
   *
   * @param languageCode - language code
   */
  setDefaultLanguage(languageCode) {
    this.defaultLanguageCode = languageCode;
  }
  /**
   * Sets the OAuth custom parameters to pass in an OAuth request for popup and redirect sign-in
   * operations.
   *
   * @remarks
   * For a detailed list, check the reserved required OAuth 2.0 parameters such as `client_id`,
   * `redirect_uri`, `scope`, `response_type`, and `state` are not allowed and will be ignored.
   *
   * @param customOAuthParameters - The custom OAuth parameters to pass in the OAuth request.
   */
  setCustomParameters(customOAuthParameters) {
    this.customParameters = customOAuthParameters;
    return this;
  }
  /**
   * Retrieve the current list of {@link CustomParameters}.
   */
  getCustomParameters() {
    return this.customParameters;
  }
};
var BaseOAuthProvider = class extends FederatedAuthProvider {
  constructor() {
    super(...arguments);
    this.scopes = [];
  }
  /**
   * Add an OAuth scope to the credential.
   *
   * @param scope - Provider OAuth scope to add.
   */
  addScope(scope) {
    if (!this.scopes.includes(scope)) {
      this.scopes.push(scope);
    }
    return this;
  }
  /**
   * Retrieve the current list of OAuth scopes.
   */
  getScopes() {
    return [...this.scopes];
  }
};
var FacebookAuthProvider = class extends BaseOAuthProvider {
  constructor() {
    super(
      "facebook.com"
      /* ProviderId.FACEBOOK */
    );
  }
  /**
   * Creates a credential for Facebook.
   *
   * @example
   * ```javascript
   * // `event` from the Facebook auth.authResponseChange callback.
   * const credential = FacebookAuthProvider.credential(event.authResponse.accessToken);
   * const result = await signInWithCredential(credential);
   * ```
   *
   * @param accessToken - Facebook access token.
   */
  static credential(accessToken) {
    return OAuthCredential._fromParams({
      providerId: FacebookAuthProvider.PROVIDER_ID,
      signInMethod: FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,
      accessToken
    });
  }
  /**
   * Used to extract the underlying {@link OAuthCredential} from a {@link UserCredential}.
   *
   * @param userCredential - The user credential.
   */
  static credentialFromResult(userCredential) {
    return FacebookAuthProvider.credentialFromTaggedObject(userCredential);
  }
  /**
   * Used to extract the underlying {@link OAuthCredential} from a {@link AuthError} which was
   * thrown during a sign-in, link, or reauthenticate operation.
   *
   * @param userCredential - The user credential.
   */
  static credentialFromError(error) {
    return FacebookAuthProvider.credentialFromTaggedObject(error.customData || {});
  }
  static credentialFromTaggedObject({ _tokenResponse: tokenResponse }) {
    if (!tokenResponse || !("oauthAccessToken" in tokenResponse)) {
      return null;
    }
    if (!tokenResponse.oauthAccessToken) {
      return null;
    }
    try {
      return FacebookAuthProvider.credential(tokenResponse.oauthAccessToken);
    } catch (_a) {
      return null;
    }
  }
};
FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD = "facebook.com";
FacebookAuthProvider.PROVIDER_ID = "facebook.com";
var GoogleAuthProvider = class extends BaseOAuthProvider {
  constructor() {
    super(
      "google.com"
      /* ProviderId.GOOGLE */
    );
    this.addScope("profile");
  }
  /**
   * Creates a credential for Google. At least one of ID token and access token is required.
   *
   * @example
   * ```javascript
   * // \`googleUser\` from the onsuccess Google Sign In callback.
   * const credential = GoogleAuthProvider.credential(googleUser.getAuthResponse().id_token);
   * const result = await signInWithCredential(credential);
   * ```
   *
   * @param idToken - Google ID token.
   * @param accessToken - Google access token.
   */
  static credential(idToken, accessToken) {
    return OAuthCredential._fromParams({
      providerId: GoogleAuthProvider.PROVIDER_ID,
      signInMethod: GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,
      idToken,
      accessToken
    });
  }
  /**
   * Used to extract the underlying {@link OAuthCredential} from a {@link UserCredential}.
   *
   * @param userCredential - The user credential.
   */
  static credentialFromResult(userCredential) {
    return GoogleAuthProvider.credentialFromTaggedObject(userCredential);
  }
  /**
   * Used to extract the underlying {@link OAuthCredential} from a {@link AuthError} which was
   * thrown during a sign-in, link, or reauthenticate operation.
   *
   * @param userCredential - The user credential.
   */
  static credentialFromError(error) {
    return GoogleAuthProvider.credentialFromTaggedObject(error.customData || {});
  }
  static credentialFromTaggedObject({ _tokenResponse: tokenResponse }) {
    if (!tokenResponse) {
      return null;
    }
    const { oauthIdToken, oauthAccessToken } = tokenResponse;
    if (!oauthIdToken && !oauthAccessToken) {
      return null;
    }
    try {
      return GoogleAuthProvider.credential(oauthIdToken, oauthAccessToken);
    } catch (_a) {
      return null;
    }
  }
};
GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD = "google.com";
GoogleAuthProvider.PROVIDER_ID = "google.com";
var GithubAuthProvider = class extends BaseOAuthProvider {
  constructor() {
    super(
      "github.com"
      /* ProviderId.GITHUB */
    );
  }
  /**
   * Creates a credential for Github.
   *
   * @param accessToken - Github access token.
   */
  static credential(accessToken) {
    return OAuthCredential._fromParams({
      providerId: GithubAuthProvider.PROVIDER_ID,
      signInMethod: GithubAuthProvider.GITHUB_SIGN_IN_METHOD,
      accessToken
    });
  }
  /**
   * Used to extract the underlying {@link OAuthCredential} from a {@link UserCredential}.
   *
   * @param userCredential - The user credential.
   */
  static credentialFromResult(userCredential) {
    return GithubAuthProvider.credentialFromTaggedObject(userCredential);
  }
  /**
   * Used to extract the underlying {@link OAuthCredential} from a {@link AuthError} which was
   * thrown during a sign-in, link, or reauthenticate operation.
   *
   * @param userCredential - The user credential.
   */
  static credentialFromError(error) {
    return GithubAuthProvider.credentialFromTaggedObject(error.customData || {});
  }
  static credentialFromTaggedObject({ _tokenResponse: tokenResponse }) {
    if (!tokenResponse || !("oauthAccessToken" in tokenResponse)) {
      return null;
    }
    if (!tokenResponse.oauthAccessToken) {
      return null;
    }
    try {
      return GithubAuthProvider.credential(tokenResponse.oauthAccessToken);
    } catch (_a) {
      return null;
    }
  }
};
GithubAuthProvider.GITHUB_SIGN_IN_METHOD = "github.com";
GithubAuthProvider.PROVIDER_ID = "github.com";
var TwitterAuthProvider = class extends BaseOAuthProvider {
  constructor() {
    super(
      "twitter.com"
      /* ProviderId.TWITTER */
    );
  }
  /**
   * Creates a credential for Twitter.
   *
   * @param token - Twitter access token.
   * @param secret - Twitter secret.
   */
  static credential(token, secret) {
    return OAuthCredential._fromParams({
      providerId: TwitterAuthProvider.PROVIDER_ID,
      signInMethod: TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,
      oauthToken: token,
      oauthTokenSecret: secret
    });
  }
  /**
   * Used to extract the underlying {@link OAuthCredential} from a {@link UserCredential}.
   *
   * @param userCredential - The user credential.
   */
  static credentialFromResult(userCredential) {
    return TwitterAuthProvider.credentialFromTaggedObject(userCredential);
  }
  /**
   * Used to extract the underlying {@link OAuthCredential} from a {@link AuthError} which was
   * thrown during a sign-in, link, or reauthenticate operation.
   *
   * @param userCredential - The user credential.
   */
  static credentialFromError(error) {
    return TwitterAuthProvider.credentialFromTaggedObject(error.customData || {});
  }
  static credentialFromTaggedObject({ _tokenResponse: tokenResponse }) {
    if (!tokenResponse) {
      return null;
    }
    const { oauthAccessToken, oauthTokenSecret } = tokenResponse;
    if (!oauthAccessToken || !oauthTokenSecret) {
      return null;
    }
    try {
      return TwitterAuthProvider.credential(oauthAccessToken, oauthTokenSecret);
    } catch (_a) {
      return null;
    }
  }
};
TwitterAuthProvider.TWITTER_SIGN_IN_METHOD = "twitter.com";
TwitterAuthProvider.PROVIDER_ID = "twitter.com";
var UserCredentialImpl = class {
  constructor(params) {
    this.user = params.user;
    this.providerId = params.providerId;
    this._tokenResponse = params._tokenResponse;
    this.operationType = params.operationType;
  }
  static async _fromIdTokenResponse(auth2, operationType, idTokenResponse, isAnonymous = false) {
    const user = await UserImpl._fromIdTokenResponse(auth2, idTokenResponse, isAnonymous);
    const providerId = providerIdForResponse(idTokenResponse);
    const userCred = new UserCredentialImpl({
      user,
      providerId,
      _tokenResponse: idTokenResponse,
      operationType
    });
    return userCred;
  }
  static async _forOperation(user, operationType, response) {
    await user._updateTokensIfNecessary(
      response,
      /* reload */
      true
    );
    const providerId = providerIdForResponse(response);
    return new UserCredentialImpl({
      user,
      providerId,
      _tokenResponse: response,
      operationType
    });
  }
};
function providerIdForResponse(response) {
  if (response.providerId) {
    return response.providerId;
  }
  if ("phoneNumber" in response) {
    return "phone";
  }
  return null;
}
var MultiFactorError = class extends FirebaseError {
  constructor(auth2, error, operationType, user) {
    var _a;
    super(error.code, error.message);
    this.operationType = operationType;
    this.user = user;
    Object.setPrototypeOf(this, MultiFactorError.prototype);
    this.customData = {
      appName: auth2.name,
      tenantId: (_a = auth2.tenantId) !== null && _a !== void 0 ? _a : void 0,
      _serverResponse: error.customData._serverResponse,
      operationType
    };
  }
  static _fromErrorAndOperation(auth2, error, operationType, user) {
    return new MultiFactorError(auth2, error, operationType, user);
  }
};
function _processCredentialSavingMfaContextIfNecessary(auth2, operationType, credential, user) {
  const idTokenProvider = operationType === "reauthenticate" ? credential._getReauthenticationResolver(auth2) : credential._getIdTokenResponse(auth2);
  return idTokenProvider.catch((error) => {
    if (error.code === `auth/${"multi-factor-auth-required"}`) {
      throw MultiFactorError._fromErrorAndOperation(auth2, error, operationType, user);
    }
    throw error;
  });
}
async function _link$1(user, credential, bypassAuthState = false) {
  const response = await _logoutIfInvalidated(user, credential._linkToIdToken(user.auth, await user.getIdToken()), bypassAuthState);
  return UserCredentialImpl._forOperation(user, "link", response);
}
async function _reauthenticate(user, credential, bypassAuthState = false) {
  const { auth: auth2 } = user;
  const operationType = "reauthenticate";
  try {
    const response = await _logoutIfInvalidated(user, _processCredentialSavingMfaContextIfNecessary(auth2, operationType, credential, user), bypassAuthState);
    _assert(
      response.idToken,
      auth2,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    const parsed = _parseToken(response.idToken);
    _assert(
      parsed,
      auth2,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    const { sub: localId } = parsed;
    _assert(
      user.uid === localId,
      auth2,
      "user-mismatch"
      /* AuthErrorCode.USER_MISMATCH */
    );
    return UserCredentialImpl._forOperation(user, operationType, response);
  } catch (e) {
    if ((e === null || e === void 0 ? void 0 : e.code) === `auth/${"user-not-found"}`) {
      _fail(
        auth2,
        "user-mismatch"
        /* AuthErrorCode.USER_MISMATCH */
      );
    }
    throw e;
  }
}
async function _signInWithCredential(auth2, credential, bypassAuthState = false) {
  const operationType = "signIn";
  const response = await _processCredentialSavingMfaContextIfNecessary(auth2, operationType, credential);
  const userCredential = await UserCredentialImpl._fromIdTokenResponse(auth2, operationType, response);
  if (!bypassAuthState) {
    await auth2._updateCurrentUser(userCredential.user);
  }
  return userCredential;
}
function onIdTokenChanged(auth2, nextOrObserver, error, completed) {
  return getModularInstance(auth2).onIdTokenChanged(nextOrObserver, error, completed);
}
function beforeAuthStateChanged(auth2, callback, onAbort) {
  return getModularInstance(auth2).beforeAuthStateChanged(callback, onAbort);
}
function startEnrollPhoneMfa(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v2/accounts/mfaEnrollment:start", _addTidIfNecessary(auth2, request));
}
function finalizeEnrollPhoneMfa(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v2/accounts/mfaEnrollment:finalize", _addTidIfNecessary(auth2, request));
}
function startEnrollTotpMfa(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v2/accounts/mfaEnrollment:start", _addTidIfNecessary(auth2, request));
}
function finalizeEnrollTotpMfa(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v2/accounts/mfaEnrollment:finalize", _addTidIfNecessary(auth2, request));
}
var STORAGE_AVAILABLE_KEY = "__sak";
var BrowserPersistenceClass = class {
  constructor(storageRetriever, type) {
    this.storageRetriever = storageRetriever;
    this.type = type;
  }
  _isAvailable() {
    try {
      if (!this.storage) {
        return Promise.resolve(false);
      }
      this.storage.setItem(STORAGE_AVAILABLE_KEY, "1");
      this.storage.removeItem(STORAGE_AVAILABLE_KEY);
      return Promise.resolve(true);
    } catch (_a) {
      return Promise.resolve(false);
    }
  }
  _set(key, value) {
    this.storage.setItem(key, JSON.stringify(value));
    return Promise.resolve();
  }
  _get(key) {
    const json = this.storage.getItem(key);
    return Promise.resolve(json ? JSON.parse(json) : null);
  }
  _remove(key) {
    this.storage.removeItem(key);
    return Promise.resolve();
  }
  get storage() {
    return this.storageRetriever();
  }
};
function _iframeCannotSyncWebStorage() {
  const ua = getUA();
  return _isSafari(ua) || _isIOS(ua);
}
var _POLLING_INTERVAL_MS$1 = 1e3;
var IE10_LOCAL_STORAGE_SYNC_DELAY = 10;
var BrowserLocalPersistence = class extends BrowserPersistenceClass {
  constructor() {
    super(
      () => window.localStorage,
      "LOCAL"
      /* PersistenceType.LOCAL */
    );
    this.boundEventHandler = (event, poll) => this.onStorageEvent(event, poll);
    this.listeners = {};
    this.localCache = {};
    this.pollTimer = null;
    this.safariLocalStorageNotSynced = _iframeCannotSyncWebStorage() && _isIframe();
    this.fallbackToPolling = _isMobileBrowser();
    this._shouldAllowMigration = true;
  }
  forAllChangedKeys(cb) {
    for (const key of Object.keys(this.listeners)) {
      const newValue = this.storage.getItem(key);
      const oldValue = this.localCache[key];
      if (newValue !== oldValue) {
        cb(key, oldValue, newValue);
      }
    }
  }
  onStorageEvent(event, poll = false) {
    if (!event.key) {
      this.forAllChangedKeys((key2, _oldValue, newValue) => {
        this.notifyListeners(key2, newValue);
      });
      return;
    }
    const key = event.key;
    if (poll) {
      this.detachListener();
    } else {
      this.stopPolling();
    }
    if (this.safariLocalStorageNotSynced) {
      const storedValue2 = this.storage.getItem(key);
      if (event.newValue !== storedValue2) {
        if (event.newValue !== null) {
          this.storage.setItem(key, event.newValue);
        } else {
          this.storage.removeItem(key);
        }
      } else if (this.localCache[key] === event.newValue && !poll) {
        return;
      }
    }
    const triggerListeners = () => {
      const storedValue2 = this.storage.getItem(key);
      if (!poll && this.localCache[key] === storedValue2) {
        return;
      }
      this.notifyListeners(key, storedValue2);
    };
    const storedValue = this.storage.getItem(key);
    if (_isIE10() && storedValue !== event.newValue && event.newValue !== event.oldValue) {
      setTimeout(triggerListeners, IE10_LOCAL_STORAGE_SYNC_DELAY);
    } else {
      triggerListeners();
    }
  }
  notifyListeners(key, value) {
    this.localCache[key] = value;
    const listeners = this.listeners[key];
    if (listeners) {
      for (const listener of Array.from(listeners)) {
        listener(value ? JSON.parse(value) : value);
      }
    }
  }
  startPolling() {
    this.stopPolling();
    this.pollTimer = setInterval(() => {
      this.forAllChangedKeys((key, oldValue, newValue) => {
        this.onStorageEvent(
          new StorageEvent("storage", {
            key,
            oldValue,
            newValue
          }),
          /* poll */
          true
        );
      });
    }, _POLLING_INTERVAL_MS$1);
  }
  stopPolling() {
    if (this.pollTimer) {
      clearInterval(this.pollTimer);
      this.pollTimer = null;
    }
  }
  attachListener() {
    window.addEventListener("storage", this.boundEventHandler);
  }
  detachListener() {
    window.removeEventListener("storage", this.boundEventHandler);
  }
  _addListener(key, listener) {
    if (Object.keys(this.listeners).length === 0) {
      if (this.fallbackToPolling) {
        this.startPolling();
      } else {
        this.attachListener();
      }
    }
    if (!this.listeners[key]) {
      this.listeners[key] = /* @__PURE__ */ new Set();
      this.localCache[key] = this.storage.getItem(key);
    }
    this.listeners[key].add(listener);
  }
  _removeListener(key, listener) {
    if (this.listeners[key]) {
      this.listeners[key].delete(listener);
      if (this.listeners[key].size === 0) {
        delete this.listeners[key];
      }
    }
    if (Object.keys(this.listeners).length === 0) {
      this.detachListener();
      this.stopPolling();
    }
  }
  // Update local cache on base operations:
  async _set(key, value) {
    await super._set(key, value);
    this.localCache[key] = JSON.stringify(value);
  }
  async _get(key) {
    const value = await super._get(key);
    this.localCache[key] = JSON.stringify(value);
    return value;
  }
  async _remove(key) {
    await super._remove(key);
    delete this.localCache[key];
  }
};
BrowserLocalPersistence.type = "LOCAL";
var browserLocalPersistence = BrowserLocalPersistence;
var BrowserSessionPersistence = class extends BrowserPersistenceClass {
  constructor() {
    super(
      () => window.sessionStorage,
      "SESSION"
      /* PersistenceType.SESSION */
    );
  }
  _addListener(_key, _listener) {
    return;
  }
  _removeListener(_key, _listener) {
    return;
  }
};
BrowserSessionPersistence.type = "SESSION";
var browserSessionPersistence = BrowserSessionPersistence;
function _allSettled(promises) {
  return Promise.all(promises.map(async (promise) => {
    try {
      const value = await promise;
      return {
        fulfilled: true,
        value
      };
    } catch (reason) {
      return {
        fulfilled: false,
        reason
      };
    }
  }));
}
var Receiver = class {
  constructor(eventTarget) {
    this.eventTarget = eventTarget;
    this.handlersMap = {};
    this.boundEventHandler = this.handleEvent.bind(this);
  }
  /**
   * Obtain an instance of a Receiver for a given event target, if none exists it will be created.
   *
   * @param eventTarget - An event target (such as window or self) through which the underlying
   * messages will be received.
   */
  static _getInstance(eventTarget) {
    const existingInstance = this.receivers.find((receiver) => receiver.isListeningto(eventTarget));
    if (existingInstance) {
      return existingInstance;
    }
    const newInstance = new Receiver(eventTarget);
    this.receivers.push(newInstance);
    return newInstance;
  }
  isListeningto(eventTarget) {
    return this.eventTarget === eventTarget;
  }
  /**
   * Fans out a MessageEvent to the appropriate listeners.
   *
   * @remarks
   * Sends an {@link Status.ACK} upon receipt and a {@link Status.DONE} once all handlers have
   * finished processing.
   *
   * @param event - The MessageEvent.
   *
   */
  async handleEvent(event) {
    const messageEvent = event;
    const { eventId, eventType, data } = messageEvent.data;
    const handlers = this.handlersMap[eventType];
    if (!(handlers === null || handlers === void 0 ? void 0 : handlers.size)) {
      return;
    }
    messageEvent.ports[0].postMessage({
      status: "ack",
      eventId,
      eventType
    });
    const promises = Array.from(handlers).map(async (handler) => handler(messageEvent.origin, data));
    const response = await _allSettled(promises);
    messageEvent.ports[0].postMessage({
      status: "done",
      eventId,
      eventType,
      response
    });
  }
  /**
   * Subscribe an event handler for a particular event.
   *
   * @param eventType - Event name to subscribe to.
   * @param eventHandler - The event handler which should receive the events.
   *
   */
  _subscribe(eventType, eventHandler) {
    if (Object.keys(this.handlersMap).length === 0) {
      this.eventTarget.addEventListener("message", this.boundEventHandler);
    }
    if (!this.handlersMap[eventType]) {
      this.handlersMap[eventType] = /* @__PURE__ */ new Set();
    }
    this.handlersMap[eventType].add(eventHandler);
  }
  /**
   * Unsubscribe an event handler from a particular event.
   *
   * @param eventType - Event name to unsubscribe from.
   * @param eventHandler - Optinoal event handler, if none provided, unsubscribe all handlers on this event.
   *
   */
  _unsubscribe(eventType, eventHandler) {
    if (this.handlersMap[eventType] && eventHandler) {
      this.handlersMap[eventType].delete(eventHandler);
    }
    if (!eventHandler || this.handlersMap[eventType].size === 0) {
      delete this.handlersMap[eventType];
    }
    if (Object.keys(this.handlersMap).length === 0) {
      this.eventTarget.removeEventListener("message", this.boundEventHandler);
    }
  }
};
Receiver.receivers = [];
function _generateEventId(prefix = "", digits = 10) {
  let random = "";
  for (let i = 0; i < digits; i++) {
    random += Math.floor(Math.random() * 10);
  }
  return prefix + random;
}
var Sender = class {
  constructor(target) {
    this.target = target;
    this.handlers = /* @__PURE__ */ new Set();
  }
  /**
   * Unsubscribe the handler and remove it from our tracking Set.
   *
   * @param handler - The handler to unsubscribe.
   */
  removeMessageHandler(handler) {
    if (handler.messageChannel) {
      handler.messageChannel.port1.removeEventListener("message", handler.onMessage);
      handler.messageChannel.port1.close();
    }
    this.handlers.delete(handler);
  }
  /**
   * Send a message to the Receiver located at {@link target}.
   *
   * @remarks
   * We'll first wait a bit for an ACK , if we get one we will wait significantly longer until the
   * receiver has had a chance to fully process the event.
   *
   * @param eventType - Type of event to send.
   * @param data - The payload of the event.
   * @param timeout - Timeout for waiting on an ACK from the receiver.
   *
   * @returns An array of settled promises from all the handlers that were listening on the receiver.
   */
  async _send(eventType, data, timeout = 50) {
    const messageChannel = typeof MessageChannel !== "undefined" ? new MessageChannel() : null;
    if (!messageChannel) {
      throw new Error(
        "connection_unavailable"
        /* _MessageError.CONNECTION_UNAVAILABLE */
      );
    }
    let completionTimer;
    let handler;
    return new Promise((resolve, reject) => {
      const eventId = _generateEventId("", 20);
      messageChannel.port1.start();
      const ackTimer = setTimeout(() => {
        reject(new Error(
          "unsupported_event"
          /* _MessageError.UNSUPPORTED_EVENT */
        ));
      }, timeout);
      handler = {
        messageChannel,
        onMessage(event) {
          const messageEvent = event;
          if (messageEvent.data.eventId !== eventId) {
            return;
          }
          switch (messageEvent.data.status) {
            case "ack":
              clearTimeout(ackTimer);
              completionTimer = setTimeout(
                () => {
                  reject(new Error(
                    "timeout"
                    /* _MessageError.TIMEOUT */
                  ));
                },
                3e3
                /* _TimeoutDuration.COMPLETION */
              );
              break;
            case "done":
              clearTimeout(completionTimer);
              resolve(messageEvent.data.response);
              break;
            default:
              clearTimeout(ackTimer);
              clearTimeout(completionTimer);
              reject(new Error(
                "invalid_response"
                /* _MessageError.INVALID_RESPONSE */
              ));
              break;
          }
        }
      };
      this.handlers.add(handler);
      messageChannel.port1.addEventListener("message", handler.onMessage);
      this.target.postMessage({
        eventType,
        eventId,
        data
      }, [messageChannel.port2]);
    }).finally(() => {
      if (handler) {
        this.removeMessageHandler(handler);
      }
    });
  }
};
function _window() {
  return window;
}
function _setWindowLocation(url) {
  _window().location.href = url;
}
function _isWorker() {
  return typeof _window()["WorkerGlobalScope"] !== "undefined" && typeof _window()["importScripts"] === "function";
}
async function _getActiveServiceWorker() {
  if (!(navigator === null || navigator === void 0 ? void 0 : navigator.serviceWorker)) {
    return null;
  }
  try {
    const registration = await navigator.serviceWorker.ready;
    return registration.active;
  } catch (_a) {
    return null;
  }
}
function _getServiceWorkerController() {
  var _a;
  return ((_a = navigator === null || navigator === void 0 ? void 0 : navigator.serviceWorker) === null || _a === void 0 ? void 0 : _a.controller) || null;
}
function _getWorkerGlobalScope() {
  return _isWorker() ? self : null;
}
var DB_NAME2 = "firebaseLocalStorageDb";
var DB_VERSION2 = 1;
var DB_OBJECTSTORE_NAME = "firebaseLocalStorage";
var DB_DATA_KEYPATH = "fbase_key";
var DBPromise = class {
  constructor(request) {
    this.request = request;
  }
  toPromise() {
    return new Promise((resolve, reject) => {
      this.request.addEventListener("success", () => {
        resolve(this.request.result);
      });
      this.request.addEventListener("error", () => {
        reject(this.request.error);
      });
    });
  }
};
function getObjectStore(db, isReadWrite) {
  return db.transaction([DB_OBJECTSTORE_NAME], isReadWrite ? "readwrite" : "readonly").objectStore(DB_OBJECTSTORE_NAME);
}
function _deleteDatabase() {
  const request = indexedDB.deleteDatabase(DB_NAME2);
  return new DBPromise(request).toPromise();
}
function _openDatabase() {
  const request = indexedDB.open(DB_NAME2, DB_VERSION2);
  return new Promise((resolve, reject) => {
    request.addEventListener("error", () => {
      reject(request.error);
    });
    request.addEventListener("upgradeneeded", () => {
      const db = request.result;
      try {
        db.createObjectStore(DB_OBJECTSTORE_NAME, { keyPath: DB_DATA_KEYPATH });
      } catch (e) {
        reject(e);
      }
    });
    request.addEventListener("success", async () => {
      const db = request.result;
      if (!db.objectStoreNames.contains(DB_OBJECTSTORE_NAME)) {
        db.close();
        await _deleteDatabase();
        resolve(await _openDatabase());
      } else {
        resolve(db);
      }
    });
  });
}
async function _putObject(db, key, value) {
  const request = getObjectStore(db, true).put({
    [DB_DATA_KEYPATH]: key,
    value
  });
  return new DBPromise(request).toPromise();
}
async function getObject(db, key) {
  const request = getObjectStore(db, false).get(key);
  const data = await new DBPromise(request).toPromise();
  return data === void 0 ? null : data.value;
}
function _deleteObject(db, key) {
  const request = getObjectStore(db, true).delete(key);
  return new DBPromise(request).toPromise();
}
var _POLLING_INTERVAL_MS = 800;
var _TRANSACTION_RETRY_COUNT = 3;
var IndexedDBLocalPersistence = class {
  constructor() {
    this.type = "LOCAL";
    this._shouldAllowMigration = true;
    this.listeners = {};
    this.localCache = {};
    this.pollTimer = null;
    this.pendingWrites = 0;
    this.receiver = null;
    this.sender = null;
    this.serviceWorkerReceiverAvailable = false;
    this.activeServiceWorker = null;
    this._workerInitializationPromise = this.initializeServiceWorkerMessaging().then(() => {
    }, () => {
    });
  }
  async _openDb() {
    if (this.db) {
      return this.db;
    }
    this.db = await _openDatabase();
    return this.db;
  }
  async _withRetries(op) {
    let numAttempts = 0;
    while (true) {
      try {
        const db = await this._openDb();
        return await op(db);
      } catch (e) {
        if (numAttempts++ > _TRANSACTION_RETRY_COUNT) {
          throw e;
        }
        if (this.db) {
          this.db.close();
          this.db = void 0;
        }
      }
    }
  }
  /**
   * IndexedDB events do not propagate from the main window to the worker context.  We rely on a
   * postMessage interface to send these events to the worker ourselves.
   */
  async initializeServiceWorkerMessaging() {
    return _isWorker() ? this.initializeReceiver() : this.initializeSender();
  }
  /**
   * As the worker we should listen to events from the main window.
   */
  async initializeReceiver() {
    this.receiver = Receiver._getInstance(_getWorkerGlobalScope());
    this.receiver._subscribe("keyChanged", async (_origin, data) => {
      const keys = await this._poll();
      return {
        keyProcessed: keys.includes(data.key)
      };
    });
    this.receiver._subscribe("ping", async (_origin, _data) => {
      return [
        "keyChanged"
        /* _EventType.KEY_CHANGED */
      ];
    });
  }
  /**
   * As the main window, we should let the worker know when keys change (set and remove).
   *
   * @remarks
   * {@link https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerContainer/ready | ServiceWorkerContainer.ready}
   * may not resolve.
   */
  async initializeSender() {
    var _a, _b;
    this.activeServiceWorker = await _getActiveServiceWorker();
    if (!this.activeServiceWorker) {
      return;
    }
    this.sender = new Sender(this.activeServiceWorker);
    const results = await this.sender._send(
      "ping",
      {},
      800
      /* _TimeoutDuration.LONG_ACK */
    );
    if (!results) {
      return;
    }
    if (((_a = results[0]) === null || _a === void 0 ? void 0 : _a.fulfilled) && ((_b = results[0]) === null || _b === void 0 ? void 0 : _b.value.includes(
      "keyChanged"
      /* _EventType.KEY_CHANGED */
    ))) {
      this.serviceWorkerReceiverAvailable = true;
    }
  }
  /**
   * Let the worker know about a changed key, the exact key doesn't technically matter since the
   * worker will just trigger a full sync anyway.
   *
   * @remarks
   * For now, we only support one service worker per page.
   *
   * @param key - Storage key which changed.
   */
  async notifyServiceWorker(key) {
    if (!this.sender || !this.activeServiceWorker || _getServiceWorkerController() !== this.activeServiceWorker) {
      return;
    }
    try {
      await this.sender._send(
        "keyChanged",
        { key },
        // Use long timeout if receiver has previously responded to a ping from us.
        this.serviceWorkerReceiverAvailable ? 800 : 50
        /* _TimeoutDuration.ACK */
      );
    } catch (_a) {
    }
  }
  async _isAvailable() {
    try {
      if (!indexedDB) {
        return false;
      }
      const db = await _openDatabase();
      await _putObject(db, STORAGE_AVAILABLE_KEY, "1");
      await _deleteObject(db, STORAGE_AVAILABLE_KEY);
      return true;
    } catch (_a) {
    }
    return false;
  }
  async _withPendingWrite(write) {
    this.pendingWrites++;
    try {
      await write();
    } finally {
      this.pendingWrites--;
    }
  }
  async _set(key, value) {
    return this._withPendingWrite(async () => {
      await this._withRetries((db) => _putObject(db, key, value));
      this.localCache[key] = value;
      return this.notifyServiceWorker(key);
    });
  }
  async _get(key) {
    const obj = await this._withRetries((db) => getObject(db, key));
    this.localCache[key] = obj;
    return obj;
  }
  async _remove(key) {
    return this._withPendingWrite(async () => {
      await this._withRetries((db) => _deleteObject(db, key));
      delete this.localCache[key];
      return this.notifyServiceWorker(key);
    });
  }
  async _poll() {
    const result = await this._withRetries((db) => {
      const getAllRequest = getObjectStore(db, false).getAll();
      return new DBPromise(getAllRequest).toPromise();
    });
    if (!result) {
      return [];
    }
    if (this.pendingWrites !== 0) {
      return [];
    }
    const keys = [];
    const keysInResult = /* @__PURE__ */ new Set();
    for (const { fbase_key: key, value } of result) {
      keysInResult.add(key);
      if (JSON.stringify(this.localCache[key]) !== JSON.stringify(value)) {
        this.notifyListeners(key, value);
        keys.push(key);
      }
    }
    for (const localKey of Object.keys(this.localCache)) {
      if (this.localCache[localKey] && !keysInResult.has(localKey)) {
        this.notifyListeners(localKey, null);
        keys.push(localKey);
      }
    }
    return keys;
  }
  notifyListeners(key, newValue) {
    this.localCache[key] = newValue;
    const listeners = this.listeners[key];
    if (listeners) {
      for (const listener of Array.from(listeners)) {
        listener(newValue);
      }
    }
  }
  startPolling() {
    this.stopPolling();
    this.pollTimer = setInterval(async () => this._poll(), _POLLING_INTERVAL_MS);
  }
  stopPolling() {
    if (this.pollTimer) {
      clearInterval(this.pollTimer);
      this.pollTimer = null;
    }
  }
  _addListener(key, listener) {
    if (Object.keys(this.listeners).length === 0) {
      this.startPolling();
    }
    if (!this.listeners[key]) {
      this.listeners[key] = /* @__PURE__ */ new Set();
      void this._get(key);
    }
    this.listeners[key].add(listener);
  }
  _removeListener(key, listener) {
    if (this.listeners[key]) {
      this.listeners[key].delete(listener);
      if (this.listeners[key].size === 0) {
        delete this.listeners[key];
      }
    }
    if (Object.keys(this.listeners).length === 0) {
      this.stopPolling();
    }
  }
};
IndexedDBLocalPersistence.type = "LOCAL";
var indexedDBLocalPersistence = IndexedDBLocalPersistence;
function startSignInPhoneMfa(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v2/accounts/mfaSignIn:start", _addTidIfNecessary(auth2, request));
}
function finalizeSignInPhoneMfa(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v2/accounts/mfaSignIn:finalize", _addTidIfNecessary(auth2, request));
}
function finalizeSignInTotpMfa(auth2, request) {
  return _performApiRequest(auth2, "POST", "/v2/accounts/mfaSignIn:finalize", _addTidIfNecessary(auth2, request));
}
var _JSLOAD_CALLBACK = _generateCallbackName("rcb");
var NETWORK_TIMEOUT_DELAY = new Delay(3e4, 6e4);
var RECAPTCHA_VERIFIER_TYPE = "recaptcha";
async function _verifyPhoneNumber(auth2, options, verifier) {
  var _a;
  const recaptchaToken = await verifier.verify();
  try {
    _assert(
      typeof recaptchaToken === "string",
      auth2,
      "argument-error"
      /* AuthErrorCode.ARGUMENT_ERROR */
    );
    _assert(
      verifier.type === RECAPTCHA_VERIFIER_TYPE,
      auth2,
      "argument-error"
      /* AuthErrorCode.ARGUMENT_ERROR */
    );
    let phoneInfoOptions;
    if (typeof options === "string") {
      phoneInfoOptions = {
        phoneNumber: options
      };
    } else {
      phoneInfoOptions = options;
    }
    if ("session" in phoneInfoOptions) {
      const session = phoneInfoOptions.session;
      if ("phoneNumber" in phoneInfoOptions) {
        _assert(
          session.type === "enroll",
          auth2,
          "internal-error"
          /* AuthErrorCode.INTERNAL_ERROR */
        );
        const response = await startEnrollPhoneMfa(auth2, {
          idToken: session.credential,
          phoneEnrollmentInfo: {
            phoneNumber: phoneInfoOptions.phoneNumber,
            recaptchaToken
          }
        });
        return response.phoneSessionInfo.sessionInfo;
      } else {
        _assert(
          session.type === "signin",
          auth2,
          "internal-error"
          /* AuthErrorCode.INTERNAL_ERROR */
        );
        const mfaEnrollmentId = ((_a = phoneInfoOptions.multiFactorHint) === null || _a === void 0 ? void 0 : _a.uid) || phoneInfoOptions.multiFactorUid;
        _assert(
          mfaEnrollmentId,
          auth2,
          "missing-multi-factor-info"
          /* AuthErrorCode.MISSING_MFA_INFO */
        );
        const response = await startSignInPhoneMfa(auth2, {
          mfaPendingCredential: session.credential,
          mfaEnrollmentId,
          phoneSignInInfo: {
            recaptchaToken
          }
        });
        return response.phoneResponseInfo.sessionInfo;
      }
    } else {
      const { sessionInfo } = await sendPhoneVerificationCode(auth2, {
        phoneNumber: phoneInfoOptions.phoneNumber,
        recaptchaToken
      });
      return sessionInfo;
    }
  } finally {
    verifier._reset();
  }
}
var PhoneAuthProvider = class {
  /**
   * @param auth - The Firebase {@link Auth} instance in which sign-ins should occur.
   *
   */
  constructor(auth2) {
    this.providerId = PhoneAuthProvider.PROVIDER_ID;
    this.auth = _castAuth(auth2);
  }
  /**
   *
   * Starts a phone number authentication flow by sending a verification code to the given phone
   * number.
   *
   * @example
   * ```javascript
   * const provider = new PhoneAuthProvider(auth);
   * const verificationId = await provider.verifyPhoneNumber(phoneNumber, applicationVerifier);
   * // Obtain verificationCode from the user.
   * const authCredential = PhoneAuthProvider.credential(verificationId, verificationCode);
   * const userCredential = await signInWithCredential(auth, authCredential);
   * ```
   *
   * @example
   * An alternative flow is provided using the `signInWithPhoneNumber` method.
   * ```javascript
   * const confirmationResult = signInWithPhoneNumber(auth, phoneNumber, applicationVerifier);
   * // Obtain verificationCode from the user.
   * const userCredential = confirmationResult.confirm(verificationCode);
   * ```
   *
   * @param phoneInfoOptions - The user's {@link PhoneInfoOptions}. The phone number should be in
   * E.164 format (e.g. +16505550101).
   * @param applicationVerifier - For abuse prevention, this method also requires a
   * {@link ApplicationVerifier}. This SDK includes a reCAPTCHA-based implementation,
   * {@link RecaptchaVerifier}.
   *
   * @returns A Promise for a verification ID that can be passed to
   * {@link PhoneAuthProvider.credential} to identify this flow..
   */
  verifyPhoneNumber(phoneOptions, applicationVerifier) {
    return _verifyPhoneNumber(this.auth, phoneOptions, getModularInstance(applicationVerifier));
  }
  /**
   * Creates a phone auth credential, given the verification ID from
   * {@link PhoneAuthProvider.verifyPhoneNumber} and the code that was sent to the user's
   * mobile device.
   *
   * @example
   * ```javascript
   * const provider = new PhoneAuthProvider(auth);
   * const verificationId = provider.verifyPhoneNumber(phoneNumber, applicationVerifier);
   * // Obtain verificationCode from the user.
   * const authCredential = PhoneAuthProvider.credential(verificationId, verificationCode);
   * const userCredential = signInWithCredential(auth, authCredential);
   * ```
   *
   * @example
   * An alternative flow is provided using the `signInWithPhoneNumber` method.
   * ```javascript
   * const confirmationResult = await signInWithPhoneNumber(auth, phoneNumber, applicationVerifier);
   * // Obtain verificationCode from the user.
   * const userCredential = await confirmationResult.confirm(verificationCode);
   * ```
   *
   * @param verificationId - The verification ID returned from {@link PhoneAuthProvider.verifyPhoneNumber}.
   * @param verificationCode - The verification code sent to the user's mobile device.
   *
   * @returns The auth provider credential.
   */
  static credential(verificationId, verificationCode) {
    return PhoneAuthCredential._fromVerification(verificationId, verificationCode);
  }
  /**
   * Generates an {@link AuthCredential} from a {@link UserCredential}.
   * @param userCredential - The user credential.
   */
  static credentialFromResult(userCredential) {
    const credential = userCredential;
    return PhoneAuthProvider.credentialFromTaggedObject(credential);
  }
  /**
   * Returns an {@link AuthCredential} when passed an error.
   *
   * @remarks
   *
   * This method works for errors like
   * `auth/account-exists-with-different-credentials`. This is useful for
   * recovering when attempting to set a user's phone number but the number
   * in question is already tied to another account. For example, the following
   * code tries to update the current user's phone number, and if that
   * fails, links the user with the account associated with that number:
   *
   * ```js
   * const provider = new PhoneAuthProvider(auth);
   * const verificationId = await provider.verifyPhoneNumber(number, verifier);
   * try {
   *   const code = ''; // Prompt the user for the verification code
   *   await updatePhoneNumber(
   *       auth.currentUser,
   *       PhoneAuthProvider.credential(verificationId, code));
   * } catch (e) {
   *   if ((e as FirebaseError)?.code === 'auth/account-exists-with-different-credential') {
   *     const cred = PhoneAuthProvider.credentialFromError(e);
   *     await linkWithCredential(auth.currentUser, cred);
   *   }
   * }
   *
   * // At this point, auth.currentUser.phoneNumber === number.
   * ```
   *
   * @param error - The error to generate a credential from.
   */
  static credentialFromError(error) {
    return PhoneAuthProvider.credentialFromTaggedObject(error.customData || {});
  }
  static credentialFromTaggedObject({ _tokenResponse: tokenResponse }) {
    if (!tokenResponse) {
      return null;
    }
    const { phoneNumber, temporaryProof } = tokenResponse;
    if (phoneNumber && temporaryProof) {
      return PhoneAuthCredential._fromTokenResponse(phoneNumber, temporaryProof);
    }
    return null;
  }
};
PhoneAuthProvider.PROVIDER_ID = "phone";
PhoneAuthProvider.PHONE_SIGN_IN_METHOD = "phone";
function _withDefaultResolver(auth2, resolverOverride) {
  if (resolverOverride) {
    return _getInstance(resolverOverride);
  }
  _assert(
    auth2._popupRedirectResolver,
    auth2,
    "argument-error"
    /* AuthErrorCode.ARGUMENT_ERROR */
  );
  return auth2._popupRedirectResolver;
}
var IdpCredential = class extends AuthCredential {
  constructor(params) {
    super(
      "custom",
      "custom"
      /* ProviderId.CUSTOM */
    );
    this.params = params;
  }
  _getIdTokenResponse(auth2) {
    return signInWithIdp(auth2, this._buildIdpRequest());
  }
  _linkToIdToken(auth2, idToken) {
    return signInWithIdp(auth2, this._buildIdpRequest(idToken));
  }
  _getReauthenticationResolver(auth2) {
    return signInWithIdp(auth2, this._buildIdpRequest());
  }
  _buildIdpRequest(idToken) {
    const request = {
      requestUri: this.params.requestUri,
      sessionId: this.params.sessionId,
      postBody: this.params.postBody,
      tenantId: this.params.tenantId,
      pendingToken: this.params.pendingToken,
      returnSecureToken: true,
      returnIdpCredential: true
    };
    if (idToken) {
      request.idToken = idToken;
    }
    return request;
  }
};
function _signIn(params) {
  return _signInWithCredential(params.auth, new IdpCredential(params), params.bypassAuthState);
}
function _reauth(params) {
  const { auth: auth2, user } = params;
  _assert(
    user,
    auth2,
    "internal-error"
    /* AuthErrorCode.INTERNAL_ERROR */
  );
  return _reauthenticate(user, new IdpCredential(params), params.bypassAuthState);
}
async function _link(params) {
  const { auth: auth2, user } = params;
  _assert(
    user,
    auth2,
    "internal-error"
    /* AuthErrorCode.INTERNAL_ERROR */
  );
  return _link$1(user, new IdpCredential(params), params.bypassAuthState);
}
var AbstractPopupRedirectOperation = class {
  constructor(auth2, filter, resolver, user, bypassAuthState = false) {
    this.auth = auth2;
    this.resolver = resolver;
    this.user = user;
    this.bypassAuthState = bypassAuthState;
    this.pendingPromise = null;
    this.eventManager = null;
    this.filter = Array.isArray(filter) ? filter : [filter];
  }
  execute() {
    return new Promise(async (resolve, reject) => {
      this.pendingPromise = { resolve, reject };
      try {
        this.eventManager = await this.resolver._initialize(this.auth);
        await this.onExecution();
        this.eventManager.registerConsumer(this);
      } catch (e) {
        this.reject(e);
      }
    });
  }
  async onAuthEvent(event) {
    const { urlResponse, sessionId, postBody, tenantId, error, type } = event;
    if (error) {
      this.reject(error);
      return;
    }
    const params = {
      auth: this.auth,
      requestUri: urlResponse,
      sessionId,
      tenantId: tenantId || void 0,
      postBody: postBody || void 0,
      user: this.user,
      bypassAuthState: this.bypassAuthState
    };
    try {
      this.resolve(await this.getIdpTask(type)(params));
    } catch (e) {
      this.reject(e);
    }
  }
  onError(error) {
    this.reject(error);
  }
  getIdpTask(type) {
    switch (type) {
      case "signInViaPopup":
      case "signInViaRedirect":
        return _signIn;
      case "linkViaPopup":
      case "linkViaRedirect":
        return _link;
      case "reauthViaPopup":
      case "reauthViaRedirect":
        return _reauth;
      default:
        _fail(
          this.auth,
          "internal-error"
          /* AuthErrorCode.INTERNAL_ERROR */
        );
    }
  }
  resolve(cred) {
    debugAssert(this.pendingPromise, "Pending promise was never set");
    this.pendingPromise.resolve(cred);
    this.unregisterAndCleanUp();
  }
  reject(error) {
    debugAssert(this.pendingPromise, "Pending promise was never set");
    this.pendingPromise.reject(error);
    this.unregisterAndCleanUp();
  }
  unregisterAndCleanUp() {
    if (this.eventManager) {
      this.eventManager.unregisterConsumer(this);
    }
    this.pendingPromise = null;
    this.cleanUp();
  }
};
var _POLL_WINDOW_CLOSE_TIMEOUT = new Delay(2e3, 1e4);
async function signInWithPopup(auth2, provider2, resolver) {
  const authInternal = _castAuth(auth2);
  _assertInstanceOf(auth2, provider2, FederatedAuthProvider);
  const resolverInternal = _withDefaultResolver(authInternal, resolver);
  const action = new PopupOperation(authInternal, "signInViaPopup", provider2, resolverInternal);
  return action.executeNotNull();
}
var PopupOperation = class extends AbstractPopupRedirectOperation {
  constructor(auth2, filter, provider2, resolver, user) {
    super(auth2, filter, resolver, user);
    this.provider = provider2;
    this.authWindow = null;
    this.pollId = null;
    if (PopupOperation.currentPopupAction) {
      PopupOperation.currentPopupAction.cancel();
    }
    PopupOperation.currentPopupAction = this;
  }
  async executeNotNull() {
    const result = await this.execute();
    _assert(
      result,
      this.auth,
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    return result;
  }
  async onExecution() {
    debugAssert(this.filter.length === 1, "Popup operations only handle one event");
    const eventId = _generateEventId();
    this.authWindow = await this.resolver._openPopup(
      this.auth,
      this.provider,
      this.filter[0],
      // There's always one, see constructor
      eventId
    );
    this.authWindow.associatedEvent = eventId;
    this.resolver._originValidation(this.auth).catch((e) => {
      this.reject(e);
    });
    this.resolver._isIframeWebStorageSupported(this.auth, (isSupported) => {
      if (!isSupported) {
        this.reject(_createError(
          this.auth,
          "web-storage-unsupported"
          /* AuthErrorCode.WEB_STORAGE_UNSUPPORTED */
        ));
      }
    });
    this.pollUserCancellation();
  }
  get eventId() {
    var _a;
    return ((_a = this.authWindow) === null || _a === void 0 ? void 0 : _a.associatedEvent) || null;
  }
  cancel() {
    this.reject(_createError(
      this.auth,
      "cancelled-popup-request"
      /* AuthErrorCode.EXPIRED_POPUP_REQUEST */
    ));
  }
  cleanUp() {
    if (this.authWindow) {
      this.authWindow.close();
    }
    if (this.pollId) {
      window.clearTimeout(this.pollId);
    }
    this.authWindow = null;
    this.pollId = null;
    PopupOperation.currentPopupAction = null;
  }
  pollUserCancellation() {
    const poll = () => {
      var _a, _b;
      if ((_b = (_a = this.authWindow) === null || _a === void 0 ? void 0 : _a.window) === null || _b === void 0 ? void 0 : _b.closed) {
        this.pollId = window.setTimeout(
          () => {
            this.pollId = null;
            this.reject(_createError(
              this.auth,
              "popup-closed-by-user"
              /* AuthErrorCode.POPUP_CLOSED_BY_USER */
            ));
          },
          8e3
          /* _Timeout.AUTH_EVENT */
        );
        return;
      }
      this.pollId = window.setTimeout(poll, _POLL_WINDOW_CLOSE_TIMEOUT.get());
    };
    poll();
  }
};
PopupOperation.currentPopupAction = null;
var PENDING_REDIRECT_KEY = "pendingRedirect";
var redirectOutcomeMap = /* @__PURE__ */ new Map();
var RedirectAction = class extends AbstractPopupRedirectOperation {
  constructor(auth2, resolver, bypassAuthState = false) {
    super(auth2, [
      "signInViaRedirect",
      "linkViaRedirect",
      "reauthViaRedirect",
      "unknown"
      /* AuthEventType.UNKNOWN */
    ], resolver, void 0, bypassAuthState);
    this.eventId = null;
  }
  /**
   * Override the execute function; if we already have a redirect result, then
   * just return it.
   */
  async execute() {
    let readyOutcome = redirectOutcomeMap.get(this.auth._key());
    if (!readyOutcome) {
      try {
        const hasPendingRedirect = await _getAndClearPendingRedirectStatus(this.resolver, this.auth);
        const result = hasPendingRedirect ? await super.execute() : null;
        readyOutcome = () => Promise.resolve(result);
      } catch (e) {
        readyOutcome = () => Promise.reject(e);
      }
      redirectOutcomeMap.set(this.auth._key(), readyOutcome);
    }
    if (!this.bypassAuthState) {
      redirectOutcomeMap.set(this.auth._key(), () => Promise.resolve(null));
    }
    return readyOutcome();
  }
  async onAuthEvent(event) {
    if (event.type === "signInViaRedirect") {
      return super.onAuthEvent(event);
    } else if (event.type === "unknown") {
      this.resolve(null);
      return;
    }
    if (event.eventId) {
      const user = await this.auth._redirectUserForId(event.eventId);
      if (user) {
        this.user = user;
        return super.onAuthEvent(event);
      } else {
        this.resolve(null);
      }
    }
  }
  async onExecution() {
  }
  cleanUp() {
  }
};
async function _getAndClearPendingRedirectStatus(resolver, auth2) {
  const key = pendingRedirectKey(auth2);
  const persistence = resolverPersistence(resolver);
  if (!await persistence._isAvailable()) {
    return false;
  }
  const hasPendingRedirect = await persistence._get(key) === "true";
  await persistence._remove(key);
  return hasPendingRedirect;
}
function _overrideRedirectResult(auth2, result) {
  redirectOutcomeMap.set(auth2._key(), result);
}
function resolverPersistence(resolver) {
  return _getInstance(resolver._redirectPersistence);
}
function pendingRedirectKey(auth2) {
  return _persistenceKeyName(PENDING_REDIRECT_KEY, auth2.config.apiKey, auth2.name);
}
async function _getRedirectResult(auth2, resolverExtern, bypassAuthState = false) {
  const authInternal = _castAuth(auth2);
  const resolver = _withDefaultResolver(authInternal, resolverExtern);
  const action = new RedirectAction(authInternal, resolver, bypassAuthState);
  const result = await action.execute();
  if (result && !bypassAuthState) {
    delete result.user._redirectEventId;
    await authInternal._persistUserIfCurrent(result.user);
    await authInternal._setRedirectUser(null, resolverExtern);
  }
  return result;
}
var EVENT_DUPLICATION_CACHE_DURATION_MS = 10 * 60 * 1e3;
var AuthEventManager = class {
  constructor(auth2) {
    this.auth = auth2;
    this.cachedEventUids = /* @__PURE__ */ new Set();
    this.consumers = /* @__PURE__ */ new Set();
    this.queuedRedirectEvent = null;
    this.hasHandledPotentialRedirect = false;
    this.lastProcessedEventTime = Date.now();
  }
  registerConsumer(authEventConsumer) {
    this.consumers.add(authEventConsumer);
    if (this.queuedRedirectEvent && this.isEventForConsumer(this.queuedRedirectEvent, authEventConsumer)) {
      this.sendToConsumer(this.queuedRedirectEvent, authEventConsumer);
      this.saveEventToCache(this.queuedRedirectEvent);
      this.queuedRedirectEvent = null;
    }
  }
  unregisterConsumer(authEventConsumer) {
    this.consumers.delete(authEventConsumer);
  }
  onEvent(event) {
    if (this.hasEventBeenHandled(event)) {
      return false;
    }
    let handled = false;
    this.consumers.forEach((consumer) => {
      if (this.isEventForConsumer(event, consumer)) {
        handled = true;
        this.sendToConsumer(event, consumer);
        this.saveEventToCache(event);
      }
    });
    if (this.hasHandledPotentialRedirect || !isRedirectEvent(event)) {
      return handled;
    }
    this.hasHandledPotentialRedirect = true;
    if (!handled) {
      this.queuedRedirectEvent = event;
      handled = true;
    }
    return handled;
  }
  sendToConsumer(event, consumer) {
    var _a;
    if (event.error && !isNullRedirectEvent(event)) {
      const code = ((_a = event.error.code) === null || _a === void 0 ? void 0 : _a.split("auth/")[1]) || "internal-error";
      consumer.onError(_createError(this.auth, code));
    } else {
      consumer.onAuthEvent(event);
    }
  }
  isEventForConsumer(event, consumer) {
    const eventIdMatches = consumer.eventId === null || !!event.eventId && event.eventId === consumer.eventId;
    return consumer.filter.includes(event.type) && eventIdMatches;
  }
  hasEventBeenHandled(event) {
    if (Date.now() - this.lastProcessedEventTime >= EVENT_DUPLICATION_CACHE_DURATION_MS) {
      this.cachedEventUids.clear();
    }
    return this.cachedEventUids.has(eventUid(event));
  }
  saveEventToCache(event) {
    this.cachedEventUids.add(eventUid(event));
    this.lastProcessedEventTime = Date.now();
  }
};
function eventUid(e) {
  return [e.type, e.eventId, e.sessionId, e.tenantId].filter((v) => v).join("-");
}
function isNullRedirectEvent({ type, error }) {
  return type === "unknown" && (error === null || error === void 0 ? void 0 : error.code) === `auth/${"no-auth-event"}`;
}
function isRedirectEvent(event) {
  switch (event.type) {
    case "signInViaRedirect":
    case "linkViaRedirect":
    case "reauthViaRedirect":
      return true;
    case "unknown":
      return isNullRedirectEvent(event);
    default:
      return false;
  }
}
async function _getProjectConfig(auth2, request = {}) {
  return _performApiRequest(auth2, "GET", "/v1/projects", request);
}
var IP_ADDRESS_REGEX = /^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;
var HTTP_REGEX = /^https?/;
async function _validateOrigin(auth2) {
  if (auth2.config.emulator) {
    return;
  }
  const { authorizedDomains } = await _getProjectConfig(auth2);
  for (const domain of authorizedDomains) {
    try {
      if (matchDomain(domain)) {
        return;
      }
    } catch (_a) {
    }
  }
  _fail(
    auth2,
    "unauthorized-domain"
    /* AuthErrorCode.INVALID_ORIGIN */
  );
}
function matchDomain(expected) {
  const currentUrl = _getCurrentUrl();
  const { protocol, hostname } = new URL(currentUrl);
  if (expected.startsWith("chrome-extension://")) {
    const ceUrl = new URL(expected);
    if (ceUrl.hostname === "" && hostname === "") {
      return protocol === "chrome-extension:" && expected.replace("chrome-extension://", "") === currentUrl.replace("chrome-extension://", "");
    }
    return protocol === "chrome-extension:" && ceUrl.hostname === hostname;
  }
  if (!HTTP_REGEX.test(protocol)) {
    return false;
  }
  if (IP_ADDRESS_REGEX.test(expected)) {
    return hostname === expected;
  }
  const escapedDomainPattern = expected.replace(/\./g, "\\.");
  const re = new RegExp("^(.+\\." + escapedDomainPattern + "|" + escapedDomainPattern + ")$", "i");
  return re.test(hostname);
}
var NETWORK_TIMEOUT = new Delay(3e4, 6e4);
function resetUnloadedGapiModules() {
  const beacon = _window().___jsl;
  if (beacon === null || beacon === void 0 ? void 0 : beacon.H) {
    for (const hint of Object.keys(beacon.H)) {
      beacon.H[hint].r = beacon.H[hint].r || [];
      beacon.H[hint].L = beacon.H[hint].L || [];
      beacon.H[hint].r = [...beacon.H[hint].L];
      if (beacon.CP) {
        for (let i = 0; i < beacon.CP.length; i++) {
          beacon.CP[i] = null;
        }
      }
    }
  }
}
function loadGapi(auth2) {
  return new Promise((resolve, reject) => {
    var _a, _b, _c;
    function loadGapiIframe() {
      resetUnloadedGapiModules();
      gapi.load("gapi.iframes", {
        callback: () => {
          resolve(gapi.iframes.getContext());
        },
        ontimeout: () => {
          resetUnloadedGapiModules();
          reject(_createError(
            auth2,
            "network-request-failed"
            /* AuthErrorCode.NETWORK_REQUEST_FAILED */
          ));
        },
        timeout: NETWORK_TIMEOUT.get()
      });
    }
    if ((_b = (_a = _window().gapi) === null || _a === void 0 ? void 0 : _a.iframes) === null || _b === void 0 ? void 0 : _b.Iframe) {
      resolve(gapi.iframes.getContext());
    } else if (!!((_c = _window().gapi) === null || _c === void 0 ? void 0 : _c.load)) {
      loadGapiIframe();
    } else {
      const cbName = _generateCallbackName("iframefcb");
      _window()[cbName] = () => {
        if (!!gapi.load) {
          loadGapiIframe();
        } else {
          reject(_createError(
            auth2,
            "network-request-failed"
            /* AuthErrorCode.NETWORK_REQUEST_FAILED */
          ));
        }
      };
      return _loadJS(`https://apis.google.com/js/api.js?onload=${cbName}`).catch((e) => reject(e));
    }
  }).catch((error) => {
    cachedGApiLoader = null;
    throw error;
  });
}
var cachedGApiLoader = null;
function _loadGapi(auth2) {
  cachedGApiLoader = cachedGApiLoader || loadGapi(auth2);
  return cachedGApiLoader;
}
var PING_TIMEOUT = new Delay(5e3, 15e3);
var IFRAME_PATH = "__/auth/iframe";
var EMULATED_IFRAME_PATH = "emulator/auth/iframe";
var IFRAME_ATTRIBUTES = {
  style: {
    position: "absolute",
    top: "-100px",
    width: "1px",
    height: "1px"
  },
  "aria-hidden": "true",
  tabindex: "-1"
};
var EID_FROM_APIHOST = /* @__PURE__ */ new Map([
  ["identitytoolkit.googleapis.com", "p"],
  ["staging-identitytoolkit.sandbox.googleapis.com", "s"],
  ["test-identitytoolkit.sandbox.googleapis.com", "t"]
  // test
]);
function getIframeUrl(auth2) {
  const config = auth2.config;
  _assert(
    config.authDomain,
    auth2,
    "auth-domain-config-required"
    /* AuthErrorCode.MISSING_AUTH_DOMAIN */
  );
  const url = config.emulator ? _emulatorUrl(config, EMULATED_IFRAME_PATH) : `https://${auth2.config.authDomain}/${IFRAME_PATH}`;
  const params = {
    apiKey: config.apiKey,
    appName: auth2.name,
    v: SDK_VERSION
  };
  const eid = EID_FROM_APIHOST.get(auth2.config.apiHost);
  if (eid) {
    params.eid = eid;
  }
  const frameworks = auth2._getFrameworks();
  if (frameworks.length) {
    params.fw = frameworks.join(",");
  }
  return `${url}?${querystring(params).slice(1)}`;
}
async function _openIframe(auth2) {
  const context = await _loadGapi(auth2);
  const gapi2 = _window().gapi;
  _assert(
    gapi2,
    auth2,
    "internal-error"
    /* AuthErrorCode.INTERNAL_ERROR */
  );
  return context.open({
    where: document.body,
    url: getIframeUrl(auth2),
    messageHandlersFilter: gapi2.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
    attributes: IFRAME_ATTRIBUTES,
    dontclear: true
  }, (iframe) => new Promise(async (resolve, reject) => {
    await iframe.restyle({
      // Prevent iframe from closing on mouse out.
      setHideOnLeave: false
    });
    const networkError = _createError(
      auth2,
      "network-request-failed"
      /* AuthErrorCode.NETWORK_REQUEST_FAILED */
    );
    const networkErrorTimer = _window().setTimeout(() => {
      reject(networkError);
    }, PING_TIMEOUT.get());
    function clearTimerAndResolve() {
      _window().clearTimeout(networkErrorTimer);
      resolve(iframe);
    }
    iframe.ping(clearTimerAndResolve).then(clearTimerAndResolve, () => {
      reject(networkError);
    });
  }));
}
var BASE_POPUP_OPTIONS = {
  location: "yes",
  resizable: "yes",
  statusbar: "yes",
  toolbar: "no"
};
var DEFAULT_WIDTH = 500;
var DEFAULT_HEIGHT = 600;
var TARGET_BLANK = "_blank";
var FIREFOX_EMPTY_URL = "http://localhost";
var AuthPopup = class {
  constructor(window2) {
    this.window = window2;
    this.associatedEvent = null;
  }
  close() {
    if (this.window) {
      try {
        this.window.close();
      } catch (e) {
      }
    }
  }
};
function _open(auth2, url, name5, width = DEFAULT_WIDTH, height = DEFAULT_HEIGHT) {
  const top = Math.max((window.screen.availHeight - height) / 2, 0).toString();
  const left = Math.max((window.screen.availWidth - width) / 2, 0).toString();
  let target = "";
  const options = Object.assign(Object.assign({}, BASE_POPUP_OPTIONS), {
    width: width.toString(),
    height: height.toString(),
    top,
    left
  });
  const ua = getUA().toLowerCase();
  if (name5) {
    target = _isChromeIOS(ua) ? TARGET_BLANK : name5;
  }
  if (_isFirefox(ua)) {
    url = url || FIREFOX_EMPTY_URL;
    options.scrollbars = "yes";
  }
  const optionsString = Object.entries(options).reduce((accum, [key, value]) => `${accum}${key}=${value},`, "");
  if (_isIOSStandalone(ua) && target !== "_self") {
    openAsNewWindowIOS(url || "", target);
    return new AuthPopup(null);
  }
  const newWin = window.open(url || "", target, optionsString);
  _assert(
    newWin,
    auth2,
    "popup-blocked"
    /* AuthErrorCode.POPUP_BLOCKED */
  );
  try {
    newWin.focus();
  } catch (e) {
  }
  return new AuthPopup(newWin);
}
function openAsNewWindowIOS(url, target) {
  const el = document.createElement("a");
  el.href = url;
  el.target = target;
  const click = document.createEvent("MouseEvent");
  click.initMouseEvent("click", true, true, window, 1, 0, 0, 0, 0, false, false, false, false, 1, null);
  el.dispatchEvent(click);
}
var WIDGET_PATH = "__/auth/handler";
var EMULATOR_WIDGET_PATH = "emulator/auth/handler";
var FIREBASE_APP_CHECK_FRAGMENT_ID = encodeURIComponent("fac");
async function _getRedirectUrl(auth2, provider2, authType, redirectUrl, eventId, additionalParams) {
  _assert(
    auth2.config.authDomain,
    auth2,
    "auth-domain-config-required"
    /* AuthErrorCode.MISSING_AUTH_DOMAIN */
  );
  _assert(
    auth2.config.apiKey,
    auth2,
    "invalid-api-key"
    /* AuthErrorCode.INVALID_API_KEY */
  );
  const params = {
    apiKey: auth2.config.apiKey,
    appName: auth2.name,
    authType,
    redirectUrl,
    v: SDK_VERSION,
    eventId
  };
  if (provider2 instanceof FederatedAuthProvider) {
    provider2.setDefaultLanguage(auth2.languageCode);
    params.providerId = provider2.providerId || "";
    if (!isEmpty(provider2.getCustomParameters())) {
      params.customParameters = JSON.stringify(provider2.getCustomParameters());
    }
    for (const [key, value] of Object.entries(additionalParams || {})) {
      params[key] = value;
    }
  }
  if (provider2 instanceof BaseOAuthProvider) {
    const scopes = provider2.getScopes().filter((scope) => scope !== "");
    if (scopes.length > 0) {
      params.scopes = scopes.join(",");
    }
  }
  if (auth2.tenantId) {
    params.tid = auth2.tenantId;
  }
  const paramsDict = params;
  for (const key of Object.keys(paramsDict)) {
    if (paramsDict[key] === void 0) {
      delete paramsDict[key];
    }
  }
  const appCheckToken = await auth2._getAppCheckToken();
  const appCheckTokenFragment = appCheckToken ? `#${FIREBASE_APP_CHECK_FRAGMENT_ID}=${encodeURIComponent(appCheckToken)}` : "";
  return `${getHandlerBase(auth2)}?${querystring(paramsDict).slice(1)}${appCheckTokenFragment}`;
}
function getHandlerBase({ config }) {
  if (!config.emulator) {
    return `https://${config.authDomain}/${WIDGET_PATH}`;
  }
  return _emulatorUrl(config, EMULATOR_WIDGET_PATH);
}
var WEB_STORAGE_SUPPORT_KEY = "webStorageSupport";
var BrowserPopupRedirectResolver = class {
  constructor() {
    this.eventManagers = {};
    this.iframes = {};
    this.originValidationPromises = {};
    this._redirectPersistence = browserSessionPersistence;
    this._completeRedirectFn = _getRedirectResult;
    this._overrideRedirectResult = _overrideRedirectResult;
  }
  // Wrapping in async even though we don't await anywhere in order
  // to make sure errors are raised as promise rejections
  async _openPopup(auth2, provider2, authType, eventId) {
    var _a;
    debugAssert((_a = this.eventManagers[auth2._key()]) === null || _a === void 0 ? void 0 : _a.manager, "_initialize() not called before _openPopup()");
    const url = await _getRedirectUrl(auth2, provider2, authType, _getCurrentUrl(), eventId);
    return _open(auth2, url, _generateEventId());
  }
  async _openRedirect(auth2, provider2, authType, eventId) {
    await this._originValidation(auth2);
    const url = await _getRedirectUrl(auth2, provider2, authType, _getCurrentUrl(), eventId);
    _setWindowLocation(url);
    return new Promise(() => {
    });
  }
  _initialize(auth2) {
    const key = auth2._key();
    if (this.eventManagers[key]) {
      const { manager, promise: promise2 } = this.eventManagers[key];
      if (manager) {
        return Promise.resolve(manager);
      } else {
        debugAssert(promise2, "If manager is not set, promise should be");
        return promise2;
      }
    }
    const promise = this.initAndGetManager(auth2);
    this.eventManagers[key] = { promise };
    promise.catch(() => {
      delete this.eventManagers[key];
    });
    return promise;
  }
  async initAndGetManager(auth2) {
    const iframe = await _openIframe(auth2);
    const manager = new AuthEventManager(auth2);
    iframe.register("authEvent", (iframeEvent) => {
      _assert(
        iframeEvent === null || iframeEvent === void 0 ? void 0 : iframeEvent.authEvent,
        auth2,
        "invalid-auth-event"
        /* AuthErrorCode.INVALID_AUTH_EVENT */
      );
      const handled = manager.onEvent(iframeEvent.authEvent);
      return {
        status: handled ? "ACK" : "ERROR"
        /* GapiOutcome.ERROR */
      };
    }, gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER);
    this.eventManagers[auth2._key()] = { manager };
    this.iframes[auth2._key()] = iframe;
    return manager;
  }
  _isIframeWebStorageSupported(auth2, cb) {
    const iframe = this.iframes[auth2._key()];
    iframe.send(WEB_STORAGE_SUPPORT_KEY, { type: WEB_STORAGE_SUPPORT_KEY }, (result) => {
      var _a;
      const isSupported = (_a = result === null || result === void 0 ? void 0 : result[0]) === null || _a === void 0 ? void 0 : _a[WEB_STORAGE_SUPPORT_KEY];
      if (isSupported !== void 0) {
        cb(!!isSupported);
      }
      _fail(
        auth2,
        "internal-error"
        /* AuthErrorCode.INTERNAL_ERROR */
      );
    }, gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER);
  }
  _originValidation(auth2) {
    const key = auth2._key();
    if (!this.originValidationPromises[key]) {
      this.originValidationPromises[key] = _validateOrigin(auth2);
    }
    return this.originValidationPromises[key];
  }
  get _shouldInitProactively() {
    return _isMobileBrowser() || _isSafari() || _isIOS();
  }
};
var browserPopupRedirectResolver = BrowserPopupRedirectResolver;
var MultiFactorAssertionImpl = class {
  constructor(factorId) {
    this.factorId = factorId;
  }
  _process(auth2, session, displayName) {
    switch (session.type) {
      case "enroll":
        return this._finalizeEnroll(auth2, session.credential, displayName);
      case "signin":
        return this._finalizeSignIn(auth2, session.credential);
      default:
        return debugFail("unexpected MultiFactorSessionType");
    }
  }
};
var PhoneMultiFactorAssertionImpl = class extends MultiFactorAssertionImpl {
  constructor(credential) {
    super(
      "phone"
      /* FactorId.PHONE */
    );
    this.credential = credential;
  }
  /** @internal */
  static _fromCredential(credential) {
    return new PhoneMultiFactorAssertionImpl(credential);
  }
  /** @internal */
  _finalizeEnroll(auth2, idToken, displayName) {
    return finalizeEnrollPhoneMfa(auth2, {
      idToken,
      displayName,
      phoneVerificationInfo: this.credential._makeVerificationRequest()
    });
  }
  /** @internal */
  _finalizeSignIn(auth2, mfaPendingCredential) {
    return finalizeSignInPhoneMfa(auth2, {
      mfaPendingCredential,
      phoneVerificationInfo: this.credential._makeVerificationRequest()
    });
  }
};
var PhoneMultiFactorGenerator = class {
  constructor() {
  }
  /**
   * Provides a {@link PhoneMultiFactorAssertion} to confirm ownership of the phone second factor.
   *
   * @remarks
   * This method does not work in a Node.js environment.
   *
   * @param phoneAuthCredential - A credential provided by {@link PhoneAuthProvider.credential}.
   * @returns A {@link PhoneMultiFactorAssertion} which can be used with
   * {@link MultiFactorResolver.resolveSignIn}
   */
  static assertion(credential) {
    return PhoneMultiFactorAssertionImpl._fromCredential(credential);
  }
};
PhoneMultiFactorGenerator.FACTOR_ID = "phone";
var TotpMultiFactorGenerator = class {
  /**
   * Provides a {@link TotpMultiFactorAssertion} to confirm ownership of
   * the TOTP (time-based one-time password) second factor.
   * This assertion is used to complete enrollment in TOTP second factor.
   *
   * @param secret A {@link TotpSecret} containing the shared secret key and other TOTP parameters.
   * @param oneTimePassword One-time password from TOTP App.
   * @returns A {@link TotpMultiFactorAssertion} which can be used with
   * {@link MultiFactorUser.enroll}.
   */
  static assertionForEnrollment(secret, oneTimePassword) {
    return TotpMultiFactorAssertionImpl._fromSecret(secret, oneTimePassword);
  }
  /**
   * Provides a {@link TotpMultiFactorAssertion} to confirm ownership of the TOTP second factor.
   * This assertion is used to complete signIn with TOTP as the second factor.
   *
   * @param enrollmentId identifies the enrolled TOTP second factor.
   * @param oneTimePassword One-time password from TOTP App.
   * @returns A {@link TotpMultiFactorAssertion} which can be used with
   * {@link MultiFactorResolver.resolveSignIn}.
   */
  static assertionForSignIn(enrollmentId, oneTimePassword) {
    return TotpMultiFactorAssertionImpl._fromEnrollmentId(enrollmentId, oneTimePassword);
  }
  /**
   * Returns a promise to {@link TotpSecret} which contains the TOTP shared secret key and other parameters.
   * Creates a TOTP secret as part of enrolling a TOTP second factor.
   * Used for generating a QR code URL or inputting into a TOTP app.
   * This method uses the auth instance corresponding to the user in the multiFactorSession.
   *
   * @param session The {@link MultiFactorSession} that the user is part of.
   * @returns A promise to {@link TotpSecret}.
   */
  static async generateSecret(session) {
    var _a;
    const mfaSession = session;
    _assert(
      typeof ((_a = mfaSession.user) === null || _a === void 0 ? void 0 : _a.auth) !== "undefined",
      "internal-error"
      /* AuthErrorCode.INTERNAL_ERROR */
    );
    const response = await startEnrollTotpMfa(mfaSession.user.auth, {
      idToken: mfaSession.credential,
      totpEnrollmentInfo: {}
    });
    return TotpSecret._fromStartTotpMfaEnrollmentResponse(response, mfaSession.user.auth);
  }
};
TotpMultiFactorGenerator.FACTOR_ID = "totp";
var TotpMultiFactorAssertionImpl = class extends MultiFactorAssertionImpl {
  constructor(otp, enrollmentId, secret) {
    super(
      "totp"
      /* FactorId.TOTP */
    );
    this.otp = otp;
    this.enrollmentId = enrollmentId;
    this.secret = secret;
  }
  /** @internal */
  static _fromSecret(secret, otp) {
    return new TotpMultiFactorAssertionImpl(otp, void 0, secret);
  }
  /** @internal */
  static _fromEnrollmentId(enrollmentId, otp) {
    return new TotpMultiFactorAssertionImpl(otp, enrollmentId);
  }
  /** @internal */
  async _finalizeEnroll(auth2, idToken, displayName) {
    _assert(
      typeof this.secret !== "undefined",
      auth2,
      "argument-error"
      /* AuthErrorCode.ARGUMENT_ERROR */
    );
    return finalizeEnrollTotpMfa(auth2, {
      idToken,
      displayName,
      totpVerificationInfo: this.secret._makeTotpVerificationInfo(this.otp)
    });
  }
  /** @internal */
  async _finalizeSignIn(auth2, mfaPendingCredential) {
    _assert(
      this.enrollmentId !== void 0 && this.otp !== void 0,
      auth2,
      "argument-error"
      /* AuthErrorCode.ARGUMENT_ERROR */
    );
    const totpVerificationInfo = { verificationCode: this.otp };
    return finalizeSignInTotpMfa(auth2, {
      mfaPendingCredential,
      mfaEnrollmentId: this.enrollmentId,
      totpVerificationInfo
    });
  }
};
var TotpSecret = class {
  // The public members are declared outside the constructor so the docs can be generated.
  constructor(secretKey, hashingAlgorithm, codeLength, codeIntervalSeconds, enrollmentCompletionDeadline, sessionInfo, auth2) {
    this.sessionInfo = sessionInfo;
    this.auth = auth2;
    this.secretKey = secretKey;
    this.hashingAlgorithm = hashingAlgorithm;
    this.codeLength = codeLength;
    this.codeIntervalSeconds = codeIntervalSeconds;
    this.enrollmentCompletionDeadline = enrollmentCompletionDeadline;
  }
  /** @internal */
  static _fromStartTotpMfaEnrollmentResponse(response, auth2) {
    return new TotpSecret(response.totpSessionInfo.sharedSecretKey, response.totpSessionInfo.hashingAlgorithm, response.totpSessionInfo.verificationCodeLength, response.totpSessionInfo.periodSec, new Date(response.totpSessionInfo.finalizeEnrollmentTime).toUTCString(), response.totpSessionInfo.sessionInfo, auth2);
  }
  /** @internal */
  _makeTotpVerificationInfo(otp) {
    return { sessionInfo: this.sessionInfo, verificationCode: otp };
  }
  /**
   * Returns a QR code URL as described in
   * https://github.com/google/google-authenticator/wiki/Key-Uri-Format
   * This can be displayed to the user as a QR code to be scanned into a TOTP app like Google Authenticator.
   * If the optional parameters are unspecified, an accountName of <userEmail> and issuer of <firebaseAppName> are used.
   *
   * @param accountName the name of the account/app along with a user identifier.
   * @param issuer issuer of the TOTP (likely the app name).
   * @returns A QR code URL string.
   */
  generateQrCodeUrl(accountName, issuer) {
    var _a;
    let useDefaults = false;
    if (_isEmptyString(accountName) || _isEmptyString(issuer)) {
      useDefaults = true;
    }
    if (useDefaults) {
      if (_isEmptyString(accountName)) {
        accountName = ((_a = this.auth.currentUser) === null || _a === void 0 ? void 0 : _a.email) || "unknownuser";
      }
      if (_isEmptyString(issuer)) {
        issuer = this.auth.name;
      }
    }
    return `otpauth://totp/${issuer}:${accountName}?secret=${this.secretKey}&issuer=${issuer}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`;
  }
};
function _isEmptyString(input) {
  return typeof input === "undefined" || (input === null || input === void 0 ? void 0 : input.length) === 0;
}
var name4 = "@firebase/auth";
var version4 = "1.1.0";
var AuthInterop = class {
  constructor(auth2) {
    this.auth = auth2;
    this.internalListeners = /* @__PURE__ */ new Map();
  }
  getUid() {
    var _a;
    this.assertAuthConfigured();
    return ((_a = this.auth.currentUser) === null || _a === void 0 ? void 0 : _a.uid) || null;
  }
  async getToken(forceRefresh) {
    this.assertAuthConfigured();
    await this.auth._initializationPromise;
    if (!this.auth.currentUser) {
      return null;
    }
    const accessToken = await this.auth.currentUser.getIdToken(forceRefresh);
    return { accessToken };
  }
  addAuthTokenListener(listener) {
    this.assertAuthConfigured();
    if (this.internalListeners.has(listener)) {
      return;
    }
    const unsubscribe = this.auth.onIdTokenChanged((user) => {
      listener((user === null || user === void 0 ? void 0 : user.stsTokenManager.accessToken) || null);
    });
    this.internalListeners.set(listener, unsubscribe);
    this.updateProactiveRefresh();
  }
  removeAuthTokenListener(listener) {
    this.assertAuthConfigured();
    const unsubscribe = this.internalListeners.get(listener);
    if (!unsubscribe) {
      return;
    }
    this.internalListeners.delete(listener);
    unsubscribe();
    this.updateProactiveRefresh();
  }
  assertAuthConfigured() {
    _assert(
      this.auth._initializationPromise,
      "dependent-sdk-initialized-before-auth"
      /* AuthErrorCode.DEPENDENT_SDK_INIT_BEFORE_AUTH */
    );
  }
  updateProactiveRefresh() {
    if (this.internalListeners.size > 0) {
      this.auth._startProactiveRefresh();
    } else {
      this.auth._stopProactiveRefresh();
    }
  }
};
function getVersionForPlatform(clientPlatform) {
  switch (clientPlatform) {
    case "Node":
      return "node";
    case "ReactNative":
      return "rn";
    case "Worker":
      return "webworker";
    case "Cordova":
      return "cordova";
    default:
      return void 0;
  }
}
function registerAuth(clientPlatform) {
  _registerComponent(new Component(
    "auth",
    (container, { options: deps }) => {
      const app2 = container.getProvider("app").getImmediate();
      const heartbeatServiceProvider = container.getProvider("heartbeat");
      const appCheckServiceProvider = container.getProvider("app-check-internal");
      const { apiKey, authDomain } = app2.options;
      _assert(apiKey && !apiKey.includes(":"), "invalid-api-key", { appName: app2.name });
      const config = {
        apiKey,
        authDomain,
        clientPlatform,
        apiHost: "identitytoolkit.googleapis.com",
        tokenApiHost: "securetoken.googleapis.com",
        apiScheme: "https",
        sdkClientVersion: _getClientVersion(clientPlatform)
      };
      const authInstance = new AuthImpl(app2, heartbeatServiceProvider, appCheckServiceProvider, config);
      _initializeAuthInstance(authInstance, deps);
      return authInstance;
    },
    "PUBLIC"
    /* ComponentType.PUBLIC */
  ).setInstantiationMode(
    "EXPLICIT"
    /* InstantiationMode.EXPLICIT */
  ).setInstanceCreatedCallback((container, _instanceIdentifier, _instance) => {
    const authInternalProvider = container.getProvider(
      "auth-internal"
      /* _ComponentName.AUTH_INTERNAL */
    );
    authInternalProvider.initialize();
  }));
  _registerComponent(new Component(
    "auth-internal",
    (container) => {
      const auth2 = _castAuth(container.getProvider(
        "auth"
        /* _ComponentName.AUTH */
      ).getImmediate());
      return ((auth3) => new AuthInterop(auth3))(auth2);
    },
    "PRIVATE"
    /* ComponentType.PRIVATE */
  ).setInstantiationMode(
    "EXPLICIT"
    /* InstantiationMode.EXPLICIT */
  ));
  registerVersion(name4, version4, getVersionForPlatform(clientPlatform));
  registerVersion(name4, version4, "esm2017");
}
var DEFAULT_ID_TOKEN_MAX_AGE = 5 * 60;
var authIdTokenMaxAge = getExperimentalSetting("authIdTokenMaxAge") || DEFAULT_ID_TOKEN_MAX_AGE;
var lastPostedIdToken = null;
var mintCookieFactory = (url) => async (user) => {
  const idTokenResult = user && await user.getIdTokenResult();
  const idTokenAge = idTokenResult && (new Date().getTime() - Date.parse(idTokenResult.issuedAtTime)) / 1e3;
  if (idTokenAge && idTokenAge > authIdTokenMaxAge) {
    return;
  }
  const idToken = idTokenResult === null || idTokenResult === void 0 ? void 0 : idTokenResult.token;
  if (lastPostedIdToken === idToken) {
    return;
  }
  lastPostedIdToken = idToken;
  await fetch(url, {
    method: idToken ? "POST" : "DELETE",
    headers: idToken ? {
      "Authorization": `Bearer ${idToken}`
    } : {}
  });
};
function getAuth(app2 = getApp()) {
  const provider2 = _getProvider(app2, "auth");
  if (provider2.isInitialized()) {
    return provider2.getImmediate();
  }
  const auth2 = initializeAuth(app2, {
    popupRedirectResolver: browserPopupRedirectResolver,
    persistence: [
      indexedDBLocalPersistence,
      browserLocalPersistence,
      browserSessionPersistence
    ]
  });
  const authTokenSyncUrl = getExperimentalSetting("authTokenSyncURL");
  if (authTokenSyncUrl) {
    const mintCookie = mintCookieFactory(authTokenSyncUrl);
    beforeAuthStateChanged(auth2, mintCookie, () => mintCookie(auth2.currentUser));
    onIdTokenChanged(auth2, (user) => mintCookie(user));
  }
  const authEmulatorHost = getDefaultEmulatorHost("auth");
  if (authEmulatorHost) {
    connectAuthEmulator(auth2, `http://${authEmulatorHost}`);
  }
  return auth2;
}
registerAuth(
  "Browser"
  /* ClientPlatform.BROWSER */
);

// firebase-tools.ts
var firebaseConfig = {
  apiKey: "AIzaSyDdAYtOpSAG1MQWqY6zHWbBSvqOCBqkEDs",
  authDomain: "flint-4c10d.firebaseapp.com",
  projectId: "flint-4c10d",
  storageBucket: "flint-4c10d.appspot.com",
  messagingSenderId: "847454040500",
  appId: "1:847454040500:web:81298369de91f143d1c2e1"
};
var app = initializeApp(firebaseConfig);
var storage = getStorage();
var storageRef = ref(storage);
var vaultRef = ref(storageRef, "vaults");
var provider = new GoogleAuthProvider();
var auth = getAuth(app);
signInWithPopup(auth, provider).then((result) => {
  const credential = GoogleAuthProvider.credentialFromResult(result);
  if (credential == null ? void 0 : credential.accessToken) {
    const token = credential.accessToken;
  }
  const user = result.user;
}).catch((error) => {
  const errorCode = error.code;
  const errorMessage = error.message;
  const email = error.customData.email;
  const credential = GoogleAuthProvider.credentialFromError(error);
});

// datatools.ts
var FlintDataTransfer = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  //#region Upload/Download Files
  async deleteFile(remoteVaultFileList) {
    for (let i = 0; i < remoteVaultFileList.items.length; i++) {
      const deleteRef = ref(storage, remoteVaultFileList.items[i].fullPath);
      deleteObject(deleteRef);
    }
    if (remoteVaultFileList.prefixes.length > 0) {
      for (let x = 0; x < remoteVaultFileList.prefixes.length; x++) {
        const localFolders = await listAll(remoteVaultFileList.prefixes[x]);
        this.deleteFile(localFolders);
      }
    }
  }
  async clearRemoteVault(settings) {
    const remoteVaultName2 = settings.remoteConnectedVault;
    if (remoteVaultName2) {
      const remoteVaultRef = ref(vaultRef, `${remoteVaultName2}`);
      const remoteVaultFileList = await listAll(remoteVaultRef);
      await this.deleteFile(remoteVaultFileList);
    }
  }
  async forceUploadFiles(vault, settings) {
    this.clearRemoteVault(settings).then(
      (value) => {
        const files = vault.getMarkdownFiles();
        for (let i = 0; i < files.length; i++) {
          try {
            this.uploadFile(files, i);
          } catch (error) {
            console.log(`Error: ${error}`);
          }
        }
      }
    );
  }
  async uploadFile(files, index) {
    if (remoteVaultName !== "") {
      const pathString = await `${remoteVaultName}/${files[index].path}`;
      const pathRef = await ref(vaultRef, pathString);
      const data = await this.plugin.app.vault.adapter.readBinary(files[index].path);
      await uploadBytesResumable(pathRef, data).then((snapshot) => {
        console.log(`file ${index} uploaded successfully`);
      });
    } else {
      new import_obsidian.Notice("Choose a target vault destination!");
    }
  }
  async importVault(localVault, remoteVault) {
    new import_obsidian.Notice(`Remote Vault: ${remoteVault}`);
    const remoteVaultRef = ref(vaultRef, `${remoteVault}`);
    const remoteVaultFileList = await listAll(remoteVaultRef);
    this.downloadToLocal(localVault, remoteVaultFileList);
  }
  async downloadToLocal(localVaultName, remoteDirFileList) {
    const vault = this.plugin.app.vault;
    if (remoteDirFileList.prefixes.length > 0) {
      for (let x = 0; x < remoteDirFileList.prefixes.length; x++) {
        let remoteFolderPath = remoteDirFileList.prefixes[x].fullPath.split("/");
        remoteFolderPath = remoteFolderPath.slice(2);
        const localFolderPath = remoteFolderPath.join("/");
        if (vault.getAbstractFileByPath(localFolderPath)) {
          const fileOrFolder = vault.getAbstractFileByPath(localFolderPath);
          if (fileOrFolder instanceof import_obsidian.TFolder) {
            console.log(`${fileOrFolder.name} Exists`);
            const localfolder = fileOrFolder;
            vault.rename(localfolder, localFolderPath);
          }
        } else {
          try {
            await vault.createFolder(localFolderPath);
          } catch (error) {
            console.log(error);
          }
        }
        const localFolders = await listAll(remoteDirFileList.prefixes[x]);
        console.log("Looping");
        this.downloadToLocal(localVaultName, localFolders);
      }
    }
    for (let i = 0; i < remoteDirFileList.items.length; i++) {
      let remoteFilePath = remoteDirFileList.items[i].fullPath.split("/");
      remoteFilePath = remoteFilePath.slice(2);
      const localFilePath = remoteFilePath.join("/");
      const file = await this.fetchFile(`${remoteDirFileList.items[i]}`);
      if (vault.getAbstractFileByPath(localFilePath)) {
        const fileOrFolder = vault.getAbstractFileByPath(localFilePath);
        if (fileOrFolder instanceof import_obsidian.TFile) {
          console.log(`${fileOrFolder.name} Exists`);
          const localfile = fileOrFolder;
          vault.modifyBinary(localfile, file);
        }
      } else {
        try {
          console.log(`Writting File Path from: ${remoteDirFileList.items[i]} to local path ${localFilePath}`);
          await vault.createBinary(localFilePath, file);
        } catch (error) {
          console.log(error);
        }
      }
    }
  }
  async fetchFile(filePathString) {
    const filePathRef = ref(storage, filePathString);
    const fileURL = await getDownloadURL(filePathRef);
    console.log(`${fileURL}`);
    const returnedFile = await new Promise((resolve, reject) => {
      const xhr = new XMLHttpRequest();
      xhr.responseType = "arraybuffer";
      xhr.onload = (event) => {
        const returnedFile2 = xhr.response;
        resolve(returnedFile2);
      };
      xhr.open("GET", fileURL);
      xhr.send();
    });
    return await returnedFile;
  }
  //#endregion
};

// flint-settings.ts
var import_obsidian2 = require("obsidian");
var import_obsidian3 = require("obsidian");
var DEFAULT_SETTINGS = {
  remoteConnectedVault: "default"
};
var _fetchVaultOptions, fetchVaultOptions_fn;
var FlintSettingsTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    __privateAdd(this, _fetchVaultOptions);
    this.plugin = plugin;
  }
  async display() {
    const { containerEl } = this;
    const allVaultOptions = await __privateMethod(this, _fetchVaultOptions, fetchVaultOptions_fn).call(this);
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("Current Connected Remote Vault").setDesc("Active Firebase Vault").addDropdown((options) => options.addOptions(allVaultOptions).onChange(async (name5) => {
      this.plugin.setRemoteDesintation(name5);
    }));
  }
};
_fetchVaultOptions = new WeakSet();
fetchVaultOptions_fn = async function() {
  const vaultList = await listAll(vaultRef);
  let ALL_FIREBASE_VAULTS = {};
  for (let i = 0; i < vaultList.prefixes.length; i++) {
    const vaultName = `${vaultList.prefixes[i]}`.split("/").pop();
    if (vaultName) {
      ALL_FIREBASE_VAULTS[vaultName] = vaultName;
    }
  }
  return ALL_FIREBASE_VAULTS;
};

// main.ts
var currentVaultName = "vaults";
var remoteVaultName = "";
var FlintPlugin = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    currentVaultName = await this.app.vault.getName();
    remoteVaultName = this.settings.remoteConnectedVault;
    this.dataTools = new FlintDataTransfer(this);
    const uploadRibbon = this.addRibbonIcon("upload", "Upload Files", (evt) => {
      new import_obsidian4.Notice("Attempting Upload");
      this.dataTools.forceUploadFiles(this.app.vault, this.settings);
    });
    uploadRibbon.addClass("flint-upload-ribbon-class");
    const downloadRibbon = this.addRibbonIcon("download", "Download Files", (evt) => {
      if (remoteVaultName !== "") {
        new import_obsidian4.Notice("Downloadin!");
        this.dataTools.importVault(currentVaultName, remoteVaultName);
      } else {
        new import_obsidian4.Notice("Please select target cloud vault!");
      }
    });
    downloadRibbon.addClass("flint-download-ribbon-class");
    this.statusBar = this.addStatusBarItem();
    if (this.settings.remoteConnectedVault !== "default") {
      this.statusBar.setText(`Flint Remote Set to ${this.settings.remoteConnectedVault}`);
    } else {
      this.statusBar.setText(`Flint Remote Not Set`);
    }
    this.addCommand({
      id: "sample-editor-command",
      name: "Sample editor command",
      editorCallback: (editor, view) => {
        console.log(editor.getSelection());
        editor.replaceSelection("Sample Editor Command");
      }
    });
    this.addCommand({
      id: "open-sample-modal-complex",
      name: "Open sample modal (complex)",
      checkCallback: (checking) => {
        const markdownView = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
        if (markdownView) {
          if (!checking) {
          }
          return true;
        }
      }
    });
    this.addCommand({
      id: "import-cloud-vault",
      name: "Import Vault from Cloud",
      callback: () => {
        const selectionModal = new CloudVaultSelectModal(this.app, this.statusBar, this, this.settings);
        selectionModal.open();
      }
    });
    this.addSettingTab(new FlintSettingsTab(this.app, this));
    this.registerDomEvent(document, "click", (evt) => {
      console.log("click", evt);
    });
    this.registerInterval(window.setInterval(() => console.log("setInterval"), 5 * 60 * 1e3));
  }
  async setRemoteDesintation(remoteName) {
    remoteVaultName = remoteName;
    this.settings.remoteConnectedVault = remoteName;
    this.statusBar.setText(`Flint Remote Set to ${remoteName}`);
    new import_obsidian4.Notice(`Syncing to ${remoteName}`);
    await this.saveSettings();
  }
  // async activateView() {
  // 	this.app.workspace.detachLeavesOfType(VIEW_TYPE_EXAMPLE);
  // 	await this.app.workspace.getRightLeaf(false).setViewState({
  // 		type: VIEW_TYPE_EXAMPLE,
  // 		active: true,
  // 	});
  // 	this.app.workspace.revealLeaf(
  // 		this.app.workspace.getLeavesOfType(VIEW_TYPE_EXAMPLE)[0]
  // 	);
  // }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
async function fetchFirebaseVaults() {
  const vaultList = await listAll(vaultRef);
  let ALL_FIREBASE_VAULTS = [];
  for (let i = 0; i < vaultList.prefixes.length; i++) {
    const vaultName = `${vaultList.prefixes[i]}`.split("/").pop();
    if (vaultName) {
      ALL_FIREBASE_VAULTS[i] = { title: vaultName, ref: `${vaultRef}` };
    }
  }
  return ALL_FIREBASE_VAULTS;
}
var CloudVaultSelectModal = class extends import_obsidian4.SuggestModal {
  constructor(app2, HTMLbar, plugin, settings) {
    super(app2);
    this.app = app2;
    this.HTMLStatusbar = HTMLbar;
    this.pluginSettings = settings;
    this.plugin = plugin;
  }
  async getSuggestions(query) {
    const RETRIEVED_FIREBASE_VAULTS = await fetchFirebaseVaults();
    if (RETRIEVED_FIREBASE_VAULTS.length <= 0) {
      new import_obsidian4.Notice("NO VAULTS PRESENT");
    }
    return RETRIEVED_FIREBASE_VAULTS.filter(
      (vault) => vault.title.toLowerCase().includes(query.toLowerCase())
    );
  }
  // Renders each suggestion item.
  renderSuggestion(vault, el) {
    el.createEl("div", { text: vault.title });
    el.createEl("small", { text: vault.ref });
  }
  // Perform action on the selected suggestion.
  async onChooseSuggestion(vault, evt) {
    new import_obsidian4.Notice(`Selected ${vault.title}`);
    remoteVaultName = vault.title;
    this.plugin.setRemoteDesintation(vault.title);
  }
};
/*! Bundled license information:

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/component/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/logger/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/storage/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

firebase/app/dist/esm/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e24386e7.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvc3JjL2NvbnN0YW50cy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvc3JjL2Fzc2VydC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvc3JjL2NyeXB0LnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9zcmMvZGVlcENvcHkudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy9nbG9iYWwudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy9kZWZhdWx0cy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvc3JjL2RlZmVycmVkLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9zcmMvZW11bGF0b3IudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy9lbnZpcm9ubWVudC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvc3JjL2Vycm9ycy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvc3JjL2pzb24udHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy9qd3QudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy9vYmoudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy9wcm9taXNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9zcmMvcXVlcnkudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy9zaGExLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9zcmMvc3Vic2NyaWJlLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9zcmMvdmFsaWRhdGlvbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvc3JjL3V0ZjgudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy91dWlkLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9zcmMvZXhwb25lbnRpYWxfYmFja29mZi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3V0aWwvc3JjL2Zvcm1hdHRlcnMudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS91dGlsL3NyYy9jb21wYXQudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9jb21wb25lbnQvc3JjL2NvbXBvbmVudC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2NvbXBvbmVudC9zcmMvY29uc3RhbnRzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvY29tcG9uZW50L3NyYy9wcm92aWRlci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2NvbXBvbmVudC9zcmMvY29tcG9uZW50X2NvbnRhaW5lci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2xvZ2dlci9zcmMvbG9nZ2VyLnRzIiwgIm5vZGVfbW9kdWxlcy9pZGIvYnVpbGQvd3JhcC1pZGItdmFsdWUuanMiLCAibm9kZV9tb2R1bGVzL2lkYi9idWlsZC9pbmRleC5qcyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2FwcC9zcmMvcGxhdGZvcm1Mb2dnZXJTZXJ2aWNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL3NyYy9sb2dnZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hcHAvc3JjL2NvbnN0YW50cy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2FwcC9zcmMvaW50ZXJuYWwudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hcHAvc3JjL2Vycm9ycy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2FwcC9zcmMvZmlyZWJhc2VBcHAudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hcHAvc3JjL2FwaS50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2FwcC9zcmMvaW5kZXhlZGRiLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL3NyYy9oZWFydGJlYXRTZXJ2aWNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL3NyYy9yZWdpc3RlckNvcmVDb21wb25lbnRzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL3NyYy9pbmRleC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL2ltcGxlbWVudGF0aW9uL2NvbnN0YW50cy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL2ltcGxlbWVudGF0aW9uL2Vycm9yLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvaW1wbGVtZW50YXRpb24vbG9jYXRpb24udHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9pbXBsZW1lbnRhdGlvbi9mYWlscmVxdWVzdC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL2ltcGxlbWVudGF0aW9uL2JhY2tvZmYudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9pbXBsZW1lbnRhdGlvbi90eXBlLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvaW1wbGVtZW50YXRpb24vdXJsLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvaW1wbGVtZW50YXRpb24vY29ubmVjdGlvbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL2ltcGxlbWVudGF0aW9uL3V0aWxzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvaW1wbGVtZW50YXRpb24vcmVxdWVzdC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL2ltcGxlbWVudGF0aW9uL2ZzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvcGxhdGZvcm0vYnJvd3Nlci9iYXNlNjQudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9pbXBsZW1lbnRhdGlvbi9zdHJpbmcudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9pbXBsZW1lbnRhdGlvbi9ibG9iLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvaW1wbGVtZW50YXRpb24vanNvbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL2ltcGxlbWVudGF0aW9uL3BhdGgudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9pbXBsZW1lbnRhdGlvbi9tZXRhZGF0YS50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL2ltcGxlbWVudGF0aW9uL2xpc3QudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9pbXBsZW1lbnRhdGlvbi9yZXF1ZXN0aW5mby50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL2ltcGxlbWVudGF0aW9uL3JlcXVlc3RzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvaW1wbGVtZW50YXRpb24vdGFza2VudW1zLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvaW1wbGVtZW50YXRpb24vb2JzZXJ2ZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9pbXBsZW1lbnRhdGlvbi9hc3luYy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL3BsYXRmb3JtL2Jyb3dzZXIvY29ubmVjdGlvbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL3N0b3JhZ2Uvc3JjL3Rhc2sudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9yZWZlcmVuY2UudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9zZXJ2aWNlLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvY29uc3RhbnRzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvYXBpLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvc3RvcmFnZS9zcmMvYXBpLmJyb3dzZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9zdG9yYWdlL3NyYy9pbmRleC50cyIsICJkYXRhdG9vbHMudHMiLCAibm9kZV9tb2R1bGVzL2ZpcmViYXNlL2FwcC9pbmRleC50cyIsICJub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvbW9kZWwvZW51bV9tYXBzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9lcnJvcnMudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3V0aWwvbG9nLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91dGlsL2Fzc2VydC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvdXRpbC9sb2NhdGlvbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvdXRpbC9uYXZpZ2F0b3IudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3V0aWwvZGVsYXkudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3V0aWwvZW11bGF0b3IudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3V0aWwvZmV0Y2hfcHJvdmlkZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9hcGkvZXJyb3JzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvYXBpL2luZGV4LnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvYXBpL2FjY291bnRfbWFuYWdlbWVudC9hY2NvdW50LnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91dGlsL3RpbWUudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3VzZXIvaWRfdG9rZW5fcmVzdWx0LnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91c2VyL2ludmFsaWRhdGlvbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvdXNlci9wcm9hY3RpdmVfcmVmcmVzaC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvdXNlci91c2VyX21ldGFkYXRhLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91c2VyL3JlbG9hZC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2FwaS9hdXRoZW50aWNhdGlvbi90b2tlbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvdXNlci90b2tlbl9tYW5hZ2VyLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91c2VyL3VzZXJfaW1wbC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvdXRpbC9pbnN0YW50aWF0b3IudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3BlcnNpc3RlbmNlL2luX21lbW9yeS50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvcGVyc2lzdGVuY2UvcGVyc2lzdGVuY2VfdXNlcl9tYW5hZ2VyLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91dGlsL2Jyb3dzZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3V0aWwvdmVyc2lvbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2FwaS9hdXRoZW50aWNhdGlvbi9yZWNhcHRjaGEudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3JlY2FwdGNoYS9yZWNhcHRjaGEudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL2xvYWRfanMudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3JlY2FwdGNoYS9yZWNhcHRjaGFfZW50ZXJwcmlzZV92ZXJpZmllci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvYXV0aC9taWRkbGV3YXJlLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9hdXRoL2F1dGhfaW1wbC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvYXV0aC9pbml0aWFsaXplLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9hdXRoL2VtdWxhdG9yLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9jcmVkZW50aWFscy9hdXRoX2NyZWRlbnRpYWwudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9hcGkvYWNjb3VudF9tYW5hZ2VtZW50L2VtYWlsX2FuZF9wYXNzd29yZC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2FwaS9hdXRoZW50aWNhdGlvbi9lbWFpbF9hbmRfcGFzc3dvcmQudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9hcGkvYXV0aGVudGljYXRpb24vZW1haWxfbGluay50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvY3JlZGVudGlhbHMvZW1haWwudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9hcGkvYXV0aGVudGljYXRpb24vaWRwLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9jcmVkZW50aWFscy9vYXV0aC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2FwaS9hdXRoZW50aWNhdGlvbi9zbXMudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL2NyZWRlbnRpYWxzL3Bob25lLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9hY3Rpb25fY29kZV91cmwudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3Byb3ZpZGVycy9lbWFpbC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvcHJvdmlkZXJzL2ZlZGVyYXRlZC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvcHJvdmlkZXJzL29hdXRoLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9wcm92aWRlcnMvZmFjZWJvb2sudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3Byb3ZpZGVycy9nb29nbGUudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3Byb3ZpZGVycy9naXRodWIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL2NyZWRlbnRpYWxzL3NhbWwudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3Byb3ZpZGVycy9zYW1sLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9wcm92aWRlcnMvdHdpdHRlci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2FwaS9hdXRoZW50aWNhdGlvbi9zaWduX3VwLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91c2VyL3VzZXJfY3JlZGVudGlhbF9pbXBsLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9zdHJhdGVnaWVzL2Fub255bW91cy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL21mYS9tZmFfZXJyb3IudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3V0aWwvcHJvdmlkZXJzLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91c2VyL2xpbmtfdW5saW5rLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91c2VyL3JlYXV0aGVudGljYXRlLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9zdHJhdGVnaWVzL2NyZWRlbnRpYWwudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9hcGkvYXV0aGVudGljYXRpb24vY3VzdG9tX3Rva2VuLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9zdHJhdGVnaWVzL2N1c3RvbV90b2tlbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL21mYS9tZmFfaW5mby50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvc3RyYXRlZ2llcy9hY3Rpb25fY29kZV9zZXR0aW5ncy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvc3RyYXRlZ2llcy9lbWFpbF9hbmRfcGFzc3dvcmQudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3N0cmF0ZWdpZXMvZW1haWxfbGluay50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2FwaS9hdXRoZW50aWNhdGlvbi9jcmVhdGVfYXV0aF91cmkudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3N0cmF0ZWdpZXMvZW1haWwudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9hcGkvYWNjb3VudF9tYW5hZ2VtZW50L3Byb2ZpbGUudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3VzZXIvYWNjb3VudF9pbmZvLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91c2VyL2FkZGl0aW9uYWxfdXNlcl9pbmZvLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9pbmRleC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL21mYS9tZmFfc2Vzc2lvbi50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL21mYS9tZmFfcmVzb2x2ZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9hcGkvYWNjb3VudF9tYW5hZ2VtZW50L21mYS50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL21mYS9tZmFfdXNlci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvcGVyc2lzdGVuY2UvaW5kZXgudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3BlcnNpc3RlbmNlL2Jyb3dzZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3BlcnNpc3RlbmNlL2xvY2FsX3N0b3JhZ2UudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3BlcnNpc3RlbmNlL3Nlc3Npb25fc3RvcmFnZS50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL3BsYXRmb3JtX2Jyb3dzZXIvbWVzc2FnZWNoYW5uZWwvcHJvbWlzZS50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL3BsYXRmb3JtX2Jyb3dzZXIvbWVzc2FnZWNoYW5uZWwvcmVjZWl2ZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3V0aWwvZXZlbnRfaWQudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL21lc3NhZ2VjaGFubmVsL3NlbmRlci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL3BsYXRmb3JtX2Jyb3dzZXIvYXV0aF93aW5kb3cudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3V0aWwvd29ya2VyLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvcGxhdGZvcm1fYnJvd3Nlci9wZXJzaXN0ZW5jZS9pbmRleGVkX2RiLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvYXBpL2F1dGhlbnRpY2F0aW9uL21mYS50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL3BsYXRmb3JtX2Jyb3dzZXIvcmVjYXB0Y2hhL3JlY2FwdGNoYV9tb2NrLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvcGxhdGZvcm1fYnJvd3Nlci9yZWNhcHRjaGEvcmVjYXB0Y2hhX2xvYWRlci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL3BsYXRmb3JtX2Jyb3dzZXIvcmVjYXB0Y2hhL3JlY2FwdGNoYV92ZXJpZmllci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL3BsYXRmb3JtX2Jyb3dzZXIvc3RyYXRlZ2llcy9waG9uZS50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL3BsYXRmb3JtX2Jyb3dzZXIvcHJvdmlkZXJzL3Bob25lLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91dGlsL3Jlc29sdmVyLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS9zdHJhdGVnaWVzL2lkcC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvc3RyYXRlZ2llcy9hYnN0cmFjdF9wb3B1cF9yZWRpcmVjdF9vcGVyYXRpb24udHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3N0cmF0ZWdpZXMvcG9wdXAudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL3N0cmF0ZWdpZXMvcmVkaXJlY3QudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3N0cmF0ZWdpZXMvcmVkaXJlY3QudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9jb3JlL2F1dGgvYXV0aF9ldmVudF9tYW5hZ2VyLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvYXBpL3Byb2plY3RfY29uZmlnL2dldF9wcm9qZWN0X2NvbmZpZy50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvdXRpbC92YWxpZGF0ZV9vcmlnaW4udHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL2lmcmFtZS9nYXBpLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvcGxhdGZvcm1fYnJvd3Nlci9pZnJhbWUvaWZyYW1lLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvcGxhdGZvcm1fYnJvd3Nlci91dGlsL3BvcHVwLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvY29yZS91dGlsL2hhbmRsZXIudHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL3BvcHVwX3JlZGlyZWN0LnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvbWZhL21mYV9hc3NlcnRpb24udHMiLCAibm9kZV9tb2R1bGVzL0BmaXJlYmFzZS9hdXRoL3NyYy9wbGF0Zm9ybV9icm93c2VyL21mYS9hc3NlcnRpb25zL3Bob25lLnRzIiwgIm5vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXV0aC9zcmMvbWZhL2Fzc2VydGlvbnMvdG90cC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvYXV0aC9maXJlYmFzZV9pbnRlcm5hbC50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL2NvcmUvYXV0aC9yZWdpc3Rlci50cyIsICJub2RlX21vZHVsZXMvQGZpcmViYXNlL2F1dGgvc3JjL3BsYXRmb3JtX2Jyb3dzZXIvaW5kZXgudHMiLCAiZmlyZWJhc2UtdG9vbHMudHMiLCAiZmxpbnQtc2V0dGluZ3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgRWRpdG9yLCBNYXJrZG93blZpZXcsIE5vdGljZSwgUGx1Z2luLFN1Z2dlc3RNb2RhbCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgIExpc3RSZXN1bHQsIGxpc3RBbGwgIH0gZnJvbSAnZmlyZWJhc2Uvc3RvcmFnZSc7XHJcbmltcG9ydCB7IEZsaW50RGF0YVRyYW5zZmVyIH0gZnJvbSAnZGF0YXRvb2xzJztcclxuaW1wb3J0IHsgdmF1bHRSZWYgfSBmcm9tICdmaXJlYmFzZS10b29scyc7XHJcbmltcG9ydCB7IEZsaW50UGx1Z2luU2V0dGluZ3MsIEZsaW50U2V0dGluZ3NUYWIsIEV4YW1wbGVWaWV3LCBWSUVXX1RZUEVfRVhBTVBMRSwgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJ2ZsaW50LXNldHRpbmdzJztcclxuXHJcbmV4cG9ydCBsZXQgY3VycmVudFZhdWx0TmFtZTogc3RyaW5nID0gJ3ZhdWx0cyc7XHJcbmV4cG9ydCBsZXQgcmVtb3RlVmF1bHROYW1lOiBzdHJpbmcgPSAnJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZsaW50UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuXHRzZXR0aW5nczogRmxpbnRQbHVnaW5TZXR0aW5ncztcclxuXHRzdGF0dXNCYXI6IEhUTUxFbGVtZW50O1xyXG5cdGRhdGFUb29sczogRmxpbnREYXRhVHJhbnNmZXI7XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblx0XHRjdXJyZW50VmF1bHROYW1lID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuZ2V0TmFtZSgpO1xyXG5cdFx0cmVtb3RlVmF1bHROYW1lID0gdGhpcy5zZXR0aW5ncy5yZW1vdGVDb25uZWN0ZWRWYXVsdDtcclxuXHRcdHRoaXMuZGF0YVRvb2xzID0gbmV3IEZsaW50RGF0YVRyYW5zZmVyKHRoaXMpO1xyXG5cclxuXHRcdC8vIFRoaXMgY3JlYXRlcyBhbiBpY29uIGluIHRoZSBsZWZ0IHJpYmJvbi5cclxuXHRcdGNvbnN0IHVwbG9hZFJpYmJvbiA9IHRoaXMuYWRkUmliYm9uSWNvbigndXBsb2FkJywgJ1VwbG9hZCBGaWxlcycsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRcdFx0Ly8gQ2FsbGVkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIHRoZSBpY29uLlxyXG5cdFx0XHRuZXcgTm90aWNlKCdBdHRlbXB0aW5nIFVwbG9hZCcpO1xyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5kYXRhVG9vbHMuZm9yY2VVcGxvYWRGaWxlcyh0aGlzLmFwcC52YXVsdCwgdGhpcy5zZXR0aW5ncyk7XHJcblxyXG5cdFx0fSk7XHJcblx0XHQvLyBQZXJmb3JtIGFkZGl0aW9uYWwgdGhpbmdzIHdpdGggdGhlIHJpYmJvblxyXG5cdFx0dXBsb2FkUmliYm9uLmFkZENsYXNzKCdmbGludC11cGxvYWQtcmliYm9uLWNsYXNzJyk7XHJcblxyXG5cdFx0Y29uc3QgZG93bmxvYWRSaWJib24gPSB0aGlzLmFkZFJpYmJvbkljb24oJ2Rvd25sb2FkJywgJ0Rvd25sb2FkIEZpbGVzJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xyXG5cdFx0XHQvL0NoZWNrIGlmIHRhcmdldCB2YXVsdCBoYXMgYmVlbiBzZWxlY3RlZFxyXG5cdFx0XHRpZiAocmVtb3RlVmF1bHROYW1lICE9PSAnJykge1xyXG5cdFx0XHRcdG5ldyBOb3RpY2UoJ0Rvd25sb2FkaW4hJyk7XHJcblx0XHRcdFx0dGhpcy5kYXRhVG9vbHMuaW1wb3J0VmF1bHQoY3VycmVudFZhdWx0TmFtZSwgcmVtb3RlVmF1bHROYW1lKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRuZXcgTm90aWNlKFwiUGxlYXNlIHNlbGVjdCB0YXJnZXQgY2xvdWQgdmF1bHQhXCIpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0fSk7XHJcblx0XHRkb3dubG9hZFJpYmJvbi5hZGRDbGFzcygnZmxpbnQtZG93bmxvYWQtcmliYm9uLWNsYXNzJyk7XHJcblxyXG5cdFx0dGhpcy5zdGF0dXNCYXIgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcclxuXHRcdC8vIFRoaXMgYWRkcyBhIHN0YXR1cyBiYXIgaXRlbSB0byB0aGUgYm90dG9tIG9mIHRoZSBhcHAuIERvZXMgbm90IHdvcmsgb24gbW9iaWxlIGFwcHMuXHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5yZW1vdGVDb25uZWN0ZWRWYXVsdCAhPT0gJ2RlZmF1bHQnKSB7XHJcblx0XHRcdHRoaXMuc3RhdHVzQmFyLnNldFRleHQoYEZsaW50IFJlbW90ZSBTZXQgdG8gJHt0aGlzLnNldHRpbmdzLnJlbW90ZUNvbm5lY3RlZFZhdWx0fWApO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMuc3RhdHVzQmFyLnNldFRleHQoYEZsaW50IFJlbW90ZSBOb3QgU2V0YCk7XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdC8vIFRoaXMgYWRkcyBhbiBlZGl0b3IgY29tbWFuZCB0aGF0IGNhbiBwZXJmb3JtIHNvbWUgb3BlcmF0aW9uIG9uIHRoZSBjdXJyZW50IGVkaXRvciBpbnN0YW5jZVxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6ICdzYW1wbGUtZWRpdG9yLWNvbW1hbmQnLFxyXG5cdFx0XHRuYW1lOiAnU2FtcGxlIGVkaXRvciBjb21tYW5kJyxcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coZWRpdG9yLmdldFNlbGVjdGlvbigpKTtcclxuXHRcdFx0XHRlZGl0b3IucmVwbGFjZVNlbGVjdGlvbignU2FtcGxlIEVkaXRvciBDb21tYW5kJyk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0Ly8gVGhpcyBhZGRzIGEgY29tcGxleCBjb21tYW5kIHRoYXQgY2FuIGNoZWNrIHdoZXRoZXIgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGFwcCBhbGxvd3MgZXhlY3V0aW9uIG9mIHRoZSBjb21tYW5kXHJcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogJ29wZW4tc2FtcGxlLW1vZGFsLWNvbXBsZXgnLFxyXG5cdFx0XHRuYW1lOiAnT3BlbiBzYW1wbGUgbW9kYWwgKGNvbXBsZXgpJyxcclxuXHRcdFx0Y2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0Ly8gQ29uZGl0aW9ucyB0byBjaGVja1xyXG5cdFx0XHRcdGNvbnN0IG1hcmtkb3duVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcblx0XHRcdFx0aWYgKG1hcmtkb3duVmlldykge1xyXG5cdFx0XHRcdFx0Ly8gSWYgY2hlY2tpbmcgaXMgdHJ1ZSwgd2UncmUgc2ltcGx5IFwiY2hlY2tpbmdcIiBpZiB0aGUgY29tbWFuZCBjYW4gYmUgcnVuLlxyXG5cdFx0XHRcdFx0Ly8gSWYgY2hlY2tpbmcgaXMgZmFsc2UsIHRoZW4gd2Ugd2FudCB0byBhY3R1YWxseSBwZXJmb3JtIHRoZSBvcGVyYXRpb24uXHJcblx0XHRcdFx0XHRpZiAoIWNoZWNraW5nKSB7XHJcblx0XHRcdFx0XHRcdC8vbmV3IFNhbXBsZU1vZGFsKHRoaXMuYXBwKS5vcGVuKCk7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0Ly8gVGhpcyBjb21tYW5kIHdpbGwgb25seSBzaG93IHVwIGluIENvbW1hbmQgUGFsZXR0ZSB3aGVuIHRoZSBjaGVjayBmdW5jdGlvbiByZXR1cm5zIHRydWVcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcclxuXHJcblx0XHRcdGlkOiAnaW1wb3J0LWNsb3VkLXZhdWx0JyxcclxuXHRcdFx0bmFtZTogJ0ltcG9ydCBWYXVsdCBmcm9tIENsb3VkJyxcclxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcclxuXHRcdFx0XHRjb25zdCBzZWxlY3Rpb25Nb2RhbCA9IG5ldyBDbG91ZFZhdWx0U2VsZWN0TW9kYWwodGhpcy5hcHAsIHRoaXMuc3RhdHVzQmFyLCB0aGlzLCB0aGlzLnNldHRpbmdzKTtcclxuXHRcdFx0XHRzZWxlY3Rpb25Nb2RhbC5vcGVuKCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHR9KTtcclxuXHRcdC8vIHRoaXMucmVnaXN0ZXJWaWV3KFxyXG5cdFx0Ly8gXHRWSUVXX1RZUEVfRVhBTVBMRSxcclxuXHRcdC8vIFx0KGxlYWYpID0+IG5ldyBFeGFtcGxlVmlldyhsZWFmKVxyXG5cdFx0Ly8gKTtcclxuXHJcblx0XHQvLyB0aGlzLmFkZFJpYmJvbkljb24oXCJkaWNlXCIsIFwiQWN0aXZhdGUgdmlld1wiLCAoKSA9PiB7XHJcblx0XHQvLyBcdHRoaXMuYWN0aXZhdGVWaWV3KCk7XHJcblx0XHQvLyB9KTtcclxuXHJcblx0XHQvLyBUaGlzIGFkZHMgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSB2YXJpb3VzIGFzcGVjdHMgb2YgdGhlIHBsdWdpblxyXG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBGbGludFNldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG5cdFx0Ly8gSWYgdGhlIHBsdWdpbiBob29rcyB1cCBhbnkgZ2xvYmFsIERPTSBldmVudHMgKG9uIHBhcnRzIG9mIHRoZSBhcHAgdGhhdCBkb2Vzbid0IGJlbG9uZyB0byB0aGlzIHBsdWdpbilcclxuXHRcdC8vIFVzaW5nIHRoaXMgZnVuY3Rpb24gd2lsbCBhdXRvbWF0aWNhbGx5IHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXIgd2hlbiB0aGlzIHBsdWdpbiBpcyBkaXNhYmxlZC5cclxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmxvZygnY2xpY2snLCBldnQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gV2hlbiByZWdpc3RlcmluZyBpbnRlcnZhbHMsIHRoaXMgZnVuY3Rpb24gd2lsbCBhdXRvbWF0aWNhbGx5IGNsZWFyIHRoZSBpbnRlcnZhbCB3aGVuIHRoZSBwbHVnaW4gaXMgZGlzYWJsZWQuXHJcblx0XHR0aGlzLnJlZ2lzdGVySW50ZXJ2YWwod2luZG93LnNldEludGVydmFsKCgpID0+IGNvbnNvbGUubG9nKCdzZXRJbnRlcnZhbCcpLCA1ICogNjAgKiAxMDAwKSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBzZXRSZW1vdGVEZXNpbnRhdGlvbihyZW1vdGVOYW1lOiBzdHJpbmcpIHtcclxuXHRcdHJlbW90ZVZhdWx0TmFtZSA9IHJlbW90ZU5hbWU7XHJcblx0XHR0aGlzLnNldHRpbmdzLnJlbW90ZUNvbm5lY3RlZFZhdWx0ID0gcmVtb3RlTmFtZTtcclxuXHRcdHRoaXMuc3RhdHVzQmFyLnNldFRleHQoYEZsaW50IFJlbW90ZSBTZXQgdG8gJHtyZW1vdGVOYW1lfWApO1xyXG5cdFx0bmV3IE5vdGljZShgU3luY2luZyB0byAke3JlbW90ZU5hbWV9YCk7XHJcblx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpXHJcblx0fVxyXG5cclxuXHJcblx0Ly8gYXN5bmMgYWN0aXZhdGVWaWV3KCkge1xyXG5cdC8vIFx0dGhpcy5hcHAud29ya3NwYWNlLmRldGFjaExlYXZlc09mVHlwZShWSUVXX1RZUEVfRVhBTVBMRSk7XHJcblxyXG5cdC8vIFx0YXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSkuc2V0Vmlld1N0YXRlKHtcclxuXHQvLyBcdFx0dHlwZTogVklFV19UWVBFX0VYQU1QTEUsXHJcblx0Ly8gXHRcdGFjdGl2ZTogdHJ1ZSxcclxuXHQvLyBcdH0pO1xyXG5cclxuXHQvLyBcdHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKFxyXG5cdC8vIFx0XHR0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9FWEFNUExFKVswXVxyXG5cdC8vIFx0KTtcclxuXHQvLyB9XHJcblxyXG5cdG9udW5sb2FkKCkge1xyXG5cclxuXHR9XHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHJcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEZpcmViYXNlVmF1bHQge1xyXG5cdHRpdGxlOiBzdHJpbmc7XHJcblx0cmVmPzogc3RyaW5nO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBmZXRjaEZpcmViYXNlVmF1bHRzKCk6IFByb21pc2U8RmlyZWJhc2VWYXVsdFtdPiB7XHJcblx0LyoqIEdlbmVyYXRlL1VwZGF0ZSBsaXN0IG9mIEFMTF9GSVJFQkFTRV9WQVVMVFMgXHJcblx0ICogQHB1YmxpYyAgXHJcblx0ICovXHJcblxyXG5cdGNvbnN0IHZhdWx0TGlzdDogTGlzdFJlc3VsdCA9IGF3YWl0IGxpc3RBbGwodmF1bHRSZWYpO1xyXG5cclxuXHRsZXQgQUxMX0ZJUkVCQVNFX1ZBVUxUUzogRmlyZWJhc2VWYXVsdFtdID0gW107XHJcblxyXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgdmF1bHRMaXN0LnByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRjb25zdCB2YXVsdE5hbWUgPSBgJHt2YXVsdExpc3QucHJlZml4ZXNbaV19YC5zcGxpdCgnLycpLnBvcCgpO1xyXG5cdFx0aWYgKHZhdWx0TmFtZSkge1xyXG5cdFx0XHRBTExfRklSRUJBU0VfVkFVTFRTW2ldID0geyB0aXRsZTogdmF1bHROYW1lLCByZWY6IGAke3ZhdWx0UmVmfWAgfTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIEFMTF9GSVJFQkFTRV9WQVVMVFM7XHJcblxyXG59XHJcbi8vY29udGFpbiBhIGxpc3Qgb2YgYWxsIHZhdWx0cyBpbiB0aGUgZmlyZWJhc2UgYnVja2V0XHJcblxyXG5leHBvcnQgY2xhc3MgQ2xvdWRWYXVsdFNlbGVjdE1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPEZpcmViYXNlVmF1bHQ+IHtcclxuXHRIVE1MU3RhdHVzYmFyOiBIVE1MRWxlbWVudDtcclxuXHRwbHVnaW5TZXR0aW5nczogRmxpbnRQbHVnaW5TZXR0aW5ncztcclxuXHRwbHVnaW46IEZsaW50UGx1Z2luO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgSFRNTGJhcjogSFRNTEVsZW1lbnQsIHBsdWdpbjogRmxpbnRQbHVnaW4sIHNldHRpbmdzOiBGbGludFBsdWdpblNldHRpbmdzKSB7XHJcblx0XHRzdXBlcihhcHApO1xyXG5cdFx0dGhpcy5hcHAgPSBhcHA7XHJcblx0XHR0aGlzLkhUTUxTdGF0dXNiYXIgPSBIVE1MYmFyO1xyXG5cdFx0dGhpcy5wbHVnaW5TZXR0aW5ncyA9IHNldHRpbmdzO1xyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcblxyXG5cdH1cclxuXHRhc3luYyBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxGaXJlYmFzZVZhdWx0W10+IHtcclxuXHRcdGNvbnN0IFJFVFJJRVZFRF9GSVJFQkFTRV9WQVVMVFMgPSBhd2FpdCBmZXRjaEZpcmViYXNlVmF1bHRzKCk7XHJcblxyXG5cdFx0aWYgKFJFVFJJRVZFRF9GSVJFQkFTRV9WQVVMVFMubGVuZ3RoIDw9IDApIHtcclxuXHRcdFx0bmV3IE5vdGljZSgnTk8gVkFVTFRTIFBSRVNFTlQnKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBSRVRSSUVWRURfRklSRUJBU0VfVkFVTFRTLmZpbHRlcigodmF1bHQpID0+XHJcblx0XHRcdHZhdWx0LnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocXVlcnkudG9Mb3dlckNhc2UoKSlcclxuXHRcdCk7XHJcblx0fVxyXG5cclxuXHQvLyBSZW5kZXJzIGVhY2ggc3VnZ2VzdGlvbiBpdGVtLlxyXG5cdHJlbmRlclN1Z2dlc3Rpb24odmF1bHQ6IEZpcmViYXNlVmF1bHQsIGVsOiBIVE1MRWxlbWVudCkge1xyXG5cdFx0ZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiB2YXVsdC50aXRsZSB9KTtcclxuXHRcdGVsLmNyZWF0ZUVsKFwic21hbGxcIiwgeyB0ZXh0OiB2YXVsdC5yZWYgfSk7XHJcblx0fVxyXG5cclxuXHQvLyBQZXJmb3JtIGFjdGlvbiBvbiB0aGUgc2VsZWN0ZWQgc3VnZ2VzdGlvbi5cclxuXHRhc3luYyBvbkNob29zZVN1Z2dlc3Rpb24odmF1bHQ6IEZpcmViYXNlVmF1bHQsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcclxuXHRcdG5ldyBOb3RpY2UoYFNlbGVjdGVkICR7dmF1bHQudGl0bGV9YCk7XHJcblxyXG5cclxuXHRcdHJlbW90ZVZhdWx0TmFtZSA9IHZhdWx0LnRpdGxlO1xyXG5cclxuXHRcdHRoaXMucGx1Z2luLnNldFJlbW90ZURlc2ludGF0aW9uKHZhdWx0LnRpdGxlKTtcclxuXHRcdC8vY2hhbmdlcyB0aGUgZGlzcGxheWVkIGN1cnJlbnQgY29ubmVjdGVkIHZhdWx0XHJcblxyXG5cdH1cclxufVxyXG5cclxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBGaXJlYmFzZSBjb25zdGFudHMuICBTb21lIG9mIHRoZXNlIChAZGVmaW5lcykgY2FuIGJlIG92ZXJyaWRkZW4gYXQgY29tcGlsZS10aW1lLlxuICovXG5cbmV4cG9ydCBjb25zdCBDT05TVEFOVFMgPSB7XG4gIC8qKlxuICAgKiBAZGVmaW5lIHtib29sZWFufSBXaGV0aGVyIHRoaXMgaXMgdGhlIGNsaWVudCBOb2RlLmpzIFNESy5cbiAgICovXG4gIE5PREVfQ0xJRU5UOiBmYWxzZSxcbiAgLyoqXG4gICAqIEBkZWZpbmUge2Jvb2xlYW59IFdoZXRoZXIgdGhpcyBpcyB0aGUgQWRtaW4gTm9kZS5qcyBTREsuXG4gICAqL1xuICBOT0RFX0FETUlOOiBmYWxzZSxcblxuICAvKipcbiAgICogRmlyZWJhc2UgU0RLIFZlcnNpb25cbiAgICovXG4gIFNES19WRVJTSU9OOiAnJHtKU0NPUkVfVkVSU0lPTn0nXG59O1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IENPTlNUQU5UUyB9IGZyb20gJy4vY29uc3RhbnRzJztcblxuLyoqXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIHByb3ZpZGVkIGFzc2VydGlvbiBpcyBmYWxzeVxuICovXG5leHBvcnQgY29uc3QgYXNzZXJ0ID0gZnVuY3Rpb24gKGFzc2VydGlvbjogdW5rbm93biwgbWVzc2FnZTogc3RyaW5nKTogdm9pZCB7XG4gIGlmICghYXNzZXJ0aW9uKSB7XG4gICAgdGhyb3cgYXNzZXJ0aW9uRXJyb3IobWVzc2FnZSk7XG4gIH1cbn07XG5cbi8qKlxuICogUmV0dXJucyBhbiBFcnJvciBvYmplY3Qgc3VpdGFibGUgZm9yIHRocm93aW5nLlxuICovXG5leHBvcnQgY29uc3QgYXNzZXJ0aW9uRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZTogc3RyaW5nKTogRXJyb3Ige1xuICByZXR1cm4gbmV3IEVycm9yKFxuICAgICdGaXJlYmFzZSBEYXRhYmFzZSAoJyArXG4gICAgICBDT05TVEFOVFMuU0RLX1ZFUlNJT04gK1xuICAgICAgJykgSU5URVJOQUwgQVNTRVJUIEZBSUxFRDogJyArXG4gICAgICBtZXNzYWdlXG4gICk7XG59O1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmNvbnN0IHN0cmluZ1RvQnl0ZUFycmF5ID0gZnVuY3Rpb24gKHN0cjogc3RyaW5nKTogbnVtYmVyW10ge1xuICAvLyBUT0RPKHVzZXIpOiBVc2UgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBpZi93aGVuIGF2YWlsYWJsZVxuICBjb25zdCBvdXQ6IG51bWJlcltdID0gW107XG4gIGxldCBwID0gMDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICBsZXQgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIGlmIChjIDwgMTI4KSB7XG4gICAgICBvdXRbcCsrXSA9IGM7XG4gICAgfSBlbHNlIGlmIChjIDwgMjA0OCkge1xuICAgICAgb3V0W3ArK10gPSAoYyA+PiA2KSB8IDE5MjtcbiAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XG4gICAgfSBlbHNlIGlmIChcbiAgICAgIChjICYgMHhmYzAwKSA9PT0gMHhkODAwICYmXG4gICAgICBpICsgMSA8IHN0ci5sZW5ndGggJiZcbiAgICAgIChzdHIuY2hhckNvZGVBdChpICsgMSkgJiAweGZjMDApID09PSAweGRjMDBcbiAgICApIHtcbiAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXG4gICAgICBjID0gMHgxMDAwMCArICgoYyAmIDB4MDNmZikgPDwgMTApICsgKHN0ci5jaGFyQ29kZUF0KCsraSkgJiAweDAzZmYpO1xuICAgICAgb3V0W3ArK10gPSAoYyA+PiAxOCkgfCAyNDA7XG4gICAgICBvdXRbcCsrXSA9ICgoYyA+PiAxMikgJiA2MykgfCAxMjg7XG4gICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcbiAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XG4gICAgfSBlbHNlIHtcbiAgICAgIG91dFtwKytdID0gKGMgPj4gMTIpIHwgMjI0O1xuICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XG4gICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xuICAgIH1cbiAgfVxuICByZXR1cm4gb3V0O1xufTtcblxuLyoqXG4gKiBUdXJucyBhbiBhcnJheSBvZiBudW1iZXJzIGludG8gdGhlIHN0cmluZyBnaXZlbiBieSB0aGUgY29uY2F0ZW5hdGlvbiBvZiB0aGVcbiAqIGNoYXJhY3RlcnMgdG8gd2hpY2ggdGhlIG51bWJlcnMgY29ycmVzcG9uZC5cbiAqIEBwYXJhbSBieXRlcyBBcnJheSBvZiBudW1iZXJzIHJlcHJlc2VudGluZyBjaGFyYWN0ZXJzLlxuICogQHJldHVybiBTdHJpbmdpZmljYXRpb24gb2YgdGhlIGFycmF5LlxuICovXG5jb25zdCBieXRlQXJyYXlUb1N0cmluZyA9IGZ1bmN0aW9uIChieXRlczogbnVtYmVyW10pOiBzdHJpbmcge1xuICAvLyBUT0RPKHVzZXIpOiBVc2UgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBpZi93aGVuIGF2YWlsYWJsZVxuICBjb25zdCBvdXQ6IHN0cmluZ1tdID0gW107XG4gIGxldCBwb3MgPSAwLFxuICAgIGMgPSAwO1xuICB3aGlsZSAocG9zIDwgYnl0ZXMubGVuZ3RoKSB7XG4gICAgY29uc3QgYzEgPSBieXRlc1twb3MrK107XG4gICAgaWYgKGMxIDwgMTI4KSB7XG4gICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoYzEpO1xuICAgIH0gZWxzZSBpZiAoYzEgPiAxOTEgJiYgYzEgPCAyMjQpIHtcbiAgICAgIGNvbnN0IGMyID0gYnl0ZXNbcG9zKytdO1xuICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzEgJiAzMSkgPDwgNikgfCAoYzIgJiA2MykpO1xuICAgIH0gZWxzZSBpZiAoYzEgPiAyMzkgJiYgYzEgPCAzNjUpIHtcbiAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXG4gICAgICBjb25zdCBjMiA9IGJ5dGVzW3BvcysrXTtcbiAgICAgIGNvbnN0IGMzID0gYnl0ZXNbcG9zKytdO1xuICAgICAgY29uc3QgYzQgPSBieXRlc1twb3MrK107XG4gICAgICBjb25zdCB1ID1cbiAgICAgICAgKCgoYzEgJiA3KSA8PCAxOCkgfCAoKGMyICYgNjMpIDw8IDEyKSB8ICgoYzMgJiA2MykgPDwgNikgfCAoYzQgJiA2MykpIC1cbiAgICAgICAgMHgxMDAwMDtcbiAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweGQ4MDAgKyAodSA+PiAxMCkpO1xuICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ZGMwMCArICh1ICYgMTAyMykpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBjMiA9IGJ5dGVzW3BvcysrXTtcbiAgICAgIGNvbnN0IGMzID0gYnl0ZXNbcG9zKytdO1xuICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKFxuICAgICAgICAoKGMxICYgMTUpIDw8IDEyKSB8ICgoYzIgJiA2MykgPDwgNikgfCAoYzMgJiA2MylcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIHJldHVybiBvdXQuam9pbignJyk7XG59O1xuXG5pbnRlcmZhY2UgQmFzZTY0IHtcbiAgYnl0ZVRvQ2hhck1hcF86IHsgW2tleTogbnVtYmVyXTogc3RyaW5nIH0gfCBudWxsO1xuICBjaGFyVG9CeXRlTWFwXzogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSB8IG51bGw7XG4gIGJ5dGVUb0NoYXJNYXBXZWJTYWZlXzogeyBba2V5OiBudW1iZXJdOiBzdHJpbmcgfSB8IG51bGw7XG4gIGNoYXJUb0J5dGVNYXBXZWJTYWZlXzogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSB8IG51bGw7XG4gIEVOQ09ERURfVkFMU19CQVNFOiBzdHJpbmc7XG4gIHJlYWRvbmx5IEVOQ09ERURfVkFMUzogc3RyaW5nO1xuICByZWFkb25seSBFTkNPREVEX1ZBTFNfV0VCU0FGRTogc3RyaW5nO1xuICBIQVNfTkFUSVZFX1NVUFBPUlQ6IGJvb2xlYW47XG4gIGVuY29kZUJ5dGVBcnJheShpbnB1dDogbnVtYmVyW10gfCBVaW50OEFycmF5LCB3ZWJTYWZlPzogYm9vbGVhbik6IHN0cmluZztcbiAgZW5jb2RlU3RyaW5nKGlucHV0OiBzdHJpbmcsIHdlYlNhZmU/OiBib29sZWFuKTogc3RyaW5nO1xuICBkZWNvZGVTdHJpbmcoaW5wdXQ6IHN0cmluZywgd2ViU2FmZTogYm9vbGVhbik6IHN0cmluZztcbiAgZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQ6IHN0cmluZywgd2ViU2FmZTogYm9vbGVhbik6IG51bWJlcltdO1xuICBpbml0XygpOiB2b2lkO1xufVxuXG4vLyBXZSBkZWZpbmUgaXQgYXMgYW4gb2JqZWN0IGxpdGVyYWwgaW5zdGVhZCBvZiBhIGNsYXNzIGJlY2F1c2UgYSBjbGFzcyBjb21waWxlZCBkb3duIHRvIGVzNSBjYW4ndFxuLy8gYmUgdHJlZXNoYWtlZC4gaHR0cHM6Ly9naXRodWIuY29tL3JvbGx1cC9yb2xsdXAvaXNzdWVzLzE2OTFcbi8vIFN0YXRpYyBsb29rdXAgbWFwcywgbGF6aWx5IHBvcHVsYXRlZCBieSBpbml0XygpXG5leHBvcnQgY29uc3QgYmFzZTY0OiBCYXNlNjQgPSB7XG4gIC8qKlxuICAgKiBNYXBzIGJ5dGVzIHRvIGNoYXJhY3RlcnMuXG4gICAqL1xuICBieXRlVG9DaGFyTWFwXzogbnVsbCxcblxuICAvKipcbiAgICogTWFwcyBjaGFyYWN0ZXJzIHRvIGJ5dGVzLlxuICAgKi9cbiAgY2hhclRvQnl0ZU1hcF86IG51bGwsXG5cbiAgLyoqXG4gICAqIE1hcHMgYnl0ZXMgdG8gd2Vic2FmZSBjaGFyYWN0ZXJzLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgYnl0ZVRvQ2hhck1hcFdlYlNhZmVfOiBudWxsLFxuXG4gIC8qKlxuICAgKiBNYXBzIHdlYnNhZmUgY2hhcmFjdGVycyB0byBieXRlcy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGNoYXJUb0J5dGVNYXBXZWJTYWZlXzogbnVsbCxcblxuICAvKipcbiAgICogT3VyIGRlZmF1bHQgYWxwaGFiZXQsIHNoYXJlZCBiZXR3ZWVuXG4gICAqIEVOQ09ERURfVkFMUyBhbmQgRU5DT0RFRF9WQUxTX1dFQlNBRkVcbiAgICovXG4gIEVOQ09ERURfVkFMU19CQVNFOlxuICAgICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicgKyAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonICsgJzAxMjM0NTY3ODknLFxuXG4gIC8qKlxuICAgKiBPdXIgZGVmYXVsdCBhbHBoYWJldC4gVmFsdWUgNjQgKD0pIGlzIHNwZWNpYWw7IGl0IG1lYW5zIFwibm90aGluZy5cIlxuICAgKi9cbiAgZ2V0IEVOQ09ERURfVkFMUygpIHtcbiAgICByZXR1cm4gdGhpcy5FTkNPREVEX1ZBTFNfQkFTRSArICcrLz0nO1xuICB9LFxuXG4gIC8qKlxuICAgKiBPdXIgd2Vic2FmZSBhbHBoYWJldC5cbiAgICovXG4gIGdldCBFTkNPREVEX1ZBTFNfV0VCU0FGRSgpIHtcbiAgICByZXR1cm4gdGhpcy5FTkNPREVEX1ZBTFNfQkFTRSArICctXy4nO1xuICB9LFxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgYnJvd3NlciBzdXBwb3J0cyB0aGUgYXRvYiBhbmQgYnRvYSBmdW5jdGlvbnMuIFRoaXMgZXh0ZW5zaW9uXG4gICAqIHN0YXJ0ZWQgYXQgTW96aWxsYSBidXQgaXMgbm93IGltcGxlbWVudGVkIGJ5IG1hbnkgYnJvd3NlcnMuIFdlIHVzZSB0aGVcbiAgICogQVNTVU1FXyogdmFyaWFibGVzIHRvIGF2b2lkIHB1bGxpbmcgaW4gdGhlIGZ1bGwgdXNlcmFnZW50IGRldGVjdGlvbiBsaWJyYXJ5XG4gICAqIGJ1dCBzdGlsbCBhbGxvd2luZyB0aGUgc3RhbmRhcmQgcGVyLWJyb3dzZXIgY29tcGlsYXRpb25zLlxuICAgKlxuICAgKi9cbiAgSEFTX05BVElWRV9TVVBQT1JUOiB0eXBlb2YgYXRvYiA9PT0gJ2Z1bmN0aW9uJyxcblxuICAvKipcbiAgICogQmFzZTY0LWVuY29kZSBhbiBhcnJheSBvZiBieXRlcy5cbiAgICpcbiAgICogQHBhcmFtIGlucHV0IEFuIGFycmF5IG9mIGJ5dGVzIChudW1iZXJzIHdpdGhcbiAgICogICAgIHZhbHVlIGluIFswLCAyNTVdKSB0byBlbmNvZGUuXG4gICAqIEBwYXJhbSB3ZWJTYWZlIEJvb2xlYW4gaW5kaWNhdGluZyB3ZSBzaG91bGQgdXNlIHRoZVxuICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXG4gICAqIEByZXR1cm4gVGhlIGJhc2U2NCBlbmNvZGVkIHN0cmluZy5cbiAgICovXG4gIGVuY29kZUJ5dGVBcnJheShpbnB1dDogbnVtYmVyW10gfCBVaW50OEFycmF5LCB3ZWJTYWZlPzogYm9vbGVhbik6IHN0cmluZyB7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGlucHV0KSkge1xuICAgICAgdGhyb3cgRXJyb3IoJ2VuY29kZUJ5dGVBcnJheSB0YWtlcyBhbiBhcnJheSBhcyBhIHBhcmFtZXRlcicpO1xuICAgIH1cblxuICAgIHRoaXMuaW5pdF8oKTtcblxuICAgIGNvbnN0IGJ5dGVUb0NoYXJNYXAgPSB3ZWJTYWZlXG4gICAgICA/IHRoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfIVxuICAgICAgOiB0aGlzLmJ5dGVUb0NoYXJNYXBfITtcblxuICAgIGNvbnN0IG91dHB1dCA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7IGkgKz0gMykge1xuICAgICAgY29uc3QgYnl0ZTEgPSBpbnB1dFtpXTtcbiAgICAgIGNvbnN0IGhhdmVCeXRlMiA9IGkgKyAxIDwgaW5wdXQubGVuZ3RoO1xuICAgICAgY29uc3QgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBpbnB1dFtpICsgMV0gOiAwO1xuICAgICAgY29uc3QgaGF2ZUJ5dGUzID0gaSArIDIgPCBpbnB1dC5sZW5ndGg7XG4gICAgICBjb25zdCBieXRlMyA9IGhhdmVCeXRlMyA/IGlucHV0W2kgKyAyXSA6IDA7XG5cbiAgICAgIGNvbnN0IG91dEJ5dGUxID0gYnl0ZTEgPj4gMjtcbiAgICAgIGNvbnN0IG91dEJ5dGUyID0gKChieXRlMSAmIDB4MDMpIDw8IDQpIHwgKGJ5dGUyID4+IDQpO1xuICAgICAgbGV0IG91dEJ5dGUzID0gKChieXRlMiAmIDB4MGYpIDw8IDIpIHwgKGJ5dGUzID4+IDYpO1xuICAgICAgbGV0IG91dEJ5dGU0ID0gYnl0ZTMgJiAweDNmO1xuXG4gICAgICBpZiAoIWhhdmVCeXRlMykge1xuICAgICAgICBvdXRCeXRlNCA9IDY0O1xuXG4gICAgICAgIGlmICghaGF2ZUJ5dGUyKSB7XG4gICAgICAgICAgb3V0Qnl0ZTMgPSA2NDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBvdXRwdXQucHVzaChcbiAgICAgICAgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlMV0sXG4gICAgICAgIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTJdLFxuICAgICAgICBieXRlVG9DaGFyTWFwW291dEJ5dGUzXSxcbiAgICAgICAgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlNF1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dHB1dC5qb2luKCcnKTtcbiAgfSxcblxuICAvKipcbiAgICogQmFzZTY0LWVuY29kZSBhIHN0cmluZy5cbiAgICpcbiAgICogQHBhcmFtIGlucHV0IEEgc3RyaW5nIHRvIGVuY29kZS5cbiAgICogQHBhcmFtIHdlYlNhZmUgSWYgdHJ1ZSwgd2Ugc2hvdWxkIHVzZSB0aGVcbiAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxuICAgKiBAcmV0dXJuIFRoZSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXG4gICAqL1xuICBlbmNvZGVTdHJpbmcoaW5wdXQ6IHN0cmluZywgd2ViU2FmZT86IGJvb2xlYW4pOiBzdHJpbmcge1xuICAgIC8vIFNob3J0Y3V0IGZvciBNb3ppbGxhIGJyb3dzZXJzIHRoYXQgaW1wbGVtZW50XG4gICAgLy8gYSBuYXRpdmUgYmFzZTY0IGVuY29kZXIgaW4gdGhlIGZvcm0gb2YgXCJidG9hL2F0b2JcIlxuICAgIGlmICh0aGlzLkhBU19OQVRJVkVfU1VQUE9SVCAmJiAhd2ViU2FmZSkge1xuICAgICAgcmV0dXJuIGJ0b2EoaW5wdXQpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5lbmNvZGVCeXRlQXJyYXkoc3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQpLCB3ZWJTYWZlKTtcbiAgfSxcblxuICAvKipcbiAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cbiAgICpcbiAgICogQHBhcmFtIGlucHV0IHRvIGRlY29kZS5cbiAgICogQHBhcmFtIHdlYlNhZmUgVHJ1ZSBpZiB3ZSBzaG91bGQgdXNlIHRoZVxuICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXG4gICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAgICovXG4gIGRlY29kZVN0cmluZyhpbnB1dDogc3RyaW5nLCB3ZWJTYWZlOiBib29sZWFuKTogc3RyaW5nIHtcbiAgICAvLyBTaG9ydGN1dCBmb3IgTW96aWxsYSBicm93c2VycyB0aGF0IGltcGxlbWVudFxuICAgIC8vIGEgbmF0aXZlIGJhc2U2NCBlbmNvZGVyIGluIHRoZSBmb3JtIG9mIFwiYnRvYS9hdG9iXCJcbiAgICBpZiAodGhpcy5IQVNfTkFUSVZFX1NVUFBPUlQgJiYgIXdlYlNhZmUpIHtcbiAgICAgIHJldHVybiBhdG9iKGlucHV0KTtcbiAgICB9XG4gICAgcmV0dXJuIGJ5dGVBcnJheVRvU3RyaW5nKHRoaXMuZGVjb2RlU3RyaW5nVG9CeXRlQXJyYXkoaW5wdXQsIHdlYlNhZmUpKTtcbiAgfSxcblxuICAvKipcbiAgICogQmFzZTY0LWRlY29kZSBhIHN0cmluZy5cbiAgICpcbiAgICogSW4gYmFzZS02NCBkZWNvZGluZywgZ3JvdXBzIG9mIGZvdXIgY2hhcmFjdGVycyBhcmUgY29udmVydGVkIGludG8gdGhyZWVcbiAgICogYnl0ZXMuICBJZiB0aGUgZW5jb2RlciBkaWQgbm90IGFwcGx5IHBhZGRpbmcsIHRoZSBpbnB1dCBsZW5ndGggbWF5IG5vdFxuICAgKiBiZSBhIG11bHRpcGxlIG9mIDQuXG4gICAqXG4gICAqIEluIHRoaXMgY2FzZSwgdGhlIGxhc3QgZ3JvdXAgd2lsbCBoYXZlIGZld2VyIHRoYW4gNCBjaGFyYWN0ZXJzLCBhbmRcbiAgICogcGFkZGluZyB3aWxsIGJlIGluZmVycmVkLiAgSWYgdGhlIGdyb3VwIGhhcyBvbmUgb3IgdHdvIGNoYXJhY3RlcnMsIGl0IGRlY29kZXNcbiAgICogdG8gb25lIGJ5dGUuICBJZiB0aGUgZ3JvdXAgaGFzIHRocmVlIGNoYXJhY3RlcnMsIGl0IGRlY29kZXMgdG8gdHdvIGJ5dGVzLlxuICAgKlxuICAgKiBAcGFyYW0gaW5wdXQgSW5wdXQgdG8gZGVjb2RlLlxuICAgKiBAcGFyYW0gd2ViU2FmZSBUcnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlIHdlYi1zYWZlIGFscGhhYmV0LlxuICAgKiBAcmV0dXJuIGJ5dGVzIHJlcHJlc2VudGluZyB0aGUgZGVjb2RlZCB2YWx1ZS5cbiAgICovXG4gIGRlY29kZVN0cmluZ1RvQnl0ZUFycmF5KGlucHV0OiBzdHJpbmcsIHdlYlNhZmU6IGJvb2xlYW4pOiBudW1iZXJbXSB7XG4gICAgdGhpcy5pbml0XygpO1xuXG4gICAgY29uc3QgY2hhclRvQnl0ZU1hcCA9IHdlYlNhZmVcbiAgICAgID8gdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV8hXG4gICAgICA6IHRoaXMuY2hhclRvQnl0ZU1hcF8hO1xuXG4gICAgY29uc3Qgb3V0cHV0OiBudW1iZXJbXSA9IFtdO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dC5sZW5ndGg7ICkge1xuICAgICAgY29uc3QgYnl0ZTEgPSBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKyspXTtcblxuICAgICAgY29uc3QgaGF2ZUJ5dGUyID0gaSA8IGlucHV0Lmxlbmd0aDtcbiAgICAgIGNvbnN0IGJ5dGUyID0gaGF2ZUJ5dGUyID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogMDtcbiAgICAgICsraTtcblxuICAgICAgY29uc3QgaGF2ZUJ5dGUzID0gaSA8IGlucHV0Lmxlbmd0aDtcbiAgICAgIGNvbnN0IGJ5dGUzID0gaGF2ZUJ5dGUzID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogNjQ7XG4gICAgICArK2k7XG5cbiAgICAgIGNvbnN0IGhhdmVCeXRlNCA9IGkgPCBpbnB1dC5sZW5ndGg7XG4gICAgICBjb25zdCBieXRlNCA9IGhhdmVCeXRlNCA/IGNoYXJUb0J5dGVNYXBbaW5wdXQuY2hhckF0KGkpXSA6IDY0O1xuICAgICAgKytpO1xuXG4gICAgICBpZiAoYnl0ZTEgPT0gbnVsbCB8fCBieXRlMiA9PSBudWxsIHx8IGJ5dGUzID09IG51bGwgfHwgYnl0ZTQgPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRGVjb2RlQmFzZTY0U3RyaW5nRXJyb3IoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgb3V0Qnl0ZTEgPSAoYnl0ZTEgPDwgMikgfCAoYnl0ZTIgPj4gNCk7XG4gICAgICBvdXRwdXQucHVzaChvdXRCeXRlMSk7XG5cbiAgICAgIGlmIChieXRlMyAhPT0gNjQpIHtcbiAgICAgICAgY29uc3Qgb3V0Qnl0ZTIgPSAoKGJ5dGUyIDw8IDQpICYgMHhmMCkgfCAoYnl0ZTMgPj4gMik7XG4gICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUyKTtcblxuICAgICAgICBpZiAoYnl0ZTQgIT09IDY0KSB7XG4gICAgICAgICAgY29uc3Qgb3V0Qnl0ZTMgPSAoKGJ5dGUzIDw8IDYpICYgMHhjMCkgfCBieXRlNDtcbiAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb3V0cHV0O1xuICB9LFxuXG4gIC8qKlxuICAgKiBMYXp5IHN0YXRpYyBpbml0aWFsaXphdGlvbiBmdW5jdGlvbi4gQ2FsbGVkIGJlZm9yZVxuICAgKiBhY2Nlc3NpbmcgYW55IG9mIHRoZSBzdGF0aWMgbWFwIHZhcmlhYmxlcy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIGluaXRfKCkge1xuICAgIGlmICghdGhpcy5ieXRlVG9DaGFyTWFwXykge1xuICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwXyA9IHt9O1xuICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwXyA9IHt9O1xuICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV8gPSB7fTtcbiAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfID0ge307XG5cbiAgICAgIC8vIFdlIHdhbnQgcXVpY2sgbWFwcGluZ3MgYmFjayBhbmQgZm9ydGgsIHNvIHdlIHByZWNvbXB1dGUgdHdvIG1hcHMuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuRU5DT0RFRF9WQUxTLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuYnl0ZVRvQ2hhck1hcF9baV0gPSB0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSk7XG4gICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5ieXRlVG9DaGFyTWFwX1tpXV0gPSBpO1xuICAgICAgICB0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1tpXSA9IHRoaXMuRU5DT0RFRF9WQUxTX1dFQlNBRkUuY2hhckF0KGkpO1xuICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLmJ5dGVUb0NoYXJNYXBXZWJTYWZlX1tpXV0gPSBpO1xuXG4gICAgICAgIC8vIEJlIGZvcmdpdmluZyB3aGVuIGRlY29kaW5nIGFuZCBjb3JyZWN0bHkgZGVjb2RlIGJvdGggZW5jb2RpbmdzLlxuICAgICAgICBpZiAoaSA+PSB0aGlzLkVOQ09ERURfVkFMU19CQVNFLmxlbmd0aCkge1xuICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5FTkNPREVEX1ZBTFNfV0VCU0FGRS5jaGFyQXQoaSldID0gaTtcbiAgICAgICAgICB0aGlzLmNoYXJUb0J5dGVNYXBXZWJTYWZlX1t0aGlzLkVOQ09ERURfVkFMUy5jaGFyQXQoaSldID0gaTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuLyoqXG4gKiBBbiBlcnJvciBlbmNvdW50ZXJlZCB3aGlsZSBkZWNvZGluZyBiYXNlNjQgc3RyaW5nLlxuICovXG5leHBvcnQgY2xhc3MgRGVjb2RlQmFzZTY0U3RyaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIHJlYWRvbmx5IG5hbWUgPSAnRGVjb2RlQmFzZTY0U3RyaW5nRXJyb3InO1xufVxuXG4vKipcbiAqIFVSTC1zYWZlIGJhc2U2NCBlbmNvZGluZ1xuICovXG5leHBvcnQgY29uc3QgYmFzZTY0RW5jb2RlID0gZnVuY3Rpb24gKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgdXRmOEJ5dGVzID0gc3RyaW5nVG9CeXRlQXJyYXkoc3RyKTtcbiAgcmV0dXJuIGJhc2U2NC5lbmNvZGVCeXRlQXJyYXkodXRmOEJ5dGVzLCB0cnVlKTtcbn07XG5cbi8qKlxuICogVVJMLXNhZmUgYmFzZTY0IGVuY29kaW5nICh3aXRob3V0IFwiLlwiIHBhZGRpbmcgaW4gdGhlIGVuZCkuXG4gKiBlLmcuIFVzZWQgaW4gSlNPTiBXZWIgVG9rZW4gKEpXVCkgcGFydHMuXG4gKi9cbmV4cG9ydCBjb25zdCBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyA9IGZ1bmN0aW9uIChzdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gIC8vIFVzZSBiYXNlNjR1cmwgZW5jb2RpbmcgYW5kIHJlbW92ZSBwYWRkaW5nIGluIHRoZSBlbmQgKGRvdCBjaGFyYWN0ZXJzKS5cbiAgcmV0dXJuIGJhc2U2NEVuY29kZShzdHIpLnJlcGxhY2UoL1xcLi9nLCAnJyk7XG59O1xuXG4vKipcbiAqIFVSTC1zYWZlIGJhc2U2NCBkZWNvZGluZ1xuICpcbiAqIE5PVEU6IERPIE5PVCB1c2UgdGhlIGdsb2JhbCBhdG9iKCkgZnVuY3Rpb24gLSBpdCBkb2VzIE5PVCBzdXBwb3J0IHRoZVxuICogYmFzZTY0VXJsIHZhcmlhbnQgZW5jb2RpbmcuXG4gKlxuICogQHBhcmFtIHN0ciBUbyBiZSBkZWNvZGVkXG4gKiBAcmV0dXJuIERlY29kZWQgcmVzdWx0LCBpZiBwb3NzaWJsZVxuICovXG5leHBvcnQgY29uc3QgYmFzZTY0RGVjb2RlID0gZnVuY3Rpb24gKHN0cjogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGJhc2U2NC5kZWNvZGVTdHJpbmcoc3RyLCB0cnVlKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ2Jhc2U2NERlY29kZSBmYWlsZWQ6ICcsIGUpO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIERvIGEgZGVlcC1jb3B5IG9mIGJhc2ljIEphdmFTY3JpcHQgT2JqZWN0cyBvciBBcnJheXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWVwQ29weTxUPih2YWx1ZTogVCk6IFQge1xuICByZXR1cm4gZGVlcEV4dGVuZCh1bmRlZmluZWQsIHZhbHVlKSBhcyBUO1xufVxuXG4vKipcbiAqIENvcHkgcHJvcGVydGllcyBmcm9tIHNvdXJjZSB0byB0YXJnZXQgKHJlY3Vyc2l2ZWx5IGFsbG93cyBleHRlbnNpb25cbiAqIG9mIE9iamVjdHMgYW5kIEFycmF5cykuICBTY2FsYXIgdmFsdWVzIGluIHRoZSB0YXJnZXQgYXJlIG92ZXItd3JpdHRlbi5cbiAqIElmIHRhcmdldCBpcyB1bmRlZmluZWQsIGFuIG9iamVjdCBvZiB0aGUgYXBwcm9wcmlhdGUgdHlwZSB3aWxsIGJlIGNyZWF0ZWRcbiAqIChhbmQgcmV0dXJuZWQpLlxuICpcbiAqIFdlIHJlY3Vyc2l2ZWx5IGNvcHkgYWxsIGNoaWxkIHByb3BlcnRpZXMgb2YgcGxhaW4gT2JqZWN0cyBpbiB0aGUgc291cmNlLSBzb1xuICogdGhhdCBuYW1lc3BhY2UtIGxpa2UgZGljdGlvbmFyaWVzIGFyZSBtZXJnZWQuXG4gKlxuICogTm90ZSB0aGF0IHRoZSB0YXJnZXQgY2FuIGJlIGEgZnVuY3Rpb24sIGluIHdoaWNoIGNhc2UgdGhlIHByb3BlcnRpZXMgaW5cbiAqIHRoZSBzb3VyY2UgT2JqZWN0IGFyZSBjb3BpZWQgb250byBpdCBhcyBzdGF0aWMgcHJvcGVydGllcyBvZiB0aGUgRnVuY3Rpb24uXG4gKlxuICogTm90ZTogd2UgZG9uJ3QgbWVyZ2UgX19wcm90b19fIHRvIHByZXZlbnQgcHJvdG90eXBlIHBvbGx1dGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVlcEV4dGVuZCh0YXJnZXQ6IHVua25vd24sIHNvdXJjZTogdW5rbm93bik6IHVua25vd24ge1xuICBpZiAoIShzb3VyY2UgaW5zdGFuY2VvZiBPYmplY3QpKSB7XG4gICAgcmV0dXJuIHNvdXJjZTtcbiAgfVxuXG4gIHN3aXRjaCAoc291cmNlLmNvbnN0cnVjdG9yKSB7XG4gICAgY2FzZSBEYXRlOlxuICAgICAgLy8gVHJlYXQgRGF0ZXMgbGlrZSBzY2FsYXJzOyBpZiB0aGUgdGFyZ2V0IGRhdGUgb2JqZWN0IGhhZCBhbnkgY2hpbGRcbiAgICAgIC8vIHByb3BlcnRpZXMgLSB0aGV5IHdpbGwgYmUgbG9zdCFcbiAgICAgIGNvbnN0IGRhdGVWYWx1ZSA9IHNvdXJjZSBhcyBEYXRlO1xuICAgICAgcmV0dXJuIG5ldyBEYXRlKGRhdGVWYWx1ZS5nZXRUaW1lKCkpO1xuXG4gICAgY2FzZSBPYmplY3Q6XG4gICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGFyZ2V0ID0ge307XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFycmF5OlxuICAgICAgLy8gQWx3YXlzIGNvcHkgdGhlIGFycmF5IHNvdXJjZSBhbmQgb3ZlcndyaXRlIHRoZSB0YXJnZXQuXG4gICAgICB0YXJnZXQgPSBbXTtcbiAgICAgIGJyZWFrO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIC8vIE5vdCBhIHBsYWluIE9iamVjdCAtIHRyZWF0IGl0IGFzIGEgc2NhbGFyLlxuICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgfVxuXG4gIGZvciAoY29uc3QgcHJvcCBpbiBzb3VyY2UpIHtcbiAgICAvLyB1c2UgaXNWYWxpZEtleSB0byBndWFyZCBhZ2FpbnN0IHByb3RvdHlwZSBwb2xsdXRpb24uIFNlZSBodHRwczovL3NueWsuaW8vdnVsbi9TTllLLUpTLUxPREFTSC00NTAyMDJcbiAgICBpZiAoIXNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wKSB8fCAhaXNWYWxpZEtleShwcm9wKSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgICh0YXJnZXQgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pW3Byb3BdID0gZGVlcEV4dGVuZChcbiAgICAgICh0YXJnZXQgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pW3Byb3BdLFxuICAgICAgKHNvdXJjZSBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPilbcHJvcF1cbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHRhcmdldDtcbn1cblxuZnVuY3Rpb24gaXNWYWxpZEtleShrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4ga2V5ICE9PSAnX19wcm90b19fJztcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFBvbHlmaWxsIGZvciBgZ2xvYmFsVGhpc2Agb2JqZWN0LlxuICogQHJldHVybnMgdGhlIGBnbG9iYWxUaGlzYCBvYmplY3QgZm9yIHRoZSBnaXZlbiBlbnZpcm9ubWVudC5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEdsb2JhbCgpOiB0eXBlb2YgZ2xvYmFsVGhpcyB7XG4gIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gc2VsZjtcbiAgfVxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gd2luZG93O1xuICB9XG4gIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBnbG9iYWw7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKCdVbmFibGUgdG8gbG9jYXRlIGdsb2JhbCBvYmplY3QuJyk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgYmFzZTY0RGVjb2RlIH0gZnJvbSAnLi9jcnlwdCc7XG5pbXBvcnQgeyBnZXRHbG9iYWwgfSBmcm9tICcuL2dsb2JhbCc7XG5cbi8qKlxuICogS2V5cyBmb3IgZXhwZXJpbWVudGFsIHByb3BlcnRpZXMgb24gdGhlIGBGaXJlYmFzZURlZmF1bHRzYCBvYmplY3QuXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB0eXBlIEV4cGVyaW1lbnRhbEtleSA9ICdhdXRoVG9rZW5TeW5jVVJMJyB8ICdhdXRoSWRUb2tlbk1heEFnZSc7XG5cbi8qKlxuICogQW4gb2JqZWN0IHRoYXQgY2FuIGJlIGluamVjdGVkIGludG8gdGhlIGVudmlyb25tZW50IGFzIF9fRklSRUJBU0VfREVGQVVMVFNfXyxcbiAqIGVpdGhlciBhcyBhIHByb3BlcnR5IG9mIGdsb2JhbFRoaXMsIGEgc2hlbGwgZW52aXJvbm1lbnQgdmFyaWFibGUsIG9yIGFcbiAqIGNvb2tpZS5cbiAqXG4gKiBUaGlzIG9iamVjdCBjYW4gYmUgdXNlZCB0byBhdXRvbWF0aWNhbGx5IGNvbmZpZ3VyZSBhbmQgaW5pdGlhbGl6ZVxuICogYSBGaXJlYmFzZSBhcHAgYXMgd2VsbCBhcyBhbnkgZW11bGF0b3JzLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGaXJlYmFzZURlZmF1bHRzIHtcbiAgY29uZmlnPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgZW11bGF0b3JIb3N0cz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG4gIF9hdXRoVG9rZW5TeW5jVVJMPzogc3RyaW5nO1xuICBfYXV0aElkVG9rZW5NYXhBZ2U/OiBudW1iZXI7XG4gIC8qKlxuICAgKiBPdmVycmlkZSBGaXJlYmFzZSdzIHJ1bnRpbWUgZW52aXJvbm1lbnQgZGV0ZWN0aW9uIGFuZFxuICAgKiBmb3JjZSB0aGUgU0RLIHRvIGFjdCBhcyBpZiBpdCB3ZXJlIGluIHRoZSBzcGVjaWZpZWQgZW52aXJvbm1lbnQuXG4gICAqL1xuICBmb3JjZUVudmlyb25tZW50PzogJ2Jyb3dzZXInIHwgJ25vZGUnO1xuICBba2V5OiBzdHJpbmddOiB1bmtub3duO1xufVxuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIC8vIE5lZWQgYHZhcmAgZm9yIHRoaXMgdG8gd29yay5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXZhclxuICB2YXIgX19GSVJFQkFTRV9ERUZBVUxUU19fOiBGaXJlYmFzZURlZmF1bHRzIHwgdW5kZWZpbmVkO1xufVxuXG5jb25zdCBnZXREZWZhdWx0c0Zyb21HbG9iYWwgPSAoKTogRmlyZWJhc2VEZWZhdWx0cyB8IHVuZGVmaW5lZCA9PlxuICBnZXRHbG9iYWwoKS5fX0ZJUkVCQVNFX0RFRkFVTFRTX187XG5cbi8qKlxuICogQXR0ZW1wdCB0byByZWFkIGRlZmF1bHRzIGZyb20gYSBKU09OIHN0cmluZyBwcm92aWRlZCB0b1xuICogcHJvY2VzcyguKWVudiguKV9fRklSRUJBU0VfREVGQVVMVFNfXyBvciBhIEpTT04gZmlsZSB3aG9zZSBwYXRoIGlzIGluXG4gKiBwcm9jZXNzKC4pZW52KC4pX19GSVJFQkFTRV9ERUZBVUxUU19QQVRIX19cbiAqIFRoZSBkb3RzIGFyZSBpbiBwYXJlbnMgYmVjYXVzZSBjZXJ0YWluIGNvbXBpbGVycyAoVml0ZT8pIGNhbm5vdFxuICogaGFuZGxlIHNlZWluZyB0aGF0IHZhcmlhYmxlIGluIGNvbW1lbnRzLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1qcy1zZGsvaXNzdWVzLzY4MzhcbiAqL1xuY29uc3QgZ2V0RGVmYXVsdHNGcm9tRW52VmFyaWFibGUgPSAoKTogRmlyZWJhc2VEZWZhdWx0cyB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHByb2Nlc3MuZW52ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBkZWZhdWx0c0pzb25TdHJpbmcgPSBwcm9jZXNzLmVudi5fX0ZJUkVCQVNFX0RFRkFVTFRTX187XG4gIGlmIChkZWZhdWx0c0pzb25TdHJpbmcpIHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShkZWZhdWx0c0pzb25TdHJpbmcpO1xuICB9XG59O1xuXG5jb25zdCBnZXREZWZhdWx0c0Zyb21Db29raWUgPSAoKTogRmlyZWJhc2VEZWZhdWx0cyB8IHVuZGVmaW5lZCA9PiB7XG4gIGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGxldCBtYXRjaDtcbiAgdHJ5IHtcbiAgICBtYXRjaCA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaCgvX19GSVJFQkFTRV9ERUZBVUxUU19fPShbXjtdKykvKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIFNvbWUgZW52aXJvbm1lbnRzIHN1Y2ggYXMgQW5ndWxhciBVbml2ZXJzYWwgU1NSIGhhdmUgYVxuICAgIC8vIGBkb2N1bWVudGAgb2JqZWN0IGJ1dCBlcnJvciBvbiBhY2Nlc3NpbmcgYGRvY3VtZW50LmNvb2tpZWAuXG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGRlY29kZWQgPSBtYXRjaCAmJiBiYXNlNjREZWNvZGUobWF0Y2hbMV0pO1xuICByZXR1cm4gZGVjb2RlZCAmJiBKU09OLnBhcnNlKGRlY29kZWQpO1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIF9fRklSRUJBU0VfREVGQVVMVFNfXyBvYmplY3QuIEl0IGNoZWNrcyBpbiBvcmRlcjpcbiAqICgxKSBpZiBzdWNoIGFuIG9iamVjdCBleGlzdHMgYXMgYSBwcm9wZXJ0eSBvZiBgZ2xvYmFsVGhpc2BcbiAqICgyKSBpZiBzdWNoIGFuIG9iamVjdCB3YXMgcHJvdmlkZWQgb24gYSBzaGVsbCBlbnZpcm9ubWVudCB2YXJpYWJsZVxuICogKDMpIGlmIHN1Y2ggYW4gb2JqZWN0IGV4aXN0cyBpbiBhIGNvb2tpZVxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgZ2V0RGVmYXVsdHMgPSAoKTogRmlyZWJhc2VEZWZhdWx0cyB8IHVuZGVmaW5lZCA9PiB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIChcbiAgICAgIGdldERlZmF1bHRzRnJvbUdsb2JhbCgpIHx8XG4gICAgICBnZXREZWZhdWx0c0Zyb21FbnZWYXJpYWJsZSgpIHx8XG4gICAgICBnZXREZWZhdWx0c0Zyb21Db29raWUoKVxuICAgICk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvKipcbiAgICAgKiBDYXRjaC1hbGwgZm9yIGJlaW5nIHVuYWJsZSB0byBnZXQgX19GSVJFQkFTRV9ERUZBVUxUU19fIGR1ZVxuICAgICAqIHRvIGFueSBlbnZpcm9ubWVudCBjYXNlIHdlIGhhdmUgbm90IGFjY291bnRlZCBmb3IuIExvZyB0b1xuICAgICAqIGluZm8gaW5zdGVhZCBvZiBzd2FsbG93aW5nIHNvIHdlIGNhbiBmaW5kIHRoZXNlIHVua25vd24gY2FzZXNcbiAgICAgKiBhbmQgYWRkIHBhdGhzIGZvciB0aGVtIGlmIG5lZWRlZC5cbiAgICAgKi9cbiAgICBjb25zb2xlLmluZm8oYFVuYWJsZSB0byBnZXQgX19GSVJFQkFTRV9ERUZBVUxUU19fIGR1ZSB0bzogJHtlfWApO1xuICAgIHJldHVybjtcbiAgfVxufTtcblxuLyoqXG4gKiBSZXR1cm5zIGVtdWxhdG9yIGhvc3Qgc3RvcmVkIGluIHRoZSBfX0ZJUkVCQVNFX0RFRkFVTFRTX18gb2JqZWN0XG4gKiBmb3IgdGhlIGdpdmVuIHByb2R1Y3QuXG4gKiBAcmV0dXJucyBhIFVSTCBob3N0IGZvcm1hdHRlZCBsaWtlIGAxMjcuMC4wLjE6OTk5OWAgb3IgYFs6OjFdOjQwMDBgIGlmIGF2YWlsYWJsZVxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCA9IChcbiAgcHJvZHVjdE5hbWU6IHN0cmluZ1xuKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IGdldERlZmF1bHRzKCk/LmVtdWxhdG9ySG9zdHM/Lltwcm9kdWN0TmFtZV07XG5cbi8qKlxuICogUmV0dXJucyBlbXVsYXRvciBob3N0bmFtZSBhbmQgcG9ydCBzdG9yZWQgaW4gdGhlIF9fRklSRUJBU0VfREVGQVVMVFNfXyBvYmplY3RcbiAqIGZvciB0aGUgZ2l2ZW4gcHJvZHVjdC5cbiAqIEByZXR1cm5zIGEgcGFpciBvZiBob3N0bmFtZSBhbmQgcG9ydCBsaWtlIGBbXCI6OjFcIiwgNDAwMF1gIGlmIGF2YWlsYWJsZVxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdG5hbWVBbmRQb3J0ID0gKFxuICBwcm9kdWN0TmFtZTogc3RyaW5nXG4pOiBbaG9zdG5hbWU6IHN0cmluZywgcG9ydDogbnVtYmVyXSB8IHVuZGVmaW5lZCA9PiB7XG4gIGNvbnN0IGhvc3QgPSBnZXREZWZhdWx0RW11bGF0b3JIb3N0KHByb2R1Y3ROYW1lKTtcbiAgaWYgKCFob3N0KSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBjb25zdCBzZXBhcmF0b3JJbmRleCA9IGhvc3QubGFzdEluZGV4T2YoJzonKTsgLy8gRmluZGluZyB0aGUgbGFzdCBzaW5jZSBJUHY2IGFkZHIgYWxzbyBoYXMgY29sb25zLlxuICBpZiAoc2VwYXJhdG9ySW5kZXggPD0gMCB8fCBzZXBhcmF0b3JJbmRleCArIDEgPT09IGhvc3QubGVuZ3RoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIGhvc3QgJHtob3N0fSB3aXRoIG5vIHNlcGFyYXRlIGhvc3RuYW1lIGFuZCBwb3J0IWApO1xuICB9XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLWdsb2JhbHNcbiAgY29uc3QgcG9ydCA9IHBhcnNlSW50KGhvc3Quc3Vic3RyaW5nKHNlcGFyYXRvckluZGV4ICsgMSksIDEwKTtcbiAgaWYgKGhvc3RbMF0gPT09ICdbJykge1xuICAgIC8vIEJyYWNrZXQtcXVvdGVkIGBbaXB2NmFkZHJdOnBvcnRgID0+IHJldHVybiBcImlwdjZhZGRyXCIgKHdpdGhvdXQgYnJhY2tldHMpLlxuICAgIHJldHVybiBbaG9zdC5zdWJzdHJpbmcoMSwgc2VwYXJhdG9ySW5kZXggLSAxKSwgcG9ydF07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFtob3N0LnN1YnN0cmluZygwLCBzZXBhcmF0b3JJbmRleCksIHBvcnRdO1xuICB9XG59O1xuXG4vKipcbiAqIFJldHVybnMgRmlyZWJhc2UgYXBwIGNvbmZpZyBzdG9yZWQgaW4gdGhlIF9fRklSRUJBU0VfREVGQVVMVFNfXyBvYmplY3QuXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjb25zdCBnZXREZWZhdWx0QXBwQ29uZmlnID0gKCk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCB1bmRlZmluZWQgPT5cbiAgZ2V0RGVmYXVsdHMoKT8uY29uZmlnO1xuXG4vKipcbiAqIFJldHVybnMgYW4gZXhwZXJpbWVudGFsIHNldHRpbmcgb24gdGhlIF9fRklSRUJBU0VfREVGQVVMVFNfXyBvYmplY3QgKHByb3BlcnRpZXNcbiAqIHByZWZpeGVkIGJ5IFwiX1wiKVxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgZ2V0RXhwZXJpbWVudGFsU2V0dGluZyA9IDxUIGV4dGVuZHMgRXhwZXJpbWVudGFsS2V5PihcbiAgbmFtZTogVFxuKTogRmlyZWJhc2VEZWZhdWx0c1tgXyR7VH1gXSA9PlxuICBnZXREZWZhdWx0cygpPy5bYF8ke25hbWV9YF0gYXMgRmlyZWJhc2VEZWZhdWx0c1tgXyR7VH1gXTtcbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5leHBvcnQgY2xhc3MgRGVmZXJyZWQ8Uj4ge1xuICBwcm9taXNlOiBQcm9taXNlPFI+O1xuICByZWplY3Q6ICh2YWx1ZT86IHVua25vd24pID0+IHZvaWQgPSAoKSA9PiB7fTtcbiAgcmVzb2x2ZTogKHZhbHVlPzogdW5rbm93bikgPT4gdm9pZCA9ICgpID0+IHt9O1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlIGFzICh2YWx1ZT86IHVua25vd24pID0+IHZvaWQ7XG4gICAgICB0aGlzLnJlamVjdCA9IHJlamVjdCBhcyAodmFsdWU/OiB1bmtub3duKSA9PiB2b2lkO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIE91ciBBUEkgaW50ZXJuYWxzIGFyZSBub3QgcHJvbWlzZWlmaWVkIGFuZCBjYW5ub3QgYmVjYXVzZSBvdXIgY2FsbGJhY2sgQVBJcyBoYXZlIHN1YnRsZSBleHBlY3RhdGlvbnMgYXJvdW5kXG4gICAqIGludm9raW5nIHByb21pc2VzIGlubGluZSwgd2hpY2ggUHJvbWlzZXMgYXJlIGZvcmJpZGRlbiB0byBkby4gVGhpcyBtZXRob2QgYWNjZXB0cyBhbiBvcHRpb25hbCBub2RlLXN0eWxlIGNhbGxiYWNrXG4gICAqIGFuZCByZXR1cm5zIGEgbm9kZS1zdHlsZSBjYWxsYmFjayB3aGljaCB3aWxsIHJlc29sdmUgb3IgcmVqZWN0IHRoZSBEZWZlcnJlZCdzIHByb21pc2UuXG4gICAqL1xuICB3cmFwQ2FsbGJhY2soXG4gICAgY2FsbGJhY2s/OiAoZXJyb3I/OiB1bmtub3duLCB2YWx1ZT86IHVua25vd24pID0+IHZvaWRcbiAgKTogKGVycm9yOiB1bmtub3duLCB2YWx1ZT86IHVua25vd24pID0+IHZvaWQge1xuICAgIHJldHVybiAoZXJyb3IsIHZhbHVlPykgPT4ge1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHRoaXMucmVqZWN0KGVycm9yKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVzb2x2ZSh2YWx1ZSk7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIEF0dGFjaGluZyBub29wIGhhbmRsZXIganVzdCBpbiBjYXNlIGRldmVsb3BlciB3YXNuJ3QgZXhwZWN0aW5nXG4gICAgICAgIC8vIHByb21pc2VzXG4gICAgICAgIHRoaXMucHJvbWlzZS5jYXRjaCgoKSA9PiB7fSk7XG5cbiAgICAgICAgLy8gU29tZSBvZiBvdXIgY2FsbGJhY2tzIGRvbid0IGV4cGVjdCBhIHZhbHVlIGFuZCBvdXIgb3duIHRlc3RzXG4gICAgICAgIC8vIGFzc2VydCB0aGF0IHRoZSBwYXJhbWV0ZXIgbGVuZ3RoIGlzIDFcbiAgICAgICAgaWYgKGNhbGxiYWNrLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIGNhbGxiYWNrKGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjYWxsYmFjayhlcnJvciwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nIH0gZnJvbSAnLi9jcnlwdCc7XG5cbi8vIEZpcmViYXNlIEF1dGggdG9rZW5zIGNvbnRhaW4gc25ha2VfY2FzZSBjbGFpbXMgZm9sbG93aW5nIHRoZSBKV1Qgc3RhbmRhcmQgLyBjb252ZW50aW9uLlxuLyogZXNsaW50LWRpc2FibGUgY2FtZWxjYXNlICovXG5cbmV4cG9ydCB0eXBlIEZpcmViYXNlU2lnbkluUHJvdmlkZXIgPVxuICB8ICdjdXN0b20nXG4gIHwgJ2VtYWlsJ1xuICB8ICdwYXNzd29yZCdcbiAgfCAncGhvbmUnXG4gIHwgJ2Fub255bW91cydcbiAgfCAnZ29vZ2xlLmNvbSdcbiAgfCAnZmFjZWJvb2suY29tJ1xuICB8ICdnaXRodWIuY29tJ1xuICB8ICd0d2l0dGVyLmNvbSdcbiAgfCAnbWljcm9zb2Z0LmNvbSdcbiAgfCAnYXBwbGUuY29tJztcblxuaW50ZXJmYWNlIEZpcmViYXNlSWRUb2tlbiB7XG4gIC8vIEFsd2F5cyBzZXQgdG8gaHR0cHM6Ly9zZWN1cmV0b2tlbi5nb29nbGUuY29tL1BST0pFQ1RfSURcbiAgaXNzOiBzdHJpbmc7XG5cbiAgLy8gQWx3YXlzIHNldCB0byBQUk9KRUNUX0lEXG4gIGF1ZDogc3RyaW5nO1xuXG4gIC8vIFRoZSB1c2VyJ3MgdW5pcXVlIElEXG4gIHN1Yjogc3RyaW5nO1xuXG4gIC8vIFRoZSB0b2tlbiBpc3N1ZSB0aW1lLCBpbiBzZWNvbmRzIHNpbmNlIGVwb2NoXG4gIGlhdDogbnVtYmVyO1xuXG4gIC8vIFRoZSB0b2tlbiBleHBpcnkgdGltZSwgbm9ybWFsbHkgJ2lhdCcgKyAzNjAwXG4gIGV4cDogbnVtYmVyO1xuXG4gIC8vIFRoZSB1c2VyJ3MgdW5pcXVlIElELiBNdXN0IGJlIGVxdWFsIHRvICdzdWInXG4gIHVzZXJfaWQ6IHN0cmluZztcblxuICAvLyBUaGUgdGltZSB0aGUgdXNlciBhdXRoZW50aWNhdGVkLCBub3JtYWxseSAnaWF0J1xuICBhdXRoX3RpbWU6IG51bWJlcjtcblxuICAvLyBUaGUgc2lnbiBpbiBwcm92aWRlciwgb25seSBzZXQgd2hlbiB0aGUgcHJvdmlkZXIgaXMgJ2Fub255bW91cydcbiAgcHJvdmlkZXJfaWQ/OiAnYW5vbnltb3VzJztcblxuICAvLyBUaGUgdXNlcidzIHByaW1hcnkgZW1haWxcbiAgZW1haWw/OiBzdHJpbmc7XG5cbiAgLy8gVGhlIHVzZXIncyBlbWFpbCB2ZXJpZmljYXRpb24gc3RhdHVzXG4gIGVtYWlsX3ZlcmlmaWVkPzogYm9vbGVhbjtcblxuICAvLyBUaGUgdXNlcidzIHByaW1hcnkgcGhvbmUgbnVtYmVyXG4gIHBob25lX251bWJlcj86IHN0cmluZztcblxuICAvLyBUaGUgdXNlcidzIGRpc3BsYXkgbmFtZVxuICBuYW1lPzogc3RyaW5nO1xuXG4gIC8vIFRoZSB1c2VyJ3MgcHJvZmlsZSBwaG90byBVUkxcbiAgcGljdHVyZT86IHN0cmluZztcblxuICAvLyBJbmZvcm1hdGlvbiBvbiBhbGwgaWRlbnRpdGllcyBsaW5rZWQgdG8gdGhpcyB1c2VyXG4gIGZpcmViYXNlOiB7XG4gICAgLy8gVGhlIHByaW1hcnkgc2lnbi1pbiBwcm92aWRlclxuICAgIHNpZ25faW5fcHJvdmlkZXI6IEZpcmViYXNlU2lnbkluUHJvdmlkZXI7XG5cbiAgICAvLyBBIG1hcCBvZiBwcm92aWRlcnMgdG8gdGhlIHVzZXIncyBsaXN0IG9mIHVuaXF1ZSBpZGVudGlmaWVycyBmcm9tXG4gICAgLy8gZWFjaCBwcm92aWRlclxuICAgIGlkZW50aXRpZXM/OiB7IFtwcm92aWRlciBpbiBGaXJlYmFzZVNpZ25JblByb3ZpZGVyXT86IHN0cmluZ1tdIH07XG4gIH07XG5cbiAgLy8gQ3VzdG9tIGNsYWltcyBzZXQgYnkgdGhlIGRldmVsb3BlclxuICBbY2xhaW06IHN0cmluZ106IHVua25vd247XG5cbiAgdWlkPzogbmV2ZXI7IC8vIFRyeSB0byBjYXRjaCBhIGNvbW1vbiBtaXN0YWtlIG9mIFwidWlkXCIgKHNob3VsZCBiZSBcInN1YlwiIGluc3RlYWQpLlxufVxuXG5leHBvcnQgdHlwZSBFbXVsYXRvck1vY2tUb2tlbk9wdGlvbnMgPSAoeyB1c2VyX2lkOiBzdHJpbmcgfSB8IHsgc3ViOiBzdHJpbmcgfSkgJlxuICBQYXJ0aWFsPEZpcmViYXNlSWRUb2tlbj47XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNb2NrVXNlclRva2VuKFxuICB0b2tlbjogRW11bGF0b3JNb2NrVG9rZW5PcHRpb25zLFxuICBwcm9qZWN0SWQ/OiBzdHJpbmdcbik6IHN0cmluZyB7XG4gIGlmICh0b2tlbi51aWQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAnVGhlIFwidWlkXCIgZmllbGQgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCBieSBtb2NrVXNlclRva2VuLiBQbGVhc2UgdXNlIFwic3ViXCIgaW5zdGVhZCBmb3IgRmlyZWJhc2UgQXV0aCBVc2VyIElELidcbiAgICApO1xuICB9XG4gIC8vIFVuc2VjdXJlZCBKV1RzIHVzZSBcIm5vbmVcIiBhcyB0aGUgYWxnb3JpdGhtLlxuICBjb25zdCBoZWFkZXIgPSB7XG4gICAgYWxnOiAnbm9uZScsXG4gICAgdHlwZTogJ0pXVCdcbiAgfTtcblxuICBjb25zdCBwcm9qZWN0ID0gcHJvamVjdElkIHx8ICdkZW1vLXByb2plY3QnO1xuICBjb25zdCBpYXQgPSB0b2tlbi5pYXQgfHwgMDtcbiAgY29uc3Qgc3ViID0gdG9rZW4uc3ViIHx8IHRva2VuLnVzZXJfaWQ7XG4gIGlmICghc3ViKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwibW9ja1VzZXJUb2tlbiBtdXN0IGNvbnRhaW4gJ3N1Yicgb3IgJ3VzZXJfaWQnIGZpZWxkIVwiKTtcbiAgfVxuXG4gIGNvbnN0IHBheWxvYWQ6IEZpcmViYXNlSWRUb2tlbiA9IHtcbiAgICAvLyBTZXQgYWxsIHJlcXVpcmVkIGZpZWxkcyB0byBkZWNlbnQgZGVmYXVsdHNcbiAgICBpc3M6IGBodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vJHtwcm9qZWN0fWAsXG4gICAgYXVkOiBwcm9qZWN0LFxuICAgIGlhdCxcbiAgICBleHA6IGlhdCArIDM2MDAsXG4gICAgYXV0aF90aW1lOiBpYXQsXG4gICAgc3ViLFxuICAgIHVzZXJfaWQ6IHN1YixcbiAgICBmaXJlYmFzZToge1xuICAgICAgc2lnbl9pbl9wcm92aWRlcjogJ2N1c3RvbScsXG4gICAgICBpZGVudGl0aWVzOiB7fVxuICAgIH0sXG5cbiAgICAvLyBPdmVycmlkZSB3aXRoIHVzZXIgb3B0aW9uc1xuICAgIC4uLnRva2VuXG4gIH07XG5cbiAgLy8gVW5zZWN1cmVkIEpXVHMgdXNlIHRoZSBlbXB0eSBzdHJpbmcgYXMgYSBzaWduYXR1cmUuXG4gIGNvbnN0IHNpZ25hdHVyZSA9ICcnO1xuICByZXR1cm4gW1xuICAgIGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nKEpTT04uc3RyaW5naWZ5KGhlYWRlcikpLFxuICAgIGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKSxcbiAgICBzaWduYXR1cmVcbiAgXS5qb2luKCcuJyk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQ09OU1RBTlRTIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgZ2V0RGVmYXVsdHMgfSBmcm9tICcuL2RlZmF1bHRzJztcblxuLyoqXG4gKiBSZXR1cm5zIG5hdmlnYXRvci51c2VyQWdlbnQgc3RyaW5nIG9yICcnIGlmIGl0J3Mgbm90IGRlZmluZWQuXG4gKiBAcmV0dXJuIHVzZXIgYWdlbnQgc3RyaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRVQSgpOiBzdHJpbmcge1xuICBpZiAoXG4gICAgdHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICB0eXBlb2YgbmF2aWdhdG9yWyd1c2VyQWdlbnQnXSA9PT0gJ3N0cmluZydcbiAgKSB7XG4gICAgcmV0dXJuIG5hdmlnYXRvclsndXNlckFnZW50J107XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG59XG5cbi8qKlxuICogRGV0ZWN0IENvcmRvdmEgLyBQaG9uZUdhcCAvIElvbmljIGZyYW1ld29ya3Mgb24gYSBtb2JpbGUgZGV2aWNlLlxuICpcbiAqIERlbGliZXJhdGVseSBkb2VzIG5vdCByZWx5IG9uIGNoZWNraW5nIGBmaWxlOi8vYCBVUkxzIChhcyB0aGlzIGZhaWxzIFBob25lR2FwXG4gKiBpbiB0aGUgUmlwcGxlIGVtdWxhdG9yKSBub3IgQ29yZG92YSBgb25EZXZpY2VSZWFkeWAsIHdoaWNoIHdvdWxkIG5vcm1hbGx5XG4gKiB3YWl0IGZvciBhIGNhbGxiYWNrLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNNb2JpbGVDb3Jkb3ZhKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gKFxuICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgLy8gQHRzLWlnbm9yZSBTZXR0aW5nIHVwIGFuIGJyb2FkbHkgYXBwbGljYWJsZSBpbmRleCBzaWduYXR1cmUgZm9yIFdpbmRvd1xuICAgIC8vIGp1c3QgdG8gZGVhbCB3aXRoIHRoaXMgY2FzZSB3b3VsZCBwcm9iYWJseSBiZSBhIGJhZCBpZGVhLlxuICAgICEhKHdpbmRvd1snY29yZG92YSddIHx8IHdpbmRvd1sncGhvbmVnYXAnXSB8fCB3aW5kb3dbJ1Bob25lR2FwJ10pICYmXG4gICAgL2lvc3xpcGhvbmV8aXBvZHxpcGFkfGFuZHJvaWR8YmxhY2tiZXJyeXxpZW1vYmlsZS9pLnRlc3QoZ2V0VUEoKSlcbiAgKTtcbn1cblxuLyoqXG4gKiBEZXRlY3QgTm9kZS5qcy5cbiAqXG4gKiBAcmV0dXJuIHRydWUgaWYgTm9kZS5qcyBlbnZpcm9ubWVudCBpcyBkZXRlY3RlZCBvciBzcGVjaWZpZWQuXG4gKi9cbi8vIE5vZGUgZGV0ZWN0aW9uIGxvZ2ljIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9pbGlha2FuL2RldGVjdC1ub2RlL1xuZXhwb3J0IGZ1bmN0aW9uIGlzTm9kZSgpOiBib29sZWFuIHtcbiAgY29uc3QgZm9yY2VFbnZpcm9ubWVudCA9IGdldERlZmF1bHRzKCk/LmZvcmNlRW52aXJvbm1lbnQ7XG4gIGlmIChmb3JjZUVudmlyb25tZW50ID09PSAnbm9kZScpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIGlmIChmb3JjZUVudmlyb25tZW50ID09PSAnYnJvd3NlcicpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICB0cnkge1xuICAgIHJldHVybiAoXG4gICAgICBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXSdcbiAgICApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogRGV0ZWN0IEJyb3dzZXIgRW52aXJvbm1lbnRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQnJvd3NlcigpOiBib29sZWFuIHtcbiAgcmV0dXJuIHR5cGVvZiBzZWxmID09PSAnb2JqZWN0JyAmJiBzZWxmLnNlbGYgPT09IHNlbGY7XG59XG5cbi8qKlxuICogRGV0ZWN0IGJyb3dzZXIgZXh0ZW5zaW9ucyAoQ2hyb21lIGFuZCBGaXJlZm94IGF0IGxlYXN0KS5cbiAqL1xuaW50ZXJmYWNlIEJyb3dzZXJSdW50aW1lIHtcbiAgaWQ/OiB1bmtub3duO1xufVxuZGVjbGFyZSBjb25zdCBjaHJvbWU6IHsgcnVudGltZT86IEJyb3dzZXJSdW50aW1lIH07XG5kZWNsYXJlIGNvbnN0IGJyb3dzZXI6IHsgcnVudGltZT86IEJyb3dzZXJSdW50aW1lIH07XG5leHBvcnQgZnVuY3Rpb24gaXNCcm93c2VyRXh0ZW5zaW9uKCk6IGJvb2xlYW4ge1xuICBjb25zdCBydW50aW1lID1cbiAgICB0eXBlb2YgY2hyb21lID09PSAnb2JqZWN0J1xuICAgICAgPyBjaHJvbWUucnVudGltZVxuICAgICAgOiB0eXBlb2YgYnJvd3NlciA9PT0gJ29iamVjdCdcbiAgICAgID8gYnJvd3Nlci5ydW50aW1lXG4gICAgICA6IHVuZGVmaW5lZDtcbiAgcmV0dXJuIHR5cGVvZiBydW50aW1lID09PSAnb2JqZWN0JyAmJiBydW50aW1lLmlkICE9PSB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogRGV0ZWN0IFJlYWN0IE5hdGl2ZS5cbiAqXG4gKiBAcmV0dXJuIHRydWUgaWYgUmVhY3ROYXRpdmUgZW52aXJvbm1lbnQgaXMgZGV0ZWN0ZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1JlYWN0TmF0aXZlKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gKFxuICAgIHR5cGVvZiBuYXZpZ2F0b3IgPT09ICdvYmplY3QnICYmIG5hdmlnYXRvclsncHJvZHVjdCddID09PSAnUmVhY3ROYXRpdmUnXG4gICk7XG59XG5cbi8qKiBEZXRlY3RzIEVsZWN0cm9uIGFwcHMuICovXG5leHBvcnQgZnVuY3Rpb24gaXNFbGVjdHJvbigpOiBib29sZWFuIHtcbiAgcmV0dXJuIGdldFVBKCkuaW5kZXhPZignRWxlY3Ryb24vJykgPj0gMDtcbn1cblxuLyoqIERldGVjdHMgSW50ZXJuZXQgRXhwbG9yZXIuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJRSgpOiBib29sZWFuIHtcbiAgY29uc3QgdWEgPSBnZXRVQSgpO1xuICByZXR1cm4gdWEuaW5kZXhPZignTVNJRSAnKSA+PSAwIHx8IHVhLmluZGV4T2YoJ1RyaWRlbnQvJykgPj0gMDtcbn1cblxuLyoqIERldGVjdHMgVW5pdmVyc2FsIFdpbmRvd3MgUGxhdGZvcm0gYXBwcy4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1VXUCgpOiBib29sZWFuIHtcbiAgcmV0dXJuIGdldFVBKCkuaW5kZXhPZignTVNBcHBIb3N0LycpID49IDA7XG59XG5cbi8qKlxuICogRGV0ZWN0IHdoZXRoZXIgdGhlIGN1cnJlbnQgU0RLIGJ1aWxkIGlzIHRoZSBOb2RlIHZlcnNpb24uXG4gKlxuICogQHJldHVybiB0cnVlIGlmIGl0J3MgdGhlIE5vZGUgU0RLIGJ1aWxkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNOb2RlU2RrKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gQ09OU1RBTlRTLk5PREVfQ0xJRU5UID09PSB0cnVlIHx8IENPTlNUQU5UUy5OT0RFX0FETUlOID09PSB0cnVlO1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIHdlIGFyZSBydW5uaW5nIGluIFNhZmFyaS4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1NhZmFyaSgpOiBib29sZWFuIHtcbiAgcmV0dXJuIChcbiAgICAhaXNOb2RlKCkgJiZcbiAgICBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdTYWZhcmknKSAmJlxuICAgICFuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdDaHJvbWUnKVxuICApO1xufVxuXG4vKipcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XG4gKiBAcmV0dXJuIHRydWUgaWYgaW5kZXhlZERCIGlzIHN1cHBvcnRlZCBieSBjdXJyZW50IGJyb3dzZXIvc2VydmljZSB3b3JrZXIgY29udGV4dFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNJbmRleGVkREJBdmFpbGFibGUoKTogYm9vbGVhbiB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHR5cGVvZiBpbmRleGVkREIgPT09ICdvYmplY3QnO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8qKlxuICogVGhpcyBtZXRob2QgdmFsaWRhdGVzIGJyb3dzZXIvc3cgY29udGV4dCBmb3IgaW5kZXhlZERCIGJ5IG9wZW5pbmcgYSBkdW1teSBpbmRleGVkREIgZGF0YWJhc2UgYW5kIHJlamVjdFxuICogaWYgZXJyb3JzIG9jY3VyIGR1cmluZyB0aGUgZGF0YWJhc2Ugb3BlbiBvcGVyYXRpb24uXG4gKlxuICogQHRocm93cyBleGNlcHRpb24gaWYgY3VycmVudCBicm93c2VyL3N3IGNvbnRleHQgY2FuJ3QgcnVuIGlkYi5vcGVuIChleDogU2FmYXJpIGlmcmFtZSwgRmlyZWZveFxuICogcHJpdmF0ZSBicm93c2luZylcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBwcmVFeGlzdDogYm9vbGVhbiA9IHRydWU7XG4gICAgICBjb25zdCBEQl9DSEVDS19OQU1FID1cbiAgICAgICAgJ3ZhbGlkYXRlLWJyb3dzZXItY29udGV4dC1mb3ItaW5kZXhlZGRiLWFuYWx5dGljcy1tb2R1bGUnO1xuICAgICAgY29uc3QgcmVxdWVzdCA9IHNlbGYuaW5kZXhlZERCLm9wZW4oREJfQ0hFQ0tfTkFNRSk7XG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHtcbiAgICAgICAgcmVxdWVzdC5yZXN1bHQuY2xvc2UoKTtcbiAgICAgICAgLy8gZGVsZXRlIGRhdGFiYXNlIG9ubHkgd2hlbiBpdCBkb2Vzbid0IHByZS1leGlzdFxuICAgICAgICBpZiAoIXByZUV4aXN0KSB7XG4gICAgICAgICAgc2VsZi5pbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoREJfQ0hFQ0tfTkFNRSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgIH07XG4gICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9ICgpID0+IHtcbiAgICAgICAgcHJlRXhpc3QgPSBmYWxzZTtcbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3Qub25lcnJvciA9ICgpID0+IHtcbiAgICAgICAgcmVqZWN0KHJlcXVlc3QuZXJyb3I/Lm1lc3NhZ2UgfHwgJycpO1xuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqXG4gKiBUaGlzIG1ldGhvZCBjaGVja3Mgd2hldGhlciBjb29raWUgaXMgZW5hYmxlZCB3aXRoaW4gY3VycmVudCBicm93c2VyXG4gKiBAcmV0dXJuIHRydWUgaWYgY29va2llIGlzIGVuYWJsZWQgd2l0aGluIGN1cnJlbnQgYnJvd3NlclxuICovXG5leHBvcnQgZnVuY3Rpb24gYXJlQ29va2llc0VuYWJsZWQoKTogYm9vbGVhbiB7XG4gIGlmICh0eXBlb2YgbmF2aWdhdG9yID09PSAndW5kZWZpbmVkJyB8fCAhbmF2aWdhdG9yLmNvb2tpZUVuYWJsZWQpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQGZpbGVvdmVydmlldyBTdGFuZGFyZGl6ZWQgRmlyZWJhc2UgRXJyb3IuXG4gKlxuICogVXNhZ2U6XG4gKlxuICogICAvLyBUeXBlc2NyaXB0IHN0cmluZyBsaXRlcmFscyBmb3IgdHlwZS1zYWZlIGNvZGVzXG4gKiAgIHR5cGUgRXJyID1cbiAqICAgICAndW5rbm93bicgfFxuICogICAgICdvYmplY3Qtbm90LWZvdW5kJ1xuICogICAgIDtcbiAqXG4gKiAgIC8vIENsb3N1cmUgZW51bSBmb3IgdHlwZS1zYWZlIGVycm9yIGNvZGVzXG4gKiAgIC8vIGF0LWVudW0ge3N0cmluZ31cbiAqICAgdmFyIEVyciA9IHtcbiAqICAgICBVTktOT1dOOiAndW5rbm93bicsXG4gKiAgICAgT0JKRUNUX05PVF9GT1VORDogJ29iamVjdC1ub3QtZm91bmQnLFxuICogICB9XG4gKlxuICogICBsZXQgZXJyb3JzOiBNYXA8RXJyLCBzdHJpbmc+ID0ge1xuICogICAgICdnZW5lcmljLWVycm9yJzogXCJVbmtub3duIGVycm9yXCIsXG4gKiAgICAgJ2ZpbGUtbm90LWZvdW5kJzogXCJDb3VsZCBub3QgZmluZCBmaWxlOiB7JGZpbGV9XCIsXG4gKiAgIH07XG4gKlxuICogICAvLyBUeXBlLXNhZmUgZnVuY3Rpb24gLSBtdXN0IHBhc3MgYSB2YWxpZCBlcnJvciBjb2RlIGFzIHBhcmFtLlxuICogICBsZXQgZXJyb3IgPSBuZXcgRXJyb3JGYWN0b3J5PEVycj4oJ3NlcnZpY2UnLCAnU2VydmljZScsIGVycm9ycyk7XG4gKlxuICogICAuLi5cbiAqICAgdGhyb3cgZXJyb3IuY3JlYXRlKEVyci5HRU5FUklDKTtcbiAqICAgLi4uXG4gKiAgIHRocm93IGVycm9yLmNyZWF0ZShFcnIuRklMRV9OT1RfRk9VTkQsIHsnZmlsZSc6IGZpbGVOYW1lfSk7XG4gKiAgIC4uLlxuICogICAvLyBTZXJ2aWNlOiBDb3VsZCBub3QgZmlsZSBmaWxlOiBmb28udHh0IChzZXJ2aWNlL2ZpbGUtbm90LWZvdW5kKS5cbiAqXG4gKiAgIGNhdGNoIChlKSB7XG4gKiAgICAgYXNzZXJ0KGUubWVzc2FnZSA9PT0gXCJDb3VsZCBub3QgZmluZCBmaWxlOiBmb28udHh0LlwiKTtcbiAqICAgICBpZiAoKGUgYXMgRmlyZWJhc2VFcnJvcik/LmNvZGUgPT09ICdzZXJ2aWNlL2ZpbGUtbm90LWZvdW5kJykge1xuICogICAgICAgY29uc29sZS5sb2coXCJDb3VsZCBub3QgcmVhZCBmaWxlOiBcIiArIGVbJ2ZpbGUnXSk7XG4gKiAgICAgfVxuICogICB9XG4gKi9cblxuZXhwb3J0IHR5cGUgRXJyb3JNYXA8RXJyb3JDb2RlIGV4dGVuZHMgc3RyaW5nPiA9IHtcbiAgcmVhZG9ubHkgW0sgaW4gRXJyb3JDb2RlXTogc3RyaW5nO1xufTtcblxuY29uc3QgRVJST1JfTkFNRSA9ICdGaXJlYmFzZUVycm9yJztcblxuZXhwb3J0IGludGVyZmFjZSBTdHJpbmdMaWtlIHtcbiAgdG9TdHJpbmcoKTogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVycm9yRGF0YSB7XG4gIFtrZXk6IHN0cmluZ106IHVua25vd247XG59XG5cbi8vIEJhc2VkIG9uIGNvZGUgZnJvbTpcbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Vycm9yI0N1c3RvbV9FcnJvcl9UeXBlc1xuZXhwb3J0IGNsYXNzIEZpcmViYXNlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIC8qKiBUaGUgY3VzdG9tIG5hbWUgZm9yIGFsbCBGaXJlYmFzZUVycm9ycy4gKi9cbiAgcmVhZG9ubHkgbmFtZTogc3RyaW5nID0gRVJST1JfTkFNRTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIGVycm9yIGNvZGUgZm9yIHRoaXMgZXJyb3IuICovXG4gICAgcmVhZG9ubHkgY29kZTogc3RyaW5nLFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICAvKiogQ3VzdG9tIGRhdGEgZm9yIHRoaXMgZXJyb3IuICovXG4gICAgcHVibGljIGN1c3RvbURhdGE/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxuICApIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcblxuICAgIC8vIEZpeCBGb3IgRVM1XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0LXdpa2kvYmxvYi9tYXN0ZXIvQnJlYWtpbmctQ2hhbmdlcy5tZCNleHRlbmRpbmctYnVpbHQtaW5zLWxpa2UtZXJyb3ItYXJyYXktYW5kLW1hcC1tYXktbm8tbG9uZ2VyLXdvcmtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgRmlyZWJhc2VFcnJvci5wcm90b3R5cGUpO1xuXG4gICAgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24uXG4gICAgLy8gT25seSBhdmFpbGFibGUgb24gVjguXG4gICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBFcnJvckZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBFcnJvckZhY3Rvcnk8XG4gIEVycm9yQ29kZSBleHRlbmRzIHN0cmluZyxcbiAgRXJyb3JQYXJhbXMgZXh0ZW5kcyB7IHJlYWRvbmx5IFtLIGluIEVycm9yQ29kZV0/OiBFcnJvckRhdGEgfSA9IHt9XG4+IHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBzZXJ2aWNlOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSByZWFkb25seSBzZXJ2aWNlTmFtZTogc3RyaW5nLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgZXJyb3JzOiBFcnJvck1hcDxFcnJvckNvZGU+XG4gICkge31cblxuICBjcmVhdGU8SyBleHRlbmRzIEVycm9yQ29kZT4oXG4gICAgY29kZTogSyxcbiAgICAuLi5kYXRhOiBLIGV4dGVuZHMga2V5b2YgRXJyb3JQYXJhbXMgPyBbRXJyb3JQYXJhbXNbS11dIDogW11cbiAgKTogRmlyZWJhc2VFcnJvciB7XG4gICAgY29uc3QgY3VzdG9tRGF0YSA9IChkYXRhWzBdIGFzIEVycm9yRGF0YSkgfHwge307XG4gICAgY29uc3QgZnVsbENvZGUgPSBgJHt0aGlzLnNlcnZpY2V9LyR7Y29kZX1gO1xuICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy5lcnJvcnNbY29kZV07XG5cbiAgICBjb25zdCBtZXNzYWdlID0gdGVtcGxhdGUgPyByZXBsYWNlVGVtcGxhdGUodGVtcGxhdGUsIGN1c3RvbURhdGEpIDogJ0Vycm9yJztcbiAgICAvLyBTZXJ2aWNlIE5hbWU6IEVycm9yIG1lc3NhZ2UgKHNlcnZpY2UvY29kZSkuXG4gICAgY29uc3QgZnVsbE1lc3NhZ2UgPSBgJHt0aGlzLnNlcnZpY2VOYW1lfTogJHttZXNzYWdlfSAoJHtmdWxsQ29kZX0pLmA7XG5cbiAgICBjb25zdCBlcnJvciA9IG5ldyBGaXJlYmFzZUVycm9yKGZ1bGxDb2RlLCBmdWxsTWVzc2FnZSwgY3VzdG9tRGF0YSk7XG5cbiAgICByZXR1cm4gZXJyb3I7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVwbGFjZVRlbXBsYXRlKHRlbXBsYXRlOiBzdHJpbmcsIGRhdGE6IEVycm9yRGF0YSk6IHN0cmluZyB7XG4gIHJldHVybiB0ZW1wbGF0ZS5yZXBsYWNlKFBBVFRFUk4sIChfLCBrZXkpID0+IHtcbiAgICBjb25zdCB2YWx1ZSA9IGRhdGFba2V5XTtcbiAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCA/IFN0cmluZyh2YWx1ZSkgOiBgPCR7a2V5fT8+YDtcbiAgfSk7XG59XG5cbmNvbnN0IFBBVFRFUk4gPSAvXFx7XFwkKFtefV0rKX0vZztcbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEV2YWx1YXRlcyBhIEpTT04gc3RyaW5nIGludG8gYSBqYXZhc2NyaXB0IG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyIEEgc3RyaW5nIGNvbnRhaW5pbmcgSlNPTi5cbiAqIEByZXR1cm4geyp9IFRoZSBqYXZhc2NyaXB0IG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHNwZWNpZmllZCBKU09OLlxuICovXG5leHBvcnQgZnVuY3Rpb24ganNvbkV2YWwoc3RyOiBzdHJpbmcpOiB1bmtub3duIHtcbiAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIEpTT04gcmVwcmVzZW50aW5nIGEgamF2YXNjcmlwdCBvYmplY3QuXG4gKiBAcGFyYW0geyp9IGRhdGEgSmF2YXNjcmlwdCBvYmplY3QgdG8gYmUgc3RyaW5naWZpZWQuXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBKU09OIGNvbnRlbnRzIG9mIHRoZSBvYmplY3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpbmdpZnkoZGF0YTogdW5rbm93bik6IHN0cmluZyB7XG4gIHJldHVybiBKU09OLnN0cmluZ2lmeShkYXRhKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBiYXNlNjREZWNvZGUgfSBmcm9tICcuL2NyeXB0JztcbmltcG9ydCB7IGpzb25FdmFsIH0gZnJvbSAnLi9qc29uJztcblxuaW50ZXJmYWNlIENsYWltcyB7XG4gIFtrZXk6IHN0cmluZ106IHt9O1xufVxuXG5pbnRlcmZhY2UgRGVjb2RlZFRva2VuIHtcbiAgaGVhZGVyOiBvYmplY3Q7XG4gIGNsYWltczogQ2xhaW1zO1xuICBkYXRhOiBvYmplY3Q7XG4gIHNpZ25hdHVyZTogc3RyaW5nO1xufVxuXG4vKipcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBpbnRvIGNvbnN0aXR1ZW50IHBhcnRzLlxuICpcbiAqIE5vdGVzOlxuICogLSBNYXkgcmV0dXJuIHdpdGggaW52YWxpZCAvIGluY29tcGxldGUgY2xhaW1zIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cbiAqL1xuZXhwb3J0IGNvbnN0IGRlY29kZSA9IGZ1bmN0aW9uICh0b2tlbjogc3RyaW5nKTogRGVjb2RlZFRva2VuIHtcbiAgbGV0IGhlYWRlciA9IHt9LFxuICAgIGNsYWltczogQ2xhaW1zID0ge30sXG4gICAgZGF0YSA9IHt9LFxuICAgIHNpZ25hdHVyZSA9ICcnO1xuXG4gIHRyeSB7XG4gICAgY29uc3QgcGFydHMgPSB0b2tlbi5zcGxpdCgnLicpO1xuICAgIGhlYWRlciA9IGpzb25FdmFsKGJhc2U2NERlY29kZShwYXJ0c1swXSkgfHwgJycpIGFzIG9iamVjdDtcbiAgICBjbGFpbXMgPSBqc29uRXZhbChiYXNlNjREZWNvZGUocGFydHNbMV0pIHx8ICcnKSBhcyBDbGFpbXM7XG4gICAgc2lnbmF0dXJlID0gcGFydHNbMl07XG4gICAgZGF0YSA9IGNsYWltc1snZCddIHx8IHt9O1xuICAgIGRlbGV0ZSBjbGFpbXNbJ2QnXTtcbiAgfSBjYXRjaCAoZSkge31cblxuICByZXR1cm4ge1xuICAgIGhlYWRlcixcbiAgICBjbGFpbXMsXG4gICAgZGF0YSxcbiAgICBzaWduYXR1cmVcbiAgfTtcbn07XG5cbmludGVyZmFjZSBEZWNvZGVkVG9rZW4ge1xuICBoZWFkZXI6IG9iamVjdDtcbiAgY2xhaW1zOiBDbGFpbXM7XG4gIGRhdGE6IG9iamVjdDtcbiAgc2lnbmF0dXJlOiBzdHJpbmc7XG59XG5cbi8qKlxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyB0aW1lLWJhc2VkIGNsYWltcy4gV2lsbCByZXR1cm4gdHJ1ZSBpZiB0aGVcbiAqIHRva2VuIGlzIHdpdGhpbiB0aGUgdGltZSB3aW5kb3cgYXV0aG9yaXplZCBieSB0aGUgJ25iZicgKG5vdC1iZWZvcmUpIGFuZCAnaWF0JyAoaXNzdWVkLWF0KSBjbGFpbXMuXG4gKlxuICogTm90ZXM6XG4gKiAtIE1heSByZXR1cm4gYSBmYWxzZSBuZWdhdGl2ZSBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXG4gKi9cbmV4cG9ydCBjb25zdCBpc1ZhbGlkVGltZXN0YW1wID0gZnVuY3Rpb24gKHRva2VuOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3QgY2xhaW1zOiBDbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcztcbiAgY29uc3Qgbm93OiBudW1iZXIgPSBNYXRoLmZsb29yKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMCk7XG4gIGxldCB2YWxpZFNpbmNlOiBudW1iZXIgPSAwLFxuICAgIHZhbGlkVW50aWw6IG51bWJlciA9IDA7XG5cbiAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnKSB7XG4gICAgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnbmJmJykpIHtcbiAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ25iZiddIGFzIG51bWJlcjtcbiAgICB9IGVsc2UgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcbiAgICAgIHZhbGlkU2luY2UgPSBjbGFpbXNbJ2lhdCddIGFzIG51bWJlcjtcbiAgICB9XG5cbiAgICBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCdleHAnKSkge1xuICAgICAgdmFsaWRVbnRpbCA9IGNsYWltc1snZXhwJ10gYXMgbnVtYmVyO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyB0b2tlbiB3aWxsIGV4cGlyZSBhZnRlciAyNGggYnkgZGVmYXVsdFxuICAgICAgdmFsaWRVbnRpbCA9IHZhbGlkU2luY2UgKyA4NjQwMDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gKFxuICAgICEhbm93ICYmXG4gICAgISF2YWxpZFNpbmNlICYmXG4gICAgISF2YWxpZFVudGlsICYmXG4gICAgbm93ID49IHZhbGlkU2luY2UgJiZcbiAgICBub3cgPD0gdmFsaWRVbnRpbFxuICApO1xufTtcblxuLyoqXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIHJldHVybnMgaXRzIGlzc3VlZCBhdCB0aW1lIGlmIHZhbGlkLCBudWxsIG90aGVyd2lzZS5cbiAqXG4gKiBOb3RlczpcbiAqIC0gTWF5IHJldHVybiBudWxsIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cbiAqL1xuZXhwb3J0IGNvbnN0IGlzc3VlZEF0VGltZSA9IGZ1bmN0aW9uICh0b2tlbjogc3RyaW5nKTogbnVtYmVyIHwgbnVsbCB7XG4gIGNvbnN0IGNsYWltczogQ2xhaW1zID0gZGVjb2RlKHRva2VuKS5jbGFpbXM7XG4gIGlmICh0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpKSB7XG4gICAgcmV0dXJuIGNsYWltc1snaWF0J10gYXMgbnVtYmVyO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcblxuLyoqXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIGNoZWNrcyB0aGUgdmFsaWRpdHkgb2YgaXRzIGZvcm1hdC4gRXhwZWN0cyBhIHZhbGlkIGlzc3VlZC1hdCB0aW1lLlxuICpcbiAqIE5vdGVzOlxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxuICovXG5leHBvcnQgY29uc3QgaXNWYWxpZEZvcm1hdCA9IGZ1bmN0aW9uICh0b2tlbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IGRlY29kZWQgPSBkZWNvZGUodG9rZW4pLFxuICAgIGNsYWltcyA9IGRlY29kZWQuY2xhaW1zO1xuXG4gIHJldHVybiAhIWNsYWltcyAmJiB0eXBlb2YgY2xhaW1zID09PSAnb2JqZWN0JyAmJiBjbGFpbXMuaGFzT3duUHJvcGVydHkoJ2lhdCcpO1xufTtcblxuLyoqXG4gKiBBdHRlbXB0cyB0byBwZWVyIGludG8gYW4gYXV0aCB0b2tlbiBhbmQgZGV0ZXJtaW5lIGlmIGl0J3MgYW4gYWRtaW4gYXV0aCB0b2tlbiBieSBsb29raW5nIGF0IHRoZSBjbGFpbXMgcG9ydGlvbi5cbiAqXG4gKiBOb3RlczpcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cbiAqL1xuZXhwb3J0IGNvbnN0IGlzQWRtaW4gPSBmdW5jdGlvbiAodG9rZW46IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBjbGFpbXM6IENsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xuICByZXR1cm4gdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zWydhZG1pbiddID09PSB0cnVlO1xufTtcbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gY29udGFpbnM8VCBleHRlbmRzIG9iamVjdD4ob2JqOiBULCBrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhZmVHZXQ8VCBleHRlbmRzIG9iamVjdCwgSyBleHRlbmRzIGtleW9mIFQ+KFxuICBvYmo6IFQsXG4gIGtleTogS1xuKTogVFtLXSB8IHVuZGVmaW5lZCB7XG4gIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG4gICAgcmV0dXJuIG9ialtrZXldO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRW1wdHkob2JqOiBvYmplY3QpOiBvYmogaXMge30ge1xuICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hcDxLIGV4dGVuZHMgc3RyaW5nLCBWLCBVPihcbiAgb2JqOiB7IFtrZXkgaW4gS106IFYgfSxcbiAgZm46ICh2YWx1ZTogViwga2V5OiBLLCBvYmo6IHsgW2tleSBpbiBLXTogViB9KSA9PiBVLFxuICBjb250ZXh0T2JqPzogdW5rbm93blxuKTogeyBba2V5IGluIEtdOiBVIH0ge1xuICBjb25zdCByZXM6IFBhcnRpYWw8eyBba2V5IGluIEtdOiBVIH0+ID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIG9iaikge1xuICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG4gICAgICByZXNba2V5XSA9IGZuLmNhbGwoY29udGV4dE9iaiwgb2JqW2tleV0sIGtleSwgb2JqKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlcyBhcyB7IFtrZXkgaW4gS106IFUgfTtcbn1cblxuLyoqXG4gKiBEZWVwIGVxdWFsIHR3byBvYmplY3RzLiBTdXBwb3J0IEFycmF5cyBhbmQgT2JqZWN0cy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlZXBFcXVhbChhOiBvYmplY3QsIGI6IG9iamVjdCk6IGJvb2xlYW4ge1xuICBpZiAoYSA9PT0gYikge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgY29uc3QgYUtleXMgPSBPYmplY3Qua2V5cyhhKTtcbiAgY29uc3QgYktleXMgPSBPYmplY3Qua2V5cyhiKTtcbiAgZm9yIChjb25zdCBrIG9mIGFLZXlzKSB7XG4gICAgaWYgKCFiS2V5cy5pbmNsdWRlcyhrKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IGFQcm9wID0gKGEgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pW2tdO1xuICAgIGNvbnN0IGJQcm9wID0gKGIgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pW2tdO1xuICAgIGlmIChpc09iamVjdChhUHJvcCkgJiYgaXNPYmplY3QoYlByb3ApKSB7XG4gICAgICBpZiAoIWRlZXBFcXVhbChhUHJvcCwgYlByb3ApKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGFQcm9wICE9PSBiUHJvcCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGZvciAoY29uc3QgayBvZiBiS2V5cykge1xuICAgIGlmICghYUtleXMuaW5jbHVkZXMoaykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KHRoaW5nOiB1bmtub3duKTogdGhpbmcgaXMgb2JqZWN0IHtcbiAgcmV0dXJuIHRoaW5nICE9PSBudWxsICYmIHR5cGVvZiB0aGluZyA9PT0gJ29iamVjdCc7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgRGVmZXJyZWQgfSBmcm9tICcuL2RlZmVycmVkJztcblxuLyoqXG4gKiBSZWplY3RzIGlmIHRoZSBnaXZlbiBwcm9taXNlIGRvZXNuJ3QgcmVzb2x2ZSBpbiB0aW1lSW5NUyBtaWxsaXNlY29uZHMuXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHByb21pc2VXaXRoVGltZW91dDxUPihcbiAgcHJvbWlzZTogUHJvbWlzZTxUPixcbiAgdGltZUluTVMgPSAyMDAwXG4pOiBQcm9taXNlPFQ+IHtcbiAgY29uc3QgZGVmZXJyZWRQcm9taXNlID0gbmV3IERlZmVycmVkPFQ+KCk7XG4gIHNldFRpbWVvdXQoKCkgPT4gZGVmZXJyZWRQcm9taXNlLnJlamVjdCgndGltZW91dCEnKSwgdGltZUluTVMpO1xuICBwcm9taXNlLnRoZW4oZGVmZXJyZWRQcm9taXNlLnJlc29sdmUsIGRlZmVycmVkUHJvbWlzZS5yZWplY3QpO1xuICByZXR1cm4gZGVmZXJyZWRQcm9taXNlLnByb21pc2U7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBSZXR1cm5zIGEgcXVlcnlzdHJpbmctZm9ybWF0dGVkIHN0cmluZyAoZS5nLiAmYXJnPXZhbCZhcmcyPXZhbDIpIGZyb20gYVxuICogcGFyYW1zIG9iamVjdCAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcbiAqIE5vdGU6IFlvdSBtdXN0IHByZXBlbmQgaXQgd2l0aCA/IHdoZW4gYWRkaW5nIGl0IHRvIGEgVVJMLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcXVlcnlzdHJpbmcocXVlcnlzdHJpbmdQYXJhbXM6IHtcbiAgW2tleTogc3RyaW5nXTogc3RyaW5nIHwgbnVtYmVyO1xufSk6IHN0cmluZyB7XG4gIGNvbnN0IHBhcmFtcyA9IFtdO1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhxdWVyeXN0cmluZ1BhcmFtcykpIHtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIHZhbHVlLmZvckVhY2goYXJyYXlWYWwgPT4ge1xuICAgICAgICBwYXJhbXMucHVzaChcbiAgICAgICAgICBlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChhcnJheVZhbClcbiAgICAgICAgKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyYW1zLmxlbmd0aCA/ICcmJyArIHBhcmFtcy5qb2luKCcmJykgOiAnJztcbn1cblxuLyoqXG4gKiBEZWNvZGVzIGEgcXVlcnlzdHJpbmcgKGUuZy4gP2FyZz12YWwmYXJnMj12YWwyKSBpbnRvIGEgcGFyYW1zIG9iamVjdFxuICogKGUuZy4ge2FyZzogJ3ZhbCcsIGFyZzI6ICd2YWwyJ30pXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBxdWVyeXN0cmluZ0RlY29kZShxdWVyeXN0cmluZzogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gIGNvbnN0IG9iajogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICBjb25zdCB0b2tlbnMgPSBxdWVyeXN0cmluZy5yZXBsYWNlKC9eXFw/LywgJycpLnNwbGl0KCcmJyk7XG5cbiAgdG9rZW5zLmZvckVhY2godG9rZW4gPT4ge1xuICAgIGlmICh0b2tlbikge1xuICAgICAgY29uc3QgW2tleSwgdmFsdWVdID0gdG9rZW4uc3BsaXQoJz0nKTtcbiAgICAgIG9ialtkZWNvZGVVUklDb21wb25lbnQoa2V5KV0gPSBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBvYmo7XG59XG5cbi8qKlxuICogRXh0cmFjdCB0aGUgcXVlcnkgc3RyaW5nIHBhcnQgb2YgYSBVUkwsIGluY2x1ZGluZyB0aGUgbGVhZGluZyBxdWVzdGlvbiBtYXJrIChpZiBwcmVzZW50KS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RRdWVyeXN0cmluZyh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IHF1ZXJ5U3RhcnQgPSB1cmwuaW5kZXhPZignPycpO1xuICBpZiAoIXF1ZXJ5U3RhcnQpIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbiAgY29uc3QgZnJhZ21lbnRTdGFydCA9IHVybC5pbmRleE9mKCcjJywgcXVlcnlTdGFydCk7XG4gIHJldHVybiB1cmwuc3Vic3RyaW5nKFxuICAgIHF1ZXJ5U3RhcnQsXG4gICAgZnJhZ21lbnRTdGFydCA+IDAgPyBmcmFnbWVudFN0YXJ0IDogdW5kZWZpbmVkXG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaC5cbiAqIFZhcmlhYmxlIG5hbWVzIGZvbGxvdyB0aGUgbm90YXRpb24gaW4gRklQUyBQVUIgMTgwLTM6XG4gKiBodHRwOi8vY3NyYy5uaXN0Lmdvdi9wdWJsaWNhdGlvbnMvZmlwcy9maXBzMTgwLTMvZmlwczE4MC0zX2ZpbmFsLnBkZi5cbiAqXG4gKiBVc2FnZTpcbiAqICAgdmFyIHNoYTEgPSBuZXcgc2hhMSgpO1xuICogICBzaGExLnVwZGF0ZShieXRlcyk7XG4gKiAgIHZhciBoYXNoID0gc2hhMS5kaWdlc3QoKTtcbiAqXG4gKiBQZXJmb3JtYW5jZTpcbiAqICAgQ2hyb21lIDIzOiAgIH40MDAgTWJpdC9zXG4gKiAgIEZpcmVmb3ggMTY6ICB+MjUwIE1iaXQvc1xuICpcbiAqL1xuXG4vKipcbiAqIFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaCBjb25zdHJ1Y3Rvci5cbiAqXG4gKiBUaGUgcHJvcGVydGllcyBkZWNsYXJlZCBoZXJlIGFyZSBkaXNjdXNzZWQgaW4gdGhlIGFib3ZlIGFsZ29yaXRobSBkb2N1bWVudC5cbiAqIEBjb25zdHJ1Y3RvclxuICogQGZpbmFsXG4gKiBAc3RydWN0XG4gKi9cbmV4cG9ydCBjbGFzcyBTaGExIHtcbiAgLyoqXG4gICAqIEhvbGRzIHRoZSBwcmV2aW91cyB2YWx1ZXMgb2YgYWNjdW11bGF0ZWQgdmFyaWFibGVzIGEtZSBpbiB0aGUgY29tcHJlc3NfXG4gICAqIGZ1bmN0aW9uLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBjaGFpbl86IG51bWJlcltdID0gW107XG5cbiAgLyoqXG4gICAqIEEgYnVmZmVyIGhvbGRpbmcgdGhlIHBhcnRpYWxseSBjb21wdXRlZCBoYXNoIHJlc3VsdC5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByaXZhdGUgYnVmXzogbnVtYmVyW10gPSBbXTtcblxuICAvKipcbiAgICogQW4gYXJyYXkgb2YgODAgYnl0ZXMsIGVhY2ggYSBwYXJ0IG9mIHRoZSBtZXNzYWdlIHRvIGJlIGhhc2hlZC4gIFJlZmVycmVkIHRvXG4gICAqIGFzIHRoZSBtZXNzYWdlIHNjaGVkdWxlIGluIHRoZSBkb2NzLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgcHJpdmF0ZSBXXzogbnVtYmVyW10gPSBbXTtcblxuICAvKipcbiAgICogQ29udGFpbnMgZGF0YSBuZWVkZWQgdG8gcGFkIG1lc3NhZ2VzIGxlc3MgdGhhbiA2NCBieXRlcy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIHByaXZhdGUgcGFkXzogbnVtYmVyW10gPSBbXTtcblxuICAvKipcbiAgICogQHByaXZhdGUge251bWJlcn1cbiAgICovXG4gIHByaXZhdGUgaW5idWZfOiBudW1iZXIgPSAwO1xuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZSB7bnVtYmVyfVxuICAgKi9cbiAgcHJpdmF0ZSB0b3RhbF86IG51bWJlciA9IDA7XG5cbiAgYmxvY2tTaXplOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5ibG9ja1NpemUgPSA1MTIgLyA4O1xuXG4gICAgdGhpcy5wYWRfWzBdID0gMTI4O1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdGhpcy5ibG9ja1NpemU7ICsraSkge1xuICAgICAgdGhpcy5wYWRfW2ldID0gMDtcbiAgICB9XG5cbiAgICB0aGlzLnJlc2V0KCk7XG4gIH1cblxuICByZXNldCgpOiB2b2lkIHtcbiAgICB0aGlzLmNoYWluX1swXSA9IDB4Njc0NTIzMDE7XG4gICAgdGhpcy5jaGFpbl9bMV0gPSAweGVmY2RhYjg5O1xuICAgIHRoaXMuY2hhaW5fWzJdID0gMHg5OGJhZGNmZTtcbiAgICB0aGlzLmNoYWluX1szXSA9IDB4MTAzMjU0NzY7XG4gICAgdGhpcy5jaGFpbl9bNF0gPSAweGMzZDJlMWYwO1xuXG4gICAgdGhpcy5pbmJ1Zl8gPSAwO1xuICAgIHRoaXMudG90YWxfID0gMDtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnRlcm5hbCBjb21wcmVzcyBoZWxwZXIgZnVuY3Rpb24uXG4gICAqIEBwYXJhbSBidWYgQmxvY2sgdG8gY29tcHJlc3MuXG4gICAqIEBwYXJhbSBvZmZzZXQgT2Zmc2V0IG9mIHRoZSBibG9jayBpbiB0aGUgYnVmZmVyLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgY29tcHJlc3NfKGJ1ZjogbnVtYmVyW10gfCBVaW50OEFycmF5IHwgc3RyaW5nLCBvZmZzZXQ/OiBudW1iZXIpOiB2b2lkIHtcbiAgICBpZiAoIW9mZnNldCkge1xuICAgICAgb2Zmc2V0ID0gMDtcbiAgICB9XG5cbiAgICBjb25zdCBXID0gdGhpcy5XXztcblxuICAgIC8vIGdldCAxNiBiaWcgZW5kaWFuIHdvcmRzXG4gICAgaWYgKHR5cGVvZiBidWYgPT09ICdzdHJpbmcnKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHtcbiAgICAgICAgLy8gVE9ETyh1c2VyKTogW2J1ZyA4MTQwMTIyXSBSZWNlbnQgdmVyc2lvbnMgb2YgU2FmYXJpIGZvciBNYWMgT1MgYW5kIGlPU1xuICAgICAgICAvLyBoYXZlIGEgYnVnIHRoYXQgdHVybnMgdGhlIHBvc3QtaW5jcmVtZW50ICsrIG9wZXJhdG9yIGludG8gcHJlLWluY3JlbWVudFxuICAgICAgICAvLyBkdXJpbmcgSklUIGNvbXBpbGF0aW9uLiAgV2UgaGF2ZSBjb2RlIHRoYXQgZGVwZW5kcyBoZWF2aWx5IG9uIFNIQS0xIGZvclxuICAgICAgICAvLyBjb3JyZWN0bmVzcyBhbmQgd2hpY2ggaXMgYWZmZWN0ZWQgYnkgdGhpcyBidWcsIHNvIEkndmUgcmVtb3ZlZCBhbGwgdXNlc1xuICAgICAgICAvLyBvZiBwb3N0LWluY3JlbWVudCArKyBpbiB3aGljaCB0aGUgcmVzdWx0IHZhbHVlIGlzIHVzZWQuICBXZSBjYW4gcmV2ZXJ0XG4gICAgICAgIC8vIHRoaXMgY2hhbmdlIG9uY2UgdGhlIFNhZmFyaSBidWdcbiAgICAgICAgLy8gKGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMDkwMzYpIGhhcyBiZWVuIGZpeGVkIGFuZFxuICAgICAgICAvLyBtb3N0IGNsaWVudHMgaGF2ZSBiZWVuIHVwZGF0ZWQuXG4gICAgICAgIFdbaV0gPVxuICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQpIDw8IDI0KSB8XG4gICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDEpIDw8IDE2KSB8XG4gICAgICAgICAgKGJ1Zi5jaGFyQ29kZUF0KG9mZnNldCArIDIpIDw8IDgpIHxcbiAgICAgICAgICBidWYuY2hhckNvZGVBdChvZmZzZXQgKyAzKTtcbiAgICAgICAgb2Zmc2V0ICs9IDQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTY7IGkrKykge1xuICAgICAgICBXW2ldID1cbiAgICAgICAgICAoYnVmW29mZnNldF0gPDwgMjQpIHxcbiAgICAgICAgICAoYnVmW29mZnNldCArIDFdIDw8IDE2KSB8XG4gICAgICAgICAgKGJ1ZltvZmZzZXQgKyAyXSA8PCA4KSB8XG4gICAgICAgICAgYnVmW29mZnNldCArIDNdO1xuICAgICAgICBvZmZzZXQgKz0gNDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBleHBhbmQgdG8gODAgd29yZHNcbiAgICBmb3IgKGxldCBpID0gMTY7IGkgPCA4MDsgaSsrKSB7XG4gICAgICBjb25zdCB0ID0gV1tpIC0gM10gXiBXW2kgLSA4XSBeIFdbaSAtIDE0XSBeIFdbaSAtIDE2XTtcbiAgICAgIFdbaV0gPSAoKHQgPDwgMSkgfCAodCA+Pj4gMzEpKSAmIDB4ZmZmZmZmZmY7XG4gICAgfVxuXG4gICAgbGV0IGEgPSB0aGlzLmNoYWluX1swXTtcbiAgICBsZXQgYiA9IHRoaXMuY2hhaW5fWzFdO1xuICAgIGxldCBjID0gdGhpcy5jaGFpbl9bMl07XG4gICAgbGV0IGQgPSB0aGlzLmNoYWluX1szXTtcbiAgICBsZXQgZSA9IHRoaXMuY2hhaW5fWzRdO1xuICAgIGxldCBmLCBrO1xuXG4gICAgLy8gVE9ETyh1c2VyKTogVHJ5IHRvIHVucm9sbCB0aGlzIGxvb3AgdG8gc3BlZWQgdXAgdGhlIGNvbXB1dGF0aW9uLlxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODA7IGkrKykge1xuICAgICAgaWYgKGkgPCA0MCkge1xuICAgICAgICBpZiAoaSA8IDIwKSB7XG4gICAgICAgICAgZiA9IGQgXiAoYiAmIChjIF4gZCkpO1xuICAgICAgICAgIGsgPSAweDVhODI3OTk5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGYgPSBiIF4gYyBeIGQ7XG4gICAgICAgICAgayA9IDB4NmVkOWViYTE7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChpIDwgNjApIHtcbiAgICAgICAgICBmID0gKGIgJiBjKSB8IChkICYgKGIgfCBjKSk7XG4gICAgICAgICAgayA9IDB4OGYxYmJjZGM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZiA9IGIgXiBjIF4gZDtcbiAgICAgICAgICBrID0gMHhjYTYyYzFkNjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjb25zdCB0ID0gKCgoYSA8PCA1KSB8IChhID4+PiAyNykpICsgZiArIGUgKyBrICsgV1tpXSkgJiAweGZmZmZmZmZmO1xuICAgICAgZSA9IGQ7XG4gICAgICBkID0gYztcbiAgICAgIGMgPSAoKGIgPDwgMzApIHwgKGIgPj4+IDIpKSAmIDB4ZmZmZmZmZmY7XG4gICAgICBiID0gYTtcbiAgICAgIGEgPSB0O1xuICAgIH1cblxuICAgIHRoaXMuY2hhaW5fWzBdID0gKHRoaXMuY2hhaW5fWzBdICsgYSkgJiAweGZmZmZmZmZmO1xuICAgIHRoaXMuY2hhaW5fWzFdID0gKHRoaXMuY2hhaW5fWzFdICsgYikgJiAweGZmZmZmZmZmO1xuICAgIHRoaXMuY2hhaW5fWzJdID0gKHRoaXMuY2hhaW5fWzJdICsgYykgJiAweGZmZmZmZmZmO1xuICAgIHRoaXMuY2hhaW5fWzNdID0gKHRoaXMuY2hhaW5fWzNdICsgZCkgJiAweGZmZmZmZmZmO1xuICAgIHRoaXMuY2hhaW5fWzRdID0gKHRoaXMuY2hhaW5fWzRdICsgZSkgJiAweGZmZmZmZmZmO1xuICB9XG5cbiAgdXBkYXRlKGJ5dGVzPzogbnVtYmVyW10gfCBVaW50OEFycmF5IHwgc3RyaW5nLCBsZW5ndGg/OiBudW1iZXIpOiB2b2lkIHtcbiAgICAvLyBUT0RPKGpvaG5sZW56KTogdGlnaHRlbiB0aGUgZnVuY3Rpb24gc2lnbmF0dXJlIGFuZCByZW1vdmUgdGhpcyBjaGVja1xuICAgIGlmIChieXRlcyA9PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGxlbmd0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBsZW5ndGggPSBieXRlcy5sZW5ndGg7XG4gICAgfVxuXG4gICAgY29uc3QgbGVuZ3RoTWludXNCbG9jayA9IGxlbmd0aCAtIHRoaXMuYmxvY2tTaXplO1xuICAgIGxldCBuID0gMDtcbiAgICAvLyBVc2luZyBsb2NhbCBpbnN0ZWFkIG9mIG1lbWJlciB2YXJpYWJsZXMgZ2l2ZXMgfjUlIHNwZWVkdXAgb24gRmlyZWZveCAxNi5cbiAgICBjb25zdCBidWYgPSB0aGlzLmJ1Zl87XG4gICAgbGV0IGluYnVmID0gdGhpcy5pbmJ1Zl87XG5cbiAgICAvLyBUaGUgb3V0ZXIgd2hpbGUgbG9vcCBzaG91bGQgZXhlY3V0ZSBhdCBtb3N0IHR3aWNlLlxuICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XG4gICAgICAvLyBXaGVuIHdlIGhhdmUgbm8gZGF0YSBpbiB0aGUgYmxvY2sgdG8gdG9wIHVwLCB3ZSBjYW4gZGlyZWN0bHkgcHJvY2VzcyB0aGVcbiAgICAgIC8vIGlucHV0IGJ1ZmZlciAoYXNzdW1pbmcgaXQgY29udGFpbnMgc3VmZmljaWVudCBkYXRhKS4gVGhpcyBnaXZlcyB+MjUlXG4gICAgICAvLyBzcGVlZHVwIG9uIENocm9tZSAyMyBhbmQgfjE1JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYsIGJ1dCByZXF1aXJlcyB0aGF0XG4gICAgICAvLyB0aGUgZGF0YSBpcyBwcm92aWRlZCBpbiBsYXJnZSBjaHVua3MgKG9yIGluIG11bHRpcGxlcyBvZiA2NCBieXRlcykuXG4gICAgICBpZiAoaW5idWYgPT09IDApIHtcbiAgICAgICAgd2hpbGUgKG4gPD0gbGVuZ3RoTWludXNCbG9jaykge1xuICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ5dGVzLCBuKTtcbiAgICAgICAgICBuICs9IHRoaXMuYmxvY2tTaXplO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgYnl0ZXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHdoaWxlIChuIDwgbGVuZ3RoKSB7XG4gICAgICAgICAgYnVmW2luYnVmXSA9IGJ5dGVzLmNoYXJDb2RlQXQobik7XG4gICAgICAgICAgKytpbmJ1ZjtcbiAgICAgICAgICArK247XG4gICAgICAgICAgaWYgKGluYnVmID09PSB0aGlzLmJsb2NrU2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcbiAgICAgICAgICAgIGluYnVmID0gMDtcbiAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgd2hpbGUgKG4gPCBsZW5ndGgpIHtcbiAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXNbbl07XG4gICAgICAgICAgKytpbmJ1ZjtcbiAgICAgICAgICArK247XG4gICAgICAgICAgaWYgKGluYnVmID09PSB0aGlzLmJsb2NrU2l6ZSkge1xuICAgICAgICAgICAgdGhpcy5jb21wcmVzc18oYnVmKTtcbiAgICAgICAgICAgIGluYnVmID0gMDtcbiAgICAgICAgICAgIC8vIEp1bXAgdG8gdGhlIG91dGVyIGxvb3Agc28gd2UgdXNlIHRoZSBmdWxsLWJsb2NrIG9wdGltaXphdGlvbi5cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuaW5idWZfID0gaW5idWY7XG4gICAgdGhpcy50b3RhbF8gKz0gbGVuZ3RoO1xuICB9XG5cbiAgLyoqIEBvdmVycmlkZSAqL1xuICBkaWdlc3QoKTogbnVtYmVyW10ge1xuICAgIGNvbnN0IGRpZ2VzdDogbnVtYmVyW10gPSBbXTtcbiAgICBsZXQgdG90YWxCaXRzID0gdGhpcy50b3RhbF8gKiA4O1xuXG4gICAgLy8gQWRkIHBhZCAweDgwIDB4MDAqLlxuICAgIGlmICh0aGlzLmluYnVmXyA8IDU2KSB7XG4gICAgICB0aGlzLnVwZGF0ZSh0aGlzLnBhZF8sIDU2IC0gdGhpcy5pbmJ1Zl8pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnVwZGF0ZSh0aGlzLnBhZF8sIHRoaXMuYmxvY2tTaXplIC0gKHRoaXMuaW5idWZfIC0gNTYpKTtcbiAgICB9XG5cbiAgICAvLyBBZGQgIyBiaXRzLlxuICAgIGZvciAobGV0IGkgPSB0aGlzLmJsb2NrU2l6ZSAtIDE7IGkgPj0gNTY7IGktLSkge1xuICAgICAgdGhpcy5idWZfW2ldID0gdG90YWxCaXRzICYgMjU1O1xuICAgICAgdG90YWxCaXRzIC89IDI1NjsgLy8gRG9uJ3QgdXNlIGJpdC1zaGlmdGluZyBoZXJlIVxuICAgIH1cblxuICAgIHRoaXMuY29tcHJlc3NfKHRoaXMuYnVmXyk7XG5cbiAgICBsZXQgbiA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAyNDsgaiA+PSAwOyBqIC09IDgpIHtcbiAgICAgICAgZGlnZXN0W25dID0gKHRoaXMuY2hhaW5fW2ldID4+IGopICYgMjU1O1xuICAgICAgICArK247XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBkaWdlc3Q7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZXhwb3J0IHR5cGUgTmV4dEZuPFQ+ID0gKHZhbHVlOiBUKSA9PiB2b2lkO1xuZXhwb3J0IHR5cGUgRXJyb3JGbiA9IChlcnJvcjogRXJyb3IpID0+IHZvaWQ7XG5leHBvcnQgdHlwZSBDb21wbGV0ZUZuID0gKCkgPT4gdm9pZDtcblxuZXhwb3J0IGludGVyZmFjZSBPYnNlcnZlcjxUPiB7XG4gIC8vIENhbGxlZCBvbmNlIGZvciBlYWNoIHZhbHVlIGluIGEgc3RyZWFtIG9mIHZhbHVlcy5cbiAgbmV4dDogTmV4dEZuPFQ+O1xuXG4gIC8vIEEgc3RyZWFtIHRlcm1pbmF0ZXMgYnkgYSBzaW5nbGUgY2FsbCB0byBFSVRIRVIgZXJyb3IoKSBvciBjb21wbGV0ZSgpLlxuICBlcnJvcjogRXJyb3JGbjtcblxuICAvLyBObyBldmVudHMgd2lsbCBiZSBzZW50IHRvIG5leHQoKSBvbmNlIGNvbXBsZXRlKCkgaXMgY2FsbGVkLlxuICBjb21wbGV0ZTogQ29tcGxldGVGbjtcbn1cblxuZXhwb3J0IHR5cGUgUGFydGlhbE9ic2VydmVyPFQ+ID0gUGFydGlhbDxPYnNlcnZlcjxUPj47XG5cbi8vIFRPRE86IFN1cHBvcnQgYWxzbyBVbnN1YnNjcmliZS51bnN1YnNjcmliZT9cbmV4cG9ydCB0eXBlIFVuc3Vic2NyaWJlID0gKCkgPT4gdm9pZDtcblxuLyoqXG4gKiBUaGUgU3Vic2NyaWJlIGludGVyZmFjZSBoYXMgdHdvIGZvcm1zIC0gcGFzc2luZyB0aGUgaW5saW5lIGZ1bmN0aW9uXG4gKiBjYWxsYmFja3MsIG9yIGEgb2JqZWN0IGludGVyZmFjZSB3aXRoIGNhbGxiYWNrIHByb3BlcnRpZXMuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU3Vic2NyaWJlPFQ+IHtcbiAgKG5leHQ/OiBOZXh0Rm48VD4sIGVycm9yPzogRXJyb3JGbiwgY29tcGxldGU/OiBDb21wbGV0ZUZuKTogVW5zdWJzY3JpYmU7XG4gIChvYnNlcnZlcjogUGFydGlhbE9ic2VydmVyPFQ+KTogVW5zdWJzY3JpYmU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgT2JzZXJ2YWJsZTxUPiB7XG4gIC8vIFN1YnNjcmliZSBtZXRob2RcbiAgc3Vic2NyaWJlOiBTdWJzY3JpYmU8VD47XG59XG5cbmV4cG9ydCB0eXBlIEV4ZWN1dG9yPFQ+ID0gKG9ic2VydmVyOiBPYnNlcnZlcjxUPikgPT4gdm9pZDtcblxuLyoqXG4gKiBIZWxwZXIgdG8gbWFrZSBhIFN1YnNjcmliZSBmdW5jdGlvbiAoanVzdCBsaWtlIFByb21pc2UgaGVscHMgbWFrZSBhXG4gKiBUaGVuYWJsZSkuXG4gKlxuICogQHBhcmFtIGV4ZWN1dG9yIEZ1bmN0aW9uIHdoaWNoIGNhbiBtYWtlIGNhbGxzIHRvIGEgc2luZ2xlIE9ic2VydmVyXG4gKiAgICAgYXMgYSBwcm94eS5cbiAqIEBwYXJhbSBvbk5vT2JzZXJ2ZXJzIENhbGxiYWNrIHdoZW4gY291bnQgb2YgT2JzZXJ2ZXJzIGdvZXMgdG8gemVyby5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN1YnNjcmliZTxUPihcbiAgZXhlY3V0b3I6IEV4ZWN1dG9yPFQ+LFxuICBvbk5vT2JzZXJ2ZXJzPzogRXhlY3V0b3I8VD5cbik6IFN1YnNjcmliZTxUPiB7XG4gIGNvbnN0IHByb3h5ID0gbmV3IE9ic2VydmVyUHJveHk8VD4oZXhlY3V0b3IsIG9uTm9PYnNlcnZlcnMpO1xuICByZXR1cm4gcHJveHkuc3Vic2NyaWJlLmJpbmQocHJveHkpO1xufVxuXG4vKipcbiAqIEltcGxlbWVudCBmYW4tb3V0IGZvciBhbnkgbnVtYmVyIG9mIE9ic2VydmVycyBhdHRhY2hlZCB2aWEgYSBzdWJzY3JpYmVcbiAqIGZ1bmN0aW9uLlxuICovXG5jbGFzcyBPYnNlcnZlclByb3h5PFQ+IGltcGxlbWVudHMgT2JzZXJ2ZXI8VD4ge1xuICBwcml2YXRlIG9ic2VydmVyczogQXJyYXk8T2JzZXJ2ZXI8VD4+IHwgdW5kZWZpbmVkID0gW107XG4gIHByaXZhdGUgdW5zdWJzY3JpYmVzOiBVbnN1YnNjcmliZVtdID0gW107XG4gIHByaXZhdGUgb25Ob09ic2VydmVyczogRXhlY3V0b3I8VD4gfCB1bmRlZmluZWQ7XG4gIHByaXZhdGUgb2JzZXJ2ZXJDb3VudCA9IDA7XG4gIC8vIE1pY3JvLXRhc2sgc2NoZWR1bGluZyBieSBjYWxsaW5nIHRhc2sudGhlbigpLlxuICBwcml2YXRlIHRhc2sgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgcHJpdmF0ZSBmaW5hbGl6ZWQgPSBmYWxzZTtcbiAgcHJpdmF0ZSBmaW5hbEVycm9yPzogRXJyb3I7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBleGVjdXRvciBGdW5jdGlvbiB3aGljaCBjYW4gbWFrZSBjYWxscyB0byBhIHNpbmdsZSBPYnNlcnZlclxuICAgKiAgICAgYXMgYSBwcm94eS5cbiAgICogQHBhcmFtIG9uTm9PYnNlcnZlcnMgQ2FsbGJhY2sgd2hlbiBjb3VudCBvZiBPYnNlcnZlcnMgZ29lcyB0byB6ZXJvLlxuICAgKi9cbiAgY29uc3RydWN0b3IoZXhlY3V0b3I6IEV4ZWN1dG9yPFQ+LCBvbk5vT2JzZXJ2ZXJzPzogRXhlY3V0b3I8VD4pIHtcbiAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSBvbk5vT2JzZXJ2ZXJzO1xuICAgIC8vIENhbGwgdGhlIGV4ZWN1dG9yIGFzeW5jaHJvbm91c2x5IHNvIHN1YnNjcmliZXJzIHRoYXQgYXJlIGNhbGxlZFxuICAgIC8vIHN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIGNyZWF0aW9uIG9mIHRoZSBzdWJzY3JpYmUgZnVuY3Rpb25cbiAgICAvLyBjYW4gc3RpbGwgcmVjZWl2ZSB0aGUgdmVyeSBmaXJzdCB2YWx1ZSBnZW5lcmF0ZWQgaW4gdGhlIGV4ZWN1dG9yLlxuICAgIHRoaXMudGFza1xuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBleGVjdXRvcih0aGlzKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goZSA9PiB7XG4gICAgICAgIHRoaXMuZXJyb3IoZSk7XG4gICAgICB9KTtcbiAgfVxuXG4gIG5leHQodmFsdWU6IFQpOiB2b2lkIHtcbiAgICB0aGlzLmZvckVhY2hPYnNlcnZlcigob2JzZXJ2ZXI6IE9ic2VydmVyPFQ+KSA9PiB7XG4gICAgICBvYnNlcnZlci5uZXh0KHZhbHVlKTtcbiAgICB9KTtcbiAgfVxuXG4gIGVycm9yKGVycm9yOiBFcnJvcik6IHZvaWQge1xuICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKChvYnNlcnZlcjogT2JzZXJ2ZXI8VD4pID0+IHtcbiAgICAgIG9ic2VydmVyLmVycm9yKGVycm9yKTtcbiAgICB9KTtcbiAgICB0aGlzLmNsb3NlKGVycm9yKTtcbiAgfVxuXG4gIGNvbXBsZXRlKCk6IHZvaWQge1xuICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKChvYnNlcnZlcjogT2JzZXJ2ZXI8VD4pID0+IHtcbiAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XG4gICAgfSk7XG4gICAgdGhpcy5jbG9zZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFN1YnNjcmliZSBmdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGFkZCBhbiBPYnNlcnZlciB0byB0aGUgZmFuLW91dCBsaXN0LlxuICAgKlxuICAgKiAtIFdlIHJlcXVpcmUgdGhhdCBubyBldmVudCBpcyBzZW50IHRvIGEgc3Vic2NyaWJlciBzeWNocm9ub3VzbHkgdG8gdGhlaXJcbiAgICogICBjYWxsIHRvIHN1YnNjcmliZSgpLlxuICAgKi9cbiAgc3Vic2NyaWJlKFxuICAgIG5leHRPck9ic2VydmVyPzogTmV4dEZuPFQ+IHwgUGFydGlhbE9ic2VydmVyPFQ+LFxuICAgIGVycm9yPzogRXJyb3JGbixcbiAgICBjb21wbGV0ZT86IENvbXBsZXRlRm5cbiAgKTogVW5zdWJzY3JpYmUge1xuICAgIGxldCBvYnNlcnZlcjogT2JzZXJ2ZXI8VD47XG5cbiAgICBpZiAoXG4gICAgICBuZXh0T3JPYnNlcnZlciA9PT0gdW5kZWZpbmVkICYmXG4gICAgICBlcnJvciA9PT0gdW5kZWZpbmVkICYmXG4gICAgICBjb21wbGV0ZSA9PT0gdW5kZWZpbmVkXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgT2JzZXJ2ZXIuJyk7XG4gICAgfVxuXG4gICAgLy8gQXNzZW1ibGUgYW4gT2JzZXJ2ZXIgb2JqZWN0IHdoZW4gcGFzc2VkIGFzIGNhbGxiYWNrIGZ1bmN0aW9ucy5cbiAgICBpZiAoXG4gICAgICBpbXBsZW1lbnRzQW55TWV0aG9kcyhuZXh0T3JPYnNlcnZlciBhcyB7IFtrZXk6IHN0cmluZ106IHVua25vd24gfSwgW1xuICAgICAgICAnbmV4dCcsXG4gICAgICAgICdlcnJvcicsXG4gICAgICAgICdjb21wbGV0ZSdcbiAgICAgIF0pXG4gICAgKSB7XG4gICAgICBvYnNlcnZlciA9IG5leHRPck9ic2VydmVyIGFzIE9ic2VydmVyPFQ+O1xuICAgIH0gZWxzZSB7XG4gICAgICBvYnNlcnZlciA9IHtcbiAgICAgICAgbmV4dDogbmV4dE9yT2JzZXJ2ZXIgYXMgTmV4dEZuPFQ+LFxuICAgICAgICBlcnJvcixcbiAgICAgICAgY29tcGxldGVcbiAgICAgIH0gYXMgT2JzZXJ2ZXI8VD47XG4gICAgfVxuXG4gICAgaWYgKG9ic2VydmVyLm5leHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgb2JzZXJ2ZXIubmV4dCA9IG5vb3AgYXMgTmV4dEZuPFQ+O1xuICAgIH1cbiAgICBpZiAob2JzZXJ2ZXIuZXJyb3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgb2JzZXJ2ZXIuZXJyb3IgPSBub29wIGFzIEVycm9yRm47XG4gICAgfVxuICAgIGlmIChvYnNlcnZlci5jb21wbGV0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBvYnNlcnZlci5jb21wbGV0ZSA9IG5vb3AgYXMgQ29tcGxldGVGbjtcbiAgICB9XG5cbiAgICBjb25zdCB1bnN1YiA9IHRoaXMudW5zdWJzY3JpYmVPbmUuYmluZCh0aGlzLCB0aGlzLm9ic2VydmVycyEubGVuZ3RoKTtcblxuICAgIC8vIEF0dGVtcHQgdG8gc3Vic2NyaWJlIHRvIGEgdGVybWluYXRlZCBPYnNlcnZhYmxlIC0gd2VcbiAgICAvLyBqdXN0IHJlc3BvbmQgdG8gdGhlIE9ic2VydmVyIHdpdGggdGhlIGZpbmFsIGVycm9yIG9yIGNvbXBsZXRlXG4gICAgLy8gZXZlbnQuXG4gICAgaWYgKHRoaXMuZmluYWxpemVkKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgICB0aGlzLnRhc2sudGhlbigoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKHRoaXMuZmluYWxFcnJvcikge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IodGhpcy5maW5hbEVycm9yKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAvLyBub3RoaW5nXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgdGhpcy5vYnNlcnZlcnMhLnB1c2gob2JzZXJ2ZXIgYXMgT2JzZXJ2ZXI8VD4pO1xuXG4gICAgcmV0dXJuIHVuc3ViO1xuICB9XG5cbiAgLy8gVW5zdWJzY3JpYmUgaXMgc3luY2hyb25vdXMgLSB3ZSBndWFyYW50ZWUgdGhhdCBubyBldmVudHMgYXJlIHNlbnQgdG9cbiAgLy8gYW55IHVuc3Vic2NyaWJlZCBPYnNlcnZlci5cbiAgcHJpdmF0ZSB1bnN1YnNjcmliZU9uZShpOiBudW1iZXIpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5vYnNlcnZlcnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLm9ic2VydmVyc1tpXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZGVsZXRlIHRoaXMub2JzZXJ2ZXJzW2ldO1xuXG4gICAgdGhpcy5vYnNlcnZlckNvdW50IC09IDE7XG4gICAgaWYgKHRoaXMub2JzZXJ2ZXJDb3VudCA9PT0gMCAmJiB0aGlzLm9uTm9PYnNlcnZlcnMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzKHRoaXMpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZm9yRWFjaE9ic2VydmVyKGZuOiAob2JzZXJ2ZXI6IE9ic2VydmVyPFQ+KSA9PiB2b2lkKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZmluYWxpemVkKSB7XG4gICAgICAvLyBBbHJlYWR5IGNsb3NlZCBieSBwcmV2aW91cyBldmVudC4uLi5qdXN0IGVhdCB0aGUgYWRkaXRpb25hbCB2YWx1ZXMuXG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gU2luY2Ugc2VuZE9uZSBjYWxscyBhc3luY2hyb25vdXNseSAtIHRoZXJlIGlzIG5vIGNoYW5jZSB0aGF0XG4gICAgLy8gdGhpcy5vYnNlcnZlcnMgd2lsbCBiZWNvbWUgdW5kZWZpbmVkLlxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMhLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLnNlbmRPbmUoaSwgZm4pO1xuICAgIH1cbiAgfVxuXG4gIC8vIENhbGwgdGhlIE9ic2VydmVyIHZpYSBvbmUgb2YgaXQncyBjYWxsYmFjayBmdW5jdGlvbi4gV2UgYXJlIGNhcmVmdWwgdG9cbiAgLy8gY29uZmlybSB0aGF0IHRoZSBvYnNlcnZlIGhhcyBub3QgYmVlbiB1bnN1YnNjcmliZWQgc2luY2UgdGhpcyBhc3luY2hyb25vdXNcbiAgLy8gZnVuY3Rpb24gaGFkIGJlZW4gcXVldWVkLlxuICBwcml2YXRlIHNlbmRPbmUoaTogbnVtYmVyLCBmbjogKG9ic2VydmVyOiBPYnNlcnZlcjxUPikgPT4gdm9pZCk6IHZvaWQge1xuICAgIC8vIEV4ZWN1dGUgdGhlIGNhbGxiYWNrIGFzeW5jaHJvbm91c2x5XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgIHRoaXMudGFzay50aGVuKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLm9ic2VydmVycyAhPT0gdW5kZWZpbmVkICYmIHRoaXMub2JzZXJ2ZXJzW2ldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBmbih0aGlzLm9ic2VydmVyc1tpXSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAvLyBJZ25vcmUgZXhjZXB0aW9ucyByYWlzZWQgaW4gT2JzZXJ2ZXJzIG9yIG1pc3NpbmcgbWV0aG9kcyBvZiBhblxuICAgICAgICAgIC8vIE9ic2VydmVyLlxuICAgICAgICAgIC8vIExvZyBlcnJvciB0byBjb25zb2xlLiBiLzMxNDA0ODA2XG4gICAgICAgICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBjb25zb2xlLmVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBjbG9zZShlcnI/OiBFcnJvcik6IHZvaWQge1xuICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLmZpbmFsaXplZCA9IHRydWU7XG4gICAgaWYgKGVyciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmZpbmFsRXJyb3IgPSBlcnI7XG4gICAgfVxuICAgIC8vIFByb3h5IGlzIG5vIGxvbmdlciBuZWVkZWQgLSBnYXJiYWdlIGNvbGxlY3QgcmVmZXJlbmNlc1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICB0aGlzLnRhc2sudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLm9ic2VydmVycyA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMub25Ob09ic2VydmVycyA9IHVuZGVmaW5lZDtcbiAgICB9KTtcbiAgfVxufVxuXG4vKiogVHVybiBzeW5jaHJvbm91cyBmdW5jdGlvbiBpbnRvIG9uZSBjYWxsZWQgYXN5bmNocm9ub3VzbHkuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xuZXhwb3J0IGZ1bmN0aW9uIGFzeW5jKGZuOiBGdW5jdGlvbiwgb25FcnJvcj86IEVycm9yRm4pOiBGdW5jdGlvbiB7XG4gIHJldHVybiAoLi4uYXJnczogdW5rbm93bltdKSA9PiB7XG4gICAgUHJvbWlzZS5yZXNvbHZlKHRydWUpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGZuKC4uLmFyZ3MpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3I6IEVycm9yKSA9PiB7XG4gICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9O1xufVxuXG4vKipcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBvYmplY3QgcGFzc2VkIGluIGltcGxlbWVudHMgYW55IG9mIHRoZSBuYW1lZCBtZXRob2RzLlxuICovXG5mdW5jdGlvbiBpbXBsZW1lbnRzQW55TWV0aG9kcyhcbiAgb2JqOiB7IFtrZXk6IHN0cmluZ106IHVua25vd24gfSxcbiAgbWV0aG9kczogc3RyaW5nW11cbik6IGJvb2xlYW4ge1xuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcgfHwgb2JqID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZm9yIChjb25zdCBtZXRob2Qgb2YgbWV0aG9kcykge1xuICAgIGlmIChtZXRob2QgaW4gb2JqICYmIHR5cGVvZiBvYmpbbWV0aG9kXSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBub29wKCk6IHZvaWQge1xuICAvLyBkbyBub3RoaW5nXG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBDaGVjayB0byBtYWtlIHN1cmUgdGhlIGFwcHJvcHJpYXRlIG51bWJlciBvZiBhcmd1bWVudHMgYXJlIHByb3ZpZGVkIGZvciBhIHB1YmxpYyBmdW5jdGlvbi5cbiAqIFRocm93cyBhbiBlcnJvciBpZiBpdCBmYWlscy5cbiAqXG4gKiBAcGFyYW0gZm5OYW1lIFRoZSBmdW5jdGlvbiBuYW1lXG4gKiBAcGFyYW0gbWluQ291bnQgVGhlIG1pbmltdW0gbnVtYmVyIG9mIGFyZ3VtZW50cyB0byBhbGxvdyBmb3IgdGhlIGZ1bmN0aW9uIGNhbGxcbiAqIEBwYXJhbSBtYXhDb3VudCBUaGUgbWF4aW11bSBudW1iZXIgb2YgYXJndW1lbnQgdG8gYWxsb3cgZm9yIHRoZSBmdW5jdGlvbiBjYWxsXG4gKiBAcGFyYW0gYXJnQ291bnQgVGhlIGFjdHVhbCBudW1iZXIgb2YgYXJndW1lbnRzIHByb3ZpZGVkLlxuICovXG5leHBvcnQgY29uc3QgdmFsaWRhdGVBcmdDb3VudCA9IGZ1bmN0aW9uIChcbiAgZm5OYW1lOiBzdHJpbmcsXG4gIG1pbkNvdW50OiBudW1iZXIsXG4gIG1heENvdW50OiBudW1iZXIsXG4gIGFyZ0NvdW50OiBudW1iZXJcbik6IHZvaWQge1xuICBsZXQgYXJnRXJyb3I7XG4gIGlmIChhcmdDb3VudCA8IG1pbkNvdW50KSB7XG4gICAgYXJnRXJyb3IgPSAnYXQgbGVhc3QgJyArIG1pbkNvdW50O1xuICB9IGVsc2UgaWYgKGFyZ0NvdW50ID4gbWF4Q291bnQpIHtcbiAgICBhcmdFcnJvciA9IG1heENvdW50ID09PSAwID8gJ25vbmUnIDogJ25vIG1vcmUgdGhhbiAnICsgbWF4Q291bnQ7XG4gIH1cbiAgaWYgKGFyZ0Vycm9yKSB7XG4gICAgY29uc3QgZXJyb3IgPVxuICAgICAgZm5OYW1lICtcbiAgICAgICcgZmFpbGVkOiBXYXMgY2FsbGVkIHdpdGggJyArXG4gICAgICBhcmdDb3VudCArXG4gICAgICAoYXJnQ291bnQgPT09IDEgPyAnIGFyZ3VtZW50LicgOiAnIGFyZ3VtZW50cy4nKSArXG4gICAgICAnIEV4cGVjdHMgJyArXG4gICAgICBhcmdFcnJvciArXG4gICAgICAnLic7XG4gICAgdGhyb3cgbmV3IEVycm9yKGVycm9yKTtcbiAgfVxufTtcblxuLyoqXG4gKiBHZW5lcmF0ZXMgYSBzdHJpbmcgdG8gcHJlZml4IGFuIGVycm9yIG1lc3NhZ2UgYWJvdXQgZmFpbGVkIGFyZ3VtZW50IHZhbGlkYXRpb25cbiAqXG4gKiBAcGFyYW0gZm5OYW1lIFRoZSBmdW5jdGlvbiBuYW1lXG4gKiBAcGFyYW0gYXJnTmFtZSBUaGUgbmFtZSBvZiB0aGUgYXJndW1lbnRcbiAqIEByZXR1cm4gVGhlIHByZWZpeCB0byBhZGQgdG8gdGhlIGVycm9yIHRocm93biBmb3IgdmFsaWRhdGlvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVycm9yUHJlZml4KGZuTmFtZTogc3RyaW5nLCBhcmdOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gYCR7Zm5OYW1lfSBmYWlsZWQ6ICR7YXJnTmFtZX0gYXJndW1lbnQgYDtcbn1cblxuLyoqXG4gKiBAcGFyYW0gZm5OYW1lXG4gKiBAcGFyYW0gYXJndW1lbnROdW1iZXJcbiAqIEBwYXJhbSBuYW1lc3BhY2VcbiAqIEBwYXJhbSBvcHRpb25hbFxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVOYW1lc3BhY2UoXG4gIGZuTmFtZTogc3RyaW5nLFxuICBuYW1lc3BhY2U6IHN0cmluZyxcbiAgb3B0aW9uYWw6IGJvb2xlYW5cbik6IHZvaWQge1xuICBpZiAob3B0aW9uYWwgJiYgIW5hbWVzcGFjZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAodHlwZW9mIG5hbWVzcGFjZSAhPT0gJ3N0cmluZycpIHtcbiAgICAvL1RPRE86IEkgc2hvdWxkIGRvIG1vcmUgdmFsaWRhdGlvbiBoZXJlLiBXZSBvbmx5IGFsbG93IGNlcnRhaW4gY2hhcnMgaW4gbmFtZXNwYWNlcy5cbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBlcnJvclByZWZpeChmbk5hbWUsICduYW1lc3BhY2UnKSArICdtdXN0IGJlIGEgdmFsaWQgZmlyZWJhc2UgbmFtZXNwYWNlLidcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUNhbGxiYWNrKFxuICBmbk5hbWU6IHN0cmluZyxcbiAgYXJndW1lbnROYW1lOiBzdHJpbmcsXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXG4gIGNhbGxiYWNrOiBGdW5jdGlvbixcbiAgb3B0aW9uYWw6IGJvb2xlYW5cbik6IHZvaWQge1xuICBpZiAob3B0aW9uYWwgJiYgIWNhbGxiYWNrKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBlcnJvclByZWZpeChmbk5hbWUsIGFyZ3VtZW50TmFtZSkgKyAnbXVzdCBiZSBhIHZhbGlkIGZ1bmN0aW9uLidcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUNvbnRleHRPYmplY3QoXG4gIGZuTmFtZTogc3RyaW5nLFxuICBhcmd1bWVudE5hbWU6IHN0cmluZyxcbiAgY29udGV4dDogdW5rbm93bixcbiAgb3B0aW9uYWw6IGJvb2xlYW5cbik6IHZvaWQge1xuICBpZiAob3B0aW9uYWwgJiYgIWNvbnRleHQpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHR5cGVvZiBjb250ZXh0ICE9PSAnb2JqZWN0JyB8fCBjb250ZXh0ID09PSBudWxsKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBjb250ZXh0IG9iamVjdC4nXG4gICAgKTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGFzc2VydCB9IGZyb20gJy4vYXNzZXJ0JztcblxuLy8gQ29kZSBvcmlnaW5hbGx5IGNhbWUgZnJvbSBnb29nLmNyeXB0LnN0cmluZ1RvVXRmOEJ5dGVBcnJheSwgYnV0IGZvciBzb21lIHJlYXNvbiB0aGV5XG4vLyBhdXRvbWF0aWNhbGx5IHJlcGxhY2VkICdcXHJcXG4nIHdpdGggJ1xcbicsIGFuZCB0aGV5IGRpZG4ndCBoYW5kbGUgc3Vycm9nYXRlIHBhaXJzLFxuLy8gc28gaXQncyBiZWVuIG1vZGlmaWVkLlxuXG4vLyBOb3RlIHRoYXQgbm90IGFsbCBVbmljb2RlIGNoYXJhY3RlcnMgYXBwZWFyIGFzIHNpbmdsZSBjaGFyYWN0ZXJzIGluIEphdmFTY3JpcHQgc3RyaW5ncy5cbi8vIGZyb21DaGFyQ29kZSByZXR1cm5zIHRoZSBVVEYtMTYgZW5jb2Rpbmcgb2YgYSBjaGFyYWN0ZXIgLSBzbyBzb21lIFVuaWNvZGUgY2hhcmFjdGVyc1xuLy8gdXNlIDIgY2hhcmFjdGVycyBpbiBKYXZhc2NyaXB0LiAgQWxsIDQtYnl0ZSBVVEYtOCBjaGFyYWN0ZXJzIGJlZ2luIHdpdGggYSBmaXJzdFxuLy8gY2hhcmFjdGVyIGluIHRoZSByYW5nZSAweEQ4MDAgLSAweERCRkYgKHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYSBzby1jYWxsZWQgc3Vycm9nYXRlXG4vLyBwYWlyKS5cbi8vIFNlZSBodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNS4xLyNzZWMtMTUuMS4zXG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7QXJyYXl9XG4gKi9cbmV4cG9ydCBjb25zdCBzdHJpbmdUb0J5dGVBcnJheSA9IGZ1bmN0aW9uIChzdHI6IHN0cmluZyk6IG51bWJlcltdIHtcbiAgY29uc3Qgb3V0OiBudW1iZXJbXSA9IFtdO1xuICBsZXQgcCA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IGMgPSBzdHIuY2hhckNvZGVBdChpKTtcblxuICAgIC8vIElzIHRoaXMgdGhlIGxlYWQgc3Vycm9nYXRlIGluIGEgc3Vycm9nYXRlIHBhaXI/XG4gICAgaWYgKGMgPj0gMHhkODAwICYmIGMgPD0gMHhkYmZmKSB7XG4gICAgICBjb25zdCBoaWdoID0gYyAtIDB4ZDgwMDsgLy8gdGhlIGhpZ2ggMTAgYml0cy5cbiAgICAgIGkrKztcbiAgICAgIGFzc2VydChpIDwgc3RyLmxlbmd0aCwgJ1N1cnJvZ2F0ZSBwYWlyIG1pc3NpbmcgdHJhaWwgc3Vycm9nYXRlLicpO1xuICAgICAgY29uc3QgbG93ID0gc3RyLmNoYXJDb2RlQXQoaSkgLSAweGRjMDA7IC8vIHRoZSBsb3cgMTAgYml0cy5cbiAgICAgIGMgPSAweDEwMDAwICsgKGhpZ2ggPDwgMTApICsgbG93O1xuICAgIH1cblxuICAgIGlmIChjIDwgMTI4KSB7XG4gICAgICBvdXRbcCsrXSA9IGM7XG4gICAgfSBlbHNlIGlmIChjIDwgMjA0OCkge1xuICAgICAgb3V0W3ArK10gPSAoYyA+PiA2KSB8IDE5MjtcbiAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XG4gICAgfSBlbHNlIGlmIChjIDwgNjU1MzYpIHtcbiAgICAgIG91dFtwKytdID0gKGMgPj4gMTIpIHwgMjI0O1xuICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XG4gICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xuICAgIH0gZWxzZSB7XG4gICAgICBvdXRbcCsrXSA9IChjID4+IDE4KSB8IDI0MDtcbiAgICAgIG91dFtwKytdID0gKChjID4+IDEyKSAmIDYzKSB8IDEyODtcbiAgICAgIG91dFtwKytdID0gKChjID4+IDYpICYgNjMpIHwgMTI4O1xuICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dDtcbn07XG5cbi8qKlxuICogQ2FsY3VsYXRlIGxlbmd0aCB3aXRob3V0IGFjdHVhbGx5IGNvbnZlcnRpbmc7IHVzZWZ1bCBmb3IgZG9pbmcgY2hlYXBlciB2YWxpZGF0aW9uLlxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxuICogQHJldHVybiB7bnVtYmVyfVxuICovXG5leHBvcnQgY29uc3Qgc3RyaW5nTGVuZ3RoID0gZnVuY3Rpb24gKHN0cjogc3RyaW5nKTogbnVtYmVyIHtcbiAgbGV0IHAgPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGMgPSBzdHIuY2hhckNvZGVBdChpKTtcbiAgICBpZiAoYyA8IDEyOCkge1xuICAgICAgcCsrO1xuICAgIH0gZWxzZSBpZiAoYyA8IDIwNDgpIHtcbiAgICAgIHAgKz0gMjtcbiAgICB9IGVsc2UgaWYgKGMgPj0gMHhkODAwICYmIGMgPD0gMHhkYmZmKSB7XG4gICAgICAvLyBMZWFkIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyLiAgVGhlIHBhaXIgdG9nZXRoZXIgd2lsbCB0YWtlIDQgYnl0ZXMgdG8gcmVwcmVzZW50LlxuICAgICAgcCArPSA0O1xuICAgICAgaSsrOyAvLyBza2lwIHRyYWlsIHN1cnJvZ2F0ZS5cbiAgICB9IGVsc2Uge1xuICAgICAgcCArPSAzO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcDtcbn07XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBDb3BpZWQgZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjExNzUyM1xuICogR2VuZXJhdGVzIGEgbmV3IHV1aWQuXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjb25zdCB1dWlkdjQgPSBmdW5jdGlvbiAoKTogc3RyaW5nIHtcbiAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgYyA9PiB7XG4gICAgY29uc3QgciA9IChNYXRoLnJhbmRvbSgpICogMTYpIHwgMCxcbiAgICAgIHYgPSBjID09PSAneCcgPyByIDogKHIgJiAweDMpIHwgMHg4O1xuICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcbiAgfSk7XG59O1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogVGhlIGFtb3VudCBvZiBtaWxsaXNlY29uZHMgdG8gZXhwb25lbnRpYWxseSBpbmNyZWFzZS5cbiAqL1xuY29uc3QgREVGQVVMVF9JTlRFUlZBTF9NSUxMSVMgPSAxMDAwO1xuXG4vKipcbiAqIFRoZSBmYWN0b3IgdG8gYmFja29mZiBieS5cbiAqIFNob3VsZCBiZSBhIG51bWJlciBncmVhdGVyIHRoYW4gMS5cbiAqL1xuY29uc3QgREVGQVVMVF9CQUNLT0ZGX0ZBQ1RPUiA9IDI7XG5cbi8qKlxuICogVGhlIG1heGltdW0gbWlsbGlzZWNvbmRzIHRvIGluY3JlYXNlIHRvLlxuICpcbiAqIDxwPlZpc2libGUgZm9yIHRlc3RpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IE1BWF9WQUxVRV9NSUxMSVMgPSA0ICogNjAgKiA2MCAqIDEwMDA7IC8vIEZvdXIgaG91cnMsIGxpa2UgaU9TIGFuZCBBbmRyb2lkLlxuXG4vKipcbiAqIFRoZSBwZXJjZW50YWdlIG9mIGJhY2tvZmYgdGltZSB0byByYW5kb21pemUgYnkuXG4gKiBTZWVcbiAqIGh0dHA6Ly9nby9zYWZlLWNsaWVudC1iZWhhdmlvciNzdGVwLTEtZGV0ZXJtaW5lLXRoZS1hcHByb3ByaWF0ZS1yZXRyeS1pbnRlcnZhbC10by1oYW5kbGUtc3Bpa2UtdHJhZmZpY1xuICogZm9yIGNvbnRleHQuXG4gKlxuICogPHA+VmlzaWJsZSBmb3IgdGVzdGluZ1xuICovXG5leHBvcnQgY29uc3QgUkFORE9NX0ZBQ1RPUiA9IDAuNTtcblxuLyoqXG4gKiBCYXNlZCBvbiB0aGUgYmFja29mZiBtZXRob2QgZnJvbVxuICogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWxpYnJhcnkvYmxvYi9tYXN0ZXIvY2xvc3VyZS9nb29nL21hdGgvZXhwb25lbnRpYWxiYWNrb2ZmLmpzLlxuICogRXh0cmFjdGVkIGhlcmUgc28gd2UgZG9uJ3QgbmVlZCB0byBwYXNzIG1ldGFkYXRhIGFuZCBhIHN0YXRlZnVsIEV4cG9uZW50aWFsQmFja29mZiBvYmplY3QgYXJvdW5kLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY2FsY3VsYXRlQmFja29mZk1pbGxpcyhcbiAgYmFja29mZkNvdW50OiBudW1iZXIsXG4gIGludGVydmFsTWlsbGlzOiBudW1iZXIgPSBERUZBVUxUX0lOVEVSVkFMX01JTExJUyxcbiAgYmFja29mZkZhY3RvcjogbnVtYmVyID0gREVGQVVMVF9CQUNLT0ZGX0ZBQ1RPUlxuKTogbnVtYmVyIHtcbiAgLy8gQ2FsY3VsYXRlcyBhbiBleHBvbmVudGlhbGx5IGluY3JlYXNpbmcgdmFsdWUuXG4gIC8vIERldmlhdGlvbjogY2FsY3VsYXRlcyB2YWx1ZSBmcm9tIGNvdW50IGFuZCBhIGNvbnN0YW50IGludGVydmFsLCBzbyB3ZSBvbmx5IG5lZWQgdG8gc2F2ZSB2YWx1ZVxuICAvLyBhbmQgY291bnQgdG8gcmVzdG9yZSBzdGF0ZS5cbiAgY29uc3QgY3VyckJhc2VWYWx1ZSA9IGludGVydmFsTWlsbGlzICogTWF0aC5wb3coYmFja29mZkZhY3RvciwgYmFja29mZkNvdW50KTtcblxuICAvLyBBIHJhbmRvbSBcImZ1enpcIiB0byBhdm9pZCB3YXZlcyBvZiByZXRyaWVzLlxuICAvLyBEZXZpYXRpb246IHJhbmRvbUZhY3RvciBpcyByZXF1aXJlZC5cbiAgY29uc3QgcmFuZG9tV2FpdCA9IE1hdGgucm91bmQoXG4gICAgLy8gQSBmcmFjdGlvbiBvZiB0aGUgYmFja29mZiB2YWx1ZSB0byBhZGQvc3VidHJhY3QuXG4gICAgLy8gRGV2aWF0aW9uOiBjaGFuZ2VzIG11bHRpcGxpY2F0aW9uIG9yZGVyIHRvIGltcHJvdmUgcmVhZGFiaWxpdHkuXG4gICAgUkFORE9NX0ZBQ1RPUiAqXG4gICAgICBjdXJyQmFzZVZhbHVlICpcbiAgICAgIC8vIEEgcmFuZG9tIGZsb2F0IChyb3VuZGVkIHRvIGludCBieSBNYXRoLnJvdW5kIGFib3ZlKSBpbiB0aGUgcmFuZ2UgWy0xLCAxXS4gRGV0ZXJtaW5lc1xuICAgICAgLy8gaWYgd2UgYWRkIG9yIHN1YnRyYWN0LlxuICAgICAgKE1hdGgucmFuZG9tKCkgLSAwLjUpICpcbiAgICAgIDJcbiAgKTtcblxuICAvLyBMaW1pdHMgYmFja29mZiB0byBtYXggdG8gYXZvaWQgZWZmZWN0aXZlbHkgcGVybWFuZW50IGJhY2tvZmYuXG4gIHJldHVybiBNYXRoLm1pbihNQVhfVkFMVUVfTUlMTElTLCBjdXJyQmFzZVZhbHVlICsgcmFuZG9tV2FpdCk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBQcm92aWRlIEVuZ2xpc2ggb3JkaW5hbCBsZXR0ZXJzIGFmdGVyIGEgbnVtYmVyXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvcmRpbmFsKGk6IG51bWJlcik6IHN0cmluZyB7XG4gIGlmICghTnVtYmVyLmlzRmluaXRlKGkpKSB7XG4gICAgcmV0dXJuIGAke2l9YDtcbiAgfVxuICByZXR1cm4gaSArIGluZGljYXRvcihpKTtcbn1cblxuZnVuY3Rpb24gaW5kaWNhdG9yKGk6IG51bWJlcik6IHN0cmluZyB7XG4gIGkgPSBNYXRoLmFicyhpKTtcbiAgY29uc3QgY2VudCA9IGkgJSAxMDA7XG4gIGlmIChjZW50ID49IDEwICYmIGNlbnQgPD0gMjApIHtcbiAgICByZXR1cm4gJ3RoJztcbiAgfVxuICBjb25zdCBkZWMgPSBpICUgMTA7XG4gIGlmIChkZWMgPT09IDEpIHtcbiAgICByZXR1cm4gJ3N0JztcbiAgfVxuICBpZiAoZGVjID09PSAyKSB7XG4gICAgcmV0dXJuICduZCc7XG4gIH1cbiAgaWYgKGRlYyA9PT0gMykge1xuICAgIHJldHVybiAncmQnO1xuICB9XG4gIHJldHVybiAndGgnO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGF0PFQ+IHtcbiAgX2RlbGVnYXRlOiBUO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9kdWxhckluc3RhbmNlPEV4cFNlcnZpY2U+KFxuICBzZXJ2aWNlOiBDb21wYXQ8RXhwU2VydmljZT4gfCBFeHBTZXJ2aWNlXG4pOiBFeHBTZXJ2aWNlIHtcbiAgaWYgKHNlcnZpY2UgJiYgKHNlcnZpY2UgYXMgQ29tcGF0PEV4cFNlcnZpY2U+KS5fZGVsZWdhdGUpIHtcbiAgICByZXR1cm4gKHNlcnZpY2UgYXMgQ29tcGF0PEV4cFNlcnZpY2U+KS5fZGVsZWdhdGU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHNlcnZpY2UgYXMgRXhwU2VydmljZTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge1xuICBJbnN0YW50aWF0aW9uTW9kZSxcbiAgSW5zdGFuY2VGYWN0b3J5LFxuICBDb21wb25lbnRUeXBlLFxuICBEaWN0aW9uYXJ5LFxuICBOYW1lLFxuICBvbkluc3RhbmNlQ3JlYXRlZENhbGxiYWNrXG59IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIENvbXBvbmVudCBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gYGF1dGhgLCBgYXV0aC1pbnRlcm5hbGBcbiAqL1xuZXhwb3J0IGNsYXNzIENvbXBvbmVudDxUIGV4dGVuZHMgTmFtZSA9IE5hbWU+IHtcbiAgbXVsdGlwbGVJbnN0YW5jZXMgPSBmYWxzZTtcbiAgLyoqXG4gICAqIFByb3BlcnRpZXMgdG8gYmUgYWRkZWQgdG8gdGhlIHNlcnZpY2UgbmFtZXNwYWNlXG4gICAqL1xuICBzZXJ2aWNlUHJvcHM6IERpY3Rpb25hcnkgPSB7fTtcblxuICBpbnN0YW50aWF0aW9uTW9kZSA9IEluc3RhbnRpYXRpb25Nb2RlLkxBWlk7XG5cbiAgb25JbnN0YW5jZUNyZWF0ZWQ6IG9uSW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2s8VD4gfCBudWxsID0gbnVsbDtcblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIG5hbWUgVGhlIHB1YmxpYyBzZXJ2aWNlIG5hbWUsIGUuZy4gYXBwLCBhdXRoLCBmaXJlc3RvcmUsIGRhdGFiYXNlXG4gICAqIEBwYXJhbSBpbnN0YW5jZUZhY3RvcnkgU2VydmljZSBmYWN0b3J5IHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyB0aGUgcHVibGljIGludGVyZmFjZVxuICAgKiBAcGFyYW0gdHlwZSB3aGV0aGVyIHRoZSBzZXJ2aWNlIHByb3ZpZGVkIGJ5IHRoZSBjb21wb25lbnQgaXMgcHVibGljIG9yIHByaXZhdGVcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHJlYWRvbmx5IG5hbWU6IFQsXG4gICAgcmVhZG9ubHkgaW5zdGFuY2VGYWN0b3J5OiBJbnN0YW5jZUZhY3Rvcnk8VD4sXG4gICAgcmVhZG9ubHkgdHlwZTogQ29tcG9uZW50VHlwZVxuICApIHt9XG5cbiAgc2V0SW5zdGFudGlhdGlvbk1vZGUobW9kZTogSW5zdGFudGlhdGlvbk1vZGUpOiB0aGlzIHtcbiAgICB0aGlzLmluc3RhbnRpYXRpb25Nb2RlID0gbW9kZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHNldE11bHRpcGxlSW5zdGFuY2VzKG11bHRpcGxlSW5zdGFuY2VzOiBib29sZWFuKTogdGhpcyB7XG4gICAgdGhpcy5tdWx0aXBsZUluc3RhbmNlcyA9IG11bHRpcGxlSW5zdGFuY2VzO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgc2V0U2VydmljZVByb3BzKHByb3BzOiBEaWN0aW9uYXJ5KTogdGhpcyB7XG4gICAgdGhpcy5zZXJ2aWNlUHJvcHMgPSBwcm9wcztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHNldEluc3RhbmNlQ3JlYXRlZENhbGxiYWNrKGNhbGxiYWNrOiBvbkluc3RhbmNlQ3JlYXRlZENhbGxiYWNrPFQ+KTogdGhpcyB7XG4gICAgdGhpcy5vbkluc3RhbmNlQ3JlYXRlZCA9IGNhbGxiYWNrO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfRU5UUllfTkFNRSA9ICdbREVGQVVMVF0nO1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IERlZmVycmVkIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgQ29tcG9uZW50Q29udGFpbmVyIH0gZnJvbSAnLi9jb21wb25lbnRfY29udGFpbmVyJztcbmltcG9ydCB7IERFRkFVTFRfRU5UUllfTkFNRSB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7XG4gIEluaXRpYWxpemVPcHRpb25zLFxuICBJbnN0YW50aWF0aW9uTW9kZSxcbiAgTmFtZSxcbiAgTmFtZVNlcnZpY2VNYXBwaW5nLFxuICBPbkluaXRDYWxsQmFja1xufSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50JztcblxuLyoqXG4gKiBQcm92aWRlciBmb3IgaW5zdGFuY2UgZm9yIHNlcnZpY2UgbmFtZSBULCBlLmcuICdhdXRoJywgJ2F1dGgtaW50ZXJuYWwnXG4gKiBOYW1lU2VydmljZU1hcHBpbmdbVF0gaXMgYW4gYWxpYXMgZm9yIHRoZSB0eXBlIG9mIHRoZSBpbnN0YW5jZVxuICovXG5leHBvcnQgY2xhc3MgUHJvdmlkZXI8VCBleHRlbmRzIE5hbWU+IHtcbiAgcHJpdmF0ZSBjb21wb25lbnQ6IENvbXBvbmVudDxUPiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHJlYWRvbmx5IGluc3RhbmNlczogTWFwPHN0cmluZywgTmFtZVNlcnZpY2VNYXBwaW5nW1RdPiA9IG5ldyBNYXAoKTtcbiAgcHJpdmF0ZSByZWFkb25seSBpbnN0YW5jZXNEZWZlcnJlZDogTWFwPFxuICAgIHN0cmluZyxcbiAgICBEZWZlcnJlZDxOYW1lU2VydmljZU1hcHBpbmdbVF0+XG4gID4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgaW5zdGFuY2VzT3B0aW9uczogTWFwPHN0cmluZywgUmVjb3JkPHN0cmluZywgdW5rbm93bj4+ID1cbiAgICBuZXcgTWFwKCk7XG4gIHByaXZhdGUgb25Jbml0Q2FsbGJhY2tzOiBNYXA8c3RyaW5nLCBTZXQ8T25Jbml0Q2FsbEJhY2s8VD4+PiA9IG5ldyBNYXAoKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlYWRvbmx5IG5hbWU6IFQsXG4gICAgcHJpdmF0ZSByZWFkb25seSBjb250YWluZXI6IENvbXBvbmVudENvbnRhaW5lclxuICApIHt9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBpZGVudGlmaWVyIEEgcHJvdmlkZXIgY2FuIHByb3ZpZGUgbXVsaXRwbGUgaW5zdGFuY2VzIG9mIGEgc2VydmljZVxuICAgKiBpZiB0aGlzLmNvbXBvbmVudC5tdWx0aXBsZUluc3RhbmNlcyBpcyB0cnVlLlxuICAgKi9cbiAgZ2V0KGlkZW50aWZpZXI/OiBzdHJpbmcpOiBQcm9taXNlPE5hbWVTZXJ2aWNlTWFwcGluZ1tUXT4ge1xuICAgIC8vIGlmIG11bHRpcGxlSW5zdGFuY2VzIGlzIG5vdCBzdXBwb3J0ZWQsIHVzZSB0aGUgZGVmYXVsdCBuYW1lXG4gICAgY29uc3Qgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihpZGVudGlmaWVyKTtcblxuICAgIGlmICghdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5oYXMobm9ybWFsaXplZElkZW50aWZpZXIpKSB7XG4gICAgICBjb25zdCBkZWZlcnJlZCA9IG5ldyBEZWZlcnJlZDxOYW1lU2VydmljZU1hcHBpbmdbVF0+KCk7XG4gICAgICB0aGlzLmluc3RhbmNlc0RlZmVycmVkLnNldChub3JtYWxpemVkSWRlbnRpZmllciwgZGVmZXJyZWQpO1xuXG4gICAgICBpZiAoXG4gICAgICAgIHRoaXMuaXNJbml0aWFsaXplZChub3JtYWxpemVkSWRlbnRpZmllcikgfHxcbiAgICAgICAgdGhpcy5zaG91bGRBdXRvSW5pdGlhbGl6ZSgpXG4gICAgICApIHtcbiAgICAgICAgLy8gaW5pdGlhbGl6ZSB0aGUgc2VydmljZSBpZiBpdCBjYW4gYmUgYXV0by1pbml0aWFsaXplZFxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGluc3RhbmNlID0gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcbiAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXJcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBpZiAoaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgdGhyb3dzIGFuIGV4Y2VwdGlvbiBkdXJpbmcgZ2V0KCksIGl0IHNob3VsZCBub3QgY2F1c2VcbiAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yLiBXZSBqdXN0IHJldHVybiB0aGUgdW5yZXNvbHZlZCBwcm9taXNlIGluIHRoaXMgY2FzZS5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmdldChub3JtYWxpemVkSWRlbnRpZmllcikhLnByb21pc2U7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIG9wdGlvbnMuaWRlbnRpZmllciBBIHByb3ZpZGVyIGNhbiBwcm92aWRlIG11bGl0cGxlIGluc3RhbmNlcyBvZiBhIHNlcnZpY2VcbiAgICogaWYgdGhpcy5jb21wb25lbnQubXVsdGlwbGVJbnN0YW5jZXMgaXMgdHJ1ZS5cbiAgICogQHBhcmFtIG9wdGlvbnMub3B0aW9uYWwgSWYgb3B0aW9uYWwgaXMgZmFsc2Ugb3Igbm90IHByb3ZpZGVkLCB0aGUgbWV0aG9kIHRocm93cyBhbiBlcnJvciB3aGVuXG4gICAqIHRoZSBzZXJ2aWNlIGlzIG5vdCBpbW1lZGlhdGVseSBhdmFpbGFibGUuXG4gICAqIElmIG9wdGlvbmFsIGlzIHRydWUsIHRoZSBtZXRob2QgcmV0dXJucyBudWxsIGlmIHRoZSBzZXJ2aWNlIGlzIG5vdCBpbW1lZGlhdGVseSBhdmFpbGFibGUuXG4gICAqL1xuICBnZXRJbW1lZGlhdGUob3B0aW9uczoge1xuICAgIGlkZW50aWZpZXI/OiBzdHJpbmc7XG4gICAgb3B0aW9uYWw6IHRydWU7XG4gIH0pOiBOYW1lU2VydmljZU1hcHBpbmdbVF0gfCBudWxsO1xuICBnZXRJbW1lZGlhdGUob3B0aW9ucz86IHtcbiAgICBpZGVudGlmaWVyPzogc3RyaW5nO1xuICAgIG9wdGlvbmFsPzogZmFsc2U7XG4gIH0pOiBOYW1lU2VydmljZU1hcHBpbmdbVF07XG4gIGdldEltbWVkaWF0ZShvcHRpb25zPzoge1xuICAgIGlkZW50aWZpZXI/OiBzdHJpbmc7XG4gICAgb3B0aW9uYWw/OiBib29sZWFuO1xuICB9KTogTmFtZVNlcnZpY2VNYXBwaW5nW1RdIHwgbnVsbCB7XG4gICAgLy8gaWYgbXVsdGlwbGVJbnN0YW5jZXMgaXMgbm90IHN1cHBvcnRlZCwgdXNlIHRoZSBkZWZhdWx0IG5hbWVcbiAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKFxuICAgICAgb3B0aW9ucz8uaWRlbnRpZmllclxuICAgICk7XG4gICAgY29uc3Qgb3B0aW9uYWwgPSBvcHRpb25zPy5vcHRpb25hbCA/PyBmYWxzZTtcblxuICAgIGlmIChcbiAgICAgIHRoaXMuaXNJbml0aWFsaXplZChub3JtYWxpemVkSWRlbnRpZmllcikgfHxcbiAgICAgIHRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKVxuICAgICkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XG4gICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllclxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKG9wdGlvbmFsKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbiBjYXNlIGEgY29tcG9uZW50IGlzIG5vdCBpbml0aWFsaXplZCBhbmQgc2hvdWxkL2NhbiBub3QgYmUgYXV0by1pbml0aWFsaXplZCBhdCB0aGUgbW9tZW50LCByZXR1cm4gbnVsbCBpZiB0aGUgb3B0aW9uYWwgZmxhZyBpcyBzZXQsIG9yIHRocm93XG4gICAgICBpZiAob3B0aW9uYWwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBFcnJvcihgU2VydmljZSAke3RoaXMubmFtZX0gaXMgbm90IGF2YWlsYWJsZWApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldENvbXBvbmVudCgpOiBDb21wb25lbnQ8VD4gfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5jb21wb25lbnQ7XG4gIH1cblxuICBzZXRDb21wb25lbnQoY29tcG9uZW50OiBDb21wb25lbnQ8VD4pOiB2b2lkIHtcbiAgICBpZiAoY29tcG9uZW50Lm5hbWUgIT09IHRoaXMubmFtZSkge1xuICAgICAgdGhyb3cgRXJyb3IoXG4gICAgICAgIGBNaXNtYXRjaGluZyBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gZm9yIFByb3ZpZGVyICR7dGhpcy5uYW1lfS5gXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmNvbXBvbmVudCkge1xuICAgICAgdGhyb3cgRXJyb3IoYENvbXBvbmVudCBmb3IgJHt0aGlzLm5hbWV9IGhhcyBhbHJlYWR5IGJlZW4gcHJvdmlkZWRgKTtcbiAgICB9XG5cbiAgICB0aGlzLmNvbXBvbmVudCA9IGNvbXBvbmVudDtcblxuICAgIC8vIHJldHVybiBlYXJseSB3aXRob3V0IGF0dGVtcHRpbmcgdG8gaW5pdGlhbGl6ZSB0aGUgY29tcG9uZW50IGlmIHRoZSBjb21wb25lbnQgcmVxdWlyZXMgZXhwbGljaXQgaW5pdGlhbGl6YXRpb24gKGNhbGxpbmcgYFByb3ZpZGVyLmluaXRpYWxpemUoKWApXG4gICAgaWYgKCF0aGlzLnNob3VsZEF1dG9Jbml0aWFsaXplKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBpZiB0aGUgc2VydmljZSBpcyBlYWdlciwgaW5pdGlhbGl6ZSB0aGUgZGVmYXVsdCBpbnN0YW5jZVxuICAgIGlmIChpc0NvbXBvbmVudEVhZ2VyKGNvbXBvbmVudCkpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7IGluc3RhbmNlSWRlbnRpZmllcjogREVGQVVMVF9FTlRSWV9OQU1FIH0pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyB3aGVuIHRoZSBpbnN0YW5jZSBmYWN0b3J5IGZvciBhbiBlYWdlciBDb21wb25lbnQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBkdXJpbmcgdGhlIGVhZ2VyXG4gICAgICAgIC8vIGluaXRpYWxpemF0aW9uLCBpdCBzaG91bGQgbm90IGNhdXNlIGEgZmF0YWwgZXJyb3IuXG4gICAgICAgIC8vIFRPRE86IEludmVzdGlnYXRlIGlmIHdlIG5lZWQgdG8gbWFrZSBpdCBjb25maWd1cmFibGUsIGJlY2F1c2Ugc29tZSBjb21wb25lbnQgbWF5IHdhbnQgdG8gY2F1c2VcbiAgICAgICAgLy8gYSBmYXRhbCBlcnJvciBpbiB0aGlzIGNhc2U/XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHNlcnZpY2UgaW5zdGFuY2VzIGZvciB0aGUgcGVuZGluZyBwcm9taXNlcyBhbmQgcmVzb2x2ZSB0aGVtXG4gICAgLy8gTk9URTogaWYgdGhpcy5tdWx0aXBsZUluc3RhbmNlcyBpcyBmYWxzZSwgb25seSB0aGUgZGVmYXVsdCBpbnN0YW5jZSB3aWxsIGJlIGNyZWF0ZWRcbiAgICAvLyBhbmQgYWxsIHByb21pc2VzIHdpdGggcmVzb2x2ZSB3aXRoIGl0IHJlZ2FyZGxlc3Mgb2YgdGhlIGlkZW50aWZpZXIuXG4gICAgZm9yIChjb25zdCBbXG4gICAgICBpbnN0YW5jZUlkZW50aWZpZXIsXG4gICAgICBpbnN0YW5jZURlZmVycmVkXG4gICAgXSBvZiB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmVudHJpZXMoKSkge1xuICAgICAgY29uc3Qgbm9ybWFsaXplZElkZW50aWZpZXIgPVxuICAgICAgICB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihpbnN0YW5jZUlkZW50aWZpZXIpO1xuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBgZ2V0T3JJbml0aWFsaXplU2VydmljZSgpYCBzaG91bGQgYWx3YXlzIHJldHVybiBhIHZhbGlkIGluc3RhbmNlIHNpbmNlIGEgY29tcG9uZW50IGlzIGd1YXJhbnRlZWQuIHVzZSAhIHRvIG1ha2UgdHlwZXNjcmlwdCBoYXBweS5cbiAgICAgICAgY29uc3QgaW5zdGFuY2UgPSB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xuICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXJcbiAgICAgICAgfSkhO1xuICAgICAgICBpbnN0YW5jZURlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyB3aGVuIHRoZSBpbnN0YW5jZSBmYWN0b3J5IHRocm93cyBhbiBleGNlcHRpb24sIGl0IHNob3VsZCBub3QgY2F1c2VcbiAgICAgICAgLy8gYSBmYXRhbCBlcnJvci4gV2UganVzdCBsZWF2ZSB0aGUgcHJvbWlzZSB1bnJlc29sdmVkLlxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNsZWFySW5zdGFuY2UoaWRlbnRpZmllcjogc3RyaW5nID0gREVGQVVMVF9FTlRSWV9OQU1FKTogdm9pZCB7XG4gICAgdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5kZWxldGUoaWRlbnRpZmllcik7XG4gICAgdGhpcy5pbnN0YW5jZXNPcHRpb25zLmRlbGV0ZShpZGVudGlmaWVyKTtcbiAgICB0aGlzLmluc3RhbmNlcy5kZWxldGUoaWRlbnRpZmllcik7XG4gIH1cblxuICAvLyBhcHAuZGVsZXRlKCkgd2lsbCBjYWxsIHRoaXMgbWV0aG9kIG9uIGV2ZXJ5IHByb3ZpZGVyIHRvIGRlbGV0ZSB0aGUgc2VydmljZXNcbiAgLy8gVE9ETzogc2hvdWxkIHdlIG1hcmsgdGhlIHByb3ZpZGVyIGFzIGRlbGV0ZWQ/XG4gIGFzeW5jIGRlbGV0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBzZXJ2aWNlcyA9IEFycmF5LmZyb20odGhpcy5pbnN0YW5jZXMudmFsdWVzKCkpO1xuXG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgLi4uc2VydmljZXNcbiAgICAgICAgLmZpbHRlcihzZXJ2aWNlID0+ICdJTlRFUk5BTCcgaW4gc2VydmljZSkgLy8gbGVnYWN5IHNlcnZpY2VzXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIC5tYXAoc2VydmljZSA9PiAoc2VydmljZSBhcyBhbnkpLklOVEVSTkFMIS5kZWxldGUoKSksXG4gICAgICAuLi5zZXJ2aWNlc1xuICAgICAgICAuZmlsdGVyKHNlcnZpY2UgPT4gJ19kZWxldGUnIGluIHNlcnZpY2UpIC8vIG1vZHVsYXJpemVkIHNlcnZpY2VzXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIC5tYXAoc2VydmljZSA9PiAoc2VydmljZSBhcyBhbnkpLl9kZWxldGUoKSlcbiAgICBdKTtcbiAgfVxuXG4gIGlzQ29tcG9uZW50U2V0KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudCAhPSBudWxsO1xuICB9XG5cbiAgaXNJbml0aWFsaXplZChpZGVudGlmaWVyOiBzdHJpbmcgPSBERUZBVUxUX0VOVFJZX05BTUUpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pbnN0YW5jZXMuaGFzKGlkZW50aWZpZXIpO1xuICB9XG5cbiAgZ2V0T3B0aW9ucyhpZGVudGlmaWVyOiBzdHJpbmcgPSBERUZBVUxUX0VOVFJZX05BTUUpOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB7XG4gICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5nZXQoaWRlbnRpZmllcikgfHwge307XG4gIH1cblxuICBpbml0aWFsaXplKG9wdHM6IEluaXRpYWxpemVPcHRpb25zID0ge30pOiBOYW1lU2VydmljZU1hcHBpbmdbVF0ge1xuICAgIGNvbnN0IHsgb3B0aW9ucyA9IHt9IH0gPSBvcHRzO1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoXG4gICAgICBvcHRzLmluc3RhbmNlSWRlbnRpZmllclxuICAgICk7XG4gICAgaWYgKHRoaXMuaXNJbml0aWFsaXplZChub3JtYWxpemVkSWRlbnRpZmllcikpIHtcbiAgICAgIHRocm93IEVycm9yKFxuICAgICAgICBgJHt0aGlzLm5hbWV9KCR7bm9ybWFsaXplZElkZW50aWZpZXJ9KSBoYXMgYWxyZWFkeSBiZWVuIGluaXRpYWxpemVkYFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuaXNDb21wb25lbnRTZXQoKSkge1xuICAgICAgdGhyb3cgRXJyb3IoYENvbXBvbmVudCAke3RoaXMubmFtZX0gaGFzIG5vdCBiZWVuIHJlZ2lzdGVyZWQgeWV0YCk7XG4gICAgfVxuXG4gICAgY29uc3QgaW5zdGFuY2UgPSB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xuICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllcixcbiAgICAgIG9wdGlvbnNcbiAgICB9KSE7XG5cbiAgICAvLyByZXNvbHZlIGFueSBwZW5kaW5nIHByb21pc2Ugd2FpdGluZyBmb3IgdGhlIHNlcnZpY2UgaW5zdGFuY2VcbiAgICBmb3IgKGNvbnN0IFtcbiAgICAgIGluc3RhbmNlSWRlbnRpZmllcixcbiAgICAgIGluc3RhbmNlRGVmZXJyZWRcbiAgICBdIG9mIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZW50cmllcygpKSB7XG4gICAgICBjb25zdCBub3JtYWxpemVkRGVmZXJyZWRJZGVudGlmaWVyID1cbiAgICAgICAgdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaW5zdGFuY2VJZGVudGlmaWVyKTtcbiAgICAgIGlmIChub3JtYWxpemVkSWRlbnRpZmllciA9PT0gbm9ybWFsaXplZERlZmVycmVkSWRlbnRpZmllcikge1xuICAgICAgICBpbnN0YW5jZURlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfVxuXG4gIC8qKlxuICAgKlxuICAgKiBAcGFyYW0gY2FsbGJhY2sgLSBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnZva2VkICBhZnRlciB0aGUgcHJvdmlkZXIgaGFzIGJlZW4gaW5pdGlhbGl6ZWQgYnkgY2FsbGluZyBwcm92aWRlci5pbml0aWFsaXplKCkuXG4gICAqIFRoZSBmdW5jdGlvbiBpcyBpbnZva2VkIFNZTkNIUk9OT1VTTFksIHNvIGl0IHNob3VsZCBub3QgZXhlY3V0ZSBhbnkgbG9uZ3J1bm5pbmcgdGFza3MgaW4gb3JkZXIgdG8gbm90IGJsb2NrIHRoZSBwcm9ncmFtLlxuICAgKlxuICAgKiBAcGFyYW0gaWRlbnRpZmllciBBbiBvcHRpb25hbCBpbnN0YW5jZSBpZGVudGlmaWVyXG4gICAqIEByZXR1cm5zIGEgZnVuY3Rpb24gdG8gdW5yZWdpc3RlciB0aGUgY2FsbGJhY2tcbiAgICovXG4gIG9uSW5pdChjYWxsYmFjazogT25Jbml0Q2FsbEJhY2s8VD4sIGlkZW50aWZpZXI/OiBzdHJpbmcpOiAoKSA9PiB2b2lkIHtcbiAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xuICAgIGNvbnN0IGV4aXN0aW5nQ2FsbGJhY2tzID1cbiAgICAgIHRoaXMub25Jbml0Q2FsbGJhY2tzLmdldChub3JtYWxpemVkSWRlbnRpZmllcikgPz9cbiAgICAgIG5ldyBTZXQ8T25Jbml0Q2FsbEJhY2s8VD4+KCk7XG4gICAgZXhpc3RpbmdDYWxsYmFja3MuYWRkKGNhbGxiYWNrKTtcbiAgICB0aGlzLm9uSW5pdENhbGxiYWNrcy5zZXQobm9ybWFsaXplZElkZW50aWZpZXIsIGV4aXN0aW5nQ2FsbGJhY2tzKTtcblxuICAgIGNvbnN0IGV4aXN0aW5nSW5zdGFuY2UgPSB0aGlzLmluc3RhbmNlcy5nZXQobm9ybWFsaXplZElkZW50aWZpZXIpO1xuICAgIGlmIChleGlzdGluZ0luc3RhbmNlKSB7XG4gICAgICBjYWxsYmFjayhleGlzdGluZ0luc3RhbmNlLCBub3JtYWxpemVkSWRlbnRpZmllcik7XG4gICAgfVxuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGV4aXN0aW5nQ2FsbGJhY2tzLmRlbGV0ZShjYWxsYmFjayk7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnZva2Ugb25Jbml0IGNhbGxiYWNrcyBzeW5jaHJvbm91c2x5XG4gICAqIEBwYXJhbSBpbnN0YW5jZSB0aGUgc2VydmljZSBpbnN0YW5jZWBcbiAgICovXG4gIHByaXZhdGUgaW52b2tlT25Jbml0Q2FsbGJhY2tzKFxuICAgIGluc3RhbmNlOiBOYW1lU2VydmljZU1hcHBpbmdbVF0sXG4gICAgaWRlbnRpZmllcjogc3RyaW5nXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGNhbGxiYWNrcyA9IHRoaXMub25Jbml0Q2FsbGJhY2tzLmdldChpZGVudGlmaWVyKTtcbiAgICBpZiAoIWNhbGxiYWNrcykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IGNhbGxiYWNrIG9mIGNhbGxiYWNrcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY2FsbGJhY2soaW5zdGFuY2UsIGlkZW50aWZpZXIpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgaW4gdGhlIG9uSW5pdCBjYWxsYmFja1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XG4gICAgaW5zdGFuY2VJZGVudGlmaWVyLFxuICAgIG9wdGlvbnMgPSB7fVxuICB9OiB7XG4gICAgaW5zdGFuY2VJZGVudGlmaWVyOiBzdHJpbmc7XG4gICAgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICB9KTogTmFtZVNlcnZpY2VNYXBwaW5nW1RdIHwgbnVsbCB7XG4gICAgbGV0IGluc3RhbmNlID0gdGhpcy5pbnN0YW5jZXMuZ2V0KGluc3RhbmNlSWRlbnRpZmllcik7XG4gICAgaWYgKCFpbnN0YW5jZSAmJiB0aGlzLmNvbXBvbmVudCkge1xuICAgICAgaW5zdGFuY2UgPSB0aGlzLmNvbXBvbmVudC5pbnN0YW5jZUZhY3RvcnkodGhpcy5jb250YWluZXIsIHtcbiAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVJZGVudGlmaWVyRm9yRmFjdG9yeShpbnN0YW5jZUlkZW50aWZpZXIpLFxuICAgICAgICBvcHRpb25zXG4gICAgICB9KTtcbiAgICAgIHRoaXMuaW5zdGFuY2VzLnNldChpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlKTtcbiAgICAgIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBvcHRpb25zKTtcblxuICAgICAgLyoqXG4gICAgICAgKiBJbnZva2Ugb25Jbml0IGxpc3RlbmVycy5cbiAgICAgICAqIE5vdGUgdGhpcy5jb21wb25lbnQub25JbnN0YW5jZUNyZWF0ZWQgaXMgZGlmZmVyZW50LCB3aGljaCBpcyB1c2VkIGJ5IHRoZSBjb21wb25lbnQgY3JlYXRvcixcbiAgICAgICAqIHdoaWxlIG9uSW5pdCBsaXN0ZW5lcnMgYXJlIHJlZ2lzdGVyZWQgYnkgY29uc3VtZXJzIG9mIHRoZSBwcm92aWRlci5cbiAgICAgICAqL1xuICAgICAgdGhpcy5pbnZva2VPbkluaXRDYWxsYmFja3MoaW5zdGFuY2UsIGluc3RhbmNlSWRlbnRpZmllcik7XG5cbiAgICAgIC8qKlxuICAgICAgICogT3JkZXIgaXMgaW1wb3J0YW50XG4gICAgICAgKiBvbkluc3RhbmNlQ3JlYXRlZCgpIHNob3VsZCBiZSBjYWxsZWQgYWZ0ZXIgdGhpcy5pbnN0YW5jZXMuc2V0KGluc3RhbmNlSWRlbnRpZmllciwgaW5zdGFuY2UpOyB3aGljaFxuICAgICAgICogbWFrZXMgYGlzSW5pdGlhbGl6ZWQoKWAgcmV0dXJuIHRydWUuXG4gICAgICAgKi9cbiAgICAgIGlmICh0aGlzLmNvbXBvbmVudC5vbkluc3RhbmNlQ3JlYXRlZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkKFxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIsXG4gICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXIsXG4gICAgICAgICAgICBpbnN0YW5jZVxuICAgICAgICAgICk7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgaW4gdGhlIG9uSW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2tcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpbnN0YW5jZSB8fCBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoXG4gICAgaWRlbnRpZmllcjogc3RyaW5nID0gREVGQVVMVF9FTlRSWV9OQU1FXG4gICk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuY29tcG9uZW50KSB7XG4gICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQubXVsdGlwbGVJbnN0YW5jZXMgPyBpZGVudGlmaWVyIDogREVGQVVMVF9FTlRSWV9OQU1FO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaWRlbnRpZmllcjsgLy8gYXNzdW1lIG11bHRpcGxlIGluc3RhbmNlcyBhcmUgc3VwcG9ydGVkIGJlZm9yZSB0aGUgY29tcG9uZW50IGlzIHByb3ZpZGVkLlxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2hvdWxkQXV0b0luaXRpYWxpemUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIChcbiAgICAgICEhdGhpcy5jb21wb25lbnQgJiZcbiAgICAgIHRoaXMuY29tcG9uZW50Lmluc3RhbnRpYXRpb25Nb2RlICE9PSBJbnN0YW50aWF0aW9uTW9kZS5FWFBMSUNJVFxuICAgICk7XG4gIH1cbn1cblxuLy8gdW5kZWZpbmVkIHNob3VsZCBiZSBwYXNzZWQgdG8gdGhlIHNlcnZpY2UgZmFjdG9yeSBmb3IgdGhlIGRlZmF1bHQgaW5zdGFuY2VcbmZ1bmN0aW9uIG5vcm1hbGl6ZUlkZW50aWZpZXJGb3JGYWN0b3J5KGlkZW50aWZpZXI6IHN0cmluZyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIHJldHVybiBpZGVudGlmaWVyID09PSBERUZBVUxUX0VOVFJZX05BTUUgPyB1bmRlZmluZWQgOiBpZGVudGlmaWVyO1xufVxuXG5mdW5jdGlvbiBpc0NvbXBvbmVudEVhZ2VyPFQgZXh0ZW5kcyBOYW1lPihjb21wb25lbnQ6IENvbXBvbmVudDxUPik6IGJvb2xlYW4ge1xuICByZXR1cm4gY29tcG9uZW50Lmluc3RhbnRpYXRpb25Nb2RlID09PSBJbnN0YW50aWF0aW9uTW9kZS5FQUdFUjtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXInO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnQnO1xuaW1wb3J0IHsgTmFtZSB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIENvbXBvbmVudENvbnRhaW5lciB0aGF0IHByb3ZpZGVzIFByb3ZpZGVycyBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gYGF1dGhgLCBgYXV0aC1pbnRlcm5hbGBcbiAqL1xuZXhwb3J0IGNsYXNzIENvbXBvbmVudENvbnRhaW5lciB7XG4gIHByaXZhdGUgcmVhZG9ubHkgcHJvdmlkZXJzID0gbmV3IE1hcDxzdHJpbmcsIFByb3ZpZGVyPE5hbWU+PigpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgbmFtZTogc3RyaW5nKSB7fVxuXG4gIC8qKlxuICAgKlxuICAgKiBAcGFyYW0gY29tcG9uZW50IENvbXBvbmVudCBiZWluZyBhZGRlZFxuICAgKiBAcGFyYW0gb3ZlcndyaXRlIFdoZW4gYSBjb21wb25lbnQgd2l0aCB0aGUgc2FtZSBuYW1lIGhhcyBhbHJlYWR5IGJlZW4gcmVnaXN0ZXJlZCxcbiAgICogaWYgb3ZlcndyaXRlIGlzIHRydWU6IG92ZXJ3cml0ZSB0aGUgZXhpc3RpbmcgY29tcG9uZW50IHdpdGggdGhlIG5ldyBjb21wb25lbnQgYW5kIGNyZWF0ZSBhIG5ld1xuICAgKiBwcm92aWRlciB3aXRoIHRoZSBuZXcgY29tcG9uZW50LiBJdCBjYW4gYmUgdXNlZnVsIGluIHRlc3RzIHdoZXJlIHlvdSB3YW50IHRvIHVzZSBkaWZmZXJlbnQgbW9ja3NcbiAgICogZm9yIGRpZmZlcmVudCB0ZXN0cy5cbiAgICogaWYgb3ZlcndyaXRlIGlzIGZhbHNlOiB0aHJvdyBhbiBleGNlcHRpb25cbiAgICovXG4gIGFkZENvbXBvbmVudDxUIGV4dGVuZHMgTmFtZT4oY29tcG9uZW50OiBDb21wb25lbnQ8VD4pOiB2b2lkIHtcbiAgICBjb25zdCBwcm92aWRlciA9IHRoaXMuZ2V0UHJvdmlkZXIoY29tcG9uZW50Lm5hbWUpO1xuICAgIGlmIChwcm92aWRlci5pc0NvbXBvbmVudFNldCgpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkIHdpdGggJHt0aGlzLm5hbWV9YFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBwcm92aWRlci5zZXRDb21wb25lbnQoY29tcG9uZW50KTtcbiAgfVxuXG4gIGFkZE9yT3ZlcndyaXRlQ29tcG9uZW50PFQgZXh0ZW5kcyBOYW1lPihjb21wb25lbnQ6IENvbXBvbmVudDxUPik6IHZvaWQge1xuICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5nZXRQcm92aWRlcihjb21wb25lbnQubmFtZSk7XG4gICAgaWYgKHByb3ZpZGVyLmlzQ29tcG9uZW50U2V0KCkpIHtcbiAgICAgIC8vIGRlbGV0ZSB0aGUgZXhpc3RpbmcgcHJvdmlkZXIgZnJvbSB0aGUgY29udGFpbmVyLCBzbyB3ZSBjYW4gcmVnaXN0ZXIgdGhlIG5ldyBjb21wb25lbnRcbiAgICAgIHRoaXMucHJvdmlkZXJzLmRlbGV0ZShjb21wb25lbnQubmFtZSk7XG4gICAgfVxuXG4gICAgdGhpcy5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXRQcm92aWRlciBwcm92aWRlcyBhIHR5cGUgc2FmZSBpbnRlcmZhY2Ugd2hlcmUgaXQgY2FuIG9ubHkgYmUgY2FsbGVkIHdpdGggYSBmaWVsZCBuYW1lXG4gICAqIHByZXNlbnQgaW4gTmFtZVNlcnZpY2VNYXBwaW5nIGludGVyZmFjZS5cbiAgICpcbiAgICogRmlyZWJhc2UgU0RLcyBwcm92aWRpbmcgc2VydmljZXMgc2hvdWxkIGV4dGVuZCBOYW1lU2VydmljZU1hcHBpbmcgaW50ZXJmYWNlIHRvIHJlZ2lzdGVyXG4gICAqIHRoZW1zZWx2ZXMuXG4gICAqL1xuICBnZXRQcm92aWRlcjxUIGV4dGVuZHMgTmFtZT4obmFtZTogVCk6IFByb3ZpZGVyPFQ+IHtcbiAgICBpZiAodGhpcy5wcm92aWRlcnMuaGFzKG5hbWUpKSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm92aWRlcnMuZ2V0KG5hbWUpIGFzIHVua25vd24gYXMgUHJvdmlkZXI8VD47XG4gICAgfVxuXG4gICAgLy8gY3JlYXRlIGEgUHJvdmlkZXIgZm9yIGEgc2VydmljZSB0aGF0IGhhc24ndCByZWdpc3RlcmVkIHdpdGggRmlyZWJhc2VcbiAgICBjb25zdCBwcm92aWRlciA9IG5ldyBQcm92aWRlcjxUPihuYW1lLCB0aGlzKTtcbiAgICB0aGlzLnByb3ZpZGVycy5zZXQobmFtZSwgcHJvdmlkZXIgYXMgdW5rbm93biBhcyBQcm92aWRlcjxOYW1lPik7XG5cbiAgICByZXR1cm4gcHJvdmlkZXIgYXMgUHJvdmlkZXI8VD47XG4gIH1cblxuICBnZXRQcm92aWRlcnMoKTogQXJyYXk8UHJvdmlkZXI8TmFtZT4+IHtcbiAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVycy52YWx1ZXMoKSk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5leHBvcnQgdHlwZSBMb2dMZXZlbFN0cmluZyA9XG4gIHwgJ2RlYnVnJ1xuICB8ICd2ZXJib3NlJ1xuICB8ICdpbmZvJ1xuICB8ICd3YXJuJ1xuICB8ICdlcnJvcidcbiAgfCAnc2lsZW50JztcblxuZXhwb3J0IGludGVyZmFjZSBMb2dPcHRpb25zIHtcbiAgbGV2ZWw6IExvZ0xldmVsU3RyaW5nO1xufVxuXG5leHBvcnQgdHlwZSBMb2dDYWxsYmFjayA9IChjYWxsYmFja1BhcmFtczogTG9nQ2FsbGJhY2tQYXJhbXMpID0+IHZvaWQ7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG9nQ2FsbGJhY2tQYXJhbXMge1xuICBsZXZlbDogTG9nTGV2ZWxTdHJpbmc7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgYXJnczogdW5rbm93bltdO1xuICB0eXBlOiBzdHJpbmc7XG59XG5cbi8qKlxuICogQSBjb250YWluZXIgZm9yIGFsbCBvZiB0aGUgTG9nZ2VyIGluc3RhbmNlc1xuICovXG5leHBvcnQgY29uc3QgaW5zdGFuY2VzOiBMb2dnZXJbXSA9IFtdO1xuXG4vKipcbiAqIFRoZSBKUyBTREsgc3VwcG9ydHMgNSBsb2cgbGV2ZWxzIGFuZCBhbHNvIGFsbG93cyBhIHVzZXIgdGhlIGFiaWxpdHkgdG9cbiAqIHNpbGVuY2UgdGhlIGxvZ3MgYWx0b2dldGhlci5cbiAqXG4gKiBUaGUgb3JkZXIgaXMgYSBmb2xsb3dzOlxuICogREVCVUcgPCBWRVJCT1NFIDwgSU5GTyA8IFdBUk4gPCBFUlJPUlxuICpcbiAqIEFsbCBvZiB0aGUgbG9nIHR5cGVzIGFib3ZlIHRoZSBjdXJyZW50IGxvZyBsZXZlbCB3aWxsIGJlIGNhcHR1cmVkIChpLmUuIGlmXG4gKiB5b3Ugc2V0IHRoZSBsb2cgbGV2ZWwgdG8gYElORk9gLCBlcnJvcnMgd2lsbCBzdGlsbCBiZSBsb2dnZWQsIGJ1dCBgREVCVUdgIGFuZFxuICogYFZFUkJPU0VgIGxvZ3Mgd2lsbCBub3QpXG4gKi9cbmV4cG9ydCBlbnVtIExvZ0xldmVsIHtcbiAgREVCVUcsXG4gIFZFUkJPU0UsXG4gIElORk8sXG4gIFdBUk4sXG4gIEVSUk9SLFxuICBTSUxFTlRcbn1cblxuY29uc3QgbGV2ZWxTdHJpbmdUb0VudW06IHsgW2tleSBpbiBMb2dMZXZlbFN0cmluZ106IExvZ0xldmVsIH0gPSB7XG4gICdkZWJ1Zyc6IExvZ0xldmVsLkRFQlVHLFxuICAndmVyYm9zZSc6IExvZ0xldmVsLlZFUkJPU0UsXG4gICdpbmZvJzogTG9nTGV2ZWwuSU5GTyxcbiAgJ3dhcm4nOiBMb2dMZXZlbC5XQVJOLFxuICAnZXJyb3InOiBMb2dMZXZlbC5FUlJPUixcbiAgJ3NpbGVudCc6IExvZ0xldmVsLlNJTEVOVFxufTtcblxuLyoqXG4gKiBUaGUgZGVmYXVsdCBsb2cgbGV2ZWxcbiAqL1xuY29uc3QgZGVmYXVsdExvZ0xldmVsOiBMb2dMZXZlbCA9IExvZ0xldmVsLklORk87XG5cbi8qKlxuICogV2UgYWxsb3cgdXNlcnMgdGhlIGFiaWxpdHkgdG8gcGFzcyB0aGVpciBvd24gbG9nIGhhbmRsZXIuIFdlIHdpbGwgcGFzcyB0aGVcbiAqIHR5cGUgb2YgbG9nLCB0aGUgY3VycmVudCBsb2cgbGV2ZWwsIGFuZCBhbnkgb3RoZXIgYXJndW1lbnRzIHBhc3NlZCAoaS5lLiB0aGVcbiAqIG1lc3NhZ2VzIHRoYXQgdGhlIHVzZXIgd2FudHMgdG8gbG9nKSB0byB0aGlzIGZ1bmN0aW9uLlxuICovXG5leHBvcnQgdHlwZSBMb2dIYW5kbGVyID0gKFxuICBsb2dnZXJJbnN0YW5jZTogTG9nZ2VyLFxuICBsb2dUeXBlOiBMb2dMZXZlbCxcbiAgLi4uYXJnczogdW5rbm93bltdXG4pID0+IHZvaWQ7XG5cbi8qKlxuICogQnkgZGVmYXVsdCwgYGNvbnNvbGUuZGVidWdgIGlzIG5vdCBkaXNwbGF5ZWQgaW4gdGhlIGRldmVsb3BlciBjb25zb2xlIChpblxuICogY2hyb21lKS4gVG8gYXZvaWQgZm9yY2luZyB1c2VycyB0byBoYXZlIHRvIG9wdC1pbiB0byB0aGVzZSBsb2dzIHR3aWNlXG4gKiAoaS5lLiBvbmNlIGZvciBmaXJlYmFzZSwgYW5kIG9uY2UgaW4gdGhlIGNvbnNvbGUpLCB3ZSBhcmUgc2VuZGluZyBgREVCVUdgXG4gKiBsb2dzIHRvIHRoZSBgY29uc29sZS5sb2dgIGZ1bmN0aW9uLlxuICovXG5jb25zdCBDb25zb2xlTWV0aG9kID0ge1xuICBbTG9nTGV2ZWwuREVCVUddOiAnbG9nJyxcbiAgW0xvZ0xldmVsLlZFUkJPU0VdOiAnbG9nJyxcbiAgW0xvZ0xldmVsLklORk9dOiAnaW5mbycsXG4gIFtMb2dMZXZlbC5XQVJOXTogJ3dhcm4nLFxuICBbTG9nTGV2ZWwuRVJST1JdOiAnZXJyb3InXG59O1xuXG4vKipcbiAqIFRoZSBkZWZhdWx0IGxvZyBoYW5kbGVyIHdpbGwgZm9yd2FyZCBERUJVRywgVkVSQk9TRSwgSU5GTywgV0FSTiwgYW5kIEVSUk9SXG4gKiBtZXNzYWdlcyBvbiB0byB0aGVpciBjb3JyZXNwb25kaW5nIGNvbnNvbGUgY291bnRlcnBhcnRzIChpZiB0aGUgbG9nIG1ldGhvZFxuICogaXMgc3VwcG9ydGVkIGJ5IHRoZSBjdXJyZW50IGxvZyBsZXZlbClcbiAqL1xuY29uc3QgZGVmYXVsdExvZ0hhbmRsZXI6IExvZ0hhbmRsZXIgPSAoaW5zdGFuY2UsIGxvZ1R5cGUsIC4uLmFyZ3MpOiB2b2lkID0+IHtcbiAgaWYgKGxvZ1R5cGUgPCBpbnN0YW5jZS5sb2dMZXZlbCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCk7XG4gIGNvbnN0IG1ldGhvZCA9IENvbnNvbGVNZXRob2RbbG9nVHlwZSBhcyBrZXlvZiB0eXBlb2YgQ29uc29sZU1ldGhvZF07XG4gIGlmIChtZXRob2QpIHtcbiAgICBjb25zb2xlW21ldGhvZCBhcyAnbG9nJyB8ICdpbmZvJyB8ICd3YXJuJyB8ICdlcnJvciddKFxuICAgICAgYFske25vd31dICAke2luc3RhbmNlLm5hbWV9OmAsXG4gICAgICAuLi5hcmdzXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgQXR0ZW1wdGVkIHRvIGxvZyBhIG1lc3NhZ2Ugd2l0aCBhbiBpbnZhbGlkIGxvZ1R5cGUgKHZhbHVlOiAke2xvZ1R5cGV9KWBcbiAgICApO1xuICB9XG59O1xuXG5leHBvcnQgY2xhc3MgTG9nZ2VyIHtcbiAgLyoqXG4gICAqIEdpdmVzIHlvdSBhbiBpbnN0YW5jZSBvZiBhIExvZ2dlciB0byBjYXB0dXJlIG1lc3NhZ2VzIGFjY29yZGluZyB0b1xuICAgKiBGaXJlYmFzZSdzIGxvZ2dpbmcgc2NoZW1lLlxuICAgKlxuICAgKiBAcGFyYW0gbmFtZSBUaGUgbmFtZSB0aGF0IHRoZSBsb2dzIHdpbGwgYmUgYXNzb2NpYXRlZCB3aXRoXG4gICAqL1xuICBjb25zdHJ1Y3RvcihwdWJsaWMgbmFtZTogc3RyaW5nKSB7XG4gICAgLyoqXG4gICAgICogQ2FwdHVyZSB0aGUgY3VycmVudCBpbnN0YW5jZSBmb3IgbGF0ZXIgdXNlXG4gICAgICovXG4gICAgaW5zdGFuY2VzLnB1c2godGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGxvZyBsZXZlbCBvZiB0aGUgZ2l2ZW4gTG9nZ2VyIGluc3RhbmNlLlxuICAgKi9cbiAgcHJpdmF0ZSBfbG9nTGV2ZWwgPSBkZWZhdWx0TG9nTGV2ZWw7XG5cbiAgZ2V0IGxvZ0xldmVsKCk6IExvZ0xldmVsIHtcbiAgICByZXR1cm4gdGhpcy5fbG9nTGV2ZWw7XG4gIH1cblxuICBzZXQgbG9nTGV2ZWwodmFsOiBMb2dMZXZlbCkge1xuICAgIGlmICghKHZhbCBpbiBMb2dMZXZlbCkpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYEludmFsaWQgdmFsdWUgXCIke3ZhbH1cIiBhc3NpZ25lZCB0byBcXGBsb2dMZXZlbFxcYGApO1xuICAgIH1cbiAgICB0aGlzLl9sb2dMZXZlbCA9IHZhbDtcbiAgfVxuXG4gIC8vIFdvcmthcm91bmQgZm9yIHNldHRlci9nZXR0ZXIgaGF2aW5nIHRvIGJlIHRoZSBzYW1lIHR5cGUuXG4gIHNldExvZ0xldmVsKHZhbDogTG9nTGV2ZWwgfCBMb2dMZXZlbFN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMuX2xvZ0xldmVsID0gdHlwZW9mIHZhbCA9PT0gJ3N0cmluZycgPyBsZXZlbFN0cmluZ1RvRW51bVt2YWxdIDogdmFsO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBtYWluIChpbnRlcm5hbCkgbG9nIGhhbmRsZXIgZm9yIHRoZSBMb2dnZXIgaW5zdGFuY2UuXG4gICAqIENhbiBiZSBzZXQgdG8gYSBuZXcgZnVuY3Rpb24gaW4gaW50ZXJuYWwgcGFja2FnZSBjb2RlIGJ1dCBub3QgYnkgdXNlci5cbiAgICovXG4gIHByaXZhdGUgX2xvZ0hhbmRsZXI6IExvZ0hhbmRsZXIgPSBkZWZhdWx0TG9nSGFuZGxlcjtcbiAgZ2V0IGxvZ0hhbmRsZXIoKTogTG9nSGFuZGxlciB7XG4gICAgcmV0dXJuIHRoaXMuX2xvZ0hhbmRsZXI7XG4gIH1cbiAgc2V0IGxvZ0hhbmRsZXIodmFsOiBMb2dIYW5kbGVyKSB7XG4gICAgaWYgKHR5cGVvZiB2YWwgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1ZhbHVlIGFzc2lnbmVkIHRvIGBsb2dIYW5kbGVyYCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG4gICAgdGhpcy5fbG9nSGFuZGxlciA9IHZhbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgb3B0aW9uYWwsIGFkZGl0aW9uYWwsIHVzZXItZGVmaW5lZCBsb2cgaGFuZGxlciBmb3IgdGhlIExvZ2dlciBpbnN0YW5jZS5cbiAgICovXG4gIHByaXZhdGUgX3VzZXJMb2dIYW5kbGVyOiBMb2dIYW5kbGVyIHwgbnVsbCA9IG51bGw7XG4gIGdldCB1c2VyTG9nSGFuZGxlcigpOiBMb2dIYW5kbGVyIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuX3VzZXJMb2dIYW5kbGVyO1xuICB9XG4gIHNldCB1c2VyTG9nSGFuZGxlcih2YWw6IExvZ0hhbmRsZXIgfCBudWxsKSB7XG4gICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgPSB2YWw7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGZ1bmN0aW9ucyBiZWxvdyBhcmUgYWxsIGJhc2VkIG9uIHRoZSBgY29uc29sZWAgaW50ZXJmYWNlXG4gICAqL1xuXG4gIGRlYnVnKC4uLmFyZ3M6IHVua25vd25bXSk6IHZvaWQge1xuICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLkRFQlVHLCAuLi5hcmdzKTtcbiAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLkRFQlVHLCAuLi5hcmdzKTtcbiAgfVxuICBsb2coLi4uYXJnczogdW5rbm93bltdKTogdm9pZCB7XG4gICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiZcbiAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLlZFUkJPU0UsIC4uLmFyZ3MpO1xuICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuVkVSQk9TRSwgLi4uYXJncyk7XG4gIH1cbiAgaW5mbyguLi5hcmdzOiB1bmtub3duW10pOiB2b2lkIHtcbiAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5JTkZPLCAuLi5hcmdzKTtcbiAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLklORk8sIC4uLmFyZ3MpO1xuICB9XG4gIHdhcm4oLi4uYXJnczogdW5rbm93bltdKTogdm9pZCB7XG4gICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuV0FSTiwgLi4uYXJncyk7XG4gICAgdGhpcy5fbG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5XQVJOLCAuLi5hcmdzKTtcbiAgfVxuICBlcnJvciguLi5hcmdzOiB1bmtub3duW10pOiB2b2lkIHtcbiAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJiB0aGlzLl91c2VyTG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5FUlJPUiwgLi4uYXJncyk7XG4gICAgdGhpcy5fbG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5FUlJPUiwgLi4uYXJncyk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldExvZ0xldmVsKGxldmVsOiBMb2dMZXZlbFN0cmluZyB8IExvZ0xldmVsKTogdm9pZCB7XG4gIGluc3RhbmNlcy5mb3JFYWNoKGluc3QgPT4ge1xuICAgIGluc3Quc2V0TG9nTGV2ZWwobGV2ZWwpO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldFVzZXJMb2dIYW5kbGVyKFxuICBsb2dDYWxsYmFjazogTG9nQ2FsbGJhY2sgfCBudWxsLFxuICBvcHRpb25zPzogTG9nT3B0aW9uc1xuKTogdm9pZCB7XG4gIGZvciAoY29uc3QgaW5zdGFuY2Ugb2YgaW5zdGFuY2VzKSB7XG4gICAgbGV0IGN1c3RvbUxvZ0xldmVsOiBMb2dMZXZlbCB8IG51bGwgPSBudWxsO1xuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMubGV2ZWwpIHtcbiAgICAgIGN1c3RvbUxvZ0xldmVsID0gbGV2ZWxTdHJpbmdUb0VudW1bb3B0aW9ucy5sZXZlbF07XG4gICAgfVxuICAgIGlmIChsb2dDYWxsYmFjayA9PT0gbnVsbCkge1xuICAgICAgaW5zdGFuY2UudXNlckxvZ0hhbmRsZXIgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBpbnN0YW5jZS51c2VyTG9nSGFuZGxlciA9IChcbiAgICAgICAgaW5zdGFuY2U6IExvZ2dlcixcbiAgICAgICAgbGV2ZWw6IExvZ0xldmVsLFxuICAgICAgICAuLi5hcmdzOiB1bmtub3duW11cbiAgICAgICkgPT4ge1xuICAgICAgICBjb25zdCBtZXNzYWdlID0gYXJnc1xuICAgICAgICAgIC5tYXAoYXJnID0+IHtcbiAgICAgICAgICAgIGlmIChhcmcgPT0gbnVsbCkge1xuICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGFyZztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGFyZyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgIHJldHVybiBhcmcudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYXJnIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGFyZy5tZXNzYWdlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAoaWdub3JlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmlsdGVyKGFyZyA9PiBhcmcpXG4gICAgICAgICAgLmpvaW4oJyAnKTtcbiAgICAgICAgaWYgKGxldmVsID49IChjdXN0b21Mb2dMZXZlbCA/PyBpbnN0YW5jZS5sb2dMZXZlbCkpIHtcbiAgICAgICAgICBsb2dDYWxsYmFjayh7XG4gICAgICAgICAgICBsZXZlbDogTG9nTGV2ZWxbbGV2ZWxdLnRvTG93ZXJDYXNlKCkgYXMgTG9nTGV2ZWxTdHJpbmcsXG4gICAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgICAgYXJncyxcbiAgICAgICAgICAgIHR5cGU6IGluc3RhbmNlLm5hbWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cbn1cbiIsICJjb25zdCBpbnN0YW5jZU9mQW55ID0gKG9iamVjdCwgY29uc3RydWN0b3JzKSA9PiBjb25zdHJ1Y3RvcnMuc29tZSgoYykgPT4gb2JqZWN0IGluc3RhbmNlb2YgYyk7XG5cbmxldCBpZGJQcm94eWFibGVUeXBlcztcbmxldCBjdXJzb3JBZHZhbmNlTWV0aG9kcztcbi8vIFRoaXMgaXMgYSBmdW5jdGlvbiB0byBwcmV2ZW50IGl0IHRocm93aW5nIHVwIGluIG5vZGUgZW52aXJvbm1lbnRzLlxuZnVuY3Rpb24gZ2V0SWRiUHJveHlhYmxlVHlwZXMoKSB7XG4gICAgcmV0dXJuIChpZGJQcm94eWFibGVUeXBlcyB8fFxuICAgICAgICAoaWRiUHJveHlhYmxlVHlwZXMgPSBbXG4gICAgICAgICAgICBJREJEYXRhYmFzZSxcbiAgICAgICAgICAgIElEQk9iamVjdFN0b3JlLFxuICAgICAgICAgICAgSURCSW5kZXgsXG4gICAgICAgICAgICBJREJDdXJzb3IsXG4gICAgICAgICAgICBJREJUcmFuc2FjdGlvbixcbiAgICAgICAgXSkpO1xufVxuLy8gVGhpcyBpcyBhIGZ1bmN0aW9uIHRvIHByZXZlbnQgaXQgdGhyb3dpbmcgdXAgaW4gbm9kZSBlbnZpcm9ubWVudHMuXG5mdW5jdGlvbiBnZXRDdXJzb3JBZHZhbmNlTWV0aG9kcygpIHtcbiAgICByZXR1cm4gKGN1cnNvckFkdmFuY2VNZXRob2RzIHx8XG4gICAgICAgIChjdXJzb3JBZHZhbmNlTWV0aG9kcyA9IFtcbiAgICAgICAgICAgIElEQkN1cnNvci5wcm90b3R5cGUuYWR2YW5jZSxcbiAgICAgICAgICAgIElEQkN1cnNvci5wcm90b3R5cGUuY29udGludWUsXG4gICAgICAgICAgICBJREJDdXJzb3IucHJvdG90eXBlLmNvbnRpbnVlUHJpbWFyeUtleSxcbiAgICAgICAgXSkpO1xufVxuY29uc3QgY3Vyc29yUmVxdWVzdE1hcCA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCB0cmFuc2FjdGlvbkRvbmVNYXAgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgdHJhbnNhY3Rpb25TdG9yZU5hbWVzTWFwID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHRyYW5zZm9ybUNhY2hlID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHJldmVyc2VUcmFuc2Zvcm1DYWNoZSA9IG5ldyBXZWFrTWFwKCk7XG5mdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zdCB1bmxpc3RlbiA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlcXVlc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIHN1Y2Nlc3MpO1xuICAgICAgICAgICAgcmVxdWVzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUod3JhcChyZXF1ZXN0LnJlc3VsdCkpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICAgICAgICB1bmxpc3RlbigpO1xuICAgICAgICB9O1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICB9KTtcbiAgICBwcm9taXNlXG4gICAgICAgIC50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAvLyBTaW5jZSBjdXJzb3JpbmcgcmV1c2VzIHRoZSBJREJSZXF1ZXN0ICgqc2lnaCopLCB3ZSBjYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsXG4gICAgICAgIC8vIChzZWUgd3JhcEZ1bmN0aW9uKS5cbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCQ3Vyc29yKSB7XG4gICAgICAgICAgICBjdXJzb3JSZXF1ZXN0TWFwLnNldCh2YWx1ZSwgcmVxdWVzdCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2F0Y2hpbmcgdG8gYXZvaWQgXCJVbmNhdWdodCBQcm9taXNlIGV4Y2VwdGlvbnNcIlxuICAgIH0pXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7IH0pO1xuICAgIC8vIFRoaXMgbWFwcGluZyBleGlzdHMgaW4gcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGJ1dCBkb2Vzbid0IGRvZXNuJ3QgZXhpc3QgaW4gdHJhbnNmb3JtQ2FjaGUuIFRoaXNcbiAgICAvLyBpcyBiZWNhdXNlIHdlIGNyZWF0ZSBtYW55IHByb21pc2VzIGZyb20gYSBzaW5nbGUgSURCUmVxdWVzdC5cbiAgICByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuc2V0KHByb21pc2UsIHJlcXVlc3QpO1xuICAgIHJldHVybiBwcm9taXNlO1xufVxuZnVuY3Rpb24gY2FjaGVEb25lUHJvbWlzZUZvclRyYW5zYWN0aW9uKHR4KSB7XG4gICAgLy8gRWFybHkgYmFpbCBpZiB3ZSd2ZSBhbHJlYWR5IGNyZWF0ZWQgYSBkb25lIHByb21pc2UgZm9yIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgaWYgKHRyYW5zYWN0aW9uRG9uZU1hcC5oYXModHgpKVxuICAgICAgICByZXR1cm47XG4gICAgY29uc3QgZG9uZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgdW5saXN0ZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICB0eC5yZW1vdmVFdmVudExpc3RlbmVyKCdjb21wbGV0ZScsIGNvbXBsZXRlKTtcbiAgICAgICAgICAgIHR4LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICAgICAgdHgucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QodHguZXJyb3IgfHwgbmV3IERPTUV4Y2VwdGlvbignQWJvcnRFcnJvcicsICdBYm9ydEVycm9yJykpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHguYWRkRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCBjb21wbGV0ZSk7XG4gICAgICAgIHR4LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICB0eC5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsIGVycm9yKTtcbiAgICB9KTtcbiAgICAvLyBDYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsLlxuICAgIHRyYW5zYWN0aW9uRG9uZU1hcC5zZXQodHgsIGRvbmUpO1xufVxubGV0IGlkYlByb3h5VHJhcHMgPSB7XG4gICAgZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciB0cmFuc2FjdGlvbi5kb25lLlxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdkb25lJylcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25Eb25lTWFwLmdldCh0YXJnZXQpO1xuICAgICAgICAgICAgLy8gUG9seWZpbGwgZm9yIG9iamVjdFN0b3JlTmFtZXMgYmVjYXVzZSBvZiBFZGdlLlxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdvYmplY3RTdG9yZU5hbWVzJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQub2JqZWN0U3RvcmVOYW1lcyB8fCB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAuZ2V0KHRhcmdldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBNYWtlIHR4LnN0b3JlIHJldHVybiB0aGUgb25seSBzdG9yZSBpbiB0aGUgdHJhbnNhY3Rpb24sIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBhcmUgbWFueS5cbiAgICAgICAgICAgIGlmIChwcm9wID09PSAnc3RvcmUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY2VpdmVyLm9iamVjdFN0b3JlTmFtZXNbMV1cbiAgICAgICAgICAgICAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgOiByZWNlaXZlci5vYmplY3RTdG9yZShyZWNlaXZlci5vYmplY3RTdG9yZU5hbWVzWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBFbHNlIHRyYW5zZm9ybSB3aGF0ZXZlciB3ZSBnZXQgYmFjay5cbiAgICAgICAgcmV0dXJuIHdyYXAodGFyZ2V0W3Byb3BdKTtcbiAgICB9LFxuICAgIHNldCh0YXJnZXQsIHByb3AsIHZhbHVlKSB7XG4gICAgICAgIHRhcmdldFtwcm9wXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGhhcyh0YXJnZXQsIHByb3ApIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uICYmXG4gICAgICAgICAgICAocHJvcCA9PT0gJ2RvbmUnIHx8IHByb3AgPT09ICdzdG9yZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvcCBpbiB0YXJnZXQ7XG4gICAgfSxcbn07XG5mdW5jdGlvbiByZXBsYWNlVHJhcHMoY2FsbGJhY2spIHtcbiAgICBpZGJQcm94eVRyYXBzID0gY2FsbGJhY2soaWRiUHJveHlUcmFwcyk7XG59XG5mdW5jdGlvbiB3cmFwRnVuY3Rpb24oZnVuYykge1xuICAgIC8vIER1ZSB0byBleHBlY3RlZCBvYmplY3QgZXF1YWxpdHkgKHdoaWNoIGlzIGVuZm9yY2VkIGJ5IHRoZSBjYWNoaW5nIGluIGB3cmFwYCksIHdlXG4gICAgLy8gb25seSBjcmVhdGUgb25lIG5ldyBmdW5jIHBlciBmdW5jLlxuICAgIC8vIEVkZ2UgZG9lc24ndCBzdXBwb3J0IG9iamVjdFN0b3JlTmFtZXMgKGJvb28pLCBzbyB3ZSBwb2x5ZmlsbCBpdCBoZXJlLlxuICAgIGlmIChmdW5jID09PSBJREJEYXRhYmFzZS5wcm90b3R5cGUudHJhbnNhY3Rpb24gJiZcbiAgICAgICAgISgnb2JqZWN0U3RvcmVOYW1lcycgaW4gSURCVHJhbnNhY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHN0b3JlTmFtZXMsIC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIGNvbnN0IHR4ID0gZnVuYy5jYWxsKHVud3JhcCh0aGlzKSwgc3RvcmVOYW1lcywgLi4uYXJncyk7XG4gICAgICAgICAgICB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAuc2V0KHR4LCBzdG9yZU5hbWVzLnNvcnQgPyBzdG9yZU5hbWVzLnNvcnQoKSA6IFtzdG9yZU5hbWVzXSk7XG4gICAgICAgICAgICByZXR1cm4gd3JhcCh0eCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIEN1cnNvciBtZXRob2RzIGFyZSBzcGVjaWFsLCBhcyB0aGUgYmVoYXZpb3VyIGlzIGEgbGl0dGxlIG1vcmUgZGlmZmVyZW50IHRvIHN0YW5kYXJkIElEQi4gSW5cbiAgICAvLyBJREIsIHlvdSBhZHZhbmNlIHRoZSBjdXJzb3IgYW5kIHdhaXQgZm9yIGEgbmV3ICdzdWNjZXNzJyBvbiB0aGUgSURCUmVxdWVzdCB0aGF0IGdhdmUgeW91IHRoZVxuICAgIC8vIGN1cnNvci4gSXQncyBraW5kYSBsaWtlIGEgcHJvbWlzZSB0aGF0IGNhbiByZXNvbHZlIHdpdGggbWFueSB2YWx1ZXMuIFRoYXQgZG9lc24ndCBtYWtlIHNlbnNlXG4gICAgLy8gd2l0aCByZWFsIHByb21pc2VzLCBzbyBlYWNoIGFkdmFuY2UgbWV0aG9kcyByZXR1cm5zIGEgbmV3IHByb21pc2UgZm9yIHRoZSBjdXJzb3Igb2JqZWN0LCBvclxuICAgIC8vIHVuZGVmaW5lZCBpZiB0aGUgZW5kIG9mIHRoZSBjdXJzb3IgaGFzIGJlZW4gcmVhY2hlZC5cbiAgICBpZiAoZ2V0Q3Vyc29yQWR2YW5jZU1ldGhvZHMoKS5pbmNsdWRlcyhmdW5jKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIC8vIENhbGxpbmcgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIHdpdGggdGhlIHByb3h5IGFzICd0aGlzJyBjYXVzZXMgSUxMRUdBTCBJTlZPQ0FUSU9OLCBzbyB3ZSB1c2VcbiAgICAgICAgICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuXG4gICAgICAgICAgICBmdW5jLmFwcGx5KHVud3JhcCh0aGlzKSwgYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gd3JhcChjdXJzb3JSZXF1ZXN0TWFwLmdldCh0aGlzKSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICAvLyBDYWxsaW5nIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiB3aXRoIHRoZSBwcm94eSBhcyAndGhpcycgY2F1c2VzIElMTEVHQUwgSU5WT0NBVElPTiwgc28gd2UgdXNlXG4gICAgICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuXG4gICAgICAgIHJldHVybiB3cmFwKGZ1bmMuYXBwbHkodW53cmFwKHRoaXMpLCBhcmdzKSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKVxuICAgICAgICByZXR1cm4gd3JhcEZ1bmN0aW9uKHZhbHVlKTtcbiAgICAvLyBUaGlzIGRvZXNuJ3QgcmV0dXJuLCBpdCBqdXN0IGNyZWF0ZXMgYSAnZG9uZScgcHJvbWlzZSBmb3IgdGhlIHRyYW5zYWN0aW9uLFxuICAgIC8vIHdoaWNoIGlzIGxhdGVyIHJldHVybmVkIGZvciB0cmFuc2FjdGlvbi5kb25lIChzZWUgaWRiT2JqZWN0SGFuZGxlcikuXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCVHJhbnNhY3Rpb24pXG4gICAgICAgIGNhY2hlRG9uZVByb21pc2VGb3JUcmFuc2FjdGlvbih2YWx1ZSk7XG4gICAgaWYgKGluc3RhbmNlT2ZBbnkodmFsdWUsIGdldElkYlByb3h5YWJsZVR5cGVzKCkpKVxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHZhbHVlLCBpZGJQcm94eVRyYXBzKTtcbiAgICAvLyBSZXR1cm4gdGhlIHNhbWUgdmFsdWUgYmFjayBpZiB3ZSdyZSBub3QgZ29pbmcgdG8gdHJhbnNmb3JtIGl0LlxuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHdyYXAodmFsdWUpIHtcbiAgICAvLyBXZSBzb21ldGltZXMgZ2VuZXJhdGUgbXVsdGlwbGUgcHJvbWlzZXMgZnJvbSBhIHNpbmdsZSBJREJSZXF1ZXN0IChlZyB3aGVuIGN1cnNvcmluZyksIGJlY2F1c2VcbiAgICAvLyBJREIgaXMgd2VpcmQgYW5kIGEgc2luZ2xlIElEQlJlcXVlc3QgY2FuIHlpZWxkIG1hbnkgcmVzcG9uc2VzLCBzbyB0aGVzZSBjYW4ndCBiZSBjYWNoZWQuXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCUmVxdWVzdClcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QodmFsdWUpO1xuICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgdHJhbnNmb3JtZWQgdGhpcyB2YWx1ZSBiZWZvcmUsIHJldXNlIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZS5cbiAgICAvLyBUaGlzIGlzIGZhc3RlciwgYnV0IGl0IGFsc28gcHJvdmlkZXMgb2JqZWN0IGVxdWFsaXR5LlxuICAgIGlmICh0cmFuc2Zvcm1DYWNoZS5oYXModmFsdWUpKVxuICAgICAgICByZXR1cm4gdHJhbnNmb3JtQ2FjaGUuZ2V0KHZhbHVlKTtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpO1xuICAgIC8vIE5vdCBhbGwgdHlwZXMgYXJlIHRyYW5zZm9ybWVkLlxuICAgIC8vIFRoZXNlIG1heSBiZSBwcmltaXRpdmUgdHlwZXMsIHNvIHRoZXkgY2FuJ3QgYmUgV2Vha01hcCBrZXlzLlxuICAgIGlmIChuZXdWYWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgdHJhbnNmb3JtQ2FjaGUuc2V0KHZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgIHJldmVyc2VUcmFuc2Zvcm1DYWNoZS5zZXQobmV3VmFsdWUsIHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld1ZhbHVlO1xufVxuY29uc3QgdW53cmFwID0gKHZhbHVlKSA9PiByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuZ2V0KHZhbHVlKTtcblxuZXhwb3J0IHsgcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGFzIGEsIGluc3RhbmNlT2ZBbnkgYXMgaSwgcmVwbGFjZVRyYXBzIGFzIHIsIHVud3JhcCBhcyB1LCB3cmFwIGFzIHcgfTtcbiIsICJpbXBvcnQgeyB3IGFzIHdyYXAsIHIgYXMgcmVwbGFjZVRyYXBzIH0gZnJvbSAnLi93cmFwLWlkYi12YWx1ZS5qcyc7XG5leHBvcnQgeyB1IGFzIHVud3JhcCwgdyBhcyB3cmFwIH0gZnJvbSAnLi93cmFwLWlkYi12YWx1ZS5qcyc7XG5cbi8qKlxuICogT3BlbiBhIGRhdGFiYXNlLlxuICpcbiAqIEBwYXJhbSBuYW1lIE5hbWUgb2YgdGhlIGRhdGFiYXNlLlxuICogQHBhcmFtIHZlcnNpb24gU2NoZW1hIHZlcnNpb24uXG4gKiBAcGFyYW0gY2FsbGJhY2tzIEFkZGl0aW9uYWwgY2FsbGJhY2tzLlxuICovXG5mdW5jdGlvbiBvcGVuREIobmFtZSwgdmVyc2lvbiwgeyBibG9ja2VkLCB1cGdyYWRlLCBibG9ja2luZywgdGVybWluYXRlZCB9ID0ge30pIHtcbiAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4obmFtZSwgdmVyc2lvbik7XG4gICAgY29uc3Qgb3BlblByb21pc2UgPSB3cmFwKHJlcXVlc3QpO1xuICAgIGlmICh1cGdyYWRlKSB7XG4gICAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcigndXBncmFkZW5lZWRlZCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdXBncmFkZSh3cmFwKHJlcXVlc3QucmVzdWx0KSwgZXZlbnQub2xkVmVyc2lvbiwgZXZlbnQubmV3VmVyc2lvbiwgd3JhcChyZXF1ZXN0LnRyYW5zYWN0aW9uKSwgZXZlbnQpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGJsb2NrZWQpIHtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdibG9ja2VkJywgKGV2ZW50KSA9PiBibG9ja2VkKFxuICAgICAgICAvLyBDYXN0aW5nIGR1ZSB0byBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQtRE9NLWxpYi1nZW5lcmF0b3IvcHVsbC8xNDA1XG4gICAgICAgIGV2ZW50Lm9sZFZlcnNpb24sIGV2ZW50Lm5ld1ZlcnNpb24sIGV2ZW50KSk7XG4gICAgfVxuICAgIG9wZW5Qcm9taXNlXG4gICAgICAgIC50aGVuKChkYikgPT4ge1xuICAgICAgICBpZiAodGVybWluYXRlZClcbiAgICAgICAgICAgIGRiLmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgKCkgPT4gdGVybWluYXRlZCgpKTtcbiAgICAgICAgaWYgKGJsb2NraW5nKSB7XG4gICAgICAgICAgICBkYi5hZGRFdmVudExpc3RlbmVyKCd2ZXJzaW9uY2hhbmdlJywgKGV2ZW50KSA9PiBibG9ja2luZyhldmVudC5vbGRWZXJzaW9uLCBldmVudC5uZXdWZXJzaW9uLCBldmVudCkpO1xuICAgICAgICB9XG4gICAgfSlcbiAgICAgICAgLmNhdGNoKCgpID0+IHsgfSk7XG4gICAgcmV0dXJuIG9wZW5Qcm9taXNlO1xufVxuLyoqXG4gKiBEZWxldGUgYSBkYXRhYmFzZS5cbiAqXG4gKiBAcGFyYW0gbmFtZSBOYW1lIG9mIHRoZSBkYXRhYmFzZS5cbiAqL1xuZnVuY3Rpb24gZGVsZXRlREIobmFtZSwgeyBibG9ja2VkIH0gPSB7fSkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UobmFtZSk7XG4gICAgaWYgKGJsb2NrZWQpIHtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdibG9ja2VkJywgKGV2ZW50KSA9PiBibG9ja2VkKFxuICAgICAgICAvLyBDYXN0aW5nIGR1ZSB0byBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQtRE9NLWxpYi1nZW5lcmF0b3IvcHVsbC8xNDA1XG4gICAgICAgIGV2ZW50Lm9sZFZlcnNpb24sIGV2ZW50KSk7XG4gICAgfVxuICAgIHJldHVybiB3cmFwKHJlcXVlc3QpLnRoZW4oKCkgPT4gdW5kZWZpbmVkKTtcbn1cblxuY29uc3QgcmVhZE1ldGhvZHMgPSBbJ2dldCcsICdnZXRLZXknLCAnZ2V0QWxsJywgJ2dldEFsbEtleXMnLCAnY291bnQnXTtcbmNvbnN0IHdyaXRlTWV0aG9kcyA9IFsncHV0JywgJ2FkZCcsICdkZWxldGUnLCAnY2xlYXInXTtcbmNvbnN0IGNhY2hlZE1ldGhvZHMgPSBuZXcgTWFwKCk7XG5mdW5jdGlvbiBnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB7XG4gICAgaWYgKCEodGFyZ2V0IGluc3RhbmNlb2YgSURCRGF0YWJhc2UgJiZcbiAgICAgICAgIShwcm9wIGluIHRhcmdldCkgJiZcbiAgICAgICAgdHlwZW9mIHByb3AgPT09ICdzdHJpbmcnKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjYWNoZWRNZXRob2RzLmdldChwcm9wKSlcbiAgICAgICAgcmV0dXJuIGNhY2hlZE1ldGhvZHMuZ2V0KHByb3ApO1xuICAgIGNvbnN0IHRhcmdldEZ1bmNOYW1lID0gcHJvcC5yZXBsYWNlKC9Gcm9tSW5kZXgkLywgJycpO1xuICAgIGNvbnN0IHVzZUluZGV4ID0gcHJvcCAhPT0gdGFyZ2V0RnVuY05hbWU7XG4gICAgY29uc3QgaXNXcml0ZSA9IHdyaXRlTWV0aG9kcy5pbmNsdWRlcyh0YXJnZXRGdW5jTmFtZSk7XG4gICAgaWYgKFxuICAgIC8vIEJhaWwgaWYgdGhlIHRhcmdldCBkb2Vzbid0IGV4aXN0IG9uIHRoZSB0YXJnZXQuIEVnLCBnZXRBbGwgaXNuJ3QgaW4gRWRnZS5cbiAgICAhKHRhcmdldEZ1bmNOYW1lIGluICh1c2VJbmRleCA/IElEQkluZGV4IDogSURCT2JqZWN0U3RvcmUpLnByb3RvdHlwZSkgfHxcbiAgICAgICAgIShpc1dyaXRlIHx8IHJlYWRNZXRob2RzLmluY2x1ZGVzKHRhcmdldEZ1bmNOYW1lKSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBtZXRob2QgPSBhc3luYyBmdW5jdGlvbiAoc3RvcmVOYW1lLCAuLi5hcmdzKSB7XG4gICAgICAgIC8vIGlzV3JpdGUgPyAncmVhZHdyaXRlJyA6IHVuZGVmaW5lZCBnemlwcHMgYmV0dGVyLCBidXQgZmFpbHMgaW4gRWRnZSA6KFxuICAgICAgICBjb25zdCB0eCA9IHRoaXMudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBpc1dyaXRlID8gJ3JlYWR3cml0ZScgOiAncmVhZG9ubHknKTtcbiAgICAgICAgbGV0IHRhcmdldCA9IHR4LnN0b3JlO1xuICAgICAgICBpZiAodXNlSW5kZXgpXG4gICAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQuaW5kZXgoYXJncy5zaGlmdCgpKTtcbiAgICAgICAgLy8gTXVzdCByZWplY3QgaWYgb3AgcmVqZWN0cy5cbiAgICAgICAgLy8gSWYgaXQncyBhIHdyaXRlIG9wZXJhdGlvbiwgbXVzdCByZWplY3QgaWYgdHguZG9uZSByZWplY3RzLlxuICAgICAgICAvLyBNdXN0IHJlamVjdCB3aXRoIG9wIHJlamVjdGlvbiBmaXJzdC5cbiAgICAgICAgLy8gTXVzdCByZXNvbHZlIHdpdGggb3AgdmFsdWUuXG4gICAgICAgIC8vIE11c3QgaGFuZGxlIGJvdGggcHJvbWlzZXMgKG5vIHVuaGFuZGxlZCByZWplY3Rpb25zKVxuICAgICAgICByZXR1cm4gKGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgICAgICAgIHRhcmdldFt0YXJnZXRGdW5jTmFtZV0oLi4uYXJncyksXG4gICAgICAgICAgICBpc1dyaXRlICYmIHR4LmRvbmUsXG4gICAgICAgIF0pKVswXTtcbiAgICB9O1xuICAgIGNhY2hlZE1ldGhvZHMuc2V0KHByb3AsIG1ldGhvZCk7XG4gICAgcmV0dXJuIG1ldGhvZDtcbn1cbnJlcGxhY2VUcmFwcygob2xkVHJhcHMpID0+ICh7XG4gICAgLi4ub2xkVHJhcHMsXG4gICAgZ2V0OiAodGFyZ2V0LCBwcm9wLCByZWNlaXZlcikgPT4gZ2V0TWV0aG9kKHRhcmdldCwgcHJvcCkgfHwgb2xkVHJhcHMuZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpLFxuICAgIGhhczogKHRhcmdldCwgcHJvcCkgPT4gISFnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB8fCBvbGRUcmFwcy5oYXModGFyZ2V0LCBwcm9wKSxcbn0pKTtcblxuZXhwb3J0IHsgZGVsZXRlREIsIG9wZW5EQiB9O1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIENvbXBvbmVudENvbnRhaW5lcixcbiAgQ29tcG9uZW50VHlwZSxcbiAgUHJvdmlkZXIsXG4gIE5hbWVcbn0gZnJvbSAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5pbXBvcnQgeyBQbGF0Zm9ybUxvZ2dlclNlcnZpY2UsIFZlcnNpb25TZXJ2aWNlIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBQbGF0Zm9ybUxvZ2dlclNlcnZpY2VJbXBsIGltcGxlbWVudHMgUGxhdGZvcm1Mb2dnZXJTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBjb250YWluZXI6IENvbXBvbmVudENvbnRhaW5lcikge31cbiAgLy8gSW4gaW5pdGlhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3aWxsIGJlIGNhbGxlZCBieSBpbnN0YWxsYXRpb25zIG9uXG4gIC8vIGF1dGggdG9rZW4gcmVmcmVzaCwgYW5kIGluc3RhbGxhdGlvbnMgd2lsbCBzZW5kIHRoaXMgc3RyaW5nLlxuICBnZXRQbGF0Zm9ybUluZm9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICBjb25zdCBwcm92aWRlcnMgPSB0aGlzLmNvbnRhaW5lci5nZXRQcm92aWRlcnMoKTtcbiAgICAvLyBMb29wIHRocm91Z2ggcHJvdmlkZXJzIGFuZCBnZXQgbGlicmFyeS92ZXJzaW9uIHBhaXJzIGZyb20gYW55IHRoYXQgYXJlXG4gICAgLy8gdmVyc2lvbiBjb21wb25lbnRzLlxuICAgIHJldHVybiBwcm92aWRlcnNcbiAgICAgIC5tYXAocHJvdmlkZXIgPT4ge1xuICAgICAgICBpZiAoaXNWZXJzaW9uU2VydmljZVByb3ZpZGVyKHByb3ZpZGVyKSkge1xuICAgICAgICAgIGNvbnN0IHNlcnZpY2UgPSBwcm92aWRlci5nZXRJbW1lZGlhdGUoKSBhcyBWZXJzaW9uU2VydmljZTtcbiAgICAgICAgICByZXR1cm4gYCR7c2VydmljZS5saWJyYXJ5fS8ke3NlcnZpY2UudmVyc2lvbn1gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmZpbHRlcihsb2dTdHJpbmcgPT4gbG9nU3RyaW5nKVxuICAgICAgLmpvaW4oJyAnKTtcbiAgfVxufVxuLyoqXG4gKlxuICogQHBhcmFtIHByb3ZpZGVyIGNoZWNrIGlmIHRoaXMgcHJvdmlkZXIgcHJvdmlkZXMgYSBWZXJzaW9uU2VydmljZVxuICpcbiAqIE5PVEU6IFVzaW5nIFByb3ZpZGVyPCdhcHAtdmVyc2lvbic+IGlzIGEgaGFjayB0byBpbmRpY2F0ZSB0aGF0IHRoZSBwcm92aWRlclxuICogcHJvdmlkZXMgVmVyc2lvblNlcnZpY2UuIFRoZSBwcm92aWRlciBpcyBub3QgbmVjZXNzYXJpbHkgYSAnYXBwLXZlcnNpb24nXG4gKiBwcm92aWRlci5cbiAqL1xuZnVuY3Rpb24gaXNWZXJzaW9uU2VydmljZVByb3ZpZGVyKHByb3ZpZGVyOiBQcm92aWRlcjxOYW1lPik6IGJvb2xlYW4ge1xuICBjb25zdCBjb21wb25lbnQgPSBwcm92aWRlci5nZXRDb21wb25lbnQoKTtcbiAgcmV0dXJuIGNvbXBvbmVudD8udHlwZSA9PT0gQ29tcG9uZW50VHlwZS5WRVJTSU9OO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IExvZ2dlciB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcignQGZpcmViYXNlL2FwcCcpO1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IG5hbWUgYXMgYXBwTmFtZSB9IGZyb20gJy4uL3BhY2thZ2UuanNvbic7XG5pbXBvcnQgeyBuYW1lIGFzIGFwcENvbXBhdE5hbWUgfSBmcm9tICcuLi8uLi9hcHAtY29tcGF0L3BhY2thZ2UuanNvbic7XG5pbXBvcnQgeyBuYW1lIGFzIGFuYWx5dGljc0NvbXBhdE5hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9hbmFseXRpY3MtY29tcGF0L3BhY2thZ2UuanNvbic7XG5pbXBvcnQgeyBuYW1lIGFzIGFuYWx5dGljc05hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9hbmFseXRpY3MvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgYXBwQ2hlY2tDb21wYXROYW1lIH0gZnJvbSAnLi4vLi4vLi4vcGFja2FnZXMvYXBwLWNoZWNrLWNvbXBhdC9wYWNrYWdlLmpzb24nO1xuaW1wb3J0IHsgbmFtZSBhcyBhcHBDaGVja05hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9hcHAtY2hlY2svcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgYXV0aE5hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9hdXRoL3BhY2thZ2UuanNvbic7XG5pbXBvcnQgeyBuYW1lIGFzIGF1dGhDb21wYXROYW1lIH0gZnJvbSAnLi4vLi4vLi4vcGFja2FnZXMvYXV0aC1jb21wYXQvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgZGF0YWJhc2VOYW1lIH0gZnJvbSAnLi4vLi4vLi4vcGFja2FnZXMvZGF0YWJhc2UvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgZGF0YWJhc2VDb21wYXROYW1lIH0gZnJvbSAnLi4vLi4vLi4vcGFja2FnZXMvZGF0YWJhc2UtY29tcGF0L3BhY2thZ2UuanNvbic7XG5pbXBvcnQgeyBuYW1lIGFzIGZ1bmN0aW9uc05hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9mdW5jdGlvbnMvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgZnVuY3Rpb25zQ29tcGF0TmFtZSB9IGZyb20gJy4uLy4uLy4uL3BhY2thZ2VzL2Z1bmN0aW9ucy1jb21wYXQvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgaW5zdGFsbGF0aW9uc05hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9pbnN0YWxsYXRpb25zL3BhY2thZ2UuanNvbic7XG5pbXBvcnQgeyBuYW1lIGFzIGluc3RhbGxhdGlvbnNDb21wYXROYW1lIH0gZnJvbSAnLi4vLi4vLi4vcGFja2FnZXMvaW5zdGFsbGF0aW9ucy1jb21wYXQvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgbWVzc2FnaW5nTmFtZSB9IGZyb20gJy4uLy4uLy4uL3BhY2thZ2VzL21lc3NhZ2luZy9wYWNrYWdlLmpzb24nO1xuaW1wb3J0IHsgbmFtZSBhcyBtZXNzYWdpbmdDb21wYXROYW1lIH0gZnJvbSAnLi4vLi4vLi4vcGFja2FnZXMvbWVzc2FnaW5nLWNvbXBhdC9wYWNrYWdlLmpzb24nO1xuaW1wb3J0IHsgbmFtZSBhcyBwZXJmb3JtYW5jZU5hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9wZXJmb3JtYW5jZS9wYWNrYWdlLmpzb24nO1xuaW1wb3J0IHsgbmFtZSBhcyBwZXJmb3JtYW5jZUNvbXBhdE5hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9wZXJmb3JtYW5jZS1jb21wYXQvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgcmVtb3RlQ29uZmlnTmFtZSB9IGZyb20gJy4uLy4uLy4uL3BhY2thZ2VzL3JlbW90ZS1jb25maWcvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgcmVtb3RlQ29uZmlnQ29tcGF0TmFtZSB9IGZyb20gJy4uLy4uLy4uL3BhY2thZ2VzL3JlbW90ZS1jb25maWctY29tcGF0L3BhY2thZ2UuanNvbic7XG5pbXBvcnQgeyBuYW1lIGFzIHN0b3JhZ2VOYW1lIH0gZnJvbSAnLi4vLi4vLi4vcGFja2FnZXMvc3RvcmFnZS9wYWNrYWdlLmpzb24nO1xuaW1wb3J0IHsgbmFtZSBhcyBzdG9yYWdlQ29tcGF0TmFtZSB9IGZyb20gJy4uLy4uLy4uL3BhY2thZ2VzL3N0b3JhZ2UtY29tcGF0L3BhY2thZ2UuanNvbic7XG5pbXBvcnQgeyBuYW1lIGFzIGZpcmVzdG9yZU5hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9maXJlc3RvcmUvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgZmlyZXN0b3JlQ29tcGF0TmFtZSB9IGZyb20gJy4uLy4uLy4uL3BhY2thZ2VzL2ZpcmVzdG9yZS1jb21wYXQvcGFja2FnZS5qc29uJztcbmltcG9ydCB7IG5hbWUgYXMgcGFja2FnZU5hbWUgfSBmcm9tICcuLi8uLi8uLi9wYWNrYWdlcy9maXJlYmFzZS9wYWNrYWdlLmpzb24nO1xuXG4vKipcbiAqIFRoZSBkZWZhdWx0IGFwcCBuYW1lXG4gKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX0VOVFJZX05BTUUgPSAnW0RFRkFVTFRdJztcblxuZXhwb3J0IGNvbnN0IFBMQVRGT1JNX0xPR19TVFJJTkcgPSB7XG4gIFthcHBOYW1lXTogJ2ZpcmUtY29yZScsXG4gIFthcHBDb21wYXROYW1lXTogJ2ZpcmUtY29yZS1jb21wYXQnLFxuICBbYW5hbHl0aWNzTmFtZV06ICdmaXJlLWFuYWx5dGljcycsXG4gIFthbmFseXRpY3NDb21wYXROYW1lXTogJ2ZpcmUtYW5hbHl0aWNzLWNvbXBhdCcsXG4gIFthcHBDaGVja05hbWVdOiAnZmlyZS1hcHAtY2hlY2snLFxuICBbYXBwQ2hlY2tDb21wYXROYW1lXTogJ2ZpcmUtYXBwLWNoZWNrLWNvbXBhdCcsXG4gIFthdXRoTmFtZV06ICdmaXJlLWF1dGgnLFxuICBbYXV0aENvbXBhdE5hbWVdOiAnZmlyZS1hdXRoLWNvbXBhdCcsXG4gIFtkYXRhYmFzZU5hbWVdOiAnZmlyZS1ydGRiJyxcbiAgW2RhdGFiYXNlQ29tcGF0TmFtZV06ICdmaXJlLXJ0ZGItY29tcGF0JyxcbiAgW2Z1bmN0aW9uc05hbWVdOiAnZmlyZS1mbicsXG4gIFtmdW5jdGlvbnNDb21wYXROYW1lXTogJ2ZpcmUtZm4tY29tcGF0JyxcbiAgW2luc3RhbGxhdGlvbnNOYW1lXTogJ2ZpcmUtaWlkJyxcbiAgW2luc3RhbGxhdGlvbnNDb21wYXROYW1lXTogJ2ZpcmUtaWlkLWNvbXBhdCcsXG4gIFttZXNzYWdpbmdOYW1lXTogJ2ZpcmUtZmNtJyxcbiAgW21lc3NhZ2luZ0NvbXBhdE5hbWVdOiAnZmlyZS1mY20tY29tcGF0JyxcbiAgW3BlcmZvcm1hbmNlTmFtZV06ICdmaXJlLXBlcmYnLFxuICBbcGVyZm9ybWFuY2VDb21wYXROYW1lXTogJ2ZpcmUtcGVyZi1jb21wYXQnLFxuICBbcmVtb3RlQ29uZmlnTmFtZV06ICdmaXJlLXJjJyxcbiAgW3JlbW90ZUNvbmZpZ0NvbXBhdE5hbWVdOiAnZmlyZS1yYy1jb21wYXQnLFxuICBbc3RvcmFnZU5hbWVdOiAnZmlyZS1nY3MnLFxuICBbc3RvcmFnZUNvbXBhdE5hbWVdOiAnZmlyZS1nY3MtY29tcGF0JyxcbiAgW2ZpcmVzdG9yZU5hbWVdOiAnZmlyZS1mc3QnLFxuICBbZmlyZXN0b3JlQ29tcGF0TmFtZV06ICdmaXJlLWZzdC1jb21wYXQnLFxuICAnZmlyZS1qcyc6ICdmaXJlLWpzJywgLy8gUGxhdGZvcm0gaWRlbnRpZmllciBmb3IgSlMgU0RLLlxuICBbcGFja2FnZU5hbWVdOiAnZmlyZS1qcy1hbGwnXG59IGFzIGNvbnN0O1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEZpcmViYXNlQXBwIH0gZnJvbSAnLi9wdWJsaWMtdHlwZXMnO1xuaW1wb3J0IHsgQ29tcG9uZW50LCBQcm92aWRlciwgTmFtZSB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgREVGQVVMVF9FTlRSWV9OQU1FIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgRmlyZWJhc2VBcHBJbXBsIH0gZnJvbSAnLi9maXJlYmFzZUFwcCc7XG5cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBjb25zdCBfYXBwcyA9IG5ldyBNYXA8c3RyaW5nLCBGaXJlYmFzZUFwcD4oKTtcblxuLyoqXG4gKiBSZWdpc3RlcmVkIGNvbXBvbmVudHMuXG4gKlxuICogQGludGVybmFsXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5leHBvcnQgY29uc3QgX2NvbXBvbmVudHMgPSBuZXcgTWFwPHN0cmluZywgQ29tcG9uZW50PGFueT4+KCk7XG5cbi8qKlxuICogQHBhcmFtIGNvbXBvbmVudCAtIHRoZSBjb21wb25lbnQgYmVpbmcgYWRkZWQgdG8gdGhpcyBhcHAncyBjb250YWluZXJcbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9hZGRDb21wb25lbnQ8VCBleHRlbmRzIE5hbWU+KFxuICBhcHA6IEZpcmViYXNlQXBwLFxuICBjb21wb25lbnQ6IENvbXBvbmVudDxUPlxuKTogdm9pZCB7XG4gIHRyeSB7XG4gICAgKGFwcCBhcyBGaXJlYmFzZUFwcEltcGwpLmNvbnRhaW5lci5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZ2dlci5kZWJ1ZyhcbiAgICAgIGBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gZmFpbGVkIHRvIHJlZ2lzdGVyIHdpdGggRmlyZWJhc2VBcHAgJHthcHAubmFtZX1gLFxuICAgICAgZVxuICAgICk7XG4gIH1cbn1cblxuLyoqXG4gKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBfYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoXG4gIGFwcDogRmlyZWJhc2VBcHAsXG4gIGNvbXBvbmVudDogQ29tcG9uZW50XG4pOiB2b2lkIHtcbiAgKGFwcCBhcyBGaXJlYmFzZUFwcEltcGwpLmNvbnRhaW5lci5hZGRPck92ZXJ3cml0ZUNvbXBvbmVudChjb21wb25lbnQpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0gY29tcG9uZW50IC0gdGhlIGNvbXBvbmVudCB0byByZWdpc3RlclxuICogQHJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGNvbXBvbmVudCBpcyByZWdpc3RlcmVkIHN1Y2Nlc3NmdWxseVxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgZnVuY3Rpb24gX3JlZ2lzdGVyQ29tcG9uZW50PFQgZXh0ZW5kcyBOYW1lPihcbiAgY29tcG9uZW50OiBDb21wb25lbnQ8VD5cbik6IGJvb2xlYW4ge1xuICBjb25zdCBjb21wb25lbnROYW1lID0gY29tcG9uZW50Lm5hbWU7XG4gIGlmIChfY29tcG9uZW50cy5oYXMoY29tcG9uZW50TmFtZSkpIHtcbiAgICBsb2dnZXIuZGVidWcoXG4gICAgICBgVGhlcmUgd2VyZSBtdWx0aXBsZSBhdHRlbXB0cyB0byByZWdpc3RlciBjb21wb25lbnQgJHtjb21wb25lbnROYW1lfS5gXG4gICAgKTtcblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIF9jb21wb25lbnRzLnNldChjb21wb25lbnROYW1lLCBjb21wb25lbnQpO1xuXG4gIC8vIGFkZCB0aGUgY29tcG9uZW50IHRvIGV4aXN0aW5nIGFwcCBpbnN0YW5jZXNcbiAgZm9yIChjb25zdCBhcHAgb2YgX2FwcHMudmFsdWVzKCkpIHtcbiAgICBfYWRkQ29tcG9uZW50KGFwcCBhcyBGaXJlYmFzZUFwcEltcGwsIGNvbXBvbmVudCk7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlQXBwIGluc3RhbmNlXG4gKiBAcGFyYW0gbmFtZSAtIHNlcnZpY2UgbmFtZVxuICpcbiAqIEByZXR1cm5zIHRoZSBwcm92aWRlciBmb3IgdGhlIHNlcnZpY2Ugd2l0aCB0aGUgbWF0Y2hpbmcgbmFtZVxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgZnVuY3Rpb24gX2dldFByb3ZpZGVyPFQgZXh0ZW5kcyBOYW1lPihcbiAgYXBwOiBGaXJlYmFzZUFwcCxcbiAgbmFtZTogVFxuKTogUHJvdmlkZXI8VD4ge1xuICBjb25zdCBoZWFydGJlYXRDb250cm9sbGVyID0gKGFwcCBhcyBGaXJlYmFzZUFwcEltcGwpLmNvbnRhaW5lclxuICAgIC5nZXRQcm92aWRlcignaGVhcnRiZWF0JylcbiAgICAuZ2V0SW1tZWRpYXRlKHsgb3B0aW9uYWw6IHRydWUgfSk7XG4gIGlmIChoZWFydGJlYXRDb250cm9sbGVyKSB7XG4gICAgdm9pZCBoZWFydGJlYXRDb250cm9sbGVyLnRyaWdnZXJIZWFydGJlYXQoKTtcbiAgfVxuICByZXR1cm4gKGFwcCBhcyBGaXJlYmFzZUFwcEltcGwpLmNvbnRhaW5lci5nZXRQcm92aWRlcihuYW1lKTtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlQXBwIGluc3RhbmNlXG4gKiBAcGFyYW0gbmFtZSAtIHNlcnZpY2UgbmFtZVxuICogQHBhcmFtIGluc3RhbmNlSWRlbnRpZmllciAtIHNlcnZpY2UgaW5zdGFuY2UgaWRlbnRpZmllciBpbiBjYXNlIHRoZSBzZXJ2aWNlIHN1cHBvcnRzIG11bHRpcGxlIGluc3RhbmNlc1xuICpcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgZnVuY3Rpb24gX3JlbW92ZVNlcnZpY2VJbnN0YW5jZTxUIGV4dGVuZHMgTmFtZT4oXG4gIGFwcDogRmlyZWJhc2VBcHAsXG4gIG5hbWU6IFQsXG4gIGluc3RhbmNlSWRlbnRpZmllcjogc3RyaW5nID0gREVGQVVMVF9FTlRSWV9OQU1FXG4pOiB2b2lkIHtcbiAgX2dldFByb3ZpZGVyKGFwcCwgbmFtZSkuY2xlYXJJbnN0YW5jZShpbnN0YW5jZUlkZW50aWZpZXIpO1xufVxuXG4vKipcbiAqIFRlc3Qgb25seVxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgZnVuY3Rpb24gX2NsZWFyQ29tcG9uZW50cygpOiB2b2lkIHtcbiAgX2NvbXBvbmVudHMuY2xlYXIoKTtcbn1cblxuLyoqXG4gKiBFeHBvcnRlZCBpbiBvcmRlciB0byBiZSB1c2VkIGluIGFwcC1jb21wYXQgcGFja2FnZVxuICovXG5leHBvcnQgeyBERUZBVUxUX0VOVFJZX05BTUUgYXMgX0RFRkFVTFRfRU5UUllfTkFNRSB9O1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEVycm9yRmFjdG9yeSwgRXJyb3JNYXAgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbmV4cG9ydCBjb25zdCBlbnVtIEFwcEVycm9yIHtcbiAgTk9fQVBQID0gJ25vLWFwcCcsXG4gIEJBRF9BUFBfTkFNRSA9ICdiYWQtYXBwLW5hbWUnLFxuICBEVVBMSUNBVEVfQVBQID0gJ2R1cGxpY2F0ZS1hcHAnLFxuICBBUFBfREVMRVRFRCA9ICdhcHAtZGVsZXRlZCcsXG4gIE5PX09QVElPTlMgPSAnbm8tb3B0aW9ucycsXG4gIElOVkFMSURfQVBQX0FSR1VNRU5UID0gJ2ludmFsaWQtYXBwLWFyZ3VtZW50JyxcbiAgSU5WQUxJRF9MT0dfQVJHVU1FTlQgPSAnaW52YWxpZC1sb2ctYXJndW1lbnQnLFxuICBJREJfT1BFTiA9ICdpZGItb3BlbicsXG4gIElEQl9HRVQgPSAnaWRiLWdldCcsXG4gIElEQl9XUklURSA9ICdpZGItc2V0JyxcbiAgSURCX0RFTEVURSA9ICdpZGItZGVsZXRlJ1xufVxuXG5jb25zdCBFUlJPUlM6IEVycm9yTWFwPEFwcEVycm9yPiA9IHtcbiAgW0FwcEVycm9yLk5PX0FQUF06XG4gICAgXCJObyBGaXJlYmFzZSBBcHAgJ3skYXBwTmFtZX0nIGhhcyBiZWVuIGNyZWF0ZWQgLSBcIiArXG4gICAgJ2NhbGwgaW5pdGlhbGl6ZUFwcCgpIGZpcnN0JyxcbiAgW0FwcEVycm9yLkJBRF9BUFBfTkFNRV06IFwiSWxsZWdhbCBBcHAgbmFtZTogJ3skYXBwTmFtZX1cIixcbiAgW0FwcEVycm9yLkRVUExJQ0FURV9BUFBdOlxuICAgIFwiRmlyZWJhc2UgQXBwIG5hbWVkICd7JGFwcE5hbWV9JyBhbHJlYWR5IGV4aXN0cyB3aXRoIGRpZmZlcmVudCBvcHRpb25zIG9yIGNvbmZpZ1wiLFxuICBbQXBwRXJyb3IuQVBQX0RFTEVURURdOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBkZWxldGVkXCIsXG4gIFtBcHBFcnJvci5OT19PUFRJT05TXTpcbiAgICAnTmVlZCB0byBwcm92aWRlIG9wdGlvbnMsIHdoZW4gbm90IGJlaW5nIGRlcGxveWVkIHRvIGhvc3RpbmcgdmlhIHNvdXJjZS4nLFxuICBbQXBwRXJyb3IuSU5WQUxJRF9BUFBfQVJHVU1FTlRdOlxuICAgICdmaXJlYmFzZS57JGFwcE5hbWV9KCkgdGFrZXMgZWl0aGVyIG5vIGFyZ3VtZW50IG9yIGEgJyArXG4gICAgJ0ZpcmViYXNlIEFwcCBpbnN0YW5jZS4nLFxuICBbQXBwRXJyb3IuSU5WQUxJRF9MT0dfQVJHVU1FTlRdOlxuICAgICdGaXJzdCBhcmd1bWVudCB0byBgb25Mb2dgIG11c3QgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLicsXG4gIFtBcHBFcnJvci5JREJfT1BFTl06XG4gICAgJ0Vycm9yIHRocm93biB3aGVuIG9wZW5pbmcgSW5kZXhlZERCLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJyxcbiAgW0FwcEVycm9yLklEQl9HRVRdOlxuICAgICdFcnJvciB0aHJvd24gd2hlbiByZWFkaW5nIGZyb20gSW5kZXhlZERCLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJyxcbiAgW0FwcEVycm9yLklEQl9XUklURV06XG4gICAgJ0Vycm9yIHRocm93biB3aGVuIHdyaXRpbmcgdG8gSW5kZXhlZERCLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJyxcbiAgW0FwcEVycm9yLklEQl9ERUxFVEVdOlxuICAgICdFcnJvciB0aHJvd24gd2hlbiBkZWxldGluZyBmcm9tIEluZGV4ZWREQi4gT3JpZ2luYWwgZXJyb3I6IHskb3JpZ2luYWxFcnJvck1lc3NhZ2V9Lidcbn07XG5cbmludGVyZmFjZSBFcnJvclBhcmFtcyB7XG4gIFtBcHBFcnJvci5OT19BUFBdOiB7IGFwcE5hbWU6IHN0cmluZyB9O1xuICBbQXBwRXJyb3IuQkFEX0FQUF9OQU1FXTogeyBhcHBOYW1lOiBzdHJpbmcgfTtcbiAgW0FwcEVycm9yLkRVUExJQ0FURV9BUFBdOiB7IGFwcE5hbWU6IHN0cmluZyB9O1xuICBbQXBwRXJyb3IuQVBQX0RFTEVURURdOiB7IGFwcE5hbWU6IHN0cmluZyB9O1xuICBbQXBwRXJyb3IuSU5WQUxJRF9BUFBfQVJHVU1FTlRdOiB7IGFwcE5hbWU6IHN0cmluZyB9O1xuICBbQXBwRXJyb3IuSURCX09QRU5dOiB7IG9yaWdpbmFsRXJyb3JNZXNzYWdlPzogc3RyaW5nIH07XG4gIFtBcHBFcnJvci5JREJfR0VUXTogeyBvcmlnaW5hbEVycm9yTWVzc2FnZT86IHN0cmluZyB9O1xuICBbQXBwRXJyb3IuSURCX1dSSVRFXTogeyBvcmlnaW5hbEVycm9yTWVzc2FnZT86IHN0cmluZyB9O1xuICBbQXBwRXJyb3IuSURCX0RFTEVURV06IHsgb3JpZ2luYWxFcnJvck1lc3NhZ2U/OiBzdHJpbmcgfTtcbn1cblxuZXhwb3J0IGNvbnN0IEVSUk9SX0ZBQ1RPUlkgPSBuZXcgRXJyb3JGYWN0b3J5PEFwcEVycm9yLCBFcnJvclBhcmFtcz4oXG4gICdhcHAnLFxuICAnRmlyZWJhc2UnLFxuICBFUlJPUlNcbik7XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgRmlyZWJhc2VBcHAsXG4gIEZpcmViYXNlT3B0aW9ucyxcbiAgRmlyZWJhc2VBcHBTZXR0aW5nc1xufSBmcm9tICcuL3B1YmxpYy10eXBlcyc7XG5pbXBvcnQge1xuICBDb21wb25lbnRDb250YWluZXIsXG4gIENvbXBvbmVudCxcbiAgQ29tcG9uZW50VHlwZVxufSBmcm9tICdAZmlyZWJhc2UvY29tcG9uZW50JztcbmltcG9ydCB7IEVSUk9SX0ZBQ1RPUlksIEFwcEVycm9yIH0gZnJvbSAnLi9lcnJvcnMnO1xuXG5leHBvcnQgY2xhc3MgRmlyZWJhc2VBcHBJbXBsIGltcGxlbWVudHMgRmlyZWJhc2VBcHAge1xuICBwcml2YXRlIHJlYWRvbmx5IF9vcHRpb25zOiBGaXJlYmFzZU9wdGlvbnM7XG4gIHByaXZhdGUgcmVhZG9ubHkgX25hbWU6IHN0cmluZztcbiAgLyoqXG4gICAqIE9yaWdpbmFsIGNvbmZpZyB2YWx1ZXMgcGFzc2VkIGluIGFzIGEgY29uc3RydWN0b3IgcGFyYW1ldGVyLlxuICAgKiBJdCBpcyBvbmx5IHVzZWQgdG8gY29tcGFyZSB3aXRoIGFub3RoZXIgY29uZmlnIG9iamVjdCB0byBzdXBwb3J0IGlkZW1wb3RlbnQgaW5pdGlhbGl6ZUFwcCgpLlxuICAgKlxuICAgKiBVcGRhdGluZyBhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQgb24gdGhlIEFwcCBpbnN0YW5jZSB3aWxsIG5vdCBjaGFuZ2UgaXRzIHZhbHVlIGluIF9jb25maWcuXG4gICAqL1xuICBwcml2YXRlIHJlYWRvbmx5IF9jb25maWc6IFJlcXVpcmVkPEZpcmViYXNlQXBwU2V0dGluZ3M+O1xuICBwcml2YXRlIF9hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ6IGJvb2xlYW47XG4gIHByaXZhdGUgX2lzRGVsZXRlZCA9IGZhbHNlO1xuICBwcml2YXRlIHJlYWRvbmx5IF9jb250YWluZXI6IENvbXBvbmVudENvbnRhaW5lcjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBvcHRpb25zOiBGaXJlYmFzZU9wdGlvbnMsXG4gICAgY29uZmlnOiBSZXF1aXJlZDxGaXJlYmFzZUFwcFNldHRpbmdzPixcbiAgICBjb250YWluZXI6IENvbXBvbmVudENvbnRhaW5lclxuICApIHtcbiAgICB0aGlzLl9vcHRpb25zID0geyAuLi5vcHRpb25zIH07XG4gICAgdGhpcy5fY29uZmlnID0geyAuLi5jb25maWcgfTtcbiAgICB0aGlzLl9uYW1lID0gY29uZmlnLm5hbWU7XG4gICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID1cbiAgICAgIGNvbmZpZy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ7XG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xuICAgIHRoaXMuY29udGFpbmVyLmFkZENvbXBvbmVudChcbiAgICAgIG5ldyBDb21wb25lbnQoJ2FwcCcsICgpID0+IHRoaXMsIENvbXBvbmVudFR5cGUuUFVCTElDKVxuICAgICk7XG4gIH1cblxuICBnZXQgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkO1xuICB9XG5cbiAgc2V0IGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCh2YWw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XG4gICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID0gdmFsO1xuICB9XG5cbiAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XG4gICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gIH1cblxuICBnZXQgb3B0aW9ucygpOiBGaXJlYmFzZU9wdGlvbnMge1xuICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5fb3B0aW9ucztcbiAgfVxuXG4gIGdldCBjb25maWcoKTogUmVxdWlyZWQ8RmlyZWJhc2VBcHBTZXR0aW5ncz4ge1xuICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcbiAgICByZXR1cm4gdGhpcy5fY29uZmlnO1xuICB9XG5cbiAgZ2V0IGNvbnRhaW5lcigpOiBDb21wb25lbnRDb250YWluZXIge1xuICAgIHJldHVybiB0aGlzLl9jb250YWluZXI7XG4gIH1cblxuICBnZXQgaXNEZWxldGVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9pc0RlbGV0ZWQ7XG4gIH1cblxuICBzZXQgaXNEZWxldGVkKHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuX2lzRGVsZXRlZCA9IHZhbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgdGhyb3cgYW4gRXJyb3IgaWYgdGhlIEFwcCBoYXMgYWxyZWFkeSBiZWVuIGRlbGV0ZWQgLVxuICAgKiB1c2UgYmVmb3JlIHBlcmZvcm1pbmcgQVBJIGFjdGlvbnMgb24gdGhlIEFwcC5cbiAgICovXG4gIHByaXZhdGUgY2hlY2tEZXN0cm95ZWQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNEZWxldGVkKSB7XG4gICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShBcHBFcnJvci5BUFBfREVMRVRFRCwgeyBhcHBOYW1lOiB0aGlzLl9uYW1lIH0pO1xuICAgIH1cbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEZpcmViYXNlQXBwLFxuICBGaXJlYmFzZU9wdGlvbnMsXG4gIEZpcmViYXNlQXBwU2V0dGluZ3Ncbn0gZnJvbSAnLi9wdWJsaWMtdHlwZXMnO1xuaW1wb3J0IHsgREVGQVVMVF9FTlRSWV9OQU1FLCBQTEFURk9STV9MT0dfU1RSSU5HIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHsgRVJST1JfRkFDVE9SWSwgQXBwRXJyb3IgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQge1xuICBDb21wb25lbnRDb250YWluZXIsXG4gIENvbXBvbmVudCxcbiAgTmFtZSxcbiAgQ29tcG9uZW50VHlwZVxufSBmcm9tICdAZmlyZWJhc2UvY29tcG9uZW50JztcbmltcG9ydCB7IHZlcnNpb24gfSBmcm9tICcuLi8uLi9maXJlYmFzZS9wYWNrYWdlLmpzb24nO1xuaW1wb3J0IHsgRmlyZWJhc2VBcHBJbXBsIH0gZnJvbSAnLi9maXJlYmFzZUFwcCc7XG5pbXBvcnQgeyBfYXBwcywgX2NvbXBvbmVudHMsIF9yZWdpc3RlckNvbXBvbmVudCB9IGZyb20gJy4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHtcbiAgTG9nTGV2ZWxTdHJpbmcsXG4gIHNldExvZ0xldmVsIGFzIHNldExvZ0xldmVsSW1wbCxcbiAgTG9nQ2FsbGJhY2ssXG4gIExvZ09wdGlvbnMsXG4gIHNldFVzZXJMb2dIYW5kbGVyXG59IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgZGVlcEVxdWFsLCBnZXREZWZhdWx0QXBwQ29uZmlnIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5leHBvcnQgeyBGaXJlYmFzZUVycm9yIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKipcbiAqIFRoZSBjdXJyZW50IFNESyB2ZXJzaW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IFNES19WRVJTSU9OID0gdmVyc2lvbjtcblxuLyoqXG4gKiBDcmVhdGVzIGFuZCBpbml0aWFsaXplcyBhIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfSBpbnN0YW5jZS5cbiAqXG4gKiBTZWVcbiAqIHtAbGlua1xuICogICBodHRwczovL2ZpcmViYXNlLmdvb2dsZS5jb20vZG9jcy93ZWIvc2V0dXAjYWRkX2ZpcmViYXNlX3RvX3lvdXJfYXBwXG4gKiAgIHwgQWRkIEZpcmViYXNlIHRvIHlvdXIgYXBwfSBhbmRcbiAqIHtAbGlua1xuICogICBodHRwczovL2ZpcmViYXNlLmdvb2dsZS5jb20vZG9jcy93ZWIvc2V0dXAjbXVsdGlwbGUtcHJvamVjdHNcbiAqICAgfCBJbml0aWFsaXplIG11bHRpcGxlIHByb2plY3RzfSBmb3IgZGV0YWlsZWQgZG9jdW1lbnRhdGlvbi5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICpcbiAqIC8vIEluaXRpYWxpemUgZGVmYXVsdCBhcHBcbiAqIC8vIFJldHJpZXZlIHlvdXIgb3duIG9wdGlvbnMgdmFsdWVzIGJ5IGFkZGluZyBhIHdlYiBhcHAgb25cbiAqIC8vIGh0dHBzOi8vY29uc29sZS5maXJlYmFzZS5nb29nbGUuY29tXG4gKiBpbml0aWFsaXplQXBwKHtcbiAqICAgYXBpS2V5OiBcIkFJemEuLi4uXCIsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBdXRoIC8gR2VuZXJhbCBVc2VcbiAqICAgYXV0aERvbWFpbjogXCJZT1VSX0FQUC5maXJlYmFzZWFwcC5jb21cIiwgICAgICAgICAvLyBBdXRoIHdpdGggcG9wdXAvcmVkaXJlY3RcbiAqICAgZGF0YWJhc2VVUkw6IFwiaHR0cHM6Ly9ZT1VSX0FQUC5maXJlYmFzZWlvLmNvbVwiLCAvLyBSZWFsdGltZSBEYXRhYmFzZVxuICogICBzdG9yYWdlQnVja2V0OiBcIllPVVJfQVBQLmFwcHNwb3QuY29tXCIsICAgICAgICAgIC8vIFN0b3JhZ2VcbiAqICAgbWVzc2FnaW5nU2VuZGVySWQ6IFwiMTIzNDU2Nzg5XCIgICAgICAgICAgICAgICAgICAvLyBDbG91ZCBNZXNzYWdpbmdcbiAqIH0pO1xuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqXG4gKiAvLyBJbml0aWFsaXplIGFub3RoZXIgYXBwXG4gKiBjb25zdCBvdGhlckFwcCA9IGluaXRpYWxpemVBcHAoe1xuICogICBkYXRhYmFzZVVSTDogXCJodHRwczovLzxPVEhFUl9EQVRBQkFTRV9OQU1FPi5maXJlYmFzZWlvLmNvbVwiLFxuICogICBzdG9yYWdlQnVja2V0OiBcIjxPVEhFUl9TVE9SQUdFX0JVQ0tFVD4uYXBwc3BvdC5jb21cIlxuICogfSwgXCJvdGhlckFwcFwiKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9ucyB0byBjb25maWd1cmUgdGhlIGFwcCdzIHNlcnZpY2VzLlxuICogQHBhcmFtIG5hbWUgLSBPcHRpb25hbCBuYW1lIG9mIHRoZSBhcHAgdG8gaW5pdGlhbGl6ZS4gSWYgbm8gbmFtZVxuICogICBpcyBwcm92aWRlZCwgdGhlIGRlZmF1bHQgaXMgYFwiW0RFRkFVTFRdXCJgLlxuICpcbiAqIEByZXR1cm5zIFRoZSBpbml0aWFsaXplZCBhcHAuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZUFwcChcbiAgb3B0aW9uczogRmlyZWJhc2VPcHRpb25zLFxuICBuYW1lPzogc3RyaW5nXG4pOiBGaXJlYmFzZUFwcDtcbi8qKlxuICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYSBGaXJlYmFzZUFwcCBpbnN0YW5jZS5cbiAqXG4gKiBAcGFyYW0gb3B0aW9ucyAtIE9wdGlvbnMgdG8gY29uZmlndXJlIHRoZSBhcHAncyBzZXJ2aWNlcy5cbiAqIEBwYXJhbSBjb25maWcgLSBGaXJlYmFzZUFwcCBDb25maWd1cmF0aW9uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZUFwcChcbiAgb3B0aW9uczogRmlyZWJhc2VPcHRpb25zLFxuICBjb25maWc/OiBGaXJlYmFzZUFwcFNldHRpbmdzXG4pOiBGaXJlYmFzZUFwcDtcbi8qKlxuICogQ3JlYXRlcyBhbmQgaW5pdGlhbGl6ZXMgYSBGaXJlYmFzZUFwcCBpbnN0YW5jZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplQXBwKCk6IEZpcmViYXNlQXBwO1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVBcHAoXG4gIF9vcHRpb25zPzogRmlyZWJhc2VPcHRpb25zLFxuICByYXdDb25maWcgPSB7fVxuKTogRmlyZWJhc2VBcHAge1xuICBsZXQgb3B0aW9ucyA9IF9vcHRpb25zO1xuXG4gIGlmICh0eXBlb2YgcmF3Q29uZmlnICE9PSAnb2JqZWN0Jykge1xuICAgIGNvbnN0IG5hbWUgPSByYXdDb25maWc7XG4gICAgcmF3Q29uZmlnID0geyBuYW1lIH07XG4gIH1cblxuICBjb25zdCBjb25maWc6IFJlcXVpcmVkPEZpcmViYXNlQXBwU2V0dGluZ3M+ID0ge1xuICAgIG5hbWU6IERFRkFVTFRfRU5UUllfTkFNRSxcbiAgICBhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ6IGZhbHNlLFxuICAgIC4uLnJhd0NvbmZpZ1xuICB9O1xuICBjb25zdCBuYW1lID0gY29uZmlnLm5hbWU7XG5cbiAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJyB8fCAhbmFtZSkge1xuICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKEFwcEVycm9yLkJBRF9BUFBfTkFNRSwge1xuICAgICAgYXBwTmFtZTogU3RyaW5nKG5hbWUpXG4gICAgfSk7XG4gIH1cblxuICBvcHRpb25zIHx8PSBnZXREZWZhdWx0QXBwQ29uZmlnKCk7XG5cbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoQXBwRXJyb3IuTk9fT1BUSU9OUyk7XG4gIH1cblxuICBjb25zdCBleGlzdGluZ0FwcCA9IF9hcHBzLmdldChuYW1lKSBhcyBGaXJlYmFzZUFwcEltcGw7XG4gIGlmIChleGlzdGluZ0FwcCkge1xuICAgIC8vIHJldHVybiB0aGUgZXhpc3RpbmcgYXBwIGlmIG9wdGlvbnMgYW5kIGNvbmZpZyBkZWVwIGVxdWFsIHRoZSBvbmVzIGluIHRoZSBleGlzdGluZyBhcHAuXG4gICAgaWYgKFxuICAgICAgZGVlcEVxdWFsKG9wdGlvbnMsIGV4aXN0aW5nQXBwLm9wdGlvbnMpICYmXG4gICAgICBkZWVwRXF1YWwoY29uZmlnLCBleGlzdGluZ0FwcC5jb25maWcpXG4gICAgKSB7XG4gICAgICByZXR1cm4gZXhpc3RpbmdBcHA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKEFwcEVycm9yLkRVUExJQ0FURV9BUFAsIHsgYXBwTmFtZTogbmFtZSB9KTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBjb250YWluZXIgPSBuZXcgQ29tcG9uZW50Q29udGFpbmVyKG5hbWUpO1xuICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiBfY29tcG9uZW50cy52YWx1ZXMoKSkge1xuICAgIGNvbnRhaW5lci5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcbiAgfVxuXG4gIGNvbnN0IG5ld0FwcCA9IG5ldyBGaXJlYmFzZUFwcEltcGwob3B0aW9ucywgY29uZmlnLCBjb250YWluZXIpO1xuXG4gIF9hcHBzLnNldChuYW1lLCBuZXdBcHApO1xuXG4gIHJldHVybiBuZXdBcHA7XG59XG5cbi8qKlxuICogUmV0cmlldmVzIGEge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VBcHB9IGluc3RhbmNlLlxuICpcbiAqIFdoZW4gY2FsbGVkIHdpdGggbm8gYXJndW1lbnRzLCB0aGUgZGVmYXVsdCBhcHAgaXMgcmV0dXJuZWQuIFdoZW4gYW4gYXBwIG5hbWVcbiAqIGlzIHByb3ZpZGVkLCB0aGUgYXBwIGNvcnJlc3BvbmRpbmcgdG8gdGhhdCBuYW1lIGlzIHJldHVybmVkLlxuICpcbiAqIEFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gaWYgdGhlIGFwcCBiZWluZyByZXRyaWV2ZWQgaGFzIG5vdCB5ZXQgYmVlblxuICogaW5pdGlhbGl6ZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFJldHVybiB0aGUgZGVmYXVsdCBhcHBcbiAqIGNvbnN0IGFwcCA9IGdldEFwcCgpO1xuICogYGBgXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFJldHVybiBhIG5hbWVkIGFwcFxuICogY29uc3Qgb3RoZXJBcHAgPSBnZXRBcHAoXCJvdGhlckFwcFwiKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBuYW1lIC0gT3B0aW9uYWwgbmFtZSBvZiB0aGUgYXBwIHRvIHJldHVybi4gSWYgbm8gbmFtZSBpc1xuICogICBwcm92aWRlZCwgdGhlIGRlZmF1bHQgaXMgYFwiW0RFRkFVTFRdXCJgLlxuICpcbiAqIEByZXR1cm5zIFRoZSBhcHAgY29ycmVzcG9uZGluZyB0byB0aGUgcHJvdmlkZWQgYXBwIG5hbWUuXG4gKiAgIElmIG5vIGFwcCBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgZGVmYXVsdCBhcHAgaXMgcmV0dXJuZWQuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXBwKG5hbWU6IHN0cmluZyA9IERFRkFVTFRfRU5UUllfTkFNRSk6IEZpcmViYXNlQXBwIHtcbiAgY29uc3QgYXBwID0gX2FwcHMuZ2V0KG5hbWUpO1xuICBpZiAoIWFwcCAmJiBuYW1lID09PSBERUZBVUxUX0VOVFJZX05BTUUgJiYgZ2V0RGVmYXVsdEFwcENvbmZpZygpKSB7XG4gICAgcmV0dXJuIGluaXRpYWxpemVBcHAoKTtcbiAgfVxuICBpZiAoIWFwcCkge1xuICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKEFwcEVycm9yLk5PX0FQUCwgeyBhcHBOYW1lOiBuYW1lIH0pO1xuICB9XG5cbiAgcmV0dXJuIGFwcDtcbn1cblxuLyoqXG4gKiBBIChyZWFkLW9ubHkpIGFycmF5IG9mIGFsbCBpbml0aWFsaXplZCBhcHBzLlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0QXBwcygpOiBGaXJlYmFzZUFwcFtdIHtcbiAgcmV0dXJuIEFycmF5LmZyb20oX2FwcHMudmFsdWVzKCkpO1xufVxuXG4vKipcbiAqIFJlbmRlcnMgdGhpcyBhcHAgdW51c2FibGUgYW5kIGZyZWVzIHRoZSByZXNvdXJjZXMgb2YgYWxsIGFzc29jaWF0ZWRcbiAqIHNlcnZpY2VzLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBkZWxldGVBcHAoYXBwKVxuICogICAudGhlbihmdW5jdGlvbigpIHtcbiAqICAgICBjb25zb2xlLmxvZyhcIkFwcCBkZWxldGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAqICAgfSlcbiAqICAgLmNhdGNoKGZ1bmN0aW9uKGVycm9yKSB7XG4gKiAgICAgY29uc29sZS5sb2coXCJFcnJvciBkZWxldGluZyBhcHA6XCIsIGVycm9yKTtcbiAqICAgfSk7XG4gKiBgYGBcbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVBcHAoYXBwOiBGaXJlYmFzZUFwcCk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBuYW1lID0gYXBwLm5hbWU7XG4gIGlmIChfYXBwcy5oYXMobmFtZSkpIHtcbiAgICBfYXBwcy5kZWxldGUobmFtZSk7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAoYXBwIGFzIEZpcmViYXNlQXBwSW1wbCkuY29udGFpbmVyXG4gICAgICAgIC5nZXRQcm92aWRlcnMoKVxuICAgICAgICAubWFwKHByb3ZpZGVyID0+IHByb3ZpZGVyLmRlbGV0ZSgpKVxuICAgICk7XG4gICAgKGFwcCBhcyBGaXJlYmFzZUFwcEltcGwpLmlzRGVsZXRlZCA9IHRydWU7XG4gIH1cbn1cblxuLyoqXG4gKiBSZWdpc3RlcnMgYSBsaWJyYXJ5J3MgbmFtZSBhbmQgdmVyc2lvbiBmb3IgcGxhdGZvcm0gbG9nZ2luZyBwdXJwb3Nlcy5cbiAqIEBwYXJhbSBsaWJyYXJ5IC0gTmFtZSBvZiAxcCBvciAzcCBsaWJyYXJ5IChlLmcuIGZpcmVzdG9yZSwgYW5ndWxhcmZpcmUpXG4gKiBAcGFyYW0gdmVyc2lvbiAtIEN1cnJlbnQgdmVyc2lvbiBvZiB0aGF0IGxpYnJhcnkuXG4gKiBAcGFyYW0gdmFyaWFudCAtIEJ1bmRsZSB2YXJpYW50LCBlLmcuLCBub2RlLCBybiwgZXRjLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyVmVyc2lvbihcbiAgbGlicmFyeUtleU9yTmFtZTogc3RyaW5nLFxuICB2ZXJzaW9uOiBzdHJpbmcsXG4gIHZhcmlhbnQ/OiBzdHJpbmdcbik6IHZvaWQge1xuICAvLyBUT0RPOiBXZSBjYW4gdXNlIHRoaXMgY2hlY2sgdG8gd2hpdGVsaXN0IHN0cmluZ3Mgd2hlbi9pZiB3ZSBzZXQgdXBcbiAgLy8gYSBnb29kIHdoaXRlbGlzdCBzeXN0ZW0uXG4gIGxldCBsaWJyYXJ5ID0gUExBVEZPUk1fTE9HX1NUUklOR1tsaWJyYXJ5S2V5T3JOYW1lXSA/PyBsaWJyYXJ5S2V5T3JOYW1lO1xuICBpZiAodmFyaWFudCkge1xuICAgIGxpYnJhcnkgKz0gYC0ke3ZhcmlhbnR9YDtcbiAgfVxuICBjb25zdCBsaWJyYXJ5TWlzbWF0Y2ggPSBsaWJyYXJ5Lm1hdGNoKC9cXHN8XFwvLyk7XG4gIGNvbnN0IHZlcnNpb25NaXNtYXRjaCA9IHZlcnNpb24ubWF0Y2goL1xcc3xcXC8vKTtcbiAgaWYgKGxpYnJhcnlNaXNtYXRjaCB8fCB2ZXJzaW9uTWlzbWF0Y2gpIHtcbiAgICBjb25zdCB3YXJuaW5nID0gW1xuICAgICAgYFVuYWJsZSB0byByZWdpc3RlciBsaWJyYXJ5IFwiJHtsaWJyYXJ5fVwiIHdpdGggdmVyc2lvbiBcIiR7dmVyc2lvbn1cIjpgXG4gICAgXTtcbiAgICBpZiAobGlicmFyeU1pc21hdGNoKSB7XG4gICAgICB3YXJuaW5nLnB1c2goXG4gICAgICAgIGBsaWJyYXJ5IG5hbWUgXCIke2xpYnJhcnl9XCIgY29udGFpbnMgaWxsZWdhbCBjaGFyYWN0ZXJzICh3aGl0ZXNwYWNlIG9yIFwiL1wiKWBcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChsaWJyYXJ5TWlzbWF0Y2ggJiYgdmVyc2lvbk1pc21hdGNoKSB7XG4gICAgICB3YXJuaW5nLnB1c2goJ2FuZCcpO1xuICAgIH1cbiAgICBpZiAodmVyc2lvbk1pc21hdGNoKSB7XG4gICAgICB3YXJuaW5nLnB1c2goXG4gICAgICAgIGB2ZXJzaW9uIG5hbWUgXCIke3ZlcnNpb259XCIgY29udGFpbnMgaWxsZWdhbCBjaGFyYWN0ZXJzICh3aGl0ZXNwYWNlIG9yIFwiL1wiKWBcbiAgICAgICk7XG4gICAgfVxuICAgIGxvZ2dlci53YXJuKHdhcm5pbmcuam9pbignICcpKTtcbiAgICByZXR1cm47XG4gIH1cbiAgX3JlZ2lzdGVyQ29tcG9uZW50KFxuICAgIG5ldyBDb21wb25lbnQoXG4gICAgICBgJHtsaWJyYXJ5fS12ZXJzaW9uYCBhcyBOYW1lLFxuICAgICAgKCkgPT4gKHsgbGlicmFyeSwgdmVyc2lvbiB9KSxcbiAgICAgIENvbXBvbmVudFR5cGUuVkVSU0lPTlxuICAgIClcbiAgKTtcbn1cblxuLyoqXG4gKiBTZXRzIGxvZyBoYW5kbGVyIGZvciBhbGwgRmlyZWJhc2UgU0RLcy5cbiAqIEBwYXJhbSBsb2dDYWxsYmFjayAtIEFuIG9wdGlvbmFsIGN1c3RvbSBsb2cgaGFuZGxlciB0aGF0IGV4ZWN1dGVzIHVzZXIgY29kZSB3aGVuZXZlclxuICogdGhlIEZpcmViYXNlIFNESyBtYWtlcyBhIGxvZ2dpbmcgY2FsbC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBvbkxvZyhcbiAgbG9nQ2FsbGJhY2s6IExvZ0NhbGxiYWNrIHwgbnVsbCxcbiAgb3B0aW9ucz86IExvZ09wdGlvbnNcbik6IHZvaWQge1xuICBpZiAobG9nQ2FsbGJhY2sgIT09IG51bGwgJiYgdHlwZW9mIGxvZ0NhbGxiYWNrICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoQXBwRXJyb3IuSU5WQUxJRF9MT0dfQVJHVU1FTlQpO1xuICB9XG4gIHNldFVzZXJMb2dIYW5kbGVyKGxvZ0NhbGxiYWNrLCBvcHRpb25zKTtcbn1cblxuLyoqXG4gKiBTZXRzIGxvZyBsZXZlbCBmb3IgYWxsIEZpcmViYXNlIFNES3MuXG4gKlxuICogQWxsIG9mIHRoZSBsb2cgdHlwZXMgYWJvdmUgdGhlIGN1cnJlbnQgbG9nIGxldmVsIGFyZSBjYXB0dXJlZCAoaS5lLiBpZlxuICogeW91IHNldCB0aGUgbG9nIGxldmVsIHRvIGBpbmZvYCwgZXJyb3JzIGFyZSBsb2dnZWQsIGJ1dCBgZGVidWdgIGFuZFxuICogYHZlcmJvc2VgIGxvZ3MgYXJlIG5vdCkuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0TG9nTGV2ZWwobG9nTGV2ZWw6IExvZ0xldmVsU3RyaW5nKTogdm9pZCB7XG4gIHNldExvZ0xldmVsSW1wbChsb2dMZXZlbCk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IERCU2NoZW1hLCBvcGVuREIsIElEQlBEYXRhYmFzZSB9IGZyb20gJ2lkYic7XG5pbXBvcnQgeyBBcHBFcnJvciwgRVJST1JfRkFDVE9SWSB9IGZyb20gJy4vZXJyb3JzJztcbmltcG9ydCB7IEZpcmViYXNlQXBwIH0gZnJvbSAnLi9wdWJsaWMtdHlwZXMnO1xuaW1wb3J0IHsgSGVhcnRiZWF0c0luSW5kZXhlZERCIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuL2xvZ2dlcic7XG5cbmNvbnN0IERCX05BTUUgPSAnZmlyZWJhc2UtaGVhcnRiZWF0LWRhdGFiYXNlJztcbmNvbnN0IERCX1ZFUlNJT04gPSAxO1xuY29uc3QgU1RPUkVfTkFNRSA9ICdmaXJlYmFzZS1oZWFydGJlYXQtc3RvcmUnO1xuXG5pbnRlcmZhY2UgQXBwREIgZXh0ZW5kcyBEQlNjaGVtYSB7XG4gICdmaXJlYmFzZS1oZWFydGJlYXQtc3RvcmUnOiB7XG4gICAga2V5OiBzdHJpbmc7XG4gICAgdmFsdWU6IEhlYXJ0YmVhdHNJbkluZGV4ZWREQjtcbiAgfTtcbn1cblxubGV0IGRiUHJvbWlzZTogUHJvbWlzZTxJREJQRGF0YWJhc2U8QXBwREI+PiB8IG51bGwgPSBudWxsO1xuZnVuY3Rpb24gZ2V0RGJQcm9taXNlKCk6IFByb21pc2U8SURCUERhdGFiYXNlPEFwcERCPj4ge1xuICBpZiAoIWRiUHJvbWlzZSkge1xuICAgIGRiUHJvbWlzZSA9IG9wZW5EQjxBcHBEQj4oREJfTkFNRSwgREJfVkVSU0lPTiwge1xuICAgICAgdXBncmFkZTogKGRiLCBvbGRWZXJzaW9uKSA9PiB7XG4gICAgICAgIC8vIFdlIGRvbid0IHVzZSAnYnJlYWsnIGluIHRoaXMgc3dpdGNoIHN0YXRlbWVudCwgdGhlIGZhbGwtdGhyb3VnaFxuICAgICAgICAvLyBiZWhhdmlvciBpcyB3aGF0IHdlIHdhbnQsIGJlY2F1c2UgaWYgdGhlcmUgYXJlIG11bHRpcGxlIHZlcnNpb25zIGJldHdlZW5cbiAgICAgICAgLy8gdGhlIG9sZCB2ZXJzaW9uIGFuZCB0aGUgY3VycmVudCB2ZXJzaW9uLCB3ZSB3YW50IEFMTCB0aGUgbWlncmF0aW9uc1xuICAgICAgICAvLyB0aGF0IGNvcnJlc3BvbmQgdG8gdGhvc2UgdmVyc2lvbnMgdG8gcnVuLCBub3Qgb25seSB0aGUgbGFzdCBvbmUuXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZWZhdWx0LWNhc2VcbiAgICAgICAgc3dpdGNoIChvbGRWZXJzaW9uKSB7XG4gICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgZGIuY3JlYXRlT2JqZWN0U3RvcmUoU1RPUkVfTkFNRSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KS5jYXRjaChlID0+IHtcbiAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKEFwcEVycm9yLklEQl9PUEVOLCB7XG4gICAgICAgIG9yaWdpbmFsRXJyb3JNZXNzYWdlOiBlLm1lc3NhZ2VcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBkYlByb21pc2U7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWFkSGVhcnRiZWF0c0Zyb21JbmRleGVkREIoXG4gIGFwcDogRmlyZWJhc2VBcHBcbik6IFByb21pc2U8SGVhcnRiZWF0c0luSW5kZXhlZERCIHwgdW5kZWZpbmVkPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYlByb21pc2UoKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYlxuICAgICAgLnRyYW5zYWN0aW9uKFNUT1JFX05BTUUpXG4gICAgICAub2JqZWN0U3RvcmUoU1RPUkVfTkFNRSlcbiAgICAgIC5nZXQoY29tcHV0ZUtleShhcHApKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBGaXJlYmFzZUVycm9yKSB7XG4gICAgICBsb2dnZXIud2FybihlLm1lc3NhZ2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBpZGJHZXRFcnJvciA9IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKEFwcEVycm9yLklEQl9HRVQsIHtcbiAgICAgICAgb3JpZ2luYWxFcnJvck1lc3NhZ2U6IChlIGFzIEVycm9yKT8ubWVzc2FnZVxuICAgICAgfSk7XG4gICAgICBsb2dnZXIud2FybihpZGJHZXRFcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdyaXRlSGVhcnRiZWF0c1RvSW5kZXhlZERCKFxuICBhcHA6IEZpcmViYXNlQXBwLFxuICBoZWFydGJlYXRPYmplY3Q6IEhlYXJ0YmVhdHNJbkluZGV4ZWREQlxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYlByb21pc2UoKTtcbiAgICBjb25zdCB0eCA9IGRiLnRyYW5zYWN0aW9uKFNUT1JFX05BTUUsICdyZWFkd3JpdGUnKTtcbiAgICBjb25zdCBvYmplY3RTdG9yZSA9IHR4Lm9iamVjdFN0b3JlKFNUT1JFX05BTUUpO1xuICAgIGF3YWl0IG9iamVjdFN0b3JlLnB1dChoZWFydGJlYXRPYmplY3QsIGNvbXB1dGVLZXkoYXBwKSk7XG4gICAgYXdhaXQgdHguZG9uZTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGlmIChlIGluc3RhbmNlb2YgRmlyZWJhc2VFcnJvcikge1xuICAgICAgbG9nZ2VyLndhcm4oZS5tZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgaWRiR2V0RXJyb3IgPSBFUlJPUl9GQUNUT1JZLmNyZWF0ZShBcHBFcnJvci5JREJfV1JJVEUsIHtcbiAgICAgICAgb3JpZ2luYWxFcnJvck1lc3NhZ2U6IChlIGFzIEVycm9yKT8ubWVzc2FnZVxuICAgICAgfSk7XG4gICAgICBsb2dnZXIud2FybihpZGJHZXRFcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gY29tcHV0ZUtleShhcHA6IEZpcmViYXNlQXBwKTogc3RyaW5nIHtcbiAgcmV0dXJuIGAke2FwcC5uYW1lfSEke2FwcC5vcHRpb25zLmFwcElkfWA7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQ29tcG9uZW50Q29udGFpbmVyIH0gZnJvbSAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5pbXBvcnQge1xuICBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyxcbiAgaXNJbmRleGVkREJBdmFpbGFibGUsXG4gIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGVcbn0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHtcbiAgcmVhZEhlYXJ0YmVhdHNGcm9tSW5kZXhlZERCLFxuICB3cml0ZUhlYXJ0YmVhdHNUb0luZGV4ZWREQlxufSBmcm9tICcuL2luZGV4ZWRkYic7XG5pbXBvcnQgeyBGaXJlYmFzZUFwcCB9IGZyb20gJy4vcHVibGljLXR5cGVzJztcbmltcG9ydCB7XG4gIEhlYXJ0YmVhdHNCeVVzZXJBZ2VudCxcbiAgSGVhcnRiZWF0U2VydmljZSxcbiAgSGVhcnRiZWF0c0luSW5kZXhlZERCLFxuICBIZWFydGJlYXRTdG9yYWdlLFxuICBTaW5nbGVEYXRlSGVhcnRiZWF0XG59IGZyb20gJy4vdHlwZXMnO1xuXG5jb25zdCBNQVhfSEVBREVSX0JZVEVTID0gMTAyNDtcbi8vIDMwIGRheXNcbmNvbnN0IFNUT1JFRF9IRUFSVEJFQVRfUkVURU5USU9OX01BWF9NSUxMSVMgPSAzMCAqIDI0ICogNjAgKiA2MCAqIDEwMDA7XG5cbmV4cG9ydCBjbGFzcyBIZWFydGJlYXRTZXJ2aWNlSW1wbCBpbXBsZW1lbnRzIEhlYXJ0YmVhdFNlcnZpY2Uge1xuICAvKipcbiAgICogVGhlIHBlcnNpc3RlbmNlIGxheWVyIGZvciBoZWFydGJlYXRzXG4gICAqIExlYXZlIHB1YmxpYyBmb3IgZWFzaWVyIHRlc3RpbmcuXG4gICAqL1xuICBfc3RvcmFnZTogSGVhcnRiZWF0U3RvcmFnZUltcGw7XG5cbiAgLyoqXG4gICAqIEluLW1lbW9yeSBjYWNoZSBmb3IgaGVhcnRiZWF0cywgdXNlZCBieSBnZXRIZWFydGJlYXRzSGVhZGVyKCkgdG8gZ2VuZXJhdGVcbiAgICogdGhlIGhlYWRlciBzdHJpbmcuXG4gICAqIFN0b3JlcyBvbmUgcmVjb3JkIHBlciBkYXRlLiBUaGlzIHdpbGwgYmUgY29uc29saWRhdGVkIGludG8gdGhlIHN0YW5kYXJkXG4gICAqIGZvcm1hdCBvZiBvbmUgcmVjb3JkIHBlciB1c2VyIGFnZW50IHN0cmluZyBiZWZvcmUgYmVpbmcgc2VudCBhcyBhIGhlYWRlci5cbiAgICogUG9wdWxhdGVkIGZyb20gaW5kZXhlZERCIHdoZW4gdGhlIGNvbnRyb2xsZXIgaXMgaW5zdGFudGlhdGVkIGFuZCBzaG91bGRcbiAgICogYmUga2VwdCBpbiBzeW5jIHdpdGggaW5kZXhlZERCLlxuICAgKiBMZWF2ZSBwdWJsaWMgZm9yIGVhc2llciB0ZXN0aW5nLlxuICAgKi9cbiAgX2hlYXJ0YmVhdHNDYWNoZTogSGVhcnRiZWF0c0luSW5kZXhlZERCIHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqXG4gICAqIHRoZSBpbml0aWFsaXphdGlvbiBwcm9taXNlIGZvciBwb3B1bGF0aW5nIGhlYXJ0YmVhdENhY2hlLlxuICAgKiBJZiBnZXRIZWFydGJlYXRzSGVhZGVyKCkgaXMgY2FsbGVkIGJlZm9yZSB0aGUgcHJvbWlzZSByZXNvbHZlc1xuICAgKiAoaGVhcmJlYXRzQ2FjaGUgPT0gbnVsbCksIGl0IHNob3VsZCB3YWl0IGZvciB0aGlzIHByb21pc2VcbiAgICogTGVhdmUgcHVibGljIGZvciBlYXNpZXIgdGVzdGluZy5cbiAgICovXG4gIF9oZWFydGJlYXRzQ2FjaGVQcm9taXNlOiBQcm9taXNlPEhlYXJ0YmVhdHNJbkluZGV4ZWREQj47XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgY29udGFpbmVyOiBDb21wb25lbnRDb250YWluZXIpIHtcbiAgICBjb25zdCBhcHAgPSB0aGlzLmNvbnRhaW5lci5nZXRQcm92aWRlcignYXBwJykuZ2V0SW1tZWRpYXRlKCk7XG4gICAgdGhpcy5fc3RvcmFnZSA9IG5ldyBIZWFydGJlYXRTdG9yYWdlSW1wbChhcHApO1xuICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZVByb21pc2UgPSB0aGlzLl9zdG9yYWdlLnJlYWQoKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPSByZXN1bHQ7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbGxlZCB0byByZXBvcnQgYSBoZWFydGJlYXQuIFRoZSBmdW5jdGlvbiB3aWxsIGdlbmVyYXRlXG4gICAqIGEgSGVhcnRiZWF0c0J5VXNlckFnZW50IG9iamVjdCwgdXBkYXRlIGhlYXJ0YmVhdHNDYWNoZSwgYW5kIHBlcnNpc3QgaXRcbiAgICogdG8gSW5kZXhlZERCLlxuICAgKiBOb3RlIHRoYXQgd2Ugb25seSBzdG9yZSBvbmUgaGVhcnRiZWF0IHBlciBkYXkuIFNvIGlmIGEgaGVhcnRiZWF0IGZvciB0b2RheSBpc1xuICAgKiBhbHJlYWR5IGxvZ2dlZCwgc3Vic2VxdWVudCBjYWxscyB0byB0aGlzIGZ1bmN0aW9uIGluIHRoZSBzYW1lIGRheSB3aWxsIGJlIGlnbm9yZWQuXG4gICAqL1xuICBhc3luYyB0cmlnZ2VySGVhcnRiZWF0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHBsYXRmb3JtTG9nZ2VyID0gdGhpcy5jb250YWluZXJcbiAgICAgIC5nZXRQcm92aWRlcigncGxhdGZvcm0tbG9nZ2VyJylcbiAgICAgIC5nZXRJbW1lZGlhdGUoKTtcblxuICAgIC8vIFRoaXMgaXMgdGhlIFwiRmlyZWJhc2UgdXNlciBhZ2VudFwiIHN0cmluZyBmcm9tIHRoZSBwbGF0Zm9ybSBsb2dnZXJcbiAgICAvLyBzZXJ2aWNlLCBub3QgdGhlIGJyb3dzZXIgdXNlciBhZ2VudC5cbiAgICBjb25zdCBhZ2VudCA9IHBsYXRmb3JtTG9nZ2VyLmdldFBsYXRmb3JtSW5mb1N0cmluZygpO1xuICAgIGNvbnN0IGRhdGUgPSBnZXRVVENEYXRlU3RyaW5nKCk7XG4gICAgaWYgKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSA9PT0gbnVsbCkge1xuICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlID0gYXdhaXQgdGhpcy5faGVhcnRiZWF0c0NhY2hlUHJvbWlzZTtcbiAgICB9XG4gICAgLy8gRG8gbm90IHN0b3JlIGEgaGVhcnRiZWF0IGlmIG9uZSBpcyBhbHJlYWR5IHN0b3JlZCBmb3IgdGhpcyBkYXlcbiAgICAvLyBvciBpZiBhIGhlYWRlciBoYXMgYWxyZWFkeSBiZWVuIHNlbnQgdG9kYXkuXG4gICAgaWYgKFxuICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmxhc3RTZW50SGVhcnRiZWF0RGF0ZSA9PT0gZGF0ZSB8fFxuICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMuc29tZShcbiAgICAgICAgc2luZ2xlRGF0ZUhlYXJ0YmVhdCA9PiBzaW5nbGVEYXRlSGVhcnRiZWF0LmRhdGUgPT09IGRhdGVcbiAgICAgIClcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVGhlcmUgaXMgbm8gZW50cnkgZm9yIHRoaXMgZGF0ZS4gQ3JlYXRlIG9uZS5cbiAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLnB1c2goeyBkYXRlLCBhZ2VudCB9KTtcbiAgICB9XG4gICAgLy8gUmVtb3ZlIGVudHJpZXMgb2xkZXIgdGhhbiAzMCBkYXlzLlxuICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzID0gdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMuZmlsdGVyKFxuICAgICAgc2luZ2xlRGF0ZUhlYXJ0YmVhdCA9PiB7XG4gICAgICAgIGNvbnN0IGhiVGltZXN0YW1wID0gbmV3IERhdGUoc2luZ2xlRGF0ZUhlYXJ0YmVhdC5kYXRlKS52YWx1ZU9mKCk7XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIHJldHVybiBub3cgLSBoYlRpbWVzdGFtcCA8PSBTVE9SRURfSEVBUlRCRUFUX1JFVEVOVElPTl9NQVhfTUlMTElTO1xuICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuX3N0b3JhZ2Uub3ZlcndyaXRlKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIGJhc2U2NCBlbmNvZGVkIHN0cmluZyB3aGljaCBjYW4gYmUgYXR0YWNoZWQgdG8gdGhlIGhlYXJ0YmVhdC1zcGVjaWZpYyBoZWFkZXIgZGlyZWN0bHkuXG4gICAqIEl0IGFsc28gY2xlYXJzIGFsbCBoZWFydGJlYXRzIGZyb20gbWVtb3J5IGFzIHdlbGwgYXMgaW4gSW5kZXhlZERCLlxuICAgKlxuICAgKiBOT1RFOiBDb25zdW1pbmcgcHJvZHVjdCBTREtzIHNob3VsZCBub3Qgc2VuZCB0aGUgaGVhZGVyIGlmIHRoaXMgbWV0aG9kXG4gICAqIHJldHVybnMgYW4gZW1wdHkgc3RyaW5nLlxuICAgKi9cbiAgYXN5bmMgZ2V0SGVhcnRiZWF0c0hlYWRlcigpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGlmICh0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPT09IG51bGwpIHtcbiAgICAgIGF3YWl0IHRoaXMuX2hlYXJ0YmVhdHNDYWNoZVByb21pc2U7XG4gICAgfVxuICAgIC8vIElmIGl0J3Mgc3RpbGwgbnVsbCBvciB0aGUgYXJyYXkgaXMgZW1wdHksIHRoZXJlIGlzIG5vIGRhdGEgdG8gc2VuZC5cbiAgICBpZiAoXG4gICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPT09IG51bGwgfHxcbiAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLmxlbmd0aCA9PT0gMFxuICAgICkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICBjb25zdCBkYXRlID0gZ2V0VVRDRGF0ZVN0cmluZygpO1xuICAgIC8vIEV4dHJhY3QgYXMgbWFueSBoZWFydGJlYXRzIGZyb20gdGhlIGNhY2hlIGFzIHdpbGwgZml0IHVuZGVyIHRoZSBzaXplIGxpbWl0LlxuICAgIGNvbnN0IHsgaGVhcnRiZWF0c1RvU2VuZCwgdW5zZW50RW50cmllcyB9ID0gZXh0cmFjdEhlYXJ0YmVhdHNGb3JIZWFkZXIoXG4gICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0c1xuICAgICk7XG4gICAgY29uc3QgaGVhZGVyU3RyaW5nID0gYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoXG4gICAgICBKU09OLnN0cmluZ2lmeSh7IHZlcnNpb246IDIsIGhlYXJ0YmVhdHM6IGhlYXJ0YmVhdHNUb1NlbmQgfSlcbiAgICApO1xuICAgIC8vIFN0b3JlIGxhc3Qgc2VudCBkYXRlIHRvIHByZXZlbnQgYW5vdGhlciBiZWluZyBsb2dnZWQvc2VudCBmb3IgdGhlIHNhbWUgZGF5LlxuICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5sYXN0U2VudEhlYXJ0YmVhdERhdGUgPSBkYXRlO1xuICAgIGlmICh1bnNlbnRFbnRyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIFN0b3JlIGFueSB1bnNlbnQgZW50cmllcyBpZiB0aGV5IGV4aXN0LlxuICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMgPSB1bnNlbnRFbnRyaWVzO1xuICAgICAgLy8gVGhpcyBzZWVtcyBtb3JlIGxpa2VseSB0aGFuIGVtcHR5aW5nIHRoZSBhcnJheSAoYmVsb3cpIHRvIGxlYWQgdG8gc29tZSBvZGQgc3RhdGVcbiAgICAgIC8vIHNpbmNlIHRoZSBjYWNoZSBpc24ndCBlbXB0eSBhbmQgdGhpcyB3aWxsIGJlIGNhbGxlZCBhZ2FpbiBvbiB0aGUgbmV4dCByZXF1ZXN0LFxuICAgICAgLy8gYW5kIGlzIHByb2JhYmx5IHNhZmVzdCBpZiB3ZSBhd2FpdCBpdC5cbiAgICAgIGF3YWl0IHRoaXMuX3N0b3JhZ2Uub3ZlcndyaXRlKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzID0gW107XG4gICAgICAvLyBEbyBub3Qgd2FpdCBmb3IgdGhpcywgdG8gcmVkdWNlIGxhdGVuY3kuXG4gICAgICB2b2lkIHRoaXMuX3N0b3JhZ2Uub3ZlcndyaXRlKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSk7XG4gICAgfVxuICAgIHJldHVybiBoZWFkZXJTdHJpbmc7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0VVRDRGF0ZVN0cmluZygpOiBzdHJpbmcge1xuICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XG4gIC8vIFJldHVybnMgZGF0ZSBmb3JtYXQgJ1lZWVktTU0tREQnXG4gIHJldHVybiB0b2RheS50b0lTT1N0cmluZygpLnN1YnN0cmluZygwLCAxMCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0SGVhcnRiZWF0c0ZvckhlYWRlcihcbiAgaGVhcnRiZWF0c0NhY2hlOiBTaW5nbGVEYXRlSGVhcnRiZWF0W10sXG4gIG1heFNpemUgPSBNQVhfSEVBREVSX0JZVEVTXG4pOiB7XG4gIGhlYXJ0YmVhdHNUb1NlbmQ6IEhlYXJ0YmVhdHNCeVVzZXJBZ2VudFtdO1xuICB1bnNlbnRFbnRyaWVzOiBTaW5nbGVEYXRlSGVhcnRiZWF0W107XG59IHtcbiAgLy8gSGVhcnRiZWF0cyBncm91cGVkIGJ5IHVzZXIgYWdlbnQgaW4gdGhlIHN0YW5kYXJkIGZvcm1hdCB0byBiZSBzZW50IGluXG4gIC8vIHRoZSBoZWFkZXIuXG4gIGNvbnN0IGhlYXJ0YmVhdHNUb1NlbmQ6IEhlYXJ0YmVhdHNCeVVzZXJBZ2VudFtdID0gW107XG4gIC8vIFNpbmdsZSBkYXRlIGZvcm1hdCBoZWFydGJlYXRzIHRoYXQgYXJlIG5vdCBzZW50LlxuICBsZXQgdW5zZW50RW50cmllcyA9IGhlYXJ0YmVhdHNDYWNoZS5zbGljZSgpO1xuICBmb3IgKGNvbnN0IHNpbmdsZURhdGVIZWFydGJlYXQgb2YgaGVhcnRiZWF0c0NhY2hlKSB7XG4gICAgLy8gTG9vayBmb3IgYW4gZXhpc3RpbmcgZW50cnkgd2l0aCB0aGUgc2FtZSB1c2VyIGFnZW50LlxuICAgIGNvbnN0IGhlYXJ0YmVhdEVudHJ5ID0gaGVhcnRiZWF0c1RvU2VuZC5maW5kKFxuICAgICAgaGIgPT4gaGIuYWdlbnQgPT09IHNpbmdsZURhdGVIZWFydGJlYXQuYWdlbnRcbiAgICApO1xuICAgIGlmICghaGVhcnRiZWF0RW50cnkpIHtcbiAgICAgIC8vIElmIG5vIGVudHJ5IGZvciB0aGlzIHVzZXIgYWdlbnQgZXhpc3RzLCBjcmVhdGUgb25lLlxuICAgICAgaGVhcnRiZWF0c1RvU2VuZC5wdXNoKHtcbiAgICAgICAgYWdlbnQ6IHNpbmdsZURhdGVIZWFydGJlYXQuYWdlbnQsXG4gICAgICAgIGRhdGVzOiBbc2luZ2xlRGF0ZUhlYXJ0YmVhdC5kYXRlXVxuICAgICAgfSk7XG4gICAgICBpZiAoY291bnRCeXRlcyhoZWFydGJlYXRzVG9TZW5kKSA+IG1heFNpemUpIHtcbiAgICAgICAgLy8gSWYgdGhlIGhlYWRlciB3b3VsZCBleGNlZWQgbWF4IHNpemUsIHJlbW92ZSB0aGUgYWRkZWQgaGVhcnRiZWF0XG4gICAgICAgIC8vIGVudHJ5IGFuZCBzdG9wIGFkZGluZyB0byB0aGUgaGVhZGVyLlxuICAgICAgICBoZWFydGJlYXRzVG9TZW5kLnBvcCgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaGVhcnRiZWF0RW50cnkuZGF0ZXMucHVzaChzaW5nbGVEYXRlSGVhcnRiZWF0LmRhdGUpO1xuICAgICAgLy8gSWYgdGhlIGhlYWRlciB3b3VsZCBleGNlZWQgbWF4IHNpemUsIHJlbW92ZSB0aGUgYWRkZWQgZGF0ZVxuICAgICAgLy8gYW5kIHN0b3AgYWRkaW5nIHRvIHRoZSBoZWFkZXIuXG4gICAgICBpZiAoY291bnRCeXRlcyhoZWFydGJlYXRzVG9TZW5kKSA+IG1heFNpemUpIHtcbiAgICAgICAgaGVhcnRiZWF0RW50cnkuZGF0ZXMucG9wKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgICAvLyBQb3AgdW5zZW50IGVudHJ5IGZyb20gcXVldWUuIChTa2lwcGVkIGlmIGFkZGluZyB0aGUgZW50cnkgZXhjZWVkZWRcbiAgICAvLyBxdW90YSBhbmQgdGhlIGxvb3AgYnJlYWtzIGVhcmx5LilcbiAgICB1bnNlbnRFbnRyaWVzID0gdW5zZW50RW50cmllcy5zbGljZSgxKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGhlYXJ0YmVhdHNUb1NlbmQsXG4gICAgdW5zZW50RW50cmllc1xuICB9O1xufVxuXG5leHBvcnQgY2xhc3MgSGVhcnRiZWF0U3RvcmFnZUltcGwgaW1wbGVtZW50cyBIZWFydGJlYXRTdG9yYWdlIHtcbiAgcHJpdmF0ZSBfY2FuVXNlSW5kZXhlZERCUHJvbWlzZTogUHJvbWlzZTxib29sZWFuPjtcbiAgY29uc3RydWN0b3IocHVibGljIGFwcDogRmlyZWJhc2VBcHApIHtcbiAgICB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlID0gdGhpcy5ydW5JbmRleGVkREJFbnZpcm9ubWVudENoZWNrKCk7XG4gIH1cbiAgYXN5bmMgcnVuSW5kZXhlZERCRW52aXJvbm1lbnRDaGVjaygpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAoIWlzSW5kZXhlZERCQXZhaWxhYmxlKCkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUoKVxuICAgICAgICAudGhlbigoKSA9PiB0cnVlKVxuICAgICAgICAuY2F0Y2goKCkgPT4gZmFsc2UpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogUmVhZCBhbGwgaGVhcnRiZWF0cy5cbiAgICovXG4gIGFzeW5jIHJlYWQoKTogUHJvbWlzZTxIZWFydGJlYXRzSW5JbmRleGVkREI+IHtcbiAgICBjb25zdCBjYW5Vc2VJbmRleGVkREIgPSBhd2FpdCB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlO1xuICAgIGlmICghY2FuVXNlSW5kZXhlZERCKSB7XG4gICAgICByZXR1cm4geyBoZWFydGJlYXRzOiBbXSB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBpZGJIZWFydGJlYXRPYmplY3QgPSBhd2FpdCByZWFkSGVhcnRiZWF0c0Zyb21JbmRleGVkREIodGhpcy5hcHApO1xuICAgICAgcmV0dXJuIGlkYkhlYXJ0YmVhdE9iamVjdCB8fCB7IGhlYXJ0YmVhdHM6IFtdIH07XG4gICAgfVxuICB9XG4gIC8vIG92ZXJ3cml0ZSB0aGUgc3RvcmFnZSB3aXRoIHRoZSBwcm92aWRlZCBoZWFydGJlYXRzXG4gIGFzeW5jIG92ZXJ3cml0ZShoZWFydGJlYXRzT2JqZWN0OiBIZWFydGJlYXRzSW5JbmRleGVkREIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjYW5Vc2VJbmRleGVkREIgPSBhd2FpdCB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlO1xuICAgIGlmICghY2FuVXNlSW5kZXhlZERCKSB7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdCA9IGF3YWl0IHRoaXMucmVhZCgpO1xuICAgICAgcmV0dXJuIHdyaXRlSGVhcnRiZWF0c1RvSW5kZXhlZERCKHRoaXMuYXBwLCB7XG4gICAgICAgIGxhc3RTZW50SGVhcnRiZWF0RGF0ZTpcbiAgICAgICAgICBoZWFydGJlYXRzT2JqZWN0Lmxhc3RTZW50SGVhcnRiZWF0RGF0ZSA/P1xuICAgICAgICAgIGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdC5sYXN0U2VudEhlYXJ0YmVhdERhdGUsXG4gICAgICAgIGhlYXJ0YmVhdHM6IGhlYXJ0YmVhdHNPYmplY3QuaGVhcnRiZWF0c1xuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIC8vIGFkZCBoZWFydGJlYXRzXG4gIGFzeW5jIGFkZChoZWFydGJlYXRzT2JqZWN0OiBIZWFydGJlYXRzSW5JbmRleGVkREIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjYW5Vc2VJbmRleGVkREIgPSBhd2FpdCB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlO1xuICAgIGlmICghY2FuVXNlSW5kZXhlZERCKSB7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdCA9IGF3YWl0IHRoaXMucmVhZCgpO1xuICAgICAgcmV0dXJuIHdyaXRlSGVhcnRiZWF0c1RvSW5kZXhlZERCKHRoaXMuYXBwLCB7XG4gICAgICAgIGxhc3RTZW50SGVhcnRiZWF0RGF0ZTpcbiAgICAgICAgICBoZWFydGJlYXRzT2JqZWN0Lmxhc3RTZW50SGVhcnRiZWF0RGF0ZSA/P1xuICAgICAgICAgIGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdC5sYXN0U2VudEhlYXJ0YmVhdERhdGUsXG4gICAgICAgIGhlYXJ0YmVhdHM6IFtcbiAgICAgICAgICAuLi5leGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QuaGVhcnRiZWF0cyxcbiAgICAgICAgICAuLi5oZWFydGJlYXRzT2JqZWN0LmhlYXJ0YmVhdHNcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQ2FsY3VsYXRlIGJ5dGVzIG9mIGEgSGVhcnRiZWF0c0J5VXNlckFnZW50IGFycmF5IGFmdGVyIGJlaW5nIHdyYXBwZWRcbiAqIGluIGEgcGxhdGZvcm0gbG9nZ2luZyBoZWFkZXIgSlNPTiBvYmplY3QsIHN0cmluZ2lmaWVkLCBhbmQgY29udmVydGVkXG4gKiB0byBiYXNlIDY0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gY291bnRCeXRlcyhoZWFydGJlYXRzQ2FjaGU6IEhlYXJ0YmVhdHNCeVVzZXJBZ2VudFtdKTogbnVtYmVyIHtcbiAgLy8gYmFzZTY0IGhhcyBhIHJlc3RyaWN0ZWQgc2V0IG9mIGNoYXJhY3RlcnMsIGFsbCBvZiB3aGljaCBzaG91bGQgYmUgMSBieXRlLlxuICByZXR1cm4gYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoXG4gICAgLy8gaGVhcnRiZWF0c0NhY2hlIHdyYXBwZXIgcHJvcGVydGllc1xuICAgIEpTT04uc3RyaW5naWZ5KHsgdmVyc2lvbjogMiwgaGVhcnRiZWF0czogaGVhcnRiZWF0c0NhY2hlIH0pXG4gICkubGVuZ3RoO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IENvbXBvbmVudCwgQ29tcG9uZW50VHlwZSB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuaW1wb3J0IHsgUGxhdGZvcm1Mb2dnZXJTZXJ2aWNlSW1wbCB9IGZyb20gJy4vcGxhdGZvcm1Mb2dnZXJTZXJ2aWNlJztcbmltcG9ydCB7IG5hbWUsIHZlcnNpb24gfSBmcm9tICcuLi9wYWNrYWdlLmpzb24nO1xuaW1wb3J0IHsgX3JlZ2lzdGVyQ29tcG9uZW50IH0gZnJvbSAnLi9pbnRlcm5hbCc7XG5pbXBvcnQgeyByZWdpc3RlclZlcnNpb24gfSBmcm9tICcuL2FwaSc7XG5pbXBvcnQgeyBIZWFydGJlYXRTZXJ2aWNlSW1wbCB9IGZyb20gJy4vaGVhcnRiZWF0U2VydmljZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckNvcmVDb21wb25lbnRzKHZhcmlhbnQ/OiBzdHJpbmcpOiB2b2lkIHtcbiAgX3JlZ2lzdGVyQ29tcG9uZW50KFxuICAgIG5ldyBDb21wb25lbnQoXG4gICAgICAncGxhdGZvcm0tbG9nZ2VyJyxcbiAgICAgIGNvbnRhaW5lciA9PiBuZXcgUGxhdGZvcm1Mb2dnZXJTZXJ2aWNlSW1wbChjb250YWluZXIpLFxuICAgICAgQ29tcG9uZW50VHlwZS5QUklWQVRFXG4gICAgKVxuICApO1xuICBfcmVnaXN0ZXJDb21wb25lbnQoXG4gICAgbmV3IENvbXBvbmVudChcbiAgICAgICdoZWFydGJlYXQnLFxuICAgICAgY29udGFpbmVyID0+IG5ldyBIZWFydGJlYXRTZXJ2aWNlSW1wbChjb250YWluZXIpLFxuICAgICAgQ29tcG9uZW50VHlwZS5QUklWQVRFXG4gICAgKVxuICApO1xuXG4gIC8vIFJlZ2lzdGVyIGBhcHBgIHBhY2thZ2UuXG4gIHJlZ2lzdGVyVmVyc2lvbihuYW1lLCB2ZXJzaW9uLCB2YXJpYW50KTtcbiAgLy8gQlVJTERfVEFSR0VUIHdpbGwgYmUgcmVwbGFjZWQgYnkgdmFsdWVzIGxpa2UgZXNtNSwgZXNtMjAxNywgY2pzNSwgZXRjIGR1cmluZyB0aGUgY29tcGlsYXRpb25cbiAgcmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sICdfX0JVSUxEX1RBUkdFVF9fJyk7XG4gIC8vIFJlZ2lzdGVyIHBsYXRmb3JtIFNESyBpZGVudGlmaWVyIChubyB2ZXJzaW9uKS5cbiAgcmVnaXN0ZXJWZXJzaW9uKCdmaXJlLWpzJywgJycpO1xufVxuIiwgIi8qKlxuICogRmlyZWJhc2UgQXBwXG4gKlxuICogQHJlbWFya3MgVGhpcyBwYWNrYWdlIGNvb3JkaW5hdGVzIHRoZSBjb21tdW5pY2F0aW9uIGJldHdlZW4gdGhlIGRpZmZlcmVudCBGaXJlYmFzZSBjb21wb25lbnRzXG4gKiBAcGFja2FnZURvY3VtZW50YXRpb25cbiAqL1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyByZWdpc3RlckNvcmVDb21wb25lbnRzIH0gZnJvbSAnLi9yZWdpc3RlckNvcmVDb21wb25lbnRzJztcblxuZXhwb3J0ICogZnJvbSAnLi9hcGknO1xuZXhwb3J0ICogZnJvbSAnLi9pbnRlcm5hbCc7XG5leHBvcnQgKiBmcm9tICcuL3B1YmxpYy10eXBlcyc7XG5cbnJlZ2lzdGVyQ29yZUNvbXBvbmVudHMoJ19fUlVOVElNRV9FTlZfXycpO1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgQ29uc3RhbnRzIHVzZWQgaW4gdGhlIEZpcmViYXNlIFN0b3JhZ2UgbGlicmFyeS5cbiAqL1xuXG4vKipcbiAqIERvbWFpbiBuYW1lIGZvciBmaXJlYmFzZSBzdG9yYWdlLlxuICovXG5leHBvcnQgY29uc3QgREVGQVVMVF9IT1NUID0gJ2ZpcmViYXNlc3RvcmFnZS5nb29nbGVhcGlzLmNvbSc7XG5cbi8qKlxuICogVGhlIGtleSBpbiBGaXJlYmFzZSBjb25maWcganNvbiBmb3IgdGhlIHN0b3JhZ2UgYnVja2V0LlxuICovXG5leHBvcnQgY29uc3QgQ09ORklHX1NUT1JBR0VfQlVDS0VUX0tFWSA9ICdzdG9yYWdlQnVja2V0JztcblxuLyoqXG4gKiAyIG1pbnV0ZXNcbiAqXG4gKiBUaGUgdGltZW91dCBmb3IgYWxsIG9wZXJhdGlvbnMgZXhjZXB0IHVwbG9hZC5cbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfTUFYX09QRVJBVElPTl9SRVRSWV9USU1FID0gMiAqIDYwICogMTAwMDtcblxuLyoqXG4gKiAxMCBtaW51dGVzXG4gKlxuICogVGhlIHRpbWVvdXQgZm9yIHVwbG9hZC5cbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfTUFYX1VQTE9BRF9SRVRSWV9USU1FID0gMTAgKiA2MCAqIDEwMDA7XG5cbi8qKlxuICogMSBzZWNvbmRcbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfTUlOX1NMRUVQX1RJTUVfTUlMTElTID0gMTAwMDtcblxuLyoqXG4gKiBUaGlzIGlzIHRoZSB2YWx1ZSBvZiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUiwgd2hpY2ggaXMgbm90IHdlbGwgc3VwcG9ydGVkXG4gKiBlbm91Z2ggZm9yIHVzIHRvIHVzZSBpdCBkaXJlY3RseS5cbiAqL1xuZXhwb3J0IGNvbnN0IE1JTl9TQUZFX0lOVEVHRVIgPSAtOTAwNzE5OTI1NDc0MDk5MTtcbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBGaXJlYmFzZUVycm9yIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5pbXBvcnQgeyBDT05GSUdfU1RPUkFHRV9CVUNLRVRfS0VZIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuXG4vKipcbiAqIEFuIGVycm9yIHJldHVybmVkIGJ5IHRoZSBGaXJlYmFzZSBTdG9yYWdlIFNESy5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIFN0b3JhZ2VFcnJvciBleHRlbmRzIEZpcmViYXNlRXJyb3Ige1xuICBwcml2YXRlIHJlYWRvbmx5IF9iYXNlTWVzc2FnZTogc3RyaW5nO1xuICAvKipcbiAgICogU3RvcmVzIGN1c3RvbSBlcnJvciBkYXRhIHVuaXF1ZSB0byB0aGUgYFN0b3JhZ2VFcnJvcmAuXG4gICAqL1xuICBjdXN0b21EYXRhOiB7IHNlcnZlclJlc3BvbnNlOiBzdHJpbmcgfCBudWxsIH0gPSB7IHNlcnZlclJlc3BvbnNlOiBudWxsIH07XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBjb2RlIC0gQSBgU3RvcmFnZUVycm9yQ29kZWAgc3RyaW5nIHRvIGJlIHByZWZpeGVkIHdpdGggJ3N0b3JhZ2UvJyBhbmRcbiAgICogIGFkZGVkIHRvIHRoZSBlbmQgb2YgdGhlIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSBtZXNzYWdlICAtIEVycm9yIG1lc3NhZ2UuXG4gICAqIEBwYXJhbSBzdGF0dXNfIC0gQ29ycmVzcG9uZGluZyBIVFRQIFN0YXR1cyBDb2RlXG4gICAqL1xuICBjb25zdHJ1Y3Rvcihjb2RlOiBTdG9yYWdlRXJyb3JDb2RlLCBtZXNzYWdlOiBzdHJpbmcsIHByaXZhdGUgc3RhdHVzXyA9IDApIHtcbiAgICBzdXBlcihcbiAgICAgIHByZXBlbmRDb2RlKGNvZGUpLFxuICAgICAgYEZpcmViYXNlIFN0b3JhZ2U6ICR7bWVzc2FnZX0gKCR7cHJlcGVuZENvZGUoY29kZSl9KWBcbiAgICApO1xuICAgIHRoaXMuX2Jhc2VNZXNzYWdlID0gdGhpcy5tZXNzYWdlO1xuICAgIC8vIFdpdGhvdXQgdGhpcywgYGluc3RhbmNlb2YgU3RvcmFnZUVycm9yYCwgaW4gdGVzdHMgZm9yIGV4YW1wbGUsXG4gICAgLy8gcmV0dXJucyBmYWxzZS5cbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgU3RvcmFnZUVycm9yLnByb3RvdHlwZSk7XG4gIH1cblxuICBnZXQgc3RhdHVzKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdHVzXztcbiAgfVxuXG4gIHNldCBzdGF0dXMoc3RhdHVzOiBudW1iZXIpIHtcbiAgICB0aGlzLnN0YXR1c18gPSBzdGF0dXM7XG4gIH1cblxuICAvKipcbiAgICogQ29tcGFyZXMgYSBgU3RvcmFnZUVycm9yQ29kZWAgYWdhaW5zdCB0aGlzIGVycm9yJ3MgY29kZSwgZmlsdGVyaW5nIG91dCB0aGUgcHJlZml4LlxuICAgKi9cbiAgX2NvZGVFcXVhbHMoY29kZTogU3RvcmFnZUVycm9yQ29kZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBwcmVwZW5kQ29kZShjb2RlKSA9PT0gdGhpcy5jb2RlO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wdGlvbmFsIHJlc3BvbnNlIG1lc3NhZ2UgdGhhdCB3YXMgYWRkZWQgYnkgdGhlIHNlcnZlci5cbiAgICovXG4gIGdldCBzZXJ2ZXJSZXNwb25zZSgpOiBudWxsIHwgc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5jdXN0b21EYXRhLnNlcnZlclJlc3BvbnNlO1xuICB9XG5cbiAgc2V0IHNlcnZlclJlc3BvbnNlKHNlcnZlclJlc3BvbnNlOiBzdHJpbmcgfCBudWxsKSB7XG4gICAgdGhpcy5jdXN0b21EYXRhLnNlcnZlclJlc3BvbnNlID0gc2VydmVyUmVzcG9uc2U7XG4gICAgaWYgKHRoaXMuY3VzdG9tRGF0YS5zZXJ2ZXJSZXNwb25zZSkge1xuICAgICAgdGhpcy5tZXNzYWdlID0gYCR7dGhpcy5fYmFzZU1lc3NhZ2V9XFxuJHt0aGlzLmN1c3RvbURhdGEuc2VydmVyUmVzcG9uc2V9YDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tZXNzYWdlID0gdGhpcy5fYmFzZU1lc3NhZ2U7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBlcnJvcnMgPSB7fTtcblxuLyoqXG4gKiBAcHVibGljXG4gKiBFcnJvciBjb2RlcyB0aGF0IGNhbiBiZSBhdHRhY2hlZCB0byBgU3RvcmFnZUVycm9yYCBvYmplY3RzLlxuICovXG5leHBvcnQgZW51bSBTdG9yYWdlRXJyb3JDb2RlIHtcbiAgLy8gU2hhcmVkIGJldHdlZW4gYWxsIHBsYXRmb3Jtc1xuICBVTktOT1dOID0gJ3Vua25vd24nLFxuICBPQkpFQ1RfTk9UX0ZPVU5EID0gJ29iamVjdC1ub3QtZm91bmQnLFxuICBCVUNLRVRfTk9UX0ZPVU5EID0gJ2J1Y2tldC1ub3QtZm91bmQnLFxuICBQUk9KRUNUX05PVF9GT1VORCA9ICdwcm9qZWN0LW5vdC1mb3VuZCcsXG4gIFFVT1RBX0VYQ0VFREVEID0gJ3F1b3RhLWV4Y2VlZGVkJyxcbiAgVU5BVVRIRU5USUNBVEVEID0gJ3VuYXV0aGVudGljYXRlZCcsXG4gIFVOQVVUSE9SSVpFRCA9ICd1bmF1dGhvcml6ZWQnLFxuICBVTkFVVEhPUklaRURfQVBQID0gJ3VuYXV0aG9yaXplZC1hcHAnLFxuICBSRVRSWV9MSU1JVF9FWENFRURFRCA9ICdyZXRyeS1saW1pdC1leGNlZWRlZCcsXG4gIElOVkFMSURfQ0hFQ0tTVU0gPSAnaW52YWxpZC1jaGVja3N1bScsXG4gIENBTkNFTEVEID0gJ2NhbmNlbGVkJyxcbiAgLy8gSlMgc3BlY2lmaWNcbiAgSU5WQUxJRF9FVkVOVF9OQU1FID0gJ2ludmFsaWQtZXZlbnQtbmFtZScsXG4gIElOVkFMSURfVVJMID0gJ2ludmFsaWQtdXJsJyxcbiAgSU5WQUxJRF9ERUZBVUxUX0JVQ0tFVCA9ICdpbnZhbGlkLWRlZmF1bHQtYnVja2V0JyxcbiAgTk9fREVGQVVMVF9CVUNLRVQgPSAnbm8tZGVmYXVsdC1idWNrZXQnLFxuICBDQU5OT1RfU0xJQ0VfQkxPQiA9ICdjYW5ub3Qtc2xpY2UtYmxvYicsXG4gIFNFUlZFUl9GSUxFX1dST05HX1NJWkUgPSAnc2VydmVyLWZpbGUtd3Jvbmctc2l6ZScsXG4gIE5PX0RPV05MT0FEX1VSTCA9ICduby1kb3dubG9hZC11cmwnLFxuICBJTlZBTElEX0FSR1VNRU5UID0gJ2ludmFsaWQtYXJndW1lbnQnLFxuICBJTlZBTElEX0FSR1VNRU5UX0NPVU5UID0gJ2ludmFsaWQtYXJndW1lbnQtY291bnQnLFxuICBBUFBfREVMRVRFRCA9ICdhcHAtZGVsZXRlZCcsXG4gIElOVkFMSURfUk9PVF9PUEVSQVRJT04gPSAnaW52YWxpZC1yb290LW9wZXJhdGlvbicsXG4gIElOVkFMSURfRk9STUFUID0gJ2ludmFsaWQtZm9ybWF0JyxcbiAgSU5URVJOQUxfRVJST1IgPSAnaW50ZXJuYWwtZXJyb3InLFxuICBVTlNVUFBPUlRFRF9FTlZJUk9OTUVOVCA9ICd1bnN1cHBvcnRlZC1lbnZpcm9ubWVudCdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByZXBlbmRDb2RlKGNvZGU6IFN0b3JhZ2VFcnJvckNvZGUpOiBzdHJpbmcge1xuICByZXR1cm4gJ3N0b3JhZ2UvJyArIGNvZGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bmtub3duKCk6IFN0b3JhZ2VFcnJvciB7XG4gIGNvbnN0IG1lc3NhZ2UgPVxuICAgICdBbiB1bmtub3duIGVycm9yIG9jY3VycmVkLCBwbGVhc2UgY2hlY2sgdGhlIGVycm9yIHBheWxvYWQgZm9yICcgK1xuICAgICdzZXJ2ZXIgcmVzcG9uc2UuJztcbiAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoU3RvcmFnZUVycm9yQ29kZS5VTktOT1dOLCBtZXNzYWdlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG9iamVjdE5vdEZvdW5kKHBhdGg6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuT0JKRUNUX05PVF9GT1VORCxcbiAgICBcIk9iamVjdCAnXCIgKyBwYXRoICsgXCInIGRvZXMgbm90IGV4aXN0LlwiXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBidWNrZXROb3RGb3VuZChidWNrZXQ6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuQlVDS0VUX05PVF9GT1VORCxcbiAgICBcIkJ1Y2tldCAnXCIgKyBidWNrZXQgKyBcIicgZG9lcyBub3QgZXhpc3QuXCJcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHByb2plY3ROb3RGb3VuZChwcm9qZWN0OiBzdHJpbmcpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLlBST0pFQ1RfTk9UX0ZPVU5ELFxuICAgIFwiUHJvamVjdCAnXCIgKyBwcm9qZWN0ICsgXCInIGRvZXMgbm90IGV4aXN0LlwiXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBxdW90YUV4Y2VlZGVkKGJ1Y2tldDogc3RyaW5nKTogU3RvcmFnZUVycm9yIHtcbiAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXG4gICAgU3RvcmFnZUVycm9yQ29kZS5RVU9UQV9FWENFRURFRCxcbiAgICBcIlF1b3RhIGZvciBidWNrZXQgJ1wiICtcbiAgICAgIGJ1Y2tldCArXG4gICAgICBcIicgZXhjZWVkZWQsIHBsZWFzZSB2aWV3IHF1b3RhIG9uIFwiICtcbiAgICAgICdodHRwczovL2ZpcmViYXNlLmdvb2dsZS5jb20vcHJpY2luZy8uJ1xuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5hdXRoZW50aWNhdGVkKCk6IFN0b3JhZ2VFcnJvciB7XG4gIGNvbnN0IG1lc3NhZ2UgPVxuICAgICdVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLCBwbGVhc2UgYXV0aGVudGljYXRlIHVzaW5nIEZpcmViYXNlICcgK1xuICAgICdBdXRoZW50aWNhdGlvbiBhbmQgdHJ5IGFnYWluLic7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFN0b3JhZ2VFcnJvckNvZGUuVU5BVVRIRU5USUNBVEVELCBtZXNzYWdlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuYXV0aG9yaXplZEFwcCgpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLlVOQVVUSE9SSVpFRF9BUFAsXG4gICAgJ1RoaXMgYXBwIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBhY2Nlc3MgRmlyZWJhc2UgU3RvcmFnZSBvbiB0aGlzIHByb2plY3QuJ1xuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5hdXRob3JpemVkKHBhdGg6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuVU5BVVRIT1JJWkVELFxuICAgIFwiVXNlciBkb2VzIG5vdCBoYXZlIHBlcm1pc3Npb24gdG8gYWNjZXNzICdcIiArIHBhdGggKyBcIicuXCJcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJldHJ5TGltaXRFeGNlZWRlZCgpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLlJFVFJZX0xJTUlUX0VYQ0VFREVELFxuICAgICdNYXggcmV0cnkgdGltZSBmb3Igb3BlcmF0aW9uIGV4Y2VlZGVkLCBwbGVhc2UgdHJ5IGFnYWluLidcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGludmFsaWRDaGVja3N1bShcbiAgcGF0aDogc3RyaW5nLFxuICBjaGVja3N1bTogc3RyaW5nLFxuICBjYWxjdWxhdGVkOiBzdHJpbmdcbik6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuSU5WQUxJRF9DSEVDS1NVTSxcbiAgICBcIlVwbG9hZGVkL2Rvd25sb2FkZWQgb2JqZWN0ICdcIiArXG4gICAgICBwYXRoICtcbiAgICAgIFwiJyBoYXMgY2hlY2tzdW0gJ1wiICtcbiAgICAgIGNoZWNrc3VtICtcbiAgICAgIFwiJyB3aGljaCBkb2VzIG5vdCBtYXRjaCAnXCIgK1xuICAgICAgY2FsY3VsYXRlZCArXG4gICAgICBcIicuIFBsZWFzZSByZXRyeSB0aGUgdXBsb2FkL2Rvd25sb2FkLlwiXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYW5jZWxlZCgpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLkNBTkNFTEVELFxuICAgICdVc2VyIGNhbmNlbGVkIHRoZSB1cGxvYWQvZG93bmxvYWQuJ1xuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW52YWxpZEV2ZW50TmFtZShuYW1lOiBzdHJpbmcpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLklOVkFMSURfRVZFTlRfTkFNRSxcbiAgICBcIkludmFsaWQgZXZlbnQgbmFtZSAnXCIgKyBuYW1lICsgXCInLlwiXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnZhbGlkVXJsKHVybDogc3RyaW5nKTogU3RvcmFnZUVycm9yIHtcbiAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXG4gICAgU3RvcmFnZUVycm9yQ29kZS5JTlZBTElEX1VSTCxcbiAgICBcIkludmFsaWQgVVJMICdcIiArIHVybCArIFwiJy5cIlxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW52YWxpZERlZmF1bHRCdWNrZXQoYnVja2V0OiBzdHJpbmcpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLklOVkFMSURfREVGQVVMVF9CVUNLRVQsXG4gICAgXCJJbnZhbGlkIGRlZmF1bHQgYnVja2V0ICdcIiArIGJ1Y2tldCArIFwiJy5cIlxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9EZWZhdWx0QnVja2V0KCk6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuTk9fREVGQVVMVF9CVUNLRVQsXG4gICAgJ05vIGRlZmF1bHQgYnVja2V0ICcgK1xuICAgICAgXCJmb3VuZC4gRGlkIHlvdSBzZXQgdGhlICdcIiArXG4gICAgICBDT05GSUdfU1RPUkFHRV9CVUNLRVRfS0VZICtcbiAgICAgIFwiJyBwcm9wZXJ0eSB3aGVuIGluaXRpYWxpemluZyB0aGUgYXBwP1wiXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjYW5ub3RTbGljZUJsb2IoKTogU3RvcmFnZUVycm9yIHtcbiAgcmV0dXJuIG5ldyBTdG9yYWdlRXJyb3IoXG4gICAgU3RvcmFnZUVycm9yQ29kZS5DQU5OT1RfU0xJQ0VfQkxPQixcbiAgICAnQ2Fubm90IHNsaWNlIGJsb2IgZm9yIHVwbG9hZC4gUGxlYXNlIHJldHJ5IHRoZSB1cGxvYWQuJ1xuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2VydmVyRmlsZVdyb25nU2l6ZSgpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLlNFUlZFUl9GSUxFX1dST05HX1NJWkUsXG4gICAgJ1NlcnZlciByZWNvcmRlZCBpbmNvcnJlY3QgdXBsb2FkIGZpbGUgc2l6ZSwgcGxlYXNlIHJldHJ5IHRoZSB1cGxvYWQuJ1xuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9Eb3dubG9hZFVSTCgpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLk5PX0RPV05MT0FEX1VSTCxcbiAgICAnVGhlIGdpdmVuIGZpbGUgZG9lcyBub3QgaGF2ZSBhbnkgZG93bmxvYWQgVVJMcy4nXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtaXNzaW5nUG9seUZpbGwocG9seUZpbGw6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuVU5TVVBQT1JURURfRU5WSVJPTk1FTlQsXG4gICAgYCR7cG9seUZpbGx9IGlzIG1pc3NpbmcuIE1ha2Ugc3VyZSB0byBpbnN0YWxsIHRoZSByZXF1aXJlZCBwb2x5ZmlsbHMuIFNlZSBodHRwczovL2ZpcmViYXNlLmdvb2dsZS5jb20vZG9jcy93ZWIvZW52aXJvbm1lbnRzLWpzLXNkayNwb2x5ZmlsbHMgZm9yIG1vcmUgaW5mb3JtYXRpb24uYFxuICApO1xufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgZnVuY3Rpb24gaW52YWxpZEFyZ3VtZW50KG1lc3NhZ2U6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFN0b3JhZ2VFcnJvckNvZGUuSU5WQUxJRF9BUkdVTUVOVCwgbWVzc2FnZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnZhbGlkQXJndW1lbnRDb3VudChcbiAgYXJnTWluOiBudW1iZXIsXG4gIGFyZ01heDogbnVtYmVyLFxuICBmbk5hbWU6IHN0cmluZyxcbiAgcmVhbDogbnVtYmVyXG4pOiBTdG9yYWdlRXJyb3Ige1xuICBsZXQgY291bnRQYXJ0O1xuICBsZXQgcGx1cmFsO1xuICBpZiAoYXJnTWluID09PSBhcmdNYXgpIHtcbiAgICBjb3VudFBhcnQgPSBhcmdNaW47XG4gICAgcGx1cmFsID0gYXJnTWluID09PSAxID8gJ2FyZ3VtZW50JyA6ICdhcmd1bWVudHMnO1xuICB9IGVsc2Uge1xuICAgIGNvdW50UGFydCA9ICdiZXR3ZWVuICcgKyBhcmdNaW4gKyAnIGFuZCAnICsgYXJnTWF4O1xuICAgIHBsdXJhbCA9ICdhcmd1bWVudHMnO1xuICB9XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuSU5WQUxJRF9BUkdVTUVOVF9DT1VOVCxcbiAgICAnSW52YWxpZCBhcmd1bWVudCBjb3VudCBpbiBgJyArXG4gICAgICBmbk5hbWUgK1xuICAgICAgJ2A6IEV4cGVjdGVkICcgK1xuICAgICAgY291bnRQYXJ0ICtcbiAgICAgICcgJyArXG4gICAgICBwbHVyYWwgK1xuICAgICAgJywgcmVjZWl2ZWQgJyArXG4gICAgICByZWFsICtcbiAgICAgICcuJ1xuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwRGVsZXRlZCgpOiBTdG9yYWdlRXJyb3Ige1xuICByZXR1cm4gbmV3IFN0b3JhZ2VFcnJvcihcbiAgICBTdG9yYWdlRXJyb3JDb2RlLkFQUF9ERUxFVEVELFxuICAgICdUaGUgRmlyZWJhc2UgYXBwIHdhcyBkZWxldGVkLidcbiAgKTtcbn1cblxuLyoqXG4gKiBAcGFyYW0gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBvcGVyYXRpb24gdGhhdCB3YXMgaW52YWxpZC5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludmFsaWRSb290T3BlcmF0aW9uKG5hbWU6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuSU5WQUxJRF9ST09UX09QRVJBVElPTixcbiAgICBcIlRoZSBvcGVyYXRpb24gJ1wiICtcbiAgICAgIG5hbWUgK1xuICAgICAgXCInIGNhbm5vdCBiZSBwZXJmb3JtZWQgb24gYSByb290IHJlZmVyZW5jZSwgY3JlYXRlIGEgbm9uLXJvb3QgXCIgK1xuICAgICAgXCJyZWZlcmVuY2UgdXNpbmcgY2hpbGQsIHN1Y2ggYXMgLmNoaWxkKCdmaWxlLnBuZycpLlwiXG4gICk7XG59XG5cbi8qKlxuICogQHBhcmFtIGZvcm1hdCAtIFRoZSBmb3JtYXQgdGhhdCB3YXMgbm90IHZhbGlkLlxuICogQHBhcmFtIG1lc3NhZ2UgLSBBIG1lc3NhZ2UgZGVzY3JpYmluZyB0aGUgZm9ybWF0IHZpb2xhdGlvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGludmFsaWRGb3JtYXQoZm9ybWF0OiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHJldHVybiBuZXcgU3RvcmFnZUVycm9yKFxuICAgIFN0b3JhZ2VFcnJvckNvZGUuSU5WQUxJRF9GT1JNQVQsXG4gICAgXCJTdHJpbmcgZG9lcyBub3QgbWF0Y2ggZm9ybWF0ICdcIiArIGZvcm1hdCArIFwiJzogXCIgKyBtZXNzYWdlXG4gICk7XG59XG5cbi8qKlxuICogQHBhcmFtIG1lc3NhZ2UgLSBBIG1lc3NhZ2UgZGVzY3JpYmluZyB0aGUgaW50ZXJuYWwgZXJyb3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1bnN1cHBvcnRlZEVudmlyb25tZW50KG1lc3NhZ2U6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHRocm93IG5ldyBTdG9yYWdlRXJyb3IoU3RvcmFnZUVycm9yQ29kZS5VTlNVUFBPUlRFRF9FTlZJUk9OTUVOVCwgbWVzc2FnZSk7XG59XG5cbi8qKlxuICogQHBhcmFtIG1lc3NhZ2UgLSBBIG1lc3NhZ2UgZGVzY3JpYmluZyB0aGUgaW50ZXJuYWwgZXJyb3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbnRlcm5hbEVycm9yKG1lc3NhZ2U6IHN0cmluZyk6IFN0b3JhZ2VFcnJvciB7XG4gIHRocm93IG5ldyBTdG9yYWdlRXJyb3IoXG4gICAgU3RvcmFnZUVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUixcbiAgICAnSW50ZXJuYWwgZXJyb3I6ICcgKyBtZXNzYWdlXG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEZ1bmN0aW9uYWxpdHkgcmVsYXRlZCB0byB0aGUgcGFyc2luZy9jb21wb3NpdGlvbiBvZiBidWNrZXQvXG4gKiBvYmplY3QgbG9jYXRpb24uXG4gKi9cblxuaW1wb3J0IHsgaW52YWxpZERlZmF1bHRCdWNrZXQsIGludmFsaWRVcmwgfSBmcm9tICcuL2Vycm9yJztcbmltcG9ydCB7IERFRkFVTFRfSE9TVCB9IGZyb20gJy4vY29uc3RhbnRzJztcblxuLyoqXG4gKiBGaXJlYmFzZSBTdG9yYWdlIGxvY2F0aW9uIGRhdGEuXG4gKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBjbGFzcyBMb2NhdGlvbiB7XG4gIHByaXZhdGUgcGF0aF86IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVhZG9ubHkgYnVja2V0OiBzdHJpbmcsIHBhdGg6IHN0cmluZykge1xuICAgIHRoaXMucGF0aF8gPSBwYXRoO1xuICB9XG5cbiAgZ2V0IHBhdGgoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5wYXRoXztcbiAgfVxuXG4gIGdldCBpc1Jvb3QoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMucGF0aC5sZW5ndGggPT09IDA7XG4gIH1cblxuICBmdWxsU2VydmVyVXJsKCk6IHN0cmluZyB7XG4gICAgY29uc3QgZW5jb2RlID0gZW5jb2RlVVJJQ29tcG9uZW50O1xuICAgIHJldHVybiAnL2IvJyArIGVuY29kZSh0aGlzLmJ1Y2tldCkgKyAnL28vJyArIGVuY29kZSh0aGlzLnBhdGgpO1xuICB9XG5cbiAgYnVja2V0T25seVNlcnZlclVybCgpOiBzdHJpbmcge1xuICAgIGNvbnN0IGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDtcbiAgICByZXR1cm4gJy9iLycgKyBlbmNvZGUodGhpcy5idWNrZXQpICsgJy9vJztcbiAgfVxuXG4gIHN0YXRpYyBtYWtlRnJvbUJ1Y2tldFNwZWMoYnVja2V0U3RyaW5nOiBzdHJpbmcsIGhvc3Q6IHN0cmluZyk6IExvY2F0aW9uIHtcbiAgICBsZXQgYnVja2V0TG9jYXRpb247XG4gICAgdHJ5IHtcbiAgICAgIGJ1Y2tldExvY2F0aW9uID0gTG9jYXRpb24ubWFrZUZyb21VcmwoYnVja2V0U3RyaW5nLCBob3N0KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBOb3QgdmFsaWQgVVJMLCB1c2UgYXMtaXMuIFRoaXMgbGV0cyB5b3UgcHV0IGJhcmUgYnVja2V0IG5hbWVzIGluXG4gICAgICAvLyBjb25maWcuXG4gICAgICByZXR1cm4gbmV3IExvY2F0aW9uKGJ1Y2tldFN0cmluZywgJycpO1xuICAgIH1cbiAgICBpZiAoYnVja2V0TG9jYXRpb24ucGF0aCA9PT0gJycpIHtcbiAgICAgIHJldHVybiBidWNrZXRMb2NhdGlvbjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgaW52YWxpZERlZmF1bHRCdWNrZXQoYnVja2V0U3RyaW5nKTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgbWFrZUZyb21VcmwodXJsOiBzdHJpbmcsIGhvc3Q6IHN0cmluZyk6IExvY2F0aW9uIHtcbiAgICBsZXQgbG9jYXRpb246IExvY2F0aW9uIHwgbnVsbCA9IG51bGw7XG4gICAgY29uc3QgYnVja2V0RG9tYWluID0gJyhbQS1aYS16MC05LlxcXFwtX10rKSc7XG5cbiAgICBmdW5jdGlvbiBnc01vZGlmeShsb2M6IExvY2F0aW9uKTogdm9pZCB7XG4gICAgICBpZiAobG9jLnBhdGguY2hhckF0KGxvYy5wYXRoLmxlbmd0aCAtIDEpID09PSAnLycpIHtcbiAgICAgICAgbG9jLnBhdGhfID0gbG9jLnBhdGhfLnNsaWNlKDAsIC0xKTtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZ3NQYXRoID0gJygvKC4qKSk/JCc7XG4gICAgY29uc3QgZ3NSZWdleCA9IG5ldyBSZWdFeHAoJ15nczovLycgKyBidWNrZXREb21haW4gKyBnc1BhdGgsICdpJyk7XG4gICAgY29uc3QgZ3NJbmRpY2VzID0geyBidWNrZXQ6IDEsIHBhdGg6IDMgfTtcblxuICAgIGZ1bmN0aW9uIGh0dHBNb2RpZnkobG9jOiBMb2NhdGlvbik6IHZvaWQge1xuICAgICAgbG9jLnBhdGhfID0gZGVjb2RlVVJJQ29tcG9uZW50KGxvYy5wYXRoKTtcbiAgICB9XG4gICAgY29uc3QgdmVyc2lvbiA9ICd2W0EtWmEtejAtOV9dKyc7XG4gICAgY29uc3QgZmlyZWJhc2VTdG9yYWdlSG9zdCA9IGhvc3QucmVwbGFjZSgvWy5dL2csICdcXFxcLicpO1xuICAgIGNvbnN0IGZpcmViYXNlU3RvcmFnZVBhdGggPSAnKC8oW14/I10qKS4qKT8kJztcbiAgICBjb25zdCBmaXJlYmFzZVN0b3JhZ2VSZWdFeHAgPSBuZXcgUmVnRXhwKFxuICAgICAgYF5odHRwcz86Ly8ke2ZpcmViYXNlU3RvcmFnZUhvc3R9LyR7dmVyc2lvbn0vYi8ke2J1Y2tldERvbWFpbn0vbyR7ZmlyZWJhc2VTdG9yYWdlUGF0aH1gLFxuICAgICAgJ2knXG4gICAgKTtcbiAgICBjb25zdCBmaXJlYmFzZVN0b3JhZ2VJbmRpY2VzID0geyBidWNrZXQ6IDEsIHBhdGg6IDMgfTtcblxuICAgIGNvbnN0IGNsb3VkU3RvcmFnZUhvc3QgPVxuICAgICAgaG9zdCA9PT0gREVGQVVMVF9IT1NUXG4gICAgICAgID8gJyg/OnN0b3JhZ2UuZ29vZ2xlYXBpcy5jb218c3RvcmFnZS5jbG91ZC5nb29nbGUuY29tKSdcbiAgICAgICAgOiBob3N0O1xuICAgIGNvbnN0IGNsb3VkU3RvcmFnZVBhdGggPSAnKFtePyNdKiknO1xuICAgIGNvbnN0IGNsb3VkU3RvcmFnZVJlZ0V4cCA9IG5ldyBSZWdFeHAoXG4gICAgICBgXmh0dHBzPzovLyR7Y2xvdWRTdG9yYWdlSG9zdH0vJHtidWNrZXREb21haW59LyR7Y2xvdWRTdG9yYWdlUGF0aH1gLFxuICAgICAgJ2knXG4gICAgKTtcbiAgICBjb25zdCBjbG91ZFN0b3JhZ2VJbmRpY2VzID0geyBidWNrZXQ6IDEsIHBhdGg6IDIgfTtcblxuICAgIGNvbnN0IGdyb3VwcyA9IFtcbiAgICAgIHsgcmVnZXg6IGdzUmVnZXgsIGluZGljZXM6IGdzSW5kaWNlcywgcG9zdE1vZGlmeTogZ3NNb2RpZnkgfSxcbiAgICAgIHtcbiAgICAgICAgcmVnZXg6IGZpcmViYXNlU3RvcmFnZVJlZ0V4cCxcbiAgICAgICAgaW5kaWNlczogZmlyZWJhc2VTdG9yYWdlSW5kaWNlcyxcbiAgICAgICAgcG9zdE1vZGlmeTogaHR0cE1vZGlmeVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgcmVnZXg6IGNsb3VkU3RvcmFnZVJlZ0V4cCxcbiAgICAgICAgaW5kaWNlczogY2xvdWRTdG9yYWdlSW5kaWNlcyxcbiAgICAgICAgcG9zdE1vZGlmeTogaHR0cE1vZGlmeVxuICAgICAgfVxuICAgIF07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBncm91cHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGdyb3VwID0gZ3JvdXBzW2ldO1xuICAgICAgY29uc3QgY2FwdHVyZXMgPSBncm91cC5yZWdleC5leGVjKHVybCk7XG4gICAgICBpZiAoY2FwdHVyZXMpIHtcbiAgICAgICAgY29uc3QgYnVja2V0VmFsdWUgPSBjYXB0dXJlc1tncm91cC5pbmRpY2VzLmJ1Y2tldF07XG4gICAgICAgIGxldCBwYXRoVmFsdWUgPSBjYXB0dXJlc1tncm91cC5pbmRpY2VzLnBhdGhdO1xuICAgICAgICBpZiAoIXBhdGhWYWx1ZSkge1xuICAgICAgICAgIHBhdGhWYWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgICAgIGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKGJ1Y2tldFZhbHVlLCBwYXRoVmFsdWUpO1xuICAgICAgICBncm91cC5wb3N0TW9kaWZ5KGxvY2F0aW9uKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChsb2NhdGlvbiA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBpbnZhbGlkVXJsKHVybCk7XG4gICAgfVxuICAgIHJldHVybiBsb2NhdGlvbjtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBTdG9yYWdlRXJyb3IgfSBmcm9tICcuL2Vycm9yJztcbmltcG9ydCB7IFJlcXVlc3QgfSBmcm9tICcuL3JlcXVlc3QnO1xuXG4vKipcbiAqIEEgcmVxdWVzdCB3aG9zZSBwcm9taXNlIGFsd2F5cyBmYWlscy5cbiAqL1xuZXhwb3J0IGNsYXNzIEZhaWxSZXF1ZXN0PFQ+IGltcGxlbWVudHMgUmVxdWVzdDxUPiB7XG4gIHByb21pc2VfOiBQcm9taXNlPFQ+O1xuXG4gIGNvbnN0cnVjdG9yKGVycm9yOiBTdG9yYWdlRXJyb3IpIHtcbiAgICB0aGlzLnByb21pc2VfID0gUHJvbWlzZS5yZWplY3Q8VD4oZXJyb3IpO1xuICB9XG5cbiAgLyoqIEBpbmhlcml0RG9jICovXG4gIGdldFByb21pc2UoKTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIHRoaXMucHJvbWlzZV87XG4gIH1cblxuICAvKiogQGluaGVyaXREb2MgKi9cbiAgY2FuY2VsKF9hcHBEZWxldGUgPSBmYWxzZSk6IHZvaWQge31cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgUHJvdmlkZXMgYSBtZXRob2QgZm9yIHJ1bm5pbmcgYSBmdW5jdGlvbiB3aXRoIGV4cG9uZW50aWFsXG4gKiBiYWNrb2ZmLlxuICovXG50eXBlIGlkID0gKHAxOiBib29sZWFuKSA9PiB2b2lkO1xuXG5leHBvcnQgeyBpZCB9O1xuXG4vKipcbiAqIEFjY2VwdHMgYSBjYWxsYmFjayBmb3IgYW4gYWN0aW9uIHRvIHBlcmZvcm0gKGBkb1JlcXVlc3RgKSxcbiAqIGFuZCB0aGVuIGEgY2FsbGJhY2sgZm9yIHdoZW4gdGhlIGJhY2tvZmYgaGFzIGNvbXBsZXRlZCAoYGJhY2tvZmZDb21wbGV0ZUNiYCkuXG4gKiBUaGUgY2FsbGJhY2sgc2VudCB0byBzdGFydCByZXF1aXJlcyBhbiBhcmd1bWVudCB0byBjYWxsIChgb25SZXF1ZXN0Q29tcGxldGVgKS5cbiAqIFdoZW4gYHN0YXJ0YCBjYWxscyBgZG9SZXF1ZXN0YCwgaXQgcGFzc2VzIGEgY2FsbGJhY2sgZm9yIHdoZW4gdGhlIHJlcXVlc3QgaGFzXG4gKiBjb21wbGV0ZWQsIGBvblJlcXVlc3RDb21wbGV0ZWAuIEJhc2VkIG9uIHRoaXMsIHRoZSBiYWNrb2ZmIGNvbnRpbnVlcywgd2l0aFxuICogYW5vdGhlciBjYWxsIHRvIGBkb1JlcXVlc3RgIGFuZCB0aGUgYWJvdmUgbG9vcCBjb250aW51ZXMgdW50aWwgdGhlIHRpbWVvdXRcbiAqIGlzIGhpdCwgb3IgYSBzdWNjZXNzZnVsIHJlc3BvbnNlIG9jY3Vycy5cbiAqIEBkZXNjcmlwdGlvblxuICogQHBhcmFtIGRvUmVxdWVzdCBDYWxsYmFjayB0byBwZXJmb3JtIHJlcXVlc3RcbiAqIEBwYXJhbSBiYWNrb2ZmQ29tcGxldGVDYiBDYWxsYmFjayB0byBjYWxsIHdoZW4gYmFja29mZiBoYXMgYmVlbiBjb21wbGV0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0KFxuICBkb1JlcXVlc3Q6IChcbiAgICBvblJlcXVlc3RDb21wbGV0ZTogKHN1Y2Nlc3M6IGJvb2xlYW4pID0+IHZvaWQsXG4gICAgY2FuY2VsZWQ6IGJvb2xlYW5cbiAgKSA9PiB2b2lkLFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICBiYWNrb2ZmQ29tcGxldGVDYjogKC4uLmFyZ3M6IGFueVtdKSA9PiB1bmtub3duLFxuICB0aW1lb3V0OiBudW1iZXJcbik6IGlkIHtcbiAgLy8gVE9ETyhhbmR5c290byk6IG1ha2UgdGhpcyBjb2RlIGNsZWFuZXIgKHByb2JhYmx5IHJlZmFjdG9yIGludG8gYW4gYWN0dWFsXG4gIC8vIHR5cGUgaW5zdGVhZCBvZiBhIGJ1bmNoIG9mIGZ1bmN0aW9ucyB3aXRoIHN0YXRlIHNoYXJlZCBpbiB0aGUgY2xvc3VyZSlcbiAgbGV0IHdhaXRTZWNvbmRzID0gMTtcbiAgLy8gV291bGQgdHlwZSB0aGlzIGFzIFwibnVtYmVyXCIgYnV0IHRoYXQgZG9lc24ndCB3b3JrIGZvciBOb2RlIHNvIMKvXFxfKOODhClfL8KvXG4gIC8vIFRPRE86IGZpbmQgYSB3YXkgdG8gZXhjbHVkZSBOb2RlIHR5cGUgZGVmaW5pdGlvbiBmb3Igc3RvcmFnZSBiZWNhdXNlIHN0b3JhZ2Ugb25seSB3b3JrcyBpbiBicm93c2VyXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIGxldCByZXRyeVRpbWVvdXRJZDogYW55ID0gbnVsbDtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgbGV0IGdsb2JhbFRpbWVvdXRJZDogYW55ID0gbnVsbDtcbiAgbGV0IGhpdFRpbWVvdXQgPSBmYWxzZTtcbiAgbGV0IGNhbmNlbFN0YXRlID0gMDtcblxuICBmdW5jdGlvbiBjYW5jZWxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gY2FuY2VsU3RhdGUgPT09IDI7XG4gIH1cbiAgbGV0IHRyaWdnZXJlZENhbGxiYWNrID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gdHJpZ2dlckNhbGxiYWNrKC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgaWYgKCF0cmlnZ2VyZWRDYWxsYmFjaykge1xuICAgICAgdHJpZ2dlcmVkQ2FsbGJhY2sgPSB0cnVlO1xuICAgICAgYmFja29mZkNvbXBsZXRlQ2IuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY2FsbFdpdGhEZWxheShtaWxsaXM6IG51bWJlcik6IHZvaWQge1xuICAgIHJldHJ5VGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZXRyeVRpbWVvdXRJZCA9IG51bGw7XG4gICAgICBkb1JlcXVlc3QocmVzcG9uc2VIYW5kbGVyLCBjYW5jZWxlZCgpKTtcbiAgICB9LCBtaWxsaXMpO1xuICB9XG5cbiAgZnVuY3Rpb24gY2xlYXJHbG9iYWxUaW1lb3V0KCk6IHZvaWQge1xuICAgIGlmIChnbG9iYWxUaW1lb3V0SWQpIHtcbiAgICAgIGNsZWFyVGltZW91dChnbG9iYWxUaW1lb3V0SWQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHJlc3BvbnNlSGFuZGxlcihzdWNjZXNzOiBib29sZWFuLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgIGlmICh0cmlnZ2VyZWRDYWxsYmFjaykge1xuICAgICAgY2xlYXJHbG9iYWxUaW1lb3V0KCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICBjbGVhckdsb2JhbFRpbWVvdXQoKTtcbiAgICAgIHRyaWdnZXJDYWxsYmFjay5jYWxsKG51bGwsIHN1Y2Nlc3MsIC4uLmFyZ3MpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBtdXN0U3RvcCA9IGNhbmNlbGVkKCkgfHwgaGl0VGltZW91dDtcbiAgICBpZiAobXVzdFN0b3ApIHtcbiAgICAgIGNsZWFyR2xvYmFsVGltZW91dCgpO1xuICAgICAgdHJpZ2dlckNhbGxiYWNrLmNhbGwobnVsbCwgc3VjY2VzcywgLi4uYXJncyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh3YWl0U2Vjb25kcyA8IDY0KSB7XG4gICAgICAvKiBUT0RPKGFuZHlzb3RvKTogZG9uJ3QgYmFjayBvZmYgc28gcXVpY2tseSBpZiB3ZSBrbm93IHdlJ3JlIG9mZmxpbmUuICovXG4gICAgICB3YWl0U2Vjb25kcyAqPSAyO1xuICAgIH1cbiAgICBsZXQgd2FpdE1pbGxpcztcbiAgICBpZiAoY2FuY2VsU3RhdGUgPT09IDEpIHtcbiAgICAgIGNhbmNlbFN0YXRlID0gMjtcbiAgICAgIHdhaXRNaWxsaXMgPSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICB3YWl0TWlsbGlzID0gKHdhaXRTZWNvbmRzICsgTWF0aC5yYW5kb20oKSkgKiAxMDAwO1xuICAgIH1cbiAgICBjYWxsV2l0aERlbGF5KHdhaXRNaWxsaXMpO1xuICB9XG4gIGxldCBzdG9wcGVkID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gc3RvcCh3YXNUaW1lb3V0OiBib29sZWFuKTogdm9pZCB7XG4gICAgaWYgKHN0b3BwZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc3RvcHBlZCA9IHRydWU7XG4gICAgY2xlYXJHbG9iYWxUaW1lb3V0KCk7XG4gICAgaWYgKHRyaWdnZXJlZENhbGxiYWNrKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChyZXRyeVRpbWVvdXRJZCAhPT0gbnVsbCkge1xuICAgICAgaWYgKCF3YXNUaW1lb3V0KSB7XG4gICAgICAgIGNhbmNlbFN0YXRlID0gMjtcbiAgICAgIH1cbiAgICAgIGNsZWFyVGltZW91dChyZXRyeVRpbWVvdXRJZCk7XG4gICAgICBjYWxsV2l0aERlbGF5KDApO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoIXdhc1RpbWVvdXQpIHtcbiAgICAgICAgY2FuY2VsU3RhdGUgPSAxO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBjYWxsV2l0aERlbGF5KDApO1xuICBnbG9iYWxUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBoaXRUaW1lb3V0ID0gdHJ1ZTtcbiAgICBzdG9wKHRydWUpO1xuICB9LCB0aW1lb3V0KTtcbiAgcmV0dXJuIHN0b3A7XG59XG5cbi8qKlxuICogU3RvcHMgdGhlIHJldHJ5IGxvb3AgZnJvbSByZXBlYXRpbmcuXG4gKiBJZiB0aGUgZnVuY3Rpb24gaXMgY3VycmVudGx5IFwiaW4gYmV0d2VlblwiIHJldHJpZXMsIGl0IGlzIGludm9rZWQgaW1tZWRpYXRlbHlcbiAqIHdpdGggdGhlIHNlY29uZCBwYXJhbWV0ZXIgYXMgXCJ0cnVlXCIuIE90aGVyd2lzZSwgaXQgd2lsbCBiZSBpbnZva2VkIG9uY2UgbW9yZVxuICogYWZ0ZXIgdGhlIGN1cnJlbnQgaW52b2NhdGlvbiBmaW5pc2hlcyBpZmYgdGhlIGN1cnJlbnQgaW52b2NhdGlvbiB3b3VsZCBoYXZlXG4gKiB0cmlnZ2VyZWQgYW5vdGhlciByZXRyeS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHN0b3AoaWQ6IGlkKTogdm9pZCB7XG4gIGlkKGZhbHNlKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBpc05vZGUgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBpbnZhbGlkQXJndW1lbnQgfSBmcm9tICcuL2Vycm9yJztcblxuZXhwb3J0IGZ1bmN0aW9uIGlzSnVzdERlZjxUPihwOiBUIHwgbnVsbCB8IHVuZGVmaW5lZCk6IHAgaXMgVCB8IG51bGwge1xuICByZXR1cm4gcCAhPT0gdm9pZCAwO1xufVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xuZXhwb3J0IGZ1bmN0aW9uIGlzRnVuY3Rpb24ocDogdW5rbm93bik6IHAgaXMgRnVuY3Rpb24ge1xuICByZXR1cm4gdHlwZW9mIHAgPT09ICdmdW5jdGlvbic7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc05vbkFycmF5T2JqZWN0KHA6IHVua25vd24pOiBib29sZWFuIHtcbiAgcmV0dXJuIHR5cGVvZiBwID09PSAnb2JqZWN0JyAmJiAhQXJyYXkuaXNBcnJheShwKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3RyaW5nKHA6IHVua25vd24pOiBwIGlzIHN0cmluZyB7XG4gIHJldHVybiB0eXBlb2YgcCA9PT0gJ3N0cmluZycgfHwgcCBpbnN0YW5jZW9mIFN0cmluZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTmF0aXZlQmxvYihwOiB1bmtub3duKTogcCBpcyBCbG9iIHtcbiAgcmV0dXJuIGlzTmF0aXZlQmxvYkRlZmluZWQoKSAmJiBwIGluc3RhbmNlb2YgQmxvYjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTmF0aXZlQmxvYkRlZmluZWQoKTogYm9vbGVhbiB7XG4gIC8vIE5vdGU6IFRoZSBgaXNOb2RlKClgIGNoZWNrIGNhbiBiZSByZW1vdmVkIHdoZW4gYG5vZGUtZmV0Y2hgIGFkZHMgbmF0aXZlIEJsb2Igc3VwcG9ydFxuICAvLyBQUjogaHR0cHM6Ly9naXRodWIuY29tL25vZGUtZmV0Y2gvbm9kZS1mZXRjaC9wdWxsLzE2NjRcbiAgcmV0dXJuIHR5cGVvZiBCbG9iICE9PSAndW5kZWZpbmVkJyAmJiAhaXNOb2RlKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZU51bWJlcihcbiAgYXJndW1lbnQ6IHN0cmluZyxcbiAgbWluVmFsdWU6IG51bWJlcixcbiAgbWF4VmFsdWU6IG51bWJlcixcbiAgdmFsdWU6IG51bWJlclxuKTogdm9pZCB7XG4gIGlmICh2YWx1ZSA8IG1pblZhbHVlKSB7XG4gICAgdGhyb3cgaW52YWxpZEFyZ3VtZW50KFxuICAgICAgYEludmFsaWQgdmFsdWUgZm9yICcke2FyZ3VtZW50fScuIEV4cGVjdGVkICR7bWluVmFsdWV9IG9yIGdyZWF0ZXIuYFxuICAgICk7XG4gIH1cbiAgaWYgKHZhbHVlID4gbWF4VmFsdWUpIHtcbiAgICB0aHJvdyBpbnZhbGlkQXJndW1lbnQoXG4gICAgICBgSW52YWxpZCB2YWx1ZSBmb3IgJyR7YXJndW1lbnR9Jy4gRXhwZWN0ZWQgJHttYXhWYWx1ZX0gb3IgbGVzcy5gXG4gICAgKTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBGdW5jdGlvbnMgdG8gY3JlYXRlIGFuZCBtYW5pcHVsYXRlIFVSTHMgZm9yIHRoZSBzZXJ2ZXIgQVBJLlxuICovXG5pbXBvcnQgeyBVcmxQYXJhbXMgfSBmcm9tICcuL3JlcXVlc3RpbmZvJztcblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VVcmwoXG4gIHVybFBhcnQ6IHN0cmluZyxcbiAgaG9zdDogc3RyaW5nLFxuICBwcm90b2NvbDogc3RyaW5nXG4pOiBzdHJpbmcge1xuICBsZXQgb3JpZ2luID0gaG9zdDtcbiAgaWYgKHByb3RvY29sID09IG51bGwpIHtcbiAgICBvcmlnaW4gPSBgaHR0cHM6Ly8ke2hvc3R9YDtcbiAgfVxuICByZXR1cm4gYCR7cHJvdG9jb2x9Oi8vJHtvcmlnaW59L3YwJHt1cmxQYXJ0fWA7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlUXVlcnlTdHJpbmcocGFyYW1zOiBVcmxQYXJhbXMpOiBzdHJpbmcge1xuICBjb25zdCBlbmNvZGUgPSBlbmNvZGVVUklDb21wb25lbnQ7XG4gIGxldCBxdWVyeVBhcnQgPSAnPyc7XG4gIGZvciAoY29uc3Qga2V5IGluIHBhcmFtcykge1xuICAgIGlmIChwYXJhbXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgY29uc3QgbmV4dFBhcnQgPSBlbmNvZGUoa2V5KSArICc9JyArIGVuY29kZShwYXJhbXNba2V5XSk7XG4gICAgICBxdWVyeVBhcnQgPSBxdWVyeVBhcnQgKyBuZXh0UGFydCArICcmJztcbiAgICB9XG4gIH1cblxuICAvLyBDaG9wIG9mZiB0aGUgZXh0cmEgJyYnIG9yICc/JyBvbiB0aGUgZW5kXG4gIHF1ZXJ5UGFydCA9IHF1ZXJ5UGFydC5zbGljZSgwLCAtMSk7XG4gIHJldHVybiBxdWVyeVBhcnQ7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqIE5ldHdvcmsgaGVhZGVycyAqL1xuZXhwb3J0IHR5cGUgSGVhZGVycyA9IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG5cbi8qKiBSZXNwb25zZSB0eXBlIGV4cG9zZWQgYnkgdGhlIG5ldHdvcmtpbmcgQVBJcy4gKi9cbmV4cG9ydCB0eXBlIENvbm5lY3Rpb25UeXBlID1cbiAgfCBzdHJpbmdcbiAgfCBBcnJheUJ1ZmZlclxuICB8IEJsb2JcbiAgfCBOb2RlSlMuUmVhZGFibGVTdHJlYW07XG5cbi8qKlxuICogQSBsaWdodHdlaWdodCB3cmFwcGVyIGFyb3VuZCBYTUxIdHRwUmVxdWVzdCB3aXRoIGFcbiAqIGdvb2cubmV0LlhocklvLWxpa2UgaW50ZXJmYWNlLlxuICpcbiAqIFlvdSBjYW4gY3JlYXRlIGEgbmV3IGNvbm5lY3Rpb24gYnkgaW52b2tpbmcgYG5ld1RleHRDb25uZWN0aW9uKClgLFxuICogYG5ld0J5dGVzQ29ubmVjdGlvbigpYCBvciBgbmV3U3RyZWFtQ29ubmVjdGlvbigpYC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDb25uZWN0aW9uPFQgZXh0ZW5kcyBDb25uZWN0aW9uVHlwZT4ge1xuICAvKipcbiAgICogU2VuZHMgYSByZXF1ZXN0IHRvIHRoZSBwcm92aWRlZCBVUkwuXG4gICAqXG4gICAqIFRoaXMgbWV0aG9kIG5ldmVyIHJlamVjdHMgaXRzIHByb21pc2UuIEluIGNhc2Ugb2YgZW5jb3VudGVyaW5nIGFuIGVycm9yLFxuICAgKiBpdCBzZXRzIGFuIGVycm9yIGNvZGUgaW50ZXJuYWxseSB3aGljaCBjYW4gYmUgYWNjZXNzZWQgYnkgY2FsbGluZ1xuICAgKiBnZXRFcnJvckNvZGUoKSBieSBjYWxsZXJzLlxuICAgKi9cbiAgc2VuZChcbiAgICB1cmw6IHN0cmluZyxcbiAgICBtZXRob2Q6IHN0cmluZyxcbiAgICBib2R5PzogQXJyYXlCdWZmZXJWaWV3IHwgQmxvYiB8IHN0cmluZyB8IG51bGwsXG4gICAgaGVhZGVycz86IEhlYWRlcnNcbiAgKTogUHJvbWlzZTx2b2lkPjtcblxuICBnZXRFcnJvckNvZGUoKTogRXJyb3JDb2RlO1xuXG4gIGdldFN0YXR1cygpOiBudW1iZXI7XG5cbiAgZ2V0UmVzcG9uc2UoKTogVDtcblxuICBnZXRFcnJvclRleHQoKTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBBYm9ydCB0aGUgcmVxdWVzdC5cbiAgICovXG4gIGFib3J0KCk6IHZvaWQ7XG5cbiAgZ2V0UmVzcG9uc2VIZWFkZXIoaGVhZGVyOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsO1xuXG4gIGFkZFVwbG9hZFByb2dyZXNzTGlzdGVuZXIobGlzdGVuZXI6IChwMTogUHJvZ3Jlc3NFdmVudCkgPT4gdm9pZCk6IHZvaWQ7XG5cbiAgcmVtb3ZlVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lcihsaXN0ZW5lcjogKHAxOiBQcm9ncmVzc0V2ZW50KSA9PiB2b2lkKTogdm9pZDtcbn1cblxuLyoqXG4gKiBFcnJvciBjb2RlcyBmb3IgcmVxdWVzdHMgbWFkZSBieSB0aGUgdGhlIFhocklvIHdyYXBwZXIuXG4gKi9cbmV4cG9ydCBlbnVtIEVycm9yQ29kZSB7XG4gIE5PX0VSUk9SID0gMCxcbiAgTkVUV09SS19FUlJPUiA9IDEsXG4gIEFCT1JUID0gMlxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQ2hlY2tzIHRoZSBzdGF0dXMgY29kZSB0byBzZWUgaWYgdGhlIGFjdGlvbiBzaG91bGQgYmUgcmV0cmllZC5cbiAqXG4gKiBAcGFyYW0gc3RhdHVzIEN1cnJlbnQgSFRUUCBzdGF0dXMgY29kZSByZXR1cm5lZCBieSBzZXJ2ZXIuXG4gKiBAcGFyYW0gYWRkaXRpb25hbFJldHJ5Q29kZXMgYWRkaXRpb25hbCByZXRyeSBjb2RlcyB0byBjaGVjayBhZ2FpbnN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1JldHJ5U3RhdHVzQ29kZShcbiAgc3RhdHVzOiBudW1iZXIsXG4gIGFkZGl0aW9uYWxSZXRyeUNvZGVzOiBudW1iZXJbXVxuKTogYm9vbGVhbiB7XG4gIC8vIFRoZSBjb2RlcyBmb3Igd2hpY2ggdG8gcmV0cnkgY2FtZSBmcm9tIHRoaXMgcGFnZTpcbiAgLy8gaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL3N0b3JhZ2UvZG9jcy9leHBvbmVudGlhbC1iYWNrb2ZmXG4gIGNvbnN0IGlzRml2ZUh1bmRyZWRDb2RlID0gc3RhdHVzID49IDUwMCAmJiBzdGF0dXMgPCA2MDA7XG4gIGNvbnN0IGV4dHJhUmV0cnlDb2RlcyA9IFtcbiAgICAvLyBSZXF1ZXN0IFRpbWVvdXQ6IHdlYiBzZXJ2ZXIgZGlkbid0IHJlY2VpdmUgZnVsbCByZXF1ZXN0IGluIHRpbWUuXG4gICAgNDA4LFxuICAgIC8vIFRvbyBNYW55IFJlcXVlc3RzOiB5b3UncmUgZ2V0dGluZyByYXRlLWxpbWl0ZWQsIGJhc2ljYWxseS5cbiAgICA0MjlcbiAgXTtcbiAgY29uc3QgaXNFeHRyYVJldHJ5Q29kZSA9IGV4dHJhUmV0cnlDb2Rlcy5pbmRleE9mKHN0YXR1cykgIT09IC0xO1xuICBjb25zdCBpc0FkZGl0aW9uYWxSZXRyeUNvZGUgPSBhZGRpdGlvbmFsUmV0cnlDb2Rlcy5pbmRleE9mKHN0YXR1cykgIT09IC0xO1xuICByZXR1cm4gaXNGaXZlSHVuZHJlZENvZGUgfHwgaXNFeHRyYVJldHJ5Q29kZSB8fCBpc0FkZGl0aW9uYWxSZXRyeUNvZGU7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IERlZmluZXMgbWV0aG9kcyB1c2VkIHRvIGFjdHVhbGx5IHNlbmQgSFRUUCByZXF1ZXN0cyBmcm9tXG4gKiBhYnN0cmFjdCByZXByZXNlbnRhdGlvbnMuXG4gKi9cblxuaW1wb3J0IHsgaWQgYXMgYmFja29mZklkLCBzdGFydCwgc3RvcCB9IGZyb20gJy4vYmFja29mZic7XG5pbXBvcnQgeyBhcHBEZWxldGVkLCBjYW5jZWxlZCwgcmV0cnlMaW1pdEV4Y2VlZGVkLCB1bmtub3duIH0gZnJvbSAnLi9lcnJvcic7XG5pbXBvcnQgeyBFcnJvckhhbmRsZXIsIFJlcXVlc3RIYW5kbGVyLCBSZXF1ZXN0SW5mbyB9IGZyb20gJy4vcmVxdWVzdGluZm8nO1xuaW1wb3J0IHsgaXNKdXN0RGVmIH0gZnJvbSAnLi90eXBlJztcbmltcG9ydCB7IG1ha2VRdWVyeVN0cmluZyB9IGZyb20gJy4vdXJsJztcbmltcG9ydCB7IENvbm5lY3Rpb24sIEVycm9yQ29kZSwgSGVhZGVycywgQ29ubmVjdGlvblR5cGUgfSBmcm9tICcuL2Nvbm5lY3Rpb24nO1xuaW1wb3J0IHsgaXNSZXRyeVN0YXR1c0NvZGUgfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGludGVyZmFjZSBSZXF1ZXN0PFQ+IHtcbiAgZ2V0UHJvbWlzZSgpOiBQcm9taXNlPFQ+O1xuXG4gIC8qKlxuICAgKiBDYW5jZWxzIHRoZSByZXF1ZXN0LiBJTVBPUlRBTlQ6IHRoZSBwcm9taXNlIG1heSBzdGlsbCBiZSByZXNvbHZlZCB3aXRoIGFuXG4gICAqIGFwcHJvcHJpYXRlIHZhbHVlIChpZiB0aGUgcmVxdWVzdCBpcyBmaW5pc2hlZCBiZWZvcmUgeW91IGNhbGwgdGhpcyBtZXRob2QsXG4gICAqIGJ1dCB0aGUgcHJvbWlzZSBoYXMgbm90IHlldCBiZWVuIHJlc29sdmVkKSwgc28gZG9uJ3QganVzdCBhc3N1bWUgaXQgd2lsbCBiZVxuICAgKiByZWplY3RlZCBpZiB5b3UgY2FsbCB0aGlzIGZ1bmN0aW9uLlxuICAgKiBAcGFyYW0gYXBwRGVsZXRlIC0gVHJ1ZSBpZiB0aGUgY2FuY2VsYXRpb24gY2FtZSBmcm9tIHRoZSBhcHAgYmVpbmcgZGVsZXRlZC5cbiAgICovXG4gIGNhbmNlbChhcHBEZWxldGU/OiBib29sZWFuKTogdm9pZDtcbn1cblxuLyoqXG4gKiBIYW5kbGVzIG5ldHdvcmsgbG9naWMgZm9yIGFsbCBTdG9yYWdlIFJlcXVlc3RzLCBpbmNsdWRpbmcgZXJyb3IgcmVwb3J0aW5nIGFuZFxuICogcmV0cmllcyB3aXRoIGJhY2tvZmYuXG4gKlxuICogQHBhcmFtIEkgLSB0aGUgdHlwZSBvZiB0aGUgYmFja2VuZCdzIG5ldHdvcmsgcmVzcG9uc2UuXG4gKiBAcGFyYW0gLSBPIHRoZSBvdXRwdXQgdHlwZSB1c2VkIGJ5IHRoZSByZXN0IG9mIHRoZSBTREsuIFRoZSBjb252ZXJzaW9uXG4gKiBoYXBwZW5zIGluIHRoZSBzcGVjaWZpZWQgYGNhbGxiYWNrX2AuXG4gKi9cbmNsYXNzIE5ldHdvcmtSZXF1ZXN0PEkgZXh0ZW5kcyBDb25uZWN0aW9uVHlwZSwgTz4gaW1wbGVtZW50cyBSZXF1ZXN0PE8+IHtcbiAgcHJpdmF0ZSBwZW5kaW5nQ29ubmVjdGlvbl86IENvbm5lY3Rpb248ST4gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBiYWNrb2ZmSWRfOiBiYWNrb2ZmSWQgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZXNvbHZlXyE6ICh2YWx1ZT86IE8gfCBQcm9taXNlTGlrZTxPPikgPT4gdm9pZDtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgcHJpdmF0ZSByZWplY3RfITogKHJlYXNvbj86IGFueSkgPT4gdm9pZDtcbiAgcHJpdmF0ZSBjYW5jZWxlZF86IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBhcHBEZWxldGVfOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgcHJvbWlzZV86IFByb21pc2U8Tz47XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSB1cmxfOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBtZXRob2RfOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSBoZWFkZXJzXzogSGVhZGVycyxcbiAgICBwcml2YXRlIGJvZHlfOiBzdHJpbmcgfCBCbG9iIHwgVWludDhBcnJheSB8IG51bGwsXG4gICAgcHJpdmF0ZSBzdWNjZXNzQ29kZXNfOiBudW1iZXJbXSxcbiAgICBwcml2YXRlIGFkZGl0aW9uYWxSZXRyeUNvZGVzXzogbnVtYmVyW10sXG4gICAgcHJpdmF0ZSBjYWxsYmFja186IFJlcXVlc3RIYW5kbGVyPEksIE8+LFxuICAgIHByaXZhdGUgZXJyb3JDYWxsYmFja186IEVycm9ySGFuZGxlciB8IG51bGwsXG4gICAgcHJpdmF0ZSB0aW1lb3V0XzogbnVtYmVyLFxuICAgIHByaXZhdGUgcHJvZ3Jlc3NDYWxsYmFja186ICgocDE6IG51bWJlciwgcDI6IG51bWJlcikgPT4gdm9pZCkgfCBudWxsLFxuICAgIHByaXZhdGUgY29ubmVjdGlvbkZhY3RvcnlfOiAoKSA9PiBDb25uZWN0aW9uPEk+LFxuICAgIHByaXZhdGUgcmV0cnkgPSB0cnVlXG4gICkge1xuICAgIHRoaXMucHJvbWlzZV8gPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLnJlc29sdmVfID0gcmVzb2x2ZSBhcyAodmFsdWU/OiBPIHwgUHJvbWlzZUxpa2U8Tz4pID0+IHZvaWQ7XG4gICAgICB0aGlzLnJlamVjdF8gPSByZWplY3Q7XG4gICAgICB0aGlzLnN0YXJ0XygpO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEFjdHVhbGx5IHN0YXJ0cyB0aGUgcmV0cnkgbG9vcC5cbiAgICovXG4gIHByaXZhdGUgc3RhcnRfKCk6IHZvaWQge1xuICAgIGNvbnN0IGRvVGhlUmVxdWVzdDogKFxuICAgICAgYmFja29mZkNhbGxiYWNrOiAoc3VjY2VzczogYm9vbGVhbiwgLi4ucDI6IHVua25vd25bXSkgPT4gdm9pZCxcbiAgICAgIGNhbmNlbGVkOiBib29sZWFuXG4gICAgKSA9PiB2b2lkID0gKGJhY2tvZmZDYWxsYmFjaywgY2FuY2VsZWQpID0+IHtcbiAgICAgIGlmIChjYW5jZWxlZCkge1xuICAgICAgICBiYWNrb2ZmQ2FsbGJhY2soZmFsc2UsIG5ldyBSZXF1ZXN0RW5kU3RhdHVzKGZhbHNlLCBudWxsLCB0cnVlKSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNvbm5lY3Rpb24gPSB0aGlzLmNvbm5lY3Rpb25GYWN0b3J5XygpO1xuICAgICAgdGhpcy5wZW5kaW5nQ29ubmVjdGlvbl8gPSBjb25uZWN0aW9uO1xuXG4gICAgICBjb25zdCBwcm9ncmVzc0xpc3RlbmVyOiAoXG4gICAgICAgIHByb2dyZXNzRXZlbnQ6IFByb2dyZXNzRXZlbnRcbiAgICAgICkgPT4gdm9pZCA9IHByb2dyZXNzRXZlbnQgPT4ge1xuICAgICAgICBjb25zdCBsb2FkZWQgPSBwcm9ncmVzc0V2ZW50LmxvYWRlZDtcbiAgICAgICAgY29uc3QgdG90YWwgPSBwcm9ncmVzc0V2ZW50Lmxlbmd0aENvbXB1dGFibGUgPyBwcm9ncmVzc0V2ZW50LnRvdGFsIDogLTE7XG4gICAgICAgIGlmICh0aGlzLnByb2dyZXNzQ2FsbGJhY2tfICE9PSBudWxsKSB7XG4gICAgICAgICAgdGhpcy5wcm9ncmVzc0NhbGxiYWNrXyhsb2FkZWQsIHRvdGFsKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGlmICh0aGlzLnByb2dyZXNzQ2FsbGJhY2tfICE9PSBudWxsKSB7XG4gICAgICAgIGNvbm5lY3Rpb24uYWRkVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lcihwcm9ncmVzc0xpc3RlbmVyKTtcbiAgICAgIH1cblxuICAgICAgLy8gY29ubmVjdGlvbi5zZW5kKCkgbmV2ZXIgcmVqZWN0cywgc28gd2UgZG9uJ3QgbmVlZCB0byBoYXZlIGEgZXJyb3IgaGFuZGxlciBvciB1c2UgY2F0Y2ggb24gdGhlIHJldHVybmVkIHByb21pc2UuXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgICBjb25uZWN0aW9uXG4gICAgICAgIC5zZW5kKHRoaXMudXJsXywgdGhpcy5tZXRob2RfLCB0aGlzLmJvZHlfLCB0aGlzLmhlYWRlcnNfKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgaWYgKHRoaXMucHJvZ3Jlc3NDYWxsYmFja18gIT09IG51bGwpIHtcbiAgICAgICAgICAgIGNvbm5lY3Rpb24ucmVtb3ZlVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lcihwcm9ncmVzc0xpc3RlbmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5wZW5kaW5nQ29ubmVjdGlvbl8gPSBudWxsO1xuICAgICAgICAgIGNvbnN0IGhpdFNlcnZlciA9IGNvbm5lY3Rpb24uZ2V0RXJyb3JDb2RlKCkgPT09IEVycm9yQ29kZS5OT19FUlJPUjtcbiAgICAgICAgICBjb25zdCBzdGF0dXMgPSBjb25uZWN0aW9uLmdldFN0YXR1cygpO1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICFoaXRTZXJ2ZXIgfHxcbiAgICAgICAgICAgIChpc1JldHJ5U3RhdHVzQ29kZShzdGF0dXMsIHRoaXMuYWRkaXRpb25hbFJldHJ5Q29kZXNfKSAmJlxuICAgICAgICAgICAgICB0aGlzLnJldHJ5KVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgY29uc3Qgd2FzQ2FuY2VsZWQgPSBjb25uZWN0aW9uLmdldEVycm9yQ29kZSgpID09PSBFcnJvckNvZGUuQUJPUlQ7XG4gICAgICAgICAgICBiYWNrb2ZmQ2FsbGJhY2soXG4gICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICBuZXcgUmVxdWVzdEVuZFN0YXR1cyhmYWxzZSwgbnVsbCwgd2FzQ2FuY2VsZWQpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzdWNjZXNzQ29kZSA9IHRoaXMuc3VjY2Vzc0NvZGVzXy5pbmRleE9mKHN0YXR1cykgIT09IC0xO1xuICAgICAgICAgIGJhY2tvZmZDYWxsYmFjayh0cnVlLCBuZXcgUmVxdWVzdEVuZFN0YXR1cyhzdWNjZXNzQ29kZSwgY29ubmVjdGlvbikpO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHJlcXVlc3RXZW50VGhyb3VnaCAtIFRydWUgaWYgdGhlIHJlcXVlc3QgZXZlbnR1YWxseSB3ZW50XG4gICAgICogICAgIHRocm91Z2gsIGZhbHNlIGlmIGl0IGhpdCB0aGUgcmV0cnkgbGltaXQgb3Igd2FzIGNhbmNlbGVkLlxuICAgICAqL1xuICAgIGNvbnN0IGJhY2tvZmZEb25lOiAoXG4gICAgICByZXF1ZXN0V2VudFRocm91Z2g6IGJvb2xlYW4sXG4gICAgICBzdGF0dXM6IFJlcXVlc3RFbmRTdGF0dXM8ST5cbiAgICApID0+IHZvaWQgPSAocmVxdWVzdFdlbnRUaHJvdWdoLCBzdGF0dXMpID0+IHtcbiAgICAgIGNvbnN0IHJlc29sdmUgPSB0aGlzLnJlc29sdmVfO1xuICAgICAgY29uc3QgcmVqZWN0ID0gdGhpcy5yZWplY3RfO1xuICAgICAgY29uc3QgY29ubmVjdGlvbiA9IHN0YXR1cy5jb25uZWN0aW9uIGFzIENvbm5lY3Rpb248ST47XG4gICAgICBpZiAoc3RhdHVzLndhc1N1Y2Nlc3NDb2RlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5jYWxsYmFja18oY29ubmVjdGlvbiwgY29ubmVjdGlvbi5nZXRSZXNwb25zZSgpKTtcbiAgICAgICAgICBpZiAoaXNKdXN0RGVmKHJlc3VsdCkpIHtcbiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvbm5lY3Rpb24gIT09IG51bGwpIHtcbiAgICAgICAgICBjb25zdCBlcnIgPSB1bmtub3duKCk7XG4gICAgICAgICAgZXJyLnNlcnZlclJlc3BvbnNlID0gY29ubmVjdGlvbi5nZXRFcnJvclRleHQoKTtcbiAgICAgICAgICBpZiAodGhpcy5lcnJvckNhbGxiYWNrXykge1xuICAgICAgICAgICAgcmVqZWN0KHRoaXMuZXJyb3JDYWxsYmFja18oY29ubmVjdGlvbiwgZXJyKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoc3RhdHVzLmNhbmNlbGVkKSB7XG4gICAgICAgICAgICBjb25zdCBlcnIgPSB0aGlzLmFwcERlbGV0ZV8gPyBhcHBEZWxldGVkKCkgOiBjYW5jZWxlZCgpO1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVyciA9IHJldHJ5TGltaXRFeGNlZWRlZCgpO1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICBpZiAodGhpcy5jYW5jZWxlZF8pIHtcbiAgICAgIGJhY2tvZmZEb25lKGZhbHNlLCBuZXcgUmVxdWVzdEVuZFN0YXR1cyhmYWxzZSwgbnVsbCwgdHJ1ZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmJhY2tvZmZJZF8gPSBzdGFydChkb1RoZVJlcXVlc3QsIGJhY2tvZmZEb25lLCB0aGlzLnRpbWVvdXRfKTtcbiAgICB9XG4gIH1cblxuICAvKiogQGluaGVyaXREb2MgKi9cbiAgZ2V0UHJvbWlzZSgpOiBQcm9taXNlPE8+IHtcbiAgICByZXR1cm4gdGhpcy5wcm9taXNlXztcbiAgfVxuXG4gIC8qKiBAaW5oZXJpdERvYyAqL1xuICBjYW5jZWwoYXBwRGVsZXRlPzogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuY2FuY2VsZWRfID0gdHJ1ZTtcbiAgICB0aGlzLmFwcERlbGV0ZV8gPSBhcHBEZWxldGUgfHwgZmFsc2U7XG4gICAgaWYgKHRoaXMuYmFja29mZklkXyAhPT0gbnVsbCkge1xuICAgICAgc3RvcCh0aGlzLmJhY2tvZmZJZF8pO1xuICAgIH1cbiAgICBpZiAodGhpcy5wZW5kaW5nQ29ubmVjdGlvbl8gIT09IG51bGwpIHtcbiAgICAgIHRoaXMucGVuZGluZ0Nvbm5lY3Rpb25fLmFib3J0KCk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQSBjb2xsZWN0aW9uIG9mIGluZm9ybWF0aW9uIGFib3V0IHRoZSByZXN1bHQgb2YgYSBuZXR3b3JrIHJlcXVlc3QuXG4gKiBAcGFyYW0gb3B0X2NhbmNlbGVkIC0gRGVmYXVsdHMgdG8gZmFsc2UuXG4gKi9cbmV4cG9ydCBjbGFzcyBSZXF1ZXN0RW5kU3RhdHVzPEkgZXh0ZW5kcyBDb25uZWN0aW9uVHlwZT4ge1xuICAvKipcbiAgICogVHJ1ZSBpZiB0aGUgcmVxdWVzdCB3YXMgY2FuY2VsZWQuXG4gICAqL1xuICBjYW5jZWxlZDogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgd2FzU3VjY2Vzc0NvZGU6IGJvb2xlYW4sXG4gICAgcHVibGljIGNvbm5lY3Rpb246IENvbm5lY3Rpb248ST4gfCBudWxsLFxuICAgIGNhbmNlbGVkPzogYm9vbGVhblxuICApIHtcbiAgICB0aGlzLmNhbmNlbGVkID0gISFjYW5jZWxlZDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkQXV0aEhlYWRlcl8oXG4gIGhlYWRlcnM6IEhlYWRlcnMsXG4gIGF1dGhUb2tlbjogc3RyaW5nIHwgbnVsbFxuKTogdm9pZCB7XG4gIGlmIChhdXRoVG9rZW4gIT09IG51bGwgJiYgYXV0aFRva2VuLmxlbmd0aCA+IDApIHtcbiAgICBoZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSAnRmlyZWJhc2UgJyArIGF1dGhUb2tlbjtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkVmVyc2lvbkhlYWRlcl8oXG4gIGhlYWRlcnM6IEhlYWRlcnMsXG4gIGZpcmViYXNlVmVyc2lvbj86IHN0cmluZ1xuKTogdm9pZCB7XG4gIGhlYWRlcnNbJ1gtRmlyZWJhc2UtU3RvcmFnZS1WZXJzaW9uJ10gPVxuICAgICd3ZWJqcy8nICsgKGZpcmViYXNlVmVyc2lvbiA/PyAnQXBwTWFuYWdlcicpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRkR21waWRIZWFkZXJfKGhlYWRlcnM6IEhlYWRlcnMsIGFwcElkOiBzdHJpbmcgfCBudWxsKTogdm9pZCB7XG4gIGlmIChhcHBJZCkge1xuICAgIGhlYWRlcnNbJ1gtRmlyZWJhc2UtR01QSUQnXSA9IGFwcElkO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRBcHBDaGVja0hlYWRlcl8oXG4gIGhlYWRlcnM6IEhlYWRlcnMsXG4gIGFwcENoZWNrVG9rZW46IHN0cmluZyB8IG51bGxcbik6IHZvaWQge1xuICBpZiAoYXBwQ2hlY2tUb2tlbiAhPT0gbnVsbCkge1xuICAgIGhlYWRlcnNbJ1gtRmlyZWJhc2UtQXBwQ2hlY2snXSA9IGFwcENoZWNrVG9rZW47XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VSZXF1ZXN0PEkgZXh0ZW5kcyBDb25uZWN0aW9uVHlwZSwgTz4oXG4gIHJlcXVlc3RJbmZvOiBSZXF1ZXN0SW5mbzxJLCBPPixcbiAgYXBwSWQ6IHN0cmluZyB8IG51bGwsXG4gIGF1dGhUb2tlbjogc3RyaW5nIHwgbnVsbCxcbiAgYXBwQ2hlY2tUb2tlbjogc3RyaW5nIHwgbnVsbCxcbiAgcmVxdWVzdEZhY3Rvcnk6ICgpID0+IENvbm5lY3Rpb248ST4sXG4gIGZpcmViYXNlVmVyc2lvbj86IHN0cmluZyxcbiAgcmV0cnkgPSB0cnVlXG4pOiBSZXF1ZXN0PE8+IHtcbiAgY29uc3QgcXVlcnlQYXJ0ID0gbWFrZVF1ZXJ5U3RyaW5nKHJlcXVlc3RJbmZvLnVybFBhcmFtcyk7XG4gIGNvbnN0IHVybCA9IHJlcXVlc3RJbmZvLnVybCArIHF1ZXJ5UGFydDtcbiAgY29uc3QgaGVhZGVycyA9IE9iamVjdC5hc3NpZ24oe30sIHJlcXVlc3RJbmZvLmhlYWRlcnMpO1xuICBhZGRHbXBpZEhlYWRlcl8oaGVhZGVycywgYXBwSWQpO1xuICBhZGRBdXRoSGVhZGVyXyhoZWFkZXJzLCBhdXRoVG9rZW4pO1xuICBhZGRWZXJzaW9uSGVhZGVyXyhoZWFkZXJzLCBmaXJlYmFzZVZlcnNpb24pO1xuICBhZGRBcHBDaGVja0hlYWRlcl8oaGVhZGVycywgYXBwQ2hlY2tUb2tlbik7XG4gIHJldHVybiBuZXcgTmV0d29ya1JlcXVlc3Q8SSwgTz4oXG4gICAgdXJsLFxuICAgIHJlcXVlc3RJbmZvLm1ldGhvZCxcbiAgICBoZWFkZXJzLFxuICAgIHJlcXVlc3RJbmZvLmJvZHksXG4gICAgcmVxdWVzdEluZm8uc3VjY2Vzc0NvZGVzLFxuICAgIHJlcXVlc3RJbmZvLmFkZGl0aW9uYWxSZXRyeUNvZGVzLFxuICAgIHJlcXVlc3RJbmZvLmhhbmRsZXIsXG4gICAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyLFxuICAgIHJlcXVlc3RJbmZvLnRpbWVvdXQsXG4gICAgcmVxdWVzdEluZm8ucHJvZ3Jlc3NDYWxsYmFjayxcbiAgICByZXF1ZXN0RmFjdG9yeSxcbiAgICByZXRyeVxuICApO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgU29tZSBtZXRob2RzIGNvcGllZCBmcm9tIGdvb2cuZnMuXG4gKiBXZSBkb24ndCBpbmNsdWRlIGdvb2cuZnMgYmVjYXVzZSBpdCBwdWxscyBpbiBhIGJ1bmNoIG9mIERlZmVycmVkIGNvZGUgdGhhdFxuICogYmxvYXRzIHRoZSBzaXplIG9mIHRoZSByZWxlYXNlZCBiaW5hcnkuXG4gKi9cbmltcG9ydCB7IGlzTmF0aXZlQmxvYkRlZmluZWQgfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHsgU3RvcmFnZUVycm9yQ29kZSwgU3RvcmFnZUVycm9yIH0gZnJvbSAnLi9lcnJvcic7XG5cbmZ1bmN0aW9uIGdldEJsb2JCdWlsZGVyKCk6IHR5cGVvZiBJQmxvYkJ1aWxkZXIgfCB1bmRlZmluZWQge1xuICBpZiAodHlwZW9mIEJsb2JCdWlsZGVyICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBCbG9iQnVpbGRlcjtcbiAgfSBlbHNlIGlmICh0eXBlb2YgV2ViS2l0QmxvYkJ1aWxkZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIFdlYktpdEJsb2JCdWlsZGVyO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cblxuLyoqXG4gKiBDb25jYXRlbmF0ZXMgb25lIG9yIG1vcmUgdmFsdWVzIHRvZ2V0aGVyIGFuZCBjb252ZXJ0cyB0aGVtIHRvIGEgQmxvYi5cbiAqXG4gKiBAcGFyYW0gYXJncyBUaGUgdmFsdWVzIHRoYXQgd2lsbCBtYWtlIHVwIHRoZSByZXN1bHRpbmcgYmxvYi5cbiAqIEByZXR1cm4gVGhlIGJsb2IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCbG9iKC4uLmFyZ3M6IEFycmF5PHN0cmluZyB8IEJsb2IgfCBBcnJheUJ1ZmZlcj4pOiBCbG9iIHtcbiAgY29uc3QgQmxvYkJ1aWxkZXIgPSBnZXRCbG9iQnVpbGRlcigpO1xuICBpZiAoQmxvYkJ1aWxkZXIgIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IGJiID0gbmV3IEJsb2JCdWlsZGVyKCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBiYi5hcHBlbmQoYXJnc1tpXSk7XG4gICAgfVxuICAgIHJldHVybiBiYi5nZXRCbG9iKCk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKGlzTmF0aXZlQmxvYkRlZmluZWQoKSkge1xuICAgICAgcmV0dXJuIG5ldyBCbG9iKGFyZ3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgU3RvcmFnZUVycm9yKFxuICAgICAgICBTdG9yYWdlRXJyb3JDb2RlLlVOU1VQUE9SVEVEX0VOVklST05NRU5ULFxuICAgICAgICBcIlRoaXMgYnJvd3NlciBkb2Vzbid0IHNlZW0gdG8gc3VwcG9ydCBjcmVhdGluZyBCbG9ic1wiXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIFNsaWNlcyB0aGUgYmxvYi4gVGhlIHJldHVybmVkIGJsb2IgY29udGFpbnMgZGF0YSBmcm9tIHRoZSBzdGFydCBieXRlXG4gKiAoaW5jbHVzaXZlKSB0aWxsIHRoZSBlbmQgYnl0ZSAoZXhjbHVzaXZlKS4gTmVnYXRpdmUgaW5kaWNlcyBjYW5ub3QgYmUgdXNlZC5cbiAqXG4gKiBAcGFyYW0gYmxvYiBUaGUgYmxvYiB0byBiZSBzbGljZWQuXG4gKiBAcGFyYW0gc3RhcnQgSW5kZXggb2YgdGhlIHN0YXJ0aW5nIGJ5dGUuXG4gKiBAcGFyYW0gZW5kIEluZGV4IG9mIHRoZSBlbmRpbmcgYnl0ZS5cbiAqIEByZXR1cm4gVGhlIGJsb2Igc2xpY2Ugb3IgbnVsbCBpZiBub3Qgc3VwcG9ydGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2xpY2VCbG9iKGJsb2I6IEJsb2IsIHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKTogQmxvYiB8IG51bGwge1xuICBpZiAoYmxvYi53ZWJraXRTbGljZSkge1xuICAgIHJldHVybiBibG9iLndlYmtpdFNsaWNlKHN0YXJ0LCBlbmQpO1xuICB9IGVsc2UgaWYgKGJsb2IubW96U2xpY2UpIHtcbiAgICByZXR1cm4gYmxvYi5tb3pTbGljZShzdGFydCwgZW5kKTtcbiAgfSBlbHNlIGlmIChibG9iLnNsaWNlKSB7XG4gICAgcmV0dXJuIGJsb2Iuc2xpY2Uoc3RhcnQsIGVuZCk7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgbWlzc2luZ1BvbHlGaWxsIH0gZnJvbSAnLi4vLi4vaW1wbGVtZW50YXRpb24vZXJyb3InO1xuXG4vKiogQ29udmVydHMgYSBCYXNlNjQgZW5jb2RlZCBzdHJpbmcgdG8gYSBiaW5hcnkgc3RyaW5nLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZUJhc2U2NChlbmNvZGVkOiBzdHJpbmcpOiBzdHJpbmcge1xuICBpZiAodHlwZW9mIGF0b2IgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgdGhyb3cgbWlzc2luZ1BvbHlGaWxsKCdiYXNlLTY0Jyk7XG4gIH1cbiAgcmV0dXJuIGF0b2IoZW5jb2RlZCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGVVaW50OEFycmF5KGRhdGE6IFVpbnQ4QXJyYXkpOiBzdHJpbmcge1xuICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGRhdGEpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IHVua25vd24sIGludmFsaWRGb3JtYXQgfSBmcm9tICcuL2Vycm9yJztcbmltcG9ydCB7IGRlY29kZUJhc2U2NCB9IGZyb20gJy4uL3BsYXRmb3JtL2Jhc2U2NCc7XG5cbi8qKlxuICogQW4gZW51bWVyYXRpb24gb2YgdGhlIHBvc3NpYmxlIHN0cmluZyBmb3JtYXRzIGZvciB1cGxvYWQuXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB0eXBlIFN0cmluZ0Zvcm1hdCA9IHR5cGVvZiBTdHJpbmdGb3JtYXRba2V5b2YgdHlwZW9mIFN0cmluZ0Zvcm1hdF07XG4vKipcbiAqIEFuIGVudW1lcmF0aW9uIG9mIHRoZSBwb3NzaWJsZSBzdHJpbmcgZm9ybWF0cyBmb3IgdXBsb2FkLlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgU3RyaW5nRm9ybWF0ID0ge1xuICAvKipcbiAgICogSW5kaWNhdGVzIHRoZSBzdHJpbmcgc2hvdWxkIGJlIGludGVycHJldGVkIFwicmF3XCIsIHRoYXQgaXMsIGFzIG5vcm1hbCB0ZXh0LlxuICAgKiBUaGUgc3RyaW5nIHdpbGwgYmUgaW50ZXJwcmV0ZWQgYXMgVVRGLTE2LCB0aGVuIHVwbG9hZGVkIGFzIGEgVVRGLTggYnl0ZVxuICAgKiBzZXF1ZW5jZS5cbiAgICogRXhhbXBsZTogVGhlIHN0cmluZyAnSGVsbG8hIFxcXFx1ZDgzZFxcXFx1ZGUwYScgYmVjb21lcyB0aGUgYnl0ZSBzZXF1ZW5jZVxuICAgKiA0OCA2NSA2YyA2YyA2ZiAyMSAyMCBmMCA5ZiA5OCA4YVxuICAgKi9cbiAgUkFXOiAncmF3JyxcbiAgLyoqXG4gICAqIEluZGljYXRlcyB0aGUgc3RyaW5nIHNob3VsZCBiZSBpbnRlcnByZXRlZCBhcyBiYXNlNjQtZW5jb2RlZCBkYXRhLlxuICAgKiBQYWRkaW5nIGNoYXJhY3RlcnMgKHRyYWlsaW5nICc9J3MpIGFyZSBvcHRpb25hbC5cbiAgICogRXhhbXBsZTogVGhlIHN0cmluZyAncldtTysrRTZ0Ny9ybHc9PScgYmVjb21lcyB0aGUgYnl0ZSBzZXF1ZW5jZVxuICAgKiBhZCA2OSA4ZSBmYiBlMSAzYSBiNyBiZiBlYiA5N1xuICAgKi9cbiAgQkFTRTY0OiAnYmFzZTY0JyxcbiAgLyoqXG4gICAqIEluZGljYXRlcyB0aGUgc3RyaW5nIHNob3VsZCBiZSBpbnRlcnByZXRlZCBhcyBiYXNlNjR1cmwtZW5jb2RlZCBkYXRhLlxuICAgKiBQYWRkaW5nIGNoYXJhY3RlcnMgKHRyYWlsaW5nICc9J3MpIGFyZSBvcHRpb25hbC5cbiAgICogRXhhbXBsZTogVGhlIHN0cmluZyAncldtTy0tRTZ0N19ybHc9PScgYmVjb21lcyB0aGUgYnl0ZSBzZXF1ZW5jZVxuICAgKiBhZCA2OSA4ZSBmYiBlMSAzYSBiNyBiZiBlYiA5N1xuICAgKi9cbiAgQkFTRTY0VVJMOiAnYmFzZTY0dXJsJyxcbiAgLyoqXG4gICAqIEluZGljYXRlcyB0aGUgc3RyaW5nIGlzIGEgZGF0YSBVUkwsIHN1Y2ggYXMgb25lIG9idGFpbmVkIGZyb21cbiAgICogY2FudmFzLnRvRGF0YVVSTCgpLlxuICAgKiBFeGFtcGxlOiB0aGUgc3RyaW5nICdkYXRhOmFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbTtiYXNlNjQsYWFhYSdcbiAgICogYmVjb21lcyB0aGUgYnl0ZSBzZXF1ZW5jZVxuICAgKiA2OSBhNiA5YVxuICAgKiAodGhlIGNvbnRlbnQtdHlwZSBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiIGlzIGFsc28gYXBwbGllZCwgYnV0IGNhblxuICAgKiBiZSBvdmVycmlkZGVuIGluIHRoZSBtZXRhZGF0YSBvYmplY3QpLlxuICAgKi9cbiAgREFUQV9VUkw6ICdkYXRhX3VybCdcbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBjbGFzcyBTdHJpbmdEYXRhIHtcbiAgY29udGVudFR5cGU6IHN0cmluZyB8IG51bGw7XG5cbiAgY29uc3RydWN0b3IocHVibGljIGRhdGE6IFVpbnQ4QXJyYXksIGNvbnRlbnRUeXBlPzogc3RyaW5nIHwgbnVsbCkge1xuICAgIHRoaXMuY29udGVudFR5cGUgPSBjb250ZW50VHlwZSB8fCBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkYXRhRnJvbVN0cmluZyhcbiAgZm9ybWF0OiBTdHJpbmdGb3JtYXQsXG4gIHN0cmluZ0RhdGE6IHN0cmluZ1xuKTogU3RyaW5nRGF0YSB7XG4gIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgY2FzZSBTdHJpbmdGb3JtYXQuUkFXOlxuICAgICAgcmV0dXJuIG5ldyBTdHJpbmdEYXRhKHV0ZjhCeXRlc18oc3RyaW5nRGF0YSkpO1xuICAgIGNhc2UgU3RyaW5nRm9ybWF0LkJBU0U2NDpcbiAgICBjYXNlIFN0cmluZ0Zvcm1hdC5CQVNFNjRVUkw6XG4gICAgICByZXR1cm4gbmV3IFN0cmluZ0RhdGEoYmFzZTY0Qnl0ZXNfKGZvcm1hdCwgc3RyaW5nRGF0YSkpO1xuICAgIGNhc2UgU3RyaW5nRm9ybWF0LkRBVEFfVVJMOlxuICAgICAgcmV0dXJuIG5ldyBTdHJpbmdEYXRhKFxuICAgICAgICBkYXRhVVJMQnl0ZXNfKHN0cmluZ0RhdGEpLFxuICAgICAgICBkYXRhVVJMQ29udGVudFR5cGVfKHN0cmluZ0RhdGEpXG4gICAgICApO1xuICAgIGRlZmF1bHQ6XG4gICAgLy8gZG8gbm90aGluZ1xuICB9XG5cbiAgLy8gYXNzZXJ0KGZhbHNlKTtcbiAgdGhyb3cgdW5rbm93bigpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdXRmOEJ5dGVzXyh2YWx1ZTogc3RyaW5nKTogVWludDhBcnJheSB7XG4gIGNvbnN0IGI6IG51bWJlcltdID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyBpKyspIHtcbiAgICBsZXQgYyA9IHZhbHVlLmNoYXJDb2RlQXQoaSk7XG4gICAgaWYgKGMgPD0gMTI3KSB7XG4gICAgICBiLnB1c2goYyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChjIDw9IDIwNDcpIHtcbiAgICAgICAgYi5wdXNoKDE5MiB8IChjID4+IDYpLCAxMjggfCAoYyAmIDYzKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoKGMgJiA2NDUxMikgPT09IDU1Mjk2KSB7XG4gICAgICAgICAgLy8gVGhlIHN0YXJ0IG9mIGEgc3Vycm9nYXRlIHBhaXIuXG4gICAgICAgICAgY29uc3QgdmFsaWQgPVxuICAgICAgICAgICAgaSA8IHZhbHVlLmxlbmd0aCAtIDEgJiYgKHZhbHVlLmNoYXJDb2RlQXQoaSArIDEpICYgNjQ1MTIpID09PSA1NjMyMDtcbiAgICAgICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgICAgICAvLyBUaGUgc2Vjb25kIHN1cnJvZ2F0ZSB3YXNuJ3QgdGhlcmUuXG4gICAgICAgICAgICBiLnB1c2goMjM5LCAxOTEsIDE4OSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGhpID0gYztcbiAgICAgICAgICAgIGNvbnN0IGxvID0gdmFsdWUuY2hhckNvZGVBdCgrK2kpO1xuICAgICAgICAgICAgYyA9IDY1NTM2IHwgKChoaSAmIDEwMjMpIDw8IDEwKSB8IChsbyAmIDEwMjMpO1xuICAgICAgICAgICAgYi5wdXNoKFxuICAgICAgICAgICAgICAyNDAgfCAoYyA+PiAxOCksXG4gICAgICAgICAgICAgIDEyOCB8ICgoYyA+PiAxMikgJiA2MyksXG4gICAgICAgICAgICAgIDEyOCB8ICgoYyA+PiA2KSAmIDYzKSxcbiAgICAgICAgICAgICAgMTI4IHwgKGMgJiA2MylcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICgoYyAmIDY0NTEyKSA9PT0gNTYzMjApIHtcbiAgICAgICAgICAgIC8vIEludmFsaWQgbG93IHN1cnJvZ2F0ZS5cbiAgICAgICAgICAgIGIucHVzaCgyMzksIDE5MSwgMTg5KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYi5wdXNoKDIyNCB8IChjID4+IDEyKSwgMTI4IHwgKChjID4+IDYpICYgNjMpLCAxMjggfCAoYyAmIDYzKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBuZXcgVWludDhBcnJheShiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBlcmNlbnRFbmNvZGVkQnl0ZXNfKHZhbHVlOiBzdHJpbmcpOiBVaW50OEFycmF5IHtcbiAgbGV0IGRlY29kZWQ7XG4gIHRyeSB7XG4gICAgZGVjb2RlZCA9IGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBpbnZhbGlkRm9ybWF0KFN0cmluZ0Zvcm1hdC5EQVRBX1VSTCwgJ01hbGZvcm1lZCBkYXRhIFVSTC4nKTtcbiAgfVxuICByZXR1cm4gdXRmOEJ5dGVzXyhkZWNvZGVkKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJhc2U2NEJ5dGVzXyhmb3JtYXQ6IFN0cmluZ0Zvcm1hdCwgdmFsdWU6IHN0cmluZyk6IFVpbnQ4QXJyYXkge1xuICBzd2l0Y2ggKGZvcm1hdCkge1xuICAgIGNhc2UgU3RyaW5nRm9ybWF0LkJBU0U2NDoge1xuICAgICAgY29uc3QgaGFzTWludXMgPSB2YWx1ZS5pbmRleE9mKCctJykgIT09IC0xO1xuICAgICAgY29uc3QgaGFzVW5kZXIgPSB2YWx1ZS5pbmRleE9mKCdfJykgIT09IC0xO1xuICAgICAgaWYgKGhhc01pbnVzIHx8IGhhc1VuZGVyKSB7XG4gICAgICAgIGNvbnN0IGludmFsaWRDaGFyID0gaGFzTWludXMgPyAnLScgOiAnXyc7XG4gICAgICAgIHRocm93IGludmFsaWRGb3JtYXQoXG4gICAgICAgICAgZm9ybWF0LFxuICAgICAgICAgIFwiSW52YWxpZCBjaGFyYWN0ZXIgJ1wiICtcbiAgICAgICAgICAgIGludmFsaWRDaGFyICtcbiAgICAgICAgICAgIFwiJyBmb3VuZDogaXMgaXQgYmFzZTY0dXJsIGVuY29kZWQ/XCJcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBjYXNlIFN0cmluZ0Zvcm1hdC5CQVNFNjRVUkw6IHtcbiAgICAgIGNvbnN0IGhhc1BsdXMgPSB2YWx1ZS5pbmRleE9mKCcrJykgIT09IC0xO1xuICAgICAgY29uc3QgaGFzU2xhc2ggPSB2YWx1ZS5pbmRleE9mKCcvJykgIT09IC0xO1xuICAgICAgaWYgKGhhc1BsdXMgfHwgaGFzU2xhc2gpIHtcbiAgICAgICAgY29uc3QgaW52YWxpZENoYXIgPSBoYXNQbHVzID8gJysnIDogJy8nO1xuICAgICAgICB0aHJvdyBpbnZhbGlkRm9ybWF0KFxuICAgICAgICAgIGZvcm1hdCxcbiAgICAgICAgICBcIkludmFsaWQgY2hhcmFjdGVyICdcIiArIGludmFsaWRDaGFyICsgXCInIGZvdW5kOiBpcyBpdCBiYXNlNjQgZW5jb2RlZD9cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC8tL2csICcrJykucmVwbGFjZSgvXy9nLCAnLycpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGRlZmF1bHQ6XG4gICAgLy8gZG8gbm90aGluZ1xuICB9XG4gIGxldCBieXRlcztcbiAgdHJ5IHtcbiAgICBieXRlcyA9IGRlY29kZUJhc2U2NCh2YWx1ZSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBpZiAoKGUgYXMgRXJyb3IpLm1lc3NhZ2UuaW5jbHVkZXMoJ3BvbHlmaWxsJykpIHtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICAgIHRocm93IGludmFsaWRGb3JtYXQoZm9ybWF0LCAnSW52YWxpZCBjaGFyYWN0ZXIgZm91bmQnKTtcbiAgfVxuICBjb25zdCBhcnJheSA9IG5ldyBVaW50OEFycmF5KGJ5dGVzLmxlbmd0aCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYnl0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICBhcnJheVtpXSA9IGJ5dGVzLmNoYXJDb2RlQXQoaSk7XG4gIH1cbiAgcmV0dXJuIGFycmF5O1xufVxuXG5jbGFzcyBEYXRhVVJMUGFydHMge1xuICBiYXNlNjQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgY29udGVudFR5cGU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICByZXN0OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoZGF0YVVSTDogc3RyaW5nKSB7XG4gICAgY29uc3QgbWF0Y2hlcyA9IGRhdGFVUkwubWF0Y2goL15kYXRhOihbXixdKyk/LC8pO1xuICAgIGlmIChtYXRjaGVzID09PSBudWxsKSB7XG4gICAgICB0aHJvdyBpbnZhbGlkRm9ybWF0KFxuICAgICAgICBTdHJpbmdGb3JtYXQuREFUQV9VUkwsXG4gICAgICAgIFwiTXVzdCBiZSBmb3JtYXR0ZWQgJ2RhdGE6WzxtZWRpYXR5cGU+XVs7YmFzZTY0XSw8ZGF0YT5cIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgbWlkZGxlID0gbWF0Y2hlc1sxXSB8fCBudWxsO1xuICAgIGlmIChtaWRkbGUgIT0gbnVsbCkge1xuICAgICAgdGhpcy5iYXNlNjQgPSBlbmRzV2l0aChtaWRkbGUsICc7YmFzZTY0Jyk7XG4gICAgICB0aGlzLmNvbnRlbnRUeXBlID0gdGhpcy5iYXNlNjRcbiAgICAgICAgPyBtaWRkbGUuc3Vic3RyaW5nKDAsIG1pZGRsZS5sZW5ndGggLSAnO2Jhc2U2NCcubGVuZ3RoKVxuICAgICAgICA6IG1pZGRsZTtcbiAgICB9XG4gICAgdGhpcy5yZXN0ID0gZGF0YVVSTC5zdWJzdHJpbmcoZGF0YVVSTC5pbmRleE9mKCcsJykgKyAxKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGF0YVVSTEJ5dGVzXyhkYXRhVXJsOiBzdHJpbmcpOiBVaW50OEFycmF5IHtcbiAgY29uc3QgcGFydHMgPSBuZXcgRGF0YVVSTFBhcnRzKGRhdGFVcmwpO1xuICBpZiAocGFydHMuYmFzZTY0KSB7XG4gICAgcmV0dXJuIGJhc2U2NEJ5dGVzXyhTdHJpbmdGb3JtYXQuQkFTRTY0LCBwYXJ0cy5yZXN0KTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gcGVyY2VudEVuY29kZWRCeXRlc18ocGFydHMucmVzdCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRhdGFVUkxDb250ZW50VHlwZV8oZGF0YVVybDogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IHBhcnRzID0gbmV3IERhdGFVUkxQYXJ0cyhkYXRhVXJsKTtcbiAgcmV0dXJuIHBhcnRzLmNvbnRlbnRUeXBlO1xufVxuXG5mdW5jdGlvbiBlbmRzV2l0aChzOiBzdHJpbmcsIGVuZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IGxvbmdFbm91Z2ggPSBzLmxlbmd0aCA+PSBlbmQubGVuZ3RoO1xuICBpZiAoIWxvbmdFbm91Z2gpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gcy5zdWJzdHJpbmcocy5sZW5ndGggLSBlbmQubGVuZ3RoKSA9PT0gZW5kO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGUgUHJvdmlkZXMgYSBCbG9iLWxpa2Ugd3JhcHBlciBmb3IgdmFyaW91cyBiaW5hcnkgdHlwZXMgKGluY2x1ZGluZyB0aGVcbiAqIG5hdGl2ZSBCbG9iIHR5cGUpLiBUaGlzIG1ha2VzIGl0IHBvc3NpYmxlIHRvIHVwbG9hZCB0eXBlcyBsaWtlIEFycmF5QnVmZmVycyxcbiAqIG1ha2luZyB1cGxvYWRzIHBvc3NpYmxlIGluIGVudmlyb25tZW50cyB3aXRob3V0IHRoZSBuYXRpdmUgQmxvYiB0eXBlLlxuICovXG5pbXBvcnQgeyBzbGljZUJsb2IsIGdldEJsb2IgfSBmcm9tICcuL2ZzJztcbmltcG9ydCB7IFN0cmluZ0Zvcm1hdCwgZGF0YUZyb21TdHJpbmcgfSBmcm9tICcuL3N0cmluZyc7XG5pbXBvcnQgeyBpc05hdGl2ZUJsb2IsIGlzTmF0aXZlQmxvYkRlZmluZWQsIGlzU3RyaW5nIH0gZnJvbSAnLi90eXBlJztcblxuLyoqXG4gKiBAcGFyYW0gb3B0X2VsaWRlQ29weSAtIElmIHRydWUsIGRvZXNuJ3QgY29weSBtdXRhYmxlIGlucHV0IGRhdGFcbiAqICAgICAoZS5nLiBVaW50OEFycmF5cykuIFBhc3MgdHJ1ZSBvbmx5IGlmIHlvdSBrbm93IHRoZSBvYmplY3RzIHdpbGwgbm90IGJlXG4gKiAgICAgbW9kaWZpZWQgYWZ0ZXIgdGhpcyBibG9iJ3MgY29uc3RydWN0aW9uLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgY2xhc3MgRmJzQmxvYiB7XG4gIHByaXZhdGUgZGF0YV8hOiBCbG9iIHwgVWludDhBcnJheTtcbiAgcHJpdmF0ZSBzaXplXzogbnVtYmVyO1xuICBwcml2YXRlIHR5cGVfOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoZGF0YTogQmxvYiB8IFVpbnQ4QXJyYXkgfCBBcnJheUJ1ZmZlciwgZWxpZGVDb3B5PzogYm9vbGVhbikge1xuICAgIGxldCBzaXplOiBudW1iZXIgPSAwO1xuICAgIGxldCBibG9iVHlwZTogc3RyaW5nID0gJyc7XG4gICAgaWYgKGlzTmF0aXZlQmxvYihkYXRhKSkge1xuICAgICAgdGhpcy5kYXRhXyA9IGRhdGEgYXMgQmxvYjtcbiAgICAgIHNpemUgPSAoZGF0YSBhcyBCbG9iKS5zaXplO1xuICAgICAgYmxvYlR5cGUgPSAoZGF0YSBhcyBCbG9iKS50eXBlO1xuICAgIH0gZWxzZSBpZiAoZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICBpZiAoZWxpZGVDb3B5KSB7XG4gICAgICAgIHRoaXMuZGF0YV8gPSBuZXcgVWludDhBcnJheShkYXRhKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZGF0YV8gPSBuZXcgVWludDhBcnJheShkYXRhLmJ5dGVMZW5ndGgpO1xuICAgICAgICB0aGlzLmRhdGFfLnNldChuZXcgVWludDhBcnJheShkYXRhKSk7XG4gICAgICB9XG4gICAgICBzaXplID0gdGhpcy5kYXRhXy5sZW5ndGg7XG4gICAgfSBlbHNlIGlmIChkYXRhIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgaWYgKGVsaWRlQ29weSkge1xuICAgICAgICB0aGlzLmRhdGFfID0gZGF0YSBhcyBVaW50OEFycmF5O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5kYXRhXyA9IG5ldyBVaW50OEFycmF5KGRhdGEubGVuZ3RoKTtcbiAgICAgICAgdGhpcy5kYXRhXy5zZXQoZGF0YSBhcyBVaW50OEFycmF5KTtcbiAgICAgIH1cbiAgICAgIHNpemUgPSBkYXRhLmxlbmd0aDtcbiAgICB9XG4gICAgdGhpcy5zaXplXyA9IHNpemU7XG4gICAgdGhpcy50eXBlXyA9IGJsb2JUeXBlO1xuICB9XG5cbiAgc2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnNpemVfO1xuICB9XG5cbiAgdHlwZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnR5cGVfO1xuICB9XG5cbiAgc2xpY2Uoc3RhcnRCeXRlOiBudW1iZXIsIGVuZEJ5dGU6IG51bWJlcik6IEZic0Jsb2IgfCBudWxsIHtcbiAgICBpZiAoaXNOYXRpdmVCbG9iKHRoaXMuZGF0YV8pKSB7XG4gICAgICBjb25zdCByZWFsQmxvYiA9IHRoaXMuZGF0YV8gYXMgQmxvYjtcbiAgICAgIGNvbnN0IHNsaWNlZCA9IHNsaWNlQmxvYihyZWFsQmxvYiwgc3RhcnRCeXRlLCBlbmRCeXRlKTtcbiAgICAgIGlmIChzbGljZWQgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IEZic0Jsb2Ioc2xpY2VkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qgc2xpY2UgPSBuZXcgVWludDhBcnJheShcbiAgICAgICAgKHRoaXMuZGF0YV8gYXMgVWludDhBcnJheSkuYnVmZmVyLFxuICAgICAgICBzdGFydEJ5dGUsXG4gICAgICAgIGVuZEJ5dGUgLSBzdGFydEJ5dGVcbiAgICAgICk7XG4gICAgICByZXR1cm4gbmV3IEZic0Jsb2Ioc2xpY2UsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBnZXRCbG9iKC4uLmFyZ3M6IEFycmF5PHN0cmluZyB8IEZic0Jsb2I+KTogRmJzQmxvYiB8IG51bGwge1xuICAgIGlmIChpc05hdGl2ZUJsb2JEZWZpbmVkKCkpIHtcbiAgICAgIGNvbnN0IGJsb2JieTogQXJyYXk8QmxvYiB8IFVpbnQ4QXJyYXkgfCBzdHJpbmc+ID0gYXJncy5tYXAoXG4gICAgICAgICh2YWw6IHN0cmluZyB8IEZic0Jsb2IpOiBCbG9iIHwgVWludDhBcnJheSB8IHN0cmluZyA9PiB7XG4gICAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIEZic0Jsb2IpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWwuZGF0YV87XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB2YWw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIG5ldyBGYnNCbG9iKGdldEJsb2IuYXBwbHkobnVsbCwgYmxvYmJ5KSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHVpbnQ4QXJyYXlzOiBVaW50OEFycmF5W10gPSBhcmdzLm1hcChcbiAgICAgICAgKHZhbDogc3RyaW5nIHwgRmJzQmxvYik6IFVpbnQ4QXJyYXkgPT4ge1xuICAgICAgICAgIGlmIChpc1N0cmluZyh2YWwpKSB7XG4gICAgICAgICAgICByZXR1cm4gZGF0YUZyb21TdHJpbmcoU3RyaW5nRm9ybWF0LlJBVywgdmFsIGFzIHN0cmluZykuZGF0YTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQmxvYnMgZG9uJ3QgZXhpc3QsIHNvIHRoaXMgaGFzIHRvIGJlIGEgVWludDhBcnJheS5cbiAgICAgICAgICAgIHJldHVybiAodmFsIGFzIEZic0Jsb2IpLmRhdGFfIGFzIFVpbnQ4QXJyYXk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgbGV0IGZpbmFsTGVuZ3RoID0gMDtcbiAgICAgIHVpbnQ4QXJyYXlzLmZvckVhY2goKGFycmF5OiBVaW50OEFycmF5KTogdm9pZCA9PiB7XG4gICAgICAgIGZpbmFsTGVuZ3RoICs9IGFycmF5LmJ5dGVMZW5ndGg7XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IG1lcmdlZCA9IG5ldyBVaW50OEFycmF5KGZpbmFsTGVuZ3RoKTtcbiAgICAgIGxldCBpbmRleCA9IDA7XG4gICAgICB1aW50OEFycmF5cy5mb3JFYWNoKChhcnJheTogVWludDhBcnJheSkgPT4ge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgbWVyZ2VkW2luZGV4KytdID0gYXJyYXlbaV07XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG5ldyBGYnNCbG9iKG1lcmdlZCwgdHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgdXBsb2FkRGF0YSgpOiBCbG9iIHwgVWludDhBcnJheSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YV87XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgaXNOb25BcnJheU9iamVjdCB9IGZyb20gJy4vdHlwZSc7XG5cbi8qKlxuICogUmV0dXJucyB0aGUgT2JqZWN0IHJlc3VsdGluZyBmcm9tIHBhcnNpbmcgdGhlIGdpdmVuIEpTT04sIG9yIG51bGwgaWYgdGhlXG4gKiBnaXZlbiBzdHJpbmcgZG9lcyBub3QgcmVwcmVzZW50IGEgSlNPTiBvYmplY3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBqc29uT2JqZWN0T3JOdWxsKFxuICBzOiBzdHJpbmdcbik6IHsgW25hbWU6IHN0cmluZ106IHVua25vd24gfSB8IG51bGwge1xuICBsZXQgb2JqO1xuICB0cnkge1xuICAgIG9iaiA9IEpTT04ucGFyc2Uocyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAoaXNOb25BcnJheU9iamVjdChvYmopKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBDb250YWlucyBoZWxwZXIgbWV0aG9kcyBmb3IgbWFuaXB1bGF0aW5nIHBhdGhzLlxuICovXG5cbi8qKlxuICogQHJldHVybiBOdWxsIGlmIHRoZSBwYXRoIGlzIGFscmVhZHkgYXQgdGhlIHJvb3QuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJlbnQocGF0aDogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmIChwYXRoLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGluZGV4ID0gcGF0aC5sYXN0SW5kZXhPZignLycpO1xuICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgcmV0dXJuICcnO1xuICB9XG4gIGNvbnN0IG5ld1BhdGggPSBwYXRoLnNsaWNlKDAsIGluZGV4KTtcbiAgcmV0dXJuIG5ld1BhdGg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGlsZChwYXRoOiBzdHJpbmcsIGNoaWxkUGF0aDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgY2Fub25pY2FsQ2hpbGRQYXRoID0gY2hpbGRQYXRoXG4gICAgLnNwbGl0KCcvJylcbiAgICAuZmlsdGVyKGNvbXBvbmVudCA9PiBjb21wb25lbnQubGVuZ3RoID4gMClcbiAgICAuam9pbignLycpO1xuICBpZiAocGF0aC5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gY2Fub25pY2FsQ2hpbGRQYXRoO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBwYXRoICsgJy8nICsgY2Fub25pY2FsQ2hpbGRQYXRoO1xuICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgbGFzdCBjb21wb25lbnQgb2YgYSBwYXRoLlxuICogJy9mb28vYmFyJyAtPiAnYmFyJ1xuICogJy9mb28vYmFyL2Jhei8nIC0+ICdiYXovJ1xuICogJy9hJyAtPiAnYSdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxhc3RDb21wb25lbnQocGF0aDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgaW5kZXggPSBwYXRoLmxhc3RJbmRleE9mKCcvJywgcGF0aC5sZW5ndGggLSAyKTtcbiAgaWYgKGluZGV4ID09PSAtMSkge1xuICAgIHJldHVybiBwYXRoO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBwYXRoLnNsaWNlKGluZGV4ICsgMSk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgRG9jdW1lbnRhdGlvbiBmb3IgdGhlIG1ldGFkYXRhIGZvcm1hdFxuICovXG5pbXBvcnQgeyBNZXRhZGF0YSB9IGZyb20gJy4uL21ldGFkYXRhJztcblxuaW1wb3J0IHsganNvbk9iamVjdE9yTnVsbCB9IGZyb20gJy4vanNvbic7XG5pbXBvcnQgeyBMb2NhdGlvbiB9IGZyb20gJy4vbG9jYXRpb24nO1xuaW1wb3J0IHsgbGFzdENvbXBvbmVudCB9IGZyb20gJy4vcGF0aCc7XG5pbXBvcnQgeyBpc1N0cmluZyB9IGZyb20gJy4vdHlwZSc7XG5pbXBvcnQgeyBtYWtlVXJsLCBtYWtlUXVlcnlTdHJpbmcgfSBmcm9tICcuL3VybCc7XG5pbXBvcnQgeyBSZWZlcmVuY2UgfSBmcm9tICcuLi9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgRmlyZWJhc2VTdG9yYWdlSW1wbCB9IGZyb20gJy4uL3NlcnZpY2UnO1xuXG5leHBvcnQgZnVuY3Rpb24gbm9YZm9ybV88VD4obWV0YWRhdGE6IE1ldGFkYXRhLCB2YWx1ZTogVCk6IFQge1xuICByZXR1cm4gdmFsdWU7XG59XG5cbmNsYXNzIE1hcHBpbmc8VD4ge1xuICBsb2NhbDogc3RyaW5nO1xuICB3cml0YWJsZTogYm9vbGVhbjtcbiAgeGZvcm06IChwMTogTWV0YWRhdGEsIHAyPzogVCkgPT4gVCB8IHVuZGVmaW5lZDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgc2VydmVyOiBzdHJpbmcsXG4gICAgbG9jYWw/OiBzdHJpbmcgfCBudWxsLFxuICAgIHdyaXRhYmxlPzogYm9vbGVhbixcbiAgICB4Zm9ybT86ICgocDE6IE1ldGFkYXRhLCBwMj86IFQpID0+IFQgfCB1bmRlZmluZWQpIHwgbnVsbFxuICApIHtcbiAgICB0aGlzLmxvY2FsID0gbG9jYWwgfHwgc2VydmVyO1xuICAgIHRoaXMud3JpdGFibGUgPSAhIXdyaXRhYmxlO1xuICAgIHRoaXMueGZvcm0gPSB4Zm9ybSB8fCBub1hmb3JtXztcbiAgfVxufVxudHlwZSBNYXBwaW5ncyA9IEFycmF5PE1hcHBpbmc8c3RyaW5nPiB8IE1hcHBpbmc8bnVtYmVyPj47XG5cbmV4cG9ydCB7IE1hcHBpbmdzIH07XG5cbmxldCBtYXBwaW5nc186IE1hcHBpbmdzIHwgbnVsbCA9IG51bGw7XG5cbmV4cG9ydCBmdW5jdGlvbiB4Zm9ybVBhdGgoZnVsbFBhdGg6IHN0cmluZyB8IHVuZGVmaW5lZCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIGlmICghaXNTdHJpbmcoZnVsbFBhdGgpIHx8IGZ1bGxQYXRoLmxlbmd0aCA8IDIpIHtcbiAgICByZXR1cm4gZnVsbFBhdGg7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGxhc3RDb21wb25lbnQoZnVsbFBhdGgpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXBwaW5ncygpOiBNYXBwaW5ncyB7XG4gIGlmIChtYXBwaW5nc18pIHtcbiAgICByZXR1cm4gbWFwcGluZ3NfO1xuICB9XG4gIGNvbnN0IG1hcHBpbmdzOiBNYXBwaW5ncyA9IFtdO1xuICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nPHN0cmluZz4oJ2J1Y2tldCcpKTtcbiAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZzxzdHJpbmc+KCdnZW5lcmF0aW9uJykpO1xuICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nPHN0cmluZz4oJ21ldGFnZW5lcmF0aW9uJykpO1xuICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nPHN0cmluZz4oJ25hbWUnLCAnZnVsbFBhdGgnLCB0cnVlKSk7XG5cbiAgZnVuY3Rpb24gbWFwcGluZ3NYZm9ybVBhdGgoXG4gICAgX21ldGFkYXRhOiBNZXRhZGF0YSxcbiAgICBmdWxsUGF0aDogc3RyaW5nIHwgdW5kZWZpbmVkXG4gICk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHhmb3JtUGF0aChmdWxsUGF0aCk7XG4gIH1cbiAgY29uc3QgbmFtZU1hcHBpbmcgPSBuZXcgTWFwcGluZzxzdHJpbmc+KCduYW1lJyk7XG4gIG5hbWVNYXBwaW5nLnhmb3JtID0gbWFwcGluZ3NYZm9ybVBhdGg7XG4gIG1hcHBpbmdzLnB1c2gobmFtZU1hcHBpbmcpO1xuXG4gIC8qKlxuICAgKiBDb2VyY2VzIHRoZSBzZWNvbmQgcGFyYW0gdG8gYSBudW1iZXIsIGlmIGl0IGlzIGRlZmluZWQuXG4gICAqL1xuICBmdW5jdGlvbiB4Zm9ybVNpemUoXG4gICAgX21ldGFkYXRhOiBNZXRhZGF0YSxcbiAgICBzaXplPzogbnVtYmVyIHwgc3RyaW5nXG4gICk6IG51bWJlciB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKHNpemUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIE51bWJlcihzaXplKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHNpemU7XG4gICAgfVxuICB9XG4gIGNvbnN0IHNpemVNYXBwaW5nID0gbmV3IE1hcHBpbmc8bnVtYmVyPignc2l6ZScpO1xuICBzaXplTWFwcGluZy54Zm9ybSA9IHhmb3JtU2l6ZTtcbiAgbWFwcGluZ3MucHVzaChzaXplTWFwcGluZyk7XG4gIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmc8bnVtYmVyPigndGltZUNyZWF0ZWQnKSk7XG4gIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmc8c3RyaW5nPigndXBkYXRlZCcpKTtcbiAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZzxzdHJpbmc+KCdtZDVIYXNoJywgbnVsbCwgdHJ1ZSkpO1xuICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nPHN0cmluZz4oJ2NhY2hlQ29udHJvbCcsIG51bGwsIHRydWUpKTtcbiAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZzxzdHJpbmc+KCdjb250ZW50RGlzcG9zaXRpb24nLCBudWxsLCB0cnVlKSk7XG4gIG1hcHBpbmdzLnB1c2gobmV3IE1hcHBpbmc8c3RyaW5nPignY29udGVudEVuY29kaW5nJywgbnVsbCwgdHJ1ZSkpO1xuICBtYXBwaW5ncy5wdXNoKG5ldyBNYXBwaW5nPHN0cmluZz4oJ2NvbnRlbnRMYW5ndWFnZScsIG51bGwsIHRydWUpKTtcbiAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZzxzdHJpbmc+KCdjb250ZW50VHlwZScsIG51bGwsIHRydWUpKTtcbiAgbWFwcGluZ3MucHVzaChuZXcgTWFwcGluZzxzdHJpbmc+KCdtZXRhZGF0YScsICdjdXN0b21NZXRhZGF0YScsIHRydWUpKTtcbiAgbWFwcGluZ3NfID0gbWFwcGluZ3M7XG4gIHJldHVybiBtYXBwaW5nc187XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRSZWYobWV0YWRhdGE6IE1ldGFkYXRhLCBzZXJ2aWNlOiBGaXJlYmFzZVN0b3JhZ2VJbXBsKTogdm9pZCB7XG4gIGZ1bmN0aW9uIGdlbmVyYXRlUmVmKCk6IFJlZmVyZW5jZSB7XG4gICAgY29uc3QgYnVja2V0OiBzdHJpbmcgPSBtZXRhZGF0YVsnYnVja2V0J10gYXMgc3RyaW5nO1xuICAgIGNvbnN0IHBhdGg6IHN0cmluZyA9IG1ldGFkYXRhWydmdWxsUGF0aCddIGFzIHN0cmluZztcbiAgICBjb25zdCBsb2MgPSBuZXcgTG9jYXRpb24oYnVja2V0LCBwYXRoKTtcbiAgICByZXR1cm4gc2VydmljZS5fbWFrZVN0b3JhZ2VSZWZlcmVuY2UobG9jKTtcbiAgfVxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkobWV0YWRhdGEsICdyZWYnLCB7IGdldDogZ2VuZXJhdGVSZWYgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmcm9tUmVzb3VyY2UoXG4gIHNlcnZpY2U6IEZpcmViYXNlU3RvcmFnZUltcGwsXG4gIHJlc291cmNlOiB7IFtuYW1lOiBzdHJpbmddOiB1bmtub3duIH0sXG4gIG1hcHBpbmdzOiBNYXBwaW5nc1xuKTogTWV0YWRhdGEge1xuICBjb25zdCBtZXRhZGF0YTogTWV0YWRhdGEgPSB7fSBhcyBNZXRhZGF0YTtcbiAgbWV0YWRhdGFbJ3R5cGUnXSA9ICdmaWxlJztcbiAgY29uc3QgbGVuID0gbWFwcGluZ3MubGVuZ3RoO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgY29uc3QgbWFwcGluZyA9IG1hcHBpbmdzW2ldO1xuICAgIG1ldGFkYXRhW21hcHBpbmcubG9jYWxdID0gKG1hcHBpbmcgYXMgTWFwcGluZzx1bmtub3duPikueGZvcm0oXG4gICAgICBtZXRhZGF0YSxcbiAgICAgIHJlc291cmNlW21hcHBpbmcuc2VydmVyXVxuICAgICk7XG4gIH1cbiAgYWRkUmVmKG1ldGFkYXRhLCBzZXJ2aWNlKTtcbiAgcmV0dXJuIG1ldGFkYXRhO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZnJvbVJlc291cmNlU3RyaW5nKFxuICBzZXJ2aWNlOiBGaXJlYmFzZVN0b3JhZ2VJbXBsLFxuICByZXNvdXJjZVN0cmluZzogc3RyaW5nLFxuICBtYXBwaW5nczogTWFwcGluZ3Ncbik6IE1ldGFkYXRhIHwgbnVsbCB7XG4gIGNvbnN0IG9iaiA9IGpzb25PYmplY3RPck51bGwocmVzb3VyY2VTdHJpbmcpO1xuICBpZiAob2JqID09PSBudWxsKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgcmVzb3VyY2UgPSBvYmogYXMgTWV0YWRhdGE7XG4gIHJldHVybiBmcm9tUmVzb3VyY2Uoc2VydmljZSwgcmVzb3VyY2UsIG1hcHBpbmdzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRvd25sb2FkVXJsRnJvbVJlc291cmNlU3RyaW5nKFxuICBtZXRhZGF0YTogTWV0YWRhdGEsXG4gIHJlc291cmNlU3RyaW5nOiBzdHJpbmcsXG4gIGhvc3Q6IHN0cmluZyxcbiAgcHJvdG9jb2w6IHN0cmluZ1xuKTogc3RyaW5nIHwgbnVsbCB7XG4gIGNvbnN0IG9iaiA9IGpzb25PYmplY3RPck51bGwocmVzb3VyY2VTdHJpbmcpO1xuICBpZiAob2JqID09PSBudWxsKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgaWYgKCFpc1N0cmluZyhvYmpbJ2Rvd25sb2FkVG9rZW5zJ10pKSB7XG4gICAgLy8gVGhpcyBjYW4gaGFwcGVuIGlmIG9iamVjdHMgYXJlIHVwbG9hZGVkIHRocm91Z2ggR0NTIGFuZCByZXRyaWV2ZWRcbiAgICAvLyB0aHJvdWdoIGxpc3QsIHNvIHdlIGRvbid0IHdhbnQgdG8gdGhyb3cgYW4gRXJyb3IuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgdG9rZW5zOiBzdHJpbmcgPSBvYmpbJ2Rvd25sb2FkVG9rZW5zJ10gYXMgc3RyaW5nO1xuICBpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGVuY29kZSA9IGVuY29kZVVSSUNvbXBvbmVudDtcbiAgY29uc3QgdG9rZW5zTGlzdCA9IHRva2Vucy5zcGxpdCgnLCcpO1xuICBjb25zdCB1cmxzID0gdG9rZW5zTGlzdC5tYXAoKHRva2VuOiBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICAgIGNvbnN0IGJ1Y2tldDogc3RyaW5nID0gbWV0YWRhdGFbJ2J1Y2tldCddIGFzIHN0cmluZztcbiAgICBjb25zdCBwYXRoOiBzdHJpbmcgPSBtZXRhZGF0YVsnZnVsbFBhdGgnXSBhcyBzdHJpbmc7XG4gICAgY29uc3QgdXJsUGFydCA9ICcvYi8nICsgZW5jb2RlKGJ1Y2tldCkgKyAnL28vJyArIGVuY29kZShwYXRoKTtcbiAgICBjb25zdCBiYXNlID0gbWFrZVVybCh1cmxQYXJ0LCBob3N0LCBwcm90b2NvbCk7XG4gICAgY29uc3QgcXVlcnlTdHJpbmcgPSBtYWtlUXVlcnlTdHJpbmcoe1xuICAgICAgYWx0OiAnbWVkaWEnLFxuICAgICAgdG9rZW5cbiAgICB9KTtcbiAgICByZXR1cm4gYmFzZSArIHF1ZXJ5U3RyaW5nO1xuICB9KTtcbiAgcmV0dXJuIHVybHNbMF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0b1Jlc291cmNlU3RyaW5nKFxuICBtZXRhZGF0YTogUGFydGlhbDxNZXRhZGF0YT4sXG4gIG1hcHBpbmdzOiBNYXBwaW5nc1xuKTogc3RyaW5nIHtcbiAgY29uc3QgcmVzb3VyY2U6IHtcbiAgICBbcHJvcDogc3RyaW5nXTogdW5rbm93bjtcbiAgfSA9IHt9O1xuICBjb25zdCBsZW4gPSBtYXBwaW5ncy5sZW5ndGg7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICBjb25zdCBtYXBwaW5nID0gbWFwcGluZ3NbaV07XG4gICAgaWYgKG1hcHBpbmcud3JpdGFibGUpIHtcbiAgICAgIHJlc291cmNlW21hcHBpbmcuc2VydmVyXSA9IG1ldGFkYXRhW21hcHBpbmcubG9jYWxdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocmVzb3VyY2UpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGZpbGVvdmVydmlldyBEb2N1bWVudGF0aW9uIGZvciB0aGUgbGlzdE9wdGlvbnMgYW5kIGxpc3RSZXN1bHQgZm9ybWF0XG4gKi9cbmltcG9ydCB7IExvY2F0aW9uIH0gZnJvbSAnLi9sb2NhdGlvbic7XG5pbXBvcnQgeyBqc29uT2JqZWN0T3JOdWxsIH0gZnJvbSAnLi9qc29uJztcbmltcG9ydCB7IExpc3RSZXN1bHQgfSBmcm9tICcuLi9saXN0JztcbmltcG9ydCB7IEZpcmViYXNlU3RvcmFnZUltcGwgfSBmcm9tICcuLi9zZXJ2aWNlJztcblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBzaW1wbGlmaWVkIG9iamVjdCBtZXRhZGF0YSByZXR1cm5lZCBieSBMaXN0IEFQSS5cbiAqIE90aGVyIGZpZWxkcyBhcmUgZmlsdGVyZWQgYmVjYXVzZSBsaXN0IGluIEZpcmViYXNlIFJ1bGVzIGRvZXMgbm90IGdyYW50XG4gKiB0aGUgcGVybWlzc2lvbiB0byByZWFkIHRoZSBtZXRhZGF0YS5cbiAqL1xuaW50ZXJmYWNlIExpc3RNZXRhZGF0YVJlc3BvbnNlIHtcbiAgbmFtZTogc3RyaW5nO1xuICBidWNrZXQ6IHN0cmluZztcbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBKU09OIHJlc3BvbnNlIG9mIExpc3QgQVBJLlxuICovXG5pbnRlcmZhY2UgTGlzdFJlc3VsdFJlc3BvbnNlIHtcbiAgcHJlZml4ZXM6IHN0cmluZ1tdO1xuICBpdGVtczogTGlzdE1ldGFkYXRhUmVzcG9uc2VbXTtcbiAgbmV4dFBhZ2VUb2tlbj86IHN0cmluZztcbn1cblxuY29uc3QgUFJFRklYRVNfS0VZID0gJ3ByZWZpeGVzJztcbmNvbnN0IElURU1TX0tFWSA9ICdpdGVtcyc7XG5cbmZ1bmN0aW9uIGZyb21CYWNrZW5kUmVzcG9uc2UoXG4gIHNlcnZpY2U6IEZpcmViYXNlU3RvcmFnZUltcGwsXG4gIGJ1Y2tldDogc3RyaW5nLFxuICByZXNvdXJjZTogTGlzdFJlc3VsdFJlc3BvbnNlXG4pOiBMaXN0UmVzdWx0IHtcbiAgY29uc3QgbGlzdFJlc3VsdDogTGlzdFJlc3VsdCA9IHtcbiAgICBwcmVmaXhlczogW10sXG4gICAgaXRlbXM6IFtdLFxuICAgIG5leHRQYWdlVG9rZW46IHJlc291cmNlWyduZXh0UGFnZVRva2VuJ11cbiAgfTtcbiAgaWYgKHJlc291cmNlW1BSRUZJWEVTX0tFWV0pIHtcbiAgICBmb3IgKGNvbnN0IHBhdGggb2YgcmVzb3VyY2VbUFJFRklYRVNfS0VZXSkge1xuICAgICAgY29uc3QgcGF0aFdpdGhvdXRUcmFpbGluZ1NsYXNoID0gcGF0aC5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgICAgY29uc3QgcmVmZXJlbmNlID0gc2VydmljZS5fbWFrZVN0b3JhZ2VSZWZlcmVuY2UoXG4gICAgICAgIG5ldyBMb2NhdGlvbihidWNrZXQsIHBhdGhXaXRob3V0VHJhaWxpbmdTbGFzaClcbiAgICAgICk7XG4gICAgICBsaXN0UmVzdWx0LnByZWZpeGVzLnB1c2gocmVmZXJlbmNlKTtcbiAgICB9XG4gIH1cblxuICBpZiAocmVzb3VyY2VbSVRFTVNfS0VZXSkge1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiByZXNvdXJjZVtJVEVNU19LRVldKSB7XG4gICAgICBjb25zdCByZWZlcmVuY2UgPSBzZXJ2aWNlLl9tYWtlU3RvcmFnZVJlZmVyZW5jZShcbiAgICAgICAgbmV3IExvY2F0aW9uKGJ1Y2tldCwgaXRlbVsnbmFtZSddKVxuICAgICAgKTtcbiAgICAgIGxpc3RSZXN1bHQuaXRlbXMucHVzaChyZWZlcmVuY2UpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gbGlzdFJlc3VsdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZyb21SZXNwb25zZVN0cmluZyhcbiAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgYnVja2V0OiBzdHJpbmcsXG4gIHJlc291cmNlU3RyaW5nOiBzdHJpbmdcbik6IExpc3RSZXN1bHQgfCBudWxsIHtcbiAgY29uc3Qgb2JqID0ganNvbk9iamVjdE9yTnVsbChyZXNvdXJjZVN0cmluZyk7XG4gIGlmIChvYmogPT09IG51bGwpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCByZXNvdXJjZSA9IG9iaiBhcyB1bmtub3duIGFzIExpc3RSZXN1bHRSZXNwb25zZTtcbiAgcmV0dXJuIGZyb21CYWNrZW5kUmVzcG9uc2Uoc2VydmljZSwgYnVja2V0LCByZXNvdXJjZSk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IFN0b3JhZ2VFcnJvciB9IGZyb20gJy4vZXJyb3InO1xuaW1wb3J0IHsgSGVhZGVycywgQ29ubmVjdGlvbiwgQ29ubmVjdGlvblR5cGUgfSBmcm9tICcuL2Nvbm5lY3Rpb24nO1xuXG4vKipcbiAqIFR5cGUgZm9yIHVybCBwYXJhbXMgc3RvcmVkIGluIFJlcXVlc3RJbmZvLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFVybFBhcmFtcyB7XG4gIFtuYW1lOiBzdHJpbmddOiBzdHJpbmcgfCBudW1iZXI7XG59XG5cbi8qKlxuICogQSBmdW5jdGlvbiB0aGF0IGNvbnZlcnRzIGEgc2VydmVyIHJlc3BvbnNlIHRvIHRoZSBBUEkgdHlwZSBleHBlY3RlZCBieSB0aGVcbiAqIFNESy5cbiAqXG4gKiBAcGFyYW0gSSAtIHRoZSB0eXBlIG9mIHRoZSBiYWNrZW5kJ3MgbmV0d29yayByZXNwb25zZVxuICogQHBhcmFtIE8gLSB0aGUgb3V0cHV0IHJlc3BvbnNlIHR5cGUgdXNlZCBieSB0aGUgcmVzdCBvZiB0aGUgU0RLLlxuICovXG5leHBvcnQgdHlwZSBSZXF1ZXN0SGFuZGxlcjxJIGV4dGVuZHMgQ29ubmVjdGlvblR5cGUsIE8+ID0gKFxuICBjb25uZWN0aW9uOiBDb25uZWN0aW9uPEk+LFxuICByZXNwb25zZTogSVxuKSA9PiBPO1xuXG4vKiogQSBmdW5jdGlvbiB0byBoYW5kbGUgYW4gZXJyb3IuICovXG5leHBvcnQgdHlwZSBFcnJvckhhbmRsZXIgPSAoXG4gIGNvbm5lY3Rpb246IENvbm5lY3Rpb248Q29ubmVjdGlvblR5cGU+LFxuICByZXNwb25zZTogU3RvcmFnZUVycm9yXG4pID0+IFN0b3JhZ2VFcnJvcjtcblxuLyoqXG4gKiBDb250YWlucyBhIGZ1bGx5IHNwZWNpZmllZCByZXF1ZXN0LlxuICpcbiAqIEBwYXJhbSBJIC0gdGhlIHR5cGUgb2YgdGhlIGJhY2tlbmQncyBuZXR3b3JrIHJlc3BvbnNlLlxuICogQHBhcmFtIE8gLSB0aGUgb3V0cHV0IHJlc3BvbnNlIHR5cGUgdXNlZCBieSB0aGUgcmVzdCBvZiB0aGUgU0RLLlxuICovXG5leHBvcnQgY2xhc3MgUmVxdWVzdEluZm88SSBleHRlbmRzIENvbm5lY3Rpb25UeXBlLCBPPiB7XG4gIHVybFBhcmFtczogVXJsUGFyYW1zID0ge307XG4gIGhlYWRlcnM6IEhlYWRlcnMgPSB7fTtcbiAgYm9keTogQmxvYiB8IHN0cmluZyB8IFVpbnQ4QXJyYXkgfCBudWxsID0gbnVsbDtcbiAgZXJyb3JIYW5kbGVyOiBFcnJvckhhbmRsZXIgfCBudWxsID0gbnVsbDtcblxuICAvKipcbiAgICogQ2FsbGVkIHdpdGggdGhlIGN1cnJlbnQgbnVtYmVyIG9mIGJ5dGVzIHVwbG9hZGVkIGFuZCB0b3RhbCBzaXplICgtMSBpZiBub3RcbiAgICogY29tcHV0YWJsZSkgb2YgdGhlIHJlcXVlc3QgYm9keSAoaS5lLiB1c2VkIHRvIHJlcG9ydCB1cGxvYWQgcHJvZ3Jlc3MpLlxuICAgKi9cbiAgcHJvZ3Jlc3NDYWxsYmFjazogKChwMTogbnVtYmVyLCBwMjogbnVtYmVyKSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xuICBzdWNjZXNzQ29kZXM6IG51bWJlcltdID0gWzIwMF07XG4gIGFkZGl0aW9uYWxSZXRyeUNvZGVzOiBudW1iZXJbXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyB1cmw6IHN0cmluZyxcbiAgICBwdWJsaWMgbWV0aG9kOiBzdHJpbmcsXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdmFsdWUgd2l0aCB3aGljaCB0byByZXNvbHZlIHRoZSByZXF1ZXN0J3MgcHJvbWlzZS4gT25seSBjYWxsZWRcbiAgICAgKiBpZiB0aGUgcmVxdWVzdCBpcyBzdWNjZXNzZnVsLiBUaHJvdyBmcm9tIHRoaXMgZnVuY3Rpb24gdG8gcmVqZWN0IHRoZVxuICAgICAqIHJldHVybmVkIFJlcXVlc3QncyBwcm9taXNlIHdpdGggdGhlIHRocm93biBlcnJvci5cbiAgICAgKiBOb3RlOiBUaGUgWGhySW8gcGFzc2VkIHRvIHRoaXMgZnVuY3Rpb24gbWF5IGJlIHJldXNlZCBhZnRlciB0aGlzIGNhbGxiYWNrXG4gICAgICogcmV0dXJucy4gRG8gbm90IGtlZXAgYSByZWZlcmVuY2UgdG8gaXQgaW4gYW55IHdheS5cbiAgICAgKi9cbiAgICBwdWJsaWMgaGFuZGxlcjogUmVxdWVzdEhhbmRsZXI8SSwgTz4sXG4gICAgcHVibGljIHRpbWVvdXQ6IG51bWJlclxuICApIHt9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IERlZmluZXMgbWV0aG9kcyBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgbmV0d29yay5cbiAqL1xuXG5pbXBvcnQgeyBNZXRhZGF0YSB9IGZyb20gJy4uL21ldGFkYXRhJztcbmltcG9ydCB7IExpc3RSZXN1bHQgfSBmcm9tICcuLi9saXN0JztcbmltcG9ydCB7IEZic0Jsb2IgfSBmcm9tICcuL2Jsb2InO1xuaW1wb3J0IHtcbiAgU3RvcmFnZUVycm9yLFxuICBjYW5ub3RTbGljZUJsb2IsXG4gIHVuYXV0aGVudGljYXRlZCxcbiAgcXVvdGFFeGNlZWRlZCxcbiAgdW5hdXRob3JpemVkLFxuICBvYmplY3ROb3RGb3VuZCxcbiAgc2VydmVyRmlsZVdyb25nU2l6ZSxcbiAgdW5rbm93bixcbiAgdW5hdXRob3JpemVkQXBwXG59IGZyb20gJy4vZXJyb3InO1xuaW1wb3J0IHsgTG9jYXRpb24gfSBmcm9tICcuL2xvY2F0aW9uJztcbmltcG9ydCB7XG4gIE1hcHBpbmdzLFxuICBmcm9tUmVzb3VyY2VTdHJpbmcsXG4gIGRvd25sb2FkVXJsRnJvbVJlc291cmNlU3RyaW5nLFxuICB0b1Jlc291cmNlU3RyaW5nXG59IGZyb20gJy4vbWV0YWRhdGEnO1xuaW1wb3J0IHsgZnJvbVJlc3BvbnNlU3RyaW5nIH0gZnJvbSAnLi9saXN0JztcbmltcG9ydCB7IFJlcXVlc3RJbmZvLCBVcmxQYXJhbXMgfSBmcm9tICcuL3JlcXVlc3RpbmZvJztcbmltcG9ydCB7IGlzU3RyaW5nIH0gZnJvbSAnLi90eXBlJztcbmltcG9ydCB7IG1ha2VVcmwgfSBmcm9tICcuL3VybCc7XG5pbXBvcnQgeyBDb25uZWN0aW9uLCBDb25uZWN0aW9uVHlwZSB9IGZyb20gJy4vY29ubmVjdGlvbic7XG5pbXBvcnQgeyBGaXJlYmFzZVN0b3JhZ2VJbXBsIH0gZnJvbSAnLi4vc2VydmljZSc7XG5cbi8qKlxuICogVGhyb3dzIHRoZSBVTktOT1dOIFN0b3JhZ2VFcnJvciBpZiBjbmRuIGlzIGZhbHNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlckNoZWNrKGNuZG46IGJvb2xlYW4pOiB2b2lkIHtcbiAgaWYgKCFjbmRuKSB7XG4gICAgdGhyb3cgdW5rbm93bigpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXRhZGF0YUhhbmRsZXIoXG4gIHNlcnZpY2U6IEZpcmViYXNlU3RvcmFnZUltcGwsXG4gIG1hcHBpbmdzOiBNYXBwaW5nc1xuKTogKHAxOiBDb25uZWN0aW9uPHN0cmluZz4sIHAyOiBzdHJpbmcpID0+IE1ldGFkYXRhIHtcbiAgZnVuY3Rpb24gaGFuZGxlcih4aHI6IENvbm5lY3Rpb248c3RyaW5nPiwgdGV4dDogc3RyaW5nKTogTWV0YWRhdGEge1xuICAgIGNvbnN0IG1ldGFkYXRhID0gZnJvbVJlc291cmNlU3RyaW5nKHNlcnZpY2UsIHRleHQsIG1hcHBpbmdzKTtcbiAgICBoYW5kbGVyQ2hlY2sobWV0YWRhdGEgIT09IG51bGwpO1xuICAgIHJldHVybiBtZXRhZGF0YSBhcyBNZXRhZGF0YTtcbiAgfVxuICByZXR1cm4gaGFuZGxlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxpc3RIYW5kbGVyKFxuICBzZXJ2aWNlOiBGaXJlYmFzZVN0b3JhZ2VJbXBsLFxuICBidWNrZXQ6IHN0cmluZ1xuKTogKHAxOiBDb25uZWN0aW9uPHN0cmluZz4sIHAyOiBzdHJpbmcpID0+IExpc3RSZXN1bHQge1xuICBmdW5jdGlvbiBoYW5kbGVyKHhocjogQ29ubmVjdGlvbjxzdHJpbmc+LCB0ZXh0OiBzdHJpbmcpOiBMaXN0UmVzdWx0IHtcbiAgICBjb25zdCBsaXN0UmVzdWx0ID0gZnJvbVJlc3BvbnNlU3RyaW5nKHNlcnZpY2UsIGJ1Y2tldCwgdGV4dCk7XG4gICAgaGFuZGxlckNoZWNrKGxpc3RSZXN1bHQgIT09IG51bGwpO1xuICAgIHJldHVybiBsaXN0UmVzdWx0IGFzIExpc3RSZXN1bHQ7XG4gIH1cbiAgcmV0dXJuIGhhbmRsZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkb3dubG9hZFVybEhhbmRsZXIoXG4gIHNlcnZpY2U6IEZpcmViYXNlU3RvcmFnZUltcGwsXG4gIG1hcHBpbmdzOiBNYXBwaW5nc1xuKTogKHAxOiBDb25uZWN0aW9uPHN0cmluZz4sIHAyOiBzdHJpbmcpID0+IHN0cmluZyB8IG51bGwge1xuICBmdW5jdGlvbiBoYW5kbGVyKHhocjogQ29ubmVjdGlvbjxzdHJpbmc+LCB0ZXh0OiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBtZXRhZGF0YSA9IGZyb21SZXNvdXJjZVN0cmluZyhzZXJ2aWNlLCB0ZXh0LCBtYXBwaW5ncyk7XG4gICAgaGFuZGxlckNoZWNrKG1ldGFkYXRhICE9PSBudWxsKTtcbiAgICByZXR1cm4gZG93bmxvYWRVcmxGcm9tUmVzb3VyY2VTdHJpbmcoXG4gICAgICBtZXRhZGF0YSBhcyBNZXRhZGF0YSxcbiAgICAgIHRleHQsXG4gICAgICBzZXJ2aWNlLmhvc3QsXG4gICAgICBzZXJ2aWNlLl9wcm90b2NvbFxuICAgICk7XG4gIH1cbiAgcmV0dXJuIGhhbmRsZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaGFyZWRFcnJvckhhbmRsZXIoXG4gIGxvY2F0aW9uOiBMb2NhdGlvblxuKTogKHAxOiBDb25uZWN0aW9uPENvbm5lY3Rpb25UeXBlPiwgcDI6IFN0b3JhZ2VFcnJvcikgPT4gU3RvcmFnZUVycm9yIHtcbiAgZnVuY3Rpb24gZXJyb3JIYW5kbGVyKFxuICAgIHhocjogQ29ubmVjdGlvbjxDb25uZWN0aW9uVHlwZT4sXG4gICAgZXJyOiBTdG9yYWdlRXJyb3JcbiAgKTogU3RvcmFnZUVycm9yIHtcbiAgICBsZXQgbmV3RXJyOiBTdG9yYWdlRXJyb3I7XG4gICAgaWYgKHhoci5nZXRTdGF0dXMoKSA9PT0gNDAxKSB7XG4gICAgICBpZiAoXG4gICAgICAgIC8vIFRoaXMgZXhhY3QgbWVzc2FnZSBzdHJpbmcgaXMgdGhlIG9ubHkgY29uc2lzdGVudCBwYXJ0IG9mIHRoZVxuICAgICAgICAvLyBzZXJ2ZXIncyBlcnJvciByZXNwb25zZSB0aGF0IGlkZW50aWZpZXMgaXQgYXMgYW4gQXBwIENoZWNrIGVycm9yLlxuICAgICAgICB4aHIuZ2V0RXJyb3JUZXh0KCkuaW5jbHVkZXMoJ0ZpcmViYXNlIEFwcCBDaGVjayB0b2tlbiBpcyBpbnZhbGlkJylcbiAgICAgICkge1xuICAgICAgICBuZXdFcnIgPSB1bmF1dGhvcml6ZWRBcHAoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld0VyciA9IHVuYXV0aGVudGljYXRlZCgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoeGhyLmdldFN0YXR1cygpID09PSA0MDIpIHtcbiAgICAgICAgbmV3RXJyID0gcXVvdGFFeGNlZWRlZChsb2NhdGlvbi5idWNrZXQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHhoci5nZXRTdGF0dXMoKSA9PT0gNDAzKSB7XG4gICAgICAgICAgbmV3RXJyID0gdW5hdXRob3JpemVkKGxvY2F0aW9uLnBhdGgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld0VyciA9IGVycjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBuZXdFcnIuc3RhdHVzID0geGhyLmdldFN0YXR1cygpO1xuICAgIG5ld0Vyci5zZXJ2ZXJSZXNwb25zZSA9IGVyci5zZXJ2ZXJSZXNwb25zZTtcbiAgICByZXR1cm4gbmV3RXJyO1xuICB9XG4gIHJldHVybiBlcnJvckhhbmRsZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBvYmplY3RFcnJvckhhbmRsZXIoXG4gIGxvY2F0aW9uOiBMb2NhdGlvblxuKTogKHAxOiBDb25uZWN0aW9uPENvbm5lY3Rpb25UeXBlPiwgcDI6IFN0b3JhZ2VFcnJvcikgPT4gU3RvcmFnZUVycm9yIHtcbiAgY29uc3Qgc2hhcmVkID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcblxuICBmdW5jdGlvbiBlcnJvckhhbmRsZXIoXG4gICAgeGhyOiBDb25uZWN0aW9uPENvbm5lY3Rpb25UeXBlPixcbiAgICBlcnI6IFN0b3JhZ2VFcnJvclxuICApOiBTdG9yYWdlRXJyb3Ige1xuICAgIGxldCBuZXdFcnIgPSBzaGFyZWQoeGhyLCBlcnIpO1xuICAgIGlmICh4aHIuZ2V0U3RhdHVzKCkgPT09IDQwNCkge1xuICAgICAgbmV3RXJyID0gb2JqZWN0Tm90Rm91bmQobG9jYXRpb24ucGF0aCk7XG4gICAgfVxuICAgIG5ld0Vyci5zZXJ2ZXJSZXNwb25zZSA9IGVyci5zZXJ2ZXJSZXNwb25zZTtcbiAgICByZXR1cm4gbmV3RXJyO1xuICB9XG4gIHJldHVybiBlcnJvckhhbmRsZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNZXRhZGF0YShcbiAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgbG9jYXRpb246IExvY2F0aW9uLFxuICBtYXBwaW5nczogTWFwcGluZ3Ncbik6IFJlcXVlc3RJbmZvPHN0cmluZywgTWV0YWRhdGE+IHtcbiAgY29uc3QgdXJsUGFydCA9IGxvY2F0aW9uLmZ1bGxTZXJ2ZXJVcmwoKTtcbiAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QsIHNlcnZpY2UuX3Byb3RvY29sKTtcbiAgY29uc3QgbWV0aG9kID0gJ0dFVCc7XG4gIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heE9wZXJhdGlvblJldHJ5VGltZTtcbiAgY29uc3QgcmVxdWVzdEluZm8gPSBuZXcgUmVxdWVzdEluZm8oXG4gICAgdXJsLFxuICAgIG1ldGhvZCxcbiAgICBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpLFxuICAgIHRpbWVvdXRcbiAgKTtcbiAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gb2JqZWN0RXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcbiAgcmV0dXJuIHJlcXVlc3RJbmZvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGlzdChcbiAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgbG9jYXRpb246IExvY2F0aW9uLFxuICBkZWxpbWl0ZXI/OiBzdHJpbmcsXG4gIHBhZ2VUb2tlbj86IHN0cmluZyB8IG51bGwsXG4gIG1heFJlc3VsdHM/OiBudW1iZXIgfCBudWxsXG4pOiBSZXF1ZXN0SW5mbzxzdHJpbmcsIExpc3RSZXN1bHQ+IHtcbiAgY29uc3QgdXJsUGFyYW1zOiBVcmxQYXJhbXMgPSB7fTtcbiAgaWYgKGxvY2F0aW9uLmlzUm9vdCkge1xuICAgIHVybFBhcmFtc1sncHJlZml4J10gPSAnJztcbiAgfSBlbHNlIHtcbiAgICB1cmxQYXJhbXNbJ3ByZWZpeCddID0gbG9jYXRpb24ucGF0aCArICcvJztcbiAgfVxuICBpZiAoZGVsaW1pdGVyICYmIGRlbGltaXRlci5sZW5ndGggPiAwKSB7XG4gICAgdXJsUGFyYW1zWydkZWxpbWl0ZXInXSA9IGRlbGltaXRlcjtcbiAgfVxuICBpZiAocGFnZVRva2VuKSB7XG4gICAgdXJsUGFyYW1zWydwYWdlVG9rZW4nXSA9IHBhZ2VUb2tlbjtcbiAgfVxuICBpZiAobWF4UmVzdWx0cykge1xuICAgIHVybFBhcmFtc1snbWF4UmVzdWx0cyddID0gbWF4UmVzdWx0cztcbiAgfVxuICBjb25zdCB1cmxQYXJ0ID0gbG9jYXRpb24uYnVja2V0T25seVNlcnZlclVybCgpO1xuICBjb25zdCB1cmwgPSBtYWtlVXJsKHVybFBhcnQsIHNlcnZpY2UuaG9zdCwgc2VydmljZS5fcHJvdG9jb2wpO1xuICBjb25zdCBtZXRob2QgPSAnR0VUJztcbiAgY29uc3QgdGltZW91dCA9IHNlcnZpY2UubWF4T3BlcmF0aW9uUmV0cnlUaW1lO1xuICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyhcbiAgICB1cmwsXG4gICAgbWV0aG9kLFxuICAgIGxpc3RIYW5kbGVyKHNlcnZpY2UsIGxvY2F0aW9uLmJ1Y2tldCksXG4gICAgdGltZW91dFxuICApO1xuICByZXF1ZXN0SW5mby51cmxQYXJhbXMgPSB1cmxQYXJhbXM7XG4gIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciA9IHNoYXJlZEVycm9ySGFuZGxlcihsb2NhdGlvbik7XG4gIHJldHVybiByZXF1ZXN0SW5mbztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEJ5dGVzPEkgZXh0ZW5kcyBDb25uZWN0aW9uVHlwZT4oXG4gIHNlcnZpY2U6IEZpcmViYXNlU3RvcmFnZUltcGwsXG4gIGxvY2F0aW9uOiBMb2NhdGlvbixcbiAgbWF4RG93bmxvYWRTaXplQnl0ZXM/OiBudW1iZXJcbik6IFJlcXVlc3RJbmZvPEksIEk+IHtcbiAgY29uc3QgdXJsUGFydCA9IGxvY2F0aW9uLmZ1bGxTZXJ2ZXJVcmwoKTtcbiAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QsIHNlcnZpY2UuX3Byb3RvY29sKSArICc/YWx0PW1lZGlhJztcbiAgY29uc3QgbWV0aG9kID0gJ0dFVCc7XG4gIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heE9wZXJhdGlvblJldHJ5VGltZTtcbiAgY29uc3QgcmVxdWVzdEluZm8gPSBuZXcgUmVxdWVzdEluZm8oXG4gICAgdXJsLFxuICAgIG1ldGhvZCxcbiAgICAoXzogQ29ubmVjdGlvbjxJPiwgZGF0YTogSSkgPT4gZGF0YSxcbiAgICB0aW1lb3V0XG4gICk7XG4gIHJlcXVlc3RJbmZvLmVycm9ySGFuZGxlciA9IG9iamVjdEVycm9ySGFuZGxlcihsb2NhdGlvbik7XG4gIGlmIChtYXhEb3dubG9hZFNpemVCeXRlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgcmVxdWVzdEluZm8uaGVhZGVyc1snUmFuZ2UnXSA9IGBieXRlcz0wLSR7bWF4RG93bmxvYWRTaXplQnl0ZXN9YDtcbiAgICByZXF1ZXN0SW5mby5zdWNjZXNzQ29kZXMgPSBbMjAwIC8qIE9LICovLCAyMDYgLyogUGFydGlhbCBDb250ZW50ICovXTtcbiAgfVxuICByZXR1cm4gcmVxdWVzdEluZm87XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREb3dubG9hZFVybChcbiAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgbG9jYXRpb246IExvY2F0aW9uLFxuICBtYXBwaW5nczogTWFwcGluZ3Ncbik6IFJlcXVlc3RJbmZvPHN0cmluZywgc3RyaW5nIHwgbnVsbD4ge1xuICBjb25zdCB1cmxQYXJ0ID0gbG9jYXRpb24uZnVsbFNlcnZlclVybCgpO1xuICBjb25zdCB1cmwgPSBtYWtlVXJsKHVybFBhcnQsIHNlcnZpY2UuaG9zdCwgc2VydmljZS5fcHJvdG9jb2wpO1xuICBjb25zdCBtZXRob2QgPSAnR0VUJztcbiAgY29uc3QgdGltZW91dCA9IHNlcnZpY2UubWF4T3BlcmF0aW9uUmV0cnlUaW1lO1xuICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyhcbiAgICB1cmwsXG4gICAgbWV0aG9kLFxuICAgIGRvd25sb2FkVXJsSGFuZGxlcihzZXJ2aWNlLCBtYXBwaW5ncyksXG4gICAgdGltZW91dFxuICApO1xuICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBvYmplY3RFcnJvckhhbmRsZXIobG9jYXRpb24pO1xuICByZXR1cm4gcmVxdWVzdEluZm87XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVNZXRhZGF0YShcbiAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgbG9jYXRpb246IExvY2F0aW9uLFxuICBtZXRhZGF0YTogUGFydGlhbDxNZXRhZGF0YT4sXG4gIG1hcHBpbmdzOiBNYXBwaW5nc1xuKTogUmVxdWVzdEluZm88c3RyaW5nLCBNZXRhZGF0YT4ge1xuICBjb25zdCB1cmxQYXJ0ID0gbG9jYXRpb24uZnVsbFNlcnZlclVybCgpO1xuICBjb25zdCB1cmwgPSBtYWtlVXJsKHVybFBhcnQsIHNlcnZpY2UuaG9zdCwgc2VydmljZS5fcHJvdG9jb2wpO1xuICBjb25zdCBtZXRob2QgPSAnUEFUQ0gnO1xuICBjb25zdCBib2R5ID0gdG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YSwgbWFwcGluZ3MpO1xuICBjb25zdCBoZWFkZXJzID0geyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnIH07XG4gIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heE9wZXJhdGlvblJldHJ5VGltZTtcbiAgY29uc3QgcmVxdWVzdEluZm8gPSBuZXcgUmVxdWVzdEluZm8oXG4gICAgdXJsLFxuICAgIG1ldGhvZCxcbiAgICBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpLFxuICAgIHRpbWVvdXRcbiAgKTtcbiAgcmVxdWVzdEluZm8uaGVhZGVycyA9IGhlYWRlcnM7XG4gIHJlcXVlc3RJbmZvLmJvZHkgPSBib2R5O1xuICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBvYmplY3RFcnJvckhhbmRsZXIobG9jYXRpb24pO1xuICByZXR1cm4gcmVxdWVzdEluZm87XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVPYmplY3QoXG4gIHNlcnZpY2U6IEZpcmViYXNlU3RvcmFnZUltcGwsXG4gIGxvY2F0aW9uOiBMb2NhdGlvblxuKTogUmVxdWVzdEluZm88c3RyaW5nLCB2b2lkPiB7XG4gIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5mdWxsU2VydmVyVXJsKCk7XG4gIGNvbnN0IHVybCA9IG1ha2VVcmwodXJsUGFydCwgc2VydmljZS5ob3N0LCBzZXJ2aWNlLl9wcm90b2NvbCk7XG4gIGNvbnN0IG1ldGhvZCA9ICdERUxFVEUnO1xuICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhPcGVyYXRpb25SZXRyeVRpbWU7XG5cbiAgZnVuY3Rpb24gaGFuZGxlcihfeGhyOiBDb25uZWN0aW9uPHN0cmluZz4sIF90ZXh0OiBzdHJpbmcpOiB2b2lkIHt9XG4gIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKHVybCwgbWV0aG9kLCBoYW5kbGVyLCB0aW1lb3V0KTtcbiAgcmVxdWVzdEluZm8uc3VjY2Vzc0NvZGVzID0gWzIwMCwgMjA0XTtcbiAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gb2JqZWN0RXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcbiAgcmV0dXJuIHJlcXVlc3RJbmZvO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGV0ZXJtaW5lQ29udGVudFR5cGVfKFxuICBtZXRhZGF0YTogTWV0YWRhdGEgfCBudWxsLFxuICBibG9iOiBGYnNCbG9iIHwgbnVsbFxuKTogc3RyaW5nIHtcbiAgcmV0dXJuIChcbiAgICAobWV0YWRhdGEgJiYgbWV0YWRhdGFbJ2NvbnRlbnRUeXBlJ10pIHx8XG4gICAgKGJsb2IgJiYgYmxvYi50eXBlKCkpIHx8XG4gICAgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSdcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ldGFkYXRhRm9yVXBsb2FkXyhcbiAgbG9jYXRpb246IExvY2F0aW9uLFxuICBibG9iOiBGYnNCbG9iLFxuICBtZXRhZGF0YT86IE1ldGFkYXRhIHwgbnVsbFxuKTogTWV0YWRhdGEge1xuICBjb25zdCBtZXRhZGF0YUNsb25lID0gT2JqZWN0LmFzc2lnbih7fSwgbWV0YWRhdGEpO1xuICBtZXRhZGF0YUNsb25lWydmdWxsUGF0aCddID0gbG9jYXRpb24ucGF0aDtcbiAgbWV0YWRhdGFDbG9uZVsnc2l6ZSddID0gYmxvYi5zaXplKCk7XG4gIGlmICghbWV0YWRhdGFDbG9uZVsnY29udGVudFR5cGUnXSkge1xuICAgIG1ldGFkYXRhQ2xvbmVbJ2NvbnRlbnRUeXBlJ10gPSBkZXRlcm1pbmVDb250ZW50VHlwZV8obnVsbCwgYmxvYik7XG4gIH1cbiAgcmV0dXJuIG1ldGFkYXRhQ2xvbmU7XG59XG5cbi8qKlxuICogUHJlcGFyZSBSZXF1ZXN0SW5mbyBmb3IgdXBsb2FkcyBhcyBDb250ZW50LVR5cGU6IG11bHRpcGFydC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG11bHRpcGFydFVwbG9hZChcbiAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgbG9jYXRpb246IExvY2F0aW9uLFxuICBtYXBwaW5nczogTWFwcGluZ3MsXG4gIGJsb2I6IEZic0Jsb2IsXG4gIG1ldGFkYXRhPzogTWV0YWRhdGEgfCBudWxsXG4pOiBSZXF1ZXN0SW5mbzxzdHJpbmcsIE1ldGFkYXRhPiB7XG4gIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5idWNrZXRPbmx5U2VydmVyVXJsKCk7XG4gIGNvbnN0IGhlYWRlcnM6IHsgW3Byb3A6IHN0cmluZ106IHN0cmluZyB9ID0ge1xuICAgICdYLUdvb2ctVXBsb2FkLVByb3RvY29sJzogJ211bHRpcGFydCdcbiAgfTtcblxuICBmdW5jdGlvbiBnZW5Cb3VuZGFyeSgpOiBzdHJpbmcge1xuICAgIGxldCBzdHIgPSAnJztcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuICAgICAgc3RyID0gc3RyICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygpLnNsaWNlKDIpO1xuICAgIH1cbiAgICByZXR1cm4gc3RyO1xuICB9XG4gIGNvbnN0IGJvdW5kYXJ5ID0gZ2VuQm91bmRhcnkoKTtcbiAgaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSAnbXVsdGlwYXJ0L3JlbGF0ZWQ7IGJvdW5kYXJ5PScgKyBib3VuZGFyeTtcbiAgY29uc3QgbWV0YWRhdGFfID0gbWV0YWRhdGFGb3JVcGxvYWRfKGxvY2F0aW9uLCBibG9iLCBtZXRhZGF0YSk7XG4gIGNvbnN0IG1ldGFkYXRhU3RyaW5nID0gdG9SZXNvdXJjZVN0cmluZyhtZXRhZGF0YV8sIG1hcHBpbmdzKTtcbiAgY29uc3QgcHJlQmxvYlBhcnQgPVxuICAgICctLScgK1xuICAgIGJvdW5kYXJ5ICtcbiAgICAnXFxyXFxuJyArXG4gICAgJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOFxcclxcblxcclxcbicgK1xuICAgIG1ldGFkYXRhU3RyaW5nICtcbiAgICAnXFxyXFxuLS0nICtcbiAgICBib3VuZGFyeSArXG4gICAgJ1xcclxcbicgK1xuICAgICdDb250ZW50LVR5cGU6ICcgK1xuICAgIG1ldGFkYXRhX1snY29udGVudFR5cGUnXSArXG4gICAgJ1xcclxcblxcclxcbic7XG4gIGNvbnN0IHBvc3RCbG9iUGFydCA9ICdcXHJcXG4tLScgKyBib3VuZGFyeSArICctLSc7XG4gIGNvbnN0IGJvZHkgPSBGYnNCbG9iLmdldEJsb2IocHJlQmxvYlBhcnQsIGJsb2IsIHBvc3RCbG9iUGFydCk7XG4gIGlmIChib2R5ID09PSBudWxsKSB7XG4gICAgdGhyb3cgY2Fubm90U2xpY2VCbG9iKCk7XG4gIH1cbiAgY29uc3QgdXJsUGFyYW1zOiBVcmxQYXJhbXMgPSB7IG5hbWU6IG1ldGFkYXRhX1snZnVsbFBhdGgnXSEgfTtcbiAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QsIHNlcnZpY2UuX3Byb3RvY29sKTtcbiAgY29uc3QgbWV0aG9kID0gJ1BPU1QnO1xuICBjb25zdCB0aW1lb3V0ID0gc2VydmljZS5tYXhVcGxvYWRSZXRyeVRpbWU7XG4gIGNvbnN0IHJlcXVlc3RJbmZvID0gbmV3IFJlcXVlc3RJbmZvKFxuICAgIHVybCxcbiAgICBtZXRob2QsXG4gICAgbWV0YWRhdGFIYW5kbGVyKHNlcnZpY2UsIG1hcHBpbmdzKSxcbiAgICB0aW1lb3V0XG4gICk7XG4gIHJlcXVlc3RJbmZvLnVybFBhcmFtcyA9IHVybFBhcmFtcztcbiAgcmVxdWVzdEluZm8uaGVhZGVycyA9IGhlYWRlcnM7XG4gIHJlcXVlc3RJbmZvLmJvZHkgPSBib2R5LnVwbG9hZERhdGEoKTtcbiAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcbiAgcmV0dXJuIHJlcXVlc3RJbmZvO1xufVxuXG4vKipcbiAqIEBwYXJhbSBjdXJyZW50IFRoZSBudW1iZXIgb2YgYnl0ZXMgdGhhdCBoYXZlIGJlZW4gdXBsb2FkZWQgc28gZmFyLlxuICogQHBhcmFtIHRvdGFsIFRoZSB0b3RhbCBudW1iZXIgb2YgYnl0ZXMgaW4gdGhlIHVwbG9hZC5cbiAqIEBwYXJhbSBvcHRfZmluYWxpemVkIFRydWUgaWYgdGhlIHNlcnZlciBoYXMgZmluaXNoZWQgdGhlIHVwbG9hZC5cbiAqIEBwYXJhbSBvcHRfbWV0YWRhdGEgVGhlIHVwbG9hZCBtZXRhZGF0YSwgc2hvdWxkXG4gKiAgICAgb25seSBiZSBwYXNzZWQgaWYgb3B0X2ZpbmFsaXplZCBpcyB0cnVlLlxuICovXG5leHBvcnQgY2xhc3MgUmVzdW1hYmxlVXBsb2FkU3RhdHVzIHtcbiAgZmluYWxpemVkOiBib29sZWFuO1xuICBtZXRhZGF0YTogTWV0YWRhdGEgfCBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBjdXJyZW50OiBudW1iZXIsXG4gICAgcHVibGljIHRvdGFsOiBudW1iZXIsXG4gICAgZmluYWxpemVkPzogYm9vbGVhbixcbiAgICBtZXRhZGF0YT86IE1ldGFkYXRhIHwgbnVsbFxuICApIHtcbiAgICB0aGlzLmZpbmFsaXplZCA9ICEhZmluYWxpemVkO1xuICAgIHRoaXMubWV0YWRhdGEgPSBtZXRhZGF0YSB8fCBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja1Jlc3VtZUhlYWRlcl8oXG4gIHhocjogQ29ubmVjdGlvbjxzdHJpbmc+LFxuICBhbGxvd2VkPzogc3RyaW5nW11cbik6IHN0cmluZyB7XG4gIGxldCBzdGF0dXM6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICB0cnkge1xuICAgIHN0YXR1cyA9IHhoci5nZXRSZXNwb25zZUhlYWRlcignWC1Hb29nLVVwbG9hZC1TdGF0dXMnKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGhhbmRsZXJDaGVjayhmYWxzZSk7XG4gIH1cbiAgY29uc3QgYWxsb3dlZFN0YXR1cyA9IGFsbG93ZWQgfHwgWydhY3RpdmUnXTtcbiAgaGFuZGxlckNoZWNrKCEhc3RhdHVzICYmIGFsbG93ZWRTdGF0dXMuaW5kZXhPZihzdGF0dXMpICE9PSAtMSk7XG4gIHJldHVybiBzdGF0dXMgYXMgc3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlUmVzdW1hYmxlVXBsb2FkKFxuICBzZXJ2aWNlOiBGaXJlYmFzZVN0b3JhZ2VJbXBsLFxuICBsb2NhdGlvbjogTG9jYXRpb24sXG4gIG1hcHBpbmdzOiBNYXBwaW5ncyxcbiAgYmxvYjogRmJzQmxvYixcbiAgbWV0YWRhdGE/OiBNZXRhZGF0YSB8IG51bGxcbik6IFJlcXVlc3RJbmZvPHN0cmluZywgc3RyaW5nPiB7XG4gIGNvbnN0IHVybFBhcnQgPSBsb2NhdGlvbi5idWNrZXRPbmx5U2VydmVyVXJsKCk7XG4gIGNvbnN0IG1ldGFkYXRhRm9yVXBsb2FkID0gbWV0YWRhdGFGb3JVcGxvYWRfKGxvY2F0aW9uLCBibG9iLCBtZXRhZGF0YSk7XG4gIGNvbnN0IHVybFBhcmFtczogVXJsUGFyYW1zID0geyBuYW1lOiBtZXRhZGF0YUZvclVwbG9hZFsnZnVsbFBhdGgnXSEgfTtcbiAgY29uc3QgdXJsID0gbWFrZVVybCh1cmxQYXJ0LCBzZXJ2aWNlLmhvc3QsIHNlcnZpY2UuX3Byb3RvY29sKTtcbiAgY29uc3QgbWV0aG9kID0gJ1BPU1QnO1xuICBjb25zdCBoZWFkZXJzID0ge1xuICAgICdYLUdvb2ctVXBsb2FkLVByb3RvY29sJzogJ3Jlc3VtYWJsZScsXG4gICAgJ1gtR29vZy1VcGxvYWQtQ29tbWFuZCc6ICdzdGFydCcsXG4gICAgJ1gtR29vZy1VcGxvYWQtSGVhZGVyLUNvbnRlbnQtTGVuZ3RoJzogYCR7YmxvYi5zaXplKCl9YCxcbiAgICAnWC1Hb29nLVVwbG9hZC1IZWFkZXItQ29udGVudC1UeXBlJzogbWV0YWRhdGFGb3JVcGxvYWRbJ2NvbnRlbnRUeXBlJ10hLFxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCdcbiAgfTtcbiAgY29uc3QgYm9keSA9IHRvUmVzb3VyY2VTdHJpbmcobWV0YWRhdGFGb3JVcGxvYWQsIG1hcHBpbmdzKTtcbiAgY29uc3QgdGltZW91dCA9IHNlcnZpY2UubWF4VXBsb2FkUmV0cnlUaW1lO1xuXG4gIGZ1bmN0aW9uIGhhbmRsZXIoeGhyOiBDb25uZWN0aW9uPHN0cmluZz4pOiBzdHJpbmcge1xuICAgIGNoZWNrUmVzdW1lSGVhZGVyXyh4aHIpO1xuICAgIGxldCB1cmw7XG4gICAgdHJ5IHtcbiAgICAgIHVybCA9IHhoci5nZXRSZXNwb25zZUhlYWRlcignWC1Hb29nLVVwbG9hZC1VUkwnKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBoYW5kbGVyQ2hlY2soZmFsc2UpO1xuICAgIH1cbiAgICBoYW5kbGVyQ2hlY2soaXNTdHJpbmcodXJsKSk7XG4gICAgcmV0dXJuIHVybCBhcyBzdHJpbmc7XG4gIH1cbiAgY29uc3QgcmVxdWVzdEluZm8gPSBuZXcgUmVxdWVzdEluZm8odXJsLCBtZXRob2QsIGhhbmRsZXIsIHRpbWVvdXQpO1xuICByZXF1ZXN0SW5mby51cmxQYXJhbXMgPSB1cmxQYXJhbXM7XG4gIHJlcXVlc3RJbmZvLmhlYWRlcnMgPSBoZWFkZXJzO1xuICByZXF1ZXN0SW5mby5ib2R5ID0gYm9keTtcbiAgcmVxdWVzdEluZm8uZXJyb3JIYW5kbGVyID0gc2hhcmVkRXJyb3JIYW5kbGVyKGxvY2F0aW9uKTtcbiAgcmV0dXJuIHJlcXVlc3RJbmZvO1xufVxuXG4vKipcbiAqIEBwYXJhbSB1cmwgRnJvbSBhIGNhbGwgdG8gZmJzLnJlcXVlc3RzLmNyZWF0ZVJlc3VtYWJsZVVwbG9hZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJlc3VtYWJsZVVwbG9hZFN0YXR1cyhcbiAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgbG9jYXRpb246IExvY2F0aW9uLFxuICB1cmw6IHN0cmluZyxcbiAgYmxvYjogRmJzQmxvYlxuKTogUmVxdWVzdEluZm88c3RyaW5nLCBSZXN1bWFibGVVcGxvYWRTdGF0dXM+IHtcbiAgY29uc3QgaGVhZGVycyA9IHsgJ1gtR29vZy1VcGxvYWQtQ29tbWFuZCc6ICdxdWVyeScgfTtcblxuICBmdW5jdGlvbiBoYW5kbGVyKHhocjogQ29ubmVjdGlvbjxzdHJpbmc+KTogUmVzdW1hYmxlVXBsb2FkU3RhdHVzIHtcbiAgICBjb25zdCBzdGF0dXMgPSBjaGVja1Jlc3VtZUhlYWRlcl8oeGhyLCBbJ2FjdGl2ZScsICdmaW5hbCddKTtcbiAgICBsZXQgc2l6ZVN0cmluZzogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIHNpemVTdHJpbmcgPSB4aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ1gtR29vZy1VcGxvYWQtU2l6ZS1SZWNlaXZlZCcpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGhhbmRsZXJDaGVjayhmYWxzZSk7XG4gICAgfVxuXG4gICAgaWYgKCFzaXplU3RyaW5nKSB7XG4gICAgICAvLyBudWxsIG9yIGVtcHR5IHN0cmluZ1xuICAgICAgaGFuZGxlckNoZWNrKGZhbHNlKTtcbiAgICB9XG5cbiAgICBjb25zdCBzaXplID0gTnVtYmVyKHNpemVTdHJpbmcpO1xuICAgIGhhbmRsZXJDaGVjayghaXNOYU4oc2l6ZSkpO1xuICAgIHJldHVybiBuZXcgUmVzdW1hYmxlVXBsb2FkU3RhdHVzKHNpemUsIGJsb2Iuc2l6ZSgpLCBzdGF0dXMgPT09ICdmaW5hbCcpO1xuICB9XG4gIGNvbnN0IG1ldGhvZCA9ICdQT1NUJztcbiAgY29uc3QgdGltZW91dCA9IHNlcnZpY2UubWF4VXBsb2FkUmV0cnlUaW1lO1xuICBjb25zdCByZXF1ZXN0SW5mbyA9IG5ldyBSZXF1ZXN0SW5mbyh1cmwsIG1ldGhvZCwgaGFuZGxlciwgdGltZW91dCk7XG4gIHJlcXVlc3RJbmZvLmhlYWRlcnMgPSBoZWFkZXJzO1xuICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xuICByZXR1cm4gcmVxdWVzdEluZm87XG59XG5cbi8qKlxuICogQW55IHVwbG9hZHMgdmlhIHRoZSByZXN1bWFibGUgdXBsb2FkIEFQSSBtdXN0IHRyYW5zZmVyIGEgbnVtYmVyIG9mIGJ5dGVzXG4gKiB0aGF0IGlzIGEgbXVsdGlwbGUgb2YgdGhpcyBudW1iZXIuXG4gKi9cbmV4cG9ydCBjb25zdCBSRVNVTUFCTEVfVVBMT0FEX0NIVU5LX1NJWkU6IG51bWJlciA9IDI1NiAqIDEwMjQ7XG5cbi8qKlxuICogQHBhcmFtIHVybCBGcm9tIGEgY2FsbCB0byBmYnMucmVxdWVzdHMuY3JlYXRlUmVzdW1hYmxlVXBsb2FkLlxuICogQHBhcmFtIGNodW5rU2l6ZSBOdW1iZXIgb2YgYnl0ZXMgdG8gdXBsb2FkLlxuICogQHBhcmFtIHN0YXR1cyBUaGUgcHJldmlvdXMgc3RhdHVzLlxuICogICAgIElmIG5vdCBwYXNzZWQgb3IgbnVsbCwgd2Ugc3RhcnQgZnJvbSB0aGUgYmVnaW5uaW5nLlxuICogQHRocm93cyBmYnMuRXJyb3IgSWYgdGhlIHVwbG9hZCBpcyBhbHJlYWR5IGNvbXBsZXRlLCB0aGUgcGFzc2VkIGluIHN0YXR1c1xuICogICAgIGhhcyBhIGZpbmFsIHNpemUgaW5jb25zaXN0ZW50IHdpdGggdGhlIGJsb2IsIG9yIHRoZSBibG9iIGNhbm5vdCBiZSBzbGljZWRcbiAqICAgICBmb3IgdXBsb2FkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gY29udGludWVSZXN1bWFibGVVcGxvYWQoXG4gIGxvY2F0aW9uOiBMb2NhdGlvbixcbiAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgdXJsOiBzdHJpbmcsXG4gIGJsb2I6IEZic0Jsb2IsXG4gIGNodW5rU2l6ZTogbnVtYmVyLFxuICBtYXBwaW5nczogTWFwcGluZ3MsXG4gIHN0YXR1cz86IFJlc3VtYWJsZVVwbG9hZFN0YXR1cyB8IG51bGwsXG4gIHByb2dyZXNzQ2FsbGJhY2s/OiAoKHAxOiBudW1iZXIsIHAyOiBudW1iZXIpID0+IHZvaWQpIHwgbnVsbFxuKTogUmVxdWVzdEluZm88c3RyaW5nLCBSZXN1bWFibGVVcGxvYWRTdGF0dXM+IHtcbiAgLy8gVE9ETyhhbmR5c290byk6IHN0YW5kYXJkaXplIG9uIGludGVybmFsIGFzc2VydHNcbiAgLy8gYXNzZXJ0KCEob3B0X3N0YXR1cyAmJiBvcHRfc3RhdHVzLmZpbmFsaXplZCkpO1xuICBjb25zdCBzdGF0dXNfID0gbmV3IFJlc3VtYWJsZVVwbG9hZFN0YXR1cygwLCAwKTtcbiAgaWYgKHN0YXR1cykge1xuICAgIHN0YXR1c18uY3VycmVudCA9IHN0YXR1cy5jdXJyZW50O1xuICAgIHN0YXR1c18udG90YWwgPSBzdGF0dXMudG90YWw7XG4gIH0gZWxzZSB7XG4gICAgc3RhdHVzXy5jdXJyZW50ID0gMDtcbiAgICBzdGF0dXNfLnRvdGFsID0gYmxvYi5zaXplKCk7XG4gIH1cbiAgaWYgKGJsb2Iuc2l6ZSgpICE9PSBzdGF0dXNfLnRvdGFsKSB7XG4gICAgdGhyb3cgc2VydmVyRmlsZVdyb25nU2l6ZSgpO1xuICB9XG4gIGNvbnN0IGJ5dGVzTGVmdCA9IHN0YXR1c18udG90YWwgLSBzdGF0dXNfLmN1cnJlbnQ7XG4gIGxldCBieXRlc1RvVXBsb2FkID0gYnl0ZXNMZWZ0O1xuICBpZiAoY2h1bmtTaXplID4gMCkge1xuICAgIGJ5dGVzVG9VcGxvYWQgPSBNYXRoLm1pbihieXRlc1RvVXBsb2FkLCBjaHVua1NpemUpO1xuICB9XG4gIGNvbnN0IHN0YXJ0Qnl0ZSA9IHN0YXR1c18uY3VycmVudDtcbiAgY29uc3QgZW5kQnl0ZSA9IHN0YXJ0Qnl0ZSArIGJ5dGVzVG9VcGxvYWQ7XG4gIGxldCB1cGxvYWRDb21tYW5kID0gJyc7XG4gIGlmIChieXRlc1RvVXBsb2FkID09PSAwKSB7XG4gICAgdXBsb2FkQ29tbWFuZCA9ICdmaW5hbGl6ZSc7XG4gIH0gZWxzZSBpZiAoYnl0ZXNMZWZ0ID09PSBieXRlc1RvVXBsb2FkKSB7XG4gICAgdXBsb2FkQ29tbWFuZCA9ICd1cGxvYWQsIGZpbmFsaXplJztcbiAgfSBlbHNlIHtcbiAgICB1cGxvYWRDb21tYW5kID0gJ3VwbG9hZCc7XG4gIH1cbiAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAnWC1Hb29nLVVwbG9hZC1Db21tYW5kJzogdXBsb2FkQ29tbWFuZCxcbiAgICAnWC1Hb29nLVVwbG9hZC1PZmZzZXQnOiBgJHtzdGF0dXNfLmN1cnJlbnR9YFxuICB9O1xuICBjb25zdCBib2R5ID0gYmxvYi5zbGljZShzdGFydEJ5dGUsIGVuZEJ5dGUpO1xuICBpZiAoYm9keSA9PT0gbnVsbCkge1xuICAgIHRocm93IGNhbm5vdFNsaWNlQmxvYigpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlcihcbiAgICB4aHI6IENvbm5lY3Rpb248c3RyaW5nPixcbiAgICB0ZXh0OiBzdHJpbmdcbiAgKTogUmVzdW1hYmxlVXBsb2FkU3RhdHVzIHtcbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogVmVyaWZ5IHRoZSBNRDUgb2YgZWFjaCB1cGxvYWRlZCByYW5nZTpcbiAgICAvLyB0aGUgJ3gtcmFuZ2UtbWQ1JyBoZWFkZXIgY29tZXMgYmFjayB3aXRoIHN0YXR1cyBjb2RlIDMwOCByZXNwb25zZXMuXG4gICAgLy8gV2UnbGwgb25seSBiZSBhYmxlIHRvIGJhaWwgb3V0IHRob3VnaCwgYmVjYXVzZSB5b3UgY2FuJ3QgcmUtdXBsb2FkIGFcbiAgICAvLyByYW5nZSB0aGF0IHlvdSBwcmV2aW91c2x5IHVwbG9hZGVkLlxuICAgIGNvbnN0IHVwbG9hZFN0YXR1cyA9IGNoZWNrUmVzdW1lSGVhZGVyXyh4aHIsIFsnYWN0aXZlJywgJ2ZpbmFsJ10pO1xuICAgIGNvbnN0IG5ld0N1cnJlbnQgPSBzdGF0dXNfLmN1cnJlbnQgKyBieXRlc1RvVXBsb2FkO1xuICAgIGNvbnN0IHNpemUgPSBibG9iLnNpemUoKTtcbiAgICBsZXQgbWV0YWRhdGE7XG4gICAgaWYgKHVwbG9hZFN0YXR1cyA9PT0gJ2ZpbmFsJykge1xuICAgICAgbWV0YWRhdGEgPSBtZXRhZGF0YUhhbmRsZXIoc2VydmljZSwgbWFwcGluZ3MpKHhociwgdGV4dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1ldGFkYXRhID0gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBSZXN1bWFibGVVcGxvYWRTdGF0dXMoXG4gICAgICBuZXdDdXJyZW50LFxuICAgICAgc2l6ZSxcbiAgICAgIHVwbG9hZFN0YXR1cyA9PT0gJ2ZpbmFsJyxcbiAgICAgIG1ldGFkYXRhXG4gICAgKTtcbiAgfVxuICBjb25zdCBtZXRob2QgPSAnUE9TVCc7XG4gIGNvbnN0IHRpbWVvdXQgPSBzZXJ2aWNlLm1heFVwbG9hZFJldHJ5VGltZTtcbiAgY29uc3QgcmVxdWVzdEluZm8gPSBuZXcgUmVxdWVzdEluZm8odXJsLCBtZXRob2QsIGhhbmRsZXIsIHRpbWVvdXQpO1xuICByZXF1ZXN0SW5mby5oZWFkZXJzID0gaGVhZGVycztcbiAgcmVxdWVzdEluZm8uYm9keSA9IGJvZHkudXBsb2FkRGF0YSgpO1xuICByZXF1ZXN0SW5mby5wcm9ncmVzc0NhbGxiYWNrID0gcHJvZ3Jlc3NDYWxsYmFjayB8fCBudWxsO1xuICByZXF1ZXN0SW5mby5lcnJvckhhbmRsZXIgPSBzaGFyZWRFcnJvckhhbmRsZXIobG9jYXRpb24pO1xuICByZXR1cm4gcmVxdWVzdEluZm87XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IEVudW1lcmF0aW9ucyB1c2VkIGZvciB1cGxvYWQgdGFza3MuXG4gKi9cblxuLyoqXG4gKiBBbiBldmVudCB0aGF0IGlzIHRyaWdnZXJlZCBvbiBhIHRhc2suXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHR5cGUgVGFza0V2ZW50ID0gc3RyaW5nO1xuXG4vKipcbiAqIEFuIGV2ZW50IHRoYXQgaXMgdHJpZ2dlcmVkIG9uIGEgdGFzay5cbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgVGFza0V2ZW50ID0ge1xuICAvKipcbiAgICogRm9yIHRoaXMgZXZlbnQsXG4gICAqIDx1bD5cbiAgICogICA8bGk+VGhlIGBuZXh0YCBmdW5jdGlvbiBpcyB0cmlnZ2VyZWQgb24gcHJvZ3Jlc3MgdXBkYXRlcyBhbmQgd2hlbiB0aGVcbiAgICogICAgICAgdGFzayBpcyBwYXVzZWQvcmVzdW1lZCB3aXRoIGFuIGBVcGxvYWRUYXNrU25hcHNob3RgIGFzIHRoZSBmaXJzdFxuICAgKiAgICAgICBhcmd1bWVudC48L2xpPlxuICAgKiAgIDxsaT5UaGUgYGVycm9yYCBmdW5jdGlvbiBpcyB0cmlnZ2VyZWQgaWYgdGhlIHVwbG9hZCBpcyBjYW5jZWxlZCBvciBmYWlsc1xuICAgKiAgICAgICBmb3IgYW5vdGhlciByZWFzb24uPC9saT5cbiAgICogICA8bGk+VGhlIGBjb21wbGV0ZWAgZnVuY3Rpb24gaXMgdHJpZ2dlcmVkIGlmIHRoZSB1cGxvYWQgY29tcGxldGVzXG4gICAqICAgICAgIHN1Y2Nlc3NmdWxseS48L2xpPlxuICAgKiA8L3VsPlxuICAgKi9cbiAgU1RBVEVfQ0hBTkdFRDogJ3N0YXRlX2NoYW5nZWQnXG59O1xuXG4vKipcbiAqIEludGVybmFsIGVudW0gZm9yIHRhc2sgc3RhdGUuXG4gKi9cbmV4cG9ydCBjb25zdCBlbnVtIEludGVybmFsVGFza1N0YXRlIHtcbiAgUlVOTklORyA9ICdydW5uaW5nJyxcbiAgUEFVU0lORyA9ICdwYXVzaW5nJyxcbiAgUEFVU0VEID0gJ3BhdXNlZCcsXG4gIFNVQ0NFU1MgPSAnc3VjY2VzcycsXG4gIENBTkNFTElORyA9ICdjYW5jZWxpbmcnLFxuICBDQU5DRUxFRCA9ICdjYW5jZWxlZCcsXG4gIEVSUk9SID0gJ2Vycm9yJ1xufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGN1cnJlbnQgc3RhdGUgb2YgYSBydW5uaW5nIHVwbG9hZC5cbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdHlwZSBUYXNrU3RhdGUgPSB0eXBlb2YgVGFza1N0YXRlW2tleW9mIHR5cGVvZiBUYXNrU3RhdGVdO1xuXG4vLyB0eXBlIGtleXMgPSBrZXlvZiBUYXNrU3RhdGVcbi8qKlxuICogUmVwcmVzZW50cyB0aGUgY3VycmVudCBzdGF0ZSBvZiBhIHJ1bm5pbmcgdXBsb2FkLlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBjb25zdCBUYXNrU3RhdGUgPSB7XG4gIC8qKiBUaGUgdGFzayBpcyBjdXJyZW50bHkgdHJhbnNmZXJyaW5nIGRhdGEuICovXG4gIFJVTk5JTkc6ICdydW5uaW5nJyxcblxuICAvKiogVGhlIHRhc2sgd2FzIHBhdXNlZCBieSB0aGUgdXNlci4gKi9cbiAgUEFVU0VEOiAncGF1c2VkJyxcblxuICAvKiogVGhlIHRhc2sgY29tcGxldGVkIHN1Y2Nlc3NmdWxseS4gKi9cbiAgU1VDQ0VTUzogJ3N1Y2Nlc3MnLFxuXG4gIC8qKiBUaGUgdGFzayB3YXMgY2FuY2VsZWQuICovXG4gIENBTkNFTEVEOiAnY2FuY2VsZWQnLFxuXG4gIC8qKiBUaGUgdGFzayBmYWlsZWQgd2l0aCBhbiBlcnJvci4gKi9cbiAgRVJST1I6ICdlcnJvcidcbn0gYXMgY29uc3Q7XG5cbmV4cG9ydCBmdW5jdGlvbiB0YXNrU3RhdGVGcm9tSW50ZXJuYWxUYXNrU3RhdGUoXG4gIHN0YXRlOiBJbnRlcm5hbFRhc2tTdGF0ZVxuKTogVGFza1N0YXRlIHtcbiAgc3dpdGNoIChzdGF0ZSkge1xuICAgIGNhc2UgSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORzpcbiAgICBjYXNlIEludGVybmFsVGFza1N0YXRlLlBBVVNJTkc6XG4gICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkc6XG4gICAgICByZXR1cm4gVGFza1N0YXRlLlJVTk5JTkc7XG4gICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTRUQ6XG4gICAgICByZXR1cm4gVGFza1N0YXRlLlBBVVNFRDtcbiAgICBjYXNlIEludGVybmFsVGFza1N0YXRlLlNVQ0NFU1M6XG4gICAgICByZXR1cm4gVGFza1N0YXRlLlNVQ0NFU1M7XG4gICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxFRDpcbiAgICAgIHJldHVybiBUYXNrU3RhdGUuQ0FOQ0VMRUQ7XG4gICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5FUlJPUjpcbiAgICAgIHJldHVybiBUYXNrU3RhdGUuRVJST1I7XG4gICAgZGVmYXVsdDpcbiAgICAgIC8vIFRPRE8oYW5keXNvdG8pOiBhc3NlcnQoZmFsc2UpO1xuICAgICAgcmV0dXJuIFRhc2tTdGF0ZS5FUlJPUjtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBpc0Z1bmN0aW9uIH0gZnJvbSAnLi90eXBlJztcbmltcG9ydCB7IFN0b3JhZ2VFcnJvciB9IGZyb20gJy4vZXJyb3InO1xuXG4vKipcbiAqIEZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIG9uY2UgZm9yIGVhY2ggdmFsdWUgaW4gYSBzdHJlYW0gb2YgdmFsdWVzLlxuICovXG5leHBvcnQgdHlwZSBOZXh0Rm48VD4gPSAodmFsdWU6IFQpID0+IHZvaWQ7XG5cbi8qKlxuICogQSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aXRoIGEgYFN0b3JhZ2VFcnJvcmBcbiAqIGlmIHRoZSBldmVudCBzdHJlYW0gZW5kcyBkdWUgdG8gYW4gZXJyb3IuXG4gKi9cbmV4cG9ydCB0eXBlIEVycm9yRm4gPSAoZXJyb3I6IFN0b3JhZ2VFcnJvcikgPT4gdm9pZDtcblxuLyoqXG4gKiBBIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIGlmIHRoZSBldmVudCBzdHJlYW0gZW5kcyBub3JtYWxseS5cbiAqL1xuZXhwb3J0IHR5cGUgQ29tcGxldGVGbiA9ICgpID0+IHZvaWQ7XG5cbi8qKlxuICogVW5zdWJzY3JpYmVzIGZyb20gYSBzdHJlYW0uXG4gKi9cbmV4cG9ydCB0eXBlIFVuc3Vic2NyaWJlID0gKCkgPT4gdm9pZDtcblxuLyoqXG4gKiBBbiBvYnNlcnZlciBpZGVudGljYWwgdG8gdGhlIGBPYnNlcnZlcmAgZGVmaW5lZCBpbiBwYWNrYWdlcy91dGlsIGV4Y2VwdCB0aGVcbiAqIGVycm9yIHBhc3NlZCBpbnRvIHRoZSBFcnJvckZuIGlzIHNwZWNpZmljYWxseSBhIGBTdG9yYWdlRXJyb3JgLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFN0b3JhZ2VPYnNlcnZlcjxUPiB7XG4gIC8qKlxuICAgKiBGdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCBvbmNlIGZvciBlYWNoIHZhbHVlIGluIHRoZSBldmVudCBzdHJlYW0uXG4gICAqL1xuICBuZXh0PzogTmV4dEZuPFQ+O1xuICAvKipcbiAgICogQSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aXRoIGEgYFN0b3JhZ2VFcnJvcmBcbiAgICogaWYgdGhlIGV2ZW50IHN0cmVhbSBlbmRzIGR1ZSB0byBhbiBlcnJvci5cbiAgICovXG4gIGVycm9yPzogRXJyb3JGbjtcbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgaWYgdGhlIGV2ZW50IHN0cmVhbSBlbmRzIG5vcm1hbGx5LlxuICAgKi9cbiAgY29tcGxldGU/OiBDb21wbGV0ZUZuO1xufVxuXG4vKipcbiAqIFN1YnNjcmliZXMgdG8gYW4gZXZlbnQgc3RyZWFtLlxuICovXG5leHBvcnQgdHlwZSBTdWJzY3JpYmU8VD4gPSAoXG4gIG5leHQ/OiBOZXh0Rm48VD4gfCBTdG9yYWdlT2JzZXJ2ZXI8VD4sXG4gIGVycm9yPzogRXJyb3JGbixcbiAgY29tcGxldGU/OiBDb21wbGV0ZUZuXG4pID0+IFVuc3Vic2NyaWJlO1xuXG5leHBvcnQgY2xhc3MgT2JzZXJ2ZXI8VD4gaW1wbGVtZW50cyBTdG9yYWdlT2JzZXJ2ZXI8VD4ge1xuICBuZXh0PzogTmV4dEZuPFQ+O1xuICBlcnJvcj86IEVycm9yRm47XG4gIGNvbXBsZXRlPzogQ29tcGxldGVGbjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBuZXh0T3JPYnNlcnZlcj86IE5leHRGbjxUPiB8IFN0b3JhZ2VPYnNlcnZlcjxUPixcbiAgICBlcnJvcj86IEVycm9yRm4sXG4gICAgY29tcGxldGU/OiBDb21wbGV0ZUZuXG4gICkge1xuICAgIGNvbnN0IGFzRnVuY3Rpb25zID1cbiAgICAgIGlzRnVuY3Rpb24obmV4dE9yT2JzZXJ2ZXIpIHx8IGVycm9yICE9IG51bGwgfHwgY29tcGxldGUgIT0gbnVsbDtcbiAgICBpZiAoYXNGdW5jdGlvbnMpIHtcbiAgICAgIHRoaXMubmV4dCA9IG5leHRPck9ic2VydmVyIGFzIE5leHRGbjxUPjtcbiAgICAgIHRoaXMuZXJyb3IgPSBlcnJvciA/PyB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmNvbXBsZXRlID0gY29tcGxldGUgPz8gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBvYnNlcnZlciA9IG5leHRPck9ic2VydmVyIGFzIHtcbiAgICAgICAgbmV4dD86IE5leHRGbjxUPjtcbiAgICAgICAgZXJyb3I/OiBFcnJvckZuO1xuICAgICAgICBjb21wbGV0ZT86IENvbXBsZXRlRm47XG4gICAgICB9O1xuICAgICAgdGhpcy5uZXh0ID0gb2JzZXJ2ZXIubmV4dDtcbiAgICAgIHRoaXMuZXJyb3IgPSBvYnNlcnZlci5lcnJvcjtcbiAgICAgIHRoaXMuY29tcGxldGUgPSBvYnNlcnZlci5jb21wbGV0ZTtcbiAgICB9XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGludm9rZXMgZiB3aXRoIGl0cyBhcmd1bWVudHMgYXN5bmNocm9ub3VzbHkgYXMgYVxuICogbWljcm90YXNrLCBpLmUuIGFzIHNvb24gYXMgcG9zc2libGUgYWZ0ZXIgdGhlIGN1cnJlbnQgc2NyaXB0IHJldHVybnMgYmFja1xuICogaW50byBicm93c2VyIGNvZGUuXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXG5leHBvcnQgZnVuY3Rpb24gYXN5bmMoZjogRnVuY3Rpb24pOiBGdW5jdGlvbiB7XG4gIHJldHVybiAoLi4uYXJnc1RvRm9yd2FyZDogdW5rbm93bltdKSA9PiB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4gZiguLi5hcmdzVG9Gb3J3YXJkKSk7XG4gIH07XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgQ29ubmVjdGlvbixcbiAgQ29ubmVjdGlvblR5cGUsXG4gIEVycm9yQ29kZSxcbiAgSGVhZGVyc1xufSBmcm9tICcuLi8uLi9pbXBsZW1lbnRhdGlvbi9jb25uZWN0aW9uJztcbmltcG9ydCB7IGludGVybmFsRXJyb3IgfSBmcm9tICcuLi8uLi9pbXBsZW1lbnRhdGlvbi9lcnJvcic7XG5cbi8qKiBBbiBvdmVycmlkZSBmb3IgdGhlIHRleHQtYmFzZWQgQ29ubmVjdGlvbi4gVXNlZCBpbiB0ZXN0cy4gKi9cbmxldCB0ZXh0RmFjdG9yeU92ZXJyaWRlOiAoKCkgPT4gQ29ubmVjdGlvbjxzdHJpbmc+KSB8IG51bGwgPSBudWxsO1xuXG4vKipcbiAqIE5ldHdvcmsgbGF5ZXIgZm9yIGJyb3dzZXJzLiBXZSB1c2UgdGhpcyBpbnN0ZWFkIG9mIGdvb2cubmV0LlhocklvIGJlY2F1c2VcbiAqIGdvb2cubmV0LlhocklvIGlzIGh5dXV1dWdlIGFuZCBkb2Vzbid0IHdvcmsgaW4gUmVhY3QgTmF0aXZlIG9uIEFuZHJvaWQuXG4gKi9cbmFic3RyYWN0IGNsYXNzIFhockNvbm5lY3Rpb248VCBleHRlbmRzIENvbm5lY3Rpb25UeXBlPlxuICBpbXBsZW1lbnRzIENvbm5lY3Rpb248VD5cbntcbiAgcHJvdGVjdGVkIHhocl86IFhNTEh0dHBSZXF1ZXN0O1xuICBwcml2YXRlIGVycm9yQ29kZV86IEVycm9yQ29kZTtcbiAgcHJpdmF0ZSBzZW5kUHJvbWlzZV86IFByb21pc2U8dm9pZD47XG4gIHByb3RlY3RlZCBzZW50XzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMueGhyXyA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHRoaXMuaW5pdFhocigpO1xuICAgIHRoaXMuZXJyb3JDb2RlXyA9IEVycm9yQ29kZS5OT19FUlJPUjtcbiAgICB0aGlzLnNlbmRQcm9taXNlXyA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgdGhpcy54aHJfLmFkZEV2ZW50TGlzdGVuZXIoJ2Fib3J0JywgKCkgPT4ge1xuICAgICAgICB0aGlzLmVycm9yQ29kZV8gPSBFcnJvckNvZGUuQUJPUlQ7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy54aHJfLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCkgPT4ge1xuICAgICAgICB0aGlzLmVycm9yQ29kZV8gPSBFcnJvckNvZGUuTkVUV09SS19FUlJPUjtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSk7XG4gICAgICB0aGlzLnhocl8uYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBhYnN0cmFjdCBpbml0WGhyKCk6IHZvaWQ7XG5cbiAgc2VuZChcbiAgICB1cmw6IHN0cmluZyxcbiAgICBtZXRob2Q6IHN0cmluZyxcbiAgICBib2R5PzogQXJyYXlCdWZmZXJWaWV3IHwgQmxvYiB8IHN0cmluZyxcbiAgICBoZWFkZXJzPzogSGVhZGVyc1xuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5zZW50Xykge1xuICAgICAgdGhyb3cgaW50ZXJuYWxFcnJvcignY2Fubm90IC5zZW5kKCkgbW9yZSB0aGFuIG9uY2UnKTtcbiAgICB9XG4gICAgdGhpcy5zZW50XyA9IHRydWU7XG4gICAgdGhpcy54aHJfLm9wZW4obWV0aG9kLCB1cmwsIHRydWUpO1xuICAgIGlmIChoZWFkZXJzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZvciAoY29uc3Qga2V5IGluIGhlYWRlcnMpIHtcbiAgICAgICAgaWYgKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgIHRoaXMueGhyXy5zZXRSZXF1ZXN0SGVhZGVyKGtleSwgaGVhZGVyc1trZXldLnRvU3RyaW5nKCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChib2R5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMueGhyXy5zZW5kKGJvZHkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnhocl8uc2VuZCgpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zZW5kUHJvbWlzZV87XG4gIH1cblxuICBnZXRFcnJvckNvZGUoKTogRXJyb3JDb2RlIHtcbiAgICBpZiAoIXRoaXMuc2VudF8pIHtcbiAgICAgIHRocm93IGludGVybmFsRXJyb3IoJ2Nhbm5vdCAuZ2V0RXJyb3JDb2RlKCkgYmVmb3JlIHNlbmRpbmcnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZXJyb3JDb2RlXztcbiAgfVxuXG4gIGdldFN0YXR1cygpOiBudW1iZXIge1xuICAgIGlmICghdGhpcy5zZW50Xykge1xuICAgICAgdGhyb3cgaW50ZXJuYWxFcnJvcignY2Fubm90IC5nZXRTdGF0dXMoKSBiZWZvcmUgc2VuZGluZycpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgcmV0dXJuIHRoaXMueGhyXy5zdGF0dXM7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgfVxuXG4gIGdldFJlc3BvbnNlKCk6IFQge1xuICAgIGlmICghdGhpcy5zZW50Xykge1xuICAgICAgdGhyb3cgaW50ZXJuYWxFcnJvcignY2Fubm90IC5nZXRSZXNwb25zZSgpIGJlZm9yZSBzZW5kaW5nJyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnhocl8ucmVzcG9uc2U7XG4gIH1cblxuICBnZXRFcnJvclRleHQoKTogc3RyaW5nIHtcbiAgICBpZiAoIXRoaXMuc2VudF8pIHtcbiAgICAgIHRocm93IGludGVybmFsRXJyb3IoJ2Nhbm5vdCAuZ2V0RXJyb3JUZXh0KCkgYmVmb3JlIHNlbmRpbmcnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMueGhyXy5zdGF0dXNUZXh0O1xuICB9XG5cbiAgLyoqIEFib3J0cyB0aGUgcmVxdWVzdC4gKi9cbiAgYWJvcnQoKTogdm9pZCB7XG4gICAgdGhpcy54aHJfLmFib3J0KCk7XG4gIH1cblxuICBnZXRSZXNwb25zZUhlYWRlcihoZWFkZXI6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnhocl8uZ2V0UmVzcG9uc2VIZWFkZXIoaGVhZGVyKTtcbiAgfVxuXG4gIGFkZFVwbG9hZFByb2dyZXNzTGlzdGVuZXIobGlzdGVuZXI6IChwMTogUHJvZ3Jlc3NFdmVudCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnhocl8udXBsb2FkICE9IG51bGwpIHtcbiAgICAgIHRoaXMueGhyXy51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBsaXN0ZW5lcik7XG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlVXBsb2FkUHJvZ3Jlc3NMaXN0ZW5lcihsaXN0ZW5lcjogKHAxOiBQcm9ncmVzc0V2ZW50KSA9PiB2b2lkKTogdm9pZCB7XG4gICAgaWYgKHRoaXMueGhyXy51cGxvYWQgIT0gbnVsbCkge1xuICAgICAgdGhpcy54aHJfLnVwbG9hZC5yZW1vdmVFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGxpc3RlbmVyKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFhoclRleHRDb25uZWN0aW9uIGV4dGVuZHMgWGhyQ29ubmVjdGlvbjxzdHJpbmc+IHtcbiAgaW5pdFhocigpOiB2b2lkIHtcbiAgICB0aGlzLnhocl8ucmVzcG9uc2VUeXBlID0gJ3RleHQnO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBuZXdUZXh0Q29ubmVjdGlvbigpOiBDb25uZWN0aW9uPHN0cmluZz4ge1xuICByZXR1cm4gdGV4dEZhY3RvcnlPdmVycmlkZSA/IHRleHRGYWN0b3J5T3ZlcnJpZGUoKSA6IG5ldyBYaHJUZXh0Q29ubmVjdGlvbigpO1xufVxuXG5leHBvcnQgY2xhc3MgWGhyQnl0ZXNDb25uZWN0aW9uIGV4dGVuZHMgWGhyQ29ubmVjdGlvbjxBcnJheUJ1ZmZlcj4ge1xuICBwcml2YXRlIGRhdGFfPzogQXJyYXlCdWZmZXI7XG5cbiAgaW5pdFhocigpOiB2b2lkIHtcbiAgICB0aGlzLnhocl8ucmVzcG9uc2VUeXBlID0gJ2FycmF5YnVmZmVyJztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbmV3Qnl0ZXNDb25uZWN0aW9uKCk6IENvbm5lY3Rpb248QXJyYXlCdWZmZXI+IHtcbiAgcmV0dXJuIG5ldyBYaHJCeXRlc0Nvbm5lY3Rpb24oKTtcbn1cblxuZXhwb3J0IGNsYXNzIFhockJsb2JDb25uZWN0aW9uIGV4dGVuZHMgWGhyQ29ubmVjdGlvbjxCbG9iPiB7XG4gIGluaXRYaHIoKTogdm9pZCB7XG4gICAgdGhpcy54aHJfLnJlc3BvbnNlVHlwZSA9ICdibG9iJztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gbmV3QmxvYkNvbm5lY3Rpb24oKTogQ29ubmVjdGlvbjxCbG9iPiB7XG4gIHJldHVybiBuZXcgWGhyQmxvYkNvbm5lY3Rpb24oKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5ld1N0cmVhbUNvbm5lY3Rpb24oKTogQ29ubmVjdGlvbjxOb2RlSlMuUmVhZGFibGVTdHJlYW0+IHtcbiAgdGhyb3cgbmV3IEVycm9yKCdTdHJlYW1zIGFyZSBvbmx5IHN1cHBvcnRlZCBvbiBOb2RlJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbmplY3RUZXN0Q29ubmVjdGlvbihcbiAgZmFjdG9yeTogKCgpID0+IENvbm5lY3Rpb248c3RyaW5nPikgfCBudWxsXG4pOiB2b2lkIHtcbiAgdGV4dEZhY3RvcnlPdmVycmlkZSA9IGZhY3Rvcnk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQGZpbGVvdmVydmlldyBEZWZpbmVzIHR5cGVzIGZvciBpbnRlcmFjdGluZyB3aXRoIGJsb2IgdHJhbnNmZXIgdGFza3MuXG4gKi9cblxuaW1wb3J0IHsgRmJzQmxvYiB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vYmxvYic7XG5pbXBvcnQge1xuICBjYW5jZWxlZCxcbiAgU3RvcmFnZUVycm9yQ29kZSxcbiAgU3RvcmFnZUVycm9yLFxuICByZXRyeUxpbWl0RXhjZWVkZWRcbn0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9lcnJvcic7XG5pbXBvcnQge1xuICBJbnRlcm5hbFRhc2tTdGF0ZSxcbiAgVGFza0V2ZW50LFxuICBUYXNrU3RhdGUsXG4gIHRhc2tTdGF0ZUZyb21JbnRlcm5hbFRhc2tTdGF0ZVxufSBmcm9tICcuL2ltcGxlbWVudGF0aW9uL3Rhc2tlbnVtcyc7XG5pbXBvcnQgeyBNZXRhZGF0YSB9IGZyb20gJy4vbWV0YWRhdGEnO1xuaW1wb3J0IHtcbiAgT2JzZXJ2ZXIsXG4gIFN1YnNjcmliZSxcbiAgVW5zdWJzY3JpYmUsXG4gIFN0b3JhZ2VPYnNlcnZlciBhcyBTdG9yYWdlT2JzZXJ2ZXJJbnRlcm5hbCxcbiAgTmV4dEZuXG59IGZyb20gJy4vaW1wbGVtZW50YXRpb24vb2JzZXJ2ZXInO1xuaW1wb3J0IHsgUmVxdWVzdCB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vcmVxdWVzdCc7XG5pbXBvcnQgeyBVcGxvYWRUYXNrU25hcHNob3QsIFN0b3JhZ2VPYnNlcnZlciB9IGZyb20gJy4vcHVibGljLXR5cGVzJztcbmltcG9ydCB7IGFzeW5jIGFzIGZic0FzeW5jIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9hc3luYyc7XG5pbXBvcnQgeyBNYXBwaW5ncywgZ2V0TWFwcGluZ3MgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9uL21ldGFkYXRhJztcbmltcG9ydCB7XG4gIGNyZWF0ZVJlc3VtYWJsZVVwbG9hZCxcbiAgZ2V0UmVzdW1hYmxlVXBsb2FkU3RhdHVzLFxuICBSRVNVTUFCTEVfVVBMT0FEX0NIVU5LX1NJWkUsXG4gIFJlc3VtYWJsZVVwbG9hZFN0YXR1cyxcbiAgY29udGludWVSZXN1bWFibGVVcGxvYWQsXG4gIGdldE1ldGFkYXRhLFxuICBtdWx0aXBhcnRVcGxvYWRcbn0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9yZXF1ZXN0cyc7XG5pbXBvcnQgeyBSZWZlcmVuY2UgfSBmcm9tICcuL3JlZmVyZW5jZSc7XG5pbXBvcnQgeyBuZXdUZXh0Q29ubmVjdGlvbiB9IGZyb20gJy4vcGxhdGZvcm0vY29ubmVjdGlvbic7XG5pbXBvcnQgeyBpc1JldHJ5U3RhdHVzQ29kZSB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vdXRpbHMnO1xuaW1wb3J0IHsgQ29tcGxldGVGbiB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IERFRkFVTFRfTUlOX1NMRUVQX1RJTUVfTUlMTElTIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9jb25zdGFudHMnO1xuXG4vKipcbiAqIFJlcHJlc2VudHMgYSBibG9iIGJlaW5nIHVwbG9hZGVkLiBDYW4gYmUgdXNlZCB0byBwYXVzZS9yZXN1bWUvY2FuY2VsIHRoZVxuICogdXBsb2FkIGFuZCBtYW5hZ2UgY2FsbGJhY2tzIGZvciB2YXJpb3VzIGV2ZW50cy5cbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgY2xhc3MgVXBsb2FkVGFzayB7XG4gIHByaXZhdGUgX3JlZjogUmVmZXJlbmNlO1xuICAvKipcbiAgICogVGhlIGRhdGEgdG8gYmUgdXBsb2FkZWQuXG4gICAqL1xuICBfYmxvYjogRmJzQmxvYjtcbiAgLyoqXG4gICAqIE1ldGFkYXRhIHJlbGF0ZWQgdG8gdGhlIHVwbG9hZC5cbiAgICovXG4gIF9tZXRhZGF0YTogTWV0YWRhdGEgfCBudWxsO1xuICBwcml2YXRlIF9tYXBwaW5nczogTWFwcGluZ3M7XG4gIC8qKlxuICAgKiBOdW1iZXIgb2YgYnl0ZXMgdHJhbnNmZXJyZWQgc28gZmFyLlxuICAgKi9cbiAgX3RyYW5zZmVycmVkOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIF9uZWVkVG9GZXRjaFN0YXR1czogYm9vbGVhbiA9IGZhbHNlO1xuICBwcml2YXRlIF9uZWVkVG9GZXRjaE1ldGFkYXRhOiBib29sZWFuID0gZmFsc2U7XG4gIHByaXZhdGUgX29ic2VydmVyczogQXJyYXk8U3RvcmFnZU9ic2VydmVySW50ZXJuYWw8VXBsb2FkVGFza1NuYXBzaG90Pj4gPSBbXTtcbiAgcHJpdmF0ZSBfcmVzdW1hYmxlOiBib29sZWFuO1xuICAvKipcbiAgICogVXBsb2FkIHN0YXRlLlxuICAgKi9cbiAgX3N0YXRlOiBJbnRlcm5hbFRhc2tTdGF0ZTtcbiAgcHJpdmF0ZSBfZXJyb3I/OiBTdG9yYWdlRXJyb3IgPSB1bmRlZmluZWQ7XG4gIHByaXZhdGUgX3VwbG9hZFVybD86IHN0cmluZyA9IHVuZGVmaW5lZDtcbiAgcHJpdmF0ZSBfcmVxdWVzdD86IFJlcXVlc3Q8dW5rbm93bj4gPSB1bmRlZmluZWQ7XG4gIHByaXZhdGUgX2NodW5rTXVsdGlwbGllcjogbnVtYmVyID0gMTtcbiAgcHJpdmF0ZSBfZXJyb3JIYW5kbGVyOiAocDE6IFN0b3JhZ2VFcnJvcikgPT4gdm9pZDtcbiAgcHJpdmF0ZSBfbWV0YWRhdGFFcnJvckhhbmRsZXI6IChwMTogU3RvcmFnZUVycm9yKSA9PiB2b2lkO1xuICBwcml2YXRlIF9yZXNvbHZlPzogKHAxOiBVcGxvYWRUYXNrU25hcHNob3QpID0+IHZvaWQgPSB1bmRlZmluZWQ7XG4gIHByaXZhdGUgX3JlamVjdD86IChwMTogU3RvcmFnZUVycm9yKSA9PiB2b2lkID0gdW5kZWZpbmVkO1xuICBwcml2YXRlIHBlbmRpbmdUaW1lb3V0PzogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0VGltZW91dD47XG4gIHByaXZhdGUgX3Byb21pc2U6IFByb21pc2U8VXBsb2FkVGFza1NuYXBzaG90PjtcblxuICBwcml2YXRlIHNsZWVwVGltZTogbnVtYmVyO1xuXG4gIHByaXZhdGUgbWF4U2xlZXBUaW1lOiBudW1iZXI7XG5cbiAgaXNFeHBvbmVudGlhbEJhY2tvZmZFeHBpcmVkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLnNsZWVwVGltZSA+IHRoaXMubWF4U2xlZXBUaW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSByZWYgLSBUaGUgZmlyZWJhc2VTdG9yYWdlLlJlZmVyZW5jZSBvYmplY3QgdGhpcyB0YXNrIGNhbWVcbiAgICogICAgIGZyb20sIHVudHlwZWQgdG8gYXZvaWQgY3ljbGljIGRlcGVuZGVuY2llcy5cbiAgICogQHBhcmFtIGJsb2IgLSBUaGUgYmxvYiB0byB1cGxvYWQuXG4gICAqL1xuICBjb25zdHJ1Y3RvcihyZWY6IFJlZmVyZW5jZSwgYmxvYjogRmJzQmxvYiwgbWV0YWRhdGE6IE1ldGFkYXRhIHwgbnVsbCA9IG51bGwpIHtcbiAgICB0aGlzLl9yZWYgPSByZWY7XG4gICAgdGhpcy5fYmxvYiA9IGJsb2I7XG4gICAgdGhpcy5fbWV0YWRhdGEgPSBtZXRhZGF0YTtcbiAgICB0aGlzLl9tYXBwaW5ncyA9IGdldE1hcHBpbmdzKCk7XG4gICAgdGhpcy5fcmVzdW1hYmxlID0gdGhpcy5fc2hvdWxkRG9SZXN1bWFibGUodGhpcy5fYmxvYik7XG4gICAgdGhpcy5fc3RhdGUgPSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HO1xuICAgIHRoaXMuX2Vycm9ySGFuZGxlciA9IGVycm9yID0+IHtcbiAgICAgIHRoaXMuX3JlcXVlc3QgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLl9jaHVua011bHRpcGxpZXIgPSAxO1xuICAgICAgaWYgKGVycm9yLl9jb2RlRXF1YWxzKFN0b3JhZ2VFcnJvckNvZGUuQ0FOQ0VMRUQpKSB7XG4gICAgICAgIHRoaXMuX25lZWRUb0ZldGNoU3RhdHVzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5jb21wbGV0ZVRyYW5zaXRpb25zXygpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgYmFja29mZkV4cGlyZWQgPSB0aGlzLmlzRXhwb25lbnRpYWxCYWNrb2ZmRXhwaXJlZCgpO1xuICAgICAgICBpZiAoaXNSZXRyeVN0YXR1c0NvZGUoZXJyb3Iuc3RhdHVzLCBbXSkpIHtcbiAgICAgICAgICBpZiAoYmFja29mZkV4cGlyZWQpIHtcbiAgICAgICAgICAgIGVycm9yID0gcmV0cnlMaW1pdEV4Y2VlZGVkKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2xlZXBUaW1lID0gTWF0aC5tYXgoXG4gICAgICAgICAgICAgIHRoaXMuc2xlZXBUaW1lICogMixcbiAgICAgICAgICAgICAgREVGQVVMVF9NSU5fU0xFRVBfVElNRV9NSUxMSVNcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLl9uZWVkVG9GZXRjaFN0YXR1cyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmNvbXBsZXRlVHJhbnNpdGlvbnNfKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2Vycm9yID0gZXJyb3I7XG4gICAgICAgIHRoaXMuX3RyYW5zaXRpb24oSW50ZXJuYWxUYXNrU3RhdGUuRVJST1IpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5fbWV0YWRhdGFFcnJvckhhbmRsZXIgPSBlcnJvciA9PiB7XG4gICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xuICAgICAgaWYgKGVycm9yLl9jb2RlRXF1YWxzKFN0b3JhZ2VFcnJvckNvZGUuQ0FOQ0VMRUQpKSB7XG4gICAgICAgIHRoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2Vycm9yID0gZXJyb3I7XG4gICAgICAgIHRoaXMuX3RyYW5zaXRpb24oSW50ZXJuYWxUYXNrU3RhdGUuRVJST1IpO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5zbGVlcFRpbWUgPSAwO1xuICAgIHRoaXMubWF4U2xlZXBUaW1lID0gdGhpcy5fcmVmLnN0b3JhZ2UubWF4VXBsb2FkUmV0cnlUaW1lO1xuICAgIHRoaXMuX3Byb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICB0aGlzLl9yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICAgIHRoaXMuX3JlamVjdCA9IHJlamVjdDtcbiAgICAgIHRoaXMuX3N0YXJ0KCk7XG4gICAgfSk7XG5cbiAgICAvLyBQcmV2ZW50IHVuY2F1Z2h0IHJlamVjdGlvbnMgb24gdGhlIGludGVybmFsIHByb21pc2UgZnJvbSBidWJibGluZyBvdXRcbiAgICAvLyB0byB0aGUgdG9wIGxldmVsIHdpdGggYSBkdW1teSBoYW5kbGVyLlxuICAgIHRoaXMuX3Byb21pc2UudGhlbihudWxsLCAoKSA9PiB7fSk7XG4gIH1cblxuICBwcml2YXRlIF9tYWtlUHJvZ3Jlc3NDYWxsYmFjaygpOiAocDE6IG51bWJlciwgcDI6IG51bWJlcikgPT4gdm9pZCB7XG4gICAgY29uc3Qgc2l6ZUJlZm9yZSA9IHRoaXMuX3RyYW5zZmVycmVkO1xuICAgIHJldHVybiBsb2FkZWQgPT4gdGhpcy5fdXBkYXRlUHJvZ3Jlc3Moc2l6ZUJlZm9yZSArIGxvYWRlZCk7XG4gIH1cblxuICBwcml2YXRlIF9zaG91bGREb1Jlc3VtYWJsZShibG9iOiBGYnNCbG9iKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGJsb2Iuc2l6ZSgpID4gMjU2ICogMTAyNDtcbiAgfVxuXG4gIHByaXZhdGUgX3N0YXJ0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9zdGF0ZSAhPT0gSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORykge1xuICAgICAgLy8gVGhpcyBjYW4gaGFwcGVuIGlmIHNvbWVvbmUgcGF1c2VzIHVzIGluIGEgcmVzdW1lIGNhbGxiYWNrLCBmb3IgZXhhbXBsZS5cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHRoaXMuX3JlcXVlc3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodGhpcy5fcmVzdW1hYmxlKSB7XG4gICAgICBpZiAodGhpcy5fdXBsb2FkVXJsID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5fY3JlYXRlUmVzdW1hYmxlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5fbmVlZFRvRmV0Y2hTdGF0dXMpIHtcbiAgICAgICAgICB0aGlzLl9mZXRjaFN0YXR1cygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICh0aGlzLl9uZWVkVG9GZXRjaE1ldGFkYXRhKSB7XG4gICAgICAgICAgICAvLyBIYXBwZW5zIGlmIHdlIG1pc3MgdGhlIG1ldGFkYXRhIG9uIHVwbG9hZCBjb21wbGV0aW9uLlxuICAgICAgICAgICAgdGhpcy5fZmV0Y2hNZXRhZGF0YSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnBlbmRpbmdUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMucGVuZGluZ1RpbWVvdXQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgIHRoaXMuX2NvbnRpbnVlVXBsb2FkKCk7XG4gICAgICAgICAgICB9LCB0aGlzLnNsZWVwVGltZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX29uZVNob3RVcGxvYWQoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9yZXNvbHZlVG9rZW4oXG4gICAgY2FsbGJhY2s6IChhdXRoVG9rZW46IHN0cmluZyB8IG51bGwsIGFwcENoZWNrVG9rZW46IHN0cmluZyB8IG51bGwpID0+IHZvaWRcbiAgKTogdm9pZCB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgIFByb21pc2UuYWxsKFtcbiAgICAgIHRoaXMuX3JlZi5zdG9yYWdlLl9nZXRBdXRoVG9rZW4oKSxcbiAgICAgIHRoaXMuX3JlZi5zdG9yYWdlLl9nZXRBcHBDaGVja1Rva2VuKClcbiAgICBdKS50aGVuKChbYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuXSkgPT4ge1xuICAgICAgc3dpdGNoICh0aGlzLl9zdGF0ZSkge1xuICAgICAgICBjYXNlIEludGVybmFsVGFza1N0YXRlLlJVTk5JTkc6XG4gICAgICAgICAgY2FsbGJhY2soYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkc6XG4gICAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxFRCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORzpcbiAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uKEludGVybmFsVGFza1N0YXRlLlBBVVNFRCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0IGZhbHNlXG5cbiAgcHJpdmF0ZSBfY3JlYXRlUmVzdW1hYmxlKCk6IHZvaWQge1xuICAgIHRoaXMuX3Jlc29sdmVUb2tlbigoYXV0aFRva2VuLCBhcHBDaGVja1Rva2VuKSA9PiB7XG4gICAgICBjb25zdCByZXF1ZXN0SW5mbyA9IGNyZWF0ZVJlc3VtYWJsZVVwbG9hZChcbiAgICAgICAgdGhpcy5fcmVmLnN0b3JhZ2UsXG4gICAgICAgIHRoaXMuX3JlZi5fbG9jYXRpb24sXG4gICAgICAgIHRoaXMuX21hcHBpbmdzLFxuICAgICAgICB0aGlzLl9ibG9iLFxuICAgICAgICB0aGlzLl9tZXRhZGF0YVxuICAgICAgKTtcbiAgICAgIGNvbnN0IGNyZWF0ZVJlcXVlc3QgPSB0aGlzLl9yZWYuc3RvcmFnZS5fbWFrZVJlcXVlc3QoXG4gICAgICAgIHJlcXVlc3RJbmZvLFxuICAgICAgICBuZXdUZXh0Q29ubmVjdGlvbixcbiAgICAgICAgYXV0aFRva2VuLFxuICAgICAgICBhcHBDaGVja1Rva2VuXG4gICAgICApO1xuICAgICAgdGhpcy5fcmVxdWVzdCA9IGNyZWF0ZVJlcXVlc3Q7XG4gICAgICBjcmVhdGVSZXF1ZXN0LmdldFByb21pc2UoKS50aGVuKCh1cmw6IHN0cmluZykgPT4ge1xuICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl91cGxvYWRVcmwgPSB1cmw7XG4gICAgICAgIHRoaXMuX25lZWRUb0ZldGNoU3RhdHVzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcbiAgICAgIH0sIHRoaXMuX2Vycm9ySGFuZGxlcik7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF9mZXRjaFN0YXR1cygpOiB2b2lkIHtcbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0KHRoaXMudXBsb2FkVXJsXyAhPT0gbnVsbCk7XG4gICAgY29uc3QgdXJsID0gdGhpcy5fdXBsb2FkVXJsIGFzIHN0cmluZztcbiAgICB0aGlzLl9yZXNvbHZlVG9rZW4oKGF1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbikgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdEluZm8gPSBnZXRSZXN1bWFibGVVcGxvYWRTdGF0dXMoXG4gICAgICAgIHRoaXMuX3JlZi5zdG9yYWdlLFxuICAgICAgICB0aGlzLl9yZWYuX2xvY2F0aW9uLFxuICAgICAgICB1cmwsXG4gICAgICAgIHRoaXMuX2Jsb2JcbiAgICAgICk7XG4gICAgICBjb25zdCBzdGF0dXNSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KFxuICAgICAgICByZXF1ZXN0SW5mbyxcbiAgICAgICAgbmV3VGV4dENvbm5lY3Rpb24sXG4gICAgICAgIGF1dGhUb2tlbixcbiAgICAgICAgYXBwQ2hlY2tUb2tlblxuICAgICAgKTtcbiAgICAgIHRoaXMuX3JlcXVlc3QgPSBzdGF0dXNSZXF1ZXN0O1xuICAgICAgc3RhdHVzUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihzdGF0dXMgPT4ge1xuICAgICAgICBzdGF0dXMgPSBzdGF0dXMgYXMgUmVzdW1hYmxlVXBsb2FkU3RhdHVzO1xuICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl91cGRhdGVQcm9ncmVzcyhzdGF0dXMuY3VycmVudCk7XG4gICAgICAgIHRoaXMuX25lZWRUb0ZldGNoU3RhdHVzID0gZmFsc2U7XG4gICAgICAgIGlmIChzdGF0dXMuZmluYWxpemVkKSB7XG4gICAgICAgICAgdGhpcy5fbmVlZFRvRmV0Y2hNZXRhZGF0YSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb21wbGV0ZVRyYW5zaXRpb25zXygpO1xuICAgICAgfSwgdGhpcy5fZXJyb3JIYW5kbGVyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2NvbnRpbnVlVXBsb2FkKCk6IHZvaWQge1xuICAgIGNvbnN0IGNodW5rU2l6ZSA9IFJFU1VNQUJMRV9VUExPQURfQ0hVTktfU0laRSAqIHRoaXMuX2NodW5rTXVsdGlwbGllcjtcbiAgICBjb25zdCBzdGF0dXMgPSBuZXcgUmVzdW1hYmxlVXBsb2FkU3RhdHVzKFxuICAgICAgdGhpcy5fdHJhbnNmZXJyZWQsXG4gICAgICB0aGlzLl9ibG9iLnNpemUoKVxuICAgICk7XG5cbiAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0KHRoaXMudXBsb2FkVXJsXyAhPT0gbnVsbCk7XG4gICAgY29uc3QgdXJsID0gdGhpcy5fdXBsb2FkVXJsIGFzIHN0cmluZztcbiAgICB0aGlzLl9yZXNvbHZlVG9rZW4oKGF1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbikgPT4ge1xuICAgICAgbGV0IHJlcXVlc3RJbmZvO1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWVzdEluZm8gPSBjb250aW51ZVJlc3VtYWJsZVVwbG9hZChcbiAgICAgICAgICB0aGlzLl9yZWYuX2xvY2F0aW9uLFxuICAgICAgICAgIHRoaXMuX3JlZi5zdG9yYWdlLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICB0aGlzLl9ibG9iLFxuICAgICAgICAgIGNodW5rU2l6ZSxcbiAgICAgICAgICB0aGlzLl9tYXBwaW5ncyxcbiAgICAgICAgICBzdGF0dXMsXG4gICAgICAgICAgdGhpcy5fbWFrZVByb2dyZXNzQ2FsbGJhY2soKVxuICAgICAgICApO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aGlzLl9lcnJvciA9IGUgYXMgU3RvcmFnZUVycm9yO1xuICAgICAgICB0aGlzLl90cmFuc2l0aW9uKEludGVybmFsVGFza1N0YXRlLkVSUk9SKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgdXBsb2FkUmVxdWVzdCA9IHRoaXMuX3JlZi5zdG9yYWdlLl9tYWtlUmVxdWVzdChcbiAgICAgICAgcmVxdWVzdEluZm8sXG4gICAgICAgIG5ld1RleHRDb25uZWN0aW9uLFxuICAgICAgICBhdXRoVG9rZW4sXG4gICAgICAgIGFwcENoZWNrVG9rZW4sXG4gICAgICAgIC8qcmV0cnk9Ki8gZmFsc2UgLy8gVXBsb2FkIHJlcXVlc3RzIHNob3VsZCBub3QgYmUgcmV0cmllZCBhcyBlYWNoIHJldHJ5IHNob3VsZCBiZSBwcmVjZWRlZCBieSBhbm90aGVyIHF1ZXJ5IHJlcXVlc3QuIFdoaWNoIGlzIGhhbmRsZWQgaW4gdGhpcyBmaWxlLlxuICAgICAgKTtcbiAgICAgIHRoaXMuX3JlcXVlc3QgPSB1cGxvYWRSZXF1ZXN0O1xuICAgICAgdXBsb2FkUmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbigobmV3U3RhdHVzOiBSZXN1bWFibGVVcGxvYWRTdGF0dXMpID0+IHtcbiAgICAgICAgdGhpcy5faW5jcmVhc2VNdWx0aXBsaWVyKCk7XG4gICAgICAgIHRoaXMuX3JlcXVlc3QgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVByb2dyZXNzKG5ld1N0YXR1cy5jdXJyZW50KTtcbiAgICAgICAgaWYgKG5ld1N0YXR1cy5maW5hbGl6ZWQpIHtcbiAgICAgICAgICB0aGlzLl9tZXRhZGF0YSA9IG5ld1N0YXR1cy5tZXRhZGF0YTtcbiAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uKEludGVybmFsVGFza1N0YXRlLlNVQ0NFU1MpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcbiAgICAgICAgfVxuICAgICAgfSwgdGhpcy5fZXJyb3JIYW5kbGVyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2luY3JlYXNlTXVsdGlwbGllcigpOiB2b2lkIHtcbiAgICBjb25zdCBjdXJyZW50U2l6ZSA9IFJFU1VNQUJMRV9VUExPQURfQ0hVTktfU0laRSAqIHRoaXMuX2NodW5rTXVsdGlwbGllcjtcblxuICAgIC8vIE1heCBjaHVuayBzaXplIGlzIDMyTS5cbiAgICBpZiAoY3VycmVudFNpemUgKiAyIDwgMzIgKiAxMDI0ICogMTAyNCkge1xuICAgICAgdGhpcy5fY2h1bmtNdWx0aXBsaWVyICo9IDI7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBfZmV0Y2hNZXRhZGF0YSgpOiB2b2lkIHtcbiAgICB0aGlzLl9yZXNvbHZlVG9rZW4oKGF1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbikgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdEluZm8gPSBnZXRNZXRhZGF0YShcbiAgICAgICAgdGhpcy5fcmVmLnN0b3JhZ2UsXG4gICAgICAgIHRoaXMuX3JlZi5fbG9jYXRpb24sXG4gICAgICAgIHRoaXMuX21hcHBpbmdzXG4gICAgICApO1xuICAgICAgY29uc3QgbWV0YWRhdGFSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KFxuICAgICAgICByZXF1ZXN0SW5mbyxcbiAgICAgICAgbmV3VGV4dENvbm5lY3Rpb24sXG4gICAgICAgIGF1dGhUb2tlbixcbiAgICAgICAgYXBwQ2hlY2tUb2tlblxuICAgICAgKTtcbiAgICAgIHRoaXMuX3JlcXVlc3QgPSBtZXRhZGF0YVJlcXVlc3Q7XG4gICAgICBtZXRhZGF0YVJlcXVlc3QuZ2V0UHJvbWlzZSgpLnRoZW4obWV0YWRhdGEgPT4ge1xuICAgICAgICB0aGlzLl9yZXF1ZXN0ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9tZXRhZGF0YSA9IG1ldGFkYXRhO1xuICAgICAgICB0aGlzLl90cmFuc2l0aW9uKEludGVybmFsVGFza1N0YXRlLlNVQ0NFU1MpO1xuICAgICAgfSwgdGhpcy5fbWV0YWRhdGFFcnJvckhhbmRsZXIpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBfb25lU2hvdFVwbG9hZCgpOiB2b2lkIHtcbiAgICB0aGlzLl9yZXNvbHZlVG9rZW4oKGF1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbikgPT4ge1xuICAgICAgY29uc3QgcmVxdWVzdEluZm8gPSBtdWx0aXBhcnRVcGxvYWQoXG4gICAgICAgIHRoaXMuX3JlZi5zdG9yYWdlLFxuICAgICAgICB0aGlzLl9yZWYuX2xvY2F0aW9uLFxuICAgICAgICB0aGlzLl9tYXBwaW5ncyxcbiAgICAgICAgdGhpcy5fYmxvYixcbiAgICAgICAgdGhpcy5fbWV0YWRhdGFcbiAgICAgICk7XG4gICAgICBjb25zdCBtdWx0aXBhcnRSZXF1ZXN0ID0gdGhpcy5fcmVmLnN0b3JhZ2UuX21ha2VSZXF1ZXN0KFxuICAgICAgICByZXF1ZXN0SW5mbyxcbiAgICAgICAgbmV3VGV4dENvbm5lY3Rpb24sXG4gICAgICAgIGF1dGhUb2tlbixcbiAgICAgICAgYXBwQ2hlY2tUb2tlblxuICAgICAgKTtcbiAgICAgIHRoaXMuX3JlcXVlc3QgPSBtdWx0aXBhcnRSZXF1ZXN0O1xuICAgICAgbXVsdGlwYXJ0UmVxdWVzdC5nZXRQcm9taXNlKCkudGhlbihtZXRhZGF0YSA9PiB7XG4gICAgICAgIHRoaXMuX3JlcXVlc3QgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX21ldGFkYXRhID0gbWV0YWRhdGE7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVByb2dyZXNzKHRoaXMuX2Jsb2Iuc2l6ZSgpKTtcbiAgICAgICAgdGhpcy5fdHJhbnNpdGlvbihJbnRlcm5hbFRhc2tTdGF0ZS5TVUNDRVNTKTtcbiAgICAgIH0sIHRoaXMuX2Vycm9ySGFuZGxlcik7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF91cGRhdGVQcm9ncmVzcyh0cmFuc2ZlcnJlZDogbnVtYmVyKTogdm9pZCB7XG4gICAgY29uc3Qgb2xkID0gdGhpcy5fdHJhbnNmZXJyZWQ7XG4gICAgdGhpcy5fdHJhbnNmZXJyZWQgPSB0cmFuc2ZlcnJlZDtcblxuICAgIC8vIEEgcHJvZ3Jlc3MgdXBkYXRlIGNhbiBtYWtlIHRoZSBcInRyYW5zZmVycmVkXCIgdmFsdWUgc21hbGxlciAoZS5nLiBhXG4gICAgLy8gcGFydGlhbCB1cGxvYWQgbm90IGNvbXBsZXRlZCBieSBzZXJ2ZXIsIGFmdGVyIHdoaWNoIHRoZSBcInRyYW5zZmVycmVkXCJcbiAgICAvLyB2YWx1ZSBtYXkgcmVzZXQgdG8gdGhlIHZhbHVlIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIHJlcXVlc3QpLlxuICAgIGlmICh0aGlzLl90cmFuc2ZlcnJlZCAhPT0gb2xkKSB7XG4gICAgICB0aGlzLl9ub3RpZnlPYnNlcnZlcnMoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF90cmFuc2l0aW9uKHN0YXRlOiBJbnRlcm5hbFRhc2tTdGF0ZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gc3RhdGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc3dpdGNoIChzdGF0ZSkge1xuICAgICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkc6XG4gICAgICBjYXNlIEludGVybmFsVGFza1N0YXRlLlBBVVNJTkc6XG4gICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxuICAgICAgICAvLyBhc3NlcnQodGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlJVTk5JTkcgfHxcbiAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HKTtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3QgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHRoaXMuX3JlcXVlc3QuY2FuY2VsKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wZW5kaW5nVGltZW91dCkge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnBlbmRpbmdUaW1lb3V0KTtcbiAgICAgICAgICB0aGlzLnBlbmRpbmdUaW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHRoaXMuY29tcGxldGVUcmFuc2l0aW9uc18oKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORzpcbiAgICAgICAgLy8gVE9ETyhhbmR5c290byk6XG4gICAgICAgIC8vIGFzc2VydCh0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEIHx8XG4gICAgICAgIC8vICAgICAgICB0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORyk7XG4gICAgICAgIGNvbnN0IHdhc1BhdXNlZCA9IHRoaXMuX3N0YXRlID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTRUQ7XG4gICAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICAgIGlmICh3YXNQYXVzZWQpIHtcbiAgICAgICAgICB0aGlzLl9ub3RpZnlPYnNlcnZlcnMoKTtcbiAgICAgICAgICB0aGlzLl9zdGFydCgpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTRUQ6XG4gICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxuICAgICAgICAvLyBhc3NlcnQodGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlBBVVNJTkcpO1xuICAgICAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlO1xuICAgICAgICB0aGlzLl9ub3RpZnlPYnNlcnZlcnMoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEludGVybmFsVGFza1N0YXRlLkNBTkNFTEVEOlxuICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcbiAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTRUQgfHxcbiAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkcpO1xuICAgICAgICB0aGlzLl9lcnJvciA9IGNhbmNlbGVkKCk7XG4gICAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVycygpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSW50ZXJuYWxUYXNrU3RhdGUuRVJST1I6XG4gICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOlxuICAgICAgICAvLyBhc3NlcnQodGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLlJVTk5JTkcgfHxcbiAgICAgICAgLy8gICAgICAgIHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HIHx8XG4gICAgICAgIC8vICAgICAgICB0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuQ0FOQ0VMSU5HKTtcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTtcbiAgICAgICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXJzKCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5TVUNDRVNTOlxuICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTpcbiAgICAgICAgLy8gYXNzZXJ0KHRoaXMuc3RhdGVfID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HIHx8XG4gICAgICAgIC8vICAgICAgICB0aGlzLnN0YXRlXyA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORyB8fFxuICAgICAgICAvLyAgICAgICAgdGhpcy5zdGF0ZV8gPT09IEludGVybmFsVGFza1N0YXRlLkNBTkNFTElORyk7XG4gICAgICAgIHRoaXMuX3N0YXRlID0gc3RhdGU7XG4gICAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVycygpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6IC8vIElnbm9yZVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgY29tcGxldGVUcmFuc2l0aW9uc18oKTogdm9pZCB7XG4gICAgc3dpdGNoICh0aGlzLl9zdGF0ZSkge1xuICAgICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HOlxuICAgICAgICB0aGlzLl90cmFuc2l0aW9uKEludGVybmFsVGFza1N0YXRlLlBBVVNFRCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkc6XG4gICAgICAgIHRoaXMuX3RyYW5zaXRpb24oSW50ZXJuYWxUYXNrU3RhdGUuQ0FOQ0VMRUQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORzpcbiAgICAgICAgdGhpcy5fc3RhcnQoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICAvLyBUT0RPKGFuZHlzb3RvKTogYXNzZXJ0KGZhbHNlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEEgc25hcHNob3Qgb2YgdGhlIGN1cnJlbnQgdGFzayBzdGF0ZS5cbiAgICovXG4gIGdldCBzbmFwc2hvdCgpOiBVcGxvYWRUYXNrU25hcHNob3Qge1xuICAgIGNvbnN0IGV4dGVybmFsU3RhdGUgPSB0YXNrU3RhdGVGcm9tSW50ZXJuYWxUYXNrU3RhdGUodGhpcy5fc3RhdGUpO1xuICAgIHJldHVybiB7XG4gICAgICBieXRlc1RyYW5zZmVycmVkOiB0aGlzLl90cmFuc2ZlcnJlZCxcbiAgICAgIHRvdGFsQnl0ZXM6IHRoaXMuX2Jsb2Iuc2l6ZSgpLFxuICAgICAgc3RhdGU6IGV4dGVybmFsU3RhdGUsXG4gICAgICBtZXRhZGF0YTogdGhpcy5fbWV0YWRhdGEhLFxuICAgICAgdGFzazogdGhpcyxcbiAgICAgIHJlZjogdGhpcy5fcmVmXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGEgY2FsbGJhY2sgZm9yIGFuIGV2ZW50LlxuICAgKiBAcGFyYW0gdHlwZSAtIFRoZSB0eXBlIG9mIGV2ZW50IHRvIGxpc3RlbiBmb3IuXG4gICAqIEBwYXJhbSBuZXh0T3JPYnNlcnZlciAtXG4gICAqICAgICBUaGUgYG5leHRgIGZ1bmN0aW9uLCB3aGljaCBnZXRzIGNhbGxlZCBmb3IgZWFjaCBpdGVtIGluXG4gICAqICAgICB0aGUgZXZlbnQgc3RyZWFtLCBvciBhbiBvYnNlcnZlciBvYmplY3Qgd2l0aCBzb21lIG9yIGFsbCBvZiB0aGVzZSB0aHJlZVxuICAgKiAgICAgcHJvcGVydGllcyAoYG5leHRgLCBgZXJyb3JgLCBgY29tcGxldGVgKS5cbiAgICogQHBhcmFtIGVycm9yIC0gQSBmdW5jdGlvbiB0aGF0IGdldHMgY2FsbGVkIHdpdGggYSBgU3RvcmFnZUVycm9yYFxuICAgKiAgICAgaWYgdGhlIGV2ZW50IHN0cmVhbSBlbmRzIGR1ZSB0byBhbiBlcnJvci5cbiAgICogQHBhcmFtIGNvbXBsZXRlZCAtIEEgZnVuY3Rpb24gdGhhdCBnZXRzIGNhbGxlZCBpZiB0aGVcbiAgICogICAgIGV2ZW50IHN0cmVhbSBlbmRzIG5vcm1hbGx5LlxuICAgKiBAcmV0dXJuc1xuICAgKiAgICAgSWYgb25seSB0aGUgZXZlbnQgYXJndW1lbnQgaXMgcGFzc2VkLCByZXR1cm5zIGEgZnVuY3Rpb24geW91IGNhbiB1c2UgdG9cbiAgICogICAgIGFkZCBjYWxsYmFja3MgKHNlZSB0aGUgZXhhbXBsZXMgYWJvdmUpLiBJZiBtb3JlIHRoYW4ganVzdCB0aGUgZXZlbnRcbiAgICogICAgIGFyZ3VtZW50IGlzIHBhc3NlZCwgcmV0dXJucyBhIGZ1bmN0aW9uIHlvdSBjYW4gY2FsbCB0byB1bnJlZ2lzdGVyIHRoZVxuICAgKiAgICAgY2FsbGJhY2tzLlxuICAgKi9cbiAgb24oXG4gICAgdHlwZTogVGFza0V2ZW50LFxuICAgIG5leHRPck9ic2VydmVyPzpcbiAgICAgIHwgU3RvcmFnZU9ic2VydmVyPFVwbG9hZFRhc2tTbmFwc2hvdD5cbiAgICAgIHwgbnVsbFxuICAgICAgfCAoKHNuYXBzaG90OiBVcGxvYWRUYXNrU25hcHNob3QpID0+IHVua25vd24pLFxuICAgIGVycm9yPzogKChhOiBTdG9yYWdlRXJyb3IpID0+IHVua25vd24pIHwgbnVsbCxcbiAgICBjb21wbGV0ZWQ/OiBDb21wbGV0ZUZuIHwgbnVsbFxuICApOiBVbnN1YnNjcmliZSB8IFN1YnNjcmliZTxVcGxvYWRUYXNrU25hcHNob3Q+IHtcbiAgICAvLyBOb3RlOiBgdHlwZWAgaXNuJ3QgYmVpbmcgdXNlZC4gSXRzIHR5cGUgaXMgYWxzbyBpbmNvcnJlY3QuIFRhc2tFdmVudCBzaG91bGQgbm90IGJlIGEgc3RyaW5nLlxuICAgIGNvbnN0IG9ic2VydmVyID0gbmV3IE9ic2VydmVyKFxuICAgICAgKG5leHRPck9ic2VydmVyIGFzXG4gICAgICAgIHwgU3RvcmFnZU9ic2VydmVySW50ZXJuYWw8VXBsb2FkVGFza1NuYXBzaG90PlxuICAgICAgICB8IE5leHRGbjxVcGxvYWRUYXNrU25hcHNob3Q+KSB8fCB1bmRlZmluZWQsXG4gICAgICBlcnJvciB8fCB1bmRlZmluZWQsXG4gICAgICBjb21wbGV0ZWQgfHwgdW5kZWZpbmVkXG4gICAgKTtcbiAgICB0aGlzLl9hZGRPYnNlcnZlcihvYnNlcnZlcik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHRoaXMuX3JlbW92ZU9ic2VydmVyKG9ic2VydmVyKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgb2JqZWN0IGJlaGF2ZXMgbGlrZSBhIFByb21pc2UsIGFuZCByZXNvbHZlcyB3aXRoIGl0cyBzbmFwc2hvdCBkYXRhXG4gICAqIHdoZW4gdGhlIHVwbG9hZCBjb21wbGV0ZXMuXG4gICAqIEBwYXJhbSBvbkZ1bGZpbGxlZCAtIFRoZSBmdWxmaWxsbWVudCBjYWxsYmFjay4gUHJvbWlzZSBjaGFpbmluZyB3b3JrcyBhcyBub3JtYWwuXG4gICAqIEBwYXJhbSBvblJlamVjdGVkIC0gVGhlIHJlamVjdGlvbiBjYWxsYmFjay5cbiAgICovXG4gIHRoZW48VT4oXG4gICAgb25GdWxmaWxsZWQ/OiAoKHZhbHVlOiBVcGxvYWRUYXNrU25hcHNob3QpID0+IFUgfCBQcm9taXNlPFU+KSB8IG51bGwsXG4gICAgb25SZWplY3RlZD86ICgoZXJyb3I6IFN0b3JhZ2VFcnJvcikgPT4gVSB8IFByb21pc2U8VT4pIHwgbnVsbFxuICApOiBQcm9taXNlPFU+IHtcbiAgICAvLyBUaGVzZSBjYXN0cyBhcmUgbmVlZGVkIHNvIHRoYXQgVHlwZVNjcmlwdCBjYW4gaW5mZXIgdGhlIHR5cGVzIG9mIHRoZVxuICAgIC8vIHJlc3VsdGluZyBQcm9taXNlLlxuICAgIHJldHVybiB0aGlzLl9wcm9taXNlLnRoZW48VT4oXG4gICAgICBvbkZ1bGZpbGxlZCBhcyAodmFsdWU6IFVwbG9hZFRhc2tTbmFwc2hvdCkgPT4gVSB8IFByb21pc2U8VT4sXG4gICAgICBvblJlamVjdGVkIGFzICgoZXJyb3I6IHVua25vd24pID0+IFByb21pc2U8bmV2ZXI+KSB8IG51bGxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEVxdWl2YWxlbnQgdG8gY2FsbGluZyBgdGhlbihudWxsLCBvblJlamVjdGVkKWAuXG4gICAqL1xuICBjYXRjaDxUPihvblJlamVjdGVkOiAocDE6IFN0b3JhZ2VFcnJvcikgPT4gVCB8IFByb21pc2U8VD4pOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0ZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgdGhlIGdpdmVuIG9ic2VydmVyLlxuICAgKi9cbiAgcHJpdmF0ZSBfYWRkT2JzZXJ2ZXIob2JzZXJ2ZXI6IE9ic2VydmVyPFVwbG9hZFRhc2tTbmFwc2hvdD4pOiB2b2lkIHtcbiAgICB0aGlzLl9vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7XG4gICAgdGhpcy5fbm90aWZ5T2JzZXJ2ZXIob2JzZXJ2ZXIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIGdpdmVuIG9ic2VydmVyLlxuICAgKi9cbiAgcHJpdmF0ZSBfcmVtb3ZlT2JzZXJ2ZXIob2JzZXJ2ZXI6IE9ic2VydmVyPFVwbG9hZFRhc2tTbmFwc2hvdD4pOiB2b2lkIHtcbiAgICBjb25zdCBpID0gdGhpcy5fb2JzZXJ2ZXJzLmluZGV4T2Yob2JzZXJ2ZXIpO1xuICAgIGlmIChpICE9PSAtMSkge1xuICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnNwbGljZShpLCAxKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9ub3RpZnlPYnNlcnZlcnMoKTogdm9pZCB7XG4gICAgdGhpcy5fZmluaXNoUHJvbWlzZSgpO1xuICAgIGNvbnN0IG9ic2VydmVycyA9IHRoaXMuX29ic2VydmVycy5zbGljZSgpO1xuICAgIG9ic2VydmVycy5mb3JFYWNoKG9ic2VydmVyID0+IHtcbiAgICAgIHRoaXMuX25vdGlmeU9ic2VydmVyKG9ic2VydmVyKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2ZpbmlzaFByb21pc2UoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX3Jlc29sdmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgbGV0IHRyaWdnZXJlZCA9IHRydWU7XG4gICAgICBzd2l0Y2ggKHRhc2tTdGF0ZUZyb21JbnRlcm5hbFRhc2tTdGF0ZSh0aGlzLl9zdGF0ZSkpIHtcbiAgICAgICAgY2FzZSBUYXNrU3RhdGUuU1VDQ0VTUzpcbiAgICAgICAgICBmYnNBc3luYyh0aGlzLl9yZXNvbHZlLmJpbmQobnVsbCwgdGhpcy5zbmFwc2hvdCkpKCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgVGFza1N0YXRlLkNBTkNFTEVEOlxuICAgICAgICBjYXNlIFRhc2tTdGF0ZS5FUlJPUjpcbiAgICAgICAgICBjb25zdCB0b0NhbGwgPSB0aGlzLl9yZWplY3QgYXMgKHAxOiBTdG9yYWdlRXJyb3IpID0+IHZvaWQ7XG4gICAgICAgICAgZmJzQXN5bmModG9DYWxsLmJpbmQobnVsbCwgdGhpcy5fZXJyb3IgYXMgU3RvcmFnZUVycm9yKSkoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0cmlnZ2VyZWQgPSBmYWxzZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGlmICh0cmlnZ2VyZWQpIHtcbiAgICAgICAgdGhpcy5fcmVzb2x2ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fcmVqZWN0ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgX25vdGlmeU9ic2VydmVyKG9ic2VydmVyOiBPYnNlcnZlcjxVcGxvYWRUYXNrU25hcHNob3Q+KTogdm9pZCB7XG4gICAgY29uc3QgZXh0ZXJuYWxTdGF0ZSA9IHRhc2tTdGF0ZUZyb21JbnRlcm5hbFRhc2tTdGF0ZSh0aGlzLl9zdGF0ZSk7XG4gICAgc3dpdGNoIChleHRlcm5hbFN0YXRlKSB7XG4gICAgICBjYXNlIFRhc2tTdGF0ZS5SVU5OSU5HOlxuICAgICAgY2FzZSBUYXNrU3RhdGUuUEFVU0VEOlxuICAgICAgICBpZiAob2JzZXJ2ZXIubmV4dCkge1xuICAgICAgICAgIGZic0FzeW5jKG9ic2VydmVyLm5leHQuYmluZChvYnNlcnZlciwgdGhpcy5zbmFwc2hvdCkpKCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRhc2tTdGF0ZS5TVUNDRVNTOlxuICAgICAgICBpZiAob2JzZXJ2ZXIuY29tcGxldGUpIHtcbiAgICAgICAgICBmYnNBc3luYyhvYnNlcnZlci5jb21wbGV0ZS5iaW5kKG9ic2VydmVyKSkoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVGFza1N0YXRlLkNBTkNFTEVEOlxuICAgICAgY2FzZSBUYXNrU3RhdGUuRVJST1I6XG4gICAgICAgIGlmIChvYnNlcnZlci5lcnJvcikge1xuICAgICAgICAgIGZic0FzeW5jKFxuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IuYmluZChvYnNlcnZlciwgdGhpcy5fZXJyb3IgYXMgU3RvcmFnZUVycm9yKVxuICAgICAgICAgICkoKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIC8vIFRPRE8oYW5keXNvdG8pOiBhc3NlcnQoZmFsc2UpO1xuICAgICAgICBpZiAob2JzZXJ2ZXIuZXJyb3IpIHtcbiAgICAgICAgICBmYnNBc3luYyhcbiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yLmJpbmQob2JzZXJ2ZXIsIHRoaXMuX2Vycm9yIGFzIFN0b3JhZ2VFcnJvcilcbiAgICAgICAgICApKCk7XG4gICAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVzdW1lcyBhIHBhdXNlZCB0YXNrLiBIYXMgbm8gZWZmZWN0IG9uIGEgY3VycmVudGx5IHJ1bm5pbmcgb3IgZmFpbGVkIHRhc2suXG4gICAqIEByZXR1cm5zIFRydWUgaWYgdGhlIG9wZXJhdGlvbiB0b29rIGVmZmVjdCwgZmFsc2UgaWYgaWdub3JlZC5cbiAgICovXG4gIHJlc3VtZSgpOiBib29sZWFuIHtcbiAgICBjb25zdCB2YWxpZCA9XG4gICAgICB0aGlzLl9zdGF0ZSA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0VEIHx8XG4gICAgICB0aGlzLl9zdGF0ZSA9PT0gSW50ZXJuYWxUYXNrU3RhdGUuUEFVU0lORztcbiAgICBpZiAodmFsaWQpIHtcbiAgICAgIHRoaXMuX3RyYW5zaXRpb24oSW50ZXJuYWxUYXNrU3RhdGUuUlVOTklORyk7XG4gICAgfVxuICAgIHJldHVybiB2YWxpZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXVzZXMgYSBjdXJyZW50bHkgcnVubmluZyB0YXNrLiBIYXMgbm8gZWZmZWN0IG9uIGEgcGF1c2VkIG9yIGZhaWxlZCB0YXNrLlxuICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBvcGVyYXRpb24gdG9vayBlZmZlY3QsIGZhbHNlIGlmIGlnbm9yZWQuXG4gICAqL1xuICBwYXVzZSgpOiBib29sZWFuIHtcbiAgICBjb25zdCB2YWxpZCA9IHRoaXMuX3N0YXRlID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5SVU5OSU5HO1xuICAgIGlmICh2YWxpZCkge1xuICAgICAgdGhpcy5fdHJhbnNpdGlvbihJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbGlkO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbmNlbHMgYSBjdXJyZW50bHkgcnVubmluZyBvciBwYXVzZWQgdGFzay4gSGFzIG5vIGVmZmVjdCBvbiBhIGNvbXBsZXRlIG9yXG4gICAqIGZhaWxlZCB0YXNrLlxuICAgKiBAcmV0dXJucyBUcnVlIGlmIHRoZSBvcGVyYXRpb24gdG9vayBlZmZlY3QsIGZhbHNlIGlmIGlnbm9yZWQuXG4gICAqL1xuICBjYW5jZWwoKTogYm9vbGVhbiB7XG4gICAgY29uc3QgdmFsaWQgPVxuICAgICAgdGhpcy5fc3RhdGUgPT09IEludGVybmFsVGFza1N0YXRlLlJVTk5JTkcgfHxcbiAgICAgIHRoaXMuX3N0YXRlID09PSBJbnRlcm5hbFRhc2tTdGF0ZS5QQVVTSU5HO1xuICAgIGlmICh2YWxpZCkge1xuICAgICAgdGhpcy5fdHJhbnNpdGlvbihJbnRlcm5hbFRhc2tTdGF0ZS5DQU5DRUxJTkcpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsaWQ7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgRGVmaW5lcyB0aGUgRmlyZWJhc2UgU3RvcmFnZVJlZmVyZW5jZSBjbGFzcy5cbiAqL1xuXG5pbXBvcnQgeyBQYXNzVGhyb3VnaCwgVHJhbnNmb3JtLCBUcmFuc2Zvcm1PcHRpb25zIH0gZnJvbSAnc3RyZWFtJztcblxuaW1wb3J0IHsgRmJzQmxvYiB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vYmxvYic7XG5pbXBvcnQgeyBMb2NhdGlvbiB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vbG9jYXRpb24nO1xuaW1wb3J0IHsgZ2V0TWFwcGluZ3MgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9uL21ldGFkYXRhJztcbmltcG9ydCB7IGNoaWxkLCBsYXN0Q29tcG9uZW50LCBwYXJlbnQgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9uL3BhdGgnO1xuaW1wb3J0IHtcbiAgZGVsZXRlT2JqZWN0IGFzIHJlcXVlc3RzRGVsZXRlT2JqZWN0LFxuICBnZXRCeXRlcyxcbiAgZ2V0RG93bmxvYWRVcmwgYXMgcmVxdWVzdHNHZXREb3dubG9hZFVybCxcbiAgZ2V0TWV0YWRhdGEgYXMgcmVxdWVzdHNHZXRNZXRhZGF0YSxcbiAgbGlzdCBhcyByZXF1ZXN0c0xpc3QsXG4gIG11bHRpcGFydFVwbG9hZCxcbiAgdXBkYXRlTWV0YWRhdGEgYXMgcmVxdWVzdHNVcGRhdGVNZXRhZGF0YVxufSBmcm9tICcuL2ltcGxlbWVudGF0aW9uL3JlcXVlc3RzJztcbmltcG9ydCB7IExpc3RPcHRpb25zLCBVcGxvYWRSZXN1bHQgfSBmcm9tICcuL3B1YmxpYy10eXBlcyc7XG5pbXBvcnQgeyBkYXRhRnJvbVN0cmluZywgU3RyaW5nRm9ybWF0IH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9zdHJpbmcnO1xuaW1wb3J0IHsgTWV0YWRhdGEgfSBmcm9tICcuL21ldGFkYXRhJztcbmltcG9ydCB7IEZpcmViYXNlU3RvcmFnZUltcGwgfSBmcm9tICcuL3NlcnZpY2UnO1xuaW1wb3J0IHsgTGlzdFJlc3VsdCB9IGZyb20gJy4vbGlzdCc7XG5pbXBvcnQgeyBVcGxvYWRUYXNrIH0gZnJvbSAnLi90YXNrJztcbmltcG9ydCB7IGludmFsaWRSb290T3BlcmF0aW9uLCBub0Rvd25sb2FkVVJMIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9lcnJvcic7XG5pbXBvcnQgeyB2YWxpZGF0ZU51bWJlciB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vdHlwZSc7XG5pbXBvcnQge1xuICBuZXdCbG9iQ29ubmVjdGlvbixcbiAgbmV3Qnl0ZXNDb25uZWN0aW9uLFxuICBuZXdTdHJlYW1Db25uZWN0aW9uLFxuICBuZXdUZXh0Q29ubmVjdGlvblxufSBmcm9tICcuL3BsYXRmb3JtL2Nvbm5lY3Rpb24nO1xuXG4vKipcbiAqIFByb3ZpZGVzIG1ldGhvZHMgdG8gaW50ZXJhY3Qgd2l0aCBhIGJ1Y2tldCBpbiB0aGUgRmlyZWJhc2UgU3RvcmFnZSBzZXJ2aWNlLlxuICogQGludGVybmFsXG4gKiBAcGFyYW0gX2xvY2F0aW9uIC0gQW4gZmJzLmxvY2F0aW9uLCBvciB0aGUgVVJMIGF0XG4gKiAgICAgd2hpY2ggdG8gYmFzZSB0aGlzIG9iamVjdCwgaW4gb25lIG9mIHRoZSBmb2xsb3dpbmcgZm9ybXM6XG4gKiAgICAgICAgIGdzOi8vPGJ1Y2tldD4vPG9iamVjdC1wYXRoPlxuICogICAgICAgICBodHRwW3NdOi8vZmlyZWJhc2VzdG9yYWdlLmdvb2dsZWFwaXMuY29tL1xuICogICAgICAgICAgICAgICAgICAgICA8YXBpLXZlcnNpb24+L2IvPGJ1Y2tldD4vby88b2JqZWN0LXBhdGg+XG4gKiAgICAgQW55IHF1ZXJ5IG9yIGZyYWdtZW50IHN0cmluZ3Mgd2lsbCBiZSBpZ25vcmVkIGluIHRoZSBodHRwW3NdXG4gKiAgICAgZm9ybWF0LiBJZiBubyB2YWx1ZSBpcyBwYXNzZWQsIHRoZSBzdG9yYWdlIG9iamVjdCB3aWxsIHVzZSBhIFVSTCBiYXNlZCBvblxuICogICAgIHRoZSBwcm9qZWN0IElEIG9mIHRoZSBiYXNlIGZpcmViYXNlLkFwcCBpbnN0YW5jZS5cbiAqL1xuZXhwb3J0IGNsYXNzIFJlZmVyZW5jZSB7XG4gIF9sb2NhdGlvbjogTG9jYXRpb247XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSBfc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgICBsb2NhdGlvbjogc3RyaW5nIHwgTG9jYXRpb25cbiAgKSB7XG4gICAgaWYgKGxvY2F0aW9uIGluc3RhbmNlb2YgTG9jYXRpb24pIHtcbiAgICAgIHRoaXMuX2xvY2F0aW9uID0gbG9jYXRpb247XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xvY2F0aW9uID0gTG9jYXRpb24ubWFrZUZyb21VcmwobG9jYXRpb24sIF9zZXJ2aWNlLmhvc3QpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRoZSBVUkwgZm9yIHRoZSBidWNrZXQgYW5kIHBhdGggdGhpcyBvYmplY3QgcmVmZXJlbmNlcyxcbiAgICogICAgIGluIHRoZSBmb3JtIGdzOi8vPGJ1Y2tldD4vPG9iamVjdC1wYXRoPlxuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICdnczovLycgKyB0aGlzLl9sb2NhdGlvbi5idWNrZXQgKyAnLycgKyB0aGlzLl9sb2NhdGlvbi5wYXRoO1xuICB9XG5cbiAgcHJvdGVjdGVkIF9uZXdSZWYoXG4gICAgc2VydmljZTogRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgICBsb2NhdGlvbjogTG9jYXRpb25cbiAgKTogUmVmZXJlbmNlIHtcbiAgICByZXR1cm4gbmV3IFJlZmVyZW5jZShzZXJ2aWNlLCBsb2NhdGlvbik7XG4gIH1cblxuICAvKipcbiAgICogQSByZWZlcmVuY2UgdG8gdGhlIHJvb3Qgb2YgdGhpcyBvYmplY3QncyBidWNrZXQuXG4gICAqL1xuICBnZXQgcm9vdCgpOiBSZWZlcmVuY2Uge1xuICAgIGNvbnN0IGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKHRoaXMuX2xvY2F0aW9uLmJ1Y2tldCwgJycpO1xuICAgIHJldHVybiB0aGlzLl9uZXdSZWYodGhpcy5fc2VydmljZSwgbG9jYXRpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lIG9mIHRoZSBidWNrZXQgY29udGFpbmluZyB0aGlzIHJlZmVyZW5jZSdzIG9iamVjdC5cbiAgICovXG4gIGdldCBidWNrZXQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fbG9jYXRpb24uYnVja2V0O1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBmdWxsIHBhdGggb2YgdGhpcyBvYmplY3QuXG4gICAqL1xuICBnZXQgZnVsbFBhdGgoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fbG9jYXRpb24ucGF0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgc2hvcnQgbmFtZSBvZiB0aGlzIG9iamVjdCwgd2hpY2ggaXMgdGhlIGxhc3QgY29tcG9uZW50IG9mIHRoZSBmdWxsIHBhdGguXG4gICAqIEZvciBleGFtcGxlLCBpZiBmdWxsUGF0aCBpcyAnZnVsbC9wYXRoL2ltYWdlLnBuZycsIG5hbWUgaXMgJ2ltYWdlLnBuZycuXG4gICAqL1xuICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBsYXN0Q29tcG9uZW50KHRoaXMuX2xvY2F0aW9uLnBhdGgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBgU3RvcmFnZVNlcnZpY2VgIGluc3RhbmNlIHRoaXMgYFN0b3JhZ2VSZWZlcmVuY2VgIGlzIGFzc29jaWF0ZWQgd2l0aC5cbiAgICovXG4gIGdldCBzdG9yYWdlKCk6IEZpcmViYXNlU3RvcmFnZUltcGwge1xuICAgIHJldHVybiB0aGlzLl9zZXJ2aWNlO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgYFN0b3JhZ2VSZWZlcmVuY2VgIHBvaW50aW5nIHRvIHRoZSBwYXJlbnQgbG9jYXRpb24gb2YgdGhpcyBgU3RvcmFnZVJlZmVyZW5jZWAsIG9yIG51bGwgaWZcbiAgICogdGhpcyByZWZlcmVuY2UgaXMgdGhlIHJvb3QuXG4gICAqL1xuICBnZXQgcGFyZW50KCk6IFJlZmVyZW5jZSB8IG51bGwge1xuICAgIGNvbnN0IG5ld1BhdGggPSBwYXJlbnQodGhpcy5fbG9jYXRpb24ucGF0aCk7XG4gICAgaWYgKG5ld1BhdGggPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCBsb2NhdGlvbiA9IG5ldyBMb2NhdGlvbih0aGlzLl9sb2NhdGlvbi5idWNrZXQsIG5ld1BhdGgpO1xuICAgIHJldHVybiBuZXcgUmVmZXJlbmNlKHRoaXMuX3NlcnZpY2UsIGxvY2F0aW9uKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVdGlsaXR5IGZ1bmN0aW9uIHRvIHRocm93IGFuIGVycm9yIGluIG1ldGhvZHMgdGhhdCBkbyBub3QgYWNjZXB0IGEgcm9vdCByZWZlcmVuY2UuXG4gICAqL1xuICBfdGhyb3dJZlJvb3QobmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX2xvY2F0aW9uLnBhdGggPT09ICcnKSB7XG4gICAgICB0aHJvdyBpbnZhbGlkUm9vdE9wZXJhdGlvbihuYW1lKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBEb3dubG9hZCB0aGUgYnl0ZXMgYXQgdGhlIG9iamVjdCdzIGxvY2F0aW9uLlxuICogQHJldHVybnMgQSBQcm9taXNlIGNvbnRhaW5pbmcgdGhlIGRvd25sb2FkZWQgYnl0ZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRCeXRlc0ludGVybmFsKFxuICByZWY6IFJlZmVyZW5jZSxcbiAgbWF4RG93bmxvYWRTaXplQnl0ZXM/OiBudW1iZXJcbik6IFByb21pc2U8QXJyYXlCdWZmZXI+IHtcbiAgcmVmLl90aHJvd0lmUm9vdCgnZ2V0Qnl0ZXMnKTtcbiAgY29uc3QgcmVxdWVzdEluZm8gPSBnZXRCeXRlcyhcbiAgICByZWYuc3RvcmFnZSxcbiAgICByZWYuX2xvY2F0aW9uLFxuICAgIG1heERvd25sb2FkU2l6ZUJ5dGVzXG4gICk7XG4gIHJldHVybiByZWYuc3RvcmFnZVxuICAgIC5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8sIG5ld0J5dGVzQ29ubmVjdGlvbilcbiAgICAudGhlbihieXRlcyA9PlxuICAgICAgbWF4RG93bmxvYWRTaXplQnl0ZXMgIT09IHVuZGVmaW5lZFxuICAgICAgICA/IC8vIEdDUyBtYXkgbm90IGhvbm9yIHRoZSBSYW5nZSBoZWFkZXIgZm9yIHNtYWxsIGZpbGVzXG4gICAgICAgICAgKGJ5dGVzIGFzIEFycmF5QnVmZmVyKS5zbGljZSgwLCBtYXhEb3dubG9hZFNpemVCeXRlcylcbiAgICAgICAgOiAoYnl0ZXMgYXMgQXJyYXlCdWZmZXIpXG4gICAgKTtcbn1cblxuLyoqXG4gKiBEb3dubG9hZCB0aGUgYnl0ZXMgYXQgdGhlIG9iamVjdCdzIGxvY2F0aW9uLlxuICogQHJldHVybnMgQSBQcm9taXNlIGNvbnRhaW5pbmcgdGhlIGRvd25sb2FkZWQgYmxvYi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEJsb2JJbnRlcm5hbChcbiAgcmVmOiBSZWZlcmVuY2UsXG4gIG1heERvd25sb2FkU2l6ZUJ5dGVzPzogbnVtYmVyXG4pOiBQcm9taXNlPEJsb2I+IHtcbiAgcmVmLl90aHJvd0lmUm9vdCgnZ2V0QmxvYicpO1xuICBjb25zdCByZXF1ZXN0SW5mbyA9IGdldEJ5dGVzKFxuICAgIHJlZi5zdG9yYWdlLFxuICAgIHJlZi5fbG9jYXRpb24sXG4gICAgbWF4RG93bmxvYWRTaXplQnl0ZXNcbiAgKTtcbiAgcmV0dXJuIHJlZi5zdG9yYWdlXG4gICAgLm1ha2VSZXF1ZXN0V2l0aFRva2VucyhyZXF1ZXN0SW5mbywgbmV3QmxvYkNvbm5lY3Rpb24pXG4gICAgLnRoZW4oYmxvYiA9PlxuICAgICAgbWF4RG93bmxvYWRTaXplQnl0ZXMgIT09IHVuZGVmaW5lZFxuICAgICAgICA/IC8vIEdDUyBtYXkgbm90IGhvbm9yIHRoZSBSYW5nZSBoZWFkZXIgZm9yIHNtYWxsIGZpbGVzXG4gICAgICAgICAgKGJsb2IgYXMgQmxvYikuc2xpY2UoMCwgbWF4RG93bmxvYWRTaXplQnl0ZXMpXG4gICAgICAgIDogKGJsb2IgYXMgQmxvYilcbiAgICApO1xufVxuXG4vKiogU3RyZWFtIHRoZSBieXRlcyBhdCB0aGUgb2JqZWN0J3MgbG9jYXRpb24uICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RyZWFtSW50ZXJuYWwoXG4gIHJlZjogUmVmZXJlbmNlLFxuICBtYXhEb3dubG9hZFNpemVCeXRlcz86IG51bWJlclxuKTogTm9kZUpTLlJlYWRhYmxlU3RyZWFtIHtcbiAgcmVmLl90aHJvd0lmUm9vdCgnZ2V0U3RyZWFtJyk7XG4gIGNvbnN0IHJlcXVlc3RJbmZvID0gZ2V0Qnl0ZXMoXG4gICAgcmVmLnN0b3JhZ2UsXG4gICAgcmVmLl9sb2NhdGlvbixcbiAgICBtYXhEb3dubG9hZFNpemVCeXRlc1xuICApO1xuXG4gIC8qKiBBIHRyYW5zZm9ybWVyIHRoYXQgcGFzc2VzIHRocm91Z2ggdGhlIGZpcnN0IG4gYnl0ZXMuICovXG4gIGNvbnN0IG5ld01heFNpemVUcmFuc2Zvcm06IChuOiBudW1iZXIpID0+IFRyYW5zZm9ybU9wdGlvbnMgPSBuID0+IHtcbiAgICBsZXQgbWlzc2luZ0J5dGVzID0gbjtcbiAgICByZXR1cm4ge1xuICAgICAgdHJhbnNmb3JtKGNodW5rLCBlbmNvZGluZywgY2FsbGJhY2spIHtcbiAgICAgICAgLy8gR0NTIG1heSBub3QgaG9ub3IgdGhlIFJhbmdlIGhlYWRlciBmb3Igc21hbGwgZmlsZXNcbiAgICAgICAgaWYgKGNodW5rLmxlbmd0aCA8IG1pc3NpbmdCeXRlcykge1xuICAgICAgICAgIHRoaXMucHVzaChjaHVuayk7XG4gICAgICAgICAgbWlzc2luZ0J5dGVzIC09IGNodW5rLmxlbmd0aDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnB1c2goY2h1bmsuc2xpY2UoMCwgbWlzc2luZ0J5dGVzKSk7XG4gICAgICAgICAgdGhpcy5lbWl0KCdlbmQnKTtcbiAgICAgICAgfVxuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgfVxuICAgIH0gYXMgVHJhbnNmb3JtT3B0aW9ucztcbiAgfTtcblxuICBjb25zdCByZXN1bHQgPVxuICAgIG1heERvd25sb2FkU2l6ZUJ5dGVzICE9PSB1bmRlZmluZWRcbiAgICAgID8gbmV3IFRyYW5zZm9ybShuZXdNYXhTaXplVHJhbnNmb3JtKG1heERvd25sb2FkU2l6ZUJ5dGVzKSlcbiAgICAgIDogbmV3IFBhc3NUaHJvdWdoKCk7XG5cbiAgcmVmLnN0b3JhZ2VcbiAgICAubWFrZVJlcXVlc3RXaXRoVG9rZW5zKHJlcXVlc3RJbmZvLCBuZXdTdHJlYW1Db25uZWN0aW9uKVxuICAgIC50aGVuKHN0cmVhbSA9PiAoc3RyZWFtIGFzIE5vZGVKUy5SZWFkYWJsZVN0cmVhbSkucGlwZShyZXN1bHQpKVxuICAgIC5jYXRjaChlID0+IHJlc3VsdC5kZXN0cm95KGUpKTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBVcGxvYWRzIGRhdGEgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cbiAqIFRoZSB1cGxvYWQgaXMgbm90IHJlc3VtYWJsZS5cbiAqXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBkYXRhIHNob3VsZCBiZSB1cGxvYWRlZC5cbiAqIEBwYXJhbSBkYXRhIC0gVGhlIGRhdGEgdG8gdXBsb2FkLlxuICogQHBhcmFtIG1ldGFkYXRhIC0gTWV0YWRhdGEgZm9yIHRoZSBuZXdseSB1cGxvYWRlZCBkYXRhLlxuICogQHJldHVybnMgQSBQcm9taXNlIGNvbnRhaW5pbmcgYW4gVXBsb2FkUmVzdWx0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1cGxvYWRCeXRlcyhcbiAgcmVmOiBSZWZlcmVuY2UsXG4gIGRhdGE6IEJsb2IgfCBVaW50OEFycmF5IHwgQXJyYXlCdWZmZXIsXG4gIG1ldGFkYXRhPzogTWV0YWRhdGFcbik6IFByb21pc2U8VXBsb2FkUmVzdWx0PiB7XG4gIHJlZi5fdGhyb3dJZlJvb3QoJ3VwbG9hZEJ5dGVzJyk7XG4gIGNvbnN0IHJlcXVlc3RJbmZvID0gbXVsdGlwYXJ0VXBsb2FkKFxuICAgIHJlZi5zdG9yYWdlLFxuICAgIHJlZi5fbG9jYXRpb24sXG4gICAgZ2V0TWFwcGluZ3MoKSxcbiAgICBuZXcgRmJzQmxvYihkYXRhLCB0cnVlKSxcbiAgICBtZXRhZGF0YVxuICApO1xuICByZXR1cm4gcmVmLnN0b3JhZ2VcbiAgICAubWFrZVJlcXVlc3RXaXRoVG9rZW5zKHJlcXVlc3RJbmZvLCBuZXdUZXh0Q29ubmVjdGlvbilcbiAgICAudGhlbihmaW5hbE1ldGFkYXRhID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1ldGFkYXRhOiBmaW5hbE1ldGFkYXRhLFxuICAgICAgICByZWZcbiAgICAgIH07XG4gICAgfSk7XG59XG5cbi8qKlxuICogVXBsb2FkcyBkYXRhIHRvIHRoaXMgb2JqZWN0J3MgbG9jYXRpb24uXG4gKiBUaGUgdXBsb2FkIGNhbiBiZSBwYXVzZWQgYW5kIHJlc3VtZWQsIGFuZCBleHBvc2VzIHByb2dyZXNzIHVwZGF0ZXMuXG4gKiBAcHVibGljXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBkYXRhIHNob3VsZCBiZSB1cGxvYWRlZC5cbiAqIEBwYXJhbSBkYXRhIC0gVGhlIGRhdGEgdG8gdXBsb2FkLlxuICogQHBhcmFtIG1ldGFkYXRhIC0gTWV0YWRhdGEgZm9yIHRoZSBuZXdseSB1cGxvYWRlZCBkYXRhLlxuICogQHJldHVybnMgQW4gVXBsb2FkVGFza1xuICovXG5leHBvcnQgZnVuY3Rpb24gdXBsb2FkQnl0ZXNSZXN1bWFibGUoXG4gIHJlZjogUmVmZXJlbmNlLFxuICBkYXRhOiBCbG9iIHwgVWludDhBcnJheSB8IEFycmF5QnVmZmVyLFxuICBtZXRhZGF0YT86IE1ldGFkYXRhXG4pOiBVcGxvYWRUYXNrIHtcbiAgcmVmLl90aHJvd0lmUm9vdCgndXBsb2FkQnl0ZXNSZXN1bWFibGUnKTtcbiAgcmV0dXJuIG5ldyBVcGxvYWRUYXNrKHJlZiwgbmV3IEZic0Jsb2IoZGF0YSksIG1ldGFkYXRhKTtcbn1cblxuLyoqXG4gKiBVcGxvYWRzIGEgc3RyaW5nIHRvIHRoaXMgb2JqZWN0J3MgbG9jYXRpb24uXG4gKiBUaGUgdXBsb2FkIGlzIG5vdCByZXN1bWFibGUuXG4gKiBAcHVibGljXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBzdHJpbmcgc2hvdWxkIGJlIHVwbG9hZGVkLlxuICogQHBhcmFtIHZhbHVlIC0gVGhlIHN0cmluZyB0byB1cGxvYWQuXG4gKiBAcGFyYW0gZm9ybWF0IC0gVGhlIGZvcm1hdCBvZiB0aGUgc3RyaW5nIHRvIHVwbG9hZC5cbiAqIEBwYXJhbSBtZXRhZGF0YSAtIE1ldGFkYXRhIGZvciB0aGUgbmV3bHkgdXBsb2FkZWQgc3RyaW5nLlxuICogQHJldHVybnMgQSBQcm9taXNlIGNvbnRhaW5pbmcgYW4gVXBsb2FkUmVzdWx0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1cGxvYWRTdHJpbmcoXG4gIHJlZjogUmVmZXJlbmNlLFxuICB2YWx1ZTogc3RyaW5nLFxuICBmb3JtYXQ6IFN0cmluZ0Zvcm1hdCA9IFN0cmluZ0Zvcm1hdC5SQVcsXG4gIG1ldGFkYXRhPzogTWV0YWRhdGFcbik6IFByb21pc2U8VXBsb2FkUmVzdWx0PiB7XG4gIHJlZi5fdGhyb3dJZlJvb3QoJ3VwbG9hZFN0cmluZycpO1xuICBjb25zdCBkYXRhID0gZGF0YUZyb21TdHJpbmcoZm9ybWF0LCB2YWx1ZSk7XG4gIGNvbnN0IG1ldGFkYXRhQ2xvbmUgPSB7IC4uLm1ldGFkYXRhIH0gYXMgTWV0YWRhdGE7XG4gIGlmIChtZXRhZGF0YUNsb25lWydjb250ZW50VHlwZSddID09IG51bGwgJiYgZGF0YS5jb250ZW50VHlwZSAhPSBudWxsKSB7XG4gICAgbWV0YWRhdGFDbG9uZVsnY29udGVudFR5cGUnXSA9IGRhdGEuY29udGVudFR5cGUhO1xuICB9XG4gIHJldHVybiB1cGxvYWRCeXRlcyhyZWYsIGRhdGEuZGF0YSwgbWV0YWRhdGFDbG9uZSk7XG59XG5cbi8qKlxuICogTGlzdCBhbGwgaXRlbXMgKGZpbGVzKSBhbmQgcHJlZml4ZXMgKGZvbGRlcnMpIHVuZGVyIHRoaXMgc3RvcmFnZSByZWZlcmVuY2UuXG4gKlxuICogVGhpcyBpcyBhIGhlbHBlciBtZXRob2QgZm9yIGNhbGxpbmcgbGlzdCgpIHJlcGVhdGVkbHkgdW50aWwgdGhlcmUgYXJlXG4gKiBubyBtb3JlIHJlc3VsdHMuIFRoZSBkZWZhdWx0IHBhZ2luYXRpb24gc2l6ZSBpcyAxMDAwLlxuICpcbiAqIE5vdGU6IFRoZSByZXN1bHRzIG1heSBub3QgYmUgY29uc2lzdGVudCBpZiBvYmplY3RzIGFyZSBjaGFuZ2VkIHdoaWxlIHRoaXNcbiAqIG9wZXJhdGlvbiBpcyBydW5uaW5nLlxuICpcbiAqIFdhcm5pbmc6IGxpc3RBbGwgbWF5IHBvdGVudGlhbGx5IGNvbnN1bWUgdG9vIG1hbnkgcmVzb3VyY2VzIGlmIHRoZXJlIGFyZVxuICogdG9vIG1hbnkgcmVzdWx0cy5cbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHRvIGdldCBsaXN0IGZyb20uXG4gKlxuICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCBhbGwgdGhlIGl0ZW1zIGFuZCBwcmVmaXhlcyB1bmRlclxuICogICAgICB0aGUgY3VycmVudCBzdG9yYWdlIHJlZmVyZW5jZS4gYHByZWZpeGVzYCBjb250YWlucyByZWZlcmVuY2VzIHRvXG4gKiAgICAgIHN1Yi1kaXJlY3RvcmllcyBhbmQgYGl0ZW1zYCBjb250YWlucyByZWZlcmVuY2VzIHRvIG9iamVjdHMgaW4gdGhpc1xuICogICAgICBmb2xkZXIuIGBuZXh0UGFnZVRva2VuYCBpcyBuZXZlciByZXR1cm5lZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxpc3RBbGwocmVmOiBSZWZlcmVuY2UpOiBQcm9taXNlPExpc3RSZXN1bHQ+IHtcbiAgY29uc3QgYWNjdW11bGF0b3I6IExpc3RSZXN1bHQgPSB7XG4gICAgcHJlZml4ZXM6IFtdLFxuICAgIGl0ZW1zOiBbXVxuICB9O1xuICByZXR1cm4gbGlzdEFsbEhlbHBlcihyZWYsIGFjY3VtdWxhdG9yKS50aGVuKCgpID0+IGFjY3VtdWxhdG9yKTtcbn1cblxuLyoqXG4gKiBTZXBhcmF0ZWQgZnJvbSBsaXN0QWxsIGJlY2F1c2UgYXN5bmMgZnVuY3Rpb25zIGNhbid0IHVzZSBcImFyZ3VtZW50c1wiLlxuICogQHBhcmFtIHJlZlxuICogQHBhcmFtIGFjY3VtdWxhdG9yXG4gKiBAcGFyYW0gcGFnZVRva2VuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGxpc3RBbGxIZWxwZXIoXG4gIHJlZjogUmVmZXJlbmNlLFxuICBhY2N1bXVsYXRvcjogTGlzdFJlc3VsdCxcbiAgcGFnZVRva2VuPzogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3Qgb3B0OiBMaXN0T3B0aW9ucyA9IHtcbiAgICAvLyBtYXhSZXN1bHRzIGlzIDEwMDAgYnkgZGVmYXVsdC5cbiAgICBwYWdlVG9rZW5cbiAgfTtcbiAgY29uc3QgbmV4dFBhZ2UgPSBhd2FpdCBsaXN0KHJlZiwgb3B0KTtcbiAgYWNjdW11bGF0b3IucHJlZml4ZXMucHVzaCguLi5uZXh0UGFnZS5wcmVmaXhlcyk7XG4gIGFjY3VtdWxhdG9yLml0ZW1zLnB1c2goLi4ubmV4dFBhZ2UuaXRlbXMpO1xuICBpZiAobmV4dFBhZ2UubmV4dFBhZ2VUb2tlbiAhPSBudWxsKSB7XG4gICAgYXdhaXQgbGlzdEFsbEhlbHBlcihyZWYsIGFjY3VtdWxhdG9yLCBuZXh0UGFnZS5uZXh0UGFnZVRva2VuKTtcbiAgfVxufVxuXG4vKipcbiAqIExpc3QgaXRlbXMgKGZpbGVzKSBhbmQgcHJlZml4ZXMgKGZvbGRlcnMpIHVuZGVyIHRoaXMgc3RvcmFnZSByZWZlcmVuY2UuXG4gKlxuICogTGlzdCBBUEkgaXMgb25seSBhdmFpbGFibGUgZm9yIEZpcmViYXNlIFJ1bGVzIFZlcnNpb24gMi5cbiAqXG4gKiBHQ1MgaXMgYSBrZXktYmxvYiBzdG9yZS4gRmlyZWJhc2UgU3RvcmFnZSBpbXBvc2VzIHRoZSBzZW1hbnRpYyBvZiAnLydcbiAqIGRlbGltaXRlZCBmb2xkZXIgc3RydWN0dXJlLlxuICogUmVmZXIgdG8gR0NTJ3MgTGlzdCBBUEkgaWYgeW91IHdhbnQgdG8gbGVhcm4gbW9yZS5cbiAqXG4gKiBUbyBhZGhlcmUgdG8gRmlyZWJhc2UgUnVsZXMncyBTZW1hbnRpY3MsIEZpcmViYXNlIFN0b3JhZ2UgZG9lcyBub3RcbiAqIHN1cHBvcnQgb2JqZWN0cyB3aG9zZSBwYXRocyBlbmQgd2l0aCBcIi9cIiBvciBjb250YWluIHR3byBjb25zZWN1dGl2ZVxuICogXCIvXCJzLiBGaXJlYmFzZSBTdG9yYWdlIExpc3QgQVBJIHdpbGwgZmlsdGVyIHRoZXNlIHVuc3VwcG9ydGVkIG9iamVjdHMuXG4gKiBsaXN0KCkgbWF5IGZhaWwgaWYgdGhlcmUgYXJlIHRvbyBtYW55IHVuc3VwcG9ydGVkIG9iamVjdHMgaW4gdGhlIGJ1Y2tldC5cbiAqIEBwdWJsaWNcbiAqXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB0byBnZXQgbGlzdCBmcm9tLlxuICogQHBhcmFtIG9wdGlvbnMgLSBTZWUgTGlzdE9wdGlvbnMgZm9yIGRldGFpbHMuXG4gKiBAcmV0dXJucyBBIFByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMuXG4gKiAgICAgIGBwcmVmaXhlc2AgY29udGFpbnMgcmVmZXJlbmNlcyB0byBzdWItZm9sZGVycyBhbmQgYGl0ZW1zYFxuICogICAgICBjb250YWlucyByZWZlcmVuY2VzIHRvIG9iamVjdHMgaW4gdGhpcyBmb2xkZXIuIGBuZXh0UGFnZVRva2VuYFxuICogICAgICBjYW4gYmUgdXNlZCB0byBnZXQgdGhlIHJlc3Qgb2YgdGhlIHJlc3VsdHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0KFxuICByZWY6IFJlZmVyZW5jZSxcbiAgb3B0aW9ucz86IExpc3RPcHRpb25zIHwgbnVsbFxuKTogUHJvbWlzZTxMaXN0UmVzdWx0PiB7XG4gIGlmIChvcHRpb25zICE9IG51bGwpIHtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnMubWF4UmVzdWx0cyA9PT0gJ251bWJlcicpIHtcbiAgICAgIHZhbGlkYXRlTnVtYmVyKFxuICAgICAgICAnb3B0aW9ucy5tYXhSZXN1bHRzJyxcbiAgICAgICAgLyogbWluVmFsdWU9ICovIDEsXG4gICAgICAgIC8qIG1heFZhbHVlPSAqLyAxMDAwLFxuICAgICAgICBvcHRpb25zLm1heFJlc3VsdHNcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIGNvbnN0IG9wID0gb3B0aW9ucyB8fCB7fTtcbiAgY29uc3QgcmVxdWVzdEluZm8gPSByZXF1ZXN0c0xpc3QoXG4gICAgcmVmLnN0b3JhZ2UsXG4gICAgcmVmLl9sb2NhdGlvbixcbiAgICAvKmRlbGltaXRlcj0gKi8gJy8nLFxuICAgIG9wLnBhZ2VUb2tlbixcbiAgICBvcC5tYXhSZXN1bHRzXG4gICk7XG4gIHJldHVybiByZWYuc3RvcmFnZS5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8sIG5ld1RleHRDb25uZWN0aW9uKTtcbn1cblxuLyoqXG4gKiBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggdGhlIG1ldGFkYXRhIGZvciB0aGlzIG9iamVjdC4gSWYgdGhpc1xuICogb2JqZWN0IGRvZXNuJ3QgZXhpc3Qgb3IgbWV0YWRhdGEgY2Fubm90IGJlIHJldHJlaXZlZCwgdGhlIHByb21pc2UgaXNcbiAqIHJlamVjdGVkLlxuICogQHB1YmxpY1xuICogQHBhcmFtIHJlZiAtIFN0b3JhZ2VSZWZlcmVuY2UgdG8gZ2V0IG1ldGFkYXRhIGZyb20uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNZXRhZGF0YShyZWY6IFJlZmVyZW5jZSk6IFByb21pc2U8TWV0YWRhdGE+IHtcbiAgcmVmLl90aHJvd0lmUm9vdCgnZ2V0TWV0YWRhdGEnKTtcbiAgY29uc3QgcmVxdWVzdEluZm8gPSByZXF1ZXN0c0dldE1ldGFkYXRhKFxuICAgIHJlZi5zdG9yYWdlLFxuICAgIHJlZi5fbG9jYXRpb24sXG4gICAgZ2V0TWFwcGluZ3MoKVxuICApO1xuICByZXR1cm4gcmVmLnN0b3JhZ2UubWFrZVJlcXVlc3RXaXRoVG9rZW5zKHJlcXVlc3RJbmZvLCBuZXdUZXh0Q29ubmVjdGlvbik7XG59XG5cbi8qKlxuICogVXBkYXRlcyB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LlxuICogQHB1YmxpY1xuICogQHBhcmFtIHJlZiAtIFN0b3JhZ2VSZWZlcmVuY2UgdG8gdXBkYXRlIG1ldGFkYXRhIGZvci5cbiAqIEBwYXJhbSBtZXRhZGF0YSAtIFRoZSBuZXcgbWV0YWRhdGEgZm9yIHRoZSBvYmplY3QuXG4gKiAgICAgT25seSB2YWx1ZXMgdGhhdCBoYXZlIGJlZW4gZXhwbGljaXRseSBzZXQgd2lsbCBiZSBjaGFuZ2VkLiBFeHBsaWNpdGx5XG4gKiAgICAgc2V0dGluZyBhIHZhbHVlIHRvIG51bGwgd2lsbCByZW1vdmUgdGhlIG1ldGFkYXRhLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlc1xuICogICAgIHdpdGggdGhlIG5ldyBtZXRhZGF0YSBmb3IgdGhpcyBvYmplY3QuXG4gKiAgICAgU2VlIGBmaXJlYmFzZVN0b3JhZ2UuUmVmZXJlbmNlLnByb3RvdHlwZS5nZXRNZXRhZGF0YWBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1ldGFkYXRhKFxuICByZWY6IFJlZmVyZW5jZSxcbiAgbWV0YWRhdGE6IFBhcnRpYWw8TWV0YWRhdGE+XG4pOiBQcm9taXNlPE1ldGFkYXRhPiB7XG4gIHJlZi5fdGhyb3dJZlJvb3QoJ3VwZGF0ZU1ldGFkYXRhJyk7XG4gIGNvbnN0IHJlcXVlc3RJbmZvID0gcmVxdWVzdHNVcGRhdGVNZXRhZGF0YShcbiAgICByZWYuc3RvcmFnZSxcbiAgICByZWYuX2xvY2F0aW9uLFxuICAgIG1ldGFkYXRhLFxuICAgIGdldE1hcHBpbmdzKClcbiAgKTtcbiAgcmV0dXJuIHJlZi5zdG9yYWdlLm1ha2VSZXF1ZXN0V2l0aFRva2VucyhyZXF1ZXN0SW5mbywgbmV3VGV4dENvbm5lY3Rpb24pO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGRvd25sb2FkIFVSTCBmb3IgdGhlIGdpdmVuIFJlZmVyZW5jZS5cbiAqIEBwdWJsaWNcbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgZG93bmxvYWRcbiAqICAgICBVUkwgZm9yIHRoaXMgb2JqZWN0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RG93bmxvYWRVUkwocmVmOiBSZWZlcmVuY2UpOiBQcm9taXNlPHN0cmluZz4ge1xuICByZWYuX3Rocm93SWZSb290KCdnZXREb3dubG9hZFVSTCcpO1xuICBjb25zdCByZXF1ZXN0SW5mbyA9IHJlcXVlc3RzR2V0RG93bmxvYWRVcmwoXG4gICAgcmVmLnN0b3JhZ2UsXG4gICAgcmVmLl9sb2NhdGlvbixcbiAgICBnZXRNYXBwaW5ncygpXG4gICk7XG4gIHJldHVybiByZWYuc3RvcmFnZVxuICAgIC5tYWtlUmVxdWVzdFdpdGhUb2tlbnMocmVxdWVzdEluZm8sIG5ld1RleHRDb25uZWN0aW9uKVxuICAgIC50aGVuKHVybCA9PiB7XG4gICAgICBpZiAodXJsID09PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5vRG93bmxvYWRVUkwoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSk7XG59XG5cbi8qKlxuICogRGVsZXRlcyB0aGUgb2JqZWN0IGF0IHRoaXMgbG9jYXRpb24uXG4gKiBAcHVibGljXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSBmb3Igb2JqZWN0IHRvIGRlbGV0ZS5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgaWYgdGhlIGRlbGV0aW9uIHN1Y2NlZWRzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlT2JqZWN0KHJlZjogUmVmZXJlbmNlKTogUHJvbWlzZTx2b2lkPiB7XG4gIHJlZi5fdGhyb3dJZlJvb3QoJ2RlbGV0ZU9iamVjdCcpO1xuICBjb25zdCByZXF1ZXN0SW5mbyA9IHJlcXVlc3RzRGVsZXRlT2JqZWN0KHJlZi5zdG9yYWdlLCByZWYuX2xvY2F0aW9uKTtcbiAgcmV0dXJuIHJlZi5zdG9yYWdlLm1ha2VSZXF1ZXN0V2l0aFRva2VucyhyZXF1ZXN0SW5mbywgbmV3VGV4dENvbm5lY3Rpb24pO1xufVxuXG4vKipcbiAqIFJldHVybnMgcmVmZXJlbmNlIGZvciBvYmplY3Qgb2J0YWluZWQgYnkgYXBwZW5kaW5nIGBjaGlsZFBhdGhgIHRvIGByZWZgLlxuICpcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHRvIGdldCBjaGlsZCBvZi5cbiAqIEBwYXJhbSBjaGlsZFBhdGggLSBDaGlsZCBwYXRoIGZyb20gcHJvdmlkZWQgcmVmLlxuICogQHJldHVybnMgQSByZWZlcmVuY2UgdG8gdGhlIG9iamVjdCBvYnRhaW5lZCBieVxuICogYXBwZW5kaW5nIGNoaWxkUGF0aCwgcmVtb3ZpbmcgYW55IGR1cGxpY2F0ZSwgYmVnaW5uaW5nLCBvciB0cmFpbGluZ1xuICogc2xhc2hlcy5cbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBfZ2V0Q2hpbGQocmVmOiBSZWZlcmVuY2UsIGNoaWxkUGF0aDogc3RyaW5nKTogUmVmZXJlbmNlIHtcbiAgY29uc3QgbmV3UGF0aCA9IGNoaWxkKHJlZi5fbG9jYXRpb24ucGF0aCwgY2hpbGRQYXRoKTtcbiAgY29uc3QgbG9jYXRpb24gPSBuZXcgTG9jYXRpb24ocmVmLl9sb2NhdGlvbi5idWNrZXQsIG5ld1BhdGgpO1xuICByZXR1cm4gbmV3IFJlZmVyZW5jZShyZWYuc3RvcmFnZSwgbG9jYXRpb24pO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IExvY2F0aW9uIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9sb2NhdGlvbic7XG5pbXBvcnQgeyBGYWlsUmVxdWVzdCB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vZmFpbHJlcXVlc3QnO1xuaW1wb3J0IHsgUmVxdWVzdCwgbWFrZVJlcXVlc3QgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9uL3JlcXVlc3QnO1xuaW1wb3J0IHsgUmVxdWVzdEluZm8gfSBmcm9tICcuL2ltcGxlbWVudGF0aW9uL3JlcXVlc3RpbmZvJztcbmltcG9ydCB7IFJlZmVyZW5jZSwgX2dldENoaWxkIH0gZnJvbSAnLi9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tICdAZmlyZWJhc2UvY29tcG9uZW50JztcbmltcG9ydCB7IEZpcmViYXNlQXV0aEludGVybmFsTmFtZSB9IGZyb20gJ0BmaXJlYmFzZS9hdXRoLWludGVyb3AtdHlwZXMnO1xuaW1wb3J0IHsgQXBwQ2hlY2tJbnRlcm5hbENvbXBvbmVudE5hbWUgfSBmcm9tICdAZmlyZWJhc2UvYXBwLWNoZWNrLWludGVyb3AtdHlwZXMnO1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1leHRyYW5lb3VzLWRlcGVuZGVuY2llc1xuaW1wb3J0IHsgRmlyZWJhc2VBcHAsIEZpcmViYXNlT3B0aW9ucyB9IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuaW1wb3J0IHtcbiAgQ09ORklHX1NUT1JBR0VfQlVDS0VUX0tFWSxcbiAgREVGQVVMVF9IT1NULFxuICBERUZBVUxUX01BWF9PUEVSQVRJT05fUkVUUllfVElNRSxcbiAgREVGQVVMVF9NQVhfVVBMT0FEX1JFVFJZX1RJTUVcbn0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9jb25zdGFudHMnO1xuaW1wb3J0IHtcbiAgaW52YWxpZEFyZ3VtZW50LFxuICBhcHBEZWxldGVkLFxuICBub0RlZmF1bHRCdWNrZXRcbn0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9lcnJvcic7XG5pbXBvcnQgeyB2YWxpZGF0ZU51bWJlciB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vdHlwZSc7XG5pbXBvcnQgeyBGaXJlYmFzZVN0b3JhZ2UgfSBmcm9tICcuL3B1YmxpYy10eXBlcyc7XG5pbXBvcnQgeyBjcmVhdGVNb2NrVXNlclRva2VuLCBFbXVsYXRvck1vY2tUb2tlbk9wdGlvbnMgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBDb25uZWN0aW9uLCBDb25uZWN0aW9uVHlwZSB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vY29ubmVjdGlvbic7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1VybChwYXRoPzogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiAvXltBLVphLXpdKzpcXC9cXC8vLnRlc3QocGF0aCBhcyBzdHJpbmcpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBmaXJlYmFzZVN0b3JhZ2UuUmVmZXJlbmNlIGZvciB0aGUgZ2l2ZW4gdXJsLlxuICovXG5mdW5jdGlvbiByZWZGcm9tVVJMKHNlcnZpY2U6IEZpcmViYXNlU3RvcmFnZUltcGwsIHVybDogc3RyaW5nKTogUmVmZXJlbmNlIHtcbiAgcmV0dXJuIG5ldyBSZWZlcmVuY2Uoc2VydmljZSwgdXJsKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgZmlyZWJhc2VTdG9yYWdlLlJlZmVyZW5jZSBmb3IgdGhlIGdpdmVuIHBhdGggaW4gdGhlIGRlZmF1bHRcbiAqIGJ1Y2tldC5cbiAqL1xuZnVuY3Rpb24gcmVmRnJvbVBhdGgoXG4gIHJlZjogRmlyZWJhc2VTdG9yYWdlSW1wbCB8IFJlZmVyZW5jZSxcbiAgcGF0aD86IHN0cmluZ1xuKTogUmVmZXJlbmNlIHtcbiAgaWYgKHJlZiBpbnN0YW5jZW9mIEZpcmViYXNlU3RvcmFnZUltcGwpIHtcbiAgICBjb25zdCBzZXJ2aWNlID0gcmVmO1xuICAgIGlmIChzZXJ2aWNlLl9idWNrZXQgPT0gbnVsbCkge1xuICAgICAgdGhyb3cgbm9EZWZhdWx0QnVja2V0KCk7XG4gICAgfVxuICAgIGNvbnN0IHJlZmVyZW5jZSA9IG5ldyBSZWZlcmVuY2Uoc2VydmljZSwgc2VydmljZS5fYnVja2V0ISk7XG4gICAgaWYgKHBhdGggIT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHJlZkZyb21QYXRoKHJlZmVyZW5jZSwgcGF0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiByZWZlcmVuY2U7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIHJlZiBpcyBhIFJlZmVyZW5jZVxuICAgIGlmIChwYXRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiBfZ2V0Q2hpbGQocmVmLCBwYXRoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlZjtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgc3RvcmFnZSBSZWZlcmVuY2UgZm9yIHRoZSBnaXZlbiB1cmwuXG4gKiBAcGFyYW0gc3RvcmFnZSAtIGBTdG9yYWdlYCBpbnN0YW5jZS5cbiAqIEBwYXJhbSB1cmwgLSBVUkwuIElmIGVtcHR5LCByZXR1cm5zIHJvb3QgcmVmZXJlbmNlLlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gcmVmKHN0b3JhZ2U6IEZpcmViYXNlU3RvcmFnZUltcGwsIHVybD86IHN0cmluZyk6IFJlZmVyZW5jZTtcbi8qKlxuICogUmV0dXJucyBhIHN0b3JhZ2UgUmVmZXJlbmNlIGZvciB0aGUgZ2l2ZW4gcGF0aCBpbiB0aGVcbiAqIGRlZmF1bHQgYnVja2V0LlxuICogQHBhcmFtIHN0b3JhZ2VPclJlZiAtIGBTdG9yYWdlYCBzZXJ2aWNlIG9yIHN0b3JhZ2UgYFJlZmVyZW5jZWAuXG4gKiBAcGFyYW0gcGF0aE9yVXJsU3RvcmFnZSAtIHBhdGguIElmIGVtcHR5LCByZXR1cm5zIHJvb3QgcmVmZXJlbmNlIChpZiBTdG9yYWdlXG4gKiBpbnN0YW5jZSBwcm92aWRlZCkgb3IgcmV0dXJucyBzYW1lIHJlZmVyZW5jZSAoaWYgUmVmZXJlbmNlIHByb3ZpZGVkKS5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZihcbiAgc3RvcmFnZU9yUmVmOiBGaXJlYmFzZVN0b3JhZ2VJbXBsIHwgUmVmZXJlbmNlLFxuICBwYXRoPzogc3RyaW5nXG4pOiBSZWZlcmVuY2U7XG5leHBvcnQgZnVuY3Rpb24gcmVmKFxuICBzZXJ2aWNlT3JSZWY6IEZpcmViYXNlU3RvcmFnZUltcGwgfCBSZWZlcmVuY2UsXG4gIHBhdGhPclVybD86IHN0cmluZ1xuKTogUmVmZXJlbmNlIHwgbnVsbCB7XG4gIGlmIChwYXRoT3JVcmwgJiYgaXNVcmwocGF0aE9yVXJsKSkge1xuICAgIGlmIChzZXJ2aWNlT3JSZWYgaW5zdGFuY2VvZiBGaXJlYmFzZVN0b3JhZ2VJbXBsKSB7XG4gICAgICByZXR1cm4gcmVmRnJvbVVSTChzZXJ2aWNlT3JSZWYsIHBhdGhPclVybCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IGludmFsaWRBcmd1bWVudChcbiAgICAgICAgJ1RvIHVzZSByZWYoc2VydmljZSwgdXJsKSwgdGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBTdG9yYWdlIGluc3RhbmNlLidcbiAgICAgICk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiByZWZGcm9tUGF0aChzZXJ2aWNlT3JSZWYsIHBhdGhPclVybCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZXh0cmFjdEJ1Y2tldChcbiAgaG9zdDogc3RyaW5nLFxuICBjb25maWc/OiBGaXJlYmFzZU9wdGlvbnNcbik6IExvY2F0aW9uIHwgbnVsbCB7XG4gIGNvbnN0IGJ1Y2tldFN0cmluZyA9IGNvbmZpZz8uW0NPTkZJR19TVE9SQUdFX0JVQ0tFVF9LRVldO1xuICBpZiAoYnVja2V0U3RyaW5nID09IG51bGwpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4gTG9jYXRpb24ubWFrZUZyb21CdWNrZXRTcGVjKGJ1Y2tldFN0cmluZywgaG9zdCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb25uZWN0U3RvcmFnZUVtdWxhdG9yKFxuICBzdG9yYWdlOiBGaXJlYmFzZVN0b3JhZ2VJbXBsLFxuICBob3N0OiBzdHJpbmcsXG4gIHBvcnQ6IG51bWJlcixcbiAgb3B0aW9uczoge1xuICAgIG1vY2tVc2VyVG9rZW4/OiBFbXVsYXRvck1vY2tUb2tlbk9wdGlvbnMgfCBzdHJpbmc7XG4gIH0gPSB7fVxuKTogdm9pZCB7XG4gIHN0b3JhZ2UuaG9zdCA9IGAke2hvc3R9OiR7cG9ydH1gO1xuICBzdG9yYWdlLl9wcm90b2NvbCA9ICdodHRwJztcbiAgY29uc3QgeyBtb2NrVXNlclRva2VuIH0gPSBvcHRpb25zO1xuICBpZiAobW9ja1VzZXJUb2tlbikge1xuICAgIHN0b3JhZ2UuX292ZXJyaWRlQXV0aFRva2VuID1cbiAgICAgIHR5cGVvZiBtb2NrVXNlclRva2VuID09PSAnc3RyaW5nJ1xuICAgICAgICA/IG1vY2tVc2VyVG9rZW5cbiAgICAgICAgOiBjcmVhdGVNb2NrVXNlclRva2VuKG1vY2tVc2VyVG9rZW4sIHN0b3JhZ2UuYXBwLm9wdGlvbnMucHJvamVjdElkKTtcbiAgfVxufVxuXG4vKipcbiAqIEEgc2VydmljZSB0aGF0IHByb3ZpZGVzIEZpcmViYXNlIFN0b3JhZ2UgUmVmZXJlbmNlIGluc3RhbmNlcy5cbiAqIEBwYXJhbSBvcHRfdXJsIC0gZ3M6Ly8gdXJsIHRvIGEgY3VzdG9tIFN0b3JhZ2UgQnVja2V0XG4gKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBjbGFzcyBGaXJlYmFzZVN0b3JhZ2VJbXBsIGltcGxlbWVudHMgRmlyZWJhc2VTdG9yYWdlIHtcbiAgX2J1Y2tldDogTG9jYXRpb24gfCBudWxsID0gbnVsbDtcbiAgLyoqXG4gICAqIFRoaXMgc3RyaW5nIGNhbiBiZSBpbiB0aGUgZm9ybWF0czpcbiAgICogLSBob3N0XG4gICAqIC0gaG9zdDpwb3J0XG4gICAqL1xuICBwcml2YXRlIF9ob3N0OiBzdHJpbmcgPSBERUZBVUxUX0hPU1Q7XG4gIF9wcm90b2NvbDogc3RyaW5nID0gJ2h0dHBzJztcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IF9hcHBJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgcmVhZG9ubHkgX3JlcXVlc3RzOiBTZXQ8UmVxdWVzdDx1bmtub3duPj47XG4gIHByaXZhdGUgX2RlbGV0ZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBfbWF4T3BlcmF0aW9uUmV0cnlUaW1lOiBudW1iZXI7XG4gIHByaXZhdGUgX21heFVwbG9hZFJldHJ5VGltZTogbnVtYmVyO1xuICBfb3ZlcnJpZGVBdXRoVG9rZW4/OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogRmlyZWJhc2VBcHAgYXNzb2NpYXRlZCB3aXRoIHRoaXMgU3RvcmFnZVNlcnZpY2UgaW5zdGFuY2UuXG4gICAgICovXG4gICAgcmVhZG9ubHkgYXBwOiBGaXJlYmFzZUFwcCxcbiAgICByZWFkb25seSBfYXV0aFByb3ZpZGVyOiBQcm92aWRlcjxGaXJlYmFzZUF1dGhJbnRlcm5hbE5hbWU+LFxuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHJlYWRvbmx5IF9hcHBDaGVja1Byb3ZpZGVyOiBQcm92aWRlcjxBcHBDaGVja0ludGVybmFsQ29tcG9uZW50TmFtZT4sXG4gICAgLyoqXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcmVhZG9ubHkgX3VybD86IHN0cmluZyxcbiAgICByZWFkb25seSBfZmlyZWJhc2VWZXJzaW9uPzogc3RyaW5nXG4gICkge1xuICAgIHRoaXMuX21heE9wZXJhdGlvblJldHJ5VGltZSA9IERFRkFVTFRfTUFYX09QRVJBVElPTl9SRVRSWV9USU1FO1xuICAgIHRoaXMuX21heFVwbG9hZFJldHJ5VGltZSA9IERFRkFVTFRfTUFYX1VQTE9BRF9SRVRSWV9USU1FO1xuICAgIHRoaXMuX3JlcXVlc3RzID0gbmV3IFNldCgpO1xuICAgIGlmIChfdXJsICE9IG51bGwpIHtcbiAgICAgIHRoaXMuX2J1Y2tldCA9IExvY2F0aW9uLm1ha2VGcm9tQnVja2V0U3BlYyhfdXJsLCB0aGlzLl9ob3N0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnVja2V0ID0gZXh0cmFjdEJ1Y2tldCh0aGlzLl9ob3N0LCB0aGlzLmFwcC5vcHRpb25zKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVGhlIGhvc3Qgc3RyaW5nIGZvciB0aGlzIHNlcnZpY2UsIGluIHRoZSBmb3JtIG9mIGBob3N0YCBvclxuICAgKiBgaG9zdDpwb3J0YC5cbiAgICovXG4gIGdldCBob3N0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2hvc3Q7XG4gIH1cblxuICBzZXQgaG9zdChob3N0OiBzdHJpbmcpIHtcbiAgICB0aGlzLl9ob3N0ID0gaG9zdDtcbiAgICBpZiAodGhpcy5fdXJsICE9IG51bGwpIHtcbiAgICAgIHRoaXMuX2J1Y2tldCA9IExvY2F0aW9uLm1ha2VGcm9tQnVja2V0U3BlYyh0aGlzLl91cmwsIGhvc3QpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idWNrZXQgPSBleHRyYWN0QnVja2V0KGhvc3QsIHRoaXMuYXBwLm9wdGlvbnMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgbWF4aW11bSB0aW1lIHRvIHJldHJ5IHVwbG9hZHMgaW4gbWlsbGlzZWNvbmRzLlxuICAgKi9cbiAgZ2V0IG1heFVwbG9hZFJldHJ5VGltZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9tYXhVcGxvYWRSZXRyeVRpbWU7XG4gIH1cblxuICBzZXQgbWF4VXBsb2FkUmV0cnlUaW1lKHRpbWU6IG51bWJlcikge1xuICAgIHZhbGlkYXRlTnVtYmVyKFxuICAgICAgJ3RpbWUnLFxuICAgICAgLyogbWluVmFsdWU9Ki8gMCxcbiAgICAgIC8qIG1heFZhbHVlPSAqLyBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksXG4gICAgICB0aW1lXG4gICAgKTtcbiAgICB0aGlzLl9tYXhVcGxvYWRSZXRyeVRpbWUgPSB0aW1lO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBtYXhpbXVtIHRpbWUgdG8gcmV0cnkgb3BlcmF0aW9ucyBvdGhlciB0aGFuIHVwbG9hZHMgb3IgZG93bmxvYWRzIGluXG4gICAqIG1pbGxpc2Vjb25kcy5cbiAgICovXG4gIGdldCBtYXhPcGVyYXRpb25SZXRyeVRpbWUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fbWF4T3BlcmF0aW9uUmV0cnlUaW1lO1xuICB9XG5cbiAgc2V0IG1heE9wZXJhdGlvblJldHJ5VGltZSh0aW1lOiBudW1iZXIpIHtcbiAgICB2YWxpZGF0ZU51bWJlcihcbiAgICAgICd0aW1lJyxcbiAgICAgIC8qIG1pblZhbHVlPSovIDAsXG4gICAgICAvKiBtYXhWYWx1ZT0gKi8gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLFxuICAgICAgdGltZVxuICAgICk7XG4gICAgdGhpcy5fbWF4T3BlcmF0aW9uUmV0cnlUaW1lID0gdGltZTtcbiAgfVxuXG4gIGFzeW5jIF9nZXRBdXRoVG9rZW4oKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgaWYgKHRoaXMuX292ZXJyaWRlQXV0aFRva2VuKSB7XG4gICAgICByZXR1cm4gdGhpcy5fb3ZlcnJpZGVBdXRoVG9rZW47XG4gICAgfVxuICAgIGNvbnN0IGF1dGggPSB0aGlzLl9hdXRoUHJvdmlkZXIuZ2V0SW1tZWRpYXRlKHsgb3B0aW9uYWw6IHRydWUgfSk7XG4gICAgaWYgKGF1dGgpIHtcbiAgICAgIGNvbnN0IHRva2VuRGF0YSA9IGF3YWl0IGF1dGguZ2V0VG9rZW4oKTtcbiAgICAgIGlmICh0b2tlbkRhdGEgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRva2VuRGF0YS5hY2Nlc3NUb2tlbjtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBhc3luYyBfZ2V0QXBwQ2hlY2tUb2tlbigpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICBjb25zdCBhcHBDaGVjayA9IHRoaXMuX2FwcENoZWNrUHJvdmlkZXIuZ2V0SW1tZWRpYXRlKHsgb3B0aW9uYWw6IHRydWUgfSk7XG4gICAgaWYgKGFwcENoZWNrKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcHBDaGVjay5nZXRUb2tlbigpO1xuICAgICAgLy8gVE9ETzogV2hhdCBkbyB3ZSB3YW50IHRvIGRvIGlmIHRoZXJlIGlzIGFuIGVycm9yIGdldHRpbmcgdGhlIHRva2VuP1xuICAgICAgLy8gQ29udGV4dDogYXBwQ2hlY2suZ2V0VG9rZW4oKSB3aWxsIG5ldmVyIHRocm93IGV2ZW4gaWYgYW4gZXJyb3IgaGFwcGVuZWQuIEluIHRoZSBlcnJvciBjYXNlLCBhIGR1bW15IHRva2VuIHdpbGwgYmVcbiAgICAgIC8vIHJldHVybmVkIGFsb25nIHdpdGggYW4gZXJyb3IgZmllbGQgZGVzY3JpYmluZyB0aGUgZXJyb3IuIEluIGdlbmVyYWwsIHdlIHNob3VsZG4ndCBjYXJlIGFib3V0IHRoZSBlcnJvciBjb25kaXRpb24gYW5kIGp1c3QgdXNlXG4gICAgICAvLyB0aGUgdG9rZW4gKGFjdHVhbCBvciBkdW1teSkgdG8gc2VuZCByZXF1ZXN0cy5cbiAgICAgIHJldHVybiByZXN1bHQudG9rZW47XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0b3AgcnVubmluZyByZXF1ZXN0cyBhbmQgcHJldmVudCBtb3JlIGZyb20gYmVpbmcgY3JlYXRlZC5cbiAgICovXG4gIF9kZWxldGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKCF0aGlzLl9kZWxldGVkKSB7XG4gICAgICB0aGlzLl9kZWxldGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX3JlcXVlc3RzLmZvckVhY2gocmVxdWVzdCA9PiByZXF1ZXN0LmNhbmNlbCgpKTtcbiAgICAgIHRoaXMuX3JlcXVlc3RzLmNsZWFyKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgbmV3IGZpcmViYXNlU3RvcmFnZS5SZWZlcmVuY2Ugb2JqZWN0IHJlZmVyZW5jaW5nIHRoaXMgU3RvcmFnZVNlcnZpY2VcbiAgICogYXQgdGhlIGdpdmVuIExvY2F0aW9uLlxuICAgKi9cbiAgX21ha2VTdG9yYWdlUmVmZXJlbmNlKGxvYzogTG9jYXRpb24pOiBSZWZlcmVuY2Uge1xuICAgIHJldHVybiBuZXcgUmVmZXJlbmNlKHRoaXMsIGxvYyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHJlcXVlc3RJbmZvIC0gSFRUUCBSZXF1ZXN0SW5mbyBvYmplY3RcbiAgICogQHBhcmFtIGF1dGhUb2tlbiAtIEZpcmViYXNlIGF1dGggdG9rZW5cbiAgICovXG4gIF9tYWtlUmVxdWVzdDxJIGV4dGVuZHMgQ29ubmVjdGlvblR5cGUsIE8+KFxuICAgIHJlcXVlc3RJbmZvOiBSZXF1ZXN0SW5mbzxJLCBPPixcbiAgICByZXF1ZXN0RmFjdG9yeTogKCkgPT4gQ29ubmVjdGlvbjxJPixcbiAgICBhdXRoVG9rZW46IHN0cmluZyB8IG51bGwsXG4gICAgYXBwQ2hlY2tUb2tlbjogc3RyaW5nIHwgbnVsbCxcbiAgICByZXRyeSA9IHRydWVcbiAgKTogUmVxdWVzdDxPPiB7XG4gICAgaWYgKCF0aGlzLl9kZWxldGVkKSB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gbWFrZVJlcXVlc3QoXG4gICAgICAgIHJlcXVlc3RJbmZvLFxuICAgICAgICB0aGlzLl9hcHBJZCxcbiAgICAgICAgYXV0aFRva2VuLFxuICAgICAgICBhcHBDaGVja1Rva2VuLFxuICAgICAgICByZXF1ZXN0RmFjdG9yeSxcbiAgICAgICAgdGhpcy5fZmlyZWJhc2VWZXJzaW9uLFxuICAgICAgICByZXRyeVxuICAgICAgKTtcbiAgICAgIHRoaXMuX3JlcXVlc3RzLmFkZChyZXF1ZXN0KTtcbiAgICAgIC8vIFJlcXVlc3QgcmVtb3ZlcyBpdHNlbGYgZnJvbSBzZXQgd2hlbiBjb21wbGV0ZS5cbiAgICAgIHJlcXVlc3QuZ2V0UHJvbWlzZSgpLnRoZW4oXG4gICAgICAgICgpID0+IHRoaXMuX3JlcXVlc3RzLmRlbGV0ZShyZXF1ZXN0KSxcbiAgICAgICAgKCkgPT4gdGhpcy5fcmVxdWVzdHMuZGVsZXRlKHJlcXVlc3QpXG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlcXVlc3Q7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBuZXcgRmFpbFJlcXVlc3QoYXBwRGVsZXRlZCgpKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBtYWtlUmVxdWVzdFdpdGhUb2tlbnM8SSBleHRlbmRzIENvbm5lY3Rpb25UeXBlLCBPPihcbiAgICByZXF1ZXN0SW5mbzogUmVxdWVzdEluZm88SSwgTz4sXG4gICAgcmVxdWVzdEZhY3Rvcnk6ICgpID0+IENvbm5lY3Rpb248ST5cbiAgKTogUHJvbWlzZTxPPiB7XG4gICAgY29uc3QgW2F1dGhUb2tlbiwgYXBwQ2hlY2tUb2tlbl0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICB0aGlzLl9nZXRBdXRoVG9rZW4oKSxcbiAgICAgIHRoaXMuX2dldEFwcENoZWNrVG9rZW4oKVxuICAgIF0pO1xuXG4gICAgcmV0dXJuIHRoaXMuX21ha2VSZXF1ZXN0KFxuICAgICAgcmVxdWVzdEluZm8sXG4gICAgICByZXF1ZXN0RmFjdG9yeSxcbiAgICAgIGF1dGhUb2tlbixcbiAgICAgIGFwcENoZWNrVG9rZW5cbiAgICApLmdldFByb21pc2UoKTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogVHlwZSBjb25zdGFudCBmb3IgRmlyZWJhc2UgU3RvcmFnZS5cbiAqL1xuZXhwb3J0IGNvbnN0IFNUT1JBR0VfVFlQRSA9ICdzdG9yYWdlJztcbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgX2dldFByb3ZpZGVyLCBGaXJlYmFzZUFwcCwgZ2V0QXBwIH0gZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5cbmltcG9ydCB7XG4gIHJlZiBhcyByZWZJbnRlcm5hbCxcbiAgRmlyZWJhc2VTdG9yYWdlSW1wbCxcbiAgY29ubmVjdFN0b3JhZ2VFbXVsYXRvciBhcyBjb25uZWN0RW11bGF0b3JJbnRlcm5hbFxufSBmcm9tICcuL3NlcnZpY2UnO1xuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tICdAZmlyZWJhc2UvY29tcG9uZW50JztcblxuaW1wb3J0IHtcbiAgU3RvcmFnZVJlZmVyZW5jZSxcbiAgRmlyZWJhc2VTdG9yYWdlLFxuICBVcGxvYWRSZXN1bHQsXG4gIExpc3RPcHRpb25zLFxuICBMaXN0UmVzdWx0LFxuICBVcGxvYWRUYXNrLFxuICBTZXR0YWJsZU1ldGFkYXRhLFxuICBVcGxvYWRNZXRhZGF0YSxcbiAgRnVsbE1ldGFkYXRhXG59IGZyb20gJy4vcHVibGljLXR5cGVzJztcbmltcG9ydCB7IE1ldGFkYXRhIGFzIE1ldGFkYXRhSW50ZXJuYWwgfSBmcm9tICcuL21ldGFkYXRhJztcbmltcG9ydCB7XG4gIHVwbG9hZEJ5dGVzIGFzIHVwbG9hZEJ5dGVzSW50ZXJuYWwsXG4gIHVwbG9hZEJ5dGVzUmVzdW1hYmxlIGFzIHVwbG9hZEJ5dGVzUmVzdW1hYmxlSW50ZXJuYWwsXG4gIHVwbG9hZFN0cmluZyBhcyB1cGxvYWRTdHJpbmdJbnRlcm5hbCxcbiAgZ2V0TWV0YWRhdGEgYXMgZ2V0TWV0YWRhdGFJbnRlcm5hbCxcbiAgdXBkYXRlTWV0YWRhdGEgYXMgdXBkYXRlTWV0YWRhdGFJbnRlcm5hbCxcbiAgbGlzdCBhcyBsaXN0SW50ZXJuYWwsXG4gIGxpc3RBbGwgYXMgbGlzdEFsbEludGVybmFsLFxuICBnZXREb3dubG9hZFVSTCBhcyBnZXREb3dubG9hZFVSTEludGVybmFsLFxuICBkZWxldGVPYmplY3QgYXMgZGVsZXRlT2JqZWN0SW50ZXJuYWwsXG4gIFJlZmVyZW5jZSxcbiAgX2dldENoaWxkIGFzIF9nZXRDaGlsZEludGVybmFsLFxuICBnZXRCeXRlc0ludGVybmFsXG59IGZyb20gJy4vcmVmZXJlbmNlJztcbmltcG9ydCB7IFNUT1JBR0VfVFlQRSB9IGZyb20gJy4vY29uc3RhbnRzJztcbmltcG9ydCB7XG4gIEVtdWxhdG9yTW9ja1Rva2VuT3B0aW9ucyxcbiAgZ2V0TW9kdWxhckluc3RhbmNlLFxuICBnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnRcbn0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgU3RyaW5nRm9ybWF0IH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9zdHJpbmcnO1xuXG5leHBvcnQgeyBFbXVsYXRvck1vY2tUb2tlbk9wdGlvbnMgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbmV4cG9ydCB7IFN0b3JhZ2VFcnJvciwgU3RvcmFnZUVycm9yQ29kZSB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vZXJyb3InO1xuXG4vKipcbiAqIFB1YmxpYyB0eXBlcy5cbiAqL1xuZXhwb3J0ICogZnJvbSAnLi9wdWJsaWMtdHlwZXMnO1xuXG5leHBvcnQgeyBMb2NhdGlvbiBhcyBfTG9jYXRpb24gfSBmcm9tICcuL2ltcGxlbWVudGF0aW9uL2xvY2F0aW9uJztcbmV4cG9ydCB7IFVwbG9hZFRhc2sgYXMgX1VwbG9hZFRhc2sgfSBmcm9tICcuL3Rhc2snO1xuZXhwb3J0IHR5cGUgeyBSZWZlcmVuY2UgYXMgX1JlZmVyZW5jZSB9IGZyb20gJy4vcmVmZXJlbmNlJztcbmV4cG9ydCB0eXBlIHsgRmlyZWJhc2VTdG9yYWdlSW1wbCBhcyBfRmlyZWJhc2VTdG9yYWdlSW1wbCB9IGZyb20gJy4vc2VydmljZSc7XG5leHBvcnQgeyBGYnNCbG9iIGFzIF9GYnNCbG9iIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9ibG9iJztcbmV4cG9ydCB7IGRhdGFGcm9tU3RyaW5nIGFzIF9kYXRhRnJvbVN0cmluZyB9IGZyb20gJy4vaW1wbGVtZW50YXRpb24vc3RyaW5nJztcbmV4cG9ydCB7XG4gIGludmFsaWRSb290T3BlcmF0aW9uIGFzIF9pbnZhbGlkUm9vdE9wZXJhdGlvbixcbiAgaW52YWxpZEFyZ3VtZW50IGFzIF9pbnZhbGlkQXJndW1lbnRcbn0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi9lcnJvcic7XG5leHBvcnQge1xuICBUYXNrRXZlbnQgYXMgX1Rhc2tFdmVudCxcbiAgVGFza1N0YXRlIGFzIF9UYXNrU3RhdGVcbn0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbi90YXNrZW51bXMnO1xuZXhwb3J0IHsgU3RyaW5nRm9ybWF0IH07XG5cbi8qKlxuICogRG93bmxvYWRzIHRoZSBkYXRhIGF0IHRoZSBvYmplY3QncyBsb2NhdGlvbi4gUmV0dXJucyBhbiBlcnJvciBpZiB0aGUgb2JqZWN0XG4gKiBpcyBub3QgZm91bmQuXG4gKlxuICogVG8gdXNlIHRoaXMgZnVuY3Rpb25hbGl0eSwgeW91IGhhdmUgdG8gd2hpdGVsaXN0IHlvdXIgYXBwJ3Mgb3JpZ2luIGluIHlvdXJcbiAqIENsb3VkIFN0b3JhZ2UgYnVja2V0LiBTZWUgYWxzb1xuICogaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL3N0b3JhZ2UvZG9jcy9jb25maWd1cmluZy1jb3JzXG4gKlxuICogQHB1YmxpY1xuICogQHBhcmFtIHJlZiAtIFN0b3JhZ2VSZWZlcmVuY2Ugd2hlcmUgZGF0YSBzaG91bGQgYmUgZG93bmxvYWRlZC5cbiAqIEBwYXJhbSBtYXhEb3dubG9hZFNpemVCeXRlcyAtIElmIHNldCwgdGhlIG1heGltdW0gYWxsb3dlZCBzaXplIGluIGJ5dGVzIHRvXG4gKiByZXRyaWV2ZS5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSBjb250YWluaW5nIHRoZSBvYmplY3QncyBieXRlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Qnl0ZXMoXG4gIHJlZjogU3RvcmFnZVJlZmVyZW5jZSxcbiAgbWF4RG93bmxvYWRTaXplQnl0ZXM/OiBudW1iZXJcbik6IFByb21pc2U8QXJyYXlCdWZmZXI+IHtcbiAgcmVmID0gZ2V0TW9kdWxhckluc3RhbmNlKHJlZik7XG4gIHJldHVybiBnZXRCeXRlc0ludGVybmFsKHJlZiBhcyBSZWZlcmVuY2UsIG1heERvd25sb2FkU2l6ZUJ5dGVzKTtcbn1cblxuLyoqXG4gKiBVcGxvYWRzIGRhdGEgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cbiAqIFRoZSB1cGxvYWQgaXMgbm90IHJlc3VtYWJsZS5cbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gd2hlcmUgZGF0YSBzaG91bGQgYmUgdXBsb2FkZWQuXG4gKiBAcGFyYW0gZGF0YSAtIFRoZSBkYXRhIHRvIHVwbG9hZC5cbiAqIEBwYXJhbSBtZXRhZGF0YSAtIE1ldGFkYXRhIGZvciB0aGUgZGF0YSB0byB1cGxvYWQuXG4gKiBAcmV0dXJucyBBIFByb21pc2UgY29udGFpbmluZyBhbiBVcGxvYWRSZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwbG9hZEJ5dGVzKFxuICByZWY6IFN0b3JhZ2VSZWZlcmVuY2UsXG4gIGRhdGE6IEJsb2IgfCBVaW50OEFycmF5IHwgQXJyYXlCdWZmZXIsXG4gIG1ldGFkYXRhPzogVXBsb2FkTWV0YWRhdGFcbik6IFByb21pc2U8VXBsb2FkUmVzdWx0PiB7XG4gIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xuICByZXR1cm4gdXBsb2FkQnl0ZXNJbnRlcm5hbChcbiAgICByZWYgYXMgUmVmZXJlbmNlLFxuICAgIGRhdGEsXG4gICAgbWV0YWRhdGEgYXMgTWV0YWRhdGFJbnRlcm5hbFxuICApO1xufVxuXG4vKipcbiAqIFVwbG9hZHMgYSBzdHJpbmcgdG8gdGhpcyBvYmplY3QncyBsb2NhdGlvbi5cbiAqIFRoZSB1cGxvYWQgaXMgbm90IHJlc3VtYWJsZS5cbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gd2hlcmUgc3RyaW5nIHNob3VsZCBiZSB1cGxvYWRlZC5cbiAqIEBwYXJhbSB2YWx1ZSAtIFRoZSBzdHJpbmcgdG8gdXBsb2FkLlxuICogQHBhcmFtIGZvcm1hdCAtIFRoZSBmb3JtYXQgb2YgdGhlIHN0cmluZyB0byB1cGxvYWQuXG4gKiBAcGFyYW0gbWV0YWRhdGEgLSBNZXRhZGF0YSBmb3IgdGhlIHN0cmluZyB0byB1cGxvYWQuXG4gKiBAcmV0dXJucyBBIFByb21pc2UgY29udGFpbmluZyBhbiBVcGxvYWRSZXN1bHRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwbG9hZFN0cmluZyhcbiAgcmVmOiBTdG9yYWdlUmVmZXJlbmNlLFxuICB2YWx1ZTogc3RyaW5nLFxuICBmb3JtYXQ/OiBTdHJpbmdGb3JtYXQsXG4gIG1ldGFkYXRhPzogVXBsb2FkTWV0YWRhdGFcbik6IFByb21pc2U8VXBsb2FkUmVzdWx0PiB7XG4gIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xuICByZXR1cm4gdXBsb2FkU3RyaW5nSW50ZXJuYWwoXG4gICAgcmVmIGFzIFJlZmVyZW5jZSxcbiAgICB2YWx1ZSxcbiAgICBmb3JtYXQsXG4gICAgbWV0YWRhdGEgYXMgTWV0YWRhdGFJbnRlcm5hbFxuICApO1xufVxuXG4vKipcbiAqIFVwbG9hZHMgZGF0YSB0byB0aGlzIG9iamVjdCdzIGxvY2F0aW9uLlxuICogVGhlIHVwbG9hZCBjYW4gYmUgcGF1c2VkIGFuZCByZXN1bWVkLCBhbmQgZXhwb3NlcyBwcm9ncmVzcyB1cGRhdGVzLlxuICogQHB1YmxpY1xuICogQHBhcmFtIHJlZiAtIHtAbGluayBTdG9yYWdlUmVmZXJlbmNlfSB3aGVyZSBkYXRhIHNob3VsZCBiZSB1cGxvYWRlZC5cbiAqIEBwYXJhbSBkYXRhIC0gVGhlIGRhdGEgdG8gdXBsb2FkLlxuICogQHBhcmFtIG1ldGFkYXRhIC0gTWV0YWRhdGEgZm9yIHRoZSBkYXRhIHRvIHVwbG9hZC5cbiAqIEByZXR1cm5zIEFuIFVwbG9hZFRhc2tcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwbG9hZEJ5dGVzUmVzdW1hYmxlKFxuICByZWY6IFN0b3JhZ2VSZWZlcmVuY2UsXG4gIGRhdGE6IEJsb2IgfCBVaW50OEFycmF5IHwgQXJyYXlCdWZmZXIsXG4gIG1ldGFkYXRhPzogVXBsb2FkTWV0YWRhdGFcbik6IFVwbG9hZFRhc2sge1xuICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcbiAgcmV0dXJuIHVwbG9hZEJ5dGVzUmVzdW1hYmxlSW50ZXJuYWwoXG4gICAgcmVmIGFzIFJlZmVyZW5jZSxcbiAgICBkYXRhLFxuICAgIG1ldGFkYXRhIGFzIE1ldGFkYXRhSW50ZXJuYWxcbiAgKSBhcyBVcGxvYWRUYXNrO1xufVxuXG4vKipcbiAqIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgbWV0YWRhdGEgZm9yIHRoaXMgb2JqZWN0LiBJZiB0aGlzXG4gKiBvYmplY3QgZG9lc24ndCBleGlzdCBvciBtZXRhZGF0YSBjYW5ub3QgYmUgcmV0cmVpdmVkLCB0aGUgcHJvbWlzZSBpc1xuICogcmVqZWN0ZWQuXG4gKiBAcHVibGljXG4gKiBAcGFyYW0gcmVmIC0ge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9IHRvIGdldCBtZXRhZGF0YSBmcm9tLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWV0YWRhdGEocmVmOiBTdG9yYWdlUmVmZXJlbmNlKTogUHJvbWlzZTxGdWxsTWV0YWRhdGE+IHtcbiAgcmVmID0gZ2V0TW9kdWxhckluc3RhbmNlKHJlZik7XG4gIHJldHVybiBnZXRNZXRhZGF0YUludGVybmFsKHJlZiBhcyBSZWZlcmVuY2UpIGFzIFByb21pc2U8RnVsbE1ldGFkYXRhPjtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSBtZXRhZGF0YSBmb3IgdGhpcyBvYmplY3QuXG4gKiBAcHVibGljXG4gKiBAcGFyYW0gcmVmIC0ge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9IHRvIHVwZGF0ZSBtZXRhZGF0YSBmb3IuXG4gKiBAcGFyYW0gbWV0YWRhdGEgLSBUaGUgbmV3IG1ldGFkYXRhIGZvciB0aGUgb2JqZWN0LlxuICogICAgIE9ubHkgdmFsdWVzIHRoYXQgaGF2ZSBiZWVuIGV4cGxpY2l0bHkgc2V0IHdpbGwgYmUgY2hhbmdlZC4gRXhwbGljaXRseVxuICogICAgIHNldHRpbmcgYSB2YWx1ZSB0byBudWxsIHdpbGwgcmVtb3ZlIHRoZSBtZXRhZGF0YS5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgbmV3IG1ldGFkYXRhIGZvciB0aGlzIG9iamVjdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1ldGFkYXRhKFxuICByZWY6IFN0b3JhZ2VSZWZlcmVuY2UsXG4gIG1ldGFkYXRhOiBTZXR0YWJsZU1ldGFkYXRhXG4pOiBQcm9taXNlPEZ1bGxNZXRhZGF0YT4ge1xuICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcbiAgcmV0dXJuIHVwZGF0ZU1ldGFkYXRhSW50ZXJuYWwoXG4gICAgcmVmIGFzIFJlZmVyZW5jZSxcbiAgICBtZXRhZGF0YSBhcyBQYXJ0aWFsPE1ldGFkYXRhSW50ZXJuYWw+XG4gICkgYXMgUHJvbWlzZTxGdWxsTWV0YWRhdGE+O1xufVxuXG4vKipcbiAqIExpc3QgaXRlbXMgKGZpbGVzKSBhbmQgcHJlZml4ZXMgKGZvbGRlcnMpIHVuZGVyIHRoaXMgc3RvcmFnZSByZWZlcmVuY2UuXG4gKlxuICogTGlzdCBBUEkgaXMgb25seSBhdmFpbGFibGUgZm9yIEZpcmViYXNlIFJ1bGVzIFZlcnNpb24gMi5cbiAqXG4gKiBHQ1MgaXMgYSBrZXktYmxvYiBzdG9yZS4gRmlyZWJhc2UgU3RvcmFnZSBpbXBvc2VzIHRoZSBzZW1hbnRpYyBvZiAnLydcbiAqIGRlbGltaXRlZCBmb2xkZXIgc3RydWN0dXJlLlxuICogUmVmZXIgdG8gR0NTJ3MgTGlzdCBBUEkgaWYgeW91IHdhbnQgdG8gbGVhcm4gbW9yZS5cbiAqXG4gKiBUbyBhZGhlcmUgdG8gRmlyZWJhc2UgUnVsZXMncyBTZW1hbnRpY3MsIEZpcmViYXNlIFN0b3JhZ2UgZG9lcyBub3RcbiAqIHN1cHBvcnQgb2JqZWN0cyB3aG9zZSBwYXRocyBlbmQgd2l0aCBcIi9cIiBvciBjb250YWluIHR3byBjb25zZWN1dGl2ZVxuICogXCIvXCJzLiBGaXJlYmFzZSBTdG9yYWdlIExpc3QgQVBJIHdpbGwgZmlsdGVyIHRoZXNlIHVuc3VwcG9ydGVkIG9iamVjdHMuXG4gKiBsaXN0KCkgbWF5IGZhaWwgaWYgdGhlcmUgYXJlIHRvbyBtYW55IHVuc3VwcG9ydGVkIG9iamVjdHMgaW4gdGhlIGJ1Y2tldC5cbiAqIEBwdWJsaWNcbiAqXG4gKiBAcGFyYW0gcmVmIC0ge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9IHRvIGdldCBsaXN0IGZyb20uXG4gKiBAcGFyYW0gb3B0aW9ucyAtIFNlZSB7QGxpbmsgTGlzdE9wdGlvbnN9IGZvciBkZXRhaWxzLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMuXG4gKiAgICAgIGBwcmVmaXhlc2AgY29udGFpbnMgcmVmZXJlbmNlcyB0byBzdWItZm9sZGVycyBhbmQgYGl0ZW1zYFxuICogICAgICBjb250YWlucyByZWZlcmVuY2VzIHRvIG9iamVjdHMgaW4gdGhpcyBmb2xkZXIuIGBuZXh0UGFnZVRva2VuYFxuICogICAgICBjYW4gYmUgdXNlZCB0byBnZXQgdGhlIHJlc3Qgb2YgdGhlIHJlc3VsdHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0KFxuICByZWY6IFN0b3JhZ2VSZWZlcmVuY2UsXG4gIG9wdGlvbnM/OiBMaXN0T3B0aW9uc1xuKTogUHJvbWlzZTxMaXN0UmVzdWx0PiB7XG4gIHJlZiA9IGdldE1vZHVsYXJJbnN0YW5jZShyZWYpO1xuICByZXR1cm4gbGlzdEludGVybmFsKHJlZiBhcyBSZWZlcmVuY2UsIG9wdGlvbnMpO1xufVxuXG4vKipcbiAqIExpc3QgYWxsIGl0ZW1zIChmaWxlcykgYW5kIHByZWZpeGVzIChmb2xkZXJzKSB1bmRlciB0aGlzIHN0b3JhZ2UgcmVmZXJlbmNlLlxuICpcbiAqIFRoaXMgaXMgYSBoZWxwZXIgbWV0aG9kIGZvciBjYWxsaW5nIGxpc3QoKSByZXBlYXRlZGx5IHVudGlsIHRoZXJlIGFyZVxuICogbm8gbW9yZSByZXN1bHRzLiBUaGUgZGVmYXVsdCBwYWdpbmF0aW9uIHNpemUgaXMgMTAwMC5cbiAqXG4gKiBOb3RlOiBUaGUgcmVzdWx0cyBtYXkgbm90IGJlIGNvbnNpc3RlbnQgaWYgb2JqZWN0cyBhcmUgY2hhbmdlZCB3aGlsZSB0aGlzXG4gKiBvcGVyYXRpb24gaXMgcnVubmluZy5cbiAqXG4gKiBXYXJuaW5nOiBgbGlzdEFsbGAgbWF5IHBvdGVudGlhbGx5IGNvbnN1bWUgdG9vIG1hbnkgcmVzb3VyY2VzIGlmIHRoZXJlIGFyZVxuICogdG9vIG1hbnkgcmVzdWx0cy5cbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSByZWYgLSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gdG8gZ2V0IGxpc3QgZnJvbS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHJlc29sdmVzIHdpdGggYWxsIHRoZSBpdGVtcyBhbmQgcHJlZml4ZXMgdW5kZXJcbiAqICAgICAgdGhlIGN1cnJlbnQgc3RvcmFnZSByZWZlcmVuY2UuIGBwcmVmaXhlc2AgY29udGFpbnMgcmVmZXJlbmNlcyB0b1xuICogICAgICBzdWItZGlyZWN0b3JpZXMgYW5kIGBpdGVtc2AgY29udGFpbnMgcmVmZXJlbmNlcyB0byBvYmplY3RzIGluIHRoaXNcbiAqICAgICAgZm9sZGVyLiBgbmV4dFBhZ2VUb2tlbmAgaXMgbmV2ZXIgcmV0dXJuZWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsaXN0QWxsKHJlZjogU3RvcmFnZVJlZmVyZW5jZSk6IFByb21pc2U8TGlzdFJlc3VsdD4ge1xuICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcbiAgcmV0dXJuIGxpc3RBbGxJbnRlcm5hbChyZWYgYXMgUmVmZXJlbmNlKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBkb3dubG9hZCBVUkwgZm9yIHRoZSBnaXZlbiB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0uXG4gKiBAcHVibGljXG4gKiBAcGFyYW0gcmVmIC0ge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9IHRvIGdldCB0aGUgZG93bmxvYWQgVVJMIGZvci5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgZG93bmxvYWRcbiAqICAgICBVUkwgZm9yIHRoaXMgb2JqZWN0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RG93bmxvYWRVUkwocmVmOiBTdG9yYWdlUmVmZXJlbmNlKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgcmVmID0gZ2V0TW9kdWxhckluc3RhbmNlKHJlZik7XG4gIHJldHVybiBnZXREb3dubG9hZFVSTEludGVybmFsKHJlZiBhcyBSZWZlcmVuY2UpO1xufVxuXG4vKipcbiAqIERlbGV0ZXMgdGhlIG9iamVjdCBhdCB0aGlzIGxvY2F0aW9uLlxuICogQHB1YmxpY1xuICogQHBhcmFtIHJlZiAtIHtAbGluayBTdG9yYWdlUmVmZXJlbmNlfSBmb3Igb2JqZWN0IHRvIGRlbGV0ZS5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgaWYgdGhlIGRlbGV0aW9uIHN1Y2NlZWRzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlT2JqZWN0KHJlZjogU3RvcmFnZVJlZmVyZW5jZSk6IFByb21pc2U8dm9pZD4ge1xuICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcbiAgcmV0dXJuIGRlbGV0ZU9iamVjdEludGVybmFsKHJlZiBhcyBSZWZlcmVuY2UpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB7QGxpbmsgU3RvcmFnZVJlZmVyZW5jZX0gZm9yIHRoZSBnaXZlbiB1cmwuXG4gKiBAcGFyYW0gc3RvcmFnZSAtIHtAbGluayBGaXJlYmFzZVN0b3JhZ2V9IGluc3RhbmNlLlxuICogQHBhcmFtIHVybCAtIFVSTC4gSWYgZW1wdHksIHJldHVybnMgcm9vdCByZWZlcmVuY2UuXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZWYoc3RvcmFnZTogRmlyZWJhc2VTdG9yYWdlLCB1cmw/OiBzdHJpbmcpOiBTdG9yYWdlUmVmZXJlbmNlO1xuLyoqXG4gKiBSZXR1cm5zIGEge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9IGZvciB0aGUgZ2l2ZW4gcGF0aCBpbiB0aGVcbiAqIGRlZmF1bHQgYnVja2V0LlxuICogQHBhcmFtIHN0b3JhZ2VPclJlZiAtIHtAbGluayBGaXJlYmFzZVN0b3JhZ2V9IG9yIHtAbGluayBTdG9yYWdlUmVmZXJlbmNlfS5cbiAqIEBwYXJhbSBwYXRoT3JVcmxTdG9yYWdlIC0gcGF0aC4gSWYgZW1wdHksIHJldHVybnMgcm9vdCByZWZlcmVuY2UgKGlmIHtAbGluayBGaXJlYmFzZVN0b3JhZ2V9XG4gKiBpbnN0YW5jZSBwcm92aWRlZCkgb3IgcmV0dXJucyBzYW1lIHJlZmVyZW5jZSAoaWYge0BsaW5rIFN0b3JhZ2VSZWZlcmVuY2V9IHByb3ZpZGVkKS5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlZihcbiAgc3RvcmFnZU9yUmVmOiBGaXJlYmFzZVN0b3JhZ2UgfCBTdG9yYWdlUmVmZXJlbmNlLFxuICBwYXRoPzogc3RyaW5nXG4pOiBTdG9yYWdlUmVmZXJlbmNlO1xuZXhwb3J0IGZ1bmN0aW9uIHJlZihcbiAgc2VydmljZU9yUmVmOiBGaXJlYmFzZVN0b3JhZ2UgfCBTdG9yYWdlUmVmZXJlbmNlLFxuICBwYXRoT3JVcmw/OiBzdHJpbmdcbik6IFN0b3JhZ2VSZWZlcmVuY2UgfCBudWxsIHtcbiAgc2VydmljZU9yUmVmID0gZ2V0TW9kdWxhckluc3RhbmNlKHNlcnZpY2VPclJlZik7XG4gIHJldHVybiByZWZJbnRlcm5hbChcbiAgICBzZXJ2aWNlT3JSZWYgYXMgRmlyZWJhc2VTdG9yYWdlSW1wbCB8IFJlZmVyZW5jZSxcbiAgICBwYXRoT3JVcmxcbiAgKTtcbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9nZXRDaGlsZChyZWY6IFN0b3JhZ2VSZWZlcmVuY2UsIGNoaWxkUGF0aDogc3RyaW5nKTogUmVmZXJlbmNlIHtcbiAgcmV0dXJuIF9nZXRDaGlsZEludGVybmFsKHJlZiBhcyBSZWZlcmVuY2UsIGNoaWxkUGF0aCk7XG59XG5cbi8qKlxuICogR2V0cyBhIHtAbGluayBGaXJlYmFzZVN0b3JhZ2V9IGluc3RhbmNlIGZvciB0aGUgZ2l2ZW4gRmlyZWJhc2UgYXBwLlxuICogQHB1YmxpY1xuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlIGFwcCB0byBnZXQge0BsaW5rIEZpcmViYXNlU3RvcmFnZX0gaW5zdGFuY2UgZm9yLlxuICogQHBhcmFtIGJ1Y2tldFVybCAtIFRoZSBnczovLyB1cmwgdG8geW91ciBGaXJlYmFzZSBTdG9yYWdlIEJ1Y2tldC5cbiAqIElmIG5vdCBwYXNzZWQsIHVzZXMgdGhlIGFwcCdzIGRlZmF1bHQgU3RvcmFnZSBCdWNrZXQuXG4gKiBAcmV0dXJucyBBIHtAbGluayBGaXJlYmFzZVN0b3JhZ2V9IGluc3RhbmNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3RvcmFnZShcbiAgYXBwOiBGaXJlYmFzZUFwcCA9IGdldEFwcCgpLFxuICBidWNrZXRVcmw/OiBzdHJpbmdcbik6IEZpcmViYXNlU3RvcmFnZSB7XG4gIGFwcCA9IGdldE1vZHVsYXJJbnN0YW5jZShhcHApO1xuICBjb25zdCBzdG9yYWdlUHJvdmlkZXI6IFByb3ZpZGVyPCdzdG9yYWdlJz4gPSBfZ2V0UHJvdmlkZXIoYXBwLCBTVE9SQUdFX1RZUEUpO1xuICBjb25zdCBzdG9yYWdlSW5zdGFuY2UgPSBzdG9yYWdlUHJvdmlkZXIuZ2V0SW1tZWRpYXRlKHtcbiAgICBpZGVudGlmaWVyOiBidWNrZXRVcmxcbiAgfSk7XG4gIGNvbnN0IGVtdWxhdG9yID0gZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdG5hbWVBbmRQb3J0KCdzdG9yYWdlJyk7XG4gIGlmIChlbXVsYXRvcikge1xuICAgIGNvbm5lY3RTdG9yYWdlRW11bGF0b3Ioc3RvcmFnZUluc3RhbmNlLCAuLi5lbXVsYXRvcik7XG4gIH1cbiAgcmV0dXJuIHN0b3JhZ2VJbnN0YW5jZTtcbn1cblxuLyoqXG4gKiBNb2RpZnkgdGhpcyB7QGxpbmsgRmlyZWJhc2VTdG9yYWdlfSBpbnN0YW5jZSB0byBjb21tdW5pY2F0ZSB3aXRoIHRoZSBDbG91ZCBTdG9yYWdlIGVtdWxhdG9yLlxuICpcbiAqIEBwYXJhbSBzdG9yYWdlIC0gVGhlIHtAbGluayBGaXJlYmFzZVN0b3JhZ2V9IGluc3RhbmNlXG4gKiBAcGFyYW0gaG9zdCAtIFRoZSBlbXVsYXRvciBob3N0IChleDogbG9jYWxob3N0KVxuICogQHBhcmFtIHBvcnQgLSBUaGUgZW11bGF0b3IgcG9ydCAoZXg6IDUwMDEpXG4gKiBAcGFyYW0gb3B0aW9ucyAtIEVtdWxhdG9yIG9wdGlvbnMuIGBvcHRpb25zLm1vY2tVc2VyVG9rZW5gIGlzIHRoZSBtb2NrIGF1dGhcbiAqIHRva2VuIHRvIHVzZSBmb3IgdW5pdCB0ZXN0aW5nIFNlY3VyaXR5IFJ1bGVzLlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gY29ubmVjdFN0b3JhZ2VFbXVsYXRvcihcbiAgc3RvcmFnZTogRmlyZWJhc2VTdG9yYWdlLFxuICBob3N0OiBzdHJpbmcsXG4gIHBvcnQ6IG51bWJlcixcbiAgb3B0aW9uczoge1xuICAgIG1vY2tVc2VyVG9rZW4/OiBFbXVsYXRvck1vY2tUb2tlbk9wdGlvbnMgfCBzdHJpbmc7XG4gIH0gPSB7fVxuKTogdm9pZCB7XG4gIGNvbm5lY3RFbXVsYXRvckludGVybmFsKHN0b3JhZ2UgYXMgRmlyZWJhc2VTdG9yYWdlSW1wbCwgaG9zdCwgcG9ydCwgb3B0aW9ucyk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgU3RvcmFnZVJlZmVyZW5jZSB9IGZyb20gJy4vcHVibGljLXR5cGVzJztcbmltcG9ydCB7IFJlZmVyZW5jZSwgZ2V0QmxvYkludGVybmFsIH0gZnJvbSAnLi9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgZ2V0TW9kdWxhckluc3RhbmNlIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKipcbiAqIERvd25sb2FkcyB0aGUgZGF0YSBhdCB0aGUgb2JqZWN0J3MgbG9jYXRpb24uIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIG9iamVjdFxuICogaXMgbm90IGZvdW5kLlxuICpcbiAqIFRvIHVzZSB0aGlzIGZ1bmN0aW9uYWxpdHksIHlvdSBoYXZlIHRvIHdoaXRlbGlzdCB5b3VyIGFwcCdzIG9yaWdpbiBpbiB5b3VyXG4gKiBDbG91ZCBTdG9yYWdlIGJ1Y2tldC4gU2VlIGFsc29cbiAqIGh0dHBzOi8vY2xvdWQuZ29vZ2xlLmNvbS9zdG9yYWdlL2RvY3MvY29uZmlndXJpbmctY29yc1xuICpcbiAqIFRoaXMgQVBJIGlzIG5vdCBhdmFpbGFibGUgaW4gTm9kZS5cbiAqXG4gKiBAcHVibGljXG4gKiBAcGFyYW0gcmVmIC0gU3RvcmFnZVJlZmVyZW5jZSB3aGVyZSBkYXRhIHNob3VsZCBiZSBkb3dubG9hZGVkLlxuICogQHBhcmFtIG1heERvd25sb2FkU2l6ZUJ5dGVzIC0gSWYgc2V0LCB0aGUgbWF4aW11bSBhbGxvd2VkIHNpemUgaW4gYnl0ZXMgdG9cbiAqIHJldHJpZXZlLlxuICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCBhIEJsb2IgY29udGFpbmluZyB0aGUgb2JqZWN0J3MgYnl0ZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEJsb2IoXG4gIHJlZjogU3RvcmFnZVJlZmVyZW5jZSxcbiAgbWF4RG93bmxvYWRTaXplQnl0ZXM/OiBudW1iZXJcbik6IFByb21pc2U8QmxvYj4ge1xuICByZWYgPSBnZXRNb2R1bGFySW5zdGFuY2UocmVmKTtcbiAgcmV0dXJuIGdldEJsb2JJbnRlcm5hbChyZWYgYXMgUmVmZXJlbmNlLCBtYXhEb3dubG9hZFNpemVCeXRlcyk7XG59XG5cbi8qKlxuICogRG93bmxvYWRzIHRoZSBkYXRhIGF0IHRoZSBvYmplY3QncyBsb2NhdGlvbi4gUmFpc2VzIGFuIGVycm9yIGV2ZW50IGlmIHRoZVxuICogb2JqZWN0IGlzIG5vdCBmb3VuZC5cbiAqXG4gKiBUaGlzIEFQSSBpcyBvbmx5IGF2YWlsYWJsZSBpbiBOb2RlLlxuICpcbiAqIEBwdWJsaWNcbiAqIEBwYXJhbSByZWYgLSBTdG9yYWdlUmVmZXJlbmNlIHdoZXJlIGRhdGEgc2hvdWxkIGJlIGRvd25sb2FkZWQuXG4gKiBAcGFyYW0gbWF4RG93bmxvYWRTaXplQnl0ZXMgLSBJZiBzZXQsIHRoZSBtYXhpbXVtIGFsbG93ZWQgc2l6ZSBpbiBieXRlcyB0b1xuICogcmV0cmlldmUuXG4gKiBAcmV0dXJucyBBIHN0cmVhbSB3aXRoIHRoZSBvYmplY3QncyBkYXRhIGFzIGJ5dGVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdHJlYW0oXG4gIHJlZjogU3RvcmFnZVJlZmVyZW5jZSxcbiAgbWF4RG93bmxvYWRTaXplQnl0ZXM/OiBudW1iZXJcbik6IE5vZGVKUy5SZWFkYWJsZVN0cmVhbSB7XG4gIHRocm93IG5ldyBFcnJvcignZ2V0U3RyZWFtKCkgaXMgb25seSBzdXBwb3J0ZWQgYnkgTm9kZUpTIGJ1aWxkcycpO1xufVxuIiwgIi8qKlxuICogQ2xvdWQgU3RvcmFnZSBmb3IgRmlyZWJhc2VcbiAqXG4gKiBAcGFja2FnZURvY3VtZW50YXRpb25cbiAqL1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby1leHRyYW5lb3VzLWRlcGVuZGVuY2llc1xuaW1wb3J0IHtcbiAgX3JlZ2lzdGVyQ29tcG9uZW50LFxuICByZWdpc3RlclZlcnNpb24sXG4gIFNES19WRVJTSU9OXG59IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuXG5pbXBvcnQgeyBGaXJlYmFzZVN0b3JhZ2VJbXBsIH0gZnJvbSAnLi4vc3JjL3NlcnZpY2UnO1xuaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBDb21wb25lbnRUeXBlLFxuICBDb21wb25lbnRDb250YWluZXIsXG4gIEluc3RhbmNlRmFjdG9yeU9wdGlvbnNcbn0gZnJvbSAnQGZpcmViYXNlL2NvbXBvbmVudCc7XG5cbmltcG9ydCB7IG5hbWUsIHZlcnNpb24gfSBmcm9tICcuLi9wYWNrYWdlLmpzb24nO1xuXG5pbXBvcnQgeyBGaXJlYmFzZVN0b3JhZ2UgfSBmcm9tICcuL3B1YmxpYy10eXBlcyc7XG5pbXBvcnQgeyBTVE9SQUdFX1RZUEUgfSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbmV4cG9ydCAqIGZyb20gJy4vYXBpJztcbmV4cG9ydCAqIGZyb20gJy4vYXBpLmJyb3dzZXInO1xuXG5mdW5jdGlvbiBmYWN0b3J5KFxuICBjb250YWluZXI6IENvbXBvbmVudENvbnRhaW5lcixcbiAgeyBpbnN0YW5jZUlkZW50aWZpZXI6IHVybCB9OiBJbnN0YW5jZUZhY3RvcnlPcHRpb25zXG4pOiBGaXJlYmFzZVN0b3JhZ2Uge1xuICBjb25zdCBhcHAgPSBjb250YWluZXIuZ2V0UHJvdmlkZXIoJ2FwcCcpLmdldEltbWVkaWF0ZSgpO1xuICBjb25zdCBhdXRoUHJvdmlkZXIgPSBjb250YWluZXIuZ2V0UHJvdmlkZXIoJ2F1dGgtaW50ZXJuYWwnKTtcbiAgY29uc3QgYXBwQ2hlY2tQcm92aWRlciA9IGNvbnRhaW5lci5nZXRQcm92aWRlcignYXBwLWNoZWNrLWludGVybmFsJyk7XG5cbiAgcmV0dXJuIG5ldyBGaXJlYmFzZVN0b3JhZ2VJbXBsKFxuICAgIGFwcCxcbiAgICBhdXRoUHJvdmlkZXIsXG4gICAgYXBwQ2hlY2tQcm92aWRlcixcbiAgICB1cmwsXG4gICAgU0RLX1ZFUlNJT05cbiAgKTtcbn1cblxuZnVuY3Rpb24gcmVnaXN0ZXJTdG9yYWdlKCk6IHZvaWQge1xuICBfcmVnaXN0ZXJDb21wb25lbnQoXG4gICAgbmV3IENvbXBvbmVudChcbiAgICAgIFNUT1JBR0VfVFlQRSxcbiAgICAgIGZhY3RvcnksXG4gICAgICBDb21wb25lbnRUeXBlLlBVQkxJQ1xuICAgICkuc2V0TXVsdGlwbGVJbnN0YW5jZXModHJ1ZSlcbiAgKTtcbiAgLy9SVU5USU1FX0VOViB3aWxsIGJlIHJlcGxhY2VkIGR1cmluZyB0aGUgY29tcGlsYXRpb24gdG8gXCJub2RlXCIgZm9yIG5vZGVqcyBhbmQgYW4gZW1wdHkgc3RyaW5nIGZvciBicm93c2VyXG4gIHJlZ2lzdGVyVmVyc2lvbihuYW1lLCB2ZXJzaW9uLCAnX19SVU5USU1FX0VOVl9fJyk7XG4gIC8vIEJVSUxEX1RBUkdFVCB3aWxsIGJlIHJlcGxhY2VkIGJ5IHZhbHVlcyBsaWtlIGVzbTUsIGVzbTIwMTcsIGNqczUsIGV0YyBkdXJpbmcgdGhlIGNvbXBpbGF0aW9uXG4gIHJlZ2lzdGVyVmVyc2lvbihuYW1lLCB2ZXJzaW9uLCAnX19CVUlMRF9UQVJHRVRfXycpO1xufVxuXG5yZWdpc3RlclN0b3JhZ2UoKTtcbiIsICJpbXBvcnQgeyBOb3RpY2UsIFRGaWxlLCBURm9sZGVyLCBWYXVsdCB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgU3RvcmFnZVJlZmVyZW5jZSwgZ2V0RG93bmxvYWRVUkwsIHJlZiwgdXBsb2FkQnl0ZXNSZXN1bWFibGUsIExpc3RSZXN1bHQsIGxpc3RBbGwsIGRlbGV0ZU9iamVjdCB9IGZyb20gJ2ZpcmViYXNlL3N0b3JhZ2UnO1xyXG5pbXBvcnQgRmxpbnRQbHVnaW4gZnJvbSAnbWFpbic7XHJcblxyXG5pbXBvcnQgeyByZW1vdGVWYXVsdE5hbWUgfSBmcm9tICdtYWluJztcclxuaW1wb3J0IHsgc3RvcmFnZSwgdmF1bHRSZWYgfSBmcm9tICdmaXJlYmFzZS10b29scyc7XHJcbmltcG9ydCB7IEZsaW50UGx1Z2luU2V0dGluZ3MgfSBmcm9tICdmbGludC1zZXR0aW5ncyc7XHJcbi8vIFJlbWVtYmVyIHRvIHJlbmFtZSB0aGVzZSBjbGFzc2VzIGFuZCBpbnRlcmZhY2VzIVxyXG4vLyBJbXBvcnQgdGhlIGZ1bmN0aW9ucyB5b3UgbmVlZCBmcm9tIHRoZSBTREtzIHlvdSBuZWVkXHJcblxyXG5leHBvcnQgY2xhc3MgRmxpbnREYXRhVHJhbnNmZXIgIHtcclxuXHRwbHVnaW46IEZsaW50UGx1Z2luO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IEZsaW50UGx1Z2luKXtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHQvLyNyZWdpb24gVXBsb2FkL0Rvd25sb2FkIEZpbGVzXHJcblxyXG5cdGFzeW5jIGRlbGV0ZUZpbGUocmVtb3RlVmF1bHRGaWxlTGlzdDogTGlzdFJlc3VsdCkge1xyXG5cdFx0Ly9kZWxldGVzIGFsbCBmaWxlcyBpbiB0aGlzIGRpciBhbmQgaW4gY2hpbGRyZW4gZGlyc1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgcmVtb3RlVmF1bHRGaWxlTGlzdC5pdGVtcy5sZW5ndGg7IGkrKyl7XHJcblx0XHRcdGNvbnN0IGRlbGV0ZVJlZjogU3RvcmFnZVJlZmVyZW5jZSA9IHJlZihzdG9yYWdlLCByZW1vdGVWYXVsdEZpbGVMaXN0Lml0ZW1zW2ldLmZ1bGxQYXRoKTtcclxuXHRcdFx0ZGVsZXRlT2JqZWN0KGRlbGV0ZVJlZik7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYocmVtb3RlVmF1bHRGaWxlTGlzdC5wcmVmaXhlcy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdGZvcihsZXQgeCA9IDA7IHggPCByZW1vdGVWYXVsdEZpbGVMaXN0LnByZWZpeGVzLmxlbmd0aDsgeCsrKXtcclxuXHRcdFx0XHRjb25zdCBsb2NhbEZvbGRlcnMgPSBhd2FpdCBsaXN0QWxsKHJlbW90ZVZhdWx0RmlsZUxpc3QucHJlZml4ZXNbeF0pO1xyXG5cdFx0XHRcdHRoaXMuZGVsZXRlRmlsZShsb2NhbEZvbGRlcnMpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHRcclxuXHR9XHJcblxyXG5cdGFzeW5jIGNsZWFyUmVtb3RlVmF1bHQoc2V0dGluZ3M6IEZsaW50UGx1Z2luU2V0dGluZ3MgKSB7XHJcblx0XHRjb25zdCByZW1vdGVWYXVsdE5hbWU6IHN0cmluZyA9IHNldHRpbmdzLnJlbW90ZUNvbm5lY3RlZFZhdWx0O1xyXG5cclxuXHRcdGlmIChyZW1vdGVWYXVsdE5hbWUpe1xyXG5cdFx0XHRjb25zdCByZW1vdGVWYXVsdFJlZjogU3RvcmFnZVJlZmVyZW5jZSA9IHJlZih2YXVsdFJlZiwgYCR7cmVtb3RlVmF1bHROYW1lfWApO1xyXG5cdFx0XHRjb25zdCByZW1vdGVWYXVsdEZpbGVMaXN0OiBMaXN0UmVzdWx0ID0gYXdhaXQgbGlzdEFsbChyZW1vdGVWYXVsdFJlZik7XHJcblx0XHRcdGF3YWl0IHRoaXMuZGVsZXRlRmlsZShyZW1vdGVWYXVsdEZpbGVMaXN0KVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YXN5bmMgZm9yY2VVcGxvYWRGaWxlcyh2YXVsdDogVmF1bHQsIHNldHRpbmdzOiBGbGludFBsdWdpblNldHRpbmdzKSB7XHJcblx0XHR0aGlzLmNsZWFyUmVtb3RlVmF1bHQoc2V0dGluZ3MpLnRoZW4oXHJcblx0XHRcdCh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGZpbGVzID0gdmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZmlsZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdHRoaXMudXBsb2FkRmlsZShmaWxlcywgaSk7XHJcblx0XHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyb3J9YCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVx0XHJcblx0XHRcdH1cclxuXHRcdCk7XHJcblx0XHRcdFx0XHJcblxyXG5cdH1cclxuXHJcblx0YXN5bmMgdXBsb2FkRmlsZShmaWxlczogVEZpbGVbXSwgaW5kZXg6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xyXG5cclxuXHJcblx0XHQvL1NlcXVlbnRpYWwgY2FsbHMgZm9yIHBhcmFtIGluZm9ybWF0aW9uXHJcblx0XHQvL0NoZWNrIGlmIGRlc3RpbmF0aW9uIGhhcyBiZWVuIHNldFxyXG5cdFx0aWYgKHJlbW90ZVZhdWx0TmFtZSAhPT0gJycpIHtcclxuXHRcdFx0Y29uc3QgcGF0aFN0cmluZzogc3RyaW5nID0gYXdhaXQgYCR7cmVtb3RlVmF1bHROYW1lfS8ke2ZpbGVzW2luZGV4XS5wYXRofWA7XHJcblx0XHRcdGNvbnN0IHBhdGhSZWY6IFN0b3JhZ2VSZWZlcmVuY2UgPSBhd2FpdCByZWYodmF1bHRSZWYsIHBhdGhTdHJpbmcpO1xyXG5cdFx0XHRjb25zdCBkYXRhOiBBcnJheUJ1ZmZlciA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyLnJlYWRCaW5hcnkoZmlsZXNbaW5kZXhdLnBhdGgpO1xyXG5cclxuXHRcdFx0Ly9mZWVkIHBhcmFtcyBpbnRvIHVwbG9hZCBmdW5jIGZyb20gZmlyZWJhc2VcclxuXHRcdFx0Ly9jb25zdCByZW1vdGVWYXVsdFJlZjogU3RvcmFnZVJlZmVyZW5jZSA9IHJlZih2YXVsdFJlZiwgYCR7cmVtb3RlVmF1bHROYW1lfWApO1xyXG5cdFx0XHQvL2NvbnN0IHJlbW90ZVZhdWx0RmlsZUxpc3Q6IExpc3RSZXN1bHQgPSBhd2FpdCBsaXN0QWxsKHJlbW90ZVZhdWx0UmVmKTtcclxuXHRcdFx0Ly9jb25zdCBhbGxSZW1vdGVGaWxlc05hbWVzID0gYXdhaXQgZ2V0QWxsUmVtb3RlRmlsZXMocmVtb3RlVmF1bHRGaWxlTGlzdCwgW10pO1xyXG5cdFx0XHQvLyBjb25zdCBhbGxMb2NhbEZpbGVzOiBURmlsZVtdID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG5cdFx0XHQvLyBsZXQgYWxsTG9jYWxGaWxlTmFtZXM6c3RyaW5nW10gPSBbXTtcclxuXHJcblxyXG5cdFx0XHQvLyBmb3IobGV0IHkgPSAwOyB5IDwgYWxsTG9jYWxGaWxlcy5sZW5ndGg7IHkrKyApe1xyXG5cdFx0XHQvLyBcdGFsbExvY2FsRmlsZU5hbWVzLnB1c2goYWxsTG9jYWxGaWxlc1t5XS5uYW1lKTtcclxuXHRcdFx0Ly8gfVxyXG5cdFx0XHRcclxuXHJcblx0XHRcdC8vanVzdCBnaXZlIHVwIGFuZCB0cmFzaCBhbGwgcGF0aHMgYnJ1aFxyXG5cclxuXHRcdFx0Ly9jb25zdCBkaWZmZXJlbmNlID0gYWxsUmVtb3RlRmlsZXNOYW1lcy5maWx0ZXIoKGVsZW1lbnQpID0+ICFhbGxMb2NhbEZpbGVOYW1lcy5pbmNsdWRlcyhlbGVtZW50KSk7XHJcblx0XHRcdC8vdGhpcyBpcyB0ZXJyaWJseSBzbG93IGFuZCBJIHRoaW5rIGV4cG9uZW50aWFsIHRpbWUgY29tcCwgY2hhbmdlIHRvIGEgaGFzaG1hcCBhdCBzb21lIHBvaW50IHBsZWFzZVxyXG5cdFx0XHQvL3JlcGxhY2UgQUxMIG9mIHRoaXMgd2l0aCBKUyBPYmplY3RzIGluc3RlYWQgXHJcblxyXG5cdFx0XHRhd2FpdCB1cGxvYWRCeXRlc1Jlc3VtYWJsZShwYXRoUmVmLCBkYXRhKS50aGVuKChzbmFwc2hvdCkgPT4ge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKGBmaWxlICR7aW5kZXh9IHVwbG9hZGVkIHN1Y2Nlc3NmdWxseWApO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRuZXcgTm90aWNlKFwiQ2hvb3NlIGEgdGFyZ2V0IHZhdWx0IGRlc3RpbmF0aW9uIVwiKTtcclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRhc3luYyBpbXBvcnRWYXVsdChsb2NhbFZhdWx0OiBzdHJpbmcsIHJlbW90ZVZhdWx0OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRcdC8qKlxyXG5cdFx0ICogQHBhcmFtIGxvY2FsVmF1bHQgaXMgdGhlIHRhcmdldCBsb2NhbCB2YXVsdCB3aGVyZSBmaWxlcyB3aWxsIGJlIHdyaXR0ZW4gdG9cclxuXHRcdCAqL1xyXG5cdFx0bmV3IE5vdGljZShgUmVtb3RlIFZhdWx0OiAke3JlbW90ZVZhdWx0fWApO1xyXG5cdFx0Y29uc3QgcmVtb3RlVmF1bHRSZWY6IFN0b3JhZ2VSZWZlcmVuY2UgPSByZWYodmF1bHRSZWYsIGAke3JlbW90ZVZhdWx0fWApO1xyXG5cdFx0Y29uc3QgcmVtb3RlVmF1bHRGaWxlTGlzdDogTGlzdFJlc3VsdCA9IGF3YWl0IGxpc3RBbGwocmVtb3RlVmF1bHRSZWYpO1xyXG5cclxuXHRcdC8vcGFzcyBpbiBhbGwgZmlsZXMgYW5kIHByZWZpeGVzIChmb2xkZXJzKSBpbnRvIGRvd25sb2FkIGZ1bmN0aW9uLlxyXG5cdFx0dGhpcy5kb3dubG9hZFRvTG9jYWwobG9jYWxWYXVsdCwgcmVtb3RlVmF1bHRGaWxlTGlzdCk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBkb3dubG9hZFRvTG9jYWwobG9jYWxWYXVsdE5hbWU6IHN0cmluZywgcmVtb3RlRGlyRmlsZUxpc3Q6IExpc3RSZXN1bHQpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHJcblx0XHRjb25zdCB2YXVsdDogVmF1bHQgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQ7XHJcblxyXG5cdFx0aWYgKHJlbW90ZURpckZpbGVMaXN0LnByZWZpeGVzLmxlbmd0aCA+IDApIHtcclxuXHJcblx0XHRcdGZvciAobGV0IHggPSAwOyB4IDwgcmVtb3RlRGlyRmlsZUxpc3QucHJlZml4ZXMubGVuZ3RoOyB4KyspIHtcclxuXHRcdFx0XHRsZXQgcmVtb3RlRm9sZGVyUGF0aCA9IHJlbW90ZURpckZpbGVMaXN0LnByZWZpeGVzW3hdLmZ1bGxQYXRoLnNwbGl0KCcvJyk7XHJcblx0XHRcdFx0cmVtb3RlRm9sZGVyUGF0aCA9IHJlbW90ZUZvbGRlclBhdGguc2xpY2UoMik7XHJcblxyXG5cdFx0XHRcdGNvbnN0IGxvY2FsRm9sZGVyUGF0aDogc3RyaW5nID0gcmVtb3RlRm9sZGVyUGF0aC5qb2luKCcvJyk7XHJcblxyXG5cdFx0XHRcdGlmICh2YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobG9jYWxGb2xkZXJQYXRoKSkge1xyXG5cdFx0XHRcdFx0Ly9JdGVtIGV4aXN0cyBhbHJlYWR5XHJcblx0XHRcdFx0XHRjb25zdCBmaWxlT3JGb2xkZXIgPSB2YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobG9jYWxGb2xkZXJQYXRoKTtcclxuXHJcblx0XHRcdFx0XHRpZiAoZmlsZU9yRm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhgJHtmaWxlT3JGb2xkZXIubmFtZX0gRXhpc3RzYCk7XHJcblx0XHRcdFx0XHRcdC8vcmVuYW1lIGZvbGRlclxyXG5cdFx0XHRcdFx0XHQvL21vZGlmeSB0aGUgZm9sZGVyXHJcblx0XHRcdFx0XHRcdGNvbnN0IGxvY2FsZm9sZGVyID0gZmlsZU9yRm9sZGVyO1xyXG5cdFx0XHRcdFx0XHR2YXVsdC5yZW5hbWUobG9jYWxmb2xkZXIsIGxvY2FsRm9sZGVyUGF0aCk7XHJcblx0XHRcdFx0XHRcdC8vdGhpcy4uLmRvZXMgbm90aGluZy4uLmJvem9cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB2YXVsdC5jcmVhdGVGb2xkZXIobG9jYWxGb2xkZXJQYXRoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGNhdGNoIChlcnJvcikge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhlcnJvcik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjb25zdCBsb2NhbEZvbGRlcnMgPSBhd2FpdCBsaXN0QWxsKHJlbW90ZURpckZpbGVMaXN0LnByZWZpeGVzW3hdKTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnTG9vcGluZycpO1xyXG5cclxuXHRcdFx0XHR0aGlzLmRvd25sb2FkVG9Mb2NhbChsb2NhbFZhdWx0TmFtZSwgbG9jYWxGb2xkZXJzKTtcclxuXHRcdFx0XHQvL25hc3R5IHJlY3Vyc2lvblxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCByZW1vdGVEaXJGaWxlTGlzdC5pdGVtcy5sZW5ndGg7IGkrKykge1xyXG5cclxuXHRcdFx0bGV0IHJlbW90ZUZpbGVQYXRoID0gcmVtb3RlRGlyRmlsZUxpc3QuaXRlbXNbaV0uZnVsbFBhdGguc3BsaXQoJy8nKTtcclxuXHRcdFx0cmVtb3RlRmlsZVBhdGggPSByZW1vdGVGaWxlUGF0aC5zbGljZSgyKTtcclxuXHJcblxyXG5cdFx0XHRjb25zdCBsb2NhbEZpbGVQYXRoOiBzdHJpbmcgPSByZW1vdGVGaWxlUGF0aC5qb2luKCcvJyk7XHJcblx0XHRcdGNvbnN0IGZpbGU6IEFycmF5QnVmZmVyID0gYXdhaXQgdGhpcy5mZXRjaEZpbGUoYCR7cmVtb3RlRGlyRmlsZUxpc3QuaXRlbXNbaV19YCk7XHJcblxyXG5cclxuXHRcdFx0aWYgKHZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChsb2NhbEZpbGVQYXRoKSkge1xyXG5cdFx0XHRcdC8vSXRlbSBleGlzdHMgYWxyZWFkeVxyXG5cdFx0XHRcdGNvbnN0IGZpbGVPckZvbGRlciA9IHZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChsb2NhbEZpbGVQYXRoKTtcclxuXHRcdFx0XHQvL25lc3QgbW9kaWZpY2F0aW9uIGZ1bmN0aW9uc1xyXG5cclxuXHJcblx0XHRcdFx0aWYgKGZpbGVPckZvbGRlciBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhgJHtmaWxlT3JGb2xkZXIubmFtZX0gRXhpc3RzYCk7XHJcblx0XHRcdFx0XHRjb25zdCBsb2NhbGZpbGUgPSBmaWxlT3JGb2xkZXI7XHJcblx0XHRcdFx0XHR2YXVsdC5tb2RpZnlCaW5hcnkobG9jYWxmaWxlLCBmaWxlKTtcclxuXHJcblx0XHRcdFx0XHQvLyBhd2FpdCB2YXVsdC5wcm9jZXNzKGxvY2FsZmlsZSwgKGRhdGEpID0+IHtcclxuXHRcdFx0XHRcdC8vIFx0Ly91c2UgQVBJIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvZGlmZi1tYXRjaC1wYXRjaC93aWtpL0FQSSB0byBmaW5kIGRpZmZzIGFuZCBldmVudHVhbGx5IHNob3cgdGhlIHVzZXIgYmVmb3JlIG1vZGlmeWluZyB0aGUgdGV4dCBjb21wbGV0ZWx5XHJcblx0XHRcdFx0XHQvLyBcdGNvbnN0IG5ld0RhdGEgPSBmaWxlO1xyXG5cdFx0XHRcdFx0Ly8gXHRyZXR1cm4gZGF0YS5yZXBsYWNlKCcnLCcnKTtcclxuXHRcdFx0XHRcdC8vIH0pXHJcblxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHQvL2ZpbGUgZG9lc250IGV4aXN0IHlldC4gXHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGBXcml0dGluZyBGaWxlIFBhdGggZnJvbTogJHtyZW1vdGVEaXJGaWxlTGlzdC5pdGVtc1tpXX0gdG8gbG9jYWwgcGF0aCAke2xvY2FsRmlsZVBhdGh9YCk7XHJcblx0XHRcdFx0XHRhd2FpdCB2YXVsdC5jcmVhdGVCaW5hcnkobG9jYWxGaWxlUGF0aCwgZmlsZSk7XHJcblxyXG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblxyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2coZXJyb3IpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdGFzeW5jIGZldGNoRmlsZShmaWxlUGF0aFN0cmluZzogc3RyaW5nKTogUHJvbWlzZTxBcnJheUJ1ZmZlcj4ge1xyXG5cclxuXHRcdGNvbnN0IGZpbGVQYXRoUmVmOiBTdG9yYWdlUmVmZXJlbmNlID0gcmVmKHN0b3JhZ2UsIGZpbGVQYXRoU3RyaW5nKTtcclxuXHRcdGNvbnN0IGZpbGVVUkw6IHN0cmluZyA9IGF3YWl0IGdldERvd25sb2FkVVJMKGZpbGVQYXRoUmVmKTtcclxuXHRcdGNvbnNvbGUubG9nKGAke2ZpbGVVUkx9YCk7XHJcblxyXG5cdFx0Y29uc3QgcmV0dXJuZWRGaWxlID0gYXdhaXQgbmV3IFByb21pc2U8QXJyYXlCdWZmZXI+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuXHRcdFx0Y29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcblx0XHRcdHhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xyXG5cdFx0XHR4aHIub25sb2FkID0gKGV2ZW50KSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgcmV0dXJuZWRGaWxlOiBBcnJheUJ1ZmZlciA9IHhoci5yZXNwb25zZTtcclxuXHRcdFx0XHRyZXNvbHZlKHJldHVybmVkRmlsZSk7XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHR4aHIub3BlbignR0VUJywgZmlsZVVSTCk7XHJcblx0XHRcdHhoci5zZW5kKCk7XHJcblx0XHR9KVxyXG5cclxuXHJcblx0XHRyZXR1cm4gYXdhaXQgcmV0dXJuZWRGaWxlO1xyXG5cdFx0Ly9wbGFjZSBmaWxlIGluIHRoZSBzYW1lIHBsYWNlIGFzIHRoZSBmaXJlYmFzZSBsb2NhdGlvbiBpbiB2YXVsdFxyXG5cdH1cclxuXHJcblxyXG5cdC8vI2VuZHJlZ2lvblxyXG59XHJcblxyXG4vLyBpbnRlcmZhY2UgRmxpbnRSZW1vdGVGaWxle1xyXG4vLyBcdG5hbWU6IHN0cmluZyxcclxuLy8gXHRwYXRoOiBzdHJpbmdcclxuLy8gfVxyXG4vLyBpbnRlcmZhY2UgRmxpbnRSZW1vdGVGaWxlTWFwIHtcclxuLy8gXHRbbmFtZTogc3RyaW5nXTogRmxpbnRSZW1vdGVGaWxlO1xyXG4vLyB9XHJcblxyXG5cclxuLy8gYXN5bmMgZnVuY3Rpb24gZ2V0QWxsUmVtb3RlRmlsZXMoZmlsZUxpc3Q6IExpc3RSZXN1bHQsIGRpckZpbGVOYW1lczogRmxpbnRSZW1vdGVGaWxlTWFwKTogUHJvbWlzZTxGbGludFJlbW90ZUZpbGVbXT4ge1xyXG5cclxuLy8gXHRmb3IgKGxldCBpID0gMDsgaSA8IGZpbGVMaXN0Lml0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbi8vIFx0XHRjb25zdCBuYW1lID0gZmlsZUxpc3QuaXRlbXNbaV0ubmFtZTtcclxuLy8gXHRcdGNvbnN0IHBhdGggPSBmaWxlTGlzdC5pdGVtc1tpXS5mdWxsUGF0aDtcclxuLy8gXHRcdGNvbnN0IGZpbGVPYmogOkZsaW50UmVtb3RlRmlsZSA9IHtuYW1lLCBwYXRofTsgXHJcbi8vIFx0XHRkaXJGaWxlTmFtZXNbZmlsZUxpc3QuaXRlbXNbaV0uZnVsbFBhdGhdID0gZmlsZU9iajtcclxuXHJcbi8vIFx0fVx0XHJcbi8vIFx0aWYgKGZpbGVMaXN0LnByZWZpeGVzLmxlbmd0aCA+IDApe1xyXG4vLyBcdFx0Zm9yIChsZXQgeCA9IDA7IHggPCBmaWxlTGlzdC5wcmVmaXhlcy5sZW5ndGg7IHgrKyl7XHJcbi8vIFx0XHRcdGNvbnN0IGxvY2FsRm9sZGVycyA9IGF3YWl0IGxpc3RBbGwoZmlsZUxpc3QucHJlZml4ZXNbeF0pO1xyXG4vLyBcdFx0XHRjb25zdCBmaWxlSW5Gb2xkZXIgPSBhd2FpdCBnZXRBbGxSZW1vdGVGaWxlcyhsb2NhbEZvbGRlcnMsIGRpckZpbGVOYW1lcyk7XHJcbi8vIFx0XHRcdGRpckZpbGVOYW1lcyA9IGRpckZpbGVOYW1lcy5jb25jYXQoZmlsZUluRm9sZGVyKTtcclxuLy8gXHRcdH1cclxuLy8gXHR9XHJcblxyXG4vLyBcdHJldHVybiBkaXJGaWxlTmFtZXM7XHJcbi8vIFx0Ly9yZXR1cm4gbWFwIG9mIGFsbCBmaWxlIG9ianNcclxuLy8gfSIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgcmVnaXN0ZXJWZXJzaW9uIH0gZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5pbXBvcnQgeyBuYW1lLCB2ZXJzaW9uIH0gZnJvbSAnLi4vcGFja2FnZS5qc29uJztcblxucmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sICdhcHAnKTtcbmV4cG9ydCAqIGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuIiwgIi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcclxuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XHJcbiAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn1cclxuXHJcbmV4cG9ydCB2YXIgX19hc3NpZ24gPSBmdW5jdGlvbigpIHtcclxuICAgIF9fYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBfX2Fzc2lnbih0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgcywgaSA9IDEsIG4gPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XHJcbiAgICAgICAgICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSkgdFtwXSA9IHNbcF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fYXNzaWduLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3Jlc3QocywgZSkge1xyXG4gICAgdmFyIHQgPSB7fTtcclxuICAgIGZvciAodmFyIHAgaW4gcykgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChzLCBwKSAmJiBlLmluZGV4T2YocCkgPCAwKVxyXG4gICAgICAgIHRbcF0gPSBzW3BdO1xyXG4gICAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDAgJiYgT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHMsIHBbaV0pKVxyXG4gICAgICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICAgICAgfVxyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2NyZWF0ZUJpbmRpbmcgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG0sIGspO1xyXG4gICAgaWYgKCFkZXNjIHx8IChcImdldFwiIGluIGRlc2MgPyAhbS5fX2VzTW9kdWxlIDogZGVzYy53cml0YWJsZSB8fCBkZXNjLmNvbmZpZ3VyYWJsZSkpIHtcclxuICAgICAgICBkZXNjID0geyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9O1xyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCBkZXNjKTtcclxufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBvW2syXSA9IG1ba107XHJcbn0pO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBvKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8sIHApKSBfX2NyZWF0ZUJpbmRpbmcobywgbSwgcCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/IFwiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS5cIiA6IFwiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbi8qKiBAZGVwcmVjYXRlZCAqL1xyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWRBcnJheXMoKSB7XHJcbiAgICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDtcclxuICAgIGZvciAodmFyIHIgPSBBcnJheShzKSwgayA9IDAsIGkgPSAwOyBpIDwgaWw7IGkrKylcclxuICAgICAgICBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKylcclxuICAgICAgICAgICAgcltrXSA9IGFbal07XHJcbiAgICByZXR1cm4gcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXkodG8sIGZyb20sIHBhY2spIHtcclxuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xyXG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xyXG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcclxufSkgOiBmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcclxuICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHN0YXRlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBnZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZWFkIHByaXZhdGUgbWVtYmVyIGZyb20gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiBraW5kID09PSBcIm1cIiA/IGYgOiBraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlcikgOiBmID8gZi52YWx1ZSA6IHN0YXRlLmdldChyZWNlaXZlcik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBzdGF0ZSwgdmFsdWUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcIm1cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgbWV0aG9kIGlzIG5vdCB3cml0YWJsZVwiKTtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIHNldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHdyaXRlIHByaXZhdGUgbWVtYmVyIHRvIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4gKGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyLCB2YWx1ZSkgOiBmID8gZi52YWx1ZSA9IHZhbHVlIDogc3RhdGUuc2V0KHJlY2VpdmVyLCB2YWx1ZSkpLCB2YWx1ZTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRJbihzdGF0ZSwgcmVjZWl2ZXIpIHtcclxuICAgIGlmIChyZWNlaXZlciA9PT0gbnVsbCB8fCAodHlwZW9mIHJlY2VpdmVyICE9PSBcIm9iamVjdFwiICYmIHR5cGVvZiByZWNlaXZlciAhPT0gXCJmdW5jdGlvblwiKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCB1c2UgJ2luJyBvcGVyYXRvciBvbiBub24tb2JqZWN0XCIpO1xyXG4gICAgcmV0dXJuIHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgPT09IHN0YXRlIDogc3RhdGUuaGFzKHJlY2VpdmVyKTtcclxufVxyXG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBBbiBlbnVtIG9mIGZhY3RvcnMgdGhhdCBtYXkgYmUgdXNlZCBmb3IgbXVsdGlmYWN0b3IgYXV0aGVudGljYXRpb24uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgRmFjdG9ySWQgPSB7XG4gIC8qKiBQaG9uZSBhcyBzZWNvbmQgZmFjdG9yICovXG4gIFBIT05FOiAncGhvbmUnLFxuICBUT1RQOiAndG90cCdcbn0gYXMgY29uc3Q7XG5cbi8qKlxuICogRW51bWVyYXRpb24gb2Ygc3VwcG9ydGVkIHByb3ZpZGVycy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjb25zdCBQcm92aWRlcklkID0ge1xuICAvKiogRmFjZWJvb2sgcHJvdmlkZXIgSUQgKi9cbiAgRkFDRUJPT0s6ICdmYWNlYm9vay5jb20nLFxuICAvKiogR2l0SHViIHByb3ZpZGVyIElEICovXG4gIEdJVEhVQjogJ2dpdGh1Yi5jb20nLFxuICAvKiogR29vZ2xlIHByb3ZpZGVyIElEICovXG4gIEdPT0dMRTogJ2dvb2dsZS5jb20nLFxuICAvKiogUGFzc3dvcmQgcHJvdmlkZXIgKi9cbiAgUEFTU1dPUkQ6ICdwYXNzd29yZCcsXG4gIC8qKiBQaG9uZSBwcm92aWRlciAqL1xuICBQSE9ORTogJ3Bob25lJyxcbiAgLyoqIFR3aXR0ZXIgcHJvdmlkZXIgSUQgKi9cbiAgVFdJVFRFUjogJ3R3aXR0ZXIuY29tJ1xufSBhcyBjb25zdDtcblxuLyoqXG4gKiBFbnVtZXJhdGlvbiBvZiBzdXBwb3J0ZWQgc2lnbi1pbiBtZXRob2RzLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IFNpZ25Jbk1ldGhvZCA9IHtcbiAgLyoqIEVtYWlsIGxpbmsgc2lnbiBpbiBtZXRob2QgKi9cbiAgRU1BSUxfTElOSzogJ2VtYWlsTGluaycsXG4gIC8qKiBFbWFpbC9wYXNzd29yZCBzaWduIGluIG1ldGhvZCAqL1xuICBFTUFJTF9QQVNTV09SRDogJ3Bhc3N3b3JkJyxcbiAgLyoqIEZhY2Vib29rIHNpZ24gaW4gbWV0aG9kICovXG4gIEZBQ0VCT09LOiAnZmFjZWJvb2suY29tJyxcbiAgLyoqIEdpdEh1YiBzaWduIGluIG1ldGhvZCAqL1xuICBHSVRIVUI6ICdnaXRodWIuY29tJyxcbiAgLyoqIEdvb2dsZSBzaWduIGluIG1ldGhvZCAqL1xuICBHT09HTEU6ICdnb29nbGUuY29tJyxcbiAgLyoqIFBob25lIHNpZ24gaW4gbWV0aG9kICovXG4gIFBIT05FOiAncGhvbmUnLFxuICAvKiogVHdpdHRlciBzaWduIGluIG1ldGhvZCAqL1xuICBUV0lUVEVSOiAndHdpdHRlci5jb20nXG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIEVudW1lcmF0aW9uIG9mIHN1cHBvcnRlZCBvcGVyYXRpb24gdHlwZXMuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgT3BlcmF0aW9uVHlwZSA9IHtcbiAgLyoqIE9wZXJhdGlvbiBpbnZvbHZpbmcgbGlua2luZyBhbiBhZGRpdGlvbmFsIHByb3ZpZGVyIHRvIGFuIGFscmVhZHkgc2lnbmVkLWluIHVzZXIuICovXG4gIExJTks6ICdsaW5rJyxcbiAgLyoqIE9wZXJhdGlvbiBpbnZvbHZpbmcgdXNpbmcgYSBwcm92aWRlciB0byByZWF1dGhlbnRpY2F0ZSBhbiBhbHJlYWR5IHNpZ25lZC1pbiB1c2VyLiAqL1xuICBSRUFVVEhFTlRJQ0FURTogJ3JlYXV0aGVudGljYXRlJyxcbiAgLyoqIE9wZXJhdGlvbiBpbnZvbHZpbmcgc2lnbmluZyBpbiBhIHVzZXIuICovXG4gIFNJR05fSU46ICdzaWduSW4nXG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIEFuIGVudW1lcmF0aW9uIG9mIHRoZSBwb3NzaWJsZSBlbWFpbCBhY3Rpb24gdHlwZXMuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgQWN0aW9uQ29kZU9wZXJhdGlvbiA9IHtcbiAgLyoqIFRoZSBlbWFpbCBsaW5rIHNpZ24taW4gYWN0aW9uLiAqL1xuICBFTUFJTF9TSUdOSU46ICdFTUFJTF9TSUdOSU4nLFxuICAvKiogVGhlIHBhc3N3b3JkIHJlc2V0IGFjdGlvbi4gKi9cbiAgUEFTU1dPUkRfUkVTRVQ6ICdQQVNTV09SRF9SRVNFVCcsXG4gIC8qKiBUaGUgZW1haWwgcmV2b2NhdGlvbiBhY3Rpb24uICovXG4gIFJFQ09WRVJfRU1BSUw6ICdSRUNPVkVSX0VNQUlMJyxcbiAgLyoqIFRoZSByZXZlcnQgc2Vjb25kIGZhY3RvciBhZGRpdGlvbiBlbWFpbCBhY3Rpb24uICovXG4gIFJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OOiAnUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT04nLFxuICAvKiogVGhlIHJldmVydCBzZWNvbmQgZmFjdG9yIGFkZGl0aW9uIGVtYWlsIGFjdGlvbi4gKi9cbiAgVkVSSUZZX0FORF9DSEFOR0VfRU1BSUw6ICdWRVJJRllfQU5EX0NIQU5HRV9FTUFJTCcsXG4gIC8qKiBUaGUgZW1haWwgdmVyaWZpY2F0aW9uIGFjdGlvbi4gKi9cbiAgVkVSSUZZX0VNQUlMOiAnVkVSSUZZX0VNQUlMJ1xufSBhcyBjb25zdDtcbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBdXRoRXJyb3JNYXAsIFVzZXIgfSBmcm9tICcuLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgRXJyb3JGYWN0b3J5LCBFcnJvck1hcCB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuaW1wb3J0IHsgSWRUb2tlbk1mYVJlc3BvbnNlIH0gZnJvbSAnLi4vYXBpL2F1dGhlbnRpY2F0aW9uL21mYSc7XG5pbXBvcnQgeyBBcHBOYW1lIH0gZnJvbSAnLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBBdXRoQ3JlZGVudGlhbCB9IGZyb20gJy4vY3JlZGVudGlhbHMnO1xuXG4vKipcbiAqIEVudW1lcmF0aW9uIG9mIEZpcmViYXNlIEF1dGggZXJyb3IgY29kZXMuXG4gKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBjb25zdCBlbnVtIEF1dGhFcnJvckNvZGUge1xuICBBRE1JTl9PTkxZX09QRVJBVElPTiA9ICdhZG1pbi1yZXN0cmljdGVkLW9wZXJhdGlvbicsXG4gIEFSR1VNRU5UX0VSUk9SID0gJ2FyZ3VtZW50LWVycm9yJyxcbiAgQVBQX05PVF9BVVRIT1JJWkVEID0gJ2FwcC1ub3QtYXV0aG9yaXplZCcsXG4gIEFQUF9OT1RfSU5TVEFMTEVEID0gJ2FwcC1ub3QtaW5zdGFsbGVkJyxcbiAgQ0FQVENIQV9DSEVDS19GQUlMRUQgPSAnY2FwdGNoYS1jaGVjay1mYWlsZWQnLFxuICBDT0RFX0VYUElSRUQgPSAnY29kZS1leHBpcmVkJyxcbiAgQ09SRE9WQV9OT1RfUkVBRFkgPSAnY29yZG92YS1ub3QtcmVhZHknLFxuICBDT1JTX1VOU1VQUE9SVEVEID0gJ2NvcnMtdW5zdXBwb3J0ZWQnLFxuICBDUkVERU5USUFMX0FMUkVBRFlfSU5fVVNFID0gJ2NyZWRlbnRpYWwtYWxyZWFkeS1pbi11c2UnLFxuICBDUkVERU5USUFMX01JU01BVENIID0gJ2N1c3RvbS10b2tlbi1taXNtYXRjaCcsXG4gIENSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTiA9ICdyZXF1aXJlcy1yZWNlbnQtbG9naW4nLFxuICBERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEggPSAnZGVwZW5kZW50LXNkay1pbml0aWFsaXplZC1iZWZvcmUtYXV0aCcsXG4gIERZTkFNSUNfTElOS19OT1RfQUNUSVZBVEVEID0gJ2R5bmFtaWMtbGluay1ub3QtYWN0aXZhdGVkJyxcbiAgRU1BSUxfQ0hBTkdFX05FRURTX1ZFUklGSUNBVElPTiA9ICdlbWFpbC1jaGFuZ2UtbmVlZHMtdmVyaWZpY2F0aW9uJyxcbiAgRU1BSUxfRVhJU1RTID0gJ2VtYWlsLWFscmVhZHktaW4tdXNlJyxcbiAgRU1VTEFUT1JfQ09ORklHX0ZBSUxFRCA9ICdlbXVsYXRvci1jb25maWctZmFpbGVkJyxcbiAgRVhQSVJFRF9PT0JfQ09ERSA9ICdleHBpcmVkLWFjdGlvbi1jb2RlJyxcbiAgRVhQSVJFRF9QT1BVUF9SRVFVRVNUID0gJ2NhbmNlbGxlZC1wb3B1cC1yZXF1ZXN0JyxcbiAgSU5URVJOQUxfRVJST1IgPSAnaW50ZXJuYWwtZXJyb3InLFxuICBJTlZBTElEX0FQSV9LRVkgPSAnaW52YWxpZC1hcGkta2V5JyxcbiAgSU5WQUxJRF9BUFBfQ1JFREVOVElBTCA9ICdpbnZhbGlkLWFwcC1jcmVkZW50aWFsJyxcbiAgSU5WQUxJRF9BUFBfSUQgPSAnaW52YWxpZC1hcHAtaWQnLFxuICBJTlZBTElEX0FVVEggPSAnaW52YWxpZC11c2VyLXRva2VuJyxcbiAgSU5WQUxJRF9BVVRIX0VWRU5UID0gJ2ludmFsaWQtYXV0aC1ldmVudCcsXG4gIElOVkFMSURfQ0VSVF9IQVNIID0gJ2ludmFsaWQtY2VydC1oYXNoJyxcbiAgSU5WQUxJRF9DT0RFID0gJ2ludmFsaWQtdmVyaWZpY2F0aW9uLWNvZGUnLFxuICBJTlZBTElEX0NPTlRJTlVFX1VSSSA9ICdpbnZhbGlkLWNvbnRpbnVlLXVyaScsXG4gIElOVkFMSURfQ09SRE9WQV9DT05GSUdVUkFUSU9OID0gJ2ludmFsaWQtY29yZG92YS1jb25maWd1cmF0aW9uJyxcbiAgSU5WQUxJRF9DVVNUT01fVE9LRU4gPSAnaW52YWxpZC1jdXN0b20tdG9rZW4nLFxuICBJTlZBTElEX0RZTkFNSUNfTElOS19ET01BSU4gPSAnaW52YWxpZC1keW5hbWljLWxpbmstZG9tYWluJyxcbiAgSU5WQUxJRF9FTUFJTCA9ICdpbnZhbGlkLWVtYWlsJyxcbiAgSU5WQUxJRF9FTVVMQVRPUl9TQ0hFTUUgPSAnaW52YWxpZC1lbXVsYXRvci1zY2hlbWUnLFxuICBJTlZBTElEX0lEUF9SRVNQT05TRSA9ICdpbnZhbGlkLWNyZWRlbnRpYWwnLFxuICBJTlZBTElEX01FU1NBR0VfUEFZTE9BRCA9ICdpbnZhbGlkLW1lc3NhZ2UtcGF5bG9hZCcsXG4gIElOVkFMSURfTUZBX1NFU1NJT04gPSAnaW52YWxpZC1tdWx0aS1mYWN0b3Itc2Vzc2lvbicsXG4gIElOVkFMSURfT0FVVEhfQ0xJRU5UX0lEID0gJ2ludmFsaWQtb2F1dGgtY2xpZW50LWlkJyxcbiAgSU5WQUxJRF9PQVVUSF9QUk9WSURFUiA9ICdpbnZhbGlkLW9hdXRoLXByb3ZpZGVyJyxcbiAgSU5WQUxJRF9PT0JfQ09ERSA9ICdpbnZhbGlkLWFjdGlvbi1jb2RlJyxcbiAgSU5WQUxJRF9PUklHSU4gPSAndW5hdXRob3JpemVkLWRvbWFpbicsXG4gIElOVkFMSURfUEFTU1dPUkQgPSAnd3JvbmctcGFzc3dvcmQnLFxuICBJTlZBTElEX1BFUlNJU1RFTkNFID0gJ2ludmFsaWQtcGVyc2lzdGVuY2UtdHlwZScsXG4gIElOVkFMSURfUEhPTkVfTlVNQkVSID0gJ2ludmFsaWQtcGhvbmUtbnVtYmVyJyxcbiAgSU5WQUxJRF9QUk9WSURFUl9JRCA9ICdpbnZhbGlkLXByb3ZpZGVyLWlkJyxcbiAgSU5WQUxJRF9SRUNJUElFTlRfRU1BSUwgPSAnaW52YWxpZC1yZWNpcGllbnQtZW1haWwnLFxuICBJTlZBTElEX1NFTkRFUiA9ICdpbnZhbGlkLXNlbmRlcicsXG4gIElOVkFMSURfU0VTU0lPTl9JTkZPID0gJ2ludmFsaWQtdmVyaWZpY2F0aW9uLWlkJyxcbiAgSU5WQUxJRF9URU5BTlRfSUQgPSAnaW52YWxpZC10ZW5hbnQtaWQnLFxuICBMT0dJTl9CTE9DS0VEID0gJ2xvZ2luLWJsb2NrZWQnLFxuICBNRkFfSU5GT19OT1RfRk9VTkQgPSAnbXVsdGktZmFjdG9yLWluZm8tbm90LWZvdW5kJyxcbiAgTUZBX1JFUVVJUkVEID0gJ211bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkJyxcbiAgTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRSA9ICdtaXNzaW5nLWFuZHJvaWQtcGtnLW5hbWUnLFxuICBNSVNTSU5HX0FQUF9DUkVERU5USUFMID0gJ21pc3NpbmctYXBwLWNyZWRlbnRpYWwnLFxuICBNSVNTSU5HX0FVVEhfRE9NQUlOID0gJ2F1dGgtZG9tYWluLWNvbmZpZy1yZXF1aXJlZCcsXG4gIE1JU1NJTkdfQ09ERSA9ICdtaXNzaW5nLXZlcmlmaWNhdGlvbi1jb2RlJyxcbiAgTUlTU0lOR19DT05USU5VRV9VUkkgPSAnbWlzc2luZy1jb250aW51ZS11cmknLFxuICBNSVNTSU5HX0lGUkFNRV9TVEFSVCA9ICdtaXNzaW5nLWlmcmFtZS1zdGFydCcsXG4gIE1JU1NJTkdfSU9TX0JVTkRMRV9JRCA9ICdtaXNzaW5nLWlvcy1idW5kbGUtaWQnLFxuICBNSVNTSU5HX09SX0lOVkFMSURfTk9OQ0UgPSAnbWlzc2luZy1vci1pbnZhbGlkLW5vbmNlJyxcbiAgTUlTU0lOR19NRkFfSU5GTyA9ICdtaXNzaW5nLW11bHRpLWZhY3Rvci1pbmZvJyxcbiAgTUlTU0lOR19NRkFfU0VTU0lPTiA9ICdtaXNzaW5nLW11bHRpLWZhY3Rvci1zZXNzaW9uJyxcbiAgTUlTU0lOR19QSE9ORV9OVU1CRVIgPSAnbWlzc2luZy1waG9uZS1udW1iZXInLFxuICBNSVNTSU5HX1BBU1NXT1JEID0gJ21pc3NpbmctcGFzc3dvcmQnLFxuICBNSVNTSU5HX1NFU1NJT05fSU5GTyA9ICdtaXNzaW5nLXZlcmlmaWNhdGlvbi1pZCcsXG4gIE1PRFVMRV9ERVNUUk9ZRUQgPSAnYXBwLWRlbGV0ZWQnLFxuICBORUVEX0NPTkZJUk1BVElPTiA9ICdhY2NvdW50LWV4aXN0cy13aXRoLWRpZmZlcmVudC1jcmVkZW50aWFsJyxcbiAgTkVUV09SS19SRVFVRVNUX0ZBSUxFRCA9ICduZXR3b3JrLXJlcXVlc3QtZmFpbGVkJyxcbiAgTlVMTF9VU0VSID0gJ251bGwtdXNlcicsXG4gIE5PX0FVVEhfRVZFTlQgPSAnbm8tYXV0aC1ldmVudCcsXG4gIE5PX1NVQ0hfUFJPVklERVIgPSAnbm8tc3VjaC1wcm92aWRlcicsXG4gIE9QRVJBVElPTl9OT1RfQUxMT1dFRCA9ICdvcGVyYXRpb24tbm90LWFsbG93ZWQnLFxuICBPUEVSQVRJT05fTk9UX1NVUFBPUlRFRCA9ICdvcGVyYXRpb24tbm90LXN1cHBvcnRlZC1pbi10aGlzLWVudmlyb25tZW50JyxcbiAgUE9QVVBfQkxPQ0tFRCA9ICdwb3B1cC1ibG9ja2VkJyxcbiAgUE9QVVBfQ0xPU0VEX0JZX1VTRVIgPSAncG9wdXAtY2xvc2VkLWJ5LXVzZXInLFxuICBQUk9WSURFUl9BTFJFQURZX0xJTktFRCA9ICdwcm92aWRlci1hbHJlYWR5LWxpbmtlZCcsXG4gIFFVT1RBX0VYQ0VFREVEID0gJ3F1b3RhLWV4Y2VlZGVkJyxcbiAgUkVESVJFQ1RfQ0FOQ0VMTEVEX0JZX1VTRVIgPSAncmVkaXJlY3QtY2FuY2VsbGVkLWJ5LXVzZXInLFxuICBSRURJUkVDVF9PUEVSQVRJT05fUEVORElORyA9ICdyZWRpcmVjdC1vcGVyYXRpb24tcGVuZGluZycsXG4gIFJFSkVDVEVEX0NSRURFTlRJQUwgPSAncmVqZWN0ZWQtY3JlZGVudGlhbCcsXG4gIFNFQ09ORF9GQUNUT1JfQUxSRUFEWV9FTlJPTExFRCA9ICdzZWNvbmQtZmFjdG9yLWFscmVhZHktaW4tdXNlJyxcbiAgU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRCA9ICdtYXhpbXVtLXNlY29uZC1mYWN0b3ItY291bnQtZXhjZWVkZWQnLFxuICBURU5BTlRfSURfTUlTTUFUQ0ggPSAndGVuYW50LWlkLW1pc21hdGNoJyxcbiAgVElNRU9VVCA9ICd0aW1lb3V0JyxcbiAgVE9LRU5fRVhQSVJFRCA9ICd1c2VyLXRva2VuLWV4cGlyZWQnLFxuICBUT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVIgPSAndG9vLW1hbnktcmVxdWVzdHMnLFxuICBVTkFVVEhPUklaRURfRE9NQUlOID0gJ3VuYXV0aG9yaXplZC1jb250aW51ZS11cmknLFxuICBVTlNVUFBPUlRFRF9GSVJTVF9GQUNUT1IgPSAndW5zdXBwb3J0ZWQtZmlyc3QtZmFjdG9yJyxcbiAgVU5TVVBQT1JURURfUEVSU0lTVEVOQ0UgPSAndW5zdXBwb3J0ZWQtcGVyc2lzdGVuY2UtdHlwZScsXG4gIFVOU1VQUE9SVEVEX1RFTkFOVF9PUEVSQVRJT04gPSAndW5zdXBwb3J0ZWQtdGVuYW50LW9wZXJhdGlvbicsXG4gIFVOVkVSSUZJRURfRU1BSUwgPSAndW52ZXJpZmllZC1lbWFpbCcsXG4gIFVTRVJfQ0FOQ0VMTEVEID0gJ3VzZXItY2FuY2VsbGVkJyxcbiAgVVNFUl9ERUxFVEVEID0gJ3VzZXItbm90LWZvdW5kJyxcbiAgVVNFUl9ESVNBQkxFRCA9ICd1c2VyLWRpc2FibGVkJyxcbiAgVVNFUl9NSVNNQVRDSCA9ICd1c2VyLW1pc21hdGNoJyxcbiAgVVNFUl9TSUdORURfT1VUID0gJ3VzZXItc2lnbmVkLW91dCcsXG4gIFdFQUtfUEFTU1dPUkQgPSAnd2Vhay1wYXNzd29yZCcsXG4gIFdFQl9TVE9SQUdFX1VOU1VQUE9SVEVEID0gJ3dlYi1zdG9yYWdlLXVuc3VwcG9ydGVkJyxcbiAgQUxSRUFEWV9JTklUSUFMSVpFRCA9ICdhbHJlYWR5LWluaXRpYWxpemVkJyxcbiAgUkVDQVBUQ0hBX05PVF9FTkFCTEVEID0gJ3JlY2FwdGNoYS1ub3QtZW5hYmxlZCcsXG4gIE1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOID0gJ21pc3NpbmctcmVjYXB0Y2hhLXRva2VuJyxcbiAgSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU4gPSAnaW52YWxpZC1yZWNhcHRjaGEtdG9rZW4nLFxuICBJTlZBTElEX1JFQ0FQVENIQV9BQ1RJT04gPSAnaW52YWxpZC1yZWNhcHRjaGEtYWN0aW9uJyxcbiAgTUlTU0lOR19DTElFTlRfVFlQRSA9ICdtaXNzaW5nLWNsaWVudC10eXBlJyxcbiAgTUlTU0lOR19SRUNBUFRDSEFfVkVSU0lPTiA9ICdtaXNzaW5nLXJlY2FwdGNoYS12ZXJzaW9uJyxcbiAgSU5WQUxJRF9SRUNBUFRDSEFfVkVSU0lPTiA9ICdpbnZhbGlkLXJlY2FwdGNoYS12ZXJzaW9uJyxcbiAgSU5WQUxJRF9SRVFfVFlQRSA9ICdpbnZhbGlkLXJlcS10eXBlJ1xufVxuXG5mdW5jdGlvbiBfZGVidWdFcnJvck1hcCgpOiBFcnJvck1hcDxBdXRoRXJyb3JDb2RlPiB7XG4gIHJldHVybiB7XG4gICAgW0F1dGhFcnJvckNvZGUuQURNSU5fT05MWV9PUEVSQVRJT05dOlxuICAgICAgJ1RoaXMgb3BlcmF0aW9uIGlzIHJlc3RyaWN0ZWQgdG8gYWRtaW5pc3RyYXRvcnMgb25seS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SXTogJycsXG4gICAgW0F1dGhFcnJvckNvZGUuQVBQX05PVF9BVVRIT1JJWkVEXTpcbiAgICAgIFwiVGhpcyBhcHAsIGlkZW50aWZpZWQgYnkgdGhlIGRvbWFpbiB3aGVyZSBpdCdzIGhvc3RlZCwgaXMgbm90IFwiICtcbiAgICAgICdhdXRob3JpemVkIHRvIHVzZSBGaXJlYmFzZSBBdXRoZW50aWNhdGlvbiB3aXRoIHRoZSBwcm92aWRlZCBBUEkga2V5LiAnICtcbiAgICAgICdSZXZpZXcgeW91ciBrZXkgY29uZmlndXJhdGlvbiBpbiB0aGUgR29vZ2xlIEFQSSBjb25zb2xlLicsXG4gICAgW0F1dGhFcnJvckNvZGUuQVBQX05PVF9JTlNUQUxMRURdOlxuICAgICAgJ1RoZSByZXF1ZXN0ZWQgbW9iaWxlIGFwcGxpY2F0aW9uIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGlkZW50aWZpZXIgKCcgK1xuICAgICAgJ0FuZHJvaWQgcGFja2FnZSBuYW1lIG9yIGlPUyBidW5kbGUgSUQpIHByb3ZpZGVkIGlzIG5vdCBpbnN0YWxsZWQgb24gJyArXG4gICAgICAndGhpcyBkZXZpY2UuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5DQVBUQ0hBX0NIRUNLX0ZBSUxFRF06XG4gICAgICAnVGhlIHJlQ0FQVENIQSByZXNwb25zZSB0b2tlbiBwcm92aWRlZCBpcyBlaXRoZXIgaW52YWxpZCwgZXhwaXJlZCwgJyArXG4gICAgICAnYWxyZWFkeSB1c2VkIG9yIHRoZSBkb21haW4gYXNzb2NpYXRlZCB3aXRoIGl0IGRvZXMgbm90IG1hdGNoIHRoZSBsaXN0ICcgK1xuICAgICAgJ29mIHdoaXRlbGlzdGVkIGRvbWFpbnMuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5DT0RFX0VYUElSRURdOlxuICAgICAgJ1RoZSBTTVMgY29kZSBoYXMgZXhwaXJlZC4gUGxlYXNlIHJlLXNlbmQgdGhlIHZlcmlmaWNhdGlvbiBjb2RlIHRvIHRyeSAnICtcbiAgICAgICdhZ2Fpbi4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLkNPUkRPVkFfTk9UX1JFQURZXTogJ0NvcmRvdmEgZnJhbWV3b3JrIGlzIG5vdCByZWFkeS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLkNPUlNfVU5TVVBQT1JURURdOiAnVGhpcyBicm93c2VyIGlzIG5vdCBzdXBwb3J0ZWQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5DUkVERU5USUFMX0FMUkVBRFlfSU5fVVNFXTpcbiAgICAgICdUaGlzIGNyZWRlbnRpYWwgaXMgYWxyZWFkeSBhc3NvY2lhdGVkIHdpdGggYSBkaWZmZXJlbnQgdXNlciBhY2NvdW50LicsXG4gICAgW0F1dGhFcnJvckNvZGUuQ1JFREVOVElBTF9NSVNNQVRDSF06XG4gICAgICAnVGhlIGN1c3RvbSB0b2tlbiBjb3JyZXNwb25kcyB0byBhIGRpZmZlcmVudCBhdWRpZW5jZS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLkNSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTl06XG4gICAgICAnVGhpcyBvcGVyYXRpb24gaXMgc2Vuc2l0aXZlIGFuZCByZXF1aXJlcyByZWNlbnQgYXV0aGVudGljYXRpb24uIExvZyBpbiAnICtcbiAgICAgICdhZ2FpbiBiZWZvcmUgcmV0cnlpbmcgdGhpcyByZXF1ZXN0LicsXG4gICAgW0F1dGhFcnJvckNvZGUuREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIXTpcbiAgICAgICdBbm90aGVyIEZpcmViYXNlIFNESyB3YXMgaW5pdGlhbGl6ZWQgYW5kIGlzIHRyeWluZyB0byB1c2UgQXV0aCBiZWZvcmUgQXV0aCBpcyAnICtcbiAgICAgICdpbml0aWFsaXplZC4gUGxlYXNlIGJlIHN1cmUgdG8gY2FsbCBgaW5pdGlhbGl6ZUF1dGhgIG9yIGBnZXRBdXRoYCBiZWZvcmUgJyArXG4gICAgICAnc3RhcnRpbmcgYW55IG90aGVyIEZpcmViYXNlIFNESy4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLkRZTkFNSUNfTElOS19OT1RfQUNUSVZBVEVEXTpcbiAgICAgICdQbGVhc2UgYWN0aXZhdGUgRHluYW1pYyBMaW5rcyBpbiB0aGUgRmlyZWJhc2UgQ29uc29sZSBhbmQgYWdyZWUgdG8gdGhlIHRlcm1zIGFuZCAnICtcbiAgICAgICdjb25kaXRpb25zLicsXG4gICAgW0F1dGhFcnJvckNvZGUuRU1BSUxfQ0hBTkdFX05FRURTX1ZFUklGSUNBVElPTl06XG4gICAgICAnTXVsdGktZmFjdG9yIHVzZXJzIG11c3QgYWx3YXlzIGhhdmUgYSB2ZXJpZmllZCBlbWFpbC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLkVNQUlMX0VYSVNUU106XG4gICAgICAnVGhlIGVtYWlsIGFkZHJlc3MgaXMgYWxyZWFkeSBpbiB1c2UgYnkgYW5vdGhlciBhY2NvdW50LicsXG4gICAgW0F1dGhFcnJvckNvZGUuRU1VTEFUT1JfQ09ORklHX0ZBSUxFRF06XG4gICAgICAnQXV0aCBpbnN0YW5jZSBoYXMgYWxyZWFkeSBiZWVuIHVzZWQgdG8gbWFrZSBhIG5ldHdvcmsgY2FsbC4gQXV0aCBjYW4gJyArXG4gICAgICAnbm8gbG9uZ2VyIGJlIGNvbmZpZ3VyZWQgdG8gdXNlIHRoZSBlbXVsYXRvci4gVHJ5IGNhbGxpbmcgJyArXG4gICAgICAnXCJjb25uZWN0QXV0aEVtdWxhdG9yKClcIiBzb29uZXIuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5FWFBJUkVEX09PQl9DT0RFXTogJ1RoZSBhY3Rpb24gY29kZSBoYXMgZXhwaXJlZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLkVYUElSRURfUE9QVVBfUkVRVUVTVF06XG4gICAgICAnVGhpcyBvcGVyYXRpb24gaGFzIGJlZW4gY2FuY2VsbGVkIGR1ZSB0byBhbm90aGVyIGNvbmZsaWN0aW5nIHBvcHVwIGJlaW5nIG9wZW5lZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SXTogJ0FuIGludGVybmFsIEF1dGhFcnJvciBoYXMgb2NjdXJyZWQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX0FQUF9DUkVERU5USUFMXTpcbiAgICAgICdUaGUgcGhvbmUgdmVyaWZpY2F0aW9uIHJlcXVlc3QgY29udGFpbnMgYW4gaW52YWxpZCBhcHBsaWNhdGlvbiB2ZXJpZmllci4nICtcbiAgICAgICcgVGhlIHJlQ0FQVENIQSB0b2tlbiByZXNwb25zZSBpcyBlaXRoZXIgaW52YWxpZCBvciBleHBpcmVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9BUFBfSURdOlxuICAgICAgJ1RoZSBtb2JpbGUgYXBwIGlkZW50aWZpZXIgaXMgbm90IHJlZ2lzdGVkIGZvciB0aGUgY3VycmVudCBwcm9qZWN0LicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9BVVRIXTpcbiAgICAgIFwiVGhpcyB1c2VyJ3MgY3JlZGVudGlhbCBpc24ndCB2YWxpZCBmb3IgdGhpcyBwcm9qZWN0LiBUaGlzIGNhbiBoYXBwZW4gXCIgK1xuICAgICAgXCJpZiB0aGUgdXNlcidzIHRva2VuIGhhcyBiZWVuIHRhbXBlcmVkIHdpdGgsIG9yIGlmIHRoZSB1c2VyIGlzbid0IGZvciBcIiArXG4gICAgICAndGhlIHByb2plY3QgYXNzb2NpYXRlZCB3aXRoIHRoaXMgQVBJIGtleS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfQVVUSF9FVkVOVF06ICdBbiBpbnRlcm5hbCBBdXRoRXJyb3IgaGFzIG9jY3VycmVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9DT0RFXTpcbiAgICAgICdUaGUgU01TIHZlcmlmaWNhdGlvbiBjb2RlIHVzZWQgdG8gY3JlYXRlIHRoZSBwaG9uZSBhdXRoIGNyZWRlbnRpYWwgaXMgJyArXG4gICAgICAnaW52YWxpZC4gUGxlYXNlIHJlc2VuZCB0aGUgdmVyaWZpY2F0aW9uIGNvZGUgc21zIGFuZCBiZSBzdXJlIHRvIHVzZSB0aGUgJyArXG4gICAgICAndmVyaWZpY2F0aW9uIGNvZGUgcHJvdmlkZWQgYnkgdGhlIHVzZXIuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX0NPTlRJTlVFX1VSSV06XG4gICAgICAnVGhlIGNvbnRpbnVlIFVSTCBwcm92aWRlZCBpbiB0aGUgcmVxdWVzdCBpcyBpbnZhbGlkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9DT1JET1ZBX0NPTkZJR1VSQVRJT05dOlxuICAgICAgJ1RoZSBmb2xsb3dpbmcgQ29yZG92YSBwbHVnaW5zIG11c3QgYmUgaW5zdGFsbGVkIHRvIGVuYWJsZSBPQXV0aCBzaWduLWluOiAnICtcbiAgICAgICdjb3Jkb3ZhLXBsdWdpbi1idWlsZGluZm8sIGNvcmRvdmEtdW5pdmVyc2FsLWxpbmtzLXBsdWdpbiwgJyArXG4gICAgICAnY29yZG92YS1wbHVnaW4tYnJvd3NlcnRhYiwgY29yZG92YS1wbHVnaW4taW5hcHBicm93c2VyIGFuZCAnICtcbiAgICAgICdjb3Jkb3ZhLXBsdWdpbi1jdXN0b211cmxzY2hlbWUuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX0NVU1RPTV9UT0tFTl06XG4gICAgICAnVGhlIGN1c3RvbSB0b2tlbiBmb3JtYXQgaXMgaW5jb3JyZWN0LiBQbGVhc2UgY2hlY2sgdGhlIGRvY3VtZW50YXRpb24uJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX0RZTkFNSUNfTElOS19ET01BSU5dOlxuICAgICAgJ1RoZSBwcm92aWRlZCBkeW5hbWljIGxpbmsgZG9tYWluIGlzIG5vdCBjb25maWd1cmVkIG9yIGF1dGhvcml6ZWQgZm9yIHRoZSBjdXJyZW50IHByb2plY3QuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX0VNQUlMXTogJ1RoZSBlbWFpbCBhZGRyZXNzIGlzIGJhZGx5IGZvcm1hdHRlZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfRU1VTEFUT1JfU0NIRU1FXTpcbiAgICAgICdFbXVsYXRvciBVUkwgbXVzdCBzdGFydCB3aXRoIGEgdmFsaWQgc2NoZW1lIChodHRwOi8vIG9yIGh0dHBzOi8vKS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfQVBJX0tFWV06XG4gICAgICAnWW91ciBBUEkga2V5IGlzIGludmFsaWQsIHBsZWFzZSBjaGVjayB5b3UgaGF2ZSBjb3BpZWQgaXQgY29ycmVjdGx5LicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9DRVJUX0hBU0hdOlxuICAgICAgJ1RoZSBTSEEtMSBjZXJ0aWZpY2F0ZSBoYXNoIHByb3ZpZGVkIGlzIGludmFsaWQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX0lEUF9SRVNQT05TRV06XG4gICAgICAnVGhlIHN1cHBsaWVkIGF1dGggY3JlZGVudGlhbCBpcyBtYWxmb3JtZWQgb3IgaGFzIGV4cGlyZWQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX01FU1NBR0VfUEFZTE9BRF06XG4gICAgICAnVGhlIGVtYWlsIHRlbXBsYXRlIGNvcnJlc3BvbmRpbmcgdG8gdGhpcyBhY3Rpb24gY29udGFpbnMgaW52YWxpZCBjaGFyYWN0ZXJzIGluIGl0cyBtZXNzYWdlLiAnICtcbiAgICAgICdQbGVhc2UgZml4IGJ5IGdvaW5nIHRvIHRoZSBBdXRoIGVtYWlsIHRlbXBsYXRlcyBzZWN0aW9uIGluIHRoZSBGaXJlYmFzZSBDb25zb2xlLicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9NRkFfU0VTU0lPTl06XG4gICAgICAnVGhlIHJlcXVlc3QgZG9lcyBub3QgY29udGFpbiBhIHZhbGlkIHByb29mIG9mIGZpcnN0IGZhY3RvciBzdWNjZXNzZnVsIHNpZ24taW4uJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX09BVVRIX1BST1ZJREVSXTpcbiAgICAgICdFbWFpbEF1dGhQcm92aWRlciBpcyBub3Qgc3VwcG9ydGVkIGZvciB0aGlzIG9wZXJhdGlvbi4gVGhpcyBvcGVyYXRpb24gJyArXG4gICAgICAnb25seSBzdXBwb3J0cyBPQXV0aCBwcm92aWRlcnMuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX09BVVRIX0NMSUVOVF9JRF06XG4gICAgICAnVGhlIE9BdXRoIGNsaWVudCBJRCBwcm92aWRlZCBpcyBlaXRoZXIgaW52YWxpZCBvciBkb2VzIG5vdCBtYXRjaCB0aGUgJyArXG4gICAgICAnc3BlY2lmaWVkIEFQSSBrZXkuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX09SSUdJTl06XG4gICAgICAnVGhpcyBkb21haW4gaXMgbm90IGF1dGhvcml6ZWQgZm9yIE9BdXRoIG9wZXJhdGlvbnMgZm9yIHlvdXIgRmlyZWJhc2UgJyArXG4gICAgICAncHJvamVjdC4gRWRpdCB0aGUgbGlzdCBvZiBhdXRob3JpemVkIGRvbWFpbnMgZnJvbSB0aGUgRmlyZWJhc2UgY29uc29sZS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfT09CX0NPREVdOlxuICAgICAgJ1RoZSBhY3Rpb24gY29kZSBpcyBpbnZhbGlkLiBUaGlzIGNhbiBoYXBwZW4gaWYgdGhlIGNvZGUgaXMgbWFsZm9ybWVkLCAnICtcbiAgICAgICdleHBpcmVkLCBvciBoYXMgYWxyZWFkeSBiZWVuIHVzZWQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX1BBU1NXT1JEXTpcbiAgICAgICdUaGUgcGFzc3dvcmQgaXMgaW52YWxpZCBvciB0aGUgdXNlciBkb2VzIG5vdCBoYXZlIGEgcGFzc3dvcmQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX1BFUlNJU1RFTkNFXTpcbiAgICAgICdUaGUgc3BlY2lmaWVkIHBlcnNpc3RlbmNlIHR5cGUgaXMgaW52YWxpZC4gSXQgY2FuIG9ubHkgYmUgbG9jYWwsIHNlc3Npb24gb3Igbm9uZS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfUEhPTkVfTlVNQkVSXTpcbiAgICAgICdUaGUgZm9ybWF0IG9mIHRoZSBwaG9uZSBudW1iZXIgcHJvdmlkZWQgaXMgaW5jb3JyZWN0LiBQbGVhc2UgZW50ZXIgdGhlICcgK1xuICAgICAgJ3Bob25lIG51bWJlciBpbiBhIGZvcm1hdCB0aGF0IGNhbiBiZSBwYXJzZWQgaW50byBFLjE2NCBmb3JtYXQuIEUuMTY0ICcgK1xuICAgICAgJ3Bob25lIG51bWJlcnMgYXJlIHdyaXR0ZW4gaW4gdGhlIGZvcm1hdCBbK11bY291bnRyeSBjb2RlXVtzdWJzY3JpYmVyICcgK1xuICAgICAgJ251bWJlciBpbmNsdWRpbmcgYXJlYSBjb2RlXS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfUFJPVklERVJfSURdOlxuICAgICAgJ1RoZSBzcGVjaWZpZWQgcHJvdmlkZXIgSUQgaXMgaW52YWxpZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVDSVBJRU5UX0VNQUlMXTpcbiAgICAgICdUaGUgZW1haWwgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBmYWlsZWQgdG8gc2VuZCBhcyB0aGUgcHJvdmlkZWQgJyArXG4gICAgICAncmVjaXBpZW50IGVtYWlsIGFkZHJlc3MgaXMgaW52YWxpZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfU0VOREVSXTpcbiAgICAgICdUaGUgZW1haWwgdGVtcGxhdGUgY29ycmVzcG9uZGluZyB0byB0aGlzIGFjdGlvbiBjb250YWlucyBhbiBpbnZhbGlkIHNlbmRlciBlbWFpbCBvciBuYW1lLiAnICtcbiAgICAgICdQbGVhc2UgZml4IGJ5IGdvaW5nIHRvIHRoZSBBdXRoIGVtYWlsIHRlbXBsYXRlcyBzZWN0aW9uIGluIHRoZSBGaXJlYmFzZSBDb25zb2xlLicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9TRVNTSU9OX0lORk9dOlxuICAgICAgJ1RoZSB2ZXJpZmljYXRpb24gSUQgdXNlZCB0byBjcmVhdGUgdGhlIHBob25lIGF1dGggY3JlZGVudGlhbCBpcyBpbnZhbGlkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9URU5BTlRfSURdOlxuICAgICAgXCJUaGUgQXV0aCBpbnN0YW5jZSdzIHRlbmFudCBJRCBpcyBpbnZhbGlkLlwiLFxuICAgIFtBdXRoRXJyb3JDb2RlLkxPR0lOX0JMT0NLRURdOlxuICAgICAgJ0xvZ2luIGJsb2NrZWQgYnkgdXNlci1wcm92aWRlZCBtZXRob2Q6IHskb3JpZ2luYWxNZXNzYWdlfScsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRV06XG4gICAgICAnQW4gQW5kcm9pZCBQYWNrYWdlIE5hbWUgbXVzdCBiZSBwcm92aWRlZCBpZiB0aGUgQW5kcm9pZCBBcHAgaXMgcmVxdWlyZWQgdG8gYmUgaW5zdGFsbGVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19BVVRIX0RPTUFJTl06XG4gICAgICAnQmUgc3VyZSB0byBpbmNsdWRlIGF1dGhEb21haW4gd2hlbiBjYWxsaW5nIGZpcmViYXNlLmluaXRpYWxpemVBcHAoKSwgJyArXG4gICAgICAnYnkgZm9sbG93aW5nIHRoZSBpbnN0cnVjdGlvbnMgaW4gdGhlIEZpcmViYXNlIGNvbnNvbGUuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5NSVNTSU5HX0FQUF9DUkVERU5USUFMXTpcbiAgICAgICdUaGUgcGhvbmUgdmVyaWZpY2F0aW9uIHJlcXVlc3QgaXMgbWlzc2luZyBhbiBhcHBsaWNhdGlvbiB2ZXJpZmllciAnICtcbiAgICAgICdhc3NlcnRpb24uIEEgcmVDQVBUQ0hBIHJlc3BvbnNlIHRva2VuIG5lZWRzIHRvIGJlIHByb3ZpZGVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19DT0RFXTpcbiAgICAgICdUaGUgcGhvbmUgYXV0aCBjcmVkZW50aWFsIHdhcyBjcmVhdGVkIHdpdGggYW4gZW1wdHkgU01TIHZlcmlmaWNhdGlvbiBjb2RlLicsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19DT05USU5VRV9VUkldOlxuICAgICAgJ0EgY29udGludWUgVVJMIG11c3QgYmUgcHJvdmlkZWQgaW4gdGhlIHJlcXVlc3QuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5NSVNTSU5HX0lGUkFNRV9TVEFSVF06ICdBbiBpbnRlcm5hbCBBdXRoRXJyb3IgaGFzIG9jY3VycmVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19JT1NfQlVORExFX0lEXTpcbiAgICAgICdBbiBpT1MgQnVuZGxlIElEIG11c3QgYmUgcHJvdmlkZWQgaWYgYW4gQXBwIFN0b3JlIElEIGlzIHByb3ZpZGVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19PUl9JTlZBTElEX05PTkNFXTpcbiAgICAgICdUaGUgcmVxdWVzdCBkb2VzIG5vdCBjb250YWluIGEgdmFsaWQgbm9uY2UuIFRoaXMgY2FuIG9jY3VyIGlmIHRoZSAnICtcbiAgICAgICdTSEEtMjU2IGhhc2ggb2YgdGhlIHByb3ZpZGVkIHJhdyBub25jZSBkb2VzIG5vdCBtYXRjaCB0aGUgaGFzaGVkIG5vbmNlICcgK1xuICAgICAgJ2luIHRoZSBJRCB0b2tlbiBwYXlsb2FkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19QQVNTV09SRF06ICdBIG5vbi1lbXB0eSBwYXNzd29yZCBtdXN0IGJlIHByb3ZpZGVkJyxcbiAgICBbQXV0aEVycm9yQ29kZS5NSVNTSU5HX01GQV9JTkZPXTpcbiAgICAgICdObyBzZWNvbmQgZmFjdG9yIGlkZW50aWZpZXIgaXMgcHJvdmlkZWQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5NSVNTSU5HX01GQV9TRVNTSU9OXTpcbiAgICAgICdUaGUgcmVxdWVzdCBpcyBtaXNzaW5nIHByb29mIG9mIGZpcnN0IGZhY3RvciBzdWNjZXNzZnVsIHNpZ24taW4uJyxcbiAgICBbQXV0aEVycm9yQ29kZS5NSVNTSU5HX1BIT05FX05VTUJFUl06XG4gICAgICAnVG8gc2VuZCB2ZXJpZmljYXRpb24gY29kZXMsIHByb3ZpZGUgYSBwaG9uZSBudW1iZXIgZm9yIHRoZSByZWNpcGllbnQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5NSVNTSU5HX1NFU1NJT05fSU5GT106XG4gICAgICAnVGhlIHBob25lIGF1dGggY3JlZGVudGlhbCB3YXMgY3JlYXRlZCB3aXRoIGFuIGVtcHR5IHZlcmlmaWNhdGlvbiBJRC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLk1PRFVMRV9ERVNUUk9ZRURdOlxuICAgICAgJ1RoaXMgaW5zdGFuY2Ugb2YgRmlyZWJhc2VBcHAgaGFzIGJlZW4gZGVsZXRlZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLk1GQV9JTkZPX05PVF9GT1VORF06XG4gICAgICAnVGhlIHVzZXIgZG9lcyBub3QgaGF2ZSBhIHNlY29uZCBmYWN0b3IgbWF0Y2hpbmcgdGhlIGlkZW50aWZpZXIgcHJvdmlkZWQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5NRkFfUkVRVUlSRURdOlxuICAgICAgJ1Byb29mIG9mIG93bmVyc2hpcCBvZiBhIHNlY29uZCBmYWN0b3IgaXMgcmVxdWlyZWQgdG8gY29tcGxldGUgc2lnbi1pbi4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLk5FRURfQ09ORklSTUFUSU9OXTpcbiAgICAgICdBbiBhY2NvdW50IGFscmVhZHkgZXhpc3RzIHdpdGggdGhlIHNhbWUgZW1haWwgYWRkcmVzcyBidXQgZGlmZmVyZW50ICcgK1xuICAgICAgJ3NpZ24taW4gY3JlZGVudGlhbHMuIFNpZ24gaW4gdXNpbmcgYSBwcm92aWRlciBhc3NvY2lhdGVkIHdpdGggdGhpcyAnICtcbiAgICAgICdlbWFpbCBhZGRyZXNzLicsXG4gICAgW0F1dGhFcnJvckNvZGUuTkVUV09SS19SRVFVRVNUX0ZBSUxFRF06XG4gICAgICAnQSBuZXR3b3JrIEF1dGhFcnJvciAoc3VjaCBhcyB0aW1lb3V0LCBpbnRlcnJ1cHRlZCBjb25uZWN0aW9uIG9yIHVucmVhY2hhYmxlIGhvc3QpIGhhcyBvY2N1cnJlZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLk5PX0FVVEhfRVZFTlRdOiAnQW4gaW50ZXJuYWwgQXV0aEVycm9yIGhhcyBvY2N1cnJlZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLk5PX1NVQ0hfUFJPVklERVJdOlxuICAgICAgJ1VzZXIgd2FzIG5vdCBsaW5rZWQgdG8gYW4gYWNjb3VudCB3aXRoIHRoZSBnaXZlbiBwcm92aWRlci4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLk5VTExfVVNFUl06XG4gICAgICAnQSBudWxsIHVzZXIgb2JqZWN0IHdhcyBwcm92aWRlZCBhcyB0aGUgYXJndW1lbnQgZm9yIGFuIG9wZXJhdGlvbiB3aGljaCAnICtcbiAgICAgICdyZXF1aXJlcyBhIG5vbi1udWxsIHVzZXIgb2JqZWN0LicsXG4gICAgW0F1dGhFcnJvckNvZGUuT1BFUkFUSU9OX05PVF9BTExPV0VEXTpcbiAgICAgICdUaGUgZ2l2ZW4gc2lnbi1pbiBwcm92aWRlciBpcyBkaXNhYmxlZCBmb3IgdGhpcyBGaXJlYmFzZSBwcm9qZWN0LiAnICtcbiAgICAgICdFbmFibGUgaXQgaW4gdGhlIEZpcmViYXNlIGNvbnNvbGUsIHVuZGVyIHRoZSBzaWduLWluIG1ldGhvZCB0YWIgb2YgdGhlICcgK1xuICAgICAgJ0F1dGggc2VjdGlvbi4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLk9QRVJBVElPTl9OT1RfU1VQUE9SVEVEXTpcbiAgICAgICdUaGlzIG9wZXJhdGlvbiBpcyBub3Qgc3VwcG9ydGVkIGluIHRoZSBlbnZpcm9ubWVudCB0aGlzIGFwcGxpY2F0aW9uIGlzICcgK1xuICAgICAgJ3J1bm5pbmcgb24uIFwibG9jYXRpb24ucHJvdG9jb2xcIiBtdXN0IGJlIGh0dHAsIGh0dHBzIG9yIGNocm9tZS1leHRlbnNpb24nICtcbiAgICAgICcgYW5kIHdlYiBzdG9yYWdlIG11c3QgYmUgZW5hYmxlZC4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLlBPUFVQX0JMT0NLRURdOlxuICAgICAgJ1VuYWJsZSB0byBlc3RhYmxpc2ggYSBjb25uZWN0aW9uIHdpdGggdGhlIHBvcHVwLiBJdCBtYXkgaGF2ZSBiZWVuIGJsb2NrZWQgYnkgdGhlIGJyb3dzZXIuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5QT1BVUF9DTE9TRURfQllfVVNFUl06XG4gICAgICAnVGhlIHBvcHVwIGhhcyBiZWVuIGNsb3NlZCBieSB0aGUgdXNlciBiZWZvcmUgZmluYWxpemluZyB0aGUgb3BlcmF0aW9uLicsXG4gICAgW0F1dGhFcnJvckNvZGUuUFJPVklERVJfQUxSRUFEWV9MSU5LRURdOlxuICAgICAgJ1VzZXIgY2FuIG9ubHkgYmUgbGlua2VkIHRvIG9uZSBpZGVudGl0eSBmb3IgdGhlIGdpdmVuIHByb3ZpZGVyLicsXG4gICAgW0F1dGhFcnJvckNvZGUuUVVPVEFfRVhDRUVERURdOlxuICAgICAgXCJUaGUgcHJvamVjdCdzIHF1b3RhIGZvciB0aGlzIG9wZXJhdGlvbiBoYXMgYmVlbiBleGNlZWRlZC5cIixcbiAgICBbQXV0aEVycm9yQ29kZS5SRURJUkVDVF9DQU5DRUxMRURfQllfVVNFUl06XG4gICAgICAnVGhlIHJlZGlyZWN0IG9wZXJhdGlvbiBoYXMgYmVlbiBjYW5jZWxsZWQgYnkgdGhlIHVzZXIgYmVmb3JlIGZpbmFsaXppbmcuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5SRURJUkVDVF9PUEVSQVRJT05fUEVORElOR106XG4gICAgICAnQSByZWRpcmVjdCBzaWduLWluIG9wZXJhdGlvbiBpcyBhbHJlYWR5IHBlbmRpbmcuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5SRUpFQ1RFRF9DUkVERU5USUFMXTpcbiAgICAgICdUaGUgcmVxdWVzdCBjb250YWlucyBtYWxmb3JtZWQgb3IgbWlzbWF0Y2hpbmcgY3JlZGVudGlhbHMuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5TRUNPTkRfRkFDVE9SX0FMUkVBRFlfRU5ST0xMRURdOlxuICAgICAgJ1RoZSBzZWNvbmQgZmFjdG9yIGlzIGFscmVhZHkgZW5yb2xsZWQgb24gdGhpcyBhY2NvdW50LicsXG4gICAgW0F1dGhFcnJvckNvZGUuU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRF06XG4gICAgICAnVGhlIG1heGltdW0gYWxsb3dlZCBudW1iZXIgb2Ygc2Vjb25kIGZhY3RvcnMgb24gYSB1c2VyIGhhcyBiZWVuIGV4Y2VlZGVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVEVOQU5UX0lEX01JU01BVENIXTpcbiAgICAgIFwiVGhlIHByb3ZpZGVkIHRlbmFudCBJRCBkb2VzIG5vdCBtYXRjaCB0aGUgQXV0aCBpbnN0YW5jZSdzIHRlbmFudCBJRFwiLFxuICAgIFtBdXRoRXJyb3JDb2RlLlRJTUVPVVRdOiAnVGhlIG9wZXJhdGlvbiBoYXMgdGltZWQgb3V0LicsXG4gICAgW0F1dGhFcnJvckNvZGUuVE9LRU5fRVhQSVJFRF06XG4gICAgICBcIlRoZSB1c2VyJ3MgY3JlZGVudGlhbCBpcyBubyBsb25nZXIgdmFsaWQuIFRoZSB1c2VyIG11c3Qgc2lnbiBpbiBhZ2Fpbi5cIixcbiAgICBbQXV0aEVycm9yQ29kZS5UT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVJdOlxuICAgICAgJ1dlIGhhdmUgYmxvY2tlZCBhbGwgcmVxdWVzdHMgZnJvbSB0aGlzIGRldmljZSBkdWUgdG8gdW51c3VhbCBhY3Rpdml0eS4gJyArXG4gICAgICAnVHJ5IGFnYWluIGxhdGVyLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVU5BVVRIT1JJWkVEX0RPTUFJTl06XG4gICAgICAnVGhlIGRvbWFpbiBvZiB0aGUgY29udGludWUgVVJMIGlzIG5vdCB3aGl0ZWxpc3RlZC4gIFBsZWFzZSB3aGl0ZWxpc3QgJyArXG4gICAgICAndGhlIGRvbWFpbiBpbiB0aGUgRmlyZWJhc2UgY29uc29sZS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLlVOU1VQUE9SVEVEX0ZJUlNUX0ZBQ1RPUl06XG4gICAgICAnRW5yb2xsaW5nIGEgc2Vjb25kIGZhY3RvciBvciBzaWduaW5nIGluIHdpdGggYSBtdWx0aS1mYWN0b3IgYWNjb3VudCByZXF1aXJlcyBzaWduLWluIHdpdGggYSBzdXBwb3J0ZWQgZmlyc3QgZmFjdG9yLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVU5TVVBQT1JURURfUEVSU0lTVEVOQ0VdOlxuICAgICAgJ1RoZSBjdXJyZW50IGVudmlyb25tZW50IGRvZXMgbm90IHN1cHBvcnQgdGhlIHNwZWNpZmllZCBwZXJzaXN0ZW5jZSB0eXBlLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVU5TVVBQT1JURURfVEVOQU5UX09QRVJBVElPTl06XG4gICAgICAnVGhpcyBvcGVyYXRpb24gaXMgbm90IHN1cHBvcnRlZCBpbiBhIG11bHRpLXRlbmFudCBjb250ZXh0LicsXG4gICAgW0F1dGhFcnJvckNvZGUuVU5WRVJJRklFRF9FTUFJTF06XG4gICAgICAnVGhlIG9wZXJhdGlvbiByZXF1aXJlcyBhIHZlcmlmaWVkIGVtYWlsLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVVNFUl9DQU5DRUxMRURdOlxuICAgICAgJ1RoZSB1c2VyIGRpZCBub3QgZ3JhbnQgeW91ciBhcHBsaWNhdGlvbiB0aGUgcGVybWlzc2lvbnMgaXQgcmVxdWVzdGVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVVNFUl9ERUxFVEVEXTpcbiAgICAgICdUaGVyZSBpcyBubyB1c2VyIHJlY29yZCBjb3JyZXNwb25kaW5nIHRvIHRoaXMgaWRlbnRpZmllci4gVGhlIHVzZXIgbWF5ICcgK1xuICAgICAgJ2hhdmUgYmVlbiBkZWxldGVkLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVVNFUl9ESVNBQkxFRF06XG4gICAgICAnVGhlIHVzZXIgYWNjb3VudCBoYXMgYmVlbiBkaXNhYmxlZCBieSBhbiBhZG1pbmlzdHJhdG9yLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVVNFUl9NSVNNQVRDSF06XG4gICAgICAnVGhlIHN1cHBsaWVkIGNyZWRlbnRpYWxzIGRvIG5vdCBjb3JyZXNwb25kIHRvIHRoZSBwcmV2aW91c2x5IHNpZ25lZCBpbiB1c2VyLicsXG4gICAgW0F1dGhFcnJvckNvZGUuVVNFUl9TSUdORURfT1VUXTogJycsXG4gICAgW0F1dGhFcnJvckNvZGUuV0VBS19QQVNTV09SRF06XG4gICAgICAnVGhlIHBhc3N3b3JkIG11c3QgYmUgNiBjaGFyYWN0ZXJzIGxvbmcgb3IgbW9yZS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLldFQl9TVE9SQUdFX1VOU1VQUE9SVEVEXTpcbiAgICAgICdUaGlzIGJyb3dzZXIgaXMgbm90IHN1cHBvcnRlZCBvciAzcmQgcGFydHkgY29va2llcyBhbmQgZGF0YSBtYXkgYmUgZGlzYWJsZWQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5BTFJFQURZX0lOSVRJQUxJWkVEXTpcbiAgICAgICdpbml0aWFsaXplQXV0aCgpIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkIHdpdGggJyArXG4gICAgICAnZGlmZmVyZW50IG9wdGlvbnMuIFRvIGF2b2lkIHRoaXMgZXJyb3IsIGNhbGwgaW5pdGlhbGl6ZUF1dGgoKSB3aXRoIHRoZSAnICtcbiAgICAgICdzYW1lIG9wdGlvbnMgYXMgd2hlbiBpdCB3YXMgb3JpZ2luYWxseSBjYWxsZWQsIG9yIGNhbGwgZ2V0QXV0aCgpIHRvIHJldHVybiB0aGUnICtcbiAgICAgICcgYWxyZWFkeSBpbml0aWFsaXplZCBpbnN0YW5jZS4nLFxuICAgIFtBdXRoRXJyb3JDb2RlLk1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOXTpcbiAgICAgICdUaGUgcmVDQVBUQ0hBIHRva2VuIGlzIG1pc3Npbmcgd2hlbiBzZW5kaW5nIHJlcXVlc3QgdG8gdGhlIGJhY2tlbmQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX1JFQ0FQVENIQV9UT0tFTl06XG4gICAgICAnVGhlIHJlQ0FQVENIQSB0b2tlbiBpcyBpbnZhbGlkIHdoZW4gc2VuZGluZyByZXF1ZXN0IHRvIHRoZSBiYWNrZW5kLicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfQUNUSU9OXTpcbiAgICAgICdUaGUgcmVDQVBUQ0hBIGFjdGlvbiBpcyBpbnZhbGlkIHdoZW4gc2VuZGluZyByZXF1ZXN0IHRvIHRoZSBiYWNrZW5kLicsXG4gICAgW0F1dGhFcnJvckNvZGUuUkVDQVBUQ0hBX05PVF9FTkFCTEVEXTpcbiAgICAgICdyZUNBUFRDSEEgRW50ZXJwcmlzZSBpbnRlZ3JhdGlvbiBpcyBub3QgZW5hYmxlZCBmb3IgdGhpcyBwcm9qZWN0LicsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19DTElFTlRfVFlQRV06XG4gICAgICAnVGhlIHJlQ0FQVENIQSBjbGllbnQgdHlwZSBpcyBtaXNzaW5nIHdoZW4gc2VuZGluZyByZXF1ZXN0IHRvIHRoZSBiYWNrZW5kLicsXG4gICAgW0F1dGhFcnJvckNvZGUuTUlTU0lOR19SRUNBUFRDSEFfVkVSU0lPTl06XG4gICAgICAnVGhlIHJlQ0FQVENIQSB2ZXJzaW9uIGlzIG1pc3Npbmcgd2hlbiBzZW5kaW5nIHJlcXVlc3QgdG8gdGhlIGJhY2tlbmQuJyxcbiAgICBbQXV0aEVycm9yQ29kZS5JTlZBTElEX1JFUV9UWVBFXTogJ0ludmFsaWQgcmVxdWVzdCBwYXJhbWV0ZXJzLicsXG4gICAgW0F1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfVkVSU0lPTl06XG4gICAgICAnVGhlIHJlQ0FQVENIQSB2ZXJzaW9uIGlzIGludmFsaWQgd2hlbiBzZW5kaW5nIHJlcXVlc3QgdG8gdGhlIGJhY2tlbmQuJ1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVycm9yTWFwUmV0cmlldmVyIGV4dGVuZHMgQXV0aEVycm9yTWFwIHtcbiAgKCk6IEVycm9yTWFwPEF1dGhFcnJvckNvZGU+O1xufVxuXG5mdW5jdGlvbiBfcHJvZEVycm9yTWFwKCk6IEVycm9yTWFwPEF1dGhFcnJvckNvZGU+IHtcbiAgLy8gV2Ugd2lsbCBpbmNsdWRlIHRoaXMgb25lIG1lc3NhZ2UgaW4gdGhlIHByb2QgZXJyb3IgbWFwIHNpbmNlIGJ5IHRoZSB2ZXJ5XG4gIC8vIG5hdHVyZSBvZiB0aGlzIGVycm9yLCBkZXZlbG9wZXJzIHdpbGwgbmV2ZXIgYmUgYWJsZSB0byBzZWUgdGhlIG1lc3NhZ2VcbiAgLy8gdXNpbmcgdGhlIGRlYnVnRXJyb3JNYXAgKHdoaWNoIGlzIGluc3RhbGxlZCBkdXJpbmcgYXV0aCBpbml0aWFsaXphdGlvbikuXG4gIHJldHVybiB7XG4gICAgW0F1dGhFcnJvckNvZGUuREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIXTpcbiAgICAgICdBbm90aGVyIEZpcmViYXNlIFNESyB3YXMgaW5pdGlhbGl6ZWQgYW5kIGlzIHRyeWluZyB0byB1c2UgQXV0aCBiZWZvcmUgQXV0aCBpcyAnICtcbiAgICAgICdpbml0aWFsaXplZC4gUGxlYXNlIGJlIHN1cmUgdG8gY2FsbCBgaW5pdGlhbGl6ZUF1dGhgIG9yIGBnZXRBdXRoYCBiZWZvcmUgJyArXG4gICAgICAnc3RhcnRpbmcgYW55IG90aGVyIEZpcmViYXNlIFNESy4nXG4gIH0gYXMgRXJyb3JNYXA8QXV0aEVycm9yQ29kZT47XG59XG5cbi8qKlxuICogQSB2ZXJib3NlIGVycm9yIG1hcCB3aXRoIGRldGFpbGVkIGRlc2NyaXB0aW9ucyBmb3IgbW9zdCBlcnJvciBjb2Rlcy5cbiAqXG4gKiBTZWUgZGlzY3Vzc2lvbiBhdCB7QGxpbmsgQXV0aEVycm9yTWFwfVxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IGRlYnVnRXJyb3JNYXA6IEF1dGhFcnJvck1hcCA9IF9kZWJ1Z0Vycm9yTWFwO1xuXG4vKipcbiAqIEEgbWluaW1hbCBlcnJvciBtYXAgd2l0aCBhbGwgdmVyYm9zZSBlcnJvciBtZXNzYWdlcyBzdHJpcHBlZC5cbiAqXG4gKiBTZWUgZGlzY3Vzc2lvbiBhdCB7QGxpbmsgQXV0aEVycm9yTWFwfVxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IHByb2RFcnJvck1hcDogQXV0aEVycm9yTWFwID0gX3Byb2RFcnJvck1hcDtcblxuZXhwb3J0IGludGVyZmFjZSBOYW1lZEVycm9yUGFyYW1zIHtcbiAgYXBwTmFtZTogQXBwTmFtZTtcbiAgY3JlZGVudGlhbD86IEF1dGhDcmVkZW50aWFsO1xuICBlbWFpbD86IHN0cmluZztcbiAgcGhvbmVOdW1iZXI/OiBzdHJpbmc7XG4gIHRlbmFudElkPzogc3RyaW5nO1xuICB1c2VyPzogVXNlcjtcbiAgX3NlcnZlclJlc3BvbnNlPzogb2JqZWN0O1xufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG50eXBlIEdlbmVyaWNBdXRoRXJyb3JQYXJhbXMgPSB7XG4gIFtrZXkgaW4gRXhjbHVkZTxcbiAgICBBdXRoRXJyb3JDb2RlLFxuICAgIHwgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUlxuICAgIHwgQXV0aEVycm9yQ29kZS5ERVBFTkRFTlRfU0RLX0lOSVRfQkVGT1JFX0FVVEhcbiAgICB8IEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1JcbiAgICB8IEF1dGhFcnJvckNvZGUuTUZBX1JFUVVJUkVEXG4gICAgfCBBdXRoRXJyb3JDb2RlLk5PX0FVVEhfRVZFTlRcbiAgICB8IEF1dGhFcnJvckNvZGUuT1BFUkFUSU9OX05PVF9TVVBQT1JURURcbiAgPl06IHtcbiAgICBhcHBOYW1lPzogQXBwTmFtZTtcbiAgICBlbWFpbD86IHN0cmluZztcbiAgICBwaG9uZU51bWJlcj86IHN0cmluZztcbiAgICBtZXNzYWdlPzogc3RyaW5nO1xuICB9O1xufTtcblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBdXRoRXJyb3JQYXJhbXMgZXh0ZW5kcyBHZW5lcmljQXV0aEVycm9yUGFyYW1zIHtcbiAgW0F1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1JdOiB7IGFwcE5hbWU/OiBBcHBOYW1lIH07XG4gIFtBdXRoRXJyb3JDb2RlLkRFUEVOREVOVF9TREtfSU5JVF9CRUZPUkVfQVVUSF06IHsgYXBwTmFtZT86IEFwcE5hbWUgfTtcbiAgW0F1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1JdOiB7IGFwcE5hbWU/OiBBcHBOYW1lIH07XG4gIFtBdXRoRXJyb3JDb2RlLkxPR0lOX0JMT0NLRURdOiB7XG4gICAgYXBwTmFtZT86IEFwcE5hbWU7XG4gICAgb3JpZ2luYWxNZXNzYWdlPzogc3RyaW5nO1xuICB9O1xuICBbQXV0aEVycm9yQ29kZS5PUEVSQVRJT05fTk9UX1NVUFBPUlRFRF06IHsgYXBwTmFtZT86IEFwcE5hbWUgfTtcbiAgW0F1dGhFcnJvckNvZGUuTk9fQVVUSF9FVkVOVF06IHsgYXBwTmFtZT86IEFwcE5hbWUgfTtcbiAgW0F1dGhFcnJvckNvZGUuTUZBX1JFUVVJUkVEXToge1xuICAgIGFwcE5hbWU6IEFwcE5hbWU7XG4gICAgX3NlcnZlclJlc3BvbnNlOiBJZFRva2VuTWZhUmVzcG9uc2U7XG4gIH07XG4gIFtBdXRoRXJyb3JDb2RlLklOVkFMSURfQ09SRE9WQV9DT05GSUdVUkFUSU9OXToge1xuICAgIGFwcE5hbWU6IEFwcE5hbWU7XG4gICAgbWlzc2luZ1BsdWdpbj86IHN0cmluZztcbiAgfTtcbn1cblxuZXhwb3J0IGNvbnN0IF9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWSA9IG5ldyBFcnJvckZhY3Rvcnk8XG4gIEF1dGhFcnJvckNvZGUsXG4gIEF1dGhFcnJvclBhcmFtc1xuPignYXV0aCcsICdGaXJlYmFzZScsIF9wcm9kRXJyb3JNYXAoKSk7XG5cbi8qKlxuICogQSBtYXAgb2YgcG90ZW50aWFsIGBBdXRoYCBlcnJvciBjb2RlcywgZm9yIGVhc2llciBjb21wYXJpc29uIHdpdGggZXJyb3JzXG4gKiB0aHJvd24gYnkgdGhlIFNESy5cbiAqXG4gKiBAcmVtYXJrc1xuICogTm90ZSB0aGF0IHlvdSBjYW4ndCB0cmVlLXNoYWtlIGluZGl2aWR1YWwga2V5c1xuICogaW4gdGhlIG1hcCwgc28gYnkgdXNpbmcgdGhlIG1hcCB5b3UgbWlnaHQgc3Vic3RhbnRpYWxseSBpbmNyZWFzZSB5b3VyXG4gKiBidW5kbGUgc2l6ZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjb25zdCBBVVRIX0VSUk9SX0NPREVTX01BUF9ET19OT1RfVVNFX0lOVEVSTkFMTFkgPSB7XG4gIEFETUlOX09OTFlfT1BFUkFUSU9OOiAnYXV0aC9hZG1pbi1yZXN0cmljdGVkLW9wZXJhdGlvbicsXG4gIEFSR1VNRU5UX0VSUk9SOiAnYXV0aC9hcmd1bWVudC1lcnJvcicsXG4gIEFQUF9OT1RfQVVUSE9SSVpFRDogJ2F1dGgvYXBwLW5vdC1hdXRob3JpemVkJyxcbiAgQVBQX05PVF9JTlNUQUxMRUQ6ICdhdXRoL2FwcC1ub3QtaW5zdGFsbGVkJyxcbiAgQ0FQVENIQV9DSEVDS19GQUlMRUQ6ICdhdXRoL2NhcHRjaGEtY2hlY2stZmFpbGVkJyxcbiAgQ09ERV9FWFBJUkVEOiAnYXV0aC9jb2RlLWV4cGlyZWQnLFxuICBDT1JET1ZBX05PVF9SRUFEWTogJ2F1dGgvY29yZG92YS1ub3QtcmVhZHknLFxuICBDT1JTX1VOU1VQUE9SVEVEOiAnYXV0aC9jb3JzLXVuc3VwcG9ydGVkJyxcbiAgQ1JFREVOVElBTF9BTFJFQURZX0lOX1VTRTogJ2F1dGgvY3JlZGVudGlhbC1hbHJlYWR5LWluLXVzZScsXG4gIENSRURFTlRJQUxfTUlTTUFUQ0g6ICdhdXRoL2N1c3RvbS10b2tlbi1taXNtYXRjaCcsXG4gIENSRURFTlRJQUxfVE9PX09MRF9MT0dJTl9BR0FJTjogJ2F1dGgvcmVxdWlyZXMtcmVjZW50LWxvZ2luJyxcbiAgREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIOiAnYXV0aC9kZXBlbmRlbnQtc2RrLWluaXRpYWxpemVkLWJlZm9yZS1hdXRoJyxcbiAgRFlOQU1JQ19MSU5LX05PVF9BQ1RJVkFURUQ6ICdhdXRoL2R5bmFtaWMtbGluay1ub3QtYWN0aXZhdGVkJyxcbiAgRU1BSUxfQ0hBTkdFX05FRURTX1ZFUklGSUNBVElPTjogJ2F1dGgvZW1haWwtY2hhbmdlLW5lZWRzLXZlcmlmaWNhdGlvbicsXG4gIEVNQUlMX0VYSVNUUzogJ2F1dGgvZW1haWwtYWxyZWFkeS1pbi11c2UnLFxuICBFTVVMQVRPUl9DT05GSUdfRkFJTEVEOiAnYXV0aC9lbXVsYXRvci1jb25maWctZmFpbGVkJyxcbiAgRVhQSVJFRF9PT0JfQ09ERTogJ2F1dGgvZXhwaXJlZC1hY3Rpb24tY29kZScsXG4gIEVYUElSRURfUE9QVVBfUkVRVUVTVDogJ2F1dGgvY2FuY2VsbGVkLXBvcHVwLXJlcXVlc3QnLFxuICBJTlRFUk5BTF9FUlJPUjogJ2F1dGgvaW50ZXJuYWwtZXJyb3InLFxuICBJTlZBTElEX0FQSV9LRVk6ICdhdXRoL2ludmFsaWQtYXBpLWtleScsXG4gIElOVkFMSURfQVBQX0NSRURFTlRJQUw6ICdhdXRoL2ludmFsaWQtYXBwLWNyZWRlbnRpYWwnLFxuICBJTlZBTElEX0FQUF9JRDogJ2F1dGgvaW52YWxpZC1hcHAtaWQnLFxuICBJTlZBTElEX0FVVEg6ICdhdXRoL2ludmFsaWQtdXNlci10b2tlbicsXG4gIElOVkFMSURfQVVUSF9FVkVOVDogJ2F1dGgvaW52YWxpZC1hdXRoLWV2ZW50JyxcbiAgSU5WQUxJRF9DRVJUX0hBU0g6ICdhdXRoL2ludmFsaWQtY2VydC1oYXNoJyxcbiAgSU5WQUxJRF9DT0RFOiAnYXV0aC9pbnZhbGlkLXZlcmlmaWNhdGlvbi1jb2RlJyxcbiAgSU5WQUxJRF9DT05USU5VRV9VUkk6ICdhdXRoL2ludmFsaWQtY29udGludWUtdXJpJyxcbiAgSU5WQUxJRF9DT1JET1ZBX0NPTkZJR1VSQVRJT046ICdhdXRoL2ludmFsaWQtY29yZG92YS1jb25maWd1cmF0aW9uJyxcbiAgSU5WQUxJRF9DVVNUT01fVE9LRU46ICdhdXRoL2ludmFsaWQtY3VzdG9tLXRva2VuJyxcbiAgSU5WQUxJRF9EWU5BTUlDX0xJTktfRE9NQUlOOiAnYXV0aC9pbnZhbGlkLWR5bmFtaWMtbGluay1kb21haW4nLFxuICBJTlZBTElEX0VNQUlMOiAnYXV0aC9pbnZhbGlkLWVtYWlsJyxcbiAgSU5WQUxJRF9FTVVMQVRPUl9TQ0hFTUU6ICdhdXRoL2ludmFsaWQtZW11bGF0b3Itc2NoZW1lJyxcbiAgSU5WQUxJRF9JRFBfUkVTUE9OU0U6ICdhdXRoL2ludmFsaWQtY3JlZGVudGlhbCcsXG4gIElOVkFMSURfTUVTU0FHRV9QQVlMT0FEOiAnYXV0aC9pbnZhbGlkLW1lc3NhZ2UtcGF5bG9hZCcsXG4gIElOVkFMSURfTUZBX1NFU1NJT046ICdhdXRoL2ludmFsaWQtbXVsdGktZmFjdG9yLXNlc3Npb24nLFxuICBJTlZBTElEX09BVVRIX0NMSUVOVF9JRDogJ2F1dGgvaW52YWxpZC1vYXV0aC1jbGllbnQtaWQnLFxuICBJTlZBTElEX09BVVRIX1BST1ZJREVSOiAnYXV0aC9pbnZhbGlkLW9hdXRoLXByb3ZpZGVyJyxcbiAgSU5WQUxJRF9PT0JfQ09ERTogJ2F1dGgvaW52YWxpZC1hY3Rpb24tY29kZScsXG4gIElOVkFMSURfT1JJR0lOOiAnYXV0aC91bmF1dGhvcml6ZWQtZG9tYWluJyxcbiAgSU5WQUxJRF9QQVNTV09SRDogJ2F1dGgvd3JvbmctcGFzc3dvcmQnLFxuICBJTlZBTElEX1BFUlNJU1RFTkNFOiAnYXV0aC9pbnZhbGlkLXBlcnNpc3RlbmNlLXR5cGUnLFxuICBJTlZBTElEX1BIT05FX05VTUJFUjogJ2F1dGgvaW52YWxpZC1waG9uZS1udW1iZXInLFxuICBJTlZBTElEX1BST1ZJREVSX0lEOiAnYXV0aC9pbnZhbGlkLXByb3ZpZGVyLWlkJyxcbiAgSU5WQUxJRF9SRUNJUElFTlRfRU1BSUw6ICdhdXRoL2ludmFsaWQtcmVjaXBpZW50LWVtYWlsJyxcbiAgSU5WQUxJRF9TRU5ERVI6ICdhdXRoL2ludmFsaWQtc2VuZGVyJyxcbiAgSU5WQUxJRF9TRVNTSU9OX0lORk86ICdhdXRoL2ludmFsaWQtdmVyaWZpY2F0aW9uLWlkJyxcbiAgSU5WQUxJRF9URU5BTlRfSUQ6ICdhdXRoL2ludmFsaWQtdGVuYW50LWlkJyxcbiAgTUZBX0lORk9fTk9UX0ZPVU5EOiAnYXV0aC9tdWx0aS1mYWN0b3ItaW5mby1ub3QtZm91bmQnLFxuICBNRkFfUkVRVUlSRUQ6ICdhdXRoL211bHRpLWZhY3Rvci1hdXRoLXJlcXVpcmVkJyxcbiAgTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRTogJ2F1dGgvbWlzc2luZy1hbmRyb2lkLXBrZy1uYW1lJyxcbiAgTUlTU0lOR19BUFBfQ1JFREVOVElBTDogJ2F1dGgvbWlzc2luZy1hcHAtY3JlZGVudGlhbCcsXG4gIE1JU1NJTkdfQVVUSF9ET01BSU46ICdhdXRoL2F1dGgtZG9tYWluLWNvbmZpZy1yZXF1aXJlZCcsXG4gIE1JU1NJTkdfQ09ERTogJ2F1dGgvbWlzc2luZy12ZXJpZmljYXRpb24tY29kZScsXG4gIE1JU1NJTkdfQ09OVElOVUVfVVJJOiAnYXV0aC9taXNzaW5nLWNvbnRpbnVlLXVyaScsXG4gIE1JU1NJTkdfSUZSQU1FX1NUQVJUOiAnYXV0aC9taXNzaW5nLWlmcmFtZS1zdGFydCcsXG4gIE1JU1NJTkdfSU9TX0JVTkRMRV9JRDogJ2F1dGgvbWlzc2luZy1pb3MtYnVuZGxlLWlkJyxcbiAgTUlTU0lOR19PUl9JTlZBTElEX05PTkNFOiAnYXV0aC9taXNzaW5nLW9yLWludmFsaWQtbm9uY2UnLFxuICBNSVNTSU5HX01GQV9JTkZPOiAnYXV0aC9taXNzaW5nLW11bHRpLWZhY3Rvci1pbmZvJyxcbiAgTUlTU0lOR19NRkFfU0VTU0lPTjogJ2F1dGgvbWlzc2luZy1tdWx0aS1mYWN0b3Itc2Vzc2lvbicsXG4gIE1JU1NJTkdfUEhPTkVfTlVNQkVSOiAnYXV0aC9taXNzaW5nLXBob25lLW51bWJlcicsXG4gIE1JU1NJTkdfU0VTU0lPTl9JTkZPOiAnYXV0aC9taXNzaW5nLXZlcmlmaWNhdGlvbi1pZCcsXG4gIE1PRFVMRV9ERVNUUk9ZRUQ6ICdhdXRoL2FwcC1kZWxldGVkJyxcbiAgTkVFRF9DT05GSVJNQVRJT046ICdhdXRoL2FjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWwnLFxuICBORVRXT1JLX1JFUVVFU1RfRkFJTEVEOiAnYXV0aC9uZXR3b3JrLXJlcXVlc3QtZmFpbGVkJyxcbiAgTlVMTF9VU0VSOiAnYXV0aC9udWxsLXVzZXInLFxuICBOT19BVVRIX0VWRU5UOiAnYXV0aC9uby1hdXRoLWV2ZW50JyxcbiAgTk9fU1VDSF9QUk9WSURFUjogJ2F1dGgvbm8tc3VjaC1wcm92aWRlcicsXG4gIE9QRVJBVElPTl9OT1RfQUxMT1dFRDogJ2F1dGgvb3BlcmF0aW9uLW5vdC1hbGxvd2VkJyxcbiAgT1BFUkFUSU9OX05PVF9TVVBQT1JURUQ6ICdhdXRoL29wZXJhdGlvbi1ub3Qtc3VwcG9ydGVkLWluLXRoaXMtZW52aXJvbm1lbnQnLFxuICBQT1BVUF9CTE9DS0VEOiAnYXV0aC9wb3B1cC1ibG9ja2VkJyxcbiAgUE9QVVBfQ0xPU0VEX0JZX1VTRVI6ICdhdXRoL3BvcHVwLWNsb3NlZC1ieS11c2VyJyxcbiAgUFJPVklERVJfQUxSRUFEWV9MSU5LRUQ6ICdhdXRoL3Byb3ZpZGVyLWFscmVhZHktbGlua2VkJyxcbiAgUVVPVEFfRVhDRUVERUQ6ICdhdXRoL3F1b3RhLWV4Y2VlZGVkJyxcbiAgUkVESVJFQ1RfQ0FOQ0VMTEVEX0JZX1VTRVI6ICdhdXRoL3JlZGlyZWN0LWNhbmNlbGxlZC1ieS11c2VyJyxcbiAgUkVESVJFQ1RfT1BFUkFUSU9OX1BFTkRJTkc6ICdhdXRoL3JlZGlyZWN0LW9wZXJhdGlvbi1wZW5kaW5nJyxcbiAgUkVKRUNURURfQ1JFREVOVElBTDogJ2F1dGgvcmVqZWN0ZWQtY3JlZGVudGlhbCcsXG4gIFNFQ09ORF9GQUNUT1JfQUxSRUFEWV9FTlJPTExFRDogJ2F1dGgvc2Vjb25kLWZhY3Rvci1hbHJlYWR5LWluLXVzZScsXG4gIFNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQ6ICdhdXRoL21heGltdW0tc2Vjb25kLWZhY3Rvci1jb3VudC1leGNlZWRlZCcsXG4gIFRFTkFOVF9JRF9NSVNNQVRDSDogJ2F1dGgvdGVuYW50LWlkLW1pc21hdGNoJyxcbiAgVElNRU9VVDogJ2F1dGgvdGltZW91dCcsXG4gIFRPS0VOX0VYUElSRUQ6ICdhdXRoL3VzZXItdG9rZW4tZXhwaXJlZCcsXG4gIFRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUjogJ2F1dGgvdG9vLW1hbnktcmVxdWVzdHMnLFxuICBVTkFVVEhPUklaRURfRE9NQUlOOiAnYXV0aC91bmF1dGhvcml6ZWQtY29udGludWUtdXJpJyxcbiAgVU5TVVBQT1JURURfRklSU1RfRkFDVE9SOiAnYXV0aC91bnN1cHBvcnRlZC1maXJzdC1mYWN0b3InLFxuICBVTlNVUFBPUlRFRF9QRVJTSVNURU5DRTogJ2F1dGgvdW5zdXBwb3J0ZWQtcGVyc2lzdGVuY2UtdHlwZScsXG4gIFVOU1VQUE9SVEVEX1RFTkFOVF9PUEVSQVRJT046ICdhdXRoL3Vuc3VwcG9ydGVkLXRlbmFudC1vcGVyYXRpb24nLFxuICBVTlZFUklGSUVEX0VNQUlMOiAnYXV0aC91bnZlcmlmaWVkLWVtYWlsJyxcbiAgVVNFUl9DQU5DRUxMRUQ6ICdhdXRoL3VzZXItY2FuY2VsbGVkJyxcbiAgVVNFUl9ERUxFVEVEOiAnYXV0aC91c2VyLW5vdC1mb3VuZCcsXG4gIFVTRVJfRElTQUJMRUQ6ICdhdXRoL3VzZXItZGlzYWJsZWQnLFxuICBVU0VSX01JU01BVENIOiAnYXV0aC91c2VyLW1pc21hdGNoJyxcbiAgVVNFUl9TSUdORURfT1VUOiAnYXV0aC91c2VyLXNpZ25lZC1vdXQnLFxuICBXRUFLX1BBU1NXT1JEOiAnYXV0aC93ZWFrLXBhc3N3b3JkJyxcbiAgV0VCX1NUT1JBR0VfVU5TVVBQT1JURUQ6ICdhdXRoL3dlYi1zdG9yYWdlLXVuc3VwcG9ydGVkJyxcbiAgQUxSRUFEWV9JTklUSUFMSVpFRDogJ2F1dGgvYWxyZWFkeS1pbml0aWFsaXplZCcsXG4gIFJFQ0FQVENIQV9OT1RfRU5BQkxFRDogJ2F1dGgvcmVjYXB0Y2hhLW5vdC1lbmFibGVkJyxcbiAgTUlTU0lOR19SRUNBUFRDSEFfVE9LRU46ICdhdXRoL21pc3NpbmctcmVjYXB0Y2hhLXRva2VuJyxcbiAgSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU46ICdhdXRoL2ludmFsaWQtcmVjYXB0Y2hhLXRva2VuJyxcbiAgSU5WQUxJRF9SRUNBUFRDSEFfQUNUSU9OOiAnYXV0aC9pbnZhbGlkLXJlY2FwdGNoYS1hY3Rpb24nLFxuICBNSVNTSU5HX0NMSUVOVF9UWVBFOiAnYXV0aC9taXNzaW5nLWNsaWVudC10eXBlJyxcbiAgTUlTU0lOR19SRUNBUFRDSEFfVkVSU0lPTjogJ2F1dGgvbWlzc2luZy1yZWNhcHRjaGEtdmVyc2lvbicsXG4gIElOVkFMSURfUkVDQVBUQ0hBX1ZFUlNJT046ICdhdXRoL2ludmFsaWQtcmVjYXB0Y2hhLXZlcnNpb24nLFxuICBJTlZBTElEX1JFUV9UWVBFOiAnYXV0aC9pbnZhbGlkLXJlcS10eXBlJ1xufSBhcyBjb25zdDtcbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBMb2dnZXIsIExvZ0xldmVsIH0gZnJvbSAnQGZpcmViYXNlL2xvZ2dlcic7XG5pbXBvcnQgeyBTREtfVkVSU0lPTiB9IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuXG5leHBvcnQgeyBMb2dMZXZlbCB9O1xuXG5jb25zdCBsb2dDbGllbnQgPSBuZXcgTG9nZ2VyKCdAZmlyZWJhc2UvYXV0aCcpO1xuXG4vLyBIZWxwZXIgbWV0aG9kcyBhcmUgbmVlZGVkIGJlY2F1c2UgdmFyaWFibGVzIGNhbid0IGJlIGV4cG9ydGVkIGFzIHJlYWQvd3JpdGVcbmV4cG9ydCBmdW5jdGlvbiBfZ2V0TG9nTGV2ZWwoKTogTG9nTGV2ZWwge1xuICByZXR1cm4gbG9nQ2xpZW50LmxvZ0xldmVsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX3NldExvZ0xldmVsKG5ld0xldmVsOiBMb2dMZXZlbCk6IHZvaWQge1xuICBsb2dDbGllbnQubG9nTGV2ZWwgPSBuZXdMZXZlbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9sb2dEZWJ1Zyhtc2c6IHN0cmluZywgLi4uYXJnczogc3RyaW5nW10pOiB2b2lkIHtcbiAgaWYgKGxvZ0NsaWVudC5sb2dMZXZlbCA8PSBMb2dMZXZlbC5ERUJVRykge1xuICAgIGxvZ0NsaWVudC5kZWJ1ZyhgQXV0aCAoJHtTREtfVkVSU0lPTn0pOiAke21zZ31gLCAuLi5hcmdzKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX2xvZ1dhcm4obXNnOiBzdHJpbmcsIC4uLmFyZ3M6IHN0cmluZ1tdKTogdm9pZCB7XG4gIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuV0FSTikge1xuICAgIGxvZ0NsaWVudC53YXJuKGBBdXRoICgke1NES19WRVJTSU9OfSk6ICR7bXNnfWAsIC4uLmFyZ3MpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfbG9nRXJyb3IobXNnOiBzdHJpbmcsIC4uLmFyZ3M6IHN0cmluZ1tdKTogdm9pZCB7XG4gIGlmIChsb2dDbGllbnQubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuRVJST1IpIHtcbiAgICBsb2dDbGllbnQuZXJyb3IoYEF1dGggKCR7U0RLX1ZFUlNJT059KTogJHttc2d9YCwgLi4uYXJncyk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IEVycm9yRmFjdG9yeSwgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHtcbiAgX0RFRkFVTFRfQVVUSF9FUlJPUl9GQUNUT1JZLFxuICBBdXRoRXJyb3JDb2RlLFxuICBBdXRoRXJyb3JQYXJhbXMsXG4gIHByb2RFcnJvck1hcCxcbiAgRXJyb3JNYXBSZXRyaWV2ZXJcbn0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IF9sb2dFcnJvciB9IGZyb20gJy4vbG9nJztcblxudHlwZSBBdXRoRXJyb3JMaXN0UGFyYW1zPEs+ID0gSyBleHRlbmRzIGtleW9mIEF1dGhFcnJvclBhcmFtc1xuICA/IFtBdXRoRXJyb3JQYXJhbXNbS11dXG4gIDogW107XG50eXBlIExlc3NBcHBOYW1lPEsgZXh0ZW5kcyBBdXRoRXJyb3JDb2RlPiA9IE9taXQ8QXV0aEVycm9yUGFyYW1zW0tdLCAnYXBwTmFtZSc+O1xuXG4vKipcbiAqIFVuY29uZGl0aW9uYWxseSBmYWlscywgdGhyb3dpbmcgYSBkZXZlbG9wZXIgZmFjaW5nIElOVEVSTkFMX0VSUk9SXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGZhaWwoYXV0aCwgQXV0aEVycm9yQ29kZS5NRkFfUkVRVUlSRUQpOyAgLy8gRXJyb3I6IHRoZSBNRkFfUkVRVUlSRUQgZXJyb3IgbmVlZHMgbW9yZSBwYXJhbXMgdGhhbiBhcHBOYW1lXG4gKiBmYWlsKGF1dGgsIEF1dGhFcnJvckNvZGUuTUZBX1JFUVVJUkVELCB7c2VydmVyUmVzcG9uc2V9KTsgIC8vIENvbXBpbGVzXG4gKiBmYWlsKEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpOyAgLy8gQ29tcGlsZXM7IGludGVybmFsIGVycm9yIGRvZXMgbm90IG5lZWQgYXBwTmFtZVxuICogZmFpbChBdXRoRXJyb3JDb2RlLlVTRVJfREVMRVRFRCk7ICAvLyBFcnJvcjogVVNFUl9ERUxFVEVEIHJlcXVpcmVzIGFwcCBuYW1lXG4gKiBmYWlsKGF1dGgsIEF1dGhFcnJvckNvZGUuVVNFUl9ERUxFVEVEKTsgIC8vIENvbXBpbGVzOyBVU0VSX0RFTEVURUQgX29ubHlfIG5lZWRzIGFwcCBuYW1lXG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gYXBwTmFtZSBBcHAgbmFtZSBmb3IgdGFnZ2luZyB0aGUgZXJyb3JcbiAqIEB0aHJvd3MgRmlyZWJhc2VFcnJvclxuICovXG5leHBvcnQgZnVuY3Rpb24gX2ZhaWw8SyBleHRlbmRzIEF1dGhFcnJvckNvZGU+KFxuICBjb2RlOiBLLFxuICAuLi5kYXRhOiB7fSBleHRlbmRzIEF1dGhFcnJvclBhcmFtc1tLXVxuICAgID8gW0F1dGhFcnJvclBhcmFtc1tLXT9dXG4gICAgOiBbQXV0aEVycm9yUGFyYW1zW0tdXVxuKTogbmV2ZXI7XG5leHBvcnQgZnVuY3Rpb24gX2ZhaWw8SyBleHRlbmRzIEF1dGhFcnJvckNvZGU+KFxuICBhdXRoOiBBdXRoLFxuICBjb2RlOiBLLFxuICAuLi5kYXRhOiB7fSBleHRlbmRzIExlc3NBcHBOYW1lPEs+ID8gW0xlc3NBcHBOYW1lPEs+P10gOiBbTGVzc0FwcE5hbWU8Sz5dXG4pOiBuZXZlcjtcbmV4cG9ydCBmdW5jdGlvbiBfZmFpbDxLIGV4dGVuZHMgQXV0aEVycm9yQ29kZT4oXG4gIGF1dGhPckNvZGU6IEF1dGggfCBLLFxuICAuLi5yZXN0OiB1bmtub3duW11cbik6IG5ldmVyIHtcbiAgdGhyb3cgY3JlYXRlRXJyb3JJbnRlcm5hbChhdXRoT3JDb2RlLCAuLi5yZXN0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9jcmVhdGVFcnJvcjxLIGV4dGVuZHMgQXV0aEVycm9yQ29kZT4oXG4gIGNvZGU6IEssXG4gIC4uLmRhdGE6IHt9IGV4dGVuZHMgQXV0aEVycm9yUGFyYW1zW0tdXG4gICAgPyBbQXV0aEVycm9yUGFyYW1zW0tdP11cbiAgICA6IFtBdXRoRXJyb3JQYXJhbXNbS11dXG4pOiBGaXJlYmFzZUVycm9yO1xuZXhwb3J0IGZ1bmN0aW9uIF9jcmVhdGVFcnJvcjxLIGV4dGVuZHMgQXV0aEVycm9yQ29kZT4oXG4gIGF1dGg6IEF1dGgsXG4gIGNvZGU6IEssXG4gIC4uLmRhdGE6IHt9IGV4dGVuZHMgTGVzc0FwcE5hbWU8Sz4gPyBbTGVzc0FwcE5hbWU8Sz4/XSA6IFtMZXNzQXBwTmFtZTxLPl1cbik6IEZpcmViYXNlRXJyb3I7XG5leHBvcnQgZnVuY3Rpb24gX2NyZWF0ZUVycm9yPEsgZXh0ZW5kcyBBdXRoRXJyb3JDb2RlPihcbiAgYXV0aE9yQ29kZTogQXV0aCB8IEssXG4gIC4uLnJlc3Q6IHVua25vd25bXVxuKTogRmlyZWJhc2VFcnJvciB7XG4gIHJldHVybiBjcmVhdGVFcnJvckludGVybmFsKGF1dGhPckNvZGUsIC4uLnJlc3QpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2Vycm9yV2l0aEN1c3RvbU1lc3NhZ2UoXG4gIGF1dGg6IEF1dGgsXG4gIGNvZGU6IEF1dGhFcnJvckNvZGUsXG4gIG1lc3NhZ2U6IHN0cmluZ1xuKTogRmlyZWJhc2VFcnJvciB7XG4gIGNvbnN0IGVycm9yTWFwID0ge1xuICAgIC4uLihwcm9kRXJyb3JNYXAgYXMgRXJyb3JNYXBSZXRyaWV2ZXIpKCksXG4gICAgW2NvZGVdOiBtZXNzYWdlXG4gIH07XG4gIGNvbnN0IGZhY3RvcnkgPSBuZXcgRXJyb3JGYWN0b3J5PEF1dGhFcnJvckNvZGUsIEF1dGhFcnJvclBhcmFtcz4oXG4gICAgJ2F1dGgnLFxuICAgICdGaXJlYmFzZScsXG4gICAgZXJyb3JNYXBcbiAgKTtcbiAgcmV0dXJuIGZhY3RvcnkuY3JlYXRlKGNvZGUsIHtcbiAgICBhcHBOYW1lOiBhdXRoLm5hbWVcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfYXNzZXJ0SW5zdGFuY2VPZihcbiAgYXV0aDogQXV0aCxcbiAgb2JqZWN0OiBvYmplY3QsXG4gIGluc3RhbmNlOiB1bmtub3duXG4pOiB2b2lkIHtcbiAgY29uc3QgY29uc3RydWN0b3JJbnN0YW5jZSA9IGluc3RhbmNlIGFzIHsgbmV3ICguLi5hcmdzOiB1bmtub3duW10pOiB1bmtub3duIH07XG4gIGlmICghKG9iamVjdCBpbnN0YW5jZW9mIGNvbnN0cnVjdG9ySW5zdGFuY2UpKSB7XG4gICAgaWYgKGNvbnN0cnVjdG9ySW5zdGFuY2UubmFtZSAhPT0gb2JqZWN0LmNvbnN0cnVjdG9yLm5hbWUpIHtcbiAgICAgIF9mYWlsKGF1dGgsIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IpO1xuICAgIH1cblxuICAgIHRocm93IF9lcnJvcldpdGhDdXN0b21NZXNzYWdlKFxuICAgICAgYXV0aCxcbiAgICAgIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IsXG4gICAgICBgVHlwZSBvZiAke29iamVjdC5jb25zdHJ1Y3Rvci5uYW1lfSBkb2VzIG5vdCBtYXRjaCBleHBlY3RlZCBpbnN0YW5jZS5gICtcbiAgICAgICAgYERpZCB5b3UgcGFzcyBhIHJlZmVyZW5jZSBmcm9tIGEgZGlmZmVyZW50IEF1dGggU0RLP2BcbiAgICApO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUVycm9ySW50ZXJuYWw8SyBleHRlbmRzIEF1dGhFcnJvckNvZGU+KFxuICBhdXRoT3JDb2RlOiBBdXRoIHwgSyxcbiAgLi4ucmVzdDogdW5rbm93bltdXG4pOiBGaXJlYmFzZUVycm9yIHtcbiAgaWYgKHR5cGVvZiBhdXRoT3JDb2RlICE9PSAnc3RyaW5nJykge1xuICAgIGNvbnN0IGNvZGUgPSByZXN0WzBdIGFzIEs7XG4gICAgY29uc3QgZnVsbFBhcmFtcyA9IFsuLi5yZXN0LnNsaWNlKDEpXSBhcyBBdXRoRXJyb3JMaXN0UGFyYW1zPEs+O1xuICAgIGlmIChmdWxsUGFyYW1zWzBdKSB7XG4gICAgICBmdWxsUGFyYW1zWzBdLmFwcE5hbWUgPSBhdXRoT3JDb2RlLm5hbWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIChhdXRoT3JDb2RlIGFzIEF1dGhJbnRlcm5hbCkuX2Vycm9yRmFjdG9yeS5jcmVhdGUoXG4gICAgICBjb2RlLFxuICAgICAgLi4uZnVsbFBhcmFtc1xuICAgICk7XG4gIH1cblxuICByZXR1cm4gX0RFRkFVTFRfQVVUSF9FUlJPUl9GQUNUT1JZLmNyZWF0ZShcbiAgICBhdXRoT3JDb2RlLFxuICAgIC4uLihyZXN0IGFzIEF1dGhFcnJvckxpc3RQYXJhbXM8Sz4pXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfYXNzZXJ0PEsgZXh0ZW5kcyBBdXRoRXJyb3JDb2RlPihcbiAgYXNzZXJ0aW9uOiB1bmtub3duLFxuICBjb2RlOiBLLFxuICAuLi5kYXRhOiB7fSBleHRlbmRzIEF1dGhFcnJvclBhcmFtc1tLXVxuICAgID8gW0F1dGhFcnJvclBhcmFtc1tLXT9dXG4gICAgOiBbQXV0aEVycm9yUGFyYW1zW0tdXVxuKTogYXNzZXJ0cyBhc3NlcnRpb247XG5leHBvcnQgZnVuY3Rpb24gX2Fzc2VydDxLIGV4dGVuZHMgQXV0aEVycm9yQ29kZT4oXG4gIGFzc2VydGlvbjogdW5rbm93bixcbiAgYXV0aDogQXV0aCxcbiAgY29kZTogSyxcbiAgLi4uZGF0YToge30gZXh0ZW5kcyBMZXNzQXBwTmFtZTxLPiA/IFtMZXNzQXBwTmFtZTxLPj9dIDogW0xlc3NBcHBOYW1lPEs+XVxuKTogYXNzZXJ0cyBhc3NlcnRpb247XG5leHBvcnQgZnVuY3Rpb24gX2Fzc2VydDxLIGV4dGVuZHMgQXV0aEVycm9yQ29kZT4oXG4gIGFzc2VydGlvbjogdW5rbm93bixcbiAgYXV0aE9yQ29kZTogQXV0aCB8IEssXG4gIC4uLnJlc3Q6IHVua25vd25bXVxuKTogYXNzZXJ0cyBhc3NlcnRpb24ge1xuICBpZiAoIWFzc2VydGlvbikge1xuICAgIHRocm93IGNyZWF0ZUVycm9ySW50ZXJuYWwoYXV0aE9yQ29kZSwgLi4ucmVzdCk7XG4gIH1cbn1cblxuLy8gV2UgcmVhbGx5IGRvIHdhbnQgdG8gYWNjZXB0IGxpdGVyYWxseSBhbnkgZnVuY3Rpb24gdHlwZSBoZXJlXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L2Jhbi10eXBlc1xudHlwZSBUeXBlRXhwZWN0YXRpb24gPSBGdW5jdGlvbiB8IHN0cmluZyB8IE1hcFR5cGU7XG5cbmludGVyZmFjZSBNYXBUeXBlIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgVHlwZUV4cGVjdGF0aW9uIHwgT3B0aW9uYWw+IHt9XG5cbmNsYXNzIE9wdGlvbmFsIHtcbiAgY29uc3RydWN0b3IocmVhZG9ubHkgdHlwZTogVHlwZUV4cGVjdGF0aW9uKSB7fVxufVxuXG5leHBvcnQgZnVuY3Rpb24gb3B0KHR5cGU6IFR5cGVFeHBlY3RhdGlvbik6IE9wdGlvbmFsIHtcbiAgcmV0dXJuIG5ldyBPcHRpb25hbCh0eXBlKTtcbn1cblxuLyoqXG4gKiBBc3NlcnRzIHRoZSBydW50aW1lIHR5cGVzIG9mIGFyZ3VtZW50cy4gVGhlICdleHBlY3RlZCcgZmllbGQgY2FuIGJlIG9uZSBvZlxuICogYSBjbGFzcywgYSBzdHJpbmcgKHJlcHJlc2VudGluZyBhIFwidHlwZW9mXCIgY2FsbCksIG9yIGEgcmVjb3JkIG1hcCBvZiBuYW1lXG4gKiB0byB0eXBlLiBGdXJ0aGVybW9yZSwgdGhlIG9wdCgpIGZ1bmN0aW9uIGNhbiBiZSB1c2VkIHRvIG1hcmsgYSBmaWVsZCBhc1xuICogb3B0aW9uYWwuIEZvciBleGFtcGxlOlxuICpcbiAqIGZ1bmN0aW9uIGZvbyhhdXRoOiBBdXRoLCBwcm9maWxlOiB7ZGlzcGxheU5hbWU/OiBzdHJpbmd9LCB1cGRhdGUgPSBmYWxzZSkge1xuICogICBhc3NlcnRUeXBlcyhhcmd1bWVudHMsIFtBdXRoSW1wbCwge2Rpc3BsYXlOYW1lOiBvcHQoJ3N0cmluZycpfSwgb3B0KCdib29sZWFuJyldKTtcbiAqIH1cbiAqXG4gKiBvcHQoKSBjYW4gYmUgdXNlZCBmb3IgYW55IHR5cGU6XG4gKiBmdW5jdGlvbiBmb28oYXV0aD86IEF1dGgpIHtcbiAqICAgYXNzZXJ0VHlwZXMoYXJndW1lbnRzLCBbb3B0KEF1dGhJbXBsKV0pO1xuICogfVxuICpcbiAqIFRoZSBzdHJpbmcgdHlwZXMgY2FuIGJlIG9yJ2QgdG9nZXRoZXIsIGFuZCB5b3UgY2FuIHVzZSBcIm51bGxcIiBhcyB3ZWxsIChub3RlXG4gKiB0aGF0IHR5cGVvZiBudWxsID09PSAnb2JqZWN0JzsgdGhpcyBpcyBhbiBlZGdlIGNhc2UpLiBGb3IgZXhhbXBsZTpcbiAqXG4gKiBmdW5jdGlvbiBmb28ocHJvZmlsZToge2Rpc3BsYXlOYW1lPzogc3RyaW5nIHwgbnVsbH0pIHtcbiAqICAgYXNzZXJ0VHlwZXMoYXJndW1lbnRzLCBbe2Rpc3BsYXlOYW1lOiBvcHQoJ3N0cmluZ3xudWxsJyl9XSk7XG4gKiB9XG4gKlxuICogQHBhcmFtIGFyZ3NcbiAqIEBwYXJhbSBleHBlY3RlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0VHlwZXMoXG4gIGFyZ3M6IE9taXQ8SUFyZ3VtZW50cywgJ2NhbGxlZSc+LFxuICAuLi5leHBlY3RlZDogQXJyYXk8VHlwZUV4cGVjdGF0aW9uIHwgT3B0aW9uYWw+XG4pOiB2b2lkIHtcbiAgaWYgKGFyZ3MubGVuZ3RoID4gZXhwZWN0ZWQubGVuZ3RoKSB7XG4gICAgX2ZhaWwoQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiwge30pO1xuICB9XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBleHBlY3RlZC5sZW5ndGg7IGkrKykge1xuICAgIGxldCBleHBlY3QgPSBleHBlY3RlZFtpXTtcbiAgICBjb25zdCBhcmcgPSBhcmdzW2ldO1xuXG4gICAgaWYgKGV4cGVjdCBpbnN0YW5jZW9mIE9wdGlvbmFsKSB7XG4gICAgICAvLyBJZiB0aGUgYXJnIGlzIHVuZGVmaW5lZCwgdGhlbiBpdCBtYXRjaGVzIFwib3B0aW9uYWxcIiBhbmQgd2UgY2FuIG1vdmUgdG9cbiAgICAgIC8vIHRoZSBuZXh0IGFyZ1xuICAgICAgaWYgKHR5cGVvZiBhcmcgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgZXhwZWN0ID0gZXhwZWN0LnR5cGU7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBleHBlY3QgPT09ICdzdHJpbmcnKSB7XG4gICAgICAvLyBIYW5kbGUgdGhlIGVkZ2UgY2FzZSBmb3IgbnVsbCBiZWNhdXNlIHR5cGVvZiBudWxsID09PSAnb2JqZWN0J1xuICAgICAgaWYgKGV4cGVjdC5pbmNsdWRlcygnbnVsbCcpICYmIGFyZyA9PT0gbnVsbCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVxdWlyZWQgPSBleHBlY3Quc3BsaXQoJ3wnKTtcbiAgICAgIF9hc3NlcnQocmVxdWlyZWQuaW5jbHVkZXModHlwZW9mIGFyZyksIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IsIHt9KTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBleHBlY3QgPT09ICdvYmplY3QnKSB7XG4gICAgICAvLyBSZWN1cnNpdmVseSBjaGVjayByZWNvcmQgYXJndW1lbnRzXG4gICAgICBjb25zdCByZWNvcmQgPSBhcmcgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICBjb25zdCBtYXAgPSBleHBlY3QgYXMgTWFwVHlwZTtcbiAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhleHBlY3QpO1xuXG4gICAgICBhc3NlcnRUeXBlcyhcbiAgICAgICAga2V5cy5tYXAoayA9PiByZWNvcmRba10pLFxuICAgICAgICAuLi5rZXlzLm1hcChrID0+IG1hcFtrXSlcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIF9hc3NlcnQoYXJnIGluc3RhbmNlb2YgZXhwZWN0LCBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SLCB7fSk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogVW5jb25kaXRpb25hbGx5IGZhaWxzLCB0aHJvd2luZyBhbiBpbnRlcm5hbCBlcnJvciB3aXRoIHRoZSBnaXZlbiBtZXNzYWdlLlxuICpcbiAqIEBwYXJhbSBmYWlsdXJlIHR5cGUgb2YgZmFpbHVyZSBlbmNvdW50ZXJlZFxuICogQHRocm93cyBFcnJvclxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVidWdGYWlsKGZhaWx1cmU6IHN0cmluZyk6IG5ldmVyIHtcbiAgLy8gTG9nIHRoZSBmYWlsdXJlIGluIGFkZGl0aW9uIHRvIHRocm93IGFuIGV4Y2VwdGlvbiwganVzdCBpbiBjYXNlIHRoZVxuICAvLyBleGNlcHRpb24gaXMgc3dhbGxvd2VkLlxuICBjb25zdCBtZXNzYWdlID0gYElOVEVSTkFMIEFTU0VSVElPTiBGQUlMRUQ6IGAgKyBmYWlsdXJlO1xuICBfbG9nRXJyb3IobWVzc2FnZSk7XG5cbiAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIEZpcmViYXNlRXJyb3IgaGVyZSBiZWNhdXNlIHRoZXNlIGFyZSBpbnRlcm5hbCBmYWlsdXJlc1xuICAvLyB0aGF0IGNhbm5vdCBiZSBoYW5kbGVkIGJ5IHRoZSB1c2VyLiAoQWxzbyBpdCB3b3VsZCBjcmVhdGUgYSBjaXJjdWxhclxuICAvLyBkZXBlbmRlbmN5IGJldHdlZW4gdGhlIGVycm9yIGFuZCBhc3NlcnQgbW9kdWxlcyB3aGljaCBkb2Vzbid0IHdvcmsuKVxuICB0aHJvdyBuZXcgRXJyb3IobWVzc2FnZSk7XG59XG5cbi8qKlxuICogRmFpbHMgaWYgdGhlIGdpdmVuIGFzc2VydGlvbiBjb25kaXRpb24gaXMgZmFsc2UsIHRocm93aW5nIGFuIEVycm9yIHdpdGggdGhlXG4gKiBnaXZlbiBtZXNzYWdlIGlmIGl0IGRpZC5cbiAqXG4gKiBAcGFyYW0gYXNzZXJ0aW9uXG4gKiBAcGFyYW0gbWVzc2FnZVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVidWdBc3NlcnQoXG4gIGFzc2VydGlvbjogdW5rbm93bixcbiAgbWVzc2FnZTogc3RyaW5nXG4pOiBhc3NlcnRzIGFzc2VydGlvbiB7XG4gIGlmICghYXNzZXJ0aW9uKSB7XG4gICAgZGVidWdGYWlsKG1lc3NhZ2UpO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIF9nZXRDdXJyZW50VXJsKCk6IHN0cmluZyB7XG4gIHJldHVybiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmIHNlbGYubG9jYXRpb24/LmhyZWYpIHx8ICcnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2lzSHR0cE9ySHR0cHMoKTogYm9vbGVhbiB7XG4gIHJldHVybiBfZ2V0Q3VycmVudFNjaGVtZSgpID09PSAnaHR0cDonIHx8IF9nZXRDdXJyZW50U2NoZW1lKCkgPT09ICdodHRwczonO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2dldEN1cnJlbnRTY2hlbWUoKTogc3RyaW5nIHwgbnVsbCB7XG4gIHJldHVybiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmIHNlbGYubG9jYXRpb24/LnByb3RvY29sKSB8fCBudWxsO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGlzQnJvd3NlckV4dGVuc2lvbiB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IF9pc0h0dHBPckh0dHBzIH0gZnJvbSAnLi9sb2NhdGlvbic7XG5cbi8qKlxuICogRGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGJyb3dzZXIgaXMgd29ya2luZyBvbmxpbmVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9pc09ubGluZSgpOiBib29sZWFuIHtcbiAgaWYgKFxuICAgIHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmXG4gICAgbmF2aWdhdG9yICYmXG4gICAgJ29uTGluZScgaW4gbmF2aWdhdG9yICYmXG4gICAgdHlwZW9mIG5hdmlnYXRvci5vbkxpbmUgPT09ICdib29sZWFuJyAmJlxuICAgIC8vIEFwcGx5IG9ubHkgZm9yIHRyYWRpdGlvbmFsIHdlYiBhcHBzIGFuZCBDaHJvbWUgZXh0ZW5zaW9ucy5cbiAgICAvLyBUaGlzIGlzIGVzcGVjaWFsbHkgdHJ1ZSBmb3IgQ29yZG92YSBhcHBzIHdoaWNoIGhhdmUgdW5yZWxpYWJsZVxuICAgIC8vIG5hdmlnYXRvci5vbkxpbmUgYmVoYXZpb3IgdW5sZXNzIGNvcmRvdmEtcGx1Z2luLW5ldHdvcmstaW5mb3JtYXRpb24gaXNcbiAgICAvLyBpbnN0YWxsZWQgd2hpY2ggb3ZlcndyaXRlcyB0aGUgbmF0aXZlIG5hdmlnYXRvci5vbkxpbmUgdmFsdWUgYW5kXG4gICAgLy8gZGVmaW5lcyBuYXZpZ2F0b3IuY29ubmVjdGlvbi5cbiAgICAoX2lzSHR0cE9ySHR0cHMoKSB8fCBpc0Jyb3dzZXJFeHRlbnNpb24oKSB8fCAnY29ubmVjdGlvbicgaW4gbmF2aWdhdG9yKVxuICApIHtcbiAgICByZXR1cm4gbmF2aWdhdG9yLm9uTGluZTtcbiAgfVxuICAvLyBJZiB3ZSBjYW4ndCBkZXRlcm1pbmUgdGhlIHN0YXRlLCBhc3N1bWUgaXQgaXMgb25saW5lLlxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9nZXRVc2VyTGFuZ3VhZ2UoKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmICh0eXBlb2YgbmF2aWdhdG9yID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IG5hdmlnYXRvckxhbmd1YWdlOiBOYXZpZ2F0b3JMYW5ndWFnZSA9IG5hdmlnYXRvcjtcbiAgcmV0dXJuIChcbiAgICAvLyBNb3N0IHJlbGlhYmxlLCBidXQgb25seSBzdXBwb3J0ZWQgaW4gQ2hyb21lL0ZpcmVmb3guXG4gICAgKG5hdmlnYXRvckxhbmd1YWdlLmxhbmd1YWdlcyAmJiBuYXZpZ2F0b3JMYW5ndWFnZS5sYW5ndWFnZXNbMF0pIHx8XG4gICAgLy8gU3VwcG9ydGVkIGluIG1vc3QgYnJvd3NlcnMsIGJ1dCByZXR1cm5zIHRoZSBsYW5ndWFnZSBvZiB0aGUgYnJvd3NlclxuICAgIC8vIFVJLCBub3QgdGhlIGxhbmd1YWdlIHNldCBpbiBicm93c2VyIHNldHRpbmdzLlxuICAgIG5hdmlnYXRvckxhbmd1YWdlLmxhbmd1YWdlIHx8XG4gICAgLy8gQ291bGRuJ3QgZGV0ZXJtaW5lIGxhbmd1YWdlLlxuICAgIG51bGxcbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBpc01vYmlsZUNvcmRvdmEsIGlzUmVhY3ROYXRpdmUgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBfaXNPbmxpbmUgfSBmcm9tICcuL25hdmlnYXRvcic7XG5pbXBvcnQgeyBkZWJ1Z0Fzc2VydCB9IGZyb20gJy4vYXNzZXJ0JztcblxuZXhwb3J0IGNvbnN0IGVudW0gRGVsYXlNaW4ge1xuICBPRkZMSU5FID0gNTAwMFxufVxuXG4vKipcbiAqIEEgc3RydWN0dXJlIHRvIGhlbHAgcGljayBiZXR3ZWVuIGEgcmFuZ2Ugb2YgbG9uZyBhbmQgc2hvcnQgZGVsYXkgZHVyYXRpb25zXG4gKiBkZXBlbmRpbmcgb24gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuIEluIGdlbmVyYWwsIHRoZSBsb25nIGRlbGF5IGlzIHVzZWQgZm9yXG4gKiBtb2JpbGUgZW52aXJvbm1lbnRzIHdoZXJlYXMgc2hvcnQgZGVsYXlzIGFyZSB1c2VkIGZvciBkZXNrdG9wIGVudmlyb25tZW50cy5cbiAqL1xuZXhwb3J0IGNsYXNzIERlbGF5IHtcbiAgLy8gVGhlIGRlZmF1bHQgdmFsdWUgZm9yIHRoZSBvZmZsaW5lIGRlbGF5IHRpbWVvdXQgaW4gbXMuXG5cbiAgcHJpdmF0ZSByZWFkb25seSBpc01vYmlsZTogYm9vbGVhbjtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJpdmF0ZSByZWFkb25seSBzaG9ydERlbGF5OiBudW1iZXIsXG4gICAgcHJpdmF0ZSByZWFkb25seSBsb25nRGVsYXk6IG51bWJlclxuICApIHtcbiAgICAvLyBJbnRlcm5hbCBlcnJvciB3aGVuIGltcHJvcGVybHkgaW5pdGlhbGl6ZWQuXG4gICAgZGVidWdBc3NlcnQoXG4gICAgICBsb25nRGVsYXkgPiBzaG9ydERlbGF5LFxuICAgICAgJ1Nob3J0IGRlbGF5IHNob3VsZCBiZSBsZXNzIHRoYW4gbG9uZyBkZWxheSEnXG4gICAgKTtcbiAgICB0aGlzLmlzTW9iaWxlID0gaXNNb2JpbGVDb3Jkb3ZhKCkgfHwgaXNSZWFjdE5hdGl2ZSgpO1xuICB9XG5cbiAgZ2V0KCk6IG51bWJlciB7XG4gICAgaWYgKCFfaXNPbmxpbmUoKSkge1xuICAgICAgLy8gUGljayB0aGUgc2hvcnRlciB0aW1lb3V0LlxuICAgICAgcmV0dXJuIE1hdGgubWluKERlbGF5TWluLk9GRkxJTkUsIHRoaXMuc2hvcnREZWxheSk7XG4gICAgfVxuICAgIC8vIElmIHJ1bm5pbmcgaW4gYSBtb2JpbGUgZW52aXJvbm1lbnQsIHJldHVybiB0aGUgbG9uZyBkZWxheSwgb3RoZXJ3aXNlXG4gICAgLy8gcmV0dXJuIHRoZSBzaG9ydCBkZWxheS5cbiAgICAvLyBUaGlzIGNvdWxkIGJlIGltcHJvdmVkIGluIHRoZSBmdXR1cmUgdG8gZHluYW1pY2FsbHkgY2hhbmdlIGJhc2VkIG9uIG90aGVyXG4gICAgLy8gdmFyaWFibGVzIGluc3RlYWQgb2YganVzdCByZWFkaW5nIHRoZSBjdXJyZW50IGVudmlyb25tZW50LlxuICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gdGhpcy5sb25nRGVsYXkgOiB0aGlzLnNob3J0RGVsYXk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBDb25maWdJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgZGVidWdBc3NlcnQgfSBmcm9tICcuL2Fzc2VydCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBfZW11bGF0b3JVcmwoY29uZmlnOiBDb25maWdJbnRlcm5hbCwgcGF0aD86IHN0cmluZyk6IHN0cmluZyB7XG4gIGRlYnVnQXNzZXJ0KGNvbmZpZy5lbXVsYXRvciwgJ0VtdWxhdG9yIHNob3VsZCBhbHdheXMgYmUgc2V0IGhlcmUnKTtcbiAgY29uc3QgeyB1cmwgfSA9IGNvbmZpZy5lbXVsYXRvcjtcblxuICBpZiAoIXBhdGgpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG5cbiAgcmV0dXJuIGAke3VybH0ke3BhdGguc3RhcnRzV2l0aCgnLycpID8gcGF0aC5zbGljZSgxKSA6IHBhdGh9YDtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBkZWJ1Z0ZhaWwgfSBmcm9tICcuL2Fzc2VydCc7XG5cbmV4cG9ydCBjbGFzcyBGZXRjaFByb3ZpZGVyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgZmV0Y2hJbXBsOiB0eXBlb2YgZmV0Y2ggfCBudWxsO1xuICBwcml2YXRlIHN0YXRpYyBoZWFkZXJzSW1wbDogdHlwZW9mIEhlYWRlcnMgfCBudWxsO1xuICBwcml2YXRlIHN0YXRpYyByZXNwb25zZUltcGw6IHR5cGVvZiBSZXNwb25zZSB8IG51bGw7XG5cbiAgc3RhdGljIGluaXRpYWxpemUoXG4gICAgZmV0Y2hJbXBsOiB0eXBlb2YgZmV0Y2gsXG4gICAgaGVhZGVyc0ltcGw/OiB0eXBlb2YgSGVhZGVycyxcbiAgICByZXNwb25zZUltcGw/OiB0eXBlb2YgUmVzcG9uc2VcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5mZXRjaEltcGwgPSBmZXRjaEltcGw7XG4gICAgaWYgKGhlYWRlcnNJbXBsKSB7XG4gICAgICB0aGlzLmhlYWRlcnNJbXBsID0gaGVhZGVyc0ltcGw7XG4gICAgfVxuICAgIGlmIChyZXNwb25zZUltcGwpIHtcbiAgICAgIHRoaXMucmVzcG9uc2VJbXBsID0gcmVzcG9uc2VJbXBsO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRpYyBmZXRjaCgpOiB0eXBlb2YgZmV0Y2gge1xuICAgIGlmICh0aGlzLmZldGNoSW1wbCkge1xuICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hJbXBsO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnICYmICdmZXRjaCcgaW4gc2VsZikge1xuICAgICAgcmV0dXJuIHNlbGYuZmV0Y2g7XG4gICAgfVxuICAgIGRlYnVnRmFpbChcbiAgICAgICdDb3VsZCBub3QgZmluZCBmZXRjaCBpbXBsZW1lbnRhdGlvbiwgbWFrZSBzdXJlIHlvdSBjYWxsIEZldGNoUHJvdmlkZXIuaW5pdGlhbGl6ZSgpIHdpdGggYW4gYXBwcm9wcmlhdGUgcG9seWZpbGwnXG4gICAgKTtcbiAgfVxuXG4gIHN0YXRpYyBoZWFkZXJzKCk6IHR5cGVvZiBIZWFkZXJzIHtcbiAgICBpZiAodGhpcy5oZWFkZXJzSW1wbCkge1xuICAgICAgcmV0dXJuIHRoaXMuaGVhZGVyc0ltcGw7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgJ0hlYWRlcnMnIGluIHNlbGYpIHtcbiAgICAgIHJldHVybiBzZWxmLkhlYWRlcnM7XG4gICAgfVxuICAgIGRlYnVnRmFpbChcbiAgICAgICdDb3VsZCBub3QgZmluZCBIZWFkZXJzIGltcGxlbWVudGF0aW9uLCBtYWtlIHN1cmUgeW91IGNhbGwgRmV0Y2hQcm92aWRlci5pbml0aWFsaXplKCkgd2l0aCBhbiBhcHByb3ByaWF0ZSBwb2x5ZmlsbCdcbiAgICApO1xuICB9XG5cbiAgc3RhdGljIHJlc3BvbnNlKCk6IHR5cGVvZiBSZXNwb25zZSB7XG4gICAgaWYgKHRoaXMucmVzcG9uc2VJbXBsKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZXNwb25zZUltcGw7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgJiYgJ1Jlc3BvbnNlJyBpbiBzZWxmKSB7XG4gICAgICByZXR1cm4gc2VsZi5SZXNwb25zZTtcbiAgICB9XG4gICAgZGVidWdGYWlsKFxuICAgICAgJ0NvdWxkIG5vdCBmaW5kIFJlc3BvbnNlIGltcGxlbWVudGF0aW9uLCBtYWtlIHN1cmUgeW91IGNhbGwgRmV0Y2hQcm92aWRlci5pbml0aWFsaXplKCkgd2l0aCBhbiBhcHByb3ByaWF0ZSBwb2x5ZmlsbCdcbiAgICApO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2NvcmUvZXJyb3JzJztcblxuLyoqXG4gKiBFcnJvcnMgdGhhdCBjYW4gYmUgcmV0dXJuZWQgYnkgdGhlIGJhY2tlbmRcbiAqL1xuZXhwb3J0IGNvbnN0IGVudW0gU2VydmVyRXJyb3Ige1xuICBBRE1JTl9PTkxZX09QRVJBVElPTiA9ICdBRE1JTl9PTkxZX09QRVJBVElPTicsXG4gIEJMT0NLSU5HX0ZVTkNUSU9OX0VSUk9SX1JFU1BPTlNFID0gJ0JMT0NLSU5HX0ZVTkNUSU9OX0VSUk9SX1JFU1BPTlNFJyxcbiAgQ0FQVENIQV9DSEVDS19GQUlMRUQgPSAnQ0FQVENIQV9DSEVDS19GQUlMRUQnLFxuICBDT1JTX1VOU1VQUE9SVEVEID0gJ0NPUlNfVU5TVVBQT1JURUQnLFxuICBDUkVERU5USUFMX01JU01BVENIID0gJ0NSRURFTlRJQUxfTUlTTUFUQ0gnLFxuICBDUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU4gPSAnQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOJyxcbiAgRFlOQU1JQ19MSU5LX05PVF9BQ1RJVkFURUQgPSAnRFlOQU1JQ19MSU5LX05PVF9BQ1RJVkFURUQnLFxuICBFTUFJTF9DSEFOR0VfTkVFRFNfVkVSSUZJQ0FUSU9OID0gJ0VNQUlMX0NIQU5HRV9ORUVEU19WRVJJRklDQVRJT04nLFxuICBFTUFJTF9FWElTVFMgPSAnRU1BSUxfRVhJU1RTJyxcbiAgRU1BSUxfTk9UX0ZPVU5EID0gJ0VNQUlMX05PVF9GT1VORCcsXG4gIEVYUElSRURfT09CX0NPREUgPSAnRVhQSVJFRF9PT0JfQ09ERScsXG4gIEZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEID0gJ0ZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEJyxcbiAgSU5WQUxJRF9BUFBfQ1JFREVOVElBTCA9ICdJTlZBTElEX0FQUF9DUkVERU5USUFMJyxcbiAgSU5WQUxJRF9BUFBfSUQgPSAnSU5WQUxJRF9BUFBfSUQnLFxuICBJTlZBTElEX0NFUlRfSEFTSCA9ICdJTlZBTElEX0NFUlRfSEFTSCcsXG4gIElOVkFMSURfQ09ERSA9ICdJTlZBTElEX0NPREUnLFxuICBJTlZBTElEX0NPTlRJTlVFX1VSSSA9ICdJTlZBTElEX0NPTlRJTlVFX1VSSScsXG4gIElOVkFMSURfQ1VTVE9NX1RPS0VOID0gJ0lOVkFMSURfQ1VTVE9NX1RPS0VOJyxcbiAgSU5WQUxJRF9EWU5BTUlDX0xJTktfRE9NQUlOID0gJ0lOVkFMSURfRFlOQU1JQ19MSU5LX0RPTUFJTicsXG4gIElOVkFMSURfRU1BSUwgPSAnSU5WQUxJRF9FTUFJTCcsXG4gIElOVkFMSURfSURfVE9LRU4gPSAnSU5WQUxJRF9JRF9UT0tFTicsXG4gIElOVkFMSURfSURQX1JFU1BPTlNFID0gJ0lOVkFMSURfSURQX1JFU1BPTlNFJyxcbiAgSU5WQUxJRF9JREVOVElGSUVSID0gJ0lOVkFMSURfSURFTlRJRklFUicsXG4gIElOVkFMSURfTUVTU0FHRV9QQVlMT0FEID0gJ0lOVkFMSURfTUVTU0FHRV9QQVlMT0FEJyxcbiAgSU5WQUxJRF9NRkFfUEVORElOR19DUkVERU5USUFMID0gJ0lOVkFMSURfTUZBX1BFTkRJTkdfQ1JFREVOVElBTCcsXG4gIElOVkFMSURfT0FVVEhfQ0xJRU5UX0lEID0gJ0lOVkFMSURfT0FVVEhfQ0xJRU5UX0lEJyxcbiAgSU5WQUxJRF9PT0JfQ09ERSA9ICdJTlZBTElEX09PQl9DT0RFJyxcbiAgSU5WQUxJRF9QQVNTV09SRCA9ICdJTlZBTElEX1BBU1NXT1JEJyxcbiAgSU5WQUxJRF9QRU5ESU5HX1RPS0VOID0gJ0lOVkFMSURfUEVORElOR19UT0tFTicsXG4gIElOVkFMSURfUEhPTkVfTlVNQkVSID0gJ0lOVkFMSURfUEhPTkVfTlVNQkVSJyxcbiAgSU5WQUxJRF9QUk9WSURFUl9JRCA9ICdJTlZBTElEX1BST1ZJREVSX0lEJyxcbiAgSU5WQUxJRF9SRUNJUElFTlRfRU1BSUwgPSAnSU5WQUxJRF9SRUNJUElFTlRfRU1BSUwnLFxuICBJTlZBTElEX1NFTkRFUiA9ICdJTlZBTElEX1NFTkRFUicsXG4gIElOVkFMSURfU0VTU0lPTl9JTkZPID0gJ0lOVkFMSURfU0VTU0lPTl9JTkZPJyxcbiAgSU5WQUxJRF9URU1QT1JBUllfUFJPT0YgPSAnSU5WQUxJRF9URU1QT1JBUllfUFJPT0YnLFxuICBJTlZBTElEX1RFTkFOVF9JRCA9ICdJTlZBTElEX1RFTkFOVF9JRCcsXG4gIE1GQV9FTlJPTExNRU5UX05PVF9GT1VORCA9ICdNRkFfRU5ST0xMTUVOVF9OT1RfRk9VTkQnLFxuICBNSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FID0gJ01JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUUnLFxuICBNSVNTSU5HX0FQUF9DUkVERU5USUFMID0gJ01JU1NJTkdfQVBQX0NSRURFTlRJQUwnLFxuICBNSVNTSU5HX0NPREUgPSAnTUlTU0lOR19DT0RFJyxcbiAgTUlTU0lOR19DT05USU5VRV9VUkkgPSAnTUlTU0lOR19DT05USU5VRV9VUkknLFxuICBNSVNTSU5HX0NVU1RPTV9UT0tFTiA9ICdNSVNTSU5HX0NVU1RPTV9UT0tFTicsXG4gIE1JU1NJTkdfSU9TX0JVTkRMRV9JRCA9ICdNSVNTSU5HX0lPU19CVU5ETEVfSUQnLFxuICBNSVNTSU5HX01GQV9FTlJPTExNRU5UX0lEID0gJ01JU1NJTkdfTUZBX0VOUk9MTE1FTlRfSUQnLFxuICBNSVNTSU5HX01GQV9QRU5ESU5HX0NSRURFTlRJQUwgPSAnTUlTU0lOR19NRkFfUEVORElOR19DUkVERU5USUFMJyxcbiAgTUlTU0lOR19PT0JfQ09ERSA9ICdNSVNTSU5HX09PQl9DT0RFJyxcbiAgTUlTU0lOR19PUl9JTlZBTElEX05PTkNFID0gJ01JU1NJTkdfT1JfSU5WQUxJRF9OT05DRScsXG4gIE1JU1NJTkdfUEFTU1dPUkQgPSAnTUlTU0lOR19QQVNTV09SRCcsXG4gIE1JU1NJTkdfUkVRX1RZUEUgPSAnTUlTU0lOR19SRVFfVFlQRScsXG4gIE1JU1NJTkdfUEhPTkVfTlVNQkVSID0gJ01JU1NJTkdfUEhPTkVfTlVNQkVSJyxcbiAgTUlTU0lOR19TRVNTSU9OX0lORk8gPSAnTUlTU0lOR19TRVNTSU9OX0lORk8nLFxuICBPUEVSQVRJT05fTk9UX0FMTE9XRUQgPSAnT1BFUkFUSU9OX05PVF9BTExPV0VEJyxcbiAgUEFTU1dPUkRfTE9HSU5fRElTQUJMRUQgPSAnUEFTU1dPUkRfTE9HSU5fRElTQUJMRUQnLFxuICBRVU9UQV9FWENFRURFRCA9ICdRVU9UQV9FWENFRURFRCcsXG4gIFJFU0VUX1BBU1NXT1JEX0VYQ0VFRF9MSU1JVCA9ICdSRVNFVF9QQVNTV09SRF9FWENFRURfTElNSVQnLFxuICBSRUpFQ1RFRF9DUkVERU5USUFMID0gJ1JFSkVDVEVEX0NSRURFTlRJQUwnLFxuICBTRUNPTkRfRkFDVE9SX0VYSVNUUyA9ICdTRUNPTkRfRkFDVE9SX0VYSVNUUycsXG4gIFNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERUQgPSAnU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRCcsXG4gIFNFU1NJT05fRVhQSVJFRCA9ICdTRVNTSU9OX0VYUElSRUQnLFxuICBURU5BTlRfSURfTUlTTUFUQ0ggPSAnVEVOQU5UX0lEX01JU01BVENIJyxcbiAgVE9LRU5fRVhQSVJFRCA9ICdUT0tFTl9FWFBJUkVEJyxcbiAgVE9PX01BTllfQVRURU1QVFNfVFJZX0xBVEVSID0gJ1RPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUicsXG4gIFVOU1VQUE9SVEVEX0ZJUlNUX0ZBQ1RPUiA9ICdVTlNVUFBPUlRFRF9GSVJTVF9GQUNUT1InLFxuICBVTlNVUFBPUlRFRF9URU5BTlRfT1BFUkFUSU9OID0gJ1VOU1VQUE9SVEVEX1RFTkFOVF9PUEVSQVRJT04nLFxuICBVTkFVVEhPUklaRURfRE9NQUlOID0gJ1VOQVVUSE9SSVpFRF9ET01BSU4nLFxuICBVTlZFUklGSUVEX0VNQUlMID0gJ1VOVkVSSUZJRURfRU1BSUwnLFxuICBVU0VSX0NBTkNFTExFRCA9ICdVU0VSX0NBTkNFTExFRCcsXG4gIFVTRVJfRElTQUJMRUQgPSAnVVNFUl9ESVNBQkxFRCcsXG4gIFVTRVJfTk9UX0ZPVU5EID0gJ1VTRVJfTk9UX0ZPVU5EJyxcbiAgV0VBS19QQVNTV09SRCA9ICdXRUFLX1BBU1NXT1JEJyxcbiAgUkVDQVBUQ0hBX05PVF9FTkFCTEVEID0gJ1JFQ0FQVENIQV9OT1RfRU5BQkxFRCcsXG4gIE1JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOID0gJ01JU1NJTkdfUkVDQVBUQ0hBX1RPS0VOJyxcbiAgSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU4gPSAnSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU4nLFxuICBJTlZBTElEX1JFQ0FQVENIQV9BQ1RJT04gPSAnSU5WQUxJRF9SRUNBUFRDSEFfQUNUSU9OJyxcbiAgTUlTU0lOR19DTElFTlRfVFlQRSA9ICdNSVNTSU5HX0NMSUVOVF9UWVBFJyxcbiAgTUlTU0lOR19SRUNBUFRDSEFfVkVSU0lPTiA9ICdNSVNTSU5HX1JFQ0FQVENIQV9WRVJTSU9OJyxcbiAgSU5WQUxJRF9SRUNBUFRDSEFfVkVSU0lPTiA9ICdJTlZBTElEX1JFQ0FQVENIQV9WRVJTSU9OJyxcbiAgSU5WQUxJRF9SRVFfVFlQRSA9ICdJTlZBTElEX1JFUV9UWVBFJ1xufVxuXG4vKipcbiAqIEFQSSBSZXNwb25zZSBpbiB0aGUgZXZlbnQgb2YgYW4gZXJyb3JcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBKc29uRXJyb3Ige1xuICBlcnJvcjoge1xuICAgIGNvZGU6IG51bWJlcjtcbiAgICBtZXNzYWdlOiBzdHJpbmc7XG4gICAgZXJyb3JzPzogW1xuICAgICAge1xuICAgICAgICBtZXNzYWdlOiBTZXJ2ZXJFcnJvcjtcbiAgICAgICAgZG9tYWluOiBzdHJpbmc7XG4gICAgICAgIHJlYXNvbjogc3RyaW5nO1xuICAgICAgfVxuICAgIF07XG4gIH07XG59XG5cbi8qKlxuICogVHlwZSBkZWZpbml0aW9uIGZvciBhIG1hcCBmcm9tIHNlcnZlciBlcnJvcnMgdG8gZGV2ZWxvcGVyIHZpc2libGUgZXJyb3JzXG4gKi9cbmV4cG9ydCBkZWNsYXJlIHR5cGUgU2VydmVyRXJyb3JNYXA8QXBpRXJyb3IgZXh0ZW5kcyBzdHJpbmc+ID0ge1xuICByZWFkb25seSBbSyBpbiBBcGlFcnJvcl06IEF1dGhFcnJvckNvZGU7XG59O1xuXG4vKipcbiAqIE1hcCBmcm9tIGVycm9ycyByZXR1cm5lZCBieSB0aGUgc2VydmVyIHRvIGVycm9ycyB0byBkZXZlbG9wZXIgdmlzaWJsZSBlcnJvcnNcbiAqL1xuZXhwb3J0IGNvbnN0IFNFUlZFUl9FUlJPUl9NQVA6IFBhcnRpYWw8U2VydmVyRXJyb3JNYXA8U2VydmVyRXJyb3I+PiA9IHtcbiAgLy8gQ3VzdG9tIHRva2VuIGVycm9ycy5cbiAgW1NlcnZlckVycm9yLkNSRURFTlRJQUxfTUlTTUFUQ0hdOiBBdXRoRXJyb3JDb2RlLkNSRURFTlRJQUxfTUlTTUFUQ0gsXG4gIC8vIFRoaXMgY2FuIG9ubHkgaGFwcGVuIGlmIHRoZSBTREsgc2VuZHMgYSBiYWQgcmVxdWVzdC5cbiAgW1NlcnZlckVycm9yLk1JU1NJTkdfQ1VTVE9NX1RPS0VOXTogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUixcblxuICAvLyBDcmVhdGUgQXV0aCBVUkkgZXJyb3JzLlxuICBbU2VydmVyRXJyb3IuSU5WQUxJRF9JREVOVElGSUVSXTogQXV0aEVycm9yQ29kZS5JTlZBTElEX0VNQUlMLFxuICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXG4gIFtTZXJ2ZXJFcnJvci5NSVNTSU5HX0NPTlRJTlVFX1VSSV06IEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IsXG5cbiAgLy8gU2lnbiBpbiB3aXRoIGVtYWlsIGFuZCBwYXNzd29yZCBlcnJvcnMgKHNvbWUgYXBwbHkgdG8gc2lnbiB1cCB0b28pLlxuICBbU2VydmVyRXJyb3IuSU5WQUxJRF9QQVNTV09SRF06IEF1dGhFcnJvckNvZGUuSU5WQUxJRF9QQVNTV09SRCxcbiAgLy8gVGhpcyBjYW4gb25seSBoYXBwZW4gaWYgdGhlIFNESyBzZW5kcyBhIGJhZCByZXF1ZXN0LlxuICBbU2VydmVyRXJyb3IuTUlTU0lOR19QQVNTV09SRF06IEF1dGhFcnJvckNvZGUuTUlTU0lOR19QQVNTV09SRCxcblxuICAvLyBTaWduIHVwIHdpdGggZW1haWwgYW5kIHBhc3N3b3JkIGVycm9ycy5cbiAgW1NlcnZlckVycm9yLkVNQUlMX0VYSVNUU106IEF1dGhFcnJvckNvZGUuRU1BSUxfRVhJU1RTLFxuICBbU2VydmVyRXJyb3IuUEFTU1dPUkRfTE9HSU5fRElTQUJMRURdOiBBdXRoRXJyb3JDb2RlLk9QRVJBVElPTl9OT1RfQUxMT1dFRCxcblxuICAvLyBWZXJpZnkgYXNzZXJ0aW9uIGZvciBzaWduIGluIHdpdGggY3JlZGVudGlhbCBlcnJvcnM6XG4gIFtTZXJ2ZXJFcnJvci5JTlZBTElEX0lEUF9SRVNQT05TRV06IEF1dGhFcnJvckNvZGUuSU5WQUxJRF9JRFBfUkVTUE9OU0UsXG4gIFtTZXJ2ZXJFcnJvci5JTlZBTElEX1BFTkRJTkdfVE9LRU5dOiBBdXRoRXJyb3JDb2RlLklOVkFMSURfSURQX1JFU1BPTlNFLFxuICBbU2VydmVyRXJyb3IuRkVERVJBVEVEX1VTRVJfSURfQUxSRUFEWV9MSU5LRURdOlxuICAgIEF1dGhFcnJvckNvZGUuQ1JFREVOVElBTF9BTFJFQURZX0lOX1VTRSxcblxuICAvLyBUaGlzIGNhbiBvbmx5IGhhcHBlbiBpZiB0aGUgU0RLIHNlbmRzIGEgYmFkIHJlcXVlc3QuXG4gIFtTZXJ2ZXJFcnJvci5NSVNTSU5HX1JFUV9UWVBFXTogQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUixcblxuICAvLyBTZW5kIFBhc3N3b3JkIHJlc2V0IGVtYWlsIGVycm9yczpcbiAgW1NlcnZlckVycm9yLkVNQUlMX05PVF9GT1VORF06IEF1dGhFcnJvckNvZGUuVVNFUl9ERUxFVEVELFxuICBbU2VydmVyRXJyb3IuUkVTRVRfUEFTU1dPUkRfRVhDRUVEX0xJTUlUXTpcbiAgICBBdXRoRXJyb3JDb2RlLlRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUixcblxuICBbU2VydmVyRXJyb3IuRVhQSVJFRF9PT0JfQ09ERV06IEF1dGhFcnJvckNvZGUuRVhQSVJFRF9PT0JfQ09ERSxcbiAgW1NlcnZlckVycm9yLklOVkFMSURfT09CX0NPREVdOiBBdXRoRXJyb3JDb2RlLklOVkFMSURfT09CX0NPREUsXG4gIC8vIFRoaXMgY2FuIG9ubHkgaGFwcGVuIGlmIHRoZSBTREsgc2VuZHMgYSBiYWQgcmVxdWVzdC5cbiAgW1NlcnZlckVycm9yLk1JU1NJTkdfT09CX0NPREVdOiBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SLFxuXG4gIC8vIE9wZXJhdGlvbnMgdGhhdCByZXF1aXJlIElEIHRva2VuIGluIHJlcXVlc3Q6XG4gIFtTZXJ2ZXJFcnJvci5DUkVERU5USUFMX1RPT19PTERfTE9HSU5fQUdBSU5dOlxuICAgIEF1dGhFcnJvckNvZGUuQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOLFxuICBbU2VydmVyRXJyb3IuSU5WQUxJRF9JRF9UT0tFTl06IEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BVVRILFxuICBbU2VydmVyRXJyb3IuVE9LRU5fRVhQSVJFRF06IEF1dGhFcnJvckNvZGUuVE9LRU5fRVhQSVJFRCxcbiAgW1NlcnZlckVycm9yLlVTRVJfTk9UX0ZPVU5EXTogQXV0aEVycm9yQ29kZS5UT0tFTl9FWFBJUkVELFxuXG4gIC8vIE90aGVyIGVycm9ycy5cbiAgW1NlcnZlckVycm9yLlRPT19NQU5ZX0FUVEVNUFRTX1RSWV9MQVRFUl06XG4gICAgQXV0aEVycm9yQ29kZS5UT09fTUFOWV9BVFRFTVBUU19UUllfTEFURVIsXG5cbiAgLy8gUGhvbmUgQXV0aCByZWxhdGVkIGVycm9ycy5cbiAgW1NlcnZlckVycm9yLklOVkFMSURfQ09ERV06IEF1dGhFcnJvckNvZGUuSU5WQUxJRF9DT0RFLFxuICBbU2VydmVyRXJyb3IuSU5WQUxJRF9TRVNTSU9OX0lORk9dOiBBdXRoRXJyb3JDb2RlLklOVkFMSURfU0VTU0lPTl9JTkZPLFxuICBbU2VydmVyRXJyb3IuSU5WQUxJRF9URU1QT1JBUllfUFJPT0ZdOiBBdXRoRXJyb3JDb2RlLklOVkFMSURfSURQX1JFU1BPTlNFLFxuICBbU2VydmVyRXJyb3IuTUlTU0lOR19TRVNTSU9OX0lORk9dOiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfU0VTU0lPTl9JTkZPLFxuICBbU2VydmVyRXJyb3IuU0VTU0lPTl9FWFBJUkVEXTogQXV0aEVycm9yQ29kZS5DT0RFX0VYUElSRUQsXG5cbiAgLy8gT3RoZXIgYWN0aW9uIGNvZGUgZXJyb3JzIHdoZW4gYWRkaXRpb25hbCBzZXR0aW5ncyBwYXNzZWQuXG4gIC8vIE1JU1NJTkdfQ09OVElOVUVfVVJJIGlzIGdldHRpbmcgbWFwcGVkIHRvIElOVEVSTkFMX0VSUk9SIGFib3ZlLlxuICAvLyBUaGlzIGlzIE9LIGFzIHRoaXMgZXJyb3Igd2lsbCBiZSBjYXVnaHQgYnkgY2xpZW50IHNpZGUgdmFsaWRhdGlvbi5cbiAgW1NlcnZlckVycm9yLk1JU1NJTkdfQU5EUk9JRF9QQUNLQUdFX05BTUVdOlxuICAgIEF1dGhFcnJvckNvZGUuTUlTU0lOR19BTkRST0lEX1BBQ0tBR0VfTkFNRSxcbiAgW1NlcnZlckVycm9yLlVOQVVUSE9SSVpFRF9ET01BSU5dOiBBdXRoRXJyb3JDb2RlLlVOQVVUSE9SSVpFRF9ET01BSU4sXG5cbiAgLy8gZ2V0UHJvamVjdENvbmZpZyBlcnJvcnMgd2hlbiBjbGllbnRJZCBpcyBwYXNzZWQuXG4gIFtTZXJ2ZXJFcnJvci5JTlZBTElEX09BVVRIX0NMSUVOVF9JRF06IEF1dGhFcnJvckNvZGUuSU5WQUxJRF9PQVVUSF9DTElFTlRfSUQsXG5cbiAgLy8gVXNlciBhY3Rpb25zIChzaWduLXVwIG9yIGRlbGV0aW9uKSBkaXNhYmxlZCBlcnJvcnMuXG4gIFtTZXJ2ZXJFcnJvci5BRE1JTl9PTkxZX09QRVJBVElPTl06IEF1dGhFcnJvckNvZGUuQURNSU5fT05MWV9PUEVSQVRJT04sXG5cbiAgLy8gTXVsdGkgZmFjdG9yIHJlbGF0ZWQgZXJyb3JzLlxuICBbU2VydmVyRXJyb3IuSU5WQUxJRF9NRkFfUEVORElOR19DUkVERU5USUFMXTpcbiAgICBBdXRoRXJyb3JDb2RlLklOVkFMSURfTUZBX1NFU1NJT04sXG4gIFtTZXJ2ZXJFcnJvci5NRkFfRU5ST0xMTUVOVF9OT1RfRk9VTkRdOiBBdXRoRXJyb3JDb2RlLk1GQV9JTkZPX05PVF9GT1VORCxcbiAgW1NlcnZlckVycm9yLk1JU1NJTkdfTUZBX0VOUk9MTE1FTlRfSURdOiBBdXRoRXJyb3JDb2RlLk1JU1NJTkdfTUZBX0lORk8sXG4gIFtTZXJ2ZXJFcnJvci5NSVNTSU5HX01GQV9QRU5ESU5HX0NSRURFTlRJQUxdOlxuICAgIEF1dGhFcnJvckNvZGUuTUlTU0lOR19NRkFfU0VTU0lPTixcbiAgW1NlcnZlckVycm9yLlNFQ09ORF9GQUNUT1JfRVhJU1RTXTpcbiAgICBBdXRoRXJyb3JDb2RlLlNFQ09ORF9GQUNUT1JfQUxSRUFEWV9FTlJPTExFRCxcbiAgW1NlcnZlckVycm9yLlNFQ09ORF9GQUNUT1JfTElNSVRfRVhDRUVERURdOlxuICAgIEF1dGhFcnJvckNvZGUuU0VDT05EX0ZBQ1RPUl9MSU1JVF9FWENFRURFRCxcblxuICAvLyBCbG9ja2luZyBmdW5jdGlvbnMgcmVsYXRlZCBlcnJvcnMuXG4gIFtTZXJ2ZXJFcnJvci5CTE9DS0lOR19GVU5DVElPTl9FUlJPUl9SRVNQT05TRV06IEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IsXG5cbiAgLy8gUmVjYXB0Y2hhIHJlbGF0ZWQgZXJyb3JzLlxuICBbU2VydmVyRXJyb3IuUkVDQVBUQ0hBX05PVF9FTkFCTEVEXTogQXV0aEVycm9yQ29kZS5SRUNBUFRDSEFfTk9UX0VOQUJMRUQsXG4gIFtTZXJ2ZXJFcnJvci5NSVNTSU5HX1JFQ0FQVENIQV9UT0tFTl06IEF1dGhFcnJvckNvZGUuTUlTU0lOR19SRUNBUFRDSEFfVE9LRU4sXG4gIFtTZXJ2ZXJFcnJvci5JTlZBTElEX1JFQ0FQVENIQV9UT0tFTl06IEF1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfVE9LRU4sXG4gIFtTZXJ2ZXJFcnJvci5JTlZBTElEX1JFQ0FQVENIQV9BQ1RJT05dOlxuICAgIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfQUNUSU9OLFxuICBbU2VydmVyRXJyb3IuTUlTU0lOR19DTElFTlRfVFlQRV06IEF1dGhFcnJvckNvZGUuTUlTU0lOR19DTElFTlRfVFlQRSxcbiAgW1NlcnZlckVycm9yLk1JU1NJTkdfUkVDQVBUQ0hBX1ZFUlNJT05dOlxuICAgIEF1dGhFcnJvckNvZGUuTUlTU0lOR19SRUNBUFRDSEFfVkVSU0lPTixcbiAgW1NlcnZlckVycm9yLklOVkFMSURfUkVDQVBUQ0hBX1ZFUlNJT05dOlxuICAgIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9SRUNBUFRDSEFfVkVSU0lPTixcbiAgW1NlcnZlckVycm9yLklOVkFMSURfUkVRX1RZUEVdOiBBdXRoRXJyb3JDb2RlLklOVkFMSURfUkVRX1RZUEVcbn07XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciwgcXVlcnlzdHJpbmcgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbmltcG9ydCB7IEF1dGhFcnJvckNvZGUsIE5hbWVkRXJyb3JQYXJhbXMgfSBmcm9tICcuLi9jb3JlL2Vycm9ycyc7XG5pbXBvcnQge1xuICBfY3JlYXRlRXJyb3IsXG4gIF9lcnJvcldpdGhDdXN0b21NZXNzYWdlLFxuICBfZmFpbFxufSBmcm9tICcuLi9jb3JlL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IERlbGF5IH0gZnJvbSAnLi4vY29yZS91dGlsL2RlbGF5JztcbmltcG9ydCB7IF9lbXVsYXRvclVybCB9IGZyb20gJy4uL2NvcmUvdXRpbC9lbXVsYXRvcic7XG5pbXBvcnQgeyBGZXRjaFByb3ZpZGVyIH0gZnJvbSAnLi4vY29yZS91dGlsL2ZldGNoX3Byb3ZpZGVyJztcbmltcG9ydCB7IEF1dGggfSBmcm9tICcuLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsLCBDb25maWdJbnRlcm5hbCB9IGZyb20gJy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgSWRUb2tlblJlc3BvbnNlLCBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IElkVG9rZW5NZmFSZXNwb25zZSB9IGZyb20gJy4vYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IFNFUlZFUl9FUlJPUl9NQVAsIFNlcnZlckVycm9yLCBTZXJ2ZXJFcnJvck1hcCB9IGZyb20gJy4vZXJyb3JzJztcblxuZXhwb3J0IGNvbnN0IGVudW0gSHR0cE1ldGhvZCB7XG4gIFBPU1QgPSAnUE9TVCcsXG4gIEdFVCA9ICdHRVQnXG59XG5cbmV4cG9ydCBjb25zdCBlbnVtIEh0dHBIZWFkZXIge1xuICBDT05URU5UX1RZUEUgPSAnQ29udGVudC1UeXBlJyxcbiAgWF9GSVJFQkFTRV9MT0NBTEUgPSAnWC1GaXJlYmFzZS1Mb2NhbGUnLFxuICBYX0NMSUVOVF9WRVJTSU9OID0gJ1gtQ2xpZW50LVZlcnNpb24nLFxuICBYX0ZJUkVCQVNFX0dNUElEID0gJ1gtRmlyZWJhc2UtZ21waWQnLFxuICBYX0ZJUkVCQVNFX0NMSUVOVCA9ICdYLUZpcmViYXNlLUNsaWVudCcsXG4gIFhfRklSRUJBU0VfQVBQX0NIRUNLID0gJ1gtRmlyZWJhc2UtQXBwQ2hlY2snXG59XG5cbmV4cG9ydCBjb25zdCBlbnVtIEVuZHBvaW50IHtcbiAgQ1JFQVRFX0FVVEhfVVJJID0gJy92MS9hY2NvdW50czpjcmVhdGVBdXRoVXJpJyxcbiAgREVMRVRFX0FDQ09VTlQgPSAnL3YxL2FjY291bnRzOmRlbGV0ZScsXG4gIFJFU0VUX1BBU1NXT1JEID0gJy92MS9hY2NvdW50czpyZXNldFBhc3N3b3JkJyxcbiAgU0lHTl9VUCA9ICcvdjEvYWNjb3VudHM6c2lnblVwJyxcbiAgU0lHTl9JTl9XSVRIX0NVU1RPTV9UT0tFTiA9ICcvdjEvYWNjb3VudHM6c2lnbkluV2l0aEN1c3RvbVRva2VuJyxcbiAgU0lHTl9JTl9XSVRIX0VNQUlMX0xJTksgPSAnL3YxL2FjY291bnRzOnNpZ25JbldpdGhFbWFpbExpbmsnLFxuICBTSUdOX0lOX1dJVEhfSURQID0gJy92MS9hY2NvdW50czpzaWduSW5XaXRoSWRwJyxcbiAgU0lHTl9JTl9XSVRIX1BBU1NXT1JEID0gJy92MS9hY2NvdW50czpzaWduSW5XaXRoUGFzc3dvcmQnLFxuICBTSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSID0gJy92MS9hY2NvdW50czpzaWduSW5XaXRoUGhvbmVOdW1iZXInLFxuICBTRU5EX1ZFUklGSUNBVElPTl9DT0RFID0gJy92MS9hY2NvdW50czpzZW5kVmVyaWZpY2F0aW9uQ29kZScsXG4gIFNFTkRfT09CX0NPREUgPSAnL3YxL2FjY291bnRzOnNlbmRPb2JDb2RlJyxcbiAgU0VUX0FDQ09VTlRfSU5GTyA9ICcvdjEvYWNjb3VudHM6dXBkYXRlJyxcbiAgR0VUX0FDQ09VTlRfSU5GTyA9ICcvdjEvYWNjb3VudHM6bG9va3VwJyxcbiAgR0VUX1JFQ0FQVENIQV9QQVJBTSA9ICcvdjEvcmVjYXB0Y2hhUGFyYW1zJyxcbiAgU1RBUlRfTUZBX0VOUk9MTE1FTlQgPSAnL3YyL2FjY291bnRzL21mYUVucm9sbG1lbnQ6c3RhcnQnLFxuICBGSU5BTElaRV9NRkFfRU5ST0xMTUVOVCA9ICcvdjIvYWNjb3VudHMvbWZhRW5yb2xsbWVudDpmaW5hbGl6ZScsXG4gIFNUQVJUX01GQV9TSUdOX0lOID0gJy92Mi9hY2NvdW50cy9tZmFTaWduSW46c3RhcnQnLFxuICBGSU5BTElaRV9NRkFfU0lHTl9JTiA9ICcvdjIvYWNjb3VudHMvbWZhU2lnbkluOmZpbmFsaXplJyxcbiAgV0lUSERSQVdfTUZBID0gJy92Mi9hY2NvdW50cy9tZmFFbnJvbGxtZW50OndpdGhkcmF3JyxcbiAgR0VUX1BST0pFQ1RfQ09ORklHID0gJy92MS9wcm9qZWN0cycsXG4gIEdFVF9SRUNBUFRDSEFfQ09ORklHID0gJy92Mi9yZWNhcHRjaGFDb25maWcnXG59XG5cbmV4cG9ydCBjb25zdCBlbnVtIFJlY2FwdGNoYUNsaWVudFR5cGUge1xuICBXRUIgPSAnQ0xJRU5UX1RZUEVfV0VCJyxcbiAgQU5EUk9JRCA9ICdDTElFTlRfVFlQRV9BTkRST0lEJyxcbiAgSU9TID0gJ0NMSUVOVF9UWVBFX0lPUydcbn1cblxuZXhwb3J0IGNvbnN0IGVudW0gUmVjYXB0Y2hhVmVyc2lvbiB7XG4gIEVOVEVSUFJJU0UgPSAnUkVDQVBUQ0hBX0VOVEVSUFJJU0UnXG59XG5cbmV4cG9ydCBjb25zdCBlbnVtIFJlY2FwdGNoYUFjdGlvbk5hbWUge1xuICBTSUdOX0lOX1dJVEhfUEFTU1dPUkQgPSAnc2lnbkluV2l0aFBhc3N3b3JkJyxcbiAgR0VUX09PQl9DT0RFID0gJ2dldE9vYkNvZGUnLFxuICBTSUdOX1VQX1BBU1NXT1JEID0gJ3NpZ25VcFBhc3N3b3JkJ1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9BUElfVElNRU9VVF9NUyA9IG5ldyBEZWxheSgzMF8wMDAsIDYwXzAwMCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBfYWRkVGlkSWZOZWNlc3Nhcnk8VCBleHRlbmRzIHsgdGVuYW50SWQ/OiBzdHJpbmcgfT4oXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFRcbik6IFQge1xuICBpZiAoYXV0aC50ZW5hbnRJZCAmJiAhcmVxdWVzdC50ZW5hbnRJZCkge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5yZXF1ZXN0LFxuICAgICAgdGVuYW50SWQ6IGF1dGgudGVuYW50SWRcbiAgICB9O1xuICB9XG4gIHJldHVybiByZXF1ZXN0O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX3BlcmZvcm1BcGlSZXF1ZXN0PFQsIFY+KFxuICBhdXRoOiBBdXRoLFxuICBtZXRob2Q6IEh0dHBNZXRob2QsXG4gIHBhdGg6IEVuZHBvaW50LFxuICByZXF1ZXN0PzogVCxcbiAgY3VzdG9tRXJyb3JNYXA6IFBhcnRpYWw8U2VydmVyRXJyb3JNYXA8U2VydmVyRXJyb3I+PiA9IHt9XG4pOiBQcm9taXNlPFY+IHtcbiAgcmV0dXJuIF9wZXJmb3JtRmV0Y2hXaXRoRXJyb3JIYW5kbGluZyhhdXRoLCBjdXN0b21FcnJvck1hcCwgYXN5bmMgKCkgPT4ge1xuICAgIGxldCBib2R5ID0ge307XG4gICAgbGV0IHBhcmFtcyA9IHt9O1xuICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICBpZiAobWV0aG9kID09PSBIdHRwTWV0aG9kLkdFVCkge1xuICAgICAgICBwYXJhbXMgPSByZXF1ZXN0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYm9keSA9IHtcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0KVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHF1ZXJ5ID0gcXVlcnlzdHJpbmcoe1xuICAgICAga2V5OiBhdXRoLmNvbmZpZy5hcGlLZXksXG4gICAgICAuLi5wYXJhbXNcbiAgICB9KS5zbGljZSgxKTtcblxuICAgIGNvbnN0IGhlYWRlcnMgPSBhd2FpdCAoYXV0aCBhcyBBdXRoSW50ZXJuYWwpLl9nZXRBZGRpdGlvbmFsSGVhZGVycygpO1xuICAgIGhlYWRlcnNbSHR0cEhlYWRlci5DT05URU5UX1RZUEVdID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuXG4gICAgaWYgKGF1dGgubGFuZ3VhZ2VDb2RlKSB7XG4gICAgICBoZWFkZXJzW0h0dHBIZWFkZXIuWF9GSVJFQkFTRV9MT0NBTEVdID0gYXV0aC5sYW5ndWFnZUNvZGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIEZldGNoUHJvdmlkZXIuZmV0Y2goKShcbiAgICAgIF9nZXRGaW5hbFRhcmdldChhdXRoLCBhdXRoLmNvbmZpZy5hcGlIb3N0LCBwYXRoLCBxdWVyeSksXG4gICAgICB7XG4gICAgICAgIG1ldGhvZCxcbiAgICAgICAgaGVhZGVycyxcbiAgICAgICAgcmVmZXJyZXJQb2xpY3k6ICduby1yZWZlcnJlcicsXG4gICAgICAgIC4uLmJvZHlcbiAgICAgIH1cbiAgICApO1xuICB9KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF9wZXJmb3JtRmV0Y2hXaXRoRXJyb3JIYW5kbGluZzxWPihcbiAgYXV0aDogQXV0aCxcbiAgY3VzdG9tRXJyb3JNYXA6IFBhcnRpYWw8U2VydmVyRXJyb3JNYXA8U2VydmVyRXJyb3I+PixcbiAgZmV0Y2hGbjogKCkgPT4gUHJvbWlzZTxSZXNwb25zZT5cbik6IFByb21pc2U8Vj4ge1xuICAoYXV0aCBhcyBBdXRoSW50ZXJuYWwpLl9jYW5Jbml0RW11bGF0b3IgPSBmYWxzZTtcbiAgY29uc3QgZXJyb3JNYXAgPSB7IC4uLlNFUlZFUl9FUlJPUl9NQVAsIC4uLmN1c3RvbUVycm9yTWFwIH07XG4gIHRyeSB7XG4gICAgY29uc3QgbmV0d29ya1RpbWVvdXQgPSBuZXcgTmV0d29ya1RpbWVvdXQ8UmVzcG9uc2U+KGF1dGgpO1xuICAgIGNvbnN0IHJlc3BvbnNlOiBSZXNwb25zZSA9IGF3YWl0IFByb21pc2UucmFjZTxQcm9taXNlPFJlc3BvbnNlPj4oW1xuICAgICAgZmV0Y2hGbigpLFxuICAgICAgbmV0d29ya1RpbWVvdXQucHJvbWlzZVxuICAgIF0pO1xuXG4gICAgLy8gSWYgd2UndmUgcmVhY2hlZCB0aGlzIHBvaW50LCB0aGUgZmV0Y2ggc3VjY2VlZGVkIGFuZCB0aGUgbmV0d29ya1RpbWVvdXRcbiAgICAvLyBkaWRuJ3QgdGhyb3c7IGNsZWFyIHRoZSBuZXR3b3JrIHRpbWVvdXQgZGVsYXkgc28gdGhhdCBOb2RlIHdvbid0IGhhbmdcbiAgICBuZXR3b3JrVGltZW91dC5jbGVhck5ldHdvcmtUaW1lb3V0KCk7XG5cbiAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGlmICgnbmVlZENvbmZpcm1hdGlvbicgaW4ganNvbikge1xuICAgICAgdGhyb3cgX21ha2VUYWdnZWRFcnJvcihhdXRoLCBBdXRoRXJyb3JDb2RlLk5FRURfQ09ORklSTUFUSU9OLCBqc29uKTtcbiAgICB9XG5cbiAgICBpZiAocmVzcG9uc2Uub2sgJiYgISgnZXJyb3JNZXNzYWdlJyBpbiBqc29uKSkge1xuICAgICAgcmV0dXJuIGpzb247XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IHJlc3BvbnNlLm9rID8ganNvbi5lcnJvck1lc3NhZ2UgOiBqc29uLmVycm9yLm1lc3NhZ2U7XG4gICAgICBjb25zdCBbc2VydmVyRXJyb3JDb2RlLCBzZXJ2ZXJFcnJvck1lc3NhZ2VdID0gZXJyb3JNZXNzYWdlLnNwbGl0KCcgOiAnKTtcbiAgICAgIGlmIChzZXJ2ZXJFcnJvckNvZGUgPT09IFNlcnZlckVycm9yLkZFREVSQVRFRF9VU0VSX0lEX0FMUkVBRFlfTElOS0VEKSB7XG4gICAgICAgIHRocm93IF9tYWtlVGFnZ2VkRXJyb3IoXG4gICAgICAgICAgYXV0aCxcbiAgICAgICAgICBBdXRoRXJyb3JDb2RlLkNSRURFTlRJQUxfQUxSRUFEWV9JTl9VU0UsXG4gICAgICAgICAganNvblxuICAgICAgICApO1xuICAgICAgfSBlbHNlIGlmIChzZXJ2ZXJFcnJvckNvZGUgPT09IFNlcnZlckVycm9yLkVNQUlMX0VYSVNUUykge1xuICAgICAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIEF1dGhFcnJvckNvZGUuRU1BSUxfRVhJU1RTLCBqc29uKTtcbiAgICAgIH0gZWxzZSBpZiAoc2VydmVyRXJyb3JDb2RlID09PSBTZXJ2ZXJFcnJvci5VU0VSX0RJU0FCTEVEKSB7XG4gICAgICAgIHRocm93IF9tYWtlVGFnZ2VkRXJyb3IoYXV0aCwgQXV0aEVycm9yQ29kZS5VU0VSX0RJU0FCTEVELCBqc29uKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGF1dGhFcnJvciA9XG4gICAgICAgIGVycm9yTWFwW3NlcnZlckVycm9yQ29kZSBhcyBTZXJ2ZXJFcnJvcl0gfHxcbiAgICAgICAgKHNlcnZlckVycm9yQ29kZVxuICAgICAgICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgLnJlcGxhY2UoL1tfXFxzXSsvZywgJy0nKSBhcyB1bmtub3duIGFzIEF1dGhFcnJvckNvZGUpO1xuICAgICAgaWYgKHNlcnZlckVycm9yTWVzc2FnZSkge1xuICAgICAgICB0aHJvdyBfZXJyb3JXaXRoQ3VzdG9tTWVzc2FnZShhdXRoLCBhdXRoRXJyb3IsIHNlcnZlckVycm9yTWVzc2FnZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfZmFpbChhdXRoLCBhdXRoRXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICAgIGlmIChlIGluc3RhbmNlb2YgRmlyZWJhc2VFcnJvcikge1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG4gICAgLy8gQ2hhbmdpbmcgdGhpcyB0byBhIGRpZmZlcmVudCBlcnJvciBjb2RlIHdpbGwgbG9nIHVzZXIgb3V0IHdoZW4gdGhlcmUgaXMgYSBuZXR3b3JrIGVycm9yXG4gICAgLy8gYmVjYXVzZSB3ZSB0cmVhdCBhbnkgZXJyb3Igb3RoZXIgdGhhbiBORVRXT1JLX1JFUVVFU1RfRkFJTEVEIGFzIHRva2VuIGlzIGludmFsaWQuXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9ibG9iLzRmYmM3MzYxMGQ3MGJlNGUwODUyZTdkZTYzYTM5Y2I3ODk3ZTg1NDYvcGFja2FnZXMvYXV0aC9zcmMvY29yZS9hdXRoL2F1dGhfaW1wbC50cyNMMzA5LUwzMTZcbiAgICBfZmFpbChhdXRoLCBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRUQsIHsgJ21lc3NhZ2UnOiBTdHJpbmcoZSkgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF9wZXJmb3JtU2lnbkluUmVxdWVzdDxULCBWIGV4dGVuZHMgSWRUb2tlblJlc3BvbnNlPihcbiAgYXV0aDogQXV0aCxcbiAgbWV0aG9kOiBIdHRwTWV0aG9kLFxuICBwYXRoOiBFbmRwb2ludCxcbiAgcmVxdWVzdD86IFQsXG4gIGN1c3RvbUVycm9yTWFwOiBQYXJ0aWFsPFNlcnZlckVycm9yTWFwPFNlcnZlckVycm9yPj4gPSB7fVxuKTogUHJvbWlzZTxWPiB7XG4gIGNvbnN0IHNlcnZlclJlc3BvbnNlID0gKGF3YWl0IF9wZXJmb3JtQXBpUmVxdWVzdDxULCBWIHwgSWRUb2tlbk1mYVJlc3BvbnNlPihcbiAgICBhdXRoLFxuICAgIG1ldGhvZCxcbiAgICBwYXRoLFxuICAgIHJlcXVlc3QsXG4gICAgY3VzdG9tRXJyb3JNYXBcbiAgKSkgYXMgVjtcbiAgaWYgKCdtZmFQZW5kaW5nQ3JlZGVudGlhbCcgaW4gc2VydmVyUmVzcG9uc2UpIHtcbiAgICBfZmFpbChhdXRoLCBBdXRoRXJyb3JDb2RlLk1GQV9SRVFVSVJFRCwge1xuICAgICAgX3NlcnZlclJlc3BvbnNlOiBzZXJ2ZXJSZXNwb25zZVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHNlcnZlclJlc3BvbnNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2dldEZpbmFsVGFyZ2V0KFxuICBhdXRoOiBBdXRoLFxuICBob3N0OiBzdHJpbmcsXG4gIHBhdGg6IHN0cmluZyxcbiAgcXVlcnk6IHN0cmluZ1xuKTogc3RyaW5nIHtcbiAgY29uc3QgYmFzZSA9IGAke2hvc3R9JHtwYXRofT8ke3F1ZXJ5fWA7XG5cbiAgaWYgKCEoYXV0aCBhcyBBdXRoSW50ZXJuYWwpLmNvbmZpZy5lbXVsYXRvcikge1xuICAgIHJldHVybiBgJHthdXRoLmNvbmZpZy5hcGlTY2hlbWV9Oi8vJHtiYXNlfWA7XG4gIH1cblxuICByZXR1cm4gX2VtdWxhdG9yVXJsKGF1dGguY29uZmlnIGFzIENvbmZpZ0ludGVybmFsLCBiYXNlKTtcbn1cblxuY2xhc3MgTmV0d29ya1RpbWVvdXQ8VD4ge1xuICAvLyBOb2RlIHRpbWVycyBhbmQgYnJvd3NlciB0aW1lcnMgYXJlIGZ1bmRhbWVudGFsbHkgaW5jb21wYXRpYmxlLCBidXQgd2VcbiAgLy8gZG9uJ3QgY2FyZSBhYm91dCB0aGUgdmFsdWUgaGVyZVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICBwcml2YXRlIHRpbWVyOiBhbnkgfCBudWxsID0gbnVsbDtcbiAgcmVhZG9ubHkgcHJvbWlzZSA9IG5ldyBQcm9taXNlPFQ+KChfLCByZWplY3QpID0+IHtcbiAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZXR1cm4gcmVqZWN0KFxuICAgICAgICBfY3JlYXRlRXJyb3IodGhpcy5hdXRoLCBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRUQpXG4gICAgICApO1xuICAgIH0sIERFRkFVTFRfQVBJX1RJTUVPVVRfTVMuZ2V0KCkpO1xuICB9KTtcblxuICBjbGVhck5ldHdvcmtUaW1lb3V0KCk6IHZvaWQge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgYXV0aDogQXV0aCkge31cbn1cblxuaW50ZXJmYWNlIFBvdGVudGlhbFJlc3BvbnNlIGV4dGVuZHMgSWRUb2tlblJlc3BvbnNlIHtcbiAgZW1haWw/OiBzdHJpbmc7XG4gIHBob25lTnVtYmVyPzogc3RyaW5nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX21ha2VUYWdnZWRFcnJvcihcbiAgYXV0aDogQXV0aCxcbiAgY29kZTogQXV0aEVycm9yQ29kZSxcbiAgcmVzcG9uc2U6IFBvdGVudGlhbFJlc3BvbnNlXG4pOiBGaXJlYmFzZUVycm9yIHtcbiAgY29uc3QgZXJyb3JQYXJhbXM6IE5hbWVkRXJyb3JQYXJhbXMgPSB7XG4gICAgYXBwTmFtZTogYXV0aC5uYW1lXG4gIH07XG5cbiAgaWYgKHJlc3BvbnNlLmVtYWlsKSB7XG4gICAgZXJyb3JQYXJhbXMuZW1haWwgPSByZXNwb25zZS5lbWFpbDtcbiAgfVxuICBpZiAocmVzcG9uc2UucGhvbmVOdW1iZXIpIHtcbiAgICBlcnJvclBhcmFtcy5waG9uZU51bWJlciA9IHJlc3BvbnNlLnBob25lTnVtYmVyO1xuICB9XG5cbiAgY29uc3QgZXJyb3IgPSBfY3JlYXRlRXJyb3IoYXV0aCwgY29kZSwgZXJyb3JQYXJhbXMpO1xuXG4gIC8vIFdlIGtub3cgY3VzdG9tRGF0YSBpcyBkZWZpbmVkIG9uIGVycm9yIGJlY2F1c2UgZXJyb3JQYXJhbXMgaXMgZGVmaW5lZFxuICAoZXJyb3IuY3VzdG9tRGF0YSEgYXMgVGFnZ2VkV2l0aFRva2VuUmVzcG9uc2UpLl90b2tlblJlc3BvbnNlID0gcmVzcG9uc2U7XG4gIHJldHVybiBlcnJvcjtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBFbmRwb2ludCwgSHR0cE1ldGhvZCwgX3BlcmZvcm1BcGlSZXF1ZXN0IH0gZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IHsgTWZhRW5yb2xsbWVudCB9IGZyb20gJy4vbWZhJztcbmltcG9ydCB7IEF1dGggfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERlbGV0ZUFjY291bnRSZXF1ZXN0IHtcbiAgaWRUb2tlbjogc3RyaW5nO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQWNjb3VudChcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogRGVsZXRlQWNjb3VudFJlcXVlc3Rcbik6IFByb21pc2U8dm9pZD4ge1xuICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0PERlbGV0ZUFjY291bnRSZXF1ZXN0LCB2b2lkPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5ERUxFVEVfQUNDT1VOVCxcbiAgICByZXF1ZXN0XG4gICk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvdmlkZXJVc2VySW5mbyB7XG4gIHByb3ZpZGVySWQ6IHN0cmluZztcbiAgcmF3SWQ/OiBzdHJpbmc7XG4gIGVtYWlsPzogc3RyaW5nO1xuICBkaXNwbGF5TmFtZT86IHN0cmluZztcbiAgcGhvdG9Vcmw/OiBzdHJpbmc7XG4gIHBob25lTnVtYmVyPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERlbGV0ZUxpbmtlZEFjY291bnRzUmVxdWVzdCB7XG4gIGlkVG9rZW46IHN0cmluZztcbiAgZGVsZXRlUHJvdmlkZXI6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERlbGV0ZUxpbmtlZEFjY291bnRzUmVzcG9uc2Uge1xuICBwcm92aWRlclVzZXJJbmZvOiBQcm92aWRlclVzZXJJbmZvW107XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVMaW5rZWRBY2NvdW50cyhcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogRGVsZXRlTGlua2VkQWNjb3VudHNSZXF1ZXN0XG4pOiBQcm9taXNlPERlbGV0ZUxpbmtlZEFjY291bnRzUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdDxcbiAgICBEZWxldGVMaW5rZWRBY2NvdW50c1JlcXVlc3QsXG4gICAgRGVsZXRlTGlua2VkQWNjb3VudHNSZXNwb25zZVxuICA+KGF1dGgsIEh0dHBNZXRob2QuUE9TVCwgRW5kcG9pbnQuU0VUX0FDQ09VTlRfSU5GTywgcmVxdWVzdCk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQVBJVXNlckluZm8ge1xuICBsb2NhbElkPzogc3RyaW5nO1xuICBkaXNwbGF5TmFtZT86IHN0cmluZztcbiAgcGhvdG9Vcmw/OiBzdHJpbmc7XG4gIGVtYWlsPzogc3RyaW5nO1xuICBlbWFpbFZlcmlmaWVkPzogYm9vbGVhbjtcbiAgcGhvbmVOdW1iZXI/OiBzdHJpbmc7XG4gIGxhc3RMb2dpbkF0PzogbnVtYmVyO1xuICBjcmVhdGVkQXQ/OiBudW1iZXI7XG4gIHRlbmFudElkPzogc3RyaW5nO1xuICBwYXNzd29yZEhhc2g/OiBzdHJpbmc7XG4gIHByb3ZpZGVyVXNlckluZm8/OiBQcm92aWRlclVzZXJJbmZvW107XG4gIG1mYUluZm8/OiBNZmFFbnJvbGxtZW50W107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0QWNjb3VudEluZm9SZXF1ZXN0IHtcbiAgaWRUb2tlbjogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdldEFjY291bnRJbmZvUmVzcG9uc2Uge1xuICB1c2VyczogQVBJVXNlckluZm9bXTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjY291bnRJbmZvKFxuICBhdXRoOiBBdXRoLFxuICByZXF1ZXN0OiBHZXRBY2NvdW50SW5mb1JlcXVlc3Rcbik6IFByb21pc2U8R2V0QWNjb3VudEluZm9SZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0PEdldEFjY291bnRJbmZvUmVxdWVzdCwgR2V0QWNjb3VudEluZm9SZXNwb25zZT4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuR0VUX0FDQ09VTlRfSU5GTyxcbiAgICByZXF1ZXN0XG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuZXhwb3J0IGZ1bmN0aW9uIHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyhcbiAgdXRjVGltZXN0YW1wPzogc3RyaW5nIHwgbnVtYmVyXG4pOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBpZiAoIXV0Y1RpbWVzdGFtcCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgdHJ5IHtcbiAgICAvLyBDb252ZXJ0IHRvIGRhdGUgb2JqZWN0LlxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShOdW1iZXIodXRjVGltZXN0YW1wKSk7XG4gICAgLy8gVGVzdCBkYXRlIGlzIHZhbGlkLlxuICAgIGlmICghaXNOYU4oZGF0ZS5nZXRUaW1lKCkpKSB7XG4gICAgICAvLyBDb252ZXJ0IHRvIFVUQyBkYXRlIHN0cmluZy5cbiAgICAgIHJldHVybiBkYXRlLnRvVVRDU3RyaW5nKCk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gRG8gbm90aGluZy4gdW5kZWZpbmVkIHdpbGwgYmUgcmV0dXJuZWQuXG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBJZFRva2VuUmVzdWx0LCBQYXJzZWRUb2tlbiwgVXNlciB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQgeyBiYXNlNjREZWNvZGUsIGdldE1vZHVsYXJJbnN0YW5jZSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuaW1wb3J0IHsgVXNlckludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBfYXNzZXJ0IH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgX2xvZ0Vycm9yIH0gZnJvbSAnLi4vdXRpbC9sb2cnO1xuaW1wb3J0IHsgdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nIH0gZnJvbSAnLi4vdXRpbC90aW1lJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9lcnJvcnMnO1xuXG4vKipcbiAqIFJldHVybnMgYSBKU09OIFdlYiBUb2tlbiAoSldUKSB1c2VkIHRvIGlkZW50aWZ5IHRoZSB1c2VyIHRvIGEgRmlyZWJhc2Ugc2VydmljZS5cbiAqXG4gKiBAcmVtYXJrc1xuICogUmV0dXJucyB0aGUgY3VycmVudCB0b2tlbiBpZiBpdCBoYXMgbm90IGV4cGlyZWQgb3IgaWYgaXQgd2lsbCBub3QgZXhwaXJlIGluIHRoZSBuZXh0IGZpdmVcbiAqIG1pbnV0ZXMuIE90aGVyd2lzZSwgdGhpcyB3aWxsIHJlZnJlc2ggdGhlIHRva2VuIGFuZCByZXR1cm4gYSBuZXcgb25lLlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gZm9yY2VSZWZyZXNoIC0gRm9yY2UgcmVmcmVzaCByZWdhcmRsZXNzIG9mIHRva2VuIGV4cGlyYXRpb24uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0SWRUb2tlbih1c2VyOiBVc2VyLCBmb3JjZVJlZnJlc2ggPSBmYWxzZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikuZ2V0SWRUb2tlbihmb3JjZVJlZnJlc2gpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBkZXNlcmlhbGl6ZWQgSlNPTiBXZWIgVG9rZW4gKEpXVCkgdXNlZCB0byBpZGVudGlmeSB0aGUgdXNlciB0byBhIEZpcmViYXNlIHNlcnZpY2UuXG4gKlxuICogQHJlbWFya3NcbiAqIFJldHVybnMgdGhlIGN1cnJlbnQgdG9rZW4gaWYgaXQgaGFzIG5vdCBleHBpcmVkIG9yIGlmIGl0IHdpbGwgbm90IGV4cGlyZSBpbiB0aGUgbmV4dCBmaXZlXG4gKiBtaW51dGVzLiBPdGhlcndpc2UsIHRoaXMgd2lsbCByZWZyZXNoIHRoZSB0b2tlbiBhbmQgcmV0dXJuIGEgbmV3IG9uZS5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIGZvcmNlUmVmcmVzaCAtIEZvcmNlIHJlZnJlc2ggcmVnYXJkbGVzcyBvZiB0b2tlbiBleHBpcmF0aW9uLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldElkVG9rZW5SZXN1bHQoXG4gIHVzZXI6IFVzZXIsXG4gIGZvcmNlUmVmcmVzaCA9IGZhbHNlXG4pOiBQcm9taXNlPElkVG9rZW5SZXN1bHQ+IHtcbiAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpIGFzIFVzZXJJbnRlcm5hbDtcbiAgY29uc3QgdG9rZW4gPSBhd2FpdCB1c2VySW50ZXJuYWwuZ2V0SWRUb2tlbihmb3JjZVJlZnJlc2gpO1xuICBjb25zdCBjbGFpbXMgPSBfcGFyc2VUb2tlbih0b2tlbik7XG5cbiAgX2Fzc2VydChcbiAgICBjbGFpbXMgJiYgY2xhaW1zLmV4cCAmJiBjbGFpbXMuYXV0aF90aW1lICYmIGNsYWltcy5pYXQsXG4gICAgdXNlckludGVybmFsLmF1dGgsXG4gICAgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUlxuICApO1xuICBjb25zdCBmaXJlYmFzZSA9XG4gICAgdHlwZW9mIGNsYWltcy5maXJlYmFzZSA9PT0gJ29iamVjdCcgPyBjbGFpbXMuZmlyZWJhc2UgOiB1bmRlZmluZWQ7XG5cbiAgY29uc3Qgc2lnbkluUHJvdmlkZXI6IHN0cmluZyB8IHVuZGVmaW5lZCA9IGZpcmViYXNlPy5bJ3NpZ25faW5fcHJvdmlkZXInXTtcblxuICByZXR1cm4ge1xuICAgIGNsYWltcyxcbiAgICB0b2tlbixcbiAgICBhdXRoVGltZTogdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKFxuICAgICAgc2Vjb25kc1N0cmluZ1RvTWlsbGlzZWNvbmRzKGNsYWltcy5hdXRoX3RpbWUpXG4gICAgKSEsXG4gICAgaXNzdWVkQXRUaW1lOiB1dGNUaW1lc3RhbXBUb0RhdGVTdHJpbmcoXG4gICAgICBzZWNvbmRzU3RyaW5nVG9NaWxsaXNlY29uZHMoY2xhaW1zLmlhdClcbiAgICApISxcbiAgICBleHBpcmF0aW9uVGltZTogdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKFxuICAgICAgc2Vjb25kc1N0cmluZ1RvTWlsbGlzZWNvbmRzKGNsYWltcy5leHApXG4gICAgKSEsXG4gICAgc2lnbkluUHJvdmlkZXI6IHNpZ25JblByb3ZpZGVyIHx8IG51bGwsXG4gICAgc2lnbkluU2Vjb25kRmFjdG9yOiBmaXJlYmFzZT8uWydzaWduX2luX3NlY29uZF9mYWN0b3InXSB8fCBudWxsXG4gIH07XG59XG5cbmZ1bmN0aW9uIHNlY29uZHNTdHJpbmdUb01pbGxpc2Vjb25kcyhzZWNvbmRzOiBzdHJpbmcpOiBudW1iZXIge1xuICByZXR1cm4gTnVtYmVyKHNlY29uZHMpICogMTAwMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9wYXJzZVRva2VuKHRva2VuOiBzdHJpbmcpOiBQYXJzZWRUb2tlbiB8IG51bGwge1xuICBjb25zdCBbYWxnb3JpdGhtLCBwYXlsb2FkLCBzaWduYXR1cmVdID0gdG9rZW4uc3BsaXQoJy4nKTtcbiAgaWYgKFxuICAgIGFsZ29yaXRobSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgcGF5bG9hZCA9PT0gdW5kZWZpbmVkIHx8XG4gICAgc2lnbmF0dXJlID09PSB1bmRlZmluZWRcbiAgKSB7XG4gICAgX2xvZ0Vycm9yKCdKV1QgbWFsZm9ybWVkLCBjb250YWluZWQgZmV3ZXIgdGhhbiAzIHNlY3Rpb25zJyk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IGRlY29kZWQgPSBiYXNlNjREZWNvZGUocGF5bG9hZCk7XG4gICAgaWYgKCFkZWNvZGVkKSB7XG4gICAgICBfbG9nRXJyb3IoJ0ZhaWxlZCB0byBkZWNvZGUgYmFzZTY0IEpXVCBwYXlsb2FkJyk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZGVjb2RlZCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBfbG9nRXJyb3IoXG4gICAgICAnQ2F1Z2h0IGVycm9yIHBhcnNpbmcgSldUIHBheWxvYWQgYXMgSlNPTicsXG4gICAgICAoZSBhcyBFcnJvcik/LnRvU3RyaW5nKClcbiAgICApO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogRXh0cmFjdCBleHBpcmVzSW4gVFRMIGZyb20gYSB0b2tlbiBieSBzdWJ0cmFjdGluZyB0aGUgZXhwaXJhdGlvbiBmcm9tIHRoZSBpc3N1YW5jZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF90b2tlbkV4cGlyZXNJbih0b2tlbjogc3RyaW5nKTogbnVtYmVyIHtcbiAgY29uc3QgcGFyc2VkVG9rZW4gPSBfcGFyc2VUb2tlbih0b2tlbik7XG4gIF9hc3NlcnQocGFyc2VkVG9rZW4sIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICBfYXNzZXJ0KHR5cGVvZiBwYXJzZWRUb2tlbi5leHAgIT09ICd1bmRlZmluZWQnLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgX2Fzc2VydCh0eXBlb2YgcGFyc2VkVG9rZW4uaWF0ICE9PSAndW5kZWZpbmVkJywgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gIHJldHVybiBOdW1iZXIocGFyc2VkVG9rZW4uZXhwKSAtIE51bWJlcihwYXJzZWRUb2tlbi5pYXQpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEZpcmViYXNlRXJyb3IgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbmltcG9ydCB7IFVzZXJJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfbG9nb3V0SWZJbnZhbGlkYXRlZDxUPihcbiAgdXNlcjogVXNlckludGVybmFsLFxuICBwcm9taXNlOiBQcm9taXNlPFQ+LFxuICBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZVxuKTogUHJvbWlzZTxUPiB7XG4gIGlmIChieXBhc3NBdXRoU3RhdGUpIHtcbiAgICByZXR1cm4gcHJvbWlzZTtcbiAgfVxuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBwcm9taXNlO1xuICB9IGNhdGNoIChlKSB7XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBGaXJlYmFzZUVycm9yICYmIGlzVXNlckludmFsaWRhdGVkKGUpKSB7XG4gICAgICBpZiAodXNlci5hdXRoLmN1cnJlbnRVc2VyID09PSB1c2VyKSB7XG4gICAgICAgIGF3YWl0IHVzZXIuYXV0aC5zaWduT3V0KCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhyb3cgZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc1VzZXJJbnZhbGlkYXRlZCh7IGNvZGUgfTogRmlyZWJhc2VFcnJvcik6IGJvb2xlYW4ge1xuICByZXR1cm4gKFxuICAgIGNvZGUgPT09IGBhdXRoLyR7QXV0aEVycm9yQ29kZS5VU0VSX0RJU0FCTEVEfWAgfHxcbiAgICBjb2RlID09PSBgYXV0aC8ke0F1dGhFcnJvckNvZGUuVE9LRU5fRVhQSVJFRH1gXG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IFVzZXJJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5cbi8vIFJlZnJlc2ggdGhlIHRva2VuIGZpdmUgbWludXRlcyBiZWZvcmUgZXhwaXJhdGlvblxuZXhwb3J0IGNvbnN0IGVudW0gRHVyYXRpb24ge1xuICBPRkZTRVQgPSA1ICogMTAwMCAqIDYwLFxuICBSRVRSWV9CQUNLT0ZGX01JTiA9IDMwICogMTAwMCxcbiAgUkVUUllfQkFDS09GRl9NQVggPSAxNiAqIDYwICogMTAwMFxufVxuXG5leHBvcnQgY2xhc3MgUHJvYWN0aXZlUmVmcmVzaCB7XG4gIHByaXZhdGUgaXNSdW5uaW5nID0gZmFsc2U7XG5cbiAgLy8gTm9kZSB0aW1lcnMgYW5kIGJyb3dzZXIgdGltZXJzIHJldHVybiBmdW5kYW1lbnRhbGx5IGRpZmZlcmVudCB0eXBlcy5cbiAgLy8gV2UgZG9uJ3QgYWN0dWFsbHkgY2FyZSB3aGF0IHRoZSB2YWx1ZSBpcyBidXQgVFMgd29uJ3QgYWNjZXB0IHVua25vd24gYW5kXG4gIC8vIHdlIGNhbid0IGNhc3QgcHJvcGVybHkgaW4gYm90aCBlbnZpcm9ubWVudHMuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIHByaXZhdGUgdGltZXJJZDogYW55IHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgZXJyb3JCYWNrb2ZmID0gRHVyYXRpb24uUkVUUllfQkFDS09GRl9NSU47XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSB1c2VyOiBVc2VySW50ZXJuYWwpIHt9XG5cbiAgX3N0YXJ0KCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmlzUnVubmluZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNSdW5uaW5nID0gdHJ1ZTtcbiAgICB0aGlzLnNjaGVkdWxlKCk7XG4gIH1cblxuICBfc3RvcCgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuaXNSdW5uaW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pc1J1bm5pbmcgPSBmYWxzZTtcbiAgICBpZiAodGhpcy50aW1lcklkICE9PSBudWxsKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcklkKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEludGVydmFsKHdhc0Vycm9yOiBib29sZWFuKTogbnVtYmVyIHtcbiAgICBpZiAod2FzRXJyb3IpIHtcbiAgICAgIGNvbnN0IGludGVydmFsID0gdGhpcy5lcnJvckJhY2tvZmY7XG4gICAgICB0aGlzLmVycm9yQmFja29mZiA9IE1hdGgubWluKFxuICAgICAgICB0aGlzLmVycm9yQmFja29mZiAqIDIsXG4gICAgICAgIER1cmF0aW9uLlJFVFJZX0JBQ0tPRkZfTUFYXG4gICAgICApO1xuICAgICAgcmV0dXJuIGludGVydmFsO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBSZXNldCB0aGUgZXJyb3IgYmFja29mZlxuICAgICAgdGhpcy5lcnJvckJhY2tvZmYgPSBEdXJhdGlvbi5SRVRSWV9CQUNLT0ZGX01JTjtcbiAgICAgIGNvbnN0IGV4cFRpbWUgPSB0aGlzLnVzZXIuc3RzVG9rZW5NYW5hZ2VyLmV4cGlyYXRpb25UaW1lID8/IDA7XG4gICAgICBjb25zdCBpbnRlcnZhbCA9IGV4cFRpbWUgLSBEYXRlLm5vdygpIC0gRHVyYXRpb24uT0ZGU0VUO1xuXG4gICAgICByZXR1cm4gTWF0aC5tYXgoMCwgaW50ZXJ2YWwpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2NoZWR1bGUod2FzRXJyb3IgPSBmYWxzZSk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHtcbiAgICAgIC8vIEp1c3QgaW4gY2FzZS4uLlxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGludGVydmFsID0gdGhpcy5nZXRJbnRlcnZhbCh3YXNFcnJvcik7XG4gICAgdGhpcy50aW1lcklkID0gc2V0VGltZW91dChhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB0aGlzLml0ZXJhdGlvbigpO1xuICAgIH0sIGludGVydmFsKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaXRlcmF0aW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnVzZXIuZ2V0SWRUb2tlbih0cnVlKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBPbmx5IHJldHJ5IG9uIG5ldHdvcmsgZXJyb3JzXG4gICAgICBpZiAoXG4gICAgICAgIChlIGFzIEZpcmViYXNlRXJyb3IpPy5jb2RlID09PVxuICAgICAgICBgYXV0aC8ke0F1dGhFcnJvckNvZGUuTkVUV09SS19SRVFVRVNUX0ZBSUxFRH1gXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5zY2hlZHVsZSgvKiB3YXNFcnJvciAqLyB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNjaGVkdWxlKCk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBVc2VyTWV0YWRhdGEgYXMgVXNlck1ldGFkYXRhVHlwZSB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCB7IHV0Y1RpbWVzdGFtcFRvRGF0ZVN0cmluZyB9IGZyb20gJy4uL3V0aWwvdGltZSc7XG5cbmV4cG9ydCBjbGFzcyBVc2VyTWV0YWRhdGEgaW1wbGVtZW50cyBVc2VyTWV0YWRhdGFUeXBlIHtcbiAgY3JlYXRpb25UaW1lPzogc3RyaW5nO1xuICBsYXN0U2lnbkluVGltZT86IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGNyZWF0ZWRBdD86IHN0cmluZyB8IG51bWJlcixcbiAgICBwcml2YXRlIGxhc3RMb2dpbkF0Pzogc3RyaW5nIHwgbnVtYmVyXG4gICkge1xuICAgIHRoaXMuX2luaXRpYWxpemVUaW1lKCk7XG4gIH1cblxuICBwcml2YXRlIF9pbml0aWFsaXplVGltZSgpOiB2b2lkIHtcbiAgICB0aGlzLmxhc3RTaWduSW5UaW1lID0gdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHRoaXMubGFzdExvZ2luQXQpO1xuICAgIHRoaXMuY3JlYXRpb25UaW1lID0gdXRjVGltZXN0YW1wVG9EYXRlU3RyaW5nKHRoaXMuY3JlYXRlZEF0KTtcbiAgfVxuXG4gIF9jb3B5KG1ldGFkYXRhOiBVc2VyTWV0YWRhdGEpOiB2b2lkIHtcbiAgICB0aGlzLmNyZWF0ZWRBdCA9IG1ldGFkYXRhLmNyZWF0ZWRBdDtcbiAgICB0aGlzLmxhc3RMb2dpbkF0ID0gbWV0YWRhdGEubGFzdExvZ2luQXQ7XG4gICAgdGhpcy5faW5pdGlhbGl6ZVRpbWUoKTtcbiAgfVxuXG4gIHRvSlNPTigpOiBvYmplY3Qge1xuICAgIHJldHVybiB7XG4gICAgICBjcmVhdGVkQXQ6IHRoaXMuY3JlYXRlZEF0LFxuICAgICAgbGFzdExvZ2luQXQ6IHRoaXMubGFzdExvZ2luQXRcbiAgICB9O1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgVXNlciwgVXNlckluZm8gfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5pbXBvcnQge1xuICBnZXRBY2NvdW50SW5mbyxcbiAgUHJvdmlkZXJVc2VySW5mb1xufSBmcm9tICcuLi8uLi9hcGkvYWNjb3VudF9tYW5hZ2VtZW50L2FjY291bnQnO1xuaW1wb3J0IHsgVXNlckludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IF9hc3NlcnQgfSBmcm9tICcuLi91dGlsL2Fzc2VydCc7XG5pbXBvcnQgeyBfbG9nb3V0SWZJbnZhbGlkYXRlZCB9IGZyb20gJy4vaW52YWxpZGF0aW9uJztcbmltcG9ydCB7IFVzZXJNZXRhZGF0YSB9IGZyb20gJy4vdXNlcl9tZXRhZGF0YSc7XG5pbXBvcnQgeyBnZXRNb2R1bGFySW5zdGFuY2UgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VyOiBVc2VySW50ZXJuYWwpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgYXV0aCA9IHVzZXIuYXV0aDtcbiAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKFxuICAgIHVzZXIsXG4gICAgZ2V0QWNjb3VudEluZm8oYXV0aCwgeyBpZFRva2VuIH0pXG4gICk7XG5cbiAgX2Fzc2VydChyZXNwb25zZT8udXNlcnMubGVuZ3RoLCBhdXRoLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcblxuICBjb25zdCBjb3JlQWNjb3VudCA9IHJlc3BvbnNlLnVzZXJzWzBdO1xuXG4gIHVzZXIuX25vdGlmeVJlbG9hZExpc3RlbmVyKGNvcmVBY2NvdW50KTtcblxuICBjb25zdCBuZXdQcm92aWRlckRhdGEgPSBjb3JlQWNjb3VudC5wcm92aWRlclVzZXJJbmZvPy5sZW5ndGhcbiAgICA/IGV4dHJhY3RQcm92aWRlckRhdGEoY29yZUFjY291bnQucHJvdmlkZXJVc2VySW5mbylcbiAgICA6IFtdO1xuXG4gIGNvbnN0IHByb3ZpZGVyRGF0YSA9IG1lcmdlUHJvdmlkZXJEYXRhKHVzZXIucHJvdmlkZXJEYXRhLCBuZXdQcm92aWRlckRhdGEpO1xuXG4gIC8vIFByZXNlcnZlcyB0aGUgbm9uLW5vbnltb3VzIHN0YXR1cyBvZiB0aGUgc3RvcmVkIHVzZXIsIGV2ZW4gaWYgbm8gbW9yZVxuICAvLyBjcmVkZW50aWFscyAoZmVkZXJhdGVkIG9yIGVtYWlsL3Bhc3N3b3JkKSBhcmUgbGlua2VkIHRvIHRoZSB1c2VyLiBJZlxuICAvLyB0aGUgdXNlciB3YXMgcHJldmlvdXNseSBhbm9ueW1vdXMsIHRoZW4gdXNlIHByb3ZpZGVyIGRhdGEgdG8gdXBkYXRlLlxuICAvLyBPbiB0aGUgb3RoZXIgaGFuZCwgaWYgaXQgd2FzIG5vdCBhbm9ueW1vdXMgYmVmb3JlLCBpdCBzaG91bGQgbmV2ZXIgYmVcbiAgLy8gY29uc2lkZXJlZCBhbm9ueW1vdXMgbm93LlxuICBjb25zdCBvbGRJc0Fub255bW91cyA9IHVzZXIuaXNBbm9ueW1vdXM7XG4gIGNvbnN0IG5ld0lzQW5vbnltb3VzID1cbiAgICAhKHVzZXIuZW1haWwgJiYgY29yZUFjY291bnQucGFzc3dvcmRIYXNoKSAmJiAhcHJvdmlkZXJEYXRhPy5sZW5ndGg7XG4gIGNvbnN0IGlzQW5vbnltb3VzID0gIW9sZElzQW5vbnltb3VzID8gZmFsc2UgOiBuZXdJc0Fub255bW91cztcblxuICBjb25zdCB1cGRhdGVzOiBQYXJ0aWFsPFVzZXJJbnRlcm5hbD4gPSB7XG4gICAgdWlkOiBjb3JlQWNjb3VudC5sb2NhbElkLFxuICAgIGRpc3BsYXlOYW1lOiBjb3JlQWNjb3VudC5kaXNwbGF5TmFtZSB8fCBudWxsLFxuICAgIHBob3RvVVJMOiBjb3JlQWNjb3VudC5waG90b1VybCB8fCBudWxsLFxuICAgIGVtYWlsOiBjb3JlQWNjb3VudC5lbWFpbCB8fCBudWxsLFxuICAgIGVtYWlsVmVyaWZpZWQ6IGNvcmVBY2NvdW50LmVtYWlsVmVyaWZpZWQgfHwgZmFsc2UsXG4gICAgcGhvbmVOdW1iZXI6IGNvcmVBY2NvdW50LnBob25lTnVtYmVyIHx8IG51bGwsXG4gICAgdGVuYW50SWQ6IGNvcmVBY2NvdW50LnRlbmFudElkIHx8IG51bGwsXG4gICAgcHJvdmlkZXJEYXRhLFxuICAgIG1ldGFkYXRhOiBuZXcgVXNlck1ldGFkYXRhKGNvcmVBY2NvdW50LmNyZWF0ZWRBdCwgY29yZUFjY291bnQubGFzdExvZ2luQXQpLFxuICAgIGlzQW5vbnltb3VzXG4gIH07XG5cbiAgT2JqZWN0LmFzc2lnbih1c2VyLCB1cGRhdGVzKTtcbn1cblxuLyoqXG4gKiBSZWxvYWRzIHVzZXIgYWNjb3VudCBkYXRhLCBpZiBzaWduZWQgaW4uXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWxvYWQodXNlcjogVXNlcik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB1c2VySW50ZXJuYWw6IFVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSBhcyBVc2VySW50ZXJuYWw7XG4gIGF3YWl0IF9yZWxvYWRXaXRob3V0U2F2aW5nKHVzZXJJbnRlcm5hbCk7XG5cbiAgLy8gRXZlbiB0aG91Z2ggdGhlIGN1cnJlbnQgdXNlciBoYXNuJ3QgY2hhbmdlZCwgdXBkYXRlXG4gIC8vIGN1cnJlbnQgdXNlciB3aWxsIHRyaWdnZXIgYSBwZXJzaXN0ZW5jZSB1cGRhdGUgdy8gdGhlXG4gIC8vIG5ldyBpbmZvLlxuICBhd2FpdCB1c2VySW50ZXJuYWwuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlckludGVybmFsKTtcbiAgdXNlckludGVybmFsLmF1dGguX25vdGlmeUxpc3RlbmVyc0lmQ3VycmVudCh1c2VySW50ZXJuYWwpO1xufVxuXG5mdW5jdGlvbiBtZXJnZVByb3ZpZGVyRGF0YShcbiAgb3JpZ2luYWw6IFVzZXJJbmZvW10sXG4gIG5ld0RhdGE6IFVzZXJJbmZvW11cbik6IFVzZXJJbmZvW10ge1xuICBjb25zdCBkZWR1cGVkID0gb3JpZ2luYWwuZmlsdGVyKFxuICAgIG8gPT4gIW5ld0RhdGEuc29tZShuID0+IG4ucHJvdmlkZXJJZCA9PT0gby5wcm92aWRlcklkKVxuICApO1xuICByZXR1cm4gWy4uLmRlZHVwZWQsIC4uLm5ld0RhdGFdO1xufVxuXG5mdW5jdGlvbiBleHRyYWN0UHJvdmlkZXJEYXRhKHByb3ZpZGVyczogUHJvdmlkZXJVc2VySW5mb1tdKTogVXNlckluZm9bXSB7XG4gIHJldHVybiBwcm92aWRlcnMubWFwKCh7IHByb3ZpZGVySWQsIC4uLnByb3ZpZGVyIH0pID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgcHJvdmlkZXJJZCxcbiAgICAgIHVpZDogcHJvdmlkZXIucmF3SWQgfHwgJycsXG4gICAgICBkaXNwbGF5TmFtZTogcHJvdmlkZXIuZGlzcGxheU5hbWUgfHwgbnVsbCxcbiAgICAgIGVtYWlsOiBwcm92aWRlci5lbWFpbCB8fCBudWxsLFxuICAgICAgcGhvbmVOdW1iZXI6IHByb3ZpZGVyLnBob25lTnVtYmVyIHx8IG51bGwsXG4gICAgICBwaG90b1VSTDogcHJvdmlkZXIucGhvdG9VcmwgfHwgbnVsbFxuICAgIH07XG4gIH0pO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSAqL1xuXG5pbXBvcnQgeyBxdWVyeXN0cmluZyB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuaW1wb3J0IHtcbiAgX2dldEZpbmFsVGFyZ2V0LFxuICBfcGVyZm9ybUZldGNoV2l0aEVycm9ySGFuZGxpbmcsXG4gIEh0dHBNZXRob2QsXG4gIEh0dHBIZWFkZXJcbn0gZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IHsgRmV0Y2hQcm92aWRlciB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9mZXRjaF9wcm92aWRlcic7XG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuXG5leHBvcnQgY29uc3QgZW51bSBFbmRwb2ludCB7XG4gIFRPS0VOID0gJy92MS90b2tlbidcbn1cblxuLyoqIFRoZSBzZXJ2ZXIgcmVzcG9uc2VzIHdpdGggc25ha2VfY2FzZTsgd2UgY29udmVydCB0byBjYW1lbENhc2UgKi9cbmludGVyZmFjZSBSZXF1ZXN0U3RzVG9rZW5TZXJ2ZXJSZXNwb25zZSB7XG4gIGFjY2Vzc190b2tlbjogc3RyaW5nO1xuICBleHBpcmVzX2luOiBzdHJpbmc7XG4gIHJlZnJlc2hfdG9rZW46IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXF1ZXN0U3RzVG9rZW5SZXNwb25zZSB7XG4gIGFjY2Vzc1Rva2VuOiBzdHJpbmc7XG4gIGV4cGlyZXNJbjogc3RyaW5nO1xuICByZWZyZXNoVG9rZW46IHN0cmluZztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3RTdHNUb2tlbihcbiAgYXV0aDogQXV0aCxcbiAgcmVmcmVzaFRva2VuOiBzdHJpbmdcbik6IFByb21pc2U8UmVxdWVzdFN0c1Rva2VuUmVzcG9uc2U+IHtcbiAgY29uc3QgcmVzcG9uc2UgPVxuICAgIGF3YWl0IF9wZXJmb3JtRmV0Y2hXaXRoRXJyb3JIYW5kbGluZzxSZXF1ZXN0U3RzVG9rZW5TZXJ2ZXJSZXNwb25zZT4oXG4gICAgICBhdXRoLFxuICAgICAge30sXG4gICAgICBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGJvZHkgPSBxdWVyeXN0cmluZyh7XG4gICAgICAgICAgJ2dyYW50X3R5cGUnOiAncmVmcmVzaF90b2tlbicsXG4gICAgICAgICAgJ3JlZnJlc2hfdG9rZW4nOiByZWZyZXNoVG9rZW5cbiAgICAgICAgfSkuc2xpY2UoMSk7XG4gICAgICAgIGNvbnN0IHsgdG9rZW5BcGlIb3N0LCBhcGlLZXkgfSA9IGF1dGguY29uZmlnO1xuICAgICAgICBjb25zdCB1cmwgPSBfZ2V0RmluYWxUYXJnZXQoXG4gICAgICAgICAgYXV0aCxcbiAgICAgICAgICB0b2tlbkFwaUhvc3QsXG4gICAgICAgICAgRW5kcG9pbnQuVE9LRU4sXG4gICAgICAgICAgYGtleT0ke2FwaUtleX1gXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgaGVhZGVycyA9IGF3YWl0IChhdXRoIGFzIEF1dGhJbnRlcm5hbCkuX2dldEFkZGl0aW9uYWxIZWFkZXJzKCk7XG4gICAgICAgIGhlYWRlcnNbSHR0cEhlYWRlci5DT05URU5UX1RZUEVdID0gJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCc7XG5cbiAgICAgICAgcmV0dXJuIEZldGNoUHJvdmlkZXIuZmV0Y2goKSh1cmwsIHtcbiAgICAgICAgICBtZXRob2Q6IEh0dHBNZXRob2QuUE9TVCxcbiAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIGJvZHlcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgKTtcblxuICAvLyBUaGUgcmVzcG9uc2UgY29tZXMgYmFjayBpbiBzbmFrZV9jYXNlLiBDb252ZXJ0IHRvIGNhbWVsOlxuICByZXR1cm4ge1xuICAgIGFjY2Vzc1Rva2VuOiByZXNwb25zZS5hY2Nlc3NfdG9rZW4sXG4gICAgZXhwaXJlc0luOiByZXNwb25zZS5leHBpcmVzX2luLFxuICAgIHJlZnJlc2hUb2tlbjogcmVzcG9uc2UucmVmcmVzaF90b2tlblxuICB9O1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEZpbmFsaXplTWZhUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IHJlcXVlc3RTdHNUb2tlbiB9IGZyb20gJy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi90b2tlbic7XG5pbXBvcnQgeyBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7IElkVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9lcnJvcnMnO1xuaW1wb3J0IHsgUGVyc2lzdGVkQmxvYiB9IGZyb20gJy4uL3BlcnNpc3RlbmNlJztcbmltcG9ydCB7IF9hc3NlcnQsIGRlYnVnRmFpbCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IF90b2tlbkV4cGlyZXNJbiB9IGZyb20gJy4vaWRfdG9rZW5fcmVzdWx0JztcblxuLyoqXG4gKiBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBiZWZvcmUgdGhlIG9mZmljaWFsIGV4cGlyYXRpb24gdGltZSBvZiBhIHRva2VuXG4gKiB0byByZWZyZXNoIHRoYXQgdG9rZW4sIHRvIHByb3ZpZGUgYSBidWZmZXIgZm9yIFJQQ3MgdG8gY29tcGxldGUuXG4gKi9cbmV4cG9ydCBjb25zdCBlbnVtIEJ1ZmZlciB7XG4gIFRPS0VOX1JFRlJFU0ggPSAzMF8wMDBcbn1cblxuLyoqXG4gKiBXZSBuZWVkIHRvIG1hcmsgdGhpcyBjbGFzcyBhcyBpbnRlcm5hbCBleHBsaWNpdGx5IHRvIGV4Y2x1ZGUgaXQgaW4gdGhlIHB1YmxpYyB0eXBpbmdzLCBiZWNhdXNlXG4gKiBpdCByZWZlcmVuY2VzIEF1dGhJbnRlcm5hbCB3aGljaCBoYXMgYSBjaXJjdWxhciBkZXBlbmRlbmN5IHdpdGggVXNlckludGVybmFsLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgY2xhc3MgU3RzVG9rZW5NYW5hZ2VyIHtcbiAgcmVmcmVzaFRva2VuOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgYWNjZXNzVG9rZW46IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBleHBpcmF0aW9uVGltZTogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cbiAgZ2V0IGlzRXhwaXJlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKFxuICAgICAgIXRoaXMuZXhwaXJhdGlvblRpbWUgfHxcbiAgICAgIERhdGUubm93KCkgPiB0aGlzLmV4cGlyYXRpb25UaW1lIC0gQnVmZmVyLlRPS0VOX1JFRlJFU0hcbiAgICApO1xuICB9XG5cbiAgdXBkYXRlRnJvbVNlcnZlclJlc3BvbnNlKFxuICAgIHJlc3BvbnNlOiBJZFRva2VuUmVzcG9uc2UgfCBGaW5hbGl6ZU1mYVJlc3BvbnNlXG4gICk6IHZvaWQge1xuICAgIF9hc3NlcnQocmVzcG9uc2UuaWRUb2tlbiwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gICAgX2Fzc2VydChcbiAgICAgIHR5cGVvZiByZXNwb25zZS5pZFRva2VuICE9PSAndW5kZWZpbmVkJyxcbiAgICAgIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1JcbiAgICApO1xuICAgIF9hc3NlcnQoXG4gICAgICB0eXBlb2YgcmVzcG9uc2UucmVmcmVzaFRva2VuICE9PSAndW5kZWZpbmVkJyxcbiAgICAgIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1JcbiAgICApO1xuICAgIGNvbnN0IGV4cGlyZXNJbiA9XG4gICAgICAnZXhwaXJlc0luJyBpbiByZXNwb25zZSAmJiB0eXBlb2YgcmVzcG9uc2UuZXhwaXJlc0luICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICA/IE51bWJlcihyZXNwb25zZS5leHBpcmVzSW4pXG4gICAgICAgIDogX3Rva2VuRXhwaXJlc0luKHJlc3BvbnNlLmlkVG9rZW4pO1xuICAgIHRoaXMudXBkYXRlVG9rZW5zQW5kRXhwaXJhdGlvbihcbiAgICAgIHJlc3BvbnNlLmlkVG9rZW4sXG4gICAgICByZXNwb25zZS5yZWZyZXNoVG9rZW4sXG4gICAgICBleHBpcmVzSW5cbiAgICApO1xuICB9XG5cbiAgYXN5bmMgZ2V0VG9rZW4oXG4gICAgYXV0aDogQXV0aEludGVybmFsLFxuICAgIGZvcmNlUmVmcmVzaCA9IGZhbHNlXG4gICk6IFByb21pc2U8c3RyaW5nIHwgbnVsbD4ge1xuICAgIF9hc3NlcnQoXG4gICAgICAhdGhpcy5hY2Nlc3NUb2tlbiB8fCB0aGlzLnJlZnJlc2hUb2tlbixcbiAgICAgIGF1dGgsXG4gICAgICBBdXRoRXJyb3JDb2RlLlRPS0VOX0VYUElSRURcbiAgICApO1xuXG4gICAgaWYgKCFmb3JjZVJlZnJlc2ggJiYgdGhpcy5hY2Nlc3NUb2tlbiAmJiAhdGhpcy5pc0V4cGlyZWQpIHtcbiAgICAgIHJldHVybiB0aGlzLmFjY2Vzc1Rva2VuO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnJlZnJlc2hUb2tlbikge1xuICAgICAgYXdhaXQgdGhpcy5yZWZyZXNoKGF1dGgsIHRoaXMucmVmcmVzaFRva2VuISk7XG4gICAgICByZXR1cm4gdGhpcy5hY2Nlc3NUb2tlbjtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNsZWFyUmVmcmVzaFRva2VuKCk6IHZvaWQge1xuICAgIHRoaXMucmVmcmVzaFRva2VuID0gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVmcmVzaChhdXRoOiBBdXRoSW50ZXJuYWwsIG9sZFRva2VuOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IGFjY2Vzc1Rva2VuLCByZWZyZXNoVG9rZW4sIGV4cGlyZXNJbiB9ID0gYXdhaXQgcmVxdWVzdFN0c1Rva2VuKFxuICAgICAgYXV0aCxcbiAgICAgIG9sZFRva2VuXG4gICAgKTtcbiAgICB0aGlzLnVwZGF0ZVRva2Vuc0FuZEV4cGlyYXRpb24oXG4gICAgICBhY2Nlc3NUb2tlbixcbiAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgIE51bWJlcihleHBpcmVzSW4pXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlVG9rZW5zQW5kRXhwaXJhdGlvbihcbiAgICBhY2Nlc3NUb2tlbjogc3RyaW5nLFxuICAgIHJlZnJlc2hUb2tlbjogc3RyaW5nLFxuICAgIGV4cGlyZXNJblNlYzogbnVtYmVyXG4gICk6IHZvaWQge1xuICAgIHRoaXMucmVmcmVzaFRva2VuID0gcmVmcmVzaFRva2VuIHx8IG51bGw7XG4gICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuIHx8IG51bGw7XG4gICAgdGhpcy5leHBpcmF0aW9uVGltZSA9IERhdGUubm93KCkgKyBleHBpcmVzSW5TZWMgKiAxMDAwO1xuICB9XG5cbiAgc3RhdGljIGZyb21KU09OKGFwcE5hbWU6IHN0cmluZywgb2JqZWN0OiBQZXJzaXN0ZWRCbG9iKTogU3RzVG9rZW5NYW5hZ2VyIHtcbiAgICBjb25zdCB7IHJlZnJlc2hUb2tlbiwgYWNjZXNzVG9rZW4sIGV4cGlyYXRpb25UaW1lIH0gPSBvYmplY3Q7XG5cbiAgICBjb25zdCBtYW5hZ2VyID0gbmV3IFN0c1Rva2VuTWFuYWdlcigpO1xuICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcbiAgICAgIF9hc3NlcnQodHlwZW9mIHJlZnJlc2hUb2tlbiA9PT0gJ3N0cmluZycsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IsIHtcbiAgICAgICAgYXBwTmFtZVxuICAgICAgfSk7XG4gICAgICBtYW5hZ2VyLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcbiAgICB9XG4gICAgaWYgKGFjY2Vzc1Rva2VuKSB7XG4gICAgICBfYXNzZXJ0KHR5cGVvZiBhY2Nlc3NUb2tlbiA9PT0gJ3N0cmluZycsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IsIHtcbiAgICAgICAgYXBwTmFtZVxuICAgICAgfSk7XG4gICAgICBtYW5hZ2VyLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgfVxuICAgIGlmIChleHBpcmF0aW9uVGltZSkge1xuICAgICAgX2Fzc2VydChcbiAgICAgICAgdHlwZW9mIGV4cGlyYXRpb25UaW1lID09PSAnbnVtYmVyJyxcbiAgICAgICAgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUixcbiAgICAgICAge1xuICAgICAgICAgIGFwcE5hbWVcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIG1hbmFnZXIuZXhwaXJhdGlvblRpbWUgPSBleHBpcmF0aW9uVGltZTtcbiAgICB9XG4gICAgcmV0dXJuIG1hbmFnZXI7XG4gIH1cblxuICB0b0pTT04oKTogb2JqZWN0IHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVmcmVzaFRva2VuOiB0aGlzLnJlZnJlc2hUb2tlbixcbiAgICAgIGFjY2Vzc1Rva2VuOiB0aGlzLmFjY2Vzc1Rva2VuLFxuICAgICAgZXhwaXJhdGlvblRpbWU6IHRoaXMuZXhwaXJhdGlvblRpbWVcbiAgICB9O1xuICB9XG5cbiAgX2Fzc2lnbihzdHNUb2tlbk1hbmFnZXI6IFN0c1Rva2VuTWFuYWdlcik6IHZvaWQge1xuICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBzdHNUb2tlbk1hbmFnZXIuYWNjZXNzVG9rZW47XG4gICAgdGhpcy5yZWZyZXNoVG9rZW4gPSBzdHNUb2tlbk1hbmFnZXIucmVmcmVzaFRva2VuO1xuICAgIHRoaXMuZXhwaXJhdGlvblRpbWUgPSBzdHNUb2tlbk1hbmFnZXIuZXhwaXJhdGlvblRpbWU7XG4gIH1cblxuICBfY2xvbmUoKTogU3RzVG9rZW5NYW5hZ2VyIHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihuZXcgU3RzVG9rZW5NYW5hZ2VyKCksIHRoaXMudG9KU09OKCkpO1xuICB9XG5cbiAgX3BlcmZvcm1SZWZyZXNoKCk6IG5ldmVyIHtcbiAgICByZXR1cm4gZGVidWdGYWlsKCdub3QgaW1wbGVtZW50ZWQnKTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IElkVG9rZW5SZXN1bHQgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgTmV4dEZuIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5pbXBvcnQge1xuICBBUElVc2VySW5mbyxcbiAgZGVsZXRlQWNjb3VudFxufSBmcm9tICcuLi8uLi9hcGkvYWNjb3VudF9tYW5hZ2VtZW50L2FjY291bnQnO1xuaW1wb3J0IHsgRmluYWxpemVNZmFSZXNwb25zZSB9IGZyb20gJy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi9tZmEnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBJZFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9tb2RlbC9pZF90b2tlbic7XG5pbXBvcnQge1xuICBNdXRhYmxlVXNlckluZm8sXG4gIFVzZXJJbnRlcm5hbCxcbiAgVXNlclBhcmFtZXRlcnNcbn0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IFBlcnNpc3RlZEJsb2IgfSBmcm9tICcuLi9wZXJzaXN0ZW5jZSc7XG5pbXBvcnQgeyBfYXNzZXJ0IH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgZ2V0SWRUb2tlblJlc3VsdCB9IGZyb20gJy4vaWRfdG9rZW5fcmVzdWx0JztcbmltcG9ydCB7IF9sb2dvdXRJZkludmFsaWRhdGVkIH0gZnJvbSAnLi9pbnZhbGlkYXRpb24nO1xuaW1wb3J0IHsgUHJvYWN0aXZlUmVmcmVzaCB9IGZyb20gJy4vcHJvYWN0aXZlX3JlZnJlc2gnO1xuaW1wb3J0IHsgX3JlbG9hZFdpdGhvdXRTYXZpbmcsIHJlbG9hZCB9IGZyb20gJy4vcmVsb2FkJztcbmltcG9ydCB7IFN0c1Rva2VuTWFuYWdlciB9IGZyb20gJy4vdG9rZW5fbWFuYWdlcic7XG5pbXBvcnQgeyBVc2VyTWV0YWRhdGEgfSBmcm9tICcuL3VzZXJfbWV0YWRhdGEnO1xuaW1wb3J0IHsgUHJvdmlkZXJJZCB9IGZyb20gJy4uLy4uL21vZGVsL2VudW1zJztcblxuZnVuY3Rpb24gYXNzZXJ0U3RyaW5nT3JVbmRlZmluZWQoXG4gIGFzc2VydGlvbjogdW5rbm93bixcbiAgYXBwTmFtZTogc3RyaW5nXG4pOiBhc3NlcnRzIGFzc2VydGlvbiBpcyBzdHJpbmcgfCB1bmRlZmluZWQge1xuICBfYXNzZXJ0KFxuICAgIHR5cGVvZiBhc3NlcnRpb24gPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBhc3NlcnRpb24gPT09ICd1bmRlZmluZWQnLFxuICAgIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IsXG4gICAgeyBhcHBOYW1lIH1cbiAgKTtcbn1cblxuZXhwb3J0IGNsYXNzIFVzZXJJbXBsIGltcGxlbWVudHMgVXNlckludGVybmFsIHtcbiAgLy8gRm9yIHRoZSB1c2VyIG9iamVjdCwgcHJvdmlkZXIgaXMgYWx3YXlzIEZpcmViYXNlLlxuICByZWFkb25seSBwcm92aWRlcklkID0gUHJvdmlkZXJJZC5GSVJFQkFTRTtcbiAgc3RzVG9rZW5NYW5hZ2VyOiBTdHNUb2tlbk1hbmFnZXI7XG4gIC8vIExhc3Qga25vd24gYWNjZXNzVG9rZW4gc28gd2Uga25vdyB3aGVuIGl0IGNoYW5nZXNcbiAgcHJpdmF0ZSBhY2Nlc3NUb2tlbjogc3RyaW5nIHwgbnVsbDtcblxuICB1aWQ6IHN0cmluZztcbiAgYXV0aDogQXV0aEludGVybmFsO1xuICBlbWFpbFZlcmlmaWVkOiBib29sZWFuO1xuICBpc0Fub255bW91czogYm9vbGVhbjtcbiAgdGVuYW50SWQ6IHN0cmluZyB8IG51bGw7XG4gIHJlYWRvbmx5IG1ldGFkYXRhOiBVc2VyTWV0YWRhdGE7XG4gIHByb3ZpZGVyRGF0YTogTXV0YWJsZVVzZXJJbmZvW107XG5cbiAgLy8gT3B0aW9uYWwgZmllbGRzIGZyb20gVXNlckluZm9cbiAgZGlzcGxheU5hbWU6IHN0cmluZyB8IG51bGw7XG4gIGVtYWlsOiBzdHJpbmcgfCBudWxsO1xuICBwaG9uZU51bWJlcjogc3RyaW5nIHwgbnVsbDtcbiAgcGhvdG9VUkw6IHN0cmluZyB8IG51bGw7XG5cbiAgX3JlZGlyZWN0RXZlbnRJZD86IHN0cmluZztcbiAgcHJpdmF0ZSByZWFkb25seSBwcm9hY3RpdmVSZWZyZXNoID0gbmV3IFByb2FjdGl2ZVJlZnJlc2godGhpcyk7XG5cbiAgY29uc3RydWN0b3IoeyB1aWQsIGF1dGgsIHN0c1Rva2VuTWFuYWdlciwgLi4ub3B0IH06IFVzZXJQYXJhbWV0ZXJzKSB7XG4gICAgdGhpcy51aWQgPSB1aWQ7XG4gICAgdGhpcy5hdXRoID0gYXV0aDtcbiAgICB0aGlzLnN0c1Rva2VuTWFuYWdlciA9IHN0c1Rva2VuTWFuYWdlcjtcbiAgICB0aGlzLmFjY2Vzc1Rva2VuID0gc3RzVG9rZW5NYW5hZ2VyLmFjY2Vzc1Rva2VuO1xuICAgIHRoaXMuZGlzcGxheU5hbWUgPSBvcHQuZGlzcGxheU5hbWUgfHwgbnVsbDtcbiAgICB0aGlzLmVtYWlsID0gb3B0LmVtYWlsIHx8IG51bGw7XG4gICAgdGhpcy5lbWFpbFZlcmlmaWVkID0gb3B0LmVtYWlsVmVyaWZpZWQgfHwgZmFsc2U7XG4gICAgdGhpcy5waG9uZU51bWJlciA9IG9wdC5waG9uZU51bWJlciB8fCBudWxsO1xuICAgIHRoaXMucGhvdG9VUkwgPSBvcHQucGhvdG9VUkwgfHwgbnVsbDtcbiAgICB0aGlzLmlzQW5vbnltb3VzID0gb3B0LmlzQW5vbnltb3VzIHx8IGZhbHNlO1xuICAgIHRoaXMudGVuYW50SWQgPSBvcHQudGVuYW50SWQgfHwgbnVsbDtcbiAgICB0aGlzLnByb3ZpZGVyRGF0YSA9IG9wdC5wcm92aWRlckRhdGEgPyBbLi4ub3B0LnByb3ZpZGVyRGF0YV0gOiBbXTtcbiAgICB0aGlzLm1ldGFkYXRhID0gbmV3IFVzZXJNZXRhZGF0YShcbiAgICAgIG9wdC5jcmVhdGVkQXQgfHwgdW5kZWZpbmVkLFxuICAgICAgb3B0Lmxhc3RMb2dpbkF0IHx8IHVuZGVmaW5lZFxuICAgICk7XG4gIH1cblxuICBhc3luYyBnZXRJZFRva2VuKGZvcmNlUmVmcmVzaD86IGJvb2xlYW4pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQoXG4gICAgICB0aGlzLFxuICAgICAgdGhpcy5zdHNUb2tlbk1hbmFnZXIuZ2V0VG9rZW4odGhpcy5hdXRoLCBmb3JjZVJlZnJlc2gpXG4gICAgKTtcbiAgICBfYXNzZXJ0KGFjY2Vzc1Rva2VuLCB0aGlzLmF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuXG4gICAgaWYgKHRoaXMuYWNjZXNzVG9rZW4gIT09IGFjY2Vzc1Rva2VuKSB7XG4gICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgICBhd2FpdCB0aGlzLmF1dGguX3BlcnNpc3RVc2VySWZDdXJyZW50KHRoaXMpO1xuICAgICAgdGhpcy5hdXRoLl9ub3RpZnlMaXN0ZW5lcnNJZkN1cnJlbnQodGhpcyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFjY2Vzc1Rva2VuO1xuICB9XG5cbiAgZ2V0SWRUb2tlblJlc3VsdChmb3JjZVJlZnJlc2g/OiBib29sZWFuKTogUHJvbWlzZTxJZFRva2VuUmVzdWx0PiB7XG4gICAgcmV0dXJuIGdldElkVG9rZW5SZXN1bHQodGhpcywgZm9yY2VSZWZyZXNoKTtcbiAgfVxuXG4gIHJlbG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gcmVsb2FkKHRoaXMpO1xuICB9XG5cbiAgcHJpdmF0ZSByZWxvYWRVc2VySW5mbzogQVBJVXNlckluZm8gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZWxvYWRMaXN0ZW5lcjogTmV4dEZuPEFQSVVzZXJJbmZvPiB8IG51bGwgPSBudWxsO1xuXG4gIF9hc3NpZ24odXNlcjogVXNlckludGVybmFsKTogdm9pZCB7XG4gICAgaWYgKHRoaXMgPT09IHVzZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgX2Fzc2VydCh0aGlzLnVpZCA9PT0gdXNlci51aWQsIHRoaXMuYXV0aCwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gICAgdGhpcy5kaXNwbGF5TmFtZSA9IHVzZXIuZGlzcGxheU5hbWU7XG4gICAgdGhpcy5waG90b1VSTCA9IHVzZXIucGhvdG9VUkw7XG4gICAgdGhpcy5lbWFpbCA9IHVzZXIuZW1haWw7XG4gICAgdGhpcy5lbWFpbFZlcmlmaWVkID0gdXNlci5lbWFpbFZlcmlmaWVkO1xuICAgIHRoaXMucGhvbmVOdW1iZXIgPSB1c2VyLnBob25lTnVtYmVyO1xuICAgIHRoaXMuaXNBbm9ueW1vdXMgPSB1c2VyLmlzQW5vbnltb3VzO1xuICAgIHRoaXMudGVuYW50SWQgPSB1c2VyLnRlbmFudElkO1xuICAgIHRoaXMucHJvdmlkZXJEYXRhID0gdXNlci5wcm92aWRlckRhdGEubWFwKHVzZXJJbmZvID0+ICh7IC4uLnVzZXJJbmZvIH0pKTtcbiAgICB0aGlzLm1ldGFkYXRhLl9jb3B5KHVzZXIubWV0YWRhdGEpO1xuICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLl9hc3NpZ24odXNlci5zdHNUb2tlbk1hbmFnZXIpO1xuICB9XG5cbiAgX2Nsb25lKGF1dGg6IEF1dGhJbnRlcm5hbCk6IFVzZXJJbnRlcm5hbCB7XG4gICAgY29uc3QgbmV3VXNlciA9IG5ldyBVc2VySW1wbCh7XG4gICAgICAuLi50aGlzLFxuICAgICAgYXV0aCxcbiAgICAgIHN0c1Rva2VuTWFuYWdlcjogdGhpcy5zdHNUb2tlbk1hbmFnZXIuX2Nsb25lKClcbiAgICB9KTtcbiAgICBuZXdVc2VyLm1ldGFkYXRhLl9jb3B5KHRoaXMubWV0YWRhdGEpO1xuICAgIHJldHVybiBuZXdVc2VyO1xuICB9XG5cbiAgX29uUmVsb2FkKGNhbGxiYWNrOiBOZXh0Rm48QVBJVXNlckluZm8+KTogdm9pZCB7XG4gICAgLy8gVGhlcmUgc2hvdWxkIG9ubHkgZXZlciBiZSBvbmUgbGlzdGVuZXIsIGFuZCB0aGF0IGlzIGEgc2luZ2xlIGluc3RhbmNlIG9mIE11bHRpRmFjdG9yVXNlclxuICAgIF9hc3NlcnQoIXRoaXMucmVsb2FkTGlzdGVuZXIsIHRoaXMuYXV0aCwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gICAgdGhpcy5yZWxvYWRMaXN0ZW5lciA9IGNhbGxiYWNrO1xuICAgIGlmICh0aGlzLnJlbG9hZFVzZXJJbmZvKSB7XG4gICAgICB0aGlzLl9ub3RpZnlSZWxvYWRMaXN0ZW5lcih0aGlzLnJlbG9hZFVzZXJJbmZvKTtcbiAgICAgIHRoaXMucmVsb2FkVXNlckluZm8gPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIF9ub3RpZnlSZWxvYWRMaXN0ZW5lcih1c2VySW5mbzogQVBJVXNlckluZm8pOiB2b2lkIHtcbiAgICBpZiAodGhpcy5yZWxvYWRMaXN0ZW5lcikge1xuICAgICAgdGhpcy5yZWxvYWRMaXN0ZW5lcih1c2VySW5mbyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIElmIG5vIGxpc3RlbmVyIGlzIHN1YnNjcmliZWQgeWV0LCBzYXZlIHRoZSByZXN1bHQgc28gaXQncyBhdmFpbGFibGUgd2hlbiB0aGV5IGRvIHN1YnNjcmliZVxuICAgICAgdGhpcy5yZWxvYWRVc2VySW5mbyA9IHVzZXJJbmZvO1xuICAgIH1cbiAgfVxuXG4gIF9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTogdm9pZCB7XG4gICAgdGhpcy5wcm9hY3RpdmVSZWZyZXNoLl9zdGFydCgpO1xuICB9XG5cbiAgX3N0b3BQcm9hY3RpdmVSZWZyZXNoKCk6IHZvaWQge1xuICAgIHRoaXMucHJvYWN0aXZlUmVmcmVzaC5fc3RvcCgpO1xuICB9XG5cbiAgYXN5bmMgX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KFxuICAgIHJlc3BvbnNlOiBJZFRva2VuUmVzcG9uc2UgfCBGaW5hbGl6ZU1mYVJlc3BvbnNlLFxuICAgIHJlbG9hZCA9IGZhbHNlXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGxldCB0b2tlbnNSZWZyZXNoZWQgPSBmYWxzZTtcbiAgICBpZiAoXG4gICAgICByZXNwb25zZS5pZFRva2VuICYmXG4gICAgICByZXNwb25zZS5pZFRva2VuICE9PSB0aGlzLnN0c1Rva2VuTWFuYWdlci5hY2Nlc3NUb2tlblxuICAgICkge1xuICAgICAgdGhpcy5zdHNUb2tlbk1hbmFnZXIudXBkYXRlRnJvbVNlcnZlclJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICAgIHRva2Vuc1JlZnJlc2hlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKHJlbG9hZCkge1xuICAgICAgYXdhaXQgX3JlbG9hZFdpdGhvdXRTYXZpbmcodGhpcyk7XG4gICAgfVxuXG4gICAgYXdhaXQgdGhpcy5hdXRoLl9wZXJzaXN0VXNlcklmQ3VycmVudCh0aGlzKTtcbiAgICBpZiAodG9rZW5zUmVmcmVzaGVkKSB7XG4gICAgICB0aGlzLmF1dGguX25vdGlmeUxpc3RlbmVyc0lmQ3VycmVudCh0aGlzKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBkZWxldGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHRoaXMuZ2V0SWRUb2tlbigpO1xuICAgIGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKHRoaXMsIGRlbGV0ZUFjY291bnQodGhpcy5hdXRoLCB7IGlkVG9rZW4gfSkpO1xuICAgIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLmNsZWFyUmVmcmVzaFRva2VuKCk7XG5cbiAgICAvLyBUT0RPOiBEZXRlcm1pbmUgaWYgY2FuY2VsbGFibGUtcHJvbWlzZXMgYXJlIG5lY2Vzc2FyeSB0byB1c2UgaW4gdGhpcyBjbGFzcyBzbyB0aGF0IGRlbGV0ZSgpXG4gICAgLy8gICAgICAgY2FuY2VscyBwZW5kaW5nIGFjdGlvbnMuLi5cblxuICAgIHJldHVybiB0aGlzLmF1dGguc2lnbk91dCgpO1xuICB9XG5cbiAgdG9KU09OKCk6IFBlcnNpc3RlZEJsb2Ige1xuICAgIHJldHVybiB7XG4gICAgICB1aWQ6IHRoaXMudWlkLFxuICAgICAgZW1haWw6IHRoaXMuZW1haWwgfHwgdW5kZWZpbmVkLFxuICAgICAgZW1haWxWZXJpZmllZDogdGhpcy5lbWFpbFZlcmlmaWVkLFxuICAgICAgZGlzcGxheU5hbWU6IHRoaXMuZGlzcGxheU5hbWUgfHwgdW5kZWZpbmVkLFxuICAgICAgaXNBbm9ueW1vdXM6IHRoaXMuaXNBbm9ueW1vdXMsXG4gICAgICBwaG90b1VSTDogdGhpcy5waG90b1VSTCB8fCB1bmRlZmluZWQsXG4gICAgICBwaG9uZU51bWJlcjogdGhpcy5waG9uZU51bWJlciB8fCB1bmRlZmluZWQsXG4gICAgICB0ZW5hbnRJZDogdGhpcy50ZW5hbnRJZCB8fCB1bmRlZmluZWQsXG4gICAgICBwcm92aWRlckRhdGE6IHRoaXMucHJvdmlkZXJEYXRhLm1hcCh1c2VySW5mbyA9PiAoeyAuLi51c2VySW5mbyB9KSksXG4gICAgICBzdHNUb2tlbk1hbmFnZXI6IHRoaXMuc3RzVG9rZW5NYW5hZ2VyLnRvSlNPTigpLFxuICAgICAgLy8gUmVkaXJlY3QgZXZlbnQgSUQgbXVzdCBiZSBtYWludGFpbmVkIGluIGNhc2UgdGhlcmUgaXMgYSBwZW5kaW5nXG4gICAgICAvLyByZWRpcmVjdCBldmVudC5cbiAgICAgIF9yZWRpcmVjdEV2ZW50SWQ6IHRoaXMuX3JlZGlyZWN0RXZlbnRJZCxcbiAgICAgIC4uLnRoaXMubWV0YWRhdGEudG9KU09OKCksXG5cbiAgICAgIC8vIFJlcXVpcmVkIGZvciBjb21wYXRpYmlsaXR5IHdpdGggdGhlIGxlZ2FjeSBTREsgKGdvL2ZpcmViYXNlLWF1dGgtc2RrLXBlcnNpc3RlbmNlLXBhcnNpbmcpOlxuICAgICAgYXBpS2V5OiB0aGlzLmF1dGguY29uZmlnLmFwaUtleSxcbiAgICAgIGFwcE5hbWU6IHRoaXMuYXV0aC5uYW1lXG4gICAgICAvLyBNaXNzaW5nIGF1dGhEb21haW4gd2lsbCBiZSB0b2xlcmF0ZWQgYnkgdGhlIGxlZ2FjeSBTREsuXG4gICAgICAvLyBzdHNUb2tlbk1hbmFnZXIuYXBpS2V5IGlzbid0IGFjdHVhbGx5IHJlcXVpcmVkIChkZXNwaXRlIHRoZSBsZWdhY3kgU0RLIHBlcnNpc3RpbmcgaXQpLlxuICAgIH07XG4gIH1cblxuICBnZXQgcmVmcmVzaFRva2VuKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuc3RzVG9rZW5NYW5hZ2VyLnJlZnJlc2hUb2tlbiB8fCAnJztcbiAgfVxuXG4gIHN0YXRpYyBfZnJvbUpTT04oYXV0aDogQXV0aEludGVybmFsLCBvYmplY3Q6IFBlcnNpc3RlZEJsb2IpOiBVc2VySW50ZXJuYWwge1xuICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gb2JqZWN0LmRpc3BsYXlOYW1lID8/IHVuZGVmaW5lZDtcbiAgICBjb25zdCBlbWFpbCA9IG9iamVjdC5lbWFpbCA/PyB1bmRlZmluZWQ7XG4gICAgY29uc3QgcGhvbmVOdW1iZXIgPSBvYmplY3QucGhvbmVOdW1iZXIgPz8gdW5kZWZpbmVkO1xuICAgIGNvbnN0IHBob3RvVVJMID0gb2JqZWN0LnBob3RvVVJMID8/IHVuZGVmaW5lZDtcbiAgICBjb25zdCB0ZW5hbnRJZCA9IG9iamVjdC50ZW5hbnRJZCA/PyB1bmRlZmluZWQ7XG4gICAgY29uc3QgX3JlZGlyZWN0RXZlbnRJZCA9IG9iamVjdC5fcmVkaXJlY3RFdmVudElkID8/IHVuZGVmaW5lZDtcbiAgICBjb25zdCBjcmVhdGVkQXQgPSBvYmplY3QuY3JlYXRlZEF0ID8/IHVuZGVmaW5lZDtcbiAgICBjb25zdCBsYXN0TG9naW5BdCA9IG9iamVjdC5sYXN0TG9naW5BdCA/PyB1bmRlZmluZWQ7XG4gICAgY29uc3Qge1xuICAgICAgdWlkLFxuICAgICAgZW1haWxWZXJpZmllZCxcbiAgICAgIGlzQW5vbnltb3VzLFxuICAgICAgcHJvdmlkZXJEYXRhLFxuICAgICAgc3RzVG9rZW5NYW5hZ2VyOiBwbGFpbk9iamVjdFRva2VuTWFuYWdlclxuICAgIH0gPSBvYmplY3Q7XG5cbiAgICBfYXNzZXJ0KHVpZCAmJiBwbGFpbk9iamVjdFRva2VuTWFuYWdlciwgYXV0aCwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG5cbiAgICBjb25zdCBzdHNUb2tlbk1hbmFnZXIgPSBTdHNUb2tlbk1hbmFnZXIuZnJvbUpTT04oXG4gICAgICB0aGlzLm5hbWUsXG4gICAgICBwbGFpbk9iamVjdFRva2VuTWFuYWdlciBhcyBQZXJzaXN0ZWRCbG9iXG4gICAgKTtcblxuICAgIF9hc3NlcnQodHlwZW9mIHVpZCA9PT0gJ3N0cmluZycsIGF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGRpc3BsYXlOYW1lLCBhdXRoLm5hbWUpO1xuICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGVtYWlsLCBhdXRoLm5hbWUpO1xuICAgIF9hc3NlcnQoXG4gICAgICB0eXBlb2YgZW1haWxWZXJpZmllZCA9PT0gJ2Jvb2xlYW4nLFxuICAgICAgYXV0aCxcbiAgICAgIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1JcbiAgICApO1xuICAgIF9hc3NlcnQoXG4gICAgICB0eXBlb2YgaXNBbm9ueW1vdXMgPT09ICdib29sZWFuJyxcbiAgICAgIGF1dGgsXG4gICAgICBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SXG4gICAgKTtcbiAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChwaG9uZU51bWJlciwgYXV0aC5uYW1lKTtcbiAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChwaG90b1VSTCwgYXV0aC5uYW1lKTtcbiAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZCh0ZW5hbnRJZCwgYXV0aC5uYW1lKTtcbiAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChfcmVkaXJlY3RFdmVudElkLCBhdXRoLm5hbWUpO1xuICAgIGFzc2VydFN0cmluZ09yVW5kZWZpbmVkKGNyZWF0ZWRBdCwgYXV0aC5uYW1lKTtcbiAgICBhc3NlcnRTdHJpbmdPclVuZGVmaW5lZChsYXN0TG9naW5BdCwgYXV0aC5uYW1lKTtcbiAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJJbXBsKHtcbiAgICAgIHVpZCxcbiAgICAgIGF1dGgsXG4gICAgICBlbWFpbCxcbiAgICAgIGVtYWlsVmVyaWZpZWQsXG4gICAgICBkaXNwbGF5TmFtZSxcbiAgICAgIGlzQW5vbnltb3VzLFxuICAgICAgcGhvdG9VUkwsXG4gICAgICBwaG9uZU51bWJlcixcbiAgICAgIHRlbmFudElkLFxuICAgICAgc3RzVG9rZW5NYW5hZ2VyLFxuICAgICAgY3JlYXRlZEF0LFxuICAgICAgbGFzdExvZ2luQXRcbiAgICB9KTtcblxuICAgIGlmIChwcm92aWRlckRhdGEgJiYgQXJyYXkuaXNBcnJheShwcm92aWRlckRhdGEpKSB7XG4gICAgICB1c2VyLnByb3ZpZGVyRGF0YSA9IHByb3ZpZGVyRGF0YS5tYXAodXNlckluZm8gPT4gKHsgLi4udXNlckluZm8gfSkpO1xuICAgIH1cblxuICAgIGlmIChfcmVkaXJlY3RFdmVudElkKSB7XG4gICAgICB1c2VyLl9yZWRpcmVjdEV2ZW50SWQgPSBfcmVkaXJlY3RFdmVudElkO1xuICAgIH1cblxuICAgIHJldHVybiB1c2VyO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYSBVc2VyIGZyb20gYW4gaWRUb2tlbiBzZXJ2ZXIgcmVzcG9uc2VcbiAgICogQHBhcmFtIGF1dGhcbiAgICogQHBhcmFtIGlkVG9rZW5SZXNwb25zZVxuICAgKi9cbiAgc3RhdGljIGFzeW5jIF9mcm9tSWRUb2tlblJlc3BvbnNlKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBpZFRva2VuUmVzcG9uc2U6IElkVG9rZW5SZXNwb25zZSxcbiAgICBpc0Fub255bW91czogYm9vbGVhbiA9IGZhbHNlXG4gICk6IFByb21pc2U8VXNlckludGVybmFsPiB7XG4gICAgY29uc3Qgc3RzVG9rZW5NYW5hZ2VyID0gbmV3IFN0c1Rva2VuTWFuYWdlcigpO1xuICAgIHN0c1Rva2VuTWFuYWdlci51cGRhdGVGcm9tU2VydmVyUmVzcG9uc2UoaWRUb2tlblJlc3BvbnNlKTtcblxuICAgIC8vIEluaXRpYWxpemUgdGhlIEZpcmViYXNlIEF1dGggdXNlci5cbiAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJJbXBsKHtcbiAgICAgIHVpZDogaWRUb2tlblJlc3BvbnNlLmxvY2FsSWQsXG4gICAgICBhdXRoLFxuICAgICAgc3RzVG9rZW5NYW5hZ2VyLFxuICAgICAgaXNBbm9ueW1vdXNcbiAgICB9KTtcblxuICAgIC8vIFVwZGF0ZXMgdGhlIHVzZXIgaW5mbyBhbmQgZGF0YSBhbmQgcmVzb2x2ZXMgd2l0aCBhIHVzZXIgaW5zdGFuY2UuXG4gICAgYXdhaXQgX3JlbG9hZFdpdGhvdXRTYXZpbmcodXNlcik7XG4gICAgcmV0dXJuIHVzZXI7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBkZWJ1Z0Fzc2VydCB9IGZyb20gJy4vYXNzZXJ0JztcblxuLyoqXG4gKiBPdXIgQVBJIGhhcyBhIGxvdCBvZiBvbmUtb2ZmIGNvbnN0YW50cyB0aGF0IGFyZSB1c2VkIHRvIGRvIHRoaW5ncy5cbiAqIFVuZm9ydHVuYXRlbHkgd2UgY2FuJ3QgZXhwb3J0IHRoZXNlIGFzIGNsYXNzZXMgaW5zdGFudGlhdGVkIGRpcmVjdGx5IHNpbmNlXG4gKiB0aGUgY29uc3RydWN0b3IgbWF5IHNpZGUgZWZmZWN0IGFuZCB0aGVyZWZvcmUgY2FuJ3QgYmUgcHJvdmVuIHRvIGJlIHNhZmVseVxuICogY3VsbGVkLiBJbnN0ZWFkLCB3ZSBleHBvcnQgdGhlc2UgY2xhc3NlcyB0aGVtc2VsdmVzIGFzIGEgbG93ZXJDYW1lbENhc2VcbiAqIGNvbnN0YW50LCBhbmQgaW5zdGFudGlhdGUgdGhlbSB1bmRlciB0aGUgaG9vZC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTaW5nbGV0b25JbnN0YW50aWF0b3I8VD4ge1xuICBuZXcgKCk6IFQ7XG59XG5cbmNvbnN0IGluc3RhbmNlQ2FjaGU6IE1hcDx1bmtub3duLCB1bmtub3duPiA9IG5ldyBNYXAoKTtcblxuZXhwb3J0IGZ1bmN0aW9uIF9nZXRJbnN0YW5jZTxUPihjbHM6IHVua25vd24pOiBUIHtcbiAgZGVidWdBc3NlcnQoY2xzIGluc3RhbmNlb2YgRnVuY3Rpb24sICdFeHBlY3RlZCBhIGNsYXNzIGRlZmluaXRpb24nKTtcbiAgbGV0IGluc3RhbmNlID0gaW5zdGFuY2VDYWNoZS5nZXQoY2xzKSBhcyBUIHwgdW5kZWZpbmVkO1xuXG4gIGlmIChpbnN0YW5jZSkge1xuICAgIGRlYnVnQXNzZXJ0KFxuICAgICAgaW5zdGFuY2UgaW5zdGFuY2VvZiBjbHMsXG4gICAgICAnSW5zdGFuY2Ugc3RvcmVkIGluIGNhY2hlIG1pc21hdGNoZWQgd2l0aCBjbGFzcydcbiAgICApO1xuICAgIHJldHVybiBpbnN0YW5jZTtcbiAgfVxuXG4gIGluc3RhbmNlID0gbmV3IChjbHMgYXMgU2luZ2xldG9uSW5zdGFudGlhdG9yPFQ+KSgpO1xuICBpbnN0YW5jZUNhY2hlLnNldChjbHMsIGluc3RhbmNlKTtcbiAgcmV0dXJuIGluc3RhbmNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2NsZWFySW5zdGFuY2VNYXAoKTogdm9pZCB7XG4gIGluc3RhbmNlQ2FjaGUuY2xlYXIoKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBQZXJzaXN0ZW5jZSB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCB7XG4gIFBlcnNpc3RlbmNlSW50ZXJuYWwsXG4gIFBlcnNpc3RlbmNlVHlwZSxcbiAgUGVyc2lzdGVuY2VWYWx1ZSxcbiAgU3RvcmFnZUV2ZW50TGlzdGVuZXJcbn0gZnJvbSAnLi4vcGVyc2lzdGVuY2UnO1xuXG5leHBvcnQgY2xhc3MgSW5NZW1vcnlQZXJzaXN0ZW5jZSBpbXBsZW1lbnRzIFBlcnNpc3RlbmNlSW50ZXJuYWwge1xuICBzdGF0aWMgdHlwZTogJ05PTkUnID0gJ05PTkUnO1xuICByZWFkb25seSB0eXBlID0gUGVyc2lzdGVuY2VUeXBlLk5PTkU7XG4gIHN0b3JhZ2U6IFJlY29yZDxzdHJpbmcsIFBlcnNpc3RlbmNlVmFsdWU+ID0ge307XG5cbiAgYXN5bmMgX2lzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgYXN5bmMgX3NldChrZXk6IHN0cmluZywgdmFsdWU6IFBlcnNpc3RlbmNlVmFsdWUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLnN0b3JhZ2Vba2V5XSA9IHZhbHVlO1xuICB9XG5cbiAgYXN5bmMgX2dldDxUIGV4dGVuZHMgUGVyc2lzdGVuY2VWYWx1ZT4oa2V5OiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XG4gICAgY29uc3QgdmFsdWUgPSB0aGlzLnN0b3JhZ2Vba2V5XTtcbiAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwgOiAodmFsdWUgYXMgVCk7XG4gIH1cblxuICBhc3luYyBfcmVtb3ZlKGtleTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgZGVsZXRlIHRoaXMuc3RvcmFnZVtrZXldO1xuICB9XG5cbiAgX2FkZExpc3RlbmVyKF9rZXk6IHN0cmluZywgX2xpc3RlbmVyOiBTdG9yYWdlRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuICAgIC8vIExpc3RlbmVycyBhcmUgbm90IHN1cHBvcnRlZCBmb3IgaW4tbWVtb3J5IHN0b3JhZ2Ugc2luY2UgaXQgY2Fubm90IGJlIHNoYXJlZCBhY3Jvc3Mgd2luZG93cy93b3JrZXJzXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgX3JlbW92ZUxpc3RlbmVyKF9rZXk6IHN0cmluZywgX2xpc3RlbmVyOiBTdG9yYWdlRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuICAgIC8vIExpc3RlbmVycyBhcmUgbm90IHN1cHBvcnRlZCBmb3IgaW4tbWVtb3J5IHN0b3JhZ2Ugc2luY2UgaXQgY2Fubm90IGJlIHNoYXJlZCBhY3Jvc3Mgd2luZG93cy93b3JrZXJzXG4gICAgcmV0dXJuO1xuICB9XG59XG5cbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBlcnNpc3RlbmNlfSBvZiB0eXBlICdOT05FJy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjb25zdCBpbk1lbW9yeVBlcnNpc3RlbmNlOiBQZXJzaXN0ZW5jZSA9IEluTWVtb3J5UGVyc2lzdGVuY2U7XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQXBpS2V5LCBBcHBOYW1lLCBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7IFVzZXJJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgUGVyc2lzdGVkQmxvYiwgUGVyc2lzdGVuY2VJbnRlcm5hbCB9IGZyb20gJy4uL3BlcnNpc3RlbmNlJztcbmltcG9ydCB7IFVzZXJJbXBsIH0gZnJvbSAnLi4vdXNlci91c2VyX2ltcGwnO1xuaW1wb3J0IHsgX2dldEluc3RhbmNlIH0gZnJvbSAnLi4vdXRpbC9pbnN0YW50aWF0b3InO1xuaW1wb3J0IHsgaW5NZW1vcnlQZXJzaXN0ZW5jZSB9IGZyb20gJy4vaW5fbWVtb3J5JztcblxuZXhwb3J0IGNvbnN0IGVudW0gS2V5TmFtZSB7XG4gIEFVVEhfVVNFUiA9ICdhdXRoVXNlcicsXG4gIEFVVEhfRVZFTlQgPSAnYXV0aEV2ZW50JyxcbiAgUkVESVJFQ1RfVVNFUiA9ICdyZWRpcmVjdFVzZXInLFxuICBQRVJTSVNURU5DRV9VU0VSID0gJ3BlcnNpc3RlbmNlJ1xufVxuZXhwb3J0IGNvbnN0IGVudW0gTmFtZXNwYWNlIHtcbiAgUEVSU0lTVEVOQ0UgPSAnZmlyZWJhc2UnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfcGVyc2lzdGVuY2VLZXlOYW1lKFxuICBrZXk6IHN0cmluZyxcbiAgYXBpS2V5OiBBcGlLZXksXG4gIGFwcE5hbWU6IEFwcE5hbWVcbik6IHN0cmluZyB7XG4gIHJldHVybiBgJHtOYW1lc3BhY2UuUEVSU0lTVEVOQ0V9OiR7a2V5fToke2FwaUtleX06JHthcHBOYW1lfWA7XG59XG5cbmV4cG9ydCBjbGFzcyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyIHtcbiAgcHJpdmF0ZSByZWFkb25seSBmdWxsVXNlcktleTogc3RyaW5nO1xuICBwcml2YXRlIHJlYWRvbmx5IGZ1bGxQZXJzaXN0ZW5jZUtleTogc3RyaW5nO1xuICBwcml2YXRlIHJlYWRvbmx5IGJvdW5kRXZlbnRIYW5kbGVyOiAoKSA9PiB2b2lkO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHBlcnNpc3RlbmNlOiBQZXJzaXN0ZW5jZUludGVybmFsLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgYXV0aDogQXV0aEludGVybmFsLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgdXNlcktleTogc3RyaW5nXG4gICkge1xuICAgIGNvbnN0IHsgY29uZmlnLCBuYW1lIH0gPSB0aGlzLmF1dGg7XG4gICAgdGhpcy5mdWxsVXNlcktleSA9IF9wZXJzaXN0ZW5jZUtleU5hbWUodGhpcy51c2VyS2V5LCBjb25maWcuYXBpS2V5LCBuYW1lKTtcbiAgICB0aGlzLmZ1bGxQZXJzaXN0ZW5jZUtleSA9IF9wZXJzaXN0ZW5jZUtleU5hbWUoXG4gICAgICBLZXlOYW1lLlBFUlNJU1RFTkNFX1VTRVIsXG4gICAgICBjb25maWcuYXBpS2V5LFxuICAgICAgbmFtZVxuICAgICk7XG4gICAgdGhpcy5ib3VuZEV2ZW50SGFuZGxlciA9IGF1dGguX29uU3RvcmFnZUV2ZW50LmJpbmQoYXV0aCk7XG4gICAgdGhpcy5wZXJzaXN0ZW5jZS5fYWRkTGlzdGVuZXIodGhpcy5mdWxsVXNlcktleSwgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XG4gIH1cblxuICBzZXRDdXJyZW50VXNlcih1c2VyOiBVc2VySW50ZXJuYWwpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5fc2V0KHRoaXMuZnVsbFVzZXJLZXksIHVzZXIudG9KU09OKCkpO1xuICB9XG5cbiAgYXN5bmMgZ2V0Q3VycmVudFVzZXIoKTogUHJvbWlzZTxVc2VySW50ZXJuYWwgfCBudWxsPiB7XG4gICAgY29uc3QgYmxvYiA9IGF3YWl0IHRoaXMucGVyc2lzdGVuY2UuX2dldDxQZXJzaXN0ZWRCbG9iPih0aGlzLmZ1bGxVc2VyS2V5KTtcbiAgICByZXR1cm4gYmxvYiA/IFVzZXJJbXBsLl9mcm9tSlNPTih0aGlzLmF1dGgsIGJsb2IpIDogbnVsbDtcbiAgfVxuXG4gIHJlbW92ZUN1cnJlbnRVc2VyKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLl9yZW1vdmUodGhpcy5mdWxsVXNlcktleSk7XG4gIH1cblxuICBzYXZlUGVyc2lzdGVuY2VGb3JSZWRpcmVjdCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5wZXJzaXN0ZW5jZS5fc2V0KFxuICAgICAgdGhpcy5mdWxsUGVyc2lzdGVuY2VLZXksXG4gICAgICB0aGlzLnBlcnNpc3RlbmNlLnR5cGVcbiAgICApO1xuICB9XG5cbiAgYXN5bmMgc2V0UGVyc2lzdGVuY2UobmV3UGVyc2lzdGVuY2U6IFBlcnNpc3RlbmNlSW50ZXJuYWwpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5wZXJzaXN0ZW5jZSA9PT0gbmV3UGVyc2lzdGVuY2UpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBjdXJyZW50VXNlciA9IGF3YWl0IHRoaXMuZ2V0Q3VycmVudFVzZXIoKTtcbiAgICBhd2FpdCB0aGlzLnJlbW92ZUN1cnJlbnRVc2VyKCk7XG5cbiAgICB0aGlzLnBlcnNpc3RlbmNlID0gbmV3UGVyc2lzdGVuY2U7XG5cbiAgICBpZiAoY3VycmVudFVzZXIpIHtcbiAgICAgIHJldHVybiB0aGlzLnNldEN1cnJlbnRVc2VyKGN1cnJlbnRVc2VyKTtcbiAgICB9XG4gIH1cblxuICBkZWxldGUoKTogdm9pZCB7XG4gICAgdGhpcy5wZXJzaXN0ZW5jZS5fcmVtb3ZlTGlzdGVuZXIodGhpcy5mdWxsVXNlcktleSwgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XG4gIH1cblxuICBzdGF0aWMgYXN5bmMgY3JlYXRlKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBwZXJzaXN0ZW5jZUhpZXJhcmNoeTogUGVyc2lzdGVuY2VJbnRlcm5hbFtdLFxuICAgIHVzZXJLZXkgPSBLZXlOYW1lLkFVVEhfVVNFUlxuICApOiBQcm9taXNlPFBlcnNpc3RlbmNlVXNlck1hbmFnZXI+IHtcbiAgICBpZiAoIXBlcnNpc3RlbmNlSGllcmFyY2h5Lmxlbmd0aCkge1xuICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyKFxuICAgICAgICBfZ2V0SW5zdGFuY2UoaW5NZW1vcnlQZXJzaXN0ZW5jZSksXG4gICAgICAgIGF1dGgsXG4gICAgICAgIHVzZXJLZXlcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gRWxpbWluYXRlIGFueSBwZXJzaXN0ZW5jZXMgdGhhdCBhcmUgbm90IGF2YWlsYWJsZVxuICAgIGNvbnN0IGF2YWlsYWJsZVBlcnNpc3RlbmNlcyA9IChcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKFxuICAgICAgICBwZXJzaXN0ZW5jZUhpZXJhcmNoeS5tYXAoYXN5bmMgcGVyc2lzdGVuY2UgPT4ge1xuICAgICAgICAgIGlmIChhd2FpdCBwZXJzaXN0ZW5jZS5faXNBdmFpbGFibGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHBlcnNpc3RlbmNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9KVxuICAgICAgKVxuICAgICkuZmlsdGVyKHBlcnNpc3RlbmNlID0+IHBlcnNpc3RlbmNlKSBhcyBQZXJzaXN0ZW5jZUludGVybmFsW107XG5cbiAgICAvLyBGYWxsIGJhY2sgdG8gdGhlIGZpcnN0IHBlcnNpc3RlbmNlIGxpc3RlZCwgb3IgaW4gbWVtb3J5IGlmIG5vbmUgYXZhaWxhYmxlXG4gICAgbGV0IHNlbGVjdGVkUGVyc2lzdGVuY2UgPVxuICAgICAgYXZhaWxhYmxlUGVyc2lzdGVuY2VzWzBdIHx8XG4gICAgICBfZ2V0SW5zdGFuY2U8UGVyc2lzdGVuY2VJbnRlcm5hbD4oaW5NZW1vcnlQZXJzaXN0ZW5jZSk7XG5cbiAgICBjb25zdCBrZXkgPSBfcGVyc2lzdGVuY2VLZXlOYW1lKHVzZXJLZXksIGF1dGguY29uZmlnLmFwaUtleSwgYXV0aC5uYW1lKTtcblxuICAgIC8vIFB1bGwgb3V0IHRoZSBleGlzdGluZyB1c2VyLCBzZXR0aW5nIHRoZSBjaG9zZW4gcGVyc2lzdGVuY2UgdG8gdGhhdFxuICAgIC8vIHBlcnNpc3RlbmNlIGlmIHRoZSB1c2VyIGV4aXN0cy5cbiAgICBsZXQgdXNlclRvTWlncmF0ZTogVXNlckludGVybmFsIHwgbnVsbCA9IG51bGw7XG4gICAgLy8gTm90ZSwgaGVyZSB3ZSBjaGVjayBmb3IgYSB1c2VyIGluIF9hbGxfIHBlcnNpc3RlbmNlcywgbm90IGp1c3QgdGhlXG4gICAgLy8gb25lcyBkZWVtZWQgYXZhaWxhYmxlLiBJZiB3ZSBjYW4gbWlncmF0ZSBhIHVzZXIgb3V0IG9mIGEgYnJva2VuXG4gICAgLy8gcGVyc2lzdGVuY2UsIHdlIHdpbGwgKGJ1dCBvbmx5IGlmIHRoYXQgcGVyc2lzdGVuY2Ugc3VwcG9ydHMgbWlncmF0aW9uKS5cbiAgICBmb3IgKGNvbnN0IHBlcnNpc3RlbmNlIG9mIHBlcnNpc3RlbmNlSGllcmFyY2h5KSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgcGVyc2lzdGVuY2UuX2dldDxQZXJzaXN0ZWRCbG9iPihrZXkpO1xuICAgICAgICBpZiAoYmxvYikge1xuICAgICAgICAgIGNvbnN0IHVzZXIgPSBVc2VySW1wbC5fZnJvbUpTT04oYXV0aCwgYmxvYik7IC8vIHRocm93cyBmb3IgdW5wYXJzYWJsZSBibG9iICh3cm9uZyBmb3JtYXQpXG4gICAgICAgICAgaWYgKHBlcnNpc3RlbmNlICE9PSBzZWxlY3RlZFBlcnNpc3RlbmNlKSB7XG4gICAgICAgICAgICB1c2VyVG9NaWdyYXRlID0gdXNlcjtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2VsZWN0ZWRQZXJzaXN0ZW5jZSA9IHBlcnNpc3RlbmNlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIHt9XG4gICAgfVxuXG4gICAgLy8gSWYgd2UgZmluZCB0aGUgdXNlciBpbiBhIHBlcnNpc3RlbmNlIHRoYXQgZG9lcyBzdXBwb3J0IG1pZ3JhdGlvbiwgdXNlXG4gICAgLy8gdGhhdCBtaWdyYXRpb24gcGF0aCAob2Ygb25seSBwZXJzaXN0ZW5jZXMgdGhhdCBzdXBwb3J0IG1pZ3JhdGlvbilcbiAgICBjb25zdCBtaWdyYXRpb25IaWVyYXJjaHkgPSBhdmFpbGFibGVQZXJzaXN0ZW5jZXMuZmlsdGVyKFxuICAgICAgcCA9PiBwLl9zaG91bGRBbGxvd01pZ3JhdGlvblxuICAgICk7XG5cbiAgICAvLyBJZiB0aGUgcGVyc2lzdGVuY2UgZG9lcyBfbm90XyBhbGxvdyBtaWdyYXRpb24sIGp1c3QgZmluaXNoIG9mZiBoZXJlXG4gICAgaWYgKFxuICAgICAgIXNlbGVjdGVkUGVyc2lzdGVuY2UuX3Nob3VsZEFsbG93TWlncmF0aW9uIHx8XG4gICAgICAhbWlncmF0aW9uSGllcmFyY2h5Lmxlbmd0aFxuICAgICkge1xuICAgICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyKHNlbGVjdGVkUGVyc2lzdGVuY2UsIGF1dGgsIHVzZXJLZXkpO1xuICAgIH1cblxuICAgIHNlbGVjdGVkUGVyc2lzdGVuY2UgPSBtaWdyYXRpb25IaWVyYXJjaHlbMF07XG4gICAgaWYgKHVzZXJUb01pZ3JhdGUpIHtcbiAgICAgIC8vIFRoaXMgbm9ybWFsbHkgc2hvdWxkbid0IHRocm93IHNpbmNlIGNob3NlblBlcnNpc3RlbmNlLmlzQXZhaWxhYmxlKCkgaXMgdHJ1ZSwgYnV0IGlmIGl0IGRvZXNcbiAgICAgIC8vIHdlJ2xsIGp1c3QgbGV0IGl0IGJ1YmJsZSB0byBzdXJmYWNlIHRoZSBlcnJvci5cbiAgICAgIGF3YWl0IHNlbGVjdGVkUGVyc2lzdGVuY2UuX3NldChrZXksIHVzZXJUb01pZ3JhdGUudG9KU09OKCkpO1xuICAgIH1cblxuICAgIC8vIEF0dGVtcHQgdG8gY2xlYXIgdGhlIGtleSBpbiBvdGhlciBwZXJzaXN0ZW5jZXMgYnV0IGlnbm9yZSBlcnJvcnMuIFRoaXMgaGVscHMgcHJldmVudCBpc3N1ZXNcbiAgICAvLyBzdWNoIGFzIHVzZXJzIGdldHRpbmcgc3R1Y2sgd2l0aCBhIHByZXZpb3VzIGFjY291bnQgYWZ0ZXIgc2lnbmluZyBvdXQgYW5kIHJlZnJlc2hpbmcgdGhlIHRhYi5cbiAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgIHBlcnNpc3RlbmNlSGllcmFyY2h5Lm1hcChhc3luYyBwZXJzaXN0ZW5jZSA9PiB7XG4gICAgICAgIGlmIChwZXJzaXN0ZW5jZSAhPT0gc2VsZWN0ZWRQZXJzaXN0ZW5jZSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBwZXJzaXN0ZW5jZS5fcmVtb3ZlKGtleSk7XG4gICAgICAgICAgfSBjYXRjaCB7fVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG4gICAgcmV0dXJuIG5ldyBQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyKHNlbGVjdGVkUGVyc2lzdGVuY2UsIGF1dGgsIHVzZXJLZXkpO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgaXNJRSwgZ2V0VUEgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbmludGVyZmFjZSBOYXZpZ2F0b3JTdGFuZGFsb25lIGV4dGVuZHMgTmF2aWdhdG9yIHtcbiAgc3RhbmRhbG9uZT86IHVua25vd247XG59XG5cbmludGVyZmFjZSBEb2N1bWVudCB7XG4gIGRvY3VtZW50TW9kZT86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBFbnVtcyBmb3IgQnJvd3NlciBuYW1lLlxuICovXG5leHBvcnQgY29uc3QgZW51bSBCcm93c2VyTmFtZSB7XG4gIEFORFJPSUQgPSAnQW5kcm9pZCcsXG4gIEJMQUNLQkVSUlkgPSAnQmxhY2tiZXJyeScsXG4gIEVER0UgPSAnRWRnZScsXG4gIEZJUkVGT1ggPSAnRmlyZWZveCcsXG4gIElFID0gJ0lFJyxcbiAgSUVNT0JJTEUgPSAnSUVNb2JpbGUnLFxuICBPUEVSQSA9ICdPcGVyYScsXG4gIE9USEVSID0gJ090aGVyJyxcbiAgQ0hST01FID0gJ0Nocm9tZScsXG4gIFNBRkFSSSA9ICdTYWZhcmknLFxuICBTSUxLID0gJ1NpbGsnLFxuICBXRUJPUyA9ICdXZWJvcydcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgdGhlIGJyb3dzZXIgZm9yIHRoZSBwdXJwb3NlcyBvZiByZXBvcnRpbmcgdXNhZ2UgdG8gdGhlIEFQSVxuICovXG5leHBvcnQgZnVuY3Rpb24gX2dldEJyb3dzZXJOYW1lKHVzZXJBZ2VudDogc3RyaW5nKTogQnJvd3Nlck5hbWUgfCBzdHJpbmcge1xuICBjb25zdCB1YSA9IHVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xuICBpZiAodWEuaW5jbHVkZXMoJ29wZXJhLycpIHx8IHVhLmluY2x1ZGVzKCdvcHIvJykgfHwgdWEuaW5jbHVkZXMoJ29waW9zLycpKSB7XG4gICAgcmV0dXJuIEJyb3dzZXJOYW1lLk9QRVJBO1xuICB9IGVsc2UgaWYgKF9pc0lFTW9iaWxlKHVhKSkge1xuICAgIC8vIFdpbmRvd3MgcGhvbmUgSUVNb2JpbGUgYnJvd3Nlci5cbiAgICByZXR1cm4gQnJvd3Nlck5hbWUuSUVNT0JJTEU7XG4gIH0gZWxzZSBpZiAodWEuaW5jbHVkZXMoJ21zaWUnKSB8fCB1YS5pbmNsdWRlcygndHJpZGVudC8nKSkge1xuICAgIHJldHVybiBCcm93c2VyTmFtZS5JRTtcbiAgfSBlbHNlIGlmICh1YS5pbmNsdWRlcygnZWRnZS8nKSkge1xuICAgIHJldHVybiBCcm93c2VyTmFtZS5FREdFO1xuICB9IGVsc2UgaWYgKF9pc0ZpcmVmb3godWEpKSB7XG4gICAgcmV0dXJuIEJyb3dzZXJOYW1lLkZJUkVGT1g7XG4gIH0gZWxzZSBpZiAodWEuaW5jbHVkZXMoJ3NpbGsvJykpIHtcbiAgICByZXR1cm4gQnJvd3Nlck5hbWUuU0lMSztcbiAgfSBlbHNlIGlmIChfaXNCbGFja0JlcnJ5KHVhKSkge1xuICAgIC8vIEJsYWNrYmVycnkgYnJvd3Nlci5cbiAgICByZXR1cm4gQnJvd3Nlck5hbWUuQkxBQ0tCRVJSWTtcbiAgfSBlbHNlIGlmIChfaXNXZWJPUyh1YSkpIHtcbiAgICAvLyBXZWJPUyBkZWZhdWx0IGJyb3dzZXIuXG4gICAgcmV0dXJuIEJyb3dzZXJOYW1lLldFQk9TO1xuICB9IGVsc2UgaWYgKF9pc1NhZmFyaSh1YSkpIHtcbiAgICByZXR1cm4gQnJvd3Nlck5hbWUuU0FGQVJJO1xuICB9IGVsc2UgaWYgKFxuICAgICh1YS5pbmNsdWRlcygnY2hyb21lLycpIHx8IF9pc0Nocm9tZUlPUyh1YSkpICYmXG4gICAgIXVhLmluY2x1ZGVzKCdlZGdlLycpXG4gICkge1xuICAgIHJldHVybiBCcm93c2VyTmFtZS5DSFJPTUU7XG4gIH0gZWxzZSBpZiAoX2lzQW5kcm9pZCh1YSkpIHtcbiAgICAvLyBBbmRyb2lkIHN0b2NrIGJyb3dzZXIuXG4gICAgcmV0dXJuIEJyb3dzZXJOYW1lLkFORFJPSUQ7XG4gIH0gZWxzZSB7XG4gICAgLy8gTW9zdCBtb2Rlcm4gYnJvd3NlcnMgaGF2ZSBuYW1lL3ZlcnNpb24gYXQgZW5kIG9mIHVzZXIgYWdlbnQgc3RyaW5nLlxuICAgIGNvbnN0IHJlID0gLyhbYS16QS1aXFxkXFwuXSspXFwvW2EtekEtWlxcZFxcLl0qJC87XG4gICAgY29uc3QgbWF0Y2hlcyA9IHVzZXJBZ2VudC5tYXRjaChyZSk7XG4gICAgaWYgKG1hdGNoZXM/Lmxlbmd0aCA9PT0gMikge1xuICAgICAgcmV0dXJuIG1hdGNoZXNbMV07XG4gICAgfVxuICB9XG4gIHJldHVybiBCcm93c2VyTmFtZS5PVEhFUjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9pc0ZpcmVmb3godWEgPSBnZXRVQSgpKTogYm9vbGVhbiB7XG4gIHJldHVybiAvZmlyZWZveFxcLy9pLnRlc3QodWEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2lzU2FmYXJpKHVzZXJBZ2VudCA9IGdldFVBKCkpOiBib29sZWFuIHtcbiAgY29uc3QgdWEgPSB1c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIChcbiAgICB1YS5pbmNsdWRlcygnc2FmYXJpLycpICYmXG4gICAgIXVhLmluY2x1ZGVzKCdjaHJvbWUvJykgJiZcbiAgICAhdWEuaW5jbHVkZXMoJ2NyaW9zLycpICYmXG4gICAgIXVhLmluY2x1ZGVzKCdhbmRyb2lkJylcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9pc0Nocm9tZUlPUyh1YSA9IGdldFVBKCkpOiBib29sZWFuIHtcbiAgcmV0dXJuIC9jcmlvc1xcLy9pLnRlc3QodWEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2lzSUVNb2JpbGUodWEgPSBnZXRVQSgpKTogYm9vbGVhbiB7XG4gIHJldHVybiAvaWVtb2JpbGUvaS50ZXN0KHVhKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9pc0FuZHJvaWQodWEgPSBnZXRVQSgpKTogYm9vbGVhbiB7XG4gIHJldHVybiAvYW5kcm9pZC9pLnRlc3QodWEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2lzQmxhY2tCZXJyeSh1YSA9IGdldFVBKCkpOiBib29sZWFuIHtcbiAgcmV0dXJuIC9ibGFja2JlcnJ5L2kudGVzdCh1YSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfaXNXZWJPUyh1YSA9IGdldFVBKCkpOiBib29sZWFuIHtcbiAgcmV0dXJuIC93ZWJvcy9pLnRlc3QodWEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2lzSU9TKHVhID0gZ2V0VUEoKSk6IGJvb2xlYW4ge1xuICByZXR1cm4gKFxuICAgIC9pcGhvbmV8aXBhZHxpcG9kL2kudGVzdCh1YSkgfHxcbiAgICAoL21hY2ludG9zaC9pLnRlc3QodWEpICYmIC9tb2JpbGUvaS50ZXN0KHVhKSlcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9pc0lPUzdPcjgodWEgPSBnZXRVQSgpKTogYm9vbGVhbiB7XG4gIHJldHVybiAoXG4gICAgLyhpUGFkfGlQaG9uZXxpUG9kKS4qT1MgN19cXGQvaS50ZXN0KHVhKSB8fFxuICAgIC8oaVBhZHxpUGhvbmV8aVBvZCkuKk9TIDhfXFxkL2kudGVzdCh1YSlcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9pc0lPU1N0YW5kYWxvbmUodWEgPSBnZXRVQSgpKTogYm9vbGVhbiB7XG4gIHJldHVybiBfaXNJT1ModWEpICYmICEhKHdpbmRvdy5uYXZpZ2F0b3IgYXMgTmF2aWdhdG9yU3RhbmRhbG9uZSk/LnN0YW5kYWxvbmU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfaXNJRTEwKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gaXNJRSgpICYmIChkb2N1bWVudCBhcyBEb2N1bWVudCkuZG9jdW1lbnRNb2RlID09PSAxMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9pc01vYmlsZUJyb3dzZXIodWE6IHN0cmluZyA9IGdldFVBKCkpOiBib29sZWFuIHtcbiAgLy8gVE9ETzogaW1wbGVtZW50IGdldEJyb3dzZXJOYW1lIGVxdWl2YWxlbnQgZm9yIE9TLlxuICByZXR1cm4gKFxuICAgIF9pc0lPUyh1YSkgfHxcbiAgICBfaXNBbmRyb2lkKHVhKSB8fFxuICAgIF9pc1dlYk9TKHVhKSB8fFxuICAgIF9pc0JsYWNrQmVycnkodWEpIHx8XG4gICAgL3dpbmRvd3MgcGhvbmUvaS50ZXN0KHVhKSB8fFxuICAgIF9pc0lFTW9iaWxlKHVhKVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2lzSWZyYW1lKCk6IGJvb2xlYW4ge1xuICB0cnkge1xuICAgIC8vIENoZWNrIHRoYXQgdGhlIGN1cnJlbnQgd2luZG93IGlzIG5vdCB0aGUgdG9wIHdpbmRvdy5cbiAgICAvLyBJZiBzbywgcmV0dXJuIHRydWUuXG4gICAgcmV0dXJuICEhKHdpbmRvdyAmJiB3aW5kb3cgIT09IHdpbmRvdy50b3ApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgU0RLX1ZFUlNJT04gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7IF9nZXRCcm93c2VyTmFtZSB9IGZyb20gJy4vYnJvd3Nlcic7XG5pbXBvcnQgeyBnZXRVQSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuZXhwb3J0IGNvbnN0IGVudW0gQ2xpZW50SW1wbGVtZW50YXRpb24ge1xuICBDT1JFID0gJ0pzQ29yZSdcbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGNvbnN0IGVudW0gQ2xpZW50UGxhdGZvcm0ge1xuICBCUk9XU0VSID0gJ0Jyb3dzZXInLFxuICBOT0RFID0gJ05vZGUnLFxuICBSRUFDVF9OQVRJVkUgPSAnUmVhY3ROYXRpdmUnLFxuICBDT1JET1ZBID0gJ0NvcmRvdmEnLFxuICBXT1JLRVIgPSAnV29ya2VyJ1xufVxuXG4vKlxuICogRGV0ZXJtaW5lIHRoZSBTREsgdmVyc2lvbiBzdHJpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9nZXRDbGllbnRWZXJzaW9uKFxuICBjbGllbnRQbGF0Zm9ybTogQ2xpZW50UGxhdGZvcm0sXG4gIGZyYW1ld29ya3M6IHJlYWRvbmx5IHN0cmluZ1tdID0gW11cbik6IHN0cmluZyB7XG4gIGxldCByZXBvcnRlZFBsYXRmb3JtOiBzdHJpbmc7XG4gIHN3aXRjaCAoY2xpZW50UGxhdGZvcm0pIHtcbiAgICBjYXNlIENsaWVudFBsYXRmb3JtLkJST1dTRVI6XG4gICAgICAvLyBJbiBhIGJyb3dzZXIgZW52aXJvbm1lbnQsIHJlcG9ydCB0aGUgYnJvd3NlciBuYW1lLlxuICAgICAgcmVwb3J0ZWRQbGF0Zm9ybSA9IF9nZXRCcm93c2VyTmFtZShnZXRVQSgpKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQ2xpZW50UGxhdGZvcm0uV09SS0VSOlxuICAgICAgLy8gVGVjaG5pY2FsbHkgYSB3b3JrZXIgcnVucyBmcm9tIGEgYnJvd3NlciBidXQgd2UgbmVlZCB0byBkaWZmZXJlbnRpYXRlIGFcbiAgICAgIC8vIHdvcmtlciBmcm9tIGEgYnJvd3Nlci5cbiAgICAgIC8vIEZvciBleGFtcGxlOiBDaHJvbWUtV29ya2VyL0pzQ29yZS80LjkuMS9GaXJlYmFzZUNvcmUtd2ViLlxuICAgICAgcmVwb3J0ZWRQbGF0Zm9ybSA9IGAke19nZXRCcm93c2VyTmFtZShnZXRVQSgpKX0tJHtjbGllbnRQbGF0Zm9ybX1gO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJlcG9ydGVkUGxhdGZvcm0gPSBjbGllbnRQbGF0Zm9ybTtcbiAgfVxuICBjb25zdCByZXBvcnRlZEZyYW1ld29ya3MgPSBmcmFtZXdvcmtzLmxlbmd0aFxuICAgID8gZnJhbWV3b3Jrcy5qb2luKCcsJylcbiAgICA6ICdGaXJlYmFzZUNvcmUtd2ViJzsgLyogZGVmYXVsdCB2YWx1ZSBpZiBubyBvdGhlciBmcmFtZXdvcmsgaXMgdXNlZCAqL1xuICByZXR1cm4gYCR7cmVwb3J0ZWRQbGF0Zm9ybX0vJHtDbGllbnRJbXBsZW1lbnRhdGlvbi5DT1JFfS8ke1NES19WRVJTSU9OfS8ke3JlcG9ydGVkRnJhbWV3b3Jrc31gO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEVuZHBvaW50LFxuICBIdHRwTWV0aG9kLFxuICBSZWNhcHRjaGFDbGllbnRUeXBlLFxuICBSZWNhcHRjaGFWZXJzaW9uLFxuICBfcGVyZm9ybUFwaVJlcXVlc3QsXG4gIF9hZGRUaWRJZk5lY2Vzc2FyeVxufSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW50ZXJmYWNlIEdldFJlY2FwdGNoYVBhcmFtUmVzcG9uc2Uge1xuICByZWNhcHRjaGFTaXRlS2V5Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVjYXB0Y2hhUGFyYW1zKGF1dGg6IEF1dGgpOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gKFxuICAgIChcbiAgICAgIGF3YWl0IF9wZXJmb3JtQXBpUmVxdWVzdDx2b2lkLCBHZXRSZWNhcHRjaGFQYXJhbVJlc3BvbnNlPihcbiAgICAgICAgYXV0aCxcbiAgICAgICAgSHR0cE1ldGhvZC5HRVQsXG4gICAgICAgIEVuZHBvaW50LkdFVF9SRUNBUFRDSEFfUEFSQU1cbiAgICAgIClcbiAgICApLnJlY2FwdGNoYVNpdGVLZXkgfHwgJydcbiAgKTtcbn1cblxuLy8gVGhlIGZvbGxvd2luZyBmdW5jdGlvbnMgYXJlIGZvciByZUNBUFRDSEEgZW50ZXJwcmlzZSBpbnRlZ3JhdGlvbi5cbmludGVyZmFjZSBHZXRSZWNhcHRjaGFDb25maWdSZXF1ZXN0IHtcbiAgdGVuYW50SWQ/OiBzdHJpbmc7XG4gIGNsaWVudFR5cGU/OiBSZWNhcHRjaGFDbGllbnRUeXBlO1xuICB2ZXJzaW9uPzogUmVjYXB0Y2hhVmVyc2lvbjtcbn1cblxuaW50ZXJmYWNlIFJlY2FwdGNoYUVuZm9yY2VtZW50U3RhdGUge1xuICBwcm92aWRlcjogc3RyaW5nO1xuICBlbmZvcmNlbWVudFN0YXRlOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0UmVjYXB0Y2hhQ29uZmlnUmVzcG9uc2Uge1xuICByZWNhcHRjaGFLZXk6IHN0cmluZztcbiAgcmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZTogUmVjYXB0Y2hhRW5mb3JjZW1lbnRTdGF0ZVtdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UmVjYXB0Y2hhQ29uZmlnKFxuICBhdXRoOiBBdXRoLFxuICByZXF1ZXN0OiBHZXRSZWNhcHRjaGFDb25maWdSZXF1ZXN0XG4pOiBQcm9taXNlPEdldFJlY2FwdGNoYUNvbmZpZ1Jlc3BvbnNlPiB7XG4gIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3Q8XG4gICAgR2V0UmVjYXB0Y2hhQ29uZmlnUmVxdWVzdCxcbiAgICBHZXRSZWNhcHRjaGFDb25maWdSZXNwb25zZVxuICA+KFxuICAgIGF1dGgsXG4gICAgSHR0cE1ldGhvZC5HRVQsXG4gICAgRW5kcG9pbnQuR0VUX1JFQ0FQVENIQV9DT05GSUcsXG4gICAgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpXG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgUmVjYXB0Y2hhUGFyYW1ldGVycyB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQgeyBHZXRSZWNhcHRjaGFDb25maWdSZXNwb25zZSB9IGZyb20gJy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi9yZWNhcHRjaGEnO1xuXG4vLyByZUNBUFRDSEEgdjIgaW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIFJlY2FwdGNoYSB7XG4gIHJlbmRlcjogKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHBhcmFtZXRlcnM6IFJlY2FwdGNoYVBhcmFtZXRlcnMpID0+IG51bWJlcjtcbiAgZ2V0UmVzcG9uc2U6IChpZDogbnVtYmVyKSA9PiBzdHJpbmc7XG4gIGV4ZWN1dGU6IChpZDogbnVtYmVyKSA9PiB1bmtub3duO1xuICByZXNldDogKGlkOiBudW1iZXIpID0+IHVua25vd247XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1YyKFxuICBncmVjYXB0Y2hhOiBSZWNhcHRjaGEgfCBHcmVDQVBUQ0hBIHwgdW5kZWZpbmVkXG4pOiBncmVjYXB0Y2hhIGlzIFJlY2FwdGNoYSB7XG4gIHJldHVybiAoXG4gICAgZ3JlY2FwdGNoYSAhPT0gdW5kZWZpbmVkICYmXG4gICAgKGdyZWNhcHRjaGEgYXMgUmVjYXB0Y2hhKS5nZXRSZXNwb25zZSAhPT0gdW5kZWZpbmVkXG4gICk7XG59XG5cbi8vIHJlQ0FQVENIQSBFbnRlcnByaXNlICYgdjMgc2hhcmVkIGludGVyZmFjZVxuZXhwb3J0IGludGVyZmFjZSBHcmVDQVBUQ0hBVG9wTGV2ZWwgZXh0ZW5kcyBHcmVDQVBUQ0hBIHtcbiAgZW50ZXJwcmlzZTogR3JlQ0FQVENIQTtcbn1cblxuLy8gcmVDQVBUQ0hBIEVudGVycHJpc2UgaW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIEdyZUNBUFRDSEEge1xuICByZWFkeTogKGNhbGxiYWNrOiAoKSA9PiB2b2lkKSA9PiB2b2lkO1xuICBleGVjdXRlOiAoc2l0ZUtleTogc3RyaW5nLCBvcHRpb25zOiB7IGFjdGlvbjogc3RyaW5nIH0pID0+IFByb21pc2U8c3RyaW5nPjtcbiAgcmVuZGVyOiAoXG4gICAgY29udGFpbmVyOiBzdHJpbmcgfCBIVE1MRWxlbWVudCxcbiAgICBwYXJhbWV0ZXJzOiBHcmVDQVBUQ0hBUmVuZGVyT3B0aW9uXG4gICkgPT4gc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdyZUNBUFRDSEFSZW5kZXJPcHRpb24ge1xuICBzaXRla2V5OiBzdHJpbmc7XG4gIHNpemU6ICdpbnZpc2libGUnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNFbnRlcnByaXNlKFxuICBncmVjYXB0Y2hhOiBSZWNhcHRjaGEgfCBHcmVDQVBUQ0hBIHwgdW5kZWZpbmVkXG4pOiBncmVjYXB0Y2hhIGlzIEdyZUNBUFRDSEFUb3BMZXZlbCB7XG4gIHJldHVybiAoXG4gICAgZ3JlY2FwdGNoYSAhPT0gdW5kZWZpbmVkICYmXG4gICAgKGdyZWNhcHRjaGEgYXMgR3JlQ0FQVENIQVRvcExldmVsKS5lbnRlcnByaXNlICE9PSB1bmRlZmluZWRcbiAgKTtcbn1cblxuLy8gVE9ETyhjaHVhbnIpOiBSZXBsYWNlIHRoaXMgd2l0aCB0aGUgQXV0aFdpbmRvdyBhZnRlciByZXNvbHZpbmcgdGhlIGRlcGVuZGVuY3kgaXNzdWUgaW4gTm9kZS5qcyBlbnYuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBXaW5kb3cge1xuICAgIGdyZWNhcHRjaGE/OiBSZWNhcHRjaGEgfCBHcmVDQVBUQ0hBVG9wTGV2ZWw7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlY2FwdGNoYUNvbmZpZyB7XG4gIC8qKlxuICAgKiBUaGUgcmVDQVBUQ0hBIHNpdGUga2V5LlxuICAgKi9cbiAgc2l0ZUtleTogc3RyaW5nID0gJyc7XG5cbiAgLyoqXG4gICAqIFRoZSByZUNBUFRDSEEgZW5hYmxlbWVudCBzdGF0dXMgb2YgdGhlIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gZm9yIHRoZSBjdXJyZW50IHRlbmFudC5cbiAgICovXG4gIGVtYWlsUGFzc3dvcmRFbmFibGVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IocmVzcG9uc2U6IEdldFJlY2FwdGNoYUNvbmZpZ1Jlc3BvbnNlKSB7XG4gICAgaWYgKHJlc3BvbnNlLnJlY2FwdGNoYUtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3JlY2FwdGNoYUtleSB1bmRlZmluZWQnKTtcbiAgICB9XG4gICAgLy8gRXhhbXBsZSByZXNwb25zZS5yZWNhcHRjaGFLZXk6IFwicHJvamVjdHMvcHJvajEyMy9rZXlzL3NpdGVrZXkxMjNcIlxuICAgIHRoaXMuc2l0ZUtleSA9IHJlc3BvbnNlLnJlY2FwdGNoYUtleS5zcGxpdCgnLycpWzNdO1xuICAgIHRoaXMuZW1haWxQYXNzd29yZEVuYWJsZWQgPSByZXNwb25zZS5yZWNhcHRjaGFFbmZvcmNlbWVudFN0YXRlLnNvbWUoXG4gICAgICBlbmZvcmNlbWVudFN0YXRlID0+XG4gICAgICAgIGVuZm9yY2VtZW50U3RhdGUucHJvdmlkZXIgPT09ICdFTUFJTF9QQVNTV09SRF9QUk9WSURFUicgJiZcbiAgICAgICAgZW5mb3JjZW1lbnRTdGF0ZS5lbmZvcmNlbWVudFN0YXRlICE9PSAnT0ZGJ1xuICAgICk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vY29yZS9lcnJvcnMnO1xuaW1wb3J0IHsgX2NyZWF0ZUVycm9yIH0gZnJvbSAnLi4vY29yZS91dGlsL2Fzc2VydCc7XG5cbmZ1bmN0aW9uIGdldFNjcmlwdFBhcmVudEVsZW1lbnQoKTogSFRNTERvY3VtZW50IHwgSFRNTEhlYWRFbGVtZW50IHtcbiAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJyk/LlswXSA/PyBkb2N1bWVudDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9sb2FkSlModXJsOiBzdHJpbmcpOiBQcm9taXNlPEV2ZW50PiB7XG4gIC8vIFRPRE86IGNvbnNpZGVyIGFkZGluZyB0aW1lb3V0IHN1cHBvcnQgJiBjYW5jZWxsYXRpb25cbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnc3JjJywgdXJsKTtcbiAgICBlbC5vbmxvYWQgPSByZXNvbHZlO1xuICAgIGVsLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgIGNvbnN0IGVycm9yID0gX2NyZWF0ZUVycm9yKEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICAgICAgZXJyb3IuY3VzdG9tRGF0YSA9IGUgYXMgdW5rbm93biBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgICAgIHJlamVjdChlcnJvcik7XG4gICAgfTtcbiAgICBlbC50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7XG4gICAgZWwuY2hhcnNldCA9ICdVVEYtOCc7XG4gICAgZ2V0U2NyaXB0UGFyZW50RWxlbWVudCgpLmFwcGVuZENoaWxkKGVsKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfZ2VuZXJhdGVDYWxsYmFja05hbWUocHJlZml4OiBzdHJpbmcpOiBzdHJpbmcge1xuICByZXR1cm4gYF9fJHtwcmVmaXh9JHtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMDAwMDAwKX1gO1xufVxuIiwgIi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMgKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGlzRW50ZXJwcmlzZSwgUmVjYXB0Y2hhQ29uZmlnIH0gZnJvbSAnLi9yZWNhcHRjaGEnO1xuaW1wb3J0IHsgZ2V0UmVjYXB0Y2hhQ29uZmlnIH0gZnJvbSAnLi4vLi4vYXBpL2F1dGhlbnRpY2F0aW9uL3JlY2FwdGNoYSc7XG5pbXBvcnQge1xuICBSZWNhcHRjaGFDbGllbnRUeXBlLFxuICBSZWNhcHRjaGFWZXJzaW9uLFxuICBSZWNhcHRjaGFBY3Rpb25OYW1lXG59IGZyb20gJy4uLy4uL2FwaSc7XG5cbmltcG9ydCB7IEF1dGggfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBfY2FzdEF1dGggfSBmcm9tICcuLi8uLi9jb3JlL2F1dGgvYXV0aF9pbXBsJztcbmltcG9ydCAqIGFzIGpzSGVscGVycyBmcm9tICcuLi9sb2FkX2pzJztcblxuY29uc3QgUkVDQVBUQ0hBX0VOVEVSUFJJU0VfVVJMID1cbiAgJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVjYXB0Y2hhL2VudGVycHJpc2UuanM/cmVuZGVyPSc7XG5cbmV4cG9ydCBjb25zdCBSRUNBUFRDSEFfRU5URVJQUklTRV9WRVJJRklFUl9UWVBFID0gJ3JlY2FwdGNoYS1lbnRlcnByaXNlJztcbmV4cG9ydCBjb25zdCBGQUtFX1RPS0VOID0gJ05PX1JFQ0FQVENIQSc7XG5cbmV4cG9ydCBjbGFzcyBSZWNhcHRjaGFFbnRlcnByaXNlVmVyaWZpZXIge1xuICAvKipcbiAgICogSWRlbnRpZmllcyB0aGUgdHlwZSBvZiBhcHBsaWNhdGlvbiB2ZXJpZmllciAoZS5nLiBcInJlY2FwdGNoYS1lbnRlcnByaXNlXCIpLlxuICAgKi9cbiAgcmVhZG9ubHkgdHlwZSA9IFJFQ0FQVENIQV9FTlRFUlBSSVNFX1ZFUklGSUVSX1RZUEU7XG5cbiAgcHJpdmF0ZSByZWFkb25seSBhdXRoOiBBdXRoSW50ZXJuYWw7XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSBhdXRoRXh0ZXJuIC0gVGhlIGNvcnJlc3BvbmRpbmcgRmlyZWJhc2Uge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICAgKlxuICAgKi9cbiAgY29uc3RydWN0b3IoYXV0aEV4dGVybjogQXV0aCkge1xuICAgIHRoaXMuYXV0aCA9IF9jYXN0QXV0aChhdXRoRXh0ZXJuKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyB0aGUgdmVyaWZpY2F0aW9uIHByb2Nlc3MuXG4gICAqXG4gICAqIEByZXR1cm5zIEEgUHJvbWlzZSBmb3IgYSB0b2tlbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGFzc2VydCB0aGUgdmFsaWRpdHkgb2YgYSByZXF1ZXN0LlxuICAgKi9cbiAgYXN5bmMgdmVyaWZ5KFxuICAgIGFjdGlvbjogc3RyaW5nID0gJ3ZlcmlmeScsXG4gICAgZm9yY2VSZWZyZXNoID0gZmFsc2VcbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBhc3luYyBmdW5jdGlvbiByZXRyaWV2ZVNpdGVLZXkoYXV0aDogQXV0aEludGVybmFsKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgIGlmICghZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgIGlmIChhdXRoLnRlbmFudElkID09IG51bGwgJiYgYXV0aC5fYWdlbnRSZWNhcHRjaGFDb25maWcgIT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiBhdXRoLl9hZ2VudFJlY2FwdGNoYUNvbmZpZy5zaXRlS2V5O1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICBhdXRoLnRlbmFudElkICE9IG51bGwgJiZcbiAgICAgICAgICBhdXRoLl90ZW5hbnRSZWNhcHRjaGFDb25maWdzW2F1dGgudGVuYW50SWRdICE9PSB1bmRlZmluZWRcbiAgICAgICAgKSB7XG4gICAgICAgICAgcmV0dXJuIGF1dGguX3RlbmFudFJlY2FwdGNoYUNvbmZpZ3NbYXV0aC50ZW5hbnRJZF0uc2l0ZUtleTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2U8c3RyaW5nPihhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGdldFJlY2FwdGNoYUNvbmZpZyhhdXRoLCB7XG4gICAgICAgICAgY2xpZW50VHlwZTogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUIsXG4gICAgICAgICAgdmVyc2lvbjogUmVjYXB0Y2hhVmVyc2lvbi5FTlRFUlBSSVNFXG4gICAgICAgIH0pXG4gICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlY2FwdGNoYUtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ3JlY2FwdGNoYSBFbnRlcnByaXNlIHNpdGUga2V5IHVuZGVmaW5lZCcpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnN0IGNvbmZpZyA9IG5ldyBSZWNhcHRjaGFDb25maWcocmVzcG9uc2UpO1xuICAgICAgICAgICAgICBpZiAoYXV0aC50ZW5hbnRJZCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXV0aC5fYWdlbnRSZWNhcHRjaGFDb25maWcgPSBjb25maWc7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYXV0aC5fdGVuYW50UmVjYXB0Y2hhQ29uZmlnc1thdXRoLnRlbmFudElkXSA9IGNvbmZpZztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShjb25maWcuc2l0ZUtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJldHJpZXZlUmVjYXB0Y2hhVG9rZW4oXG4gICAgICBzaXRlS2V5OiBzdHJpbmcsXG4gICAgICByZXNvbHZlOiAodmFsdWU6IHN0cmluZyB8IFByb21pc2VMaWtlPHN0cmluZz4pID0+IHZvaWQsXG4gICAgICByZWplY3Q6IChyZWFzb24/OiB1bmtub3duKSA9PiB2b2lkXG4gICAgKTogdm9pZCB7XG4gICAgICBjb25zdCBncmVjYXB0Y2hhID0gd2luZG93LmdyZWNhcHRjaGE7XG4gICAgICBpZiAoaXNFbnRlcnByaXNlKGdyZWNhcHRjaGEpKSB7XG4gICAgICAgIGdyZWNhcHRjaGEuZW50ZXJwcmlzZS5yZWFkeSgoKSA9PiB7XG4gICAgICAgICAgZ3JlY2FwdGNoYS5lbnRlcnByaXNlXG4gICAgICAgICAgICAuZXhlY3V0ZShzaXRlS2V5LCB7IGFjdGlvbiB9KVxuICAgICAgICAgICAgLnRoZW4odG9rZW4gPT4ge1xuICAgICAgICAgICAgICByZXNvbHZlKHRva2VuKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgICAgICByZXNvbHZlKEZBS0VfVE9LRU4pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVqZWN0KEVycm9yKCdObyByZUNBUFRDSEEgZW50ZXJwcmlzZSBzY3JpcHQgbG9hZGVkLicpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2U8c3RyaW5nPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXRyaWV2ZVNpdGVLZXkodGhpcy5hdXRoKVxuICAgICAgICAudGhlbihzaXRlS2V5ID0+IHtcbiAgICAgICAgICBpZiAoIWZvcmNlUmVmcmVzaCAmJiBpc0VudGVycHJpc2Uod2luZG93LmdyZWNhcHRjaGEpKSB7XG4gICAgICAgICAgICByZXRyaWV2ZVJlY2FwdGNoYVRva2VuKHNpdGVLZXksIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICByZWplY3QoXG4gICAgICAgICAgICAgICAgbmV3IEVycm9yKCdSZWNhcHRjaGFWZXJpZmllciBpcyBvbmx5IHN1cHBvcnRlZCBpbiBicm93c2VyJylcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAganNIZWxwZXJzXG4gICAgICAgICAgICAgIC5fbG9hZEpTKFJFQ0FQVENIQV9FTlRFUlBSSVNFX1VSTCArIHNpdGVLZXkpXG4gICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICByZXRyaWV2ZVJlY2FwdGNoYVRva2VuKHNpdGVLZXksIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbmplY3RSZWNhcHRjaGFGaWVsZHM8VD4oXG4gIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgcmVxdWVzdDogVCxcbiAgYWN0aW9uOiBSZWNhcHRjaGFBY3Rpb25OYW1lLFxuICBjYXB0Y2hhUmVzcCA9IGZhbHNlXG4pOiBQcm9taXNlPFQ+IHtcbiAgY29uc3QgdmVyaWZpZXIgPSBuZXcgUmVjYXB0Y2hhRW50ZXJwcmlzZVZlcmlmaWVyKGF1dGgpO1xuICBsZXQgY2FwdGNoYVJlc3BvbnNlO1xuICB0cnkge1xuICAgIGNhcHRjaGFSZXNwb25zZSA9IGF3YWl0IHZlcmlmaWVyLnZlcmlmeShhY3Rpb24pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNhcHRjaGFSZXNwb25zZSA9IGF3YWl0IHZlcmlmaWVyLnZlcmlmeShhY3Rpb24sIHRydWUpO1xuICB9XG4gIGNvbnN0IG5ld1JlcXVlc3QgPSB7IC4uLnJlcXVlc3QgfTtcbiAgaWYgKCFjYXB0Y2hhUmVzcCkge1xuICAgIE9iamVjdC5hc3NpZ24obmV3UmVxdWVzdCwgeyBjYXB0Y2hhUmVzcG9uc2UgfSk7XG4gIH0gZWxzZSB7XG4gICAgT2JqZWN0LmFzc2lnbihuZXdSZXF1ZXN0LCB7ICdjYXB0Y2hhUmVzcCc6IGNhcHRjaGFSZXNwb25zZSB9KTtcbiAgfVxuICBPYmplY3QuYXNzaWduKG5ld1JlcXVlc3QsIHsgJ2NsaWVudFR5cGUnOiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQiB9KTtcbiAgT2JqZWN0LmFzc2lnbihuZXdSZXF1ZXN0LCB7XG4gICAgJ3JlY2FwdGNoYVZlcnNpb24nOiBSZWNhcHRjaGFWZXJzaW9uLkVOVEVSUFJJU0VcbiAgfSk7XG4gIHJldHVybiBuZXdSZXF1ZXN0O1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgVW5zdWJzY3JpYmUsIFVzZXIgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5cbmludGVyZmFjZSBNaWRkbGV3YXJlRW50cnkge1xuICAodXNlcjogVXNlciB8IG51bGwpOiBQcm9taXNlPHZvaWQ+O1xuICBvbkFib3J0PzogKCkgPT4gdm9pZDtcbn1cblxuZXhwb3J0IGNsYXNzIEF1dGhNaWRkbGV3YXJlUXVldWUge1xuICBwcml2YXRlIHJlYWRvbmx5IHF1ZXVlOiBNaWRkbGV3YXJlRW50cnlbXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgYXV0aDogQXV0aEludGVybmFsKSB7fVxuXG4gIHB1c2hDYWxsYmFjayhcbiAgICBjYWxsYmFjazogKHVzZXI6IFVzZXIgfCBudWxsKSA9PiB2b2lkIHwgUHJvbWlzZTx2b2lkPixcbiAgICBvbkFib3J0PzogKCkgPT4gdm9pZFxuICApOiBVbnN1YnNjcmliZSB7XG4gICAgLy8gVGhlIGNhbGxiYWNrIGNvdWxkIGJlIHN5bmMgb3IgYXN5bmMuIFdyYXAgaXQgaW50byBhXG4gICAgLy8gZnVuY3Rpb24gdGhhdCBpcyBhbHdheXMgYXN5bmMuXG4gICAgY29uc3Qgd3JhcHBlZENhbGxiYWNrOiBNaWRkbGV3YXJlRW50cnkgPSAoXG4gICAgICB1c2VyOiBVc2VyIHwgbnVsbFxuICAgICk6IFByb21pc2U8dm9pZD4gPT5cbiAgICAgIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBjYWxsYmFjayh1c2VyKTtcbiAgICAgICAgICAvLyBFaXRoZXIgcmVzb2x2ZSB3aXRoIGV4aXN0aW5nIHByb21pc2Ugb3Igd3JhcCBhIG5vbi1wcm9taXNlXG4gICAgICAgICAgLy8gcmV0dXJuIHZhbHVlIGludG8gYSBwcm9taXNlLlxuICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIC8vIFN5bmMgY2FsbGJhY2sgdGhyb3dzLlxuICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgLy8gQXR0YWNoIHRoZSBvbkFib3J0IGlmIHByZXNlbnRcbiAgICB3cmFwcGVkQ2FsbGJhY2sub25BYm9ydCA9IG9uQWJvcnQ7XG4gICAgdGhpcy5xdWV1ZS5wdXNoKHdyYXBwZWRDYWxsYmFjayk7XG5cbiAgICBjb25zdCBpbmRleCA9IHRoaXMucXVldWUubGVuZ3RoIC0gMTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgLy8gVW5zdWJzY3JpYmUuIFJlcGxhY2Ugd2l0aCBuby1vcC4gRG8gbm90IHJlbW92ZSBmcm9tIGFycmF5LCBvciBpdCB3aWxsIGRpc3R1cmJcbiAgICAgIC8vIGluZGV4aW5nIG9mIG90aGVyIGVsZW1lbnRzLlxuICAgICAgdGhpcy5xdWV1ZVtpbmRleF0gPSAoKSA9PiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9O1xuICB9XG5cbiAgYXN5bmMgcnVuTWlkZGxld2FyZShuZXh0VXNlcjogVXNlciB8IG51bGwpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5hdXRoLmN1cnJlbnRVc2VyID09PSBuZXh0VXNlcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFdoaWxlIHJ1bm5pbmcgdGhlIG1pZGRsZXdhcmUsIGJ1aWxkIGEgdGVtcG9yYXJ5IHN0YWNrIG9mIG9uQWJvcnRcbiAgICAvLyBjYWxsYmFja3MgdG8gY2FsbCBpZiBvbmUgbWlkZGxld2FyZSBjYWxsYmFjayByZWplY3RzLlxuXG4gICAgY29uc3Qgb25BYm9ydFN0YWNrOiBBcnJheTwoKSA9PiB2b2lkPiA9IFtdO1xuICAgIHRyeSB7XG4gICAgICBmb3IgKGNvbnN0IGJlZm9yZVN0YXRlQ2FsbGJhY2sgb2YgdGhpcy5xdWV1ZSkge1xuICAgICAgICBhd2FpdCBiZWZvcmVTdGF0ZUNhbGxiYWNrKG5leHRVc2VyKTtcblxuICAgICAgICAvLyBPbmx5IHB1c2ggdGhlIG9uQWJvcnQgaWYgdGhlIGNhbGxiYWNrIHN1Y2NlZWRzXG4gICAgICAgIGlmIChiZWZvcmVTdGF0ZUNhbGxiYWNrLm9uQWJvcnQpIHtcbiAgICAgICAgICBvbkFib3J0U3RhY2sucHVzaChiZWZvcmVTdGF0ZUNhbGxiYWNrLm9uQWJvcnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gUnVuIGFsbCBvbkFib3J0LCB3aXRoIHNlcGFyYXRlIHRyeS9jYXRjaCB0byBpZ25vcmUgYW55IGVycm9ycyBhbmRcbiAgICAgIC8vIGNvbnRpbnVlXG4gICAgICBvbkFib3J0U3RhY2sucmV2ZXJzZSgpO1xuICAgICAgZm9yIChjb25zdCBvbkFib3J0IG9mIG9uQWJvcnRTdGFjaykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIG9uQWJvcnQoKTtcbiAgICAgICAgfSBjYXRjaCAoXykge1xuICAgICAgICAgIC8qIHN3YWxsb3cgZXJyb3IgKi9cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aHJvdyB0aGlzLmF1dGguX2Vycm9yRmFjdG9yeS5jcmVhdGUoQXV0aEVycm9yQ29kZS5MT0dJTl9CTE9DS0VELCB7XG4gICAgICAgIG9yaWdpbmFsTWVzc2FnZTogKGUgYXMgRXJyb3IpPy5tZXNzYWdlXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBfRmlyZWJhc2VTZXJ2aWNlLCBGaXJlYmFzZUFwcCB9IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuaW1wb3J0IHsgUHJvdmlkZXIgfSBmcm9tICdAZmlyZWJhc2UvY29tcG9uZW50JztcbmltcG9ydCB7IEFwcENoZWNrSW50ZXJuYWxDb21wb25lbnROYW1lIH0gZnJvbSAnQGZpcmViYXNlL2FwcC1jaGVjay1pbnRlcm9wLXR5cGVzJztcbmltcG9ydCB7XG4gIEF1dGgsXG4gIEF1dGhFcnJvck1hcCxcbiAgQXV0aFNldHRpbmdzLFxuICBFbXVsYXRvckNvbmZpZyxcbiAgTmV4dE9yT2JzZXJ2ZXIsXG4gIFBlcnNpc3RlbmNlLFxuICBQb3B1cFJlZGlyZWN0UmVzb2x2ZXIsXG4gIFVzZXIsXG4gIFVzZXJDcmVkZW50aWFsLFxuICBDb21wbGV0ZUZuLFxuICBFcnJvckZuLFxuICBOZXh0Rm4sXG4gIFVuc3Vic2NyaWJlXG59IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQge1xuICBjcmVhdGVTdWJzY3JpYmUsXG4gIEVycm9yRmFjdG9yeSxcbiAgRmlyZWJhc2VFcnJvcixcbiAgZ2V0TW9kdWxhckluc3RhbmNlLFxuICBPYnNlcnZlcixcbiAgU3Vic2NyaWJlXG59IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuaW1wb3J0IHsgQXV0aEludGVybmFsLCBDb25maWdJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9wb3B1cF9yZWRpcmVjdCc7XG5pbXBvcnQgeyBVc2VySW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC91c2VyJztcbmltcG9ydCB7XG4gIEF1dGhFcnJvckNvZGUsXG4gIEF1dGhFcnJvclBhcmFtcyxcbiAgRXJyb3JNYXBSZXRyaWV2ZXIsXG4gIF9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWVxufSBmcm9tICcuLi9lcnJvcnMnO1xuaW1wb3J0IHsgUGVyc2lzdGVuY2VJbnRlcm5hbCB9IGZyb20gJy4uL3BlcnNpc3RlbmNlJztcbmltcG9ydCB7XG4gIEtleU5hbWUsXG4gIFBlcnNpc3RlbmNlVXNlck1hbmFnZXJcbn0gZnJvbSAnLi4vcGVyc2lzdGVuY2UvcGVyc2lzdGVuY2VfdXNlcl9tYW5hZ2VyJztcbmltcG9ydCB7IF9yZWxvYWRXaXRob3V0U2F2aW5nIH0gZnJvbSAnLi4vdXNlci9yZWxvYWQnO1xuaW1wb3J0IHsgX2Fzc2VydCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IF9nZXRJbnN0YW5jZSB9IGZyb20gJy4uL3V0aWwvaW5zdGFudGlhdG9yJztcbmltcG9ydCB7IF9nZXRVc2VyTGFuZ3VhZ2UgfSBmcm9tICcuLi91dGlsL25hdmlnYXRvcic7XG5pbXBvcnQgeyBfZ2V0Q2xpZW50VmVyc2lvbiB9IGZyb20gJy4uL3V0aWwvdmVyc2lvbic7XG5pbXBvcnQgeyBIdHRwSGVhZGVyLCBSZWNhcHRjaGFDbGllbnRUeXBlLCBSZWNhcHRjaGFWZXJzaW9uIH0gZnJvbSAnLi4vLi4vYXBpJztcbmltcG9ydCB7IGdldFJlY2FwdGNoYUNvbmZpZyB9IGZyb20gJy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi9yZWNhcHRjaGEnO1xuaW1wb3J0IHsgUmVjYXB0Y2hhRW50ZXJwcmlzZVZlcmlmaWVyIH0gZnJvbSAnLi4vLi4vcGxhdGZvcm1fYnJvd3Nlci9yZWNhcHRjaGEvcmVjYXB0Y2hhX2VudGVycHJpc2VfdmVyaWZpZXInO1xuaW1wb3J0IHsgQXV0aE1pZGRsZXdhcmVRdWV1ZSB9IGZyb20gJy4vbWlkZGxld2FyZSc7XG5pbXBvcnQgeyBSZWNhcHRjaGFDb25maWcgfSBmcm9tICcuLi8uLi9wbGF0Zm9ybV9icm93c2VyL3JlY2FwdGNoYS9yZWNhcHRjaGEnO1xuaW1wb3J0IHsgX2xvZ1dhcm4gfSBmcm9tICcuLi91dGlsL2xvZyc7XG5cbmludGVyZmFjZSBBc3luY0FjdGlvbiB7XG4gICgpOiBQcm9taXNlPHZvaWQ+O1xufVxuXG5leHBvcnQgY29uc3QgZW51bSBEZWZhdWx0Q29uZmlnIHtcbiAgVE9LRU5fQVBJX0hPU1QgPSAnc2VjdXJldG9rZW4uZ29vZ2xlYXBpcy5jb20nLFxuICBBUElfSE9TVCA9ICdpZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20nLFxuICBBUElfU0NIRU1FID0gJ2h0dHBzJ1xufVxuXG5leHBvcnQgY2xhc3MgQXV0aEltcGwgaW1wbGVtZW50cyBBdXRoSW50ZXJuYWwsIF9GaXJlYmFzZVNlcnZpY2Uge1xuICBjdXJyZW50VXNlcjogVXNlciB8IG51bGwgPSBudWxsO1xuICBlbXVsYXRvckNvbmZpZzogRW11bGF0b3JDb25maWcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBvcGVyYXRpb25zID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIHByaXZhdGUgcGVyc2lzdGVuY2VNYW5hZ2VyPzogUGVyc2lzdGVuY2VVc2VyTWFuYWdlcjtcbiAgcHJpdmF0ZSByZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcj86IFBlcnNpc3RlbmNlVXNlck1hbmFnZXI7XG4gIHByaXZhdGUgYXV0aFN0YXRlU3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbjxVc2VyPih0aGlzKTtcbiAgcHJpdmF0ZSBpZFRva2VuU3Vic2NyaXB0aW9uID0gbmV3IFN1YnNjcmlwdGlvbjxVc2VyPih0aGlzKTtcbiAgcHJpdmF0ZSByZWFkb25seSBiZWZvcmVTdGF0ZVF1ZXVlID0gbmV3IEF1dGhNaWRkbGV3YXJlUXVldWUodGhpcyk7XG4gIHByaXZhdGUgcmVkaXJlY3RVc2VyOiBVc2VySW50ZXJuYWwgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBpc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkID0gZmFsc2U7XG5cbiAgLy8gQW55IG5ldHdvcmsgY2FsbHMgd2lsbCBzZXQgdGhpcyB0byB0cnVlIGFuZCBwcmV2ZW50IHN1YnNlcXVlbnQgZW11bGF0b3JcbiAgLy8gaW5pdGlhbGl6YXRpb25cbiAgX2NhbkluaXRFbXVsYXRvciA9IHRydWU7XG4gIF9pc0luaXRpYWxpemVkID0gZmFsc2U7XG4gIF9kZWxldGVkID0gZmFsc2U7XG4gIF9pbml0aWFsaXphdGlvblByb21pc2U6IFByb21pc2U8dm9pZD4gfCBudWxsID0gbnVsbDtcbiAgX3BvcHVwUmVkaXJlY3RSZXNvbHZlcjogUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWwgfCBudWxsID0gbnVsbDtcbiAgX2Vycm9yRmFjdG9yeTogRXJyb3JGYWN0b3J5PEF1dGhFcnJvckNvZGUsIEF1dGhFcnJvclBhcmFtcz4gPVxuICAgIF9ERUZBVUxUX0FVVEhfRVJST1JfRkFDVE9SWTtcbiAgX2FnZW50UmVjYXB0Y2hhQ29uZmlnOiBSZWNhcHRjaGFDb25maWcgfCBudWxsID0gbnVsbDtcbiAgX3RlbmFudFJlY2FwdGNoYUNvbmZpZ3M6IFJlY29yZDxzdHJpbmcsIFJlY2FwdGNoYUNvbmZpZz4gPSB7fTtcbiAgcmVhZG9ubHkgbmFtZTogc3RyaW5nO1xuXG4gIC8vIFRyYWNrcyB0aGUgbGFzdCBub3RpZmllZCBVSUQgZm9yIHN0YXRlIGNoYW5nZSBsaXN0ZW5lcnMgdG8gcHJldmVudFxuICAvLyByZXBlYXRlZCBjYWxscyB0byB0aGUgY2FsbGJhY2tzLiBVbmRlZmluZWQgbWVhbnMgaXQncyBuZXZlciBiZWVuXG4gIC8vIGNhbGxlZCwgd2hlcmVhcyBudWxsIG1lYW5zIGl0J3MgYmVlbiBjYWxsZWQgd2l0aCBhIHNpZ25lZCBvdXQgdXNlclxuICBwcml2YXRlIGxhc3ROb3RpZmllZFVpZDogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblxuICBsYW5ndWFnZUNvZGU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICB0ZW5hbnRJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIHNldHRpbmdzOiBBdXRoU2V0dGluZ3MgPSB7IGFwcFZlcmlmaWNhdGlvbkRpc2FibGVkRm9yVGVzdGluZzogZmFsc2UgfTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgcmVhZG9ubHkgYXBwOiBGaXJlYmFzZUFwcCxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGhlYXJ0YmVhdFNlcnZpY2VQcm92aWRlcjogUHJvdmlkZXI8J2hlYXJ0YmVhdCc+LFxuICAgIHByaXZhdGUgcmVhZG9ubHkgYXBwQ2hlY2tTZXJ2aWNlUHJvdmlkZXI6IFByb3ZpZGVyPEFwcENoZWNrSW50ZXJuYWxDb21wb25lbnROYW1lPixcbiAgICBwdWJsaWMgcmVhZG9ubHkgY29uZmlnOiBDb25maWdJbnRlcm5hbFxuICApIHtcbiAgICB0aGlzLm5hbWUgPSBhcHAubmFtZTtcbiAgICB0aGlzLmNsaWVudFZlcnNpb24gPSBjb25maWcuc2RrQ2xpZW50VmVyc2lvbjtcbiAgfVxuXG4gIF9pbml0aWFsaXplV2l0aFBlcnNpc3RlbmNlKFxuICAgIHBlcnNpc3RlbmNlSGllcmFyY2h5OiBQZXJzaXN0ZW5jZUludGVybmFsW10sXG4gICAgcG9wdXBSZWRpcmVjdFJlc29sdmVyPzogUG9wdXBSZWRpcmVjdFJlc29sdmVyXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmIChwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpIHtcbiAgICAgIHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciA9IF9nZXRJbnN0YW5jZShwb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xuICAgIH1cblxuICAgIC8vIEhhdmUgdG8gY2hlY2sgZm9yIGFwcCBkZWxldGlvbiB0aHJvdWdob3V0IGluaXRpYWxpemF0aW9uIChhZnRlciBlYWNoXG4gICAgLy8gcHJvbWlzZSByZXNvbHV0aW9uKVxuICAgIHRoaXMuX2luaXRpYWxpemF0aW9uUHJvbWlzZSA9IHRoaXMucXVldWUoYXN5bmMgKCkgPT4ge1xuICAgICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnBlcnNpc3RlbmNlTWFuYWdlciA9IGF3YWl0IFBlcnNpc3RlbmNlVXNlck1hbmFnZXIuY3JlYXRlKFxuICAgICAgICB0aGlzLFxuICAgICAgICBwZXJzaXN0ZW5jZUhpZXJhcmNoeVxuICAgICAgKTtcblxuICAgICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBJbml0aWFsaXplIHRoZSByZXNvbHZlciBlYXJseSBpZiBuZWNlc3NhcnkgKG9ubHkgYXBwbGljYWJsZSB0byB3ZWI6XG4gICAgICAvLyB0aGlzIHdpbGwgY2F1c2UgdGhlIGlmcmFtZSB0byBsb2FkIGltbWVkaWF0ZWx5IGluIGNlcnRhaW4gY2FzZXMpXG4gICAgICBpZiAodGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyPy5fc2hvdWxkSW5pdFByb2FjdGl2ZWx5KSB7XG4gICAgICAgIC8vIElmIHRoaXMgZmFpbHMsIGRvbid0IGhhbHQgYXV0aCBsb2FkaW5nXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyLl9pbml0aWFsaXplKHRoaXMpO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgLyogSWdub3JlIHRoZSBlcnJvciAqL1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZUN1cnJlbnRVc2VyKHBvcHVwUmVkaXJlY3RSZXNvbHZlcik7XG4gICAgICB0aGlzLmxhc3ROb3RpZmllZFVpZCA9IHRoaXMuY3VycmVudFVzZXI/LnVpZCB8fCBudWxsO1xuXG4gICAgICBpZiAodGhpcy5fZGVsZXRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2lzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMuX2luaXRpYWxpemF0aW9uUHJvbWlzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJZiB0aGUgcGVyc2lzdGVuY2UgaXMgY2hhbmdlZCBpbiBhbm90aGVyIHdpbmRvdywgdGhlIHVzZXIgbWFuYWdlciB3aWxsIGxldCB1cyBrbm93XG4gICAqL1xuICBhc3luYyBfb25TdG9yYWdlRXZlbnQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLmdldEN1cnJlbnRVc2VyKCk7XG5cbiAgICBpZiAoIXRoaXMuY3VycmVudFVzZXIgJiYgIXVzZXIpIHtcbiAgICAgIC8vIE5vIGNoYW5nZSwgZG8gbm90aGluZyAod2FzIHNpZ25lZCBvdXQgYW5kIHJlbWFpbmVkIHNpZ25lZCBvdXQpLlxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIElmIHRoZSBzYW1lIHVzZXIgaXMgdG8gYmUgc3luY2hyb25pemVkLlxuICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyICYmIHVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci51aWQgPT09IHVzZXIudWlkKSB7XG4gICAgICAvLyBEYXRhIHVwZGF0ZSwgc2ltcGx5IGNvcHkgZGF0YSBjaGFuZ2VzLlxuICAgICAgdGhpcy5fY3VycmVudFVzZXIuX2Fzc2lnbih1c2VyKTtcbiAgICAgIC8vIElmIHRva2VucyBjaGFuZ2VkIGZyb20gcHJldmlvdXMgdXNlciB0b2tlbnMsIHRoaXMgd2lsbCB0cmlnZ2VyXG4gICAgICAvLyBub3RpZnlBdXRoTGlzdGVuZXJzXy5cbiAgICAgIGF3YWl0IHRoaXMuY3VycmVudFVzZXIuZ2V0SWRUb2tlbigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBjdXJyZW50IEF1dGggc3RhdGUuIEVpdGhlciBhIG5ldyBsb2dpbiBvciBsb2dvdXQuXG4gICAgLy8gU2tpcCBibG9ja2luZyBjYWxsYmFja3MsIHRoZXkgc2hvdWxkIG5vdCBhcHBseSB0byBhIGNoYW5nZSBpbiBhbm90aGVyIHRhYi5cbiAgICBhd2FpdCB0aGlzLl91cGRhdGVDdXJyZW50VXNlcih1c2VyLCAvKiBza2lwQmVmb3JlU3RhdGVDYWxsYmFja3MgKi8gdHJ1ZSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVDdXJyZW50VXNlcihcbiAgICBwb3B1cFJlZGlyZWN0UmVzb2x2ZXI/OiBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gRmlyc3QgY2hlY2sgdG8gc2VlIGlmIHdlIGhhdmUgYSBwZW5kaW5nIHJlZGlyZWN0IGV2ZW50LlxuICAgIGNvbnN0IHByZXZpb3VzbHlTdG9yZWRVc2VyID1cbiAgICAgIChhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2UuZ2V0Q3VycmVudFVzZXIoKSkgYXMgVXNlckludGVybmFsIHwgbnVsbDtcbiAgICBsZXQgZnV0dXJlQ3VycmVudFVzZXIgPSBwcmV2aW91c2x5U3RvcmVkVXNlcjtcbiAgICBsZXQgbmVlZHNUb2NoZWNrTWlkZGxld2FyZSA9IGZhbHNlO1xuICAgIGlmIChwb3B1cFJlZGlyZWN0UmVzb2x2ZXIgJiYgdGhpcy5jb25maWcuYXV0aERvbWFpbikge1xuICAgICAgYXdhaXQgdGhpcy5nZXRPckluaXRSZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcigpO1xuICAgICAgY29uc3QgcmVkaXJlY3RVc2VyRXZlbnRJZCA9IHRoaXMucmVkaXJlY3RVc2VyPy5fcmVkaXJlY3RFdmVudElkO1xuICAgICAgY29uc3Qgc3RvcmVkVXNlckV2ZW50SWQgPSBmdXR1cmVDdXJyZW50VXNlcj8uX3JlZGlyZWN0RXZlbnRJZDtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMudHJ5UmVkaXJlY3RTaWduSW4ocG9wdXBSZWRpcmVjdFJlc29sdmVyKTtcblxuICAgICAgLy8gSWYgdGhlIHN0b3JlZCB1c2VyIChpLmUuIHRoZSBvbGQgXCJjdXJyZW50VXNlclwiKSBoYXMgYSByZWRpcmVjdElkIHRoYXRcbiAgICAgIC8vIG1hdGNoZXMgdGhlIHJlZGlyZWN0IHVzZXIsIHRoZW4gd2Ugd2FudCB0byBpbml0aWFsbHkgc2lnbiBpbiB3aXRoIHRoZVxuICAgICAgLy8gbmV3IHVzZXIgb2JqZWN0IGZyb20gcmVzdWx0LlxuICAgICAgLy8gVE9ETyhzYW1naG8pOiBNb3JlIHRob3JvdWdobHkgdGVzdCBhbGwgb2YgdGhpc1xuICAgICAgaWYgKFxuICAgICAgICAoIXJlZGlyZWN0VXNlckV2ZW50SWQgfHwgcmVkaXJlY3RVc2VyRXZlbnRJZCA9PT0gc3RvcmVkVXNlckV2ZW50SWQpICYmXG4gICAgICAgIHJlc3VsdD8udXNlclxuICAgICAgKSB7XG4gICAgICAgIGZ1dHVyZUN1cnJlbnRVc2VyID0gcmVzdWx0LnVzZXIgYXMgVXNlckludGVybmFsO1xuICAgICAgICBuZWVkc1RvY2hlY2tNaWRkbGV3YXJlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiBubyB1c2VyIGluIHBlcnNpc3RlbmNlLCB0aGVyZSBpcyBubyBjdXJyZW50IHVzZXIuIFNldCB0byBudWxsLlxuICAgIGlmICghZnV0dXJlQ3VycmVudFVzZXIpIHtcbiAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgfVxuXG4gICAgaWYgKCFmdXR1cmVDdXJyZW50VXNlci5fcmVkaXJlY3RFdmVudElkKSB7XG4gICAgICAvLyBUaGlzIGlzbid0IGEgcmVkaXJlY3QgbGluayBvcGVyYXRpb24sIHdlIGNhbiByZWxvYWQgYW5kIGJhaWwuXG4gICAgICAvLyBGaXJzdCB0aG91Z2gsIGVuc3VyZSB0aGF0IHdlIGNoZWNrIHRoZSBtaWRkbGV3YXJlIGlzIGhhcHB5LlxuICAgICAgaWYgKG5lZWRzVG9jaGVja01pZGRsZXdhcmUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBhd2FpdCB0aGlzLmJlZm9yZVN0YXRlUXVldWUucnVuTWlkZGxld2FyZShmdXR1cmVDdXJyZW50VXNlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBmdXR1cmVDdXJyZW50VXNlciA9IHByZXZpb3VzbHlTdG9yZWRVc2VyO1xuICAgICAgICAgIC8vIFdlIGtub3cgdGhpcyBpcyBhdmFpbGFibGUgc2luY2UgdGhlIGJpdCBpcyBvbmx5IHNldCB3aGVuIHRoZVxuICAgICAgICAgIC8vIHJlc29sdmVyIGlzIGF2YWlsYWJsZVxuICAgICAgICAgIHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciEuX292ZXJyaWRlUmVkaXJlY3RSZXN1bHQodGhpcywgKCkgPT5cbiAgICAgICAgICAgIFByb21pc2UucmVqZWN0KGUpXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoZnV0dXJlQ3VycmVudFVzZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVsb2FkQW5kU2V0Q3VycmVudFVzZXJPckNsZWFyKGZ1dHVyZUN1cnJlbnRVc2VyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIobnVsbCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgX2Fzc2VydCh0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIsIHRoaXMsIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IpO1xuICAgIGF3YWl0IHRoaXMuZ2V0T3JJbml0UmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXIoKTtcblxuICAgIC8vIElmIHRoZSByZWRpcmVjdCB1c2VyJ3MgZXZlbnQgSUQgbWF0Y2hlcyB0aGUgY3VycmVudCB1c2VyJ3MgZXZlbnQgSUQsXG4gICAgLy8gRE8gTk9UIHJlbG9hZCB0aGUgY3VycmVudCB1c2VyLCBvdGhlcndpc2UgdGhleSdsbCBiZSBjbGVhcmVkIGZyb20gc3RvcmFnZS5cbiAgICAvLyBUaGlzIGlzIGltcG9ydGFudCBmb3IgdGhlIHJlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0KCkgZmxvdy5cbiAgICBpZiAoXG4gICAgICB0aGlzLnJlZGlyZWN0VXNlciAmJlxuICAgICAgdGhpcy5yZWRpcmVjdFVzZXIuX3JlZGlyZWN0RXZlbnRJZCA9PT0gZnV0dXJlQ3VycmVudFVzZXIuX3JlZGlyZWN0RXZlbnRJZFxuICAgICkge1xuICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcihmdXR1cmVDdXJyZW50VXNlcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVsb2FkQW5kU2V0Q3VycmVudFVzZXJPckNsZWFyKGZ1dHVyZUN1cnJlbnRVc2VyKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgdHJ5UmVkaXJlY3RTaWduSW4oXG4gICAgcmVkaXJlY3RSZXNvbHZlcjogUG9wdXBSZWRpcmVjdFJlc29sdmVyXG4gICk6IFByb21pc2U8VXNlckNyZWRlbnRpYWwgfCBudWxsPiB7XG4gICAgLy8gVGhlIHJlZGlyZWN0IHVzZXIgbmVlZHMgdG8gYmUgY2hlY2tlZCAoYW5kIHNpZ25lZCBpbiBpZiBhdmFpbGFibGUpXG4gICAgLy8gZHVyaW5nIGF1dGggaW5pdGlhbGl6YXRpb24uIEFsbCBvZiB0aGUgbm9ybWFsIHNpZ24gaW4gYW5kIGxpbmsvcmVhdXRoXG4gICAgLy8gZmxvd3MgY2FsbCBiYWNrIGludG8gYXV0aCBhbmQgcHVzaCB0aGluZ3Mgb250byB0aGUgcHJvbWlzZSBxdWV1ZS4gV2VcbiAgICAvLyBuZWVkIHRvIGF3YWl0IHRoZSByZXN1bHQgb2YgdGhlIHJlZGlyZWN0IHNpZ24gaW4gKmluc2lkZSB0aGUgcHJvbWlzZVxuICAgIC8vIHF1ZXVlKi4gVGhpcyBwcmVzZW50cyBhIHByb2JsZW06IHdlIHJ1biBpbnRvIGRlYWRsb2NrLiBTZWU6XG4gICAgLy8gICAg4pSMPiBbSW5pdGlhbGl6YXRpb25dIOKUgOKUgOKUgOKUgOKUgOKUkFxuICAgIC8vICAgIOKUjD4gWzxvdGhlciBxdWV1ZSB0YXNrcz5dIOKUglxuICAgIC8vICAgIOKUlOKUgCBbZ2V0UmVkaXJlY3RSZXN1bHRdIDzilIDilJhcbiAgICAvLyAgICB3aGVyZSBbXSBhcmUgdGFza3Mgb24gdGhlIHF1ZXVlIGFuZCBhcnJvd3MgZGVub3RlIGF3YWl0c1xuICAgIC8vIEluaXRpYWxpemF0aW9uIHdpbGwgbmV2ZXIgY29tcGxldGUgYmVjYXVzZSBpdCdzIHdhaXRpbmcgb24gc29tZXRoaW5nXG4gICAgLy8gdGhhdCdzIHdhaXRpbmcgZm9yIGluaXRpYWxpemF0aW9uIHRvIGNvbXBsZXRlIVxuICAgIC8vXG4gICAgLy8gSW5zdGVhZCwgdGhpcyBtZXRob2QgY2FsbHMgZ2V0UmVkaXJlY3RSZXN1bHQoKSAoc3RvcmVkIGluXG4gICAgLy8gX2NvbXBsZXRlUmVkaXJlY3RGbikgd2l0aCBhbiBvcHRpb25hbCBwYXJhbWV0ZXIgdGhhdCBpbnN0cnVjdHMgYWxsIG9mXG4gICAgLy8gdGhlIHVuZGVybHlpbmcgYXV0aCBvcGVyYXRpb25zIHRvIHNraXAgYW55dGhpbmcgdGhhdCBtdXRhdGVzIGF1dGggc3RhdGUuXG5cbiAgICBsZXQgcmVzdWx0OiBVc2VyQ3JlZGVudGlhbCB8IG51bGwgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICAvLyBXZSBrbm93IHRoaXMuX3BvcHVwUmVkaXJlY3RSZXNvbHZlciBpcyBzZXQgc2luY2UgcmVkaXJlY3RSZXNvbHZlclxuICAgICAgLy8gaXMgcGFzc2VkIGluLiBUaGUgX2NvbXBsZXRlUmVkaXJlY3RGbiBleHBlY3RzIHRoZSB1bndyYXBwZWQgZXh0ZXJuLlxuICAgICAgcmVzdWx0ID0gYXdhaXQgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyIS5fY29tcGxldGVSZWRpcmVjdEZuKFxuICAgICAgICB0aGlzLFxuICAgICAgICByZWRpcmVjdFJlc29sdmVyLFxuICAgICAgICB0cnVlXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIFN3YWxsb3cgYW55IGVycm9ycyBoZXJlOyB0aGUgY29kZSBjYW4gcmV0cmlldmUgdGhlbSBpblxuICAgICAgLy8gZ2V0UmVkaXJlY3RSZXN1bHQoKS5cbiAgICAgIGF3YWl0IHRoaXMuX3NldFJlZGlyZWN0VXNlcihudWxsKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyByZWxvYWRBbmRTZXRDdXJyZW50VXNlck9yQ2xlYXIoXG4gICAgdXNlcjogVXNlckludGVybmFsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBfcmVsb2FkV2l0aG91dFNhdmluZyh1c2VyKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoXG4gICAgICAgIChlIGFzIEZpcmViYXNlRXJyb3IpPy5jb2RlICE9PVxuICAgICAgICBgYXV0aC8ke0F1dGhFcnJvckNvZGUuTkVUV09SS19SRVFVRVNUX0ZBSUxFRH1gXG4gICAgICApIHtcbiAgICAgICAgLy8gU29tZXRoaW5nJ3Mgd3Jvbmcgd2l0aCB0aGUgdXNlcidzIHRva2VuLiBMb2cgdGhlbSBvdXQgYW5kIHJlbW92ZVxuICAgICAgICAvLyB0aGVtIGZyb20gc3RvcmFnZVxuICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKG51bGwpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmRpcmVjdGx5U2V0Q3VycmVudFVzZXIodXNlcik7XG4gIH1cblxuICB1c2VEZXZpY2VMYW5ndWFnZSgpOiB2b2lkIHtcbiAgICB0aGlzLmxhbmd1YWdlQ29kZSA9IF9nZXRVc2VyTGFuZ3VhZ2UoKTtcbiAgfVxuXG4gIGFzeW5jIF9kZWxldGUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5fZGVsZXRlZCA9IHRydWU7XG4gIH1cblxuICBhc3luYyB1cGRhdGVDdXJyZW50VXNlcih1c2VyRXh0ZXJuOiBVc2VyIHwgbnVsbCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIFRoZSBwdWJsaWMgdXBkYXRlQ3VycmVudFVzZXIgbWV0aG9kIG5lZWRzIHRvIG1ha2UgYSBjb3B5IG9mIHRoZSB1c2VyLFxuICAgIC8vIGFuZCBhbHNvIGNoZWNrIHRoYXQgdGhlIHByb2plY3QgbWF0Y2hlc1xuICAgIGNvbnN0IHVzZXIgPSB1c2VyRXh0ZXJuXG4gICAgICA/IChnZXRNb2R1bGFySW5zdGFuY2UodXNlckV4dGVybikgYXMgVXNlckludGVybmFsKVxuICAgICAgOiBudWxsO1xuICAgIGlmICh1c2VyKSB7XG4gICAgICBfYXNzZXJ0KFxuICAgICAgICB1c2VyLmF1dGguY29uZmlnLmFwaUtleSA9PT0gdGhpcy5jb25maWcuYXBpS2V5LFxuICAgICAgICB0aGlzLFxuICAgICAgICBBdXRoRXJyb3JDb2RlLklOVkFMSURfQVVUSFxuICAgICAgKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXIgJiYgdXNlci5fY2xvbmUodGhpcykpO1xuICB9XG5cbiAgYXN5bmMgX3VwZGF0ZUN1cnJlbnRVc2VyKFxuICAgIHVzZXI6IFVzZXIgfCBudWxsLFxuICAgIHNraXBCZWZvcmVTdGF0ZUNhbGxiYWNrczogYm9vbGVhbiA9IGZhbHNlXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLl9kZWxldGVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh1c2VyKSB7XG4gICAgICBfYXNzZXJ0KFxuICAgICAgICB0aGlzLnRlbmFudElkID09PSB1c2VyLnRlbmFudElkLFxuICAgICAgICB0aGlzLFxuICAgICAgICBBdXRoRXJyb3JDb2RlLlRFTkFOVF9JRF9NSVNNQVRDSFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoIXNraXBCZWZvcmVTdGF0ZUNhbGxiYWNrcykge1xuICAgICAgYXdhaXQgdGhpcy5iZWZvcmVTdGF0ZVF1ZXVlLnJ1bk1pZGRsZXdhcmUodXNlcik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucXVldWUoYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgdGhpcy5kaXJlY3RseVNldEN1cnJlbnRVc2VyKHVzZXIgYXMgVXNlckludGVybmFsIHwgbnVsbCk7XG4gICAgICB0aGlzLm5vdGlmeUF1dGhMaXN0ZW5lcnMoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHNpZ25PdXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gUnVuIGZpcnN0LCB0byBibG9jayBfc2V0UmVkaXJlY3RVc2VyKCkgaWYgYW55IGNhbGxiYWNrcyBmYWlsLlxuICAgIGF3YWl0IHRoaXMuYmVmb3JlU3RhdGVRdWV1ZS5ydW5NaWRkbGV3YXJlKG51bGwpO1xuICAgIC8vIENsZWFyIHRoZSByZWRpcmVjdCB1c2VyIHdoZW4gc2lnbk91dCBpcyBjYWxsZWRcbiAgICBpZiAodGhpcy5yZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlciB8fCB0aGlzLl9wb3B1cFJlZGlyZWN0UmVzb2x2ZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuX3NldFJlZGlyZWN0VXNlcihudWxsKTtcbiAgICB9XG5cbiAgICAvLyBQcmV2ZW50IGNhbGxiYWNrcyBmcm9tIGJlaW5nIGNhbGxlZCBhZ2FpbiBpbiBfdXBkYXRlQ3VycmVudFVzZXIsIGFzXG4gICAgLy8gdGhleSB3ZXJlIGFscmVhZHkgY2FsbGVkIGluIHRoZSBmaXJzdCBsaW5lLlxuICAgIHJldHVybiB0aGlzLl91cGRhdGVDdXJyZW50VXNlcihudWxsLCAvKiBza2lwQmVmb3JlU3RhdGVDYWxsYmFja3MgKi8gdHJ1ZSk7XG4gIH1cblxuICBzZXRQZXJzaXN0ZW5jZShwZXJzaXN0ZW5jZTogUGVyc2lzdGVuY2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5xdWV1ZShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCB0aGlzLmFzc2VydGVkUGVyc2lzdGVuY2Uuc2V0UGVyc2lzdGVuY2UoX2dldEluc3RhbmNlKHBlcnNpc3RlbmNlKSk7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBpbml0aWFsaXplUmVjYXB0Y2hhQ29uZmlnKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZ2V0UmVjYXB0Y2hhQ29uZmlnKHRoaXMsIHtcbiAgICAgIGNsaWVudFR5cGU6IFJlY2FwdGNoYUNsaWVudFR5cGUuV0VCLFxuICAgICAgdmVyc2lvbjogUmVjYXB0Y2hhVmVyc2lvbi5FTlRFUlBSSVNFXG4gICAgfSk7XG5cbiAgICBjb25zdCBjb25maWcgPSBuZXcgUmVjYXB0Y2hhQ29uZmlnKHJlc3BvbnNlKTtcbiAgICBpZiAodGhpcy50ZW5hbnRJZCA9PSBudWxsKSB7XG4gICAgICB0aGlzLl9hZ2VudFJlY2FwdGNoYUNvbmZpZyA9IGNvbmZpZztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fdGVuYW50UmVjYXB0Y2hhQ29uZmlnc1t0aGlzLnRlbmFudElkXSA9IGNvbmZpZztcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLmVtYWlsUGFzc3dvcmRFbmFibGVkKSB7XG4gICAgICBjb25zdCB2ZXJpZmllciA9IG5ldyBSZWNhcHRjaGFFbnRlcnByaXNlVmVyaWZpZXIodGhpcyk7XG4gICAgICB2b2lkIHZlcmlmaWVyLnZlcmlmeSgpO1xuICAgIH1cbiAgfVxuXG4gIF9nZXRSZWNhcHRjaGFDb25maWcoKTogUmVjYXB0Y2hhQ29uZmlnIHwgbnVsbCB7XG4gICAgaWYgKHRoaXMudGVuYW50SWQgPT0gbnVsbCkge1xuICAgICAgcmV0dXJuIHRoaXMuX2FnZW50UmVjYXB0Y2hhQ29uZmlnO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5fdGVuYW50UmVjYXB0Y2hhQ29uZmlnc1t0aGlzLnRlbmFudElkXTtcbiAgICB9XG4gIH1cblxuICBfZ2V0UGVyc2lzdGVuY2UoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLnBlcnNpc3RlbmNlLnR5cGU7XG4gIH1cblxuICBfdXBkYXRlRXJyb3JNYXAoZXJyb3JNYXA6IEF1dGhFcnJvck1hcCk6IHZvaWQge1xuICAgIHRoaXMuX2Vycm9yRmFjdG9yeSA9IG5ldyBFcnJvckZhY3Rvcnk8QXV0aEVycm9yQ29kZSwgQXV0aEVycm9yUGFyYW1zPihcbiAgICAgICdhdXRoJyxcbiAgICAgICdGaXJlYmFzZScsXG4gICAgICAoZXJyb3JNYXAgYXMgRXJyb3JNYXBSZXRyaWV2ZXIpKClcbiAgICApO1xuICB9XG5cbiAgb25BdXRoU3RhdGVDaGFuZ2VkKFxuICAgIG5leHRPck9ic2VydmVyOiBOZXh0T3JPYnNlcnZlcjxVc2VyPixcbiAgICBlcnJvcj86IEVycm9yRm4sXG4gICAgY29tcGxldGVkPzogQ29tcGxldGVGblxuICApOiBVbnN1YnNjcmliZSB7XG4gICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJTdGF0ZUxpc3RlbmVyKFxuICAgICAgdGhpcy5hdXRoU3RhdGVTdWJzY3JpcHRpb24sXG4gICAgICBuZXh0T3JPYnNlcnZlcixcbiAgICAgIGVycm9yLFxuICAgICAgY29tcGxldGVkXG4gICAgKTtcbiAgfVxuXG4gIGJlZm9yZUF1dGhTdGF0ZUNoYW5nZWQoXG4gICAgY2FsbGJhY2s6ICh1c2VyOiBVc2VyIHwgbnVsbCkgPT4gdm9pZCB8IFByb21pc2U8dm9pZD4sXG4gICAgb25BYm9ydD86ICgpID0+IHZvaWRcbiAgKTogVW5zdWJzY3JpYmUge1xuICAgIHJldHVybiB0aGlzLmJlZm9yZVN0YXRlUXVldWUucHVzaENhbGxiYWNrKGNhbGxiYWNrLCBvbkFib3J0KTtcbiAgfVxuXG4gIG9uSWRUb2tlbkNoYW5nZWQoXG4gICAgbmV4dE9yT2JzZXJ2ZXI6IE5leHRPck9ic2VydmVyPFVzZXI+LFxuICAgIGVycm9yPzogRXJyb3JGbixcbiAgICBjb21wbGV0ZWQ/OiBDb21wbGV0ZUZuXG4gICk6IFVuc3Vic2NyaWJlIHtcbiAgICByZXR1cm4gdGhpcy5yZWdpc3RlclN0YXRlTGlzdGVuZXIoXG4gICAgICB0aGlzLmlkVG9rZW5TdWJzY3JpcHRpb24sXG4gICAgICBuZXh0T3JPYnNlcnZlcixcbiAgICAgIGVycm9yLFxuICAgICAgY29tcGxldGVkXG4gICAgKTtcbiAgfVxuXG4gIGF1dGhTdGF0ZVJlYWR5KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAodGhpcy5jdXJyZW50VXNlcikge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB1bnN1YnNjcmliZSA9IHRoaXMub25BdXRoU3RhdGVDaGFuZ2VkKCgpID0+IHtcbiAgICAgICAgICB1bnN1YnNjcmliZSgpO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSwgcmVqZWN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHRvSlNPTigpOiBvYmplY3Qge1xuICAgIHJldHVybiB7XG4gICAgICBhcGlLZXk6IHRoaXMuY29uZmlnLmFwaUtleSxcbiAgICAgIGF1dGhEb21haW46IHRoaXMuY29uZmlnLmF1dGhEb21haW4sXG4gICAgICBhcHBOYW1lOiB0aGlzLm5hbWUsXG4gICAgICBjdXJyZW50VXNlcjogdGhpcy5fY3VycmVudFVzZXI/LnRvSlNPTigpXG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIF9zZXRSZWRpcmVjdFVzZXIoXG4gICAgdXNlcjogVXNlckludGVybmFsIHwgbnVsbCxcbiAgICBwb3B1cFJlZGlyZWN0UmVzb2x2ZXI/OiBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJcbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVkaXJlY3RNYW5hZ2VyID0gYXdhaXQgdGhpcy5nZXRPckluaXRSZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcihcbiAgICAgIHBvcHVwUmVkaXJlY3RSZXNvbHZlclxuICAgICk7XG4gICAgcmV0dXJuIHVzZXIgPT09IG51bGxcbiAgICAgID8gcmVkaXJlY3RNYW5hZ2VyLnJlbW92ZUN1cnJlbnRVc2VyKClcbiAgICAgIDogcmVkaXJlY3RNYW5hZ2VyLnNldEN1cnJlbnRVc2VyKHVzZXIpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRPckluaXRSZWRpcmVjdFBlcnNpc3RlbmNlTWFuYWdlcihcbiAgICBwb3B1cFJlZGlyZWN0UmVzb2x2ZXI/OiBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJcbiAgKTogUHJvbWlzZTxQZXJzaXN0ZW5jZVVzZXJNYW5hZ2VyPiB7XG4gICAgaWYgKCF0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyKSB7XG4gICAgICBjb25zdCByZXNvbHZlcjogUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWwgfCBudWxsID1cbiAgICAgICAgKHBvcHVwUmVkaXJlY3RSZXNvbHZlciAmJiBfZ2V0SW5zdGFuY2UocG9wdXBSZWRpcmVjdFJlc29sdmVyKSkgfHxcbiAgICAgICAgdGhpcy5fcG9wdXBSZWRpcmVjdFJlc29sdmVyO1xuICAgICAgX2Fzc2VydChyZXNvbHZlciwgdGhpcywgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUik7XG4gICAgICB0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyID0gYXdhaXQgUGVyc2lzdGVuY2VVc2VyTWFuYWdlci5jcmVhdGUoXG4gICAgICAgIHRoaXMsXG4gICAgICAgIFtfZ2V0SW5zdGFuY2UocmVzb2x2ZXIuX3JlZGlyZWN0UGVyc2lzdGVuY2UpXSxcbiAgICAgICAgS2V5TmFtZS5SRURJUkVDVF9VU0VSXG4gICAgICApO1xuICAgICAgdGhpcy5yZWRpcmVjdFVzZXIgPVxuICAgICAgICBhd2FpdCB0aGlzLnJlZGlyZWN0UGVyc2lzdGVuY2VNYW5hZ2VyLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucmVkaXJlY3RQZXJzaXN0ZW5jZU1hbmFnZXI7XG4gIH1cblxuICBhc3luYyBfcmVkaXJlY3RVc2VyRm9ySWQoaWQ6IHN0cmluZyk6IFByb21pc2U8VXNlckludGVybmFsIHwgbnVsbD4ge1xuICAgIC8vIE1ha2Ugc3VyZSB3ZSd2ZSBjbGVhcmVkIGFueSBwZW5kaW5nIHBlcnNpc3RlbmNlIGFjdGlvbnMgaWYgd2UncmUgbm90IGluXG4gICAgLy8gdGhlIGluaXRpYWxpemVyXG4gICAgaWYgKHRoaXMuX2lzSW5pdGlhbGl6ZWQpIHtcbiAgICAgIGF3YWl0IHRoaXMucXVldWUoYXN5bmMgKCkgPT4ge30pO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9jdXJyZW50VXNlcj8uX3JlZGlyZWN0RXZlbnRJZCA9PT0gaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50VXNlcjtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5yZWRpcmVjdFVzZXI/Ll9yZWRpcmVjdEV2ZW50SWQgPT09IGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZWRpcmVjdFVzZXI7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBhc3luYyBfcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlcjogVXNlckludGVybmFsKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHVzZXIgPT09IHRoaXMuY3VycmVudFVzZXIpIHtcbiAgICAgIHJldHVybiB0aGlzLnF1ZXVlKGFzeW5jICgpID0+IHRoaXMuZGlyZWN0bHlTZXRDdXJyZW50VXNlcih1c2VyKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqIE5vdGlmaWVzIGxpc3RlbmVycyBvbmx5IGlmIHRoZSB1c2VyIGlzIGN1cnJlbnQgKi9cbiAgX25vdGlmeUxpc3RlbmVyc0lmQ3VycmVudCh1c2VyOiBVc2VySW50ZXJuYWwpOiB2b2lkIHtcbiAgICBpZiAodXNlciA9PT0gdGhpcy5jdXJyZW50VXNlcikge1xuICAgICAgdGhpcy5ub3RpZnlBdXRoTGlzdGVuZXJzKCk7XG4gICAgfVxuICB9XG5cbiAgX2tleSgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHt0aGlzLmNvbmZpZy5hdXRoRG9tYWlufToke3RoaXMuY29uZmlnLmFwaUtleX06JHt0aGlzLm5hbWV9YDtcbiAgfVxuXG4gIF9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTogdm9pZCB7XG4gICAgdGhpcy5pc1Byb2FjdGl2ZVJlZnJlc2hFbmFibGVkID0gdHJ1ZTtcbiAgICBpZiAodGhpcy5jdXJyZW50VXNlcikge1xuICAgICAgdGhpcy5fY3VycmVudFVzZXIuX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIF9zdG9wUHJvYWN0aXZlUmVmcmVzaCgpOiB2b2lkIHtcbiAgICB0aGlzLmlzUHJvYWN0aXZlUmVmcmVzaEVuYWJsZWQgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5jdXJyZW50VXNlcikge1xuICAgICAgdGhpcy5fY3VycmVudFVzZXIuX3N0b3BQcm9hY3RpdmVSZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIFJldHVybnMgdGhlIGN1cnJlbnQgdXNlciBjYXN0IGFzIHRoZSBpbnRlcm5hbCB0eXBlICovXG4gIGdldCBfY3VycmVudFVzZXIoKTogVXNlckludGVybmFsIHtcbiAgICByZXR1cm4gdGhpcy5jdXJyZW50VXNlciBhcyBVc2VySW50ZXJuYWw7XG4gIH1cblxuICBwcml2YXRlIG5vdGlmeUF1dGhMaXN0ZW5lcnMoKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLl9pc0luaXRpYWxpemVkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pZFRva2VuU3Vic2NyaXB0aW9uLm5leHQodGhpcy5jdXJyZW50VXNlcik7XG5cbiAgICBjb25zdCBjdXJyZW50VWlkID0gdGhpcy5jdXJyZW50VXNlcj8udWlkID8/IG51bGw7XG4gICAgaWYgKHRoaXMubGFzdE5vdGlmaWVkVWlkICE9PSBjdXJyZW50VWlkKSB7XG4gICAgICB0aGlzLmxhc3ROb3RpZmllZFVpZCA9IGN1cnJlbnRVaWQ7XG4gICAgICB0aGlzLmF1dGhTdGF0ZVN1YnNjcmlwdGlvbi5uZXh0KHRoaXMuY3VycmVudFVzZXIpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcmVnaXN0ZXJTdGF0ZUxpc3RlbmVyKFxuICAgIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uPFVzZXI+LFxuICAgIG5leHRPck9ic2VydmVyOiBOZXh0T3JPYnNlcnZlcjxVc2VyPixcbiAgICBlcnJvcj86IEVycm9yRm4sXG4gICAgY29tcGxldGVkPzogQ29tcGxldGVGblxuICApOiBVbnN1YnNjcmliZSB7XG4gICAgaWYgKHRoaXMuX2RlbGV0ZWQpIHtcbiAgICAgIHJldHVybiAoKSA9PiB7fTtcbiAgICB9XG5cbiAgICBjb25zdCBjYiA9XG4gICAgICB0eXBlb2YgbmV4dE9yT2JzZXJ2ZXIgPT09ICdmdW5jdGlvbidcbiAgICAgICAgPyBuZXh0T3JPYnNlcnZlclxuICAgICAgICA6IG5leHRPck9ic2VydmVyLm5leHQuYmluZChuZXh0T3JPYnNlcnZlcik7XG5cbiAgICBjb25zdCBwcm9taXNlID0gdGhpcy5faXNJbml0aWFsaXplZFxuICAgICAgPyBQcm9taXNlLnJlc29sdmUoKVxuICAgICAgOiB0aGlzLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gICAgX2Fzc2VydChwcm9taXNlLCB0aGlzLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgICAvLyBUaGUgY2FsbGJhY2sgbmVlZHMgdG8gYmUgY2FsbGVkIGFzeW5jaHJvbm91c2x5IHBlciB0aGUgc3BlYy5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgcHJvbWlzZS50aGVuKCgpID0+IGNiKHRoaXMuY3VycmVudFVzZXIpKTtcblxuICAgIGlmICh0eXBlb2YgbmV4dE9yT2JzZXJ2ZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJldHVybiBzdWJzY3JpcHRpb24uYWRkT2JzZXJ2ZXIobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gc3Vic2NyaXB0aW9uLmFkZE9ic2VydmVyKG5leHRPck9ic2VydmVyKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVW5wcm90ZWN0ZWQgKGZyb20gcmFjZSBjb25kaXRpb25zKSBtZXRob2QgdG8gc2V0IHRoZSBjdXJyZW50IHVzZXIuIFRoaXNcbiAgICogc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGZyb20gd2l0aGluIGEgcXVldWVkIGNhbGxiYWNrLiBUaGlzIGlzIG5lY2Vzc2FyeVxuICAgKiBiZWNhdXNlIHRoZSBxdWV1ZSBzaG91bGRuJ3QgcmVseSBvbiBhbm90aGVyIHF1ZXVlZCBjYWxsYmFjay5cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZGlyZWN0bHlTZXRDdXJyZW50VXNlcihcbiAgICB1c2VyOiBVc2VySW50ZXJuYWwgfCBudWxsXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLmN1cnJlbnRVc2VyICYmIHRoaXMuY3VycmVudFVzZXIgIT09IHVzZXIpIHtcbiAgICAgIHRoaXMuX2N1cnJlbnRVc2VyLl9zdG9wUHJvYWN0aXZlUmVmcmVzaCgpO1xuICAgIH1cbiAgICBpZiAodXNlciAmJiB0aGlzLmlzUHJvYWN0aXZlUmVmcmVzaEVuYWJsZWQpIHtcbiAgICAgIHVzZXIuX3N0YXJ0UHJvYWN0aXZlUmVmcmVzaCgpO1xuICAgIH1cblxuICAgIHRoaXMuY3VycmVudFVzZXIgPSB1c2VyO1xuXG4gICAgaWYgKHVzZXIpIHtcbiAgICAgIGF3YWl0IHRoaXMuYXNzZXJ0ZWRQZXJzaXN0ZW5jZS5zZXRDdXJyZW50VXNlcih1c2VyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYXdhaXQgdGhpcy5hc3NlcnRlZFBlcnNpc3RlbmNlLnJlbW92ZUN1cnJlbnRVc2VyKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBxdWV1ZShhY3Rpb246IEFzeW5jQWN0aW9uKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgLy8gSW4gY2FzZSBzb21ldGhpbmcgZXJyb3JzLCB0aGUgY2FsbGJhY2sgc3RpbGwgc2hvdWxkIGJlIGNhbGxlZCBpbiBvcmRlclxuICAgIC8vIHRvIGtlZXAgdGhlIHByb21pc2UgY2hhaW4gYWxpdmVcbiAgICB0aGlzLm9wZXJhdGlvbnMgPSB0aGlzLm9wZXJhdGlvbnMudGhlbihhY3Rpb24sIGFjdGlvbik7XG4gICAgcmV0dXJuIHRoaXMub3BlcmF0aW9ucztcbiAgfVxuXG4gIHByaXZhdGUgZ2V0IGFzc2VydGVkUGVyc2lzdGVuY2UoKTogUGVyc2lzdGVuY2VVc2VyTWFuYWdlciB7XG4gICAgX2Fzc2VydCh0aGlzLnBlcnNpc3RlbmNlTWFuYWdlciwgdGhpcywgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2VNYW5hZ2VyO1xuICB9XG5cbiAgcHJpdmF0ZSBmcmFtZXdvcmtzOiBzdHJpbmdbXSA9IFtdO1xuICBwcml2YXRlIGNsaWVudFZlcnNpb246IHN0cmluZztcbiAgX2xvZ0ZyYW1ld29yayhmcmFtZXdvcms6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICghZnJhbWV3b3JrIHx8IHRoaXMuZnJhbWV3b3Jrcy5pbmNsdWRlcyhmcmFtZXdvcmspKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuZnJhbWV3b3Jrcy5wdXNoKGZyYW1ld29yayk7XG5cbiAgICAvLyBTb3J0IGFscGhhYmV0aWNhbGx5IHNvIHRoYXQgXCJGaXJlYmFzZUNvcmUtd2ViLEZpcmViYXNlVUktd2ViXCIgYW5kXG4gICAgLy8gXCJGaXJlYmFzZVVJLXdlYixGaXJlYmFzZUNvcmUtd2ViXCIgYXJlbid0IHZpZXdlZCBhcyBkaWZmZXJlbnQuXG4gICAgdGhpcy5mcmFtZXdvcmtzLnNvcnQoKTtcbiAgICB0aGlzLmNsaWVudFZlcnNpb24gPSBfZ2V0Q2xpZW50VmVyc2lvbihcbiAgICAgIHRoaXMuY29uZmlnLmNsaWVudFBsYXRmb3JtLFxuICAgICAgdGhpcy5fZ2V0RnJhbWV3b3JrcygpXG4gICAgKTtcbiAgfVxuICBfZ2V0RnJhbWV3b3JrcygpOiByZWFkb25seSBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuZnJhbWV3b3JrcztcbiAgfVxuICBhc3luYyBfZ2V0QWRkaXRpb25hbEhlYWRlcnMoKTogUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+PiB7XG4gICAgLy8gQWRkaXRpb25hbCBoZWFkZXJzIG9uIGV2ZXJ5IHJlcXVlc3RcbiAgICBjb25zdCBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgW0h0dHBIZWFkZXIuWF9DTElFTlRfVkVSU0lPTl06IHRoaXMuY2xpZW50VmVyc2lvblxuICAgIH07XG5cbiAgICBpZiAodGhpcy5hcHAub3B0aW9ucy5hcHBJZCkge1xuICAgICAgaGVhZGVyc1tIdHRwSGVhZGVyLlhfRklSRUJBU0VfR01QSURdID0gdGhpcy5hcHAub3B0aW9ucy5hcHBJZDtcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgaGVhcnRiZWF0IHNlcnZpY2UgZXhpc3RzLCBhZGQgdGhlIGhlYXJ0YmVhdCBzdHJpbmdcbiAgICBjb25zdCBoZWFydGJlYXRzSGVhZGVyID0gYXdhaXQgdGhpcy5oZWFydGJlYXRTZXJ2aWNlUHJvdmlkZXJcbiAgICAgIC5nZXRJbW1lZGlhdGUoe1xuICAgICAgICBvcHRpb25hbDogdHJ1ZVxuICAgICAgfSlcbiAgICAgID8uZ2V0SGVhcnRiZWF0c0hlYWRlcigpO1xuICAgIGlmIChoZWFydGJlYXRzSGVhZGVyKSB7XG4gICAgICBoZWFkZXJzW0h0dHBIZWFkZXIuWF9GSVJFQkFTRV9DTElFTlRdID0gaGVhcnRiZWF0c0hlYWRlcjtcbiAgICB9XG5cbiAgICAvLyBJZiB0aGUgQXBwIENoZWNrIHNlcnZpY2UgZXhpc3RzLCBhZGQgdGhlIEFwcCBDaGVjayB0b2tlbiBpbiB0aGUgaGVhZGVyc1xuICAgIGNvbnN0IGFwcENoZWNrVG9rZW4gPSBhd2FpdCB0aGlzLl9nZXRBcHBDaGVja1Rva2VuKCk7XG4gICAgaWYgKGFwcENoZWNrVG9rZW4pIHtcbiAgICAgIGhlYWRlcnNbSHR0cEhlYWRlci5YX0ZJUkVCQVNFX0FQUF9DSEVDS10gPSBhcHBDaGVja1Rva2VuO1xuICAgIH1cblxuICAgIHJldHVybiBoZWFkZXJzO1xuICB9XG5cbiAgYXN5bmMgX2dldEFwcENoZWNrVG9rZW4oKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICBjb25zdCBhcHBDaGVja1Rva2VuUmVzdWx0ID0gYXdhaXQgdGhpcy5hcHBDaGVja1NlcnZpY2VQcm92aWRlclxuICAgICAgLmdldEltbWVkaWF0ZSh7IG9wdGlvbmFsOiB0cnVlIH0pXG4gICAgICA/LmdldFRva2VuKCk7XG4gICAgaWYgKGFwcENoZWNrVG9rZW5SZXN1bHQ/LmVycm9yKSB7XG4gICAgICAvLyBDb250ZXh0OiBhcHBDaGVjay5nZXRUb2tlbigpIHdpbGwgbmV2ZXIgdGhyb3cgZXZlbiBpZiBhbiBlcnJvciBoYXBwZW5lZC5cbiAgICAgIC8vIEluIHRoZSBlcnJvciBjYXNlLCBhIGR1bW15IHRva2VuIHdpbGwgYmUgcmV0dXJuZWQgYWxvbmcgd2l0aCBhbiBlcnJvciBmaWVsZCBkZXNjcmliaW5nXG4gICAgICAvLyB0aGUgZXJyb3IuIEluIGdlbmVyYWwsIHdlIHNob3VsZG4ndCBjYXJlIGFib3V0IHRoZSBlcnJvciBjb25kaXRpb24gYW5kIGp1c3QgdXNlXG4gICAgICAvLyB0aGUgdG9rZW4gKGFjdHVhbCBvciBkdW1teSkgdG8gc2VuZCByZXF1ZXN0cy5cbiAgICAgIF9sb2dXYXJuKFxuICAgICAgICBgRXJyb3Igd2hpbGUgcmV0cmlldmluZyBBcHAgQ2hlY2sgdG9rZW46ICR7YXBwQ2hlY2tUb2tlblJlc3VsdC5lcnJvcn1gXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gYXBwQ2hlY2tUb2tlblJlc3VsdD8udG9rZW47XG4gIH1cbn1cblxuLyoqXG4gKiBNZXRob2QgdG8gYmUgdXNlZCB0byBjYXN0IGRvd24gdG8gb3VyIHByaXZhdGUgaW1wbG1lbnRhdGlvbiBvZiBBdXRoLlxuICogSXQgd2lsbCBhbHNvIGhhbmRsZSB1bndyYXBwaW5nIGZyb20gdGhlIGNvbXBhdCB0eXBlIGlmIG5lY2Vzc2FyeVxuICpcbiAqIEBwYXJhbSBhdXRoIEF1dGggb2JqZWN0IHBhc3NlZCBpbiBmcm9tIGRldmVsb3BlclxuICovXG5leHBvcnQgZnVuY3Rpb24gX2Nhc3RBdXRoKGF1dGg6IEF1dGgpOiBBdXRoSW50ZXJuYWwge1xuICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpIGFzIEF1dGhJbnRlcm5hbDtcbn1cblxuLyoqIEhlbHBlciBjbGFzcyB0byB3cmFwIHN1YnNjcmliZXIgbG9naWMgKi9cbmNsYXNzIFN1YnNjcmlwdGlvbjxUPiB7XG4gIHByaXZhdGUgb2JzZXJ2ZXI6IE9ic2VydmVyPFQgfCBudWxsPiB8IG51bGwgPSBudWxsO1xuICByZWFkb25seSBhZGRPYnNlcnZlcjogU3Vic2NyaWJlPFQgfCBudWxsPiA9IGNyZWF0ZVN1YnNjcmliZShcbiAgICBvYnNlcnZlciA9PiAodGhpcy5vYnNlcnZlciA9IG9ic2VydmVyKVxuICApO1xuXG4gIGNvbnN0cnVjdG9yKHJlYWRvbmx5IGF1dGg6IEF1dGhJbnRlcm5hbCkge31cblxuICBnZXQgbmV4dCgpOiBOZXh0Rm48VCB8IG51bGw+IHtcbiAgICBfYXNzZXJ0KHRoaXMub2JzZXJ2ZXIsIHRoaXMuYXV0aCwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gICAgcmV0dXJuIHRoaXMub2JzZXJ2ZXIubmV4dC5iaW5kKHRoaXMub2JzZXJ2ZXIpO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgX2dldFByb3ZpZGVyLCBGaXJlYmFzZUFwcCB9IGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuaW1wb3J0IHsgZGVlcEVxdWFsIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgQXV0aCwgRGVwZW5kZW5jaWVzIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5pbXBvcnQgeyBQZXJzaXN0ZW5jZUludGVybmFsIH0gZnJvbSAnLi4vcGVyc2lzdGVuY2UnO1xuaW1wb3J0IHsgX2ZhaWwgfSBmcm9tICcuLi91dGlsL2Fzc2VydCc7XG5pbXBvcnQgeyBfZ2V0SW5zdGFuY2UgfSBmcm9tICcuLi91dGlsL2luc3RhbnRpYXRvcic7XG5pbXBvcnQgeyBBdXRoSW1wbCB9IGZyb20gJy4vYXV0aF9pbXBsJztcblxuLyoqXG4gKiBJbml0aWFsaXplcyBhbiB7QGxpbmsgQXV0aH0gaW5zdGFuY2Ugd2l0aCBmaW5lLWdyYWluZWQgY29udHJvbCBvdmVyXG4gKiB7QGxpbmsgRGVwZW5kZW5jaWVzfS5cbiAqXG4gKiBAcmVtYXJrc1xuICpcbiAqIFRoaXMgZnVuY3Rpb24gYWxsb3dzIG1vcmUgY29udHJvbCBvdmVyIHRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgdGhhblxuICoge0BsaW5rIGdldEF1dGh9LiBgZ2V0QXV0aGAgdXNlcyBwbGF0Zm9ybS1zcGVjaWZpYyBkZWZhdWx0cyB0byBzdXBwbHlcbiAqIHRoZSB7QGxpbmsgRGVwZW5kZW5jaWVzfS4gSW4gZ2VuZXJhbCwgYGdldEF1dGhgIGlzIHRoZSBlYXNpZXN0IHdheSB0b1xuICogaW5pdGlhbGl6ZSBBdXRoIGFuZCB3b3JrcyBmb3IgbW9zdCB1c2UgY2FzZXMuIFVzZSBgaW5pdGlhbGl6ZUF1dGhgIGlmIHlvdVxuICogbmVlZCBjb250cm9sIG92ZXIgd2hpY2ggcGVyc2lzdGVuY2UgbGF5ZXIgaXMgdXNlZCwgb3IgdG8gbWluaW1pemUgYnVuZGxlXG4gKiBzaXplIGlmIHlvdSdyZSBub3QgdXNpbmcgZWl0aGVyIGBzaWduSW5XaXRoUG9wdXBgIG9yIGBzaWduSW5XaXRoUmVkaXJlY3RgLlxuICpcbiAqIEZvciBleGFtcGxlLCBpZiB5b3VyIGFwcCBvbmx5IHVzZXMgYW5vbnltb3VzIGFjY291bnRzIGFuZCB5b3Ugb25seSB3YW50XG4gKiBhY2NvdW50cyBzYXZlZCBmb3IgdGhlIGN1cnJlbnQgc2Vzc2lvbiwgaW5pdGlhbGl6ZSBgQXV0aGAgd2l0aDpcbiAqXG4gKiBgYGBqc1xuICogY29uc3QgYXV0aCA9IGluaXRpYWxpemVBdXRoKGFwcCwge1xuICogICBwZXJzaXN0ZW5jZTogYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSxcbiAqICAgcG9wdXBSZWRpcmVjdFJlc29sdmVyOiB1bmRlZmluZWQsXG4gKiB9KTtcbiAqIGBgYFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluaXRpYWxpemVBdXRoKGFwcDogRmlyZWJhc2VBcHAsIGRlcHM/OiBEZXBlbmRlbmNpZXMpOiBBdXRoIHtcbiAgY29uc3QgcHJvdmlkZXIgPSBfZ2V0UHJvdmlkZXIoYXBwLCAnYXV0aCcpO1xuXG4gIGlmIChwcm92aWRlci5pc0luaXRpYWxpemVkKCkpIHtcbiAgICBjb25zdCBhdXRoID0gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCkgYXMgQXV0aEltcGw7XG4gICAgY29uc3QgaW5pdGlhbE9wdGlvbnMgPSBwcm92aWRlci5nZXRPcHRpb25zKCkgYXMgRGVwZW5kZW5jaWVzO1xuICAgIGlmIChkZWVwRXF1YWwoaW5pdGlhbE9wdGlvbnMsIGRlcHMgPz8ge30pKSB7XG4gICAgICByZXR1cm4gYXV0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgX2ZhaWwoYXV0aCwgQXV0aEVycm9yQ29kZS5BTFJFQURZX0lOSVRJQUxJWkVEKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBhdXRoID0gcHJvdmlkZXIuaW5pdGlhbGl6ZSh7IG9wdGlvbnM6IGRlcHMgfSkgYXMgQXV0aEltcGw7XG5cbiAgcmV0dXJuIGF1dGg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfaW5pdGlhbGl6ZUF1dGhJbnN0YW5jZShcbiAgYXV0aDogQXV0aEltcGwsXG4gIGRlcHM/OiBEZXBlbmRlbmNpZXNcbik6IHZvaWQge1xuICBjb25zdCBwZXJzaXN0ZW5jZSA9IGRlcHM/LnBlcnNpc3RlbmNlIHx8IFtdO1xuICBjb25zdCBoaWVyYXJjaHkgPSAoXG4gICAgQXJyYXkuaXNBcnJheShwZXJzaXN0ZW5jZSkgPyBwZXJzaXN0ZW5jZSA6IFtwZXJzaXN0ZW5jZV1cbiAgKS5tYXA8UGVyc2lzdGVuY2VJbnRlcm5hbD4oX2dldEluc3RhbmNlKTtcbiAgaWYgKGRlcHM/LmVycm9yTWFwKSB7XG4gICAgYXV0aC5fdXBkYXRlRXJyb3JNYXAoZGVwcy5lcnJvck1hcCk7XG4gIH1cblxuICAvLyBUaGlzIHByb21pc2UgaXMgaW50ZW5kZWQgdG8gZmxvYXQ7IGF1dGggaW5pdGlhbGl6YXRpb24gaGFwcGVucyBpbiB0aGVcbiAgLy8gYmFja2dyb3VuZCwgbWVhbndoaWxlIHRoZSBhdXRoIG9iamVjdCBtYXkgYmUgdXNlZCBieSB0aGUgYXBwLlxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gIGF1dGguX2luaXRpYWxpemVXaXRoUGVyc2lzdGVuY2UoaGllcmFyY2h5LCBkZXBzPy5wb3B1cFJlZGlyZWN0UmVzb2x2ZXIpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9lcnJvcnMnO1xuaW1wb3J0IHsgX2Fzc2VydCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IF9jYXN0QXV0aCB9IGZyb20gJy4vYXV0aF9pbXBsJztcblxuLyoqXG4gKiBDaGFuZ2VzIHRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgRmlyZWJhc2UgQXV0aCBFbXVsYXRvciwgaW5zdGVhZCBvZiBwcm9kdWN0aW9uXG4gKiBGaXJlYmFzZSBBdXRoIHNlcnZpY2VzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIG11c3QgYmUgY2FsbGVkIHN5bmNocm9ub3VzbHkgaW1tZWRpYXRlbHkgZm9sbG93aW5nIHRoZSBmaXJzdCBjYWxsIHRvXG4gKiB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9LiAgRG8gbm90IHVzZSB3aXRoIHByb2R1Y3Rpb24gY3JlZGVudGlhbHMgYXMgZW11bGF0b3JcbiAqIHRyYWZmaWMgaXMgbm90IGVuY3J5cHRlZC5cbiAqXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGNvbm5lY3RBdXRoRW11bGF0b3IoYXV0aCwgJ2h0dHA6Ly8xMjcuMC4wLjE6OTA5OScsIHsgZGlzYWJsZVdhcm5pbmdzOiB0cnVlIH0pO1xuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIHVybCAtIFRoZSBVUkwgYXQgd2hpY2ggdGhlIGVtdWxhdG9yIGlzIHJ1bm5pbmcgKGVnLCAnaHR0cDovL2xvY2FsaG9zdDo5MDk5JykuXG4gKiBAcGFyYW0gb3B0aW9ucyAtIE9wdGlvbmFsLiBgb3B0aW9ucy5kaXNhYmxlV2FybmluZ3NgIGRlZmF1bHRzIHRvIGBmYWxzZWAuIFNldCBpdCB0b1xuICogYHRydWVgIHRvIGRpc2FibGUgdGhlIHdhcm5pbmcgYmFubmVyIGF0dGFjaGVkIHRvIHRoZSBET00uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gY29ubmVjdEF1dGhFbXVsYXRvcihcbiAgYXV0aDogQXV0aCxcbiAgdXJsOiBzdHJpbmcsXG4gIG9wdGlvbnM/OiB7IGRpc2FibGVXYXJuaW5nczogYm9vbGVhbiB9XG4pOiB2b2lkIHtcbiAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICBfYXNzZXJ0KFxuICAgIGF1dGhJbnRlcm5hbC5fY2FuSW5pdEVtdWxhdG9yLFxuICAgIGF1dGhJbnRlcm5hbCxcbiAgICBBdXRoRXJyb3JDb2RlLkVNVUxBVE9SX0NPTkZJR19GQUlMRURcbiAgKTtcblxuICBfYXNzZXJ0KFxuICAgIC9eaHR0cHM/OlxcL1xcLy8udGVzdCh1cmwpLFxuICAgIGF1dGhJbnRlcm5hbCxcbiAgICBBdXRoRXJyb3JDb2RlLklOVkFMSURfRU1VTEFUT1JfU0NIRU1FXG4gICk7XG5cbiAgY29uc3QgZGlzYWJsZVdhcm5pbmdzID0gISFvcHRpb25zPy5kaXNhYmxlV2FybmluZ3M7XG5cbiAgY29uc3QgcHJvdG9jb2wgPSBleHRyYWN0UHJvdG9jb2wodXJsKTtcbiAgY29uc3QgeyBob3N0LCBwb3J0IH0gPSBleHRyYWN0SG9zdEFuZFBvcnQodXJsKTtcbiAgY29uc3QgcG9ydFN0ciA9IHBvcnQgPT09IG51bGwgPyAnJyA6IGA6JHtwb3J0fWA7XG5cbiAgLy8gQWx3YXlzIHJlcGxhY2UgcGF0aCB3aXRoIFwiL1wiIChldmVuIGlmIGlucHV0IHVybCBoYWQgbm8gcGF0aCBhdCBhbGwsIG9yIGhhZCBhIGRpZmZlcmVudCBvbmUpLlxuICBhdXRoSW50ZXJuYWwuY29uZmlnLmVtdWxhdG9yID0geyB1cmw6IGAke3Byb3RvY29sfS8vJHtob3N0fSR7cG9ydFN0cn0vYCB9O1xuICBhdXRoSW50ZXJuYWwuc2V0dGluZ3MuYXBwVmVyaWZpY2F0aW9uRGlzYWJsZWRGb3JUZXN0aW5nID0gdHJ1ZTtcbiAgYXV0aEludGVybmFsLmVtdWxhdG9yQ29uZmlnID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgaG9zdCxcbiAgICBwb3J0LFxuICAgIHByb3RvY29sOiBwcm90b2NvbC5yZXBsYWNlKCc6JywgJycpLFxuICAgIG9wdGlvbnM6IE9iamVjdC5mcmVlemUoeyBkaXNhYmxlV2FybmluZ3MgfSlcbiAgfSk7XG5cbiAgaWYgKCFkaXNhYmxlV2FybmluZ3MpIHtcbiAgICBlbWl0RW11bGF0b3JXYXJuaW5nKCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZXh0cmFjdFByb3RvY29sKHVybDogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3QgcHJvdG9jb2xFbmQgPSB1cmwuaW5kZXhPZignOicpO1xuICByZXR1cm4gcHJvdG9jb2xFbmQgPCAwID8gJycgOiB1cmwuc3Vic3RyKDAsIHByb3RvY29sRW5kICsgMSk7XG59XG5cbmZ1bmN0aW9uIGV4dHJhY3RIb3N0QW5kUG9ydCh1cmw6IHN0cmluZyk6IHtcbiAgaG9zdDogc3RyaW5nO1xuICBwb3J0OiBudW1iZXIgfCBudWxsO1xufSB7XG4gIGNvbnN0IHByb3RvY29sID0gZXh0cmFjdFByb3RvY29sKHVybCk7XG4gIGNvbnN0IGF1dGhvcml0eSA9IC8oXFwvXFwvKT8oW14/Iy9dKykvLmV4ZWModXJsLnN1YnN0cihwcm90b2NvbC5sZW5ndGgpKTsgLy8gQmV0d2VlbiAvLyBhbmQgLywgPyBvciAjLlxuICBpZiAoIWF1dGhvcml0eSkge1xuICAgIHJldHVybiB7IGhvc3Q6ICcnLCBwb3J0OiBudWxsIH07XG4gIH1cbiAgY29uc3QgaG9zdEFuZFBvcnQgPSBhdXRob3JpdHlbMl0uc3BsaXQoJ0AnKS5wb3AoKSB8fCAnJzsgLy8gU3RyaXAgb3V0IFwidXNlcm5hbWU6cGFzc3dvcmRAXCIuXG4gIGNvbnN0IGJyYWNrZXRlZElQdjYgPSAvXihcXFtbXlxcXV0rXFxdKSg6fCQpLy5leGVjKGhvc3RBbmRQb3J0KTtcbiAgaWYgKGJyYWNrZXRlZElQdjYpIHtcbiAgICBjb25zdCBob3N0ID0gYnJhY2tldGVkSVB2NlsxXTtcbiAgICByZXR1cm4geyBob3N0LCBwb3J0OiBwYXJzZVBvcnQoaG9zdEFuZFBvcnQuc3Vic3RyKGhvc3QubGVuZ3RoICsgMSkpIH07XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgW2hvc3QsIHBvcnRdID0gaG9zdEFuZFBvcnQuc3BsaXQoJzonKTtcbiAgICByZXR1cm4geyBob3N0LCBwb3J0OiBwYXJzZVBvcnQocG9ydCkgfTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwYXJzZVBvcnQocG9ydFN0cjogc3RyaW5nKTogbnVtYmVyIHwgbnVsbCB7XG4gIGlmICghcG9ydFN0cikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHBvcnQgPSBOdW1iZXIocG9ydFN0cik7XG4gIGlmIChpc05hTihwb3J0KSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIHJldHVybiBwb3J0O1xufVxuXG5mdW5jdGlvbiBlbWl0RW11bGF0b3JXYXJuaW5nKCk6IHZvaWQge1xuICBmdW5jdGlvbiBhdHRhY2hCYW5uZXIoKTogdm9pZCB7XG4gICAgY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgY29uc3Qgc3R5ID0gZWwuc3R5bGU7XG4gICAgZWwuaW5uZXJUZXh0ID1cbiAgICAgICdSdW5uaW5nIGluIGVtdWxhdG9yIG1vZGUuIERvIG5vdCB1c2Ugd2l0aCBwcm9kdWN0aW9uIGNyZWRlbnRpYWxzLic7XG4gICAgc3R5LnBvc2l0aW9uID0gJ2ZpeGVkJztcbiAgICBzdHkud2lkdGggPSAnMTAwJSc7XG4gICAgc3R5LmJhY2tncm91bmRDb2xvciA9ICcjZmZmZmZmJztcbiAgICBzdHkuYm9yZGVyID0gJy4xZW0gc29saWQgIzAwMDAwMCc7XG4gICAgc3R5LmNvbG9yID0gJyNiNTAwMDAnO1xuICAgIHN0eS5ib3R0b20gPSAnMHB4JztcbiAgICBzdHkubGVmdCA9ICcwcHgnO1xuICAgIHN0eS5tYXJnaW4gPSAnMHB4JztcbiAgICBzdHkuekluZGV4ID0gJzEwMDAwJztcbiAgICBzdHkudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgZWwuY2xhc3NMaXN0LmFkZCgnZmlyZWJhc2UtZW11bGF0b3Itd2FybmluZycpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgY29uc29sZS5pbmZvID09PSAnZnVuY3Rpb24nKSB7XG4gICAgY29uc29sZS5pbmZvKFxuICAgICAgJ1dBUk5JTkc6IFlvdSBhcmUgdXNpbmcgdGhlIEF1dGggRW11bGF0b3IsJyArXG4gICAgICAgICcgd2hpY2ggaXMgaW50ZW5kZWQgZm9yIGxvY2FsIHRlc3Rpbmcgb25seS4gIERvIG5vdCB1c2Ugd2l0aCcgK1xuICAgICAgICAnIHByb2R1Y3Rpb24gY3JlZGVudGlhbHMuJ1xuICAgICk7XG4gIH1cbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2xvYWRpbmcnKSB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGF0dGFjaEJhbm5lcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF0dGFjaEJhbm5lcigpO1xuICAgIH1cbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFBob25lT3JPYXV0aFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgSWRUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgZGVidWdGYWlsIH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuXG4vKipcbiAqIEludGVyZmFjZSB0aGF0IHJlcHJlc2VudHMgdGhlIGNyZWRlbnRpYWxzIHJldHVybmVkIGJ5IGFuIHtAbGluayBBdXRoUHJvdmlkZXJ9LlxuICpcbiAqIEByZW1hcmtzXG4gKiBJbXBsZW1lbnRhdGlvbnMgc3BlY2lmeSB0aGUgZGV0YWlscyBhYm91dCBlYWNoIGF1dGggcHJvdmlkZXIncyBjcmVkZW50aWFsIHJlcXVpcmVtZW50cy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjbGFzcyBBdXRoQ3JlZGVudGlhbCB7XG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBhdXRoZW50aWNhdGlvbiBwcm92aWRlciBJRCBmb3IgdGhlIGNyZWRlbnRpYWwuXG4gICAgICpcbiAgICAgKiBAcmVtYXJrc1xuICAgICAqIEZvciBleGFtcGxlLCAnZmFjZWJvb2suY29tJywgb3IgJ2dvb2dsZS5jb20nLlxuICAgICAqL1xuICAgIHJlYWRvbmx5IHByb3ZpZGVySWQ6IHN0cmluZyxcbiAgICAvKipcbiAgICAgKiBUaGUgYXV0aGVudGljYXRpb24gc2lnbiBpbiBtZXRob2QgZm9yIHRoZSBjcmVkZW50aWFsLlxuICAgICAqXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBGb3IgZXhhbXBsZSwge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfUEFTU1dPUkQsIG9yXG4gICAgICoge0BsaW5rIFNpZ25Jbk1ldGhvZH0uRU1BSUxfTElOSy4gVGhpcyBjb3JyZXNwb25kcyB0byB0aGUgc2lnbi1pbiBtZXRob2RcbiAgICAgKiBpZGVudGlmaWVyIGFzIHJldHVybmVkIGluIHtAbGluayBmZXRjaFNpZ25Jbk1ldGhvZHNGb3JFbWFpbH0uXG4gICAgICovXG4gICAgcmVhZG9ubHkgc2lnbkluTWV0aG9kOiBzdHJpbmdcbiAgKSB7fVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBvYmplY3QuXG4gICAqXG4gICAqIEByZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBvYmplY3QuXG4gICAqL1xuICB0b0pTT04oKTogb2JqZWN0IHtcbiAgICByZXR1cm4gZGVidWdGYWlsKCdub3QgaW1wbGVtZW50ZWQnKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgX2dldElkVG9rZW5SZXNwb25zZShfYXV0aDogQXV0aEludGVybmFsKTogUHJvbWlzZTxQaG9uZU9yT2F1dGhUb2tlblJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XG4gIH1cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBfbGlua1RvSWRUb2tlbihcbiAgICBfYXV0aDogQXV0aEludGVybmFsLFxuICAgIF9pZFRva2VuOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxJZFRva2VuUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gZGVidWdGYWlsKCdub3QgaW1wbGVtZW50ZWQnKTtcbiAgfVxuICAvKiogQGludGVybmFsICovXG4gIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoX2F1dGg6IEF1dGhJbnRlcm5hbCk6IFByb21pc2U8SWRUb2tlblJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIGRlYnVnRmFpbCgnbm90IGltcGxlbWVudGVkJyk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBY3Rpb25Db2RlT3BlcmF0aW9uLCBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHtcbiAgRW5kcG9pbnQsXG4gIEh0dHBNZXRob2QsXG4gIF9hZGRUaWRJZk5lY2Vzc2FyeSxcbiAgX3BlcmZvcm1BcGlSZXF1ZXN0XG59IGZyb20gJy4uL2luZGV4JztcbmltcG9ydCB7IElkVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IE1mYUVucm9sbG1lbnQgfSBmcm9tICcuL21mYSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVzZXRQYXNzd29yZFJlcXVlc3Qge1xuICBvb2JDb2RlOiBzdHJpbmc7XG4gIG5ld1Bhc3N3b3JkPzogc3RyaW5nO1xuICB0ZW5hbnRJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXNldFBhc3N3b3JkUmVzcG9uc2Uge1xuICBlbWFpbDogc3RyaW5nO1xuICBuZXdFbWFpbD86IHN0cmluZztcbiAgcmVxdWVzdFR5cGU/OiBBY3Rpb25Db2RlT3BlcmF0aW9uO1xuICBtZmFJbmZvPzogTWZhRW5yb2xsbWVudDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlc2V0UGFzc3dvcmQoXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFJlc2V0UGFzc3dvcmRSZXF1ZXN0XG4pOiBQcm9taXNlPFJlc2V0UGFzc3dvcmRSZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0PFJlc2V0UGFzc3dvcmRSZXF1ZXN0LCBSZXNldFBhc3N3b3JkUmVzcG9uc2U+KFxuICAgIGF1dGgsXG4gICAgSHR0cE1ldGhvZC5QT1NULFxuICAgIEVuZHBvaW50LlJFU0VUX1BBU1NXT1JELFxuICAgIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KVxuICApO1xufVxuZXhwb3J0IGludGVyZmFjZSBVcGRhdGVFbWFpbFBhc3N3b3JkUmVxdWVzdCB7XG4gIGlkVG9rZW46IHN0cmluZztcbiAgcmV0dXJuU2VjdXJlVG9rZW4/OiBib29sZWFuO1xuICBlbWFpbD86IHN0cmluZztcbiAgcGFzc3dvcmQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBkYXRlRW1haWxQYXNzd29yZFJlc3BvbnNlIGV4dGVuZHMgSWRUb2tlblJlc3BvbnNlIHt9XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVFbWFpbFBhc3N3b3JkKFxuICBhdXRoOiBBdXRoLFxuICByZXF1ZXN0OiBVcGRhdGVFbWFpbFBhc3N3b3JkUmVxdWVzdFxuKTogUHJvbWlzZTxVcGRhdGVFbWFpbFBhc3N3b3JkUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdDxcbiAgICBVcGRhdGVFbWFpbFBhc3N3b3JkUmVxdWVzdCxcbiAgICBVcGRhdGVFbWFpbFBhc3N3b3JkUmVzcG9uc2VcbiAgPihhdXRoLCBIdHRwTWV0aG9kLlBPU1QsIEVuZHBvaW50LlNFVF9BQ0NPVU5UX0lORk8sIHJlcXVlc3QpO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFwcGx5QWN0aW9uQ29kZVJlcXVlc3Qge1xuICBvb2JDb2RlOiBzdHJpbmc7XG4gIHRlbmFudElkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFwcGx5QWN0aW9uQ29kZVJlc3BvbnNlIHt9XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhcHBseUFjdGlvbkNvZGUoXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IEFwcGx5QWN0aW9uQ29kZVJlcXVlc3Rcbik6IFByb21pc2U8QXBwbHlBY3Rpb25Db2RlUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdDxBcHBseUFjdGlvbkNvZGVSZXF1ZXN0LCBBcHBseUFjdGlvbkNvZGVSZXNwb25zZT4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuU0VUX0FDQ09VTlRfSU5GTyxcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBY3Rpb25Db2RlT3BlcmF0aW9uLCBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHtcbiAgRW5kcG9pbnQsXG4gIEh0dHBNZXRob2QsXG4gIFJlY2FwdGNoYUNsaWVudFR5cGUsXG4gIFJlY2FwdGNoYVZlcnNpb24sXG4gIF9hZGRUaWRJZk5lY2Vzc2FyeSxcbiAgX3BlcmZvcm1BcGlSZXF1ZXN0LFxuICBfcGVyZm9ybVNpZ25JblJlcXVlc3Rcbn0gZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IHsgSWRUb2tlbiwgSWRUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNpZ25JbldpdGhQYXNzd29yZFJlcXVlc3Qge1xuICByZXR1cm5TZWN1cmVUb2tlbj86IGJvb2xlYW47XG4gIGVtYWlsOiBzdHJpbmc7XG4gIHBhc3N3b3JkOiBzdHJpbmc7XG4gIHRlbmFudElkPzogc3RyaW5nO1xuICBjYXB0Y2hhUmVzcG9uc2U/OiBzdHJpbmc7XG4gIGNsaWVudFR5cGU/OiBSZWNhcHRjaGFDbGllbnRUeXBlO1xuICByZWNhcHRjaGFWZXJzaW9uPzogUmVjYXB0Y2hhVmVyc2lvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaWduSW5XaXRoUGFzc3dvcmRSZXNwb25zZSBleHRlbmRzIElkVG9rZW5SZXNwb25zZSB7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIGRpc3BsYXlOYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoUGFzc3dvcmQoXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFNpZ25JbldpdGhQYXNzd29yZFJlcXVlc3Rcbik6IFByb21pc2U8U2lnbkluV2l0aFBhc3N3b3JkUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdDxcbiAgICBTaWduSW5XaXRoUGFzc3dvcmRSZXF1ZXN0LFxuICAgIFNpZ25JbldpdGhQYXNzd29yZFJlc3BvbnNlXG4gID4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuU0lHTl9JTl9XSVRIX1BBU1NXT1JELFxuICAgIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KVxuICApO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdldE9vYkNvZGVSZXF1ZXN0IHtcbiAgZW1haWw/OiBzdHJpbmc7IC8vIEV2ZXJ5dGhpbmcgZXhjZXB0IFZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMXG4gIGNvbnRpbnVlVXJsPzogc3RyaW5nO1xuICBpT1NCdW5kbGVJZD86IHN0cmluZztcbiAgaW9zQXBwU3RvcmVJZD86IHN0cmluZztcbiAgYW5kcm9pZFBhY2thZ2VOYW1lPzogc3RyaW5nO1xuICBhbmRyb2lkSW5zdGFsbEFwcD86IGJvb2xlYW47XG4gIGFuZHJvaWRNaW5pbXVtVmVyc2lvbkNvZGU/OiBzdHJpbmc7XG4gIGNhbkhhbmRsZUNvZGVJbkFwcD86IGJvb2xlYW47XG4gIGR5bmFtaWNMaW5rRG9tYWluPzogc3RyaW5nO1xuICB0ZW5hbnRJZD86IHN0cmluZztcbiAgdGFyZ2V0UHJvamVjdGlkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZlcmlmeUVtYWlsUmVxdWVzdCBleHRlbmRzIEdldE9vYkNvZGVSZXF1ZXN0IHtcbiAgcmVxdWVzdFR5cGU6IEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0VNQUlMO1xuICBpZFRva2VuOiBJZFRva2VuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhc3N3b3JkUmVzZXRSZXF1ZXN0IGV4dGVuZHMgR2V0T29iQ29kZVJlcXVlc3Qge1xuICByZXF1ZXN0VHlwZTogQWN0aW9uQ29kZU9wZXJhdGlvbi5QQVNTV09SRF9SRVNFVDtcbiAgZW1haWw6IHN0cmluZztcbiAgY2FwdGNoYVJlc3A/OiBzdHJpbmc7XG4gIGNsaWVudFR5cGU/OiBSZWNhcHRjaGFDbGllbnRUeXBlO1xuICByZWNhcHRjaGFWZXJzaW9uPzogUmVjYXB0Y2hhVmVyc2lvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbWFpbFNpZ25JblJlcXVlc3QgZXh0ZW5kcyBHZXRPb2JDb2RlUmVxdWVzdCB7XG4gIHJlcXVlc3RUeXBlOiBBY3Rpb25Db2RlT3BlcmF0aW9uLkVNQUlMX1NJR05JTjtcbiAgZW1haWw6IHN0cmluZztcbiAgY2FwdGNoYVJlc3A/OiBzdHJpbmc7XG4gIGNsaWVudFR5cGU/OiBSZWNhcHRjaGFDbGllbnRUeXBlO1xuICByZWNhcHRjaGFWZXJzaW9uPzogUmVjYXB0Y2hhVmVyc2lvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZXJpZnlBbmRDaGFuZ2VFbWFpbFJlcXVlc3QgZXh0ZW5kcyBHZXRPb2JDb2RlUmVxdWVzdCB7XG4gIHJlcXVlc3RUeXBlOiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMO1xuICBpZFRva2VuOiBJZFRva2VuO1xuICBuZXdFbWFpbDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgR2V0T29iQ29kZVJlc3BvbnNlIHtcbiAgZW1haWw6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZXJpZnlFbWFpbFJlc3BvbnNlIGV4dGVuZHMgR2V0T29iQ29kZVJlc3BvbnNlIHt9XG5leHBvcnQgaW50ZXJmYWNlIFBhc3N3b3JkUmVzZXRSZXNwb25zZSBleHRlbmRzIEdldE9vYkNvZGVSZXNwb25zZSB7fVxuZXhwb3J0IGludGVyZmFjZSBFbWFpbFNpZ25JblJlc3BvbnNlIGV4dGVuZHMgR2V0T29iQ29kZVJlc3BvbnNlIHt9XG5leHBvcnQgaW50ZXJmYWNlIFZlcmlmeUFuZENoYW5nZUVtYWlsUmVzcG9uc2UgZXh0ZW5kcyBHZXRPb2JDb2RlUmVxdWVzdCB7fVxuXG5hc3luYyBmdW5jdGlvbiBzZW5kT29iQ29kZShcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogR2V0T29iQ29kZVJlcXVlc3Rcbik6IFByb21pc2U8R2V0T29iQ29kZVJlc3BvbnNlPiB7XG4gIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3Q8R2V0T29iQ29kZVJlcXVlc3QsIEdldE9vYkNvZGVSZXNwb25zZT4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuU0VORF9PT0JfQ09ERSxcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRFbWFpbFZlcmlmaWNhdGlvbihcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogVmVyaWZ5RW1haWxSZXF1ZXN0XG4pOiBQcm9taXNlPFZlcmlmeUVtYWlsUmVzcG9uc2U+IHtcbiAgcmV0dXJuIHNlbmRPb2JDb2RlKGF1dGgsIHJlcXVlc3QpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogUGFzc3dvcmRSZXNldFJlcXVlc3Rcbik6IFByb21pc2U8UGFzc3dvcmRSZXNldFJlc3BvbnNlPiB7XG4gIHJldHVybiBzZW5kT29iQ29kZShhdXRoLCByZXF1ZXN0KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRTaWduSW5MaW5rVG9FbWFpbChcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogRW1haWxTaWduSW5SZXF1ZXN0XG4pOiBQcm9taXNlPEVtYWlsU2lnbkluUmVzcG9uc2U+IHtcbiAgcmV0dXJuIHNlbmRPb2JDb2RlKGF1dGgsIHJlcXVlc3QpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5QW5kQ2hhbmdlRW1haWwoXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFZlcmlmeUFuZENoYW5nZUVtYWlsUmVxdWVzdFxuKTogUHJvbWlzZTxWZXJpZnlBbmRDaGFuZ2VFbWFpbFJlc3BvbnNlPiB7XG4gIHJldHVybiBzZW5kT29iQ29kZShhdXRoLCByZXF1ZXN0KTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBfcGVyZm9ybVNpZ25JblJlcXVlc3QsXG4gIEVuZHBvaW50LFxuICBIdHRwTWV0aG9kLFxuICBfYWRkVGlkSWZOZWNlc3Nhcnlcbn0gZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IHsgSWRUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgQXV0aCB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2lnbkluV2l0aEVtYWlsTGlua1JlcXVlc3Qge1xuICBlbWFpbDogc3RyaW5nO1xuICBvb2JDb2RlOiBzdHJpbmc7XG4gIHRlbmFudElkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNpZ25JbldpdGhFbWFpbExpbmtSZXNwb25zZSBleHRlbmRzIElkVG9rZW5SZXNwb25zZSB7XG4gIGVtYWlsOiBzdHJpbmc7XG4gIGlzTmV3VXNlcjogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhFbWFpbExpbmsoXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFNpZ25JbldpdGhFbWFpbExpbmtSZXF1ZXN0XG4pOiBQcm9taXNlPFNpZ25JbldpdGhFbWFpbExpbmtSZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0PFxuICAgIFNpZ25JbldpdGhFbWFpbExpbmtSZXF1ZXN0LFxuICAgIFNpZ25JbldpdGhFbWFpbExpbmtSZXNwb25zZVxuICA+KFxuICAgIGF1dGgsXG4gICAgSHR0cE1ldGhvZC5QT1NULFxuICAgIEVuZHBvaW50LlNJR05fSU5fV0lUSF9FTUFJTF9MSU5LLFxuICAgIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KVxuICApO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNpZ25JbldpdGhFbWFpbExpbmtGb3JMaW5raW5nUmVxdWVzdFxuICBleHRlbmRzIFNpZ25JbldpdGhFbWFpbExpbmtSZXF1ZXN0IHtcbiAgaWRUb2tlbjogc3RyaW5nO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsTGlua0ZvckxpbmtpbmcoXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFNpZ25JbldpdGhFbWFpbExpbmtGb3JMaW5raW5nUmVxdWVzdFxuKTogUHJvbWlzZTxTaWduSW5XaXRoRW1haWxMaW5rUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdDxcbiAgICBTaWduSW5XaXRoRW1haWxMaW5rRm9yTGlua2luZ1JlcXVlc3QsXG4gICAgU2lnbkluV2l0aEVtYWlsTGlua1Jlc3BvbnNlXG4gID4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuU0lHTl9JTl9XSVRIX0VNQUlMX0xJTkssXG4gICAgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpXG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgUHJvdmlkZXJJZCwgU2lnbkluTWV0aG9kIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG5pbXBvcnQgeyB1cGRhdGVFbWFpbFBhc3N3b3JkIH0gZnJvbSAnLi4vLi4vYXBpL2FjY291bnRfbWFuYWdlbWVudC9lbWFpbF9hbmRfcGFzc3dvcmQnO1xuaW1wb3J0IHtcbiAgc2lnbkluV2l0aFBhc3N3b3JkLFxuICBTaWduSW5XaXRoUGFzc3dvcmRSZXF1ZXN0XG59IGZyb20gJy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi9lbWFpbF9hbmRfcGFzc3dvcmQnO1xuaW1wb3J0IHtcbiAgc2lnbkluV2l0aEVtYWlsTGluayxcbiAgc2lnbkluV2l0aEVtYWlsTGlua0Zvckxpbmtpbmdcbn0gZnJvbSAnLi4vLi4vYXBpL2F1dGhlbnRpY2F0aW9uL2VtYWlsX2xpbmsnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBJZFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9tb2RlbC9pZF90b2tlbic7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IF9mYWlsIH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgQXV0aENyZWRlbnRpYWwgfSBmcm9tICcuL2F1dGhfY3JlZGVudGlhbCc7XG5pbXBvcnQgeyBpbmplY3RSZWNhcHRjaGFGaWVsZHMgfSBmcm9tICcuLi8uLi9wbGF0Zm9ybV9icm93c2VyL3JlY2FwdGNoYS9yZWNhcHRjaGFfZW50ZXJwcmlzZV92ZXJpZmllcic7XG5pbXBvcnQgeyBSZWNhcHRjaGFBY3Rpb25OYW1lLCBSZWNhcHRjaGFDbGllbnRUeXBlIH0gZnJvbSAnLi4vLi4vYXBpJztcbi8qKlxuICogSW50ZXJmYWNlIHRoYXQgcmVwcmVzZW50cyB0aGUgY3JlZGVudGlhbHMgcmV0dXJuZWQgYnkge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSBmb3JcbiAqIHtAbGluayBQcm92aWRlcklkfS5QQVNTV09SRFxuICpcbiAqIEByZW1hcmtzXG4gKiBDb3ZlcnMgYm90aCB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9QQVNTV09SRCBhbmRcbiAqIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX0xJTksuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgRW1haWxBdXRoQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBAaW50ZXJuYWwgKi9cbiAgICByZWFkb25seSBfZW1haWw6IHN0cmluZyxcbiAgICAvKiogQGludGVybmFsICovXG4gICAgcmVhZG9ubHkgX3Bhc3N3b3JkOiBzdHJpbmcsXG4gICAgc2lnbkluTWV0aG9kOiBTaWduSW5NZXRob2QsXG4gICAgLyoqIEBpbnRlcm5hbCAqL1xuICAgIHJlYWRvbmx5IF90ZW5hbnRJZDogc3RyaW5nIHwgbnVsbCA9IG51bGxcbiAgKSB7XG4gICAgc3VwZXIoUHJvdmlkZXJJZC5QQVNTV09SRCwgc2lnbkluTWV0aG9kKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgc3RhdGljIF9mcm9tRW1haWxBbmRQYXNzd29yZChcbiAgICBlbWFpbDogc3RyaW5nLFxuICAgIHBhc3N3b3JkOiBzdHJpbmdcbiAgKTogRW1haWxBdXRoQ3JlZGVudGlhbCB7XG4gICAgcmV0dXJuIG5ldyBFbWFpbEF1dGhDcmVkZW50aWFsKFxuICAgICAgZW1haWwsXG4gICAgICBwYXNzd29yZCxcbiAgICAgIFNpZ25Jbk1ldGhvZC5FTUFJTF9QQVNTV09SRFxuICAgICk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHN0YXRpYyBfZnJvbUVtYWlsQW5kQ29kZShcbiAgICBlbWFpbDogc3RyaW5nLFxuICAgIG9vYkNvZGU6IHN0cmluZyxcbiAgICB0ZW5hbnRJZDogc3RyaW5nIHwgbnVsbCA9IG51bGxcbiAgKTogRW1haWxBdXRoQ3JlZGVudGlhbCB7XG4gICAgcmV0dXJuIG5ldyBFbWFpbEF1dGhDcmVkZW50aWFsKFxuICAgICAgZW1haWwsXG4gICAgICBvb2JDb2RlLFxuICAgICAgU2lnbkluTWV0aG9kLkVNQUlMX0xJTkssXG4gICAgICB0ZW5hbnRJZFxuICAgICk7XG4gIH1cblxuICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gKi9cbiAgdG9KU09OKCk6IG9iamVjdCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcbiAgICAgIHBhc3N3b3JkOiB0aGlzLl9wYXNzd29yZCxcbiAgICAgIHNpZ25Jbk1ldGhvZDogdGhpcy5zaWduSW5NZXRob2QsXG4gICAgICB0ZW5hbnRJZDogdGhpcy5fdGVuYW50SWRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXRpYyBtZXRob2QgdG8gZGVzZXJpYWxpemUgYSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIGFuIG9iamVjdCBpbnRvIGFuIHtAbGluayAgQXV0aENyZWRlbnRpYWx9LlxuICAgKlxuICAgKiBAcGFyYW0ganNvbiAtIEVpdGhlciBgb2JqZWN0YCBvciB0aGUgc3RyaW5naWZpZWQgcmVwcmVzZW50YXRpb24gb2YgdGhlIG9iamVjdC4gV2hlbiBzdHJpbmcgaXNcbiAgICogcHJvdmlkZWQsIGBKU09OLnBhcnNlYCB3b3VsZCBiZSBjYWxsZWQgZmlyc3QuXG4gICAqXG4gICAqIEByZXR1cm5zIElmIHRoZSBKU09OIGlucHV0IGRvZXMgbm90IHJlcHJlc2VudCBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9LCBudWxsIGlzIHJldHVybmVkLlxuICAgKi9cbiAgc3RhdGljIGZyb21KU09OKGpzb246IG9iamVjdCB8IHN0cmluZyk6IEVtYWlsQXV0aENyZWRlbnRpYWwgfCBudWxsIHtcbiAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcbiAgICBpZiAob2JqPy5lbWFpbCAmJiBvYmo/LnBhc3N3b3JkKSB7XG4gICAgICBpZiAob2JqLnNpZ25Jbk1ldGhvZCA9PT0gU2lnbkluTWV0aG9kLkVNQUlMX1BBU1NXT1JEKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mcm9tRW1haWxBbmRQYXNzd29yZChvYmouZW1haWwsIG9iai5wYXNzd29yZCk7XG4gICAgICB9IGVsc2UgaWYgKG9iai5zaWduSW5NZXRob2QgPT09IFNpZ25Jbk1ldGhvZC5FTUFJTF9MSU5LKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mcm9tRW1haWxBbmRDb2RlKG9iai5lbWFpbCwgb2JqLnBhc3N3b3JkLCBvYmoudGVuYW50SWQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgYXN5bmMgX2dldElkVG9rZW5SZXNwb25zZShhdXRoOiBBdXRoSW50ZXJuYWwpOiBQcm9taXNlPElkVG9rZW5SZXNwb25zZT4ge1xuICAgIHN3aXRjaCAodGhpcy5zaWduSW5NZXRob2QpIHtcbiAgICAgIGNhc2UgU2lnbkluTWV0aG9kLkVNQUlMX1BBU1NXT1JEOlxuICAgICAgICBjb25zdCByZXF1ZXN0OiBTaWduSW5XaXRoUGFzc3dvcmRSZXF1ZXN0ID0ge1xuICAgICAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxuICAgICAgICAgIGVtYWlsOiB0aGlzLl9lbWFpbCxcbiAgICAgICAgICBwYXNzd29yZDogdGhpcy5fcGFzc3dvcmQsXG4gICAgICAgICAgY2xpZW50VHlwZTogUmVjYXB0Y2hhQ2xpZW50VHlwZS5XRUJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGF1dGguX2dldFJlY2FwdGNoYUNvbmZpZygpPy5lbWFpbFBhc3N3b3JkRW5hYmxlZCkge1xuICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhID0gYXdhaXQgaW5qZWN0UmVjYXB0Y2hhRmllbGRzKFxuICAgICAgICAgICAgYXV0aCxcbiAgICAgICAgICAgIHJlcXVlc3QsXG4gICAgICAgICAgICBSZWNhcHRjaGFBY3Rpb25OYW1lLlNJR05fSU5fV0lUSF9QQVNTV09SRFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhQYXNzd29yZChhdXRoLCByZXF1ZXN0V2l0aFJlY2FwdGNoYSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHNpZ25JbldpdGhQYXNzd29yZChhdXRoLCByZXF1ZXN0KS5jYXRjaChhc3luYyBlcnJvciA9PiB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIGVycm9yLmNvZGUgPT09IGBhdXRoLyR7QXV0aEVycm9yQ29kZS5NSVNTSU5HX1JFQ0FQVENIQV9UT0tFTn1gXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgJ1NpZ24taW4gd2l0aCBlbWFpbCBhZGRyZXNzIGFuZCBwYXNzd29yZCBpcyBwcm90ZWN0ZWQgYnkgcmVDQVBUQ0hBIGZvciB0aGlzIHByb2plY3QuIEF1dG9tYXRpY2FsbHkgdHJpZ2dlcmluZyB0aGUgcmVDQVBUQ0hBIGZsb3cgYW5kIHJlc3RhcnRpbmcgdGhlIHNpZ24taW4gZmxvdy4nXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhID0gYXdhaXQgaW5qZWN0UmVjYXB0Y2hhRmllbGRzKFxuICAgICAgICAgICAgICAgIGF1dGgsXG4gICAgICAgICAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgICAgICAgICBSZWNhcHRjaGFBY3Rpb25OYW1lLlNJR05fSU5fV0lUSF9QQVNTV09SRFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICByZXR1cm4gc2lnbkluV2l0aFBhc3N3b3JkKGF1dGgsIHJlcXVlc3RXaXRoUmVjYXB0Y2hhKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIGNhc2UgU2lnbkluTWV0aG9kLkVNQUlMX0xJTks6XG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoRW1haWxMaW5rKGF1dGgsIHtcbiAgICAgICAgICBlbWFpbDogdGhpcy5fZW1haWwsXG4gICAgICAgICAgb29iQ29kZTogdGhpcy5fcGFzc3dvcmRcbiAgICAgICAgfSk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBfZmFpbChhdXRoLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgICB9XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIGFzeW5jIF9saW5rVG9JZFRva2VuKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBpZFRva2VuOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxJZFRva2VuUmVzcG9uc2U+IHtcbiAgICBzd2l0Y2ggKHRoaXMuc2lnbkluTWV0aG9kKSB7XG4gICAgICBjYXNlIFNpZ25Jbk1ldGhvZC5FTUFJTF9QQVNTV09SRDpcbiAgICAgICAgcmV0dXJuIHVwZGF0ZUVtYWlsUGFzc3dvcmQoYXV0aCwge1xuICAgICAgICAgIGlkVG9rZW4sXG4gICAgICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUsXG4gICAgICAgICAgZW1haWw6IHRoaXMuX2VtYWlsLFxuICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLl9wYXNzd29yZFxuICAgICAgICB9KTtcbiAgICAgIGNhc2UgU2lnbkluTWV0aG9kLkVNQUlMX0xJTks6XG4gICAgICAgIHJldHVybiBzaWduSW5XaXRoRW1haWxMaW5rRm9yTGlua2luZyhhdXRoLCB7XG4gICAgICAgICAgaWRUb2tlbixcbiAgICAgICAgICBlbWFpbDogdGhpcy5fZW1haWwsXG4gICAgICAgICAgb29iQ29kZTogdGhpcy5fcGFzc3dvcmRcbiAgICAgICAgfSk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBfZmFpbChhdXRoLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgICB9XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoYXV0aDogQXV0aEludGVybmFsKTogUHJvbWlzZTxJZFRva2VuUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gdGhpcy5fZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGgpO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgRW5kcG9pbnQsXG4gIEh0dHBNZXRob2QsXG4gIF9hZGRUaWRJZk5lY2Vzc2FyeSxcbiAgX3BlcmZvcm1TaWduSW5SZXF1ZXN0XG59IGZyb20gJy4uL2luZGV4JztcbmltcG9ydCB7IElkVG9rZW4sIElkVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IEF1dGggfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNpZ25JbldpdGhJZHBSZXF1ZXN0IHtcbiAgcmVxdWVzdFVyaTogc3RyaW5nO1xuICBwb3N0Qm9keT86IHN0cmluZztcbiAgc2Vzc2lvbklkPzogc3RyaW5nO1xuICB0ZW5hbnRJZD86IHN0cmluZztcbiAgcmV0dXJuU2VjdXJlVG9rZW46IGJvb2xlYW47XG4gIHJldHVybklkcENyZWRlbnRpYWw/OiBib29sZWFuO1xuICBpZFRva2VuPzogSWRUb2tlbjtcbiAgYXV0b0NyZWF0ZT86IGJvb2xlYW47XG4gIHBlbmRpbmdUb2tlbj86IHN0cmluZztcbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTaWduSW5XaXRoSWRwUmVzcG9uc2UgZXh0ZW5kcyBJZFRva2VuUmVzcG9uc2Uge1xuICBvYXV0aEFjY2Vzc1Rva2VuPzogc3RyaW5nO1xuICBvYXV0aFRva2VuU2VjcmV0Pzogc3RyaW5nO1xuICBub25jZT86IHN0cmluZztcbiAgb2F1dGhJZFRva2VuPzogc3RyaW5nO1xuICBwZW5kaW5nVG9rZW4/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoSWRwKFxuICBhdXRoOiBBdXRoLFxuICByZXF1ZXN0OiBTaWduSW5XaXRoSWRwUmVxdWVzdFxuKTogUHJvbWlzZTxTaWduSW5XaXRoSWRwUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdDxTaWduSW5XaXRoSWRwUmVxdWVzdCwgU2lnbkluV2l0aElkcFJlc3BvbnNlPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5TSUdOX0lOX1dJVEhfSURQLFxuICAgIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KVxuICApO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IHF1ZXJ5c3RyaW5nIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5pbXBvcnQge1xuICBzaWduSW5XaXRoSWRwLFxuICBTaWduSW5XaXRoSWRwUmVxdWVzdFxufSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vaWRwJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgSWRUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5pbXBvcnQgeyBfZmFpbCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IEF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi9hdXRoX2NyZWRlbnRpYWwnO1xuXG5jb25zdCBJRFBfUkVRVUVTVF9VUkkgPSAnaHR0cDovL2xvY2FsaG9zdCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT0F1dGhDcmVkZW50aWFsUGFyYW1zIHtcbiAgLy8gT0F1dGggMiB1c2VzIGVpdGhlciBpZCB0b2tlbiBvciBhY2Nlc3MgdG9rZW5cbiAgaWRUb2tlbj86IHN0cmluZyB8IG51bGw7XG4gIGFjY2Vzc1Rva2VuPzogc3RyaW5nIHwgbnVsbDtcblxuICAvLyBUaGVzZSBmaWVsZHMgYXJlIHVzZWQgd2l0aCBPQXV0aCAxXG4gIG9hdXRoVG9rZW4/OiBzdHJpbmc7XG4gIHNlY3JldD86IHN0cmluZztcbiAgb2F1dGhUb2tlblNlY3JldD86IHN0cmluZztcblxuICAvLyBOb25jZSBpcyBvbmx5IHNldCBpZiBwZW5kaW5nVG9rZW4gaXMgbm90IHByZXNlbnRcbiAgbm9uY2U/OiBzdHJpbmc7XG4gIHBlbmRpbmdUb2tlbj86IHN0cmluZztcblxuICAvLyBVdGlsaXRpZXNcbiAgcHJvdmlkZXJJZDogc3RyaW5nO1xuICBzaWduSW5NZXRob2Q6IHN0cmluZztcbn1cblxuLyoqXG4gKiBSZXByZXNlbnRzIHRoZSBPQXV0aCBjcmVkZW50aWFscyByZXR1cm5lZCBieSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXG4gKlxuICogQHJlbWFya3NcbiAqIEltcGxlbWVudGF0aW9ucyBzcGVjaWZ5IHRoZSBkZXRhaWxzIGFib3V0IGVhY2ggYXV0aCBwcm92aWRlcidzIGNyZWRlbnRpYWwgcmVxdWlyZW1lbnRzLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIE9BdXRoQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcbiAgLyoqXG4gICAqIFRoZSBPQXV0aCBJRCB0b2tlbiBhc3NvY2lhdGVkIHdpdGggdGhlIGNyZWRlbnRpYWwgaWYgaXQgYmVsb25ncyB0byBhbiBPSURDIHByb3ZpZGVyLFxuICAgKiBzdWNoIGFzIGBnb29nbGUuY29tYC5cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICBpZFRva2VuPzogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIE9BdXRoIGFjY2VzcyB0b2tlbiBhc3NvY2lhdGVkIHdpdGggdGhlIGNyZWRlbnRpYWwgaWYgaXQgYmVsb25ncyB0byBhblxuICAgKiB7QGxpbmsgT0F1dGhQcm92aWRlcn0sIHN1Y2ggYXMgYGZhY2Vib29rLmNvbWAsIGB0d2l0dGVyLmNvbWAsIGV0Yy5cbiAgICogQHJlYWRvbmx5XG4gICAqL1xuICBhY2Nlc3NUb2tlbj86IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBPQXV0aCBhY2Nlc3MgdG9rZW4gc2VjcmV0IGFzc29jaWF0ZWQgd2l0aCB0aGUgY3JlZGVudGlhbCBpZiBpdCBiZWxvbmdzIHRvIGFuIE9BdXRoIDEuMFxuICAgKiBwcm92aWRlciwgc3VjaCBhcyBgdHdpdHRlci5jb21gLlxuICAgKiBAcmVhZG9ubHlcbiAgICovXG4gIHNlY3JldD86IHN0cmluZztcblxuICBwcml2YXRlIG5vbmNlPzogc3RyaW5nO1xuICBwcml2YXRlIHBlbmRpbmdUb2tlbjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBzdGF0aWMgX2Zyb21QYXJhbXMocGFyYW1zOiBPQXV0aENyZWRlbnRpYWxQYXJhbXMpOiBPQXV0aENyZWRlbnRpYWwge1xuICAgIGNvbnN0IGNyZWQgPSBuZXcgT0F1dGhDcmVkZW50aWFsKHBhcmFtcy5wcm92aWRlcklkLCBwYXJhbXMuc2lnbkluTWV0aG9kKTtcblxuICAgIGlmIChwYXJhbXMuaWRUb2tlbiB8fCBwYXJhbXMuYWNjZXNzVG9rZW4pIHtcbiAgICAgIC8vIE9BdXRoIDIgYW5kIGVpdGhlciBJRCB0b2tlbiBvciBhY2Nlc3MgdG9rZW4uXG4gICAgICBpZiAocGFyYW1zLmlkVG9rZW4pIHtcbiAgICAgICAgY3JlZC5pZFRva2VuID0gcGFyYW1zLmlkVG9rZW47XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJhbXMuYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgY3JlZC5hY2Nlc3NUb2tlbiA9IHBhcmFtcy5hY2Nlc3NUb2tlbjtcbiAgICAgIH1cblxuICAgICAgLy8gQWRkIG5vbmNlIGlmIGF2YWlsYWJsZSBhbmQgbm8gcGVuZGluZ1Rva2VuIGlzIHByZXNlbnQuXG4gICAgICBpZiAocGFyYW1zLm5vbmNlICYmICFwYXJhbXMucGVuZGluZ1Rva2VuKSB7XG4gICAgICAgIGNyZWQubm9uY2UgPSBwYXJhbXMubm9uY2U7XG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJhbXMucGVuZGluZ1Rva2VuKSB7XG4gICAgICAgIGNyZWQucGVuZGluZ1Rva2VuID0gcGFyYW1zLnBlbmRpbmdUb2tlbjtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHBhcmFtcy5vYXV0aFRva2VuICYmIHBhcmFtcy5vYXV0aFRva2VuU2VjcmV0KSB7XG4gICAgICAvLyBPQXV0aCAxIGFuZCBPQXV0aCB0b2tlbiB3aXRoIHRva2VuIHNlY3JldFxuICAgICAgY3JlZC5hY2Nlc3NUb2tlbiA9IHBhcmFtcy5vYXV0aFRva2VuO1xuICAgICAgY3JlZC5zZWNyZXQgPSBwYXJhbXMub2F1dGhUb2tlblNlY3JldDtcbiAgICB9IGVsc2Uge1xuICAgICAgX2ZhaWwoQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUik7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNyZWQ7XG4gIH1cblxuICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gICovXG4gIHRvSlNPTigpOiBvYmplY3Qge1xuICAgIHJldHVybiB7XG4gICAgICBpZFRva2VuOiB0aGlzLmlkVG9rZW4sXG4gICAgICBhY2Nlc3NUb2tlbjogdGhpcy5hY2Nlc3NUb2tlbixcbiAgICAgIHNlY3JldDogdGhpcy5zZWNyZXQsXG4gICAgICBub25jZTogdGhpcy5ub25jZSxcbiAgICAgIHBlbmRpbmdUb2tlbjogdGhpcy5wZW5kaW5nVG9rZW4sXG4gICAgICBwcm92aWRlcklkOiB0aGlzLnByb3ZpZGVySWQsXG4gICAgICBzaWduSW5NZXRob2Q6IHRoaXMuc2lnbkluTWV0aG9kXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGF0aWMgbWV0aG9kIHRvIGRlc2VyaWFsaXplIGEgSlNPTiByZXByZXNlbnRhdGlvbiBvZiBhbiBvYmplY3QgaW50byBhblxuICAgKiB7QGxpbmsgIEF1dGhDcmVkZW50aWFsfS5cbiAgICpcbiAgICogQHBhcmFtIGpzb24gLSBJbnB1dCBjYW4gYmUgZWl0aGVyIE9iamVjdCBvciB0aGUgc3RyaW5naWZpZWQgcmVwcmVzZW50YXRpb24gb2YgdGhlIG9iamVjdC5cbiAgICogV2hlbiBzdHJpbmcgaXMgcHJvdmlkZWQsIEpTT04ucGFyc2Ugd291bGQgYmUgY2FsbGVkIGZpcnN0LlxuICAgKlxuICAgKiBAcmV0dXJucyBJZiB0aGUgSlNPTiBpbnB1dCBkb2VzIG5vdCByZXByZXNlbnQgYW4ge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0sIG51bGwgaXMgcmV0dXJuZWQuXG4gICAqL1xuICBzdGF0aWMgZnJvbUpTT04oanNvbjogc3RyaW5nIHwgb2JqZWN0KTogT0F1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgY29uc3Qgb2JqID0gdHlwZW9mIGpzb24gPT09ICdzdHJpbmcnID8gSlNPTi5wYXJzZShqc29uKSA6IGpzb247XG4gICAgY29uc3QgeyBwcm92aWRlcklkLCBzaWduSW5NZXRob2QsIC4uLnJlc3QgfTogT0F1dGhDcmVkZW50aWFsUGFyYW1zID0gb2JqO1xuICAgIGlmICghcHJvdmlkZXJJZCB8fCAhc2lnbkluTWV0aG9kKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBjcmVkID0gbmV3IE9BdXRoQ3JlZGVudGlhbChwcm92aWRlcklkLCBzaWduSW5NZXRob2QpO1xuICAgIGNyZWQuaWRUb2tlbiA9IHJlc3QuaWRUb2tlbiB8fCB1bmRlZmluZWQ7XG4gICAgY3JlZC5hY2Nlc3NUb2tlbiA9IHJlc3QuYWNjZXNzVG9rZW4gfHwgdW5kZWZpbmVkO1xuICAgIGNyZWQuc2VjcmV0ID0gcmVzdC5zZWNyZXQ7XG4gICAgY3JlZC5ub25jZSA9IHJlc3Qubm9uY2U7XG4gICAgY3JlZC5wZW5kaW5nVG9rZW4gPSByZXN0LnBlbmRpbmdUb2tlbiB8fCBudWxsO1xuICAgIHJldHVybiBjcmVkO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGg6IEF1dGhJbnRlcm5hbCk6IFByb21pc2U8SWRUb2tlblJlc3BvbnNlPiB7XG4gICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIF9saW5rVG9JZFRva2VuKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBpZFRva2VuOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxJZFRva2VuUmVzcG9uc2U+IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcbiAgICByZXF1ZXN0LmlkVG9rZW4gPSBpZFRva2VuO1xuICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGg6IEF1dGhJbnRlcm5hbCk6IFByb21pc2U8SWRUb2tlblJlc3BvbnNlPiB7XG4gICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgcmVxdWVzdC5hdXRvQ3JlYXRlID0gZmFsc2U7XG4gICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkUmVxdWVzdCgpOiBTaWduSW5XaXRoSWRwUmVxdWVzdCB7XG4gICAgY29uc3QgcmVxdWVzdDogU2lnbkluV2l0aElkcFJlcXVlc3QgPSB7XG4gICAgICByZXF1ZXN0VXJpOiBJRFBfUkVRVUVTVF9VUkksXG4gICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZVxuICAgIH07XG5cbiAgICBpZiAodGhpcy5wZW5kaW5nVG9rZW4pIHtcbiAgICAgIHJlcXVlc3QucGVuZGluZ1Rva2VuID0gdGhpcy5wZW5kaW5nVG9rZW47XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHBvc3RCb2R5OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICBpZiAodGhpcy5pZFRva2VuKSB7XG4gICAgICAgIHBvc3RCb2R5WydpZF90b2tlbiddID0gdGhpcy5pZFRva2VuO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgcG9zdEJvZHlbJ2FjY2Vzc190b2tlbiddID0gdGhpcy5hY2Nlc3NUb2tlbjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnNlY3JldCkge1xuICAgICAgICBwb3N0Qm9keVsnb2F1dGhfdG9rZW5fc2VjcmV0J10gPSB0aGlzLnNlY3JldDtcbiAgICAgIH1cblxuICAgICAgcG9zdEJvZHlbJ3Byb3ZpZGVySWQnXSA9IHRoaXMucHJvdmlkZXJJZDtcbiAgICAgIGlmICh0aGlzLm5vbmNlICYmICF0aGlzLnBlbmRpbmdUb2tlbikge1xuICAgICAgICBwb3N0Qm9keVsnbm9uY2UnXSA9IHRoaXMubm9uY2U7XG4gICAgICB9XG5cbiAgICAgIHJlcXVlc3QucG9zdEJvZHkgPSBxdWVyeXN0cmluZyhwb3N0Qm9keSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlcXVlc3Q7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBFbmRwb2ludCxcbiAgSHR0cE1ldGhvZCxcbiAgX2FkZFRpZElmTmVjZXNzYXJ5LFxuICBfbWFrZVRhZ2dlZEVycm9yLFxuICBfcGVyZm9ybUFwaVJlcXVlc3QsXG4gIF9wZXJmb3JtU2lnbkluUmVxdWVzdFxufSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9lcnJvcnMnO1xuaW1wb3J0IHsgSWRUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgU2VydmVyRXJyb3IsIFNlcnZlckVycm9yTWFwIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IEF1dGggfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVSZXF1ZXN0IHtcbiAgcGhvbmVOdW1iZXI6IHN0cmluZztcbiAgcmVjYXB0Y2hhVG9rZW46IHN0cmluZztcbiAgdGVuYW50SWQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VuZFBob25lVmVyaWZpY2F0aW9uQ29kZVJlc3BvbnNlIHtcbiAgc2Vzc2lvbkluZm86IHN0cmluZztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGUoXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVSZXF1ZXN0XG4pOiBQcm9taXNlPFNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVSZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0PFxuICAgIFNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVSZXF1ZXN0LFxuICAgIFNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGVSZXNwb25zZVxuICA+KFxuICAgIGF1dGgsXG4gICAgSHR0cE1ldGhvZC5QT1NULFxuICAgIEVuZHBvaW50LlNFTkRfVkVSSUZJQ0FUSU9OX0NPREUsXG4gICAgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpXG4gICk7XG59XG5cbi8qKlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdCB7XG4gIHRlbXBvcmFyeVByb29mPzogc3RyaW5nO1xuICBwaG9uZU51bWJlcj86IHN0cmluZztcbiAgc2Vzc2lvbkluZm8/OiBzdHJpbmc7XG4gIGNvZGU/OiBzdHJpbmc7XG4gIHRlbmFudElkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpbmtXaXRoUGhvbmVOdW1iZXJSZXF1ZXN0XG4gIGV4dGVuZHMgU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdCB7XG4gIGlkVG9rZW46IHN0cmluZztcbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTaWduSW5XaXRoUGhvbmVOdW1iZXJSZXNwb25zZSBleHRlbmRzIElkVG9rZW5SZXNwb25zZSB7XG4gIHRlbXBvcmFyeVByb29mPzogc3RyaW5nO1xuICBwaG9uZU51bWJlcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhQaG9uZU51bWJlcihcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdFxuKTogUHJvbWlzZTxTaWduSW5XaXRoUGhvbmVOdW1iZXJSZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1TaWduSW5SZXF1ZXN0PFxuICAgIFNpZ25JbldpdGhQaG9uZU51bWJlclJlcXVlc3QsXG4gICAgU2lnbkluV2l0aFBob25lTnVtYmVyUmVzcG9uc2VcbiAgPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5TSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSLFxuICAgIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KVxuICApO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbGlua1dpdGhQaG9uZU51bWJlcihcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogTGlua1dpdGhQaG9uZU51bWJlclJlcXVlc3Rcbik6IFByb21pc2U8U2lnbkluV2l0aFBob25lTnVtYmVyUmVzcG9uc2U+IHtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfcGVyZm9ybVNpZ25JblJlcXVlc3Q8XG4gICAgTGlua1dpdGhQaG9uZU51bWJlclJlcXVlc3QsXG4gICAgU2lnbkluV2l0aFBob25lTnVtYmVyUmVzcG9uc2VcbiAgPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5TSUdOX0lOX1dJVEhfUEhPTkVfTlVNQkVSLFxuICAgIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KVxuICApO1xuICBpZiAocmVzcG9uc2UudGVtcG9yYXJ5UHJvb2YpIHtcbiAgICB0aHJvdyBfbWFrZVRhZ2dlZEVycm9yKGF1dGgsIEF1dGhFcnJvckNvZGUuTkVFRF9DT05GSVJNQVRJT04sIHJlc3BvbnNlKTtcbiAgfVxuICByZXR1cm4gcmVzcG9uc2U7XG59XG5cbmludGVyZmFjZSBWZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nUmVxdWVzdFxuICBleHRlbmRzIFNpZ25JbldpdGhQaG9uZU51bWJlclJlcXVlc3Qge1xuICBvcGVyYXRpb246ICdSRUFVVEgnO1xufVxuXG5jb25zdCBWRVJJRllfUEhPTkVfTlVNQkVSX0ZPUl9FWElTVElOR19FUlJPUl9NQVBfOiBQYXJ0aWFsPFxuICBTZXJ2ZXJFcnJvck1hcDxTZXJ2ZXJFcnJvcj5cbj4gPSB7XG4gIFtTZXJ2ZXJFcnJvci5VU0VSX05PVF9GT1VORF06IEF1dGhFcnJvckNvZGUuVVNFUl9ERUxFVEVEXG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UGhvbmVOdW1iZXJGb3JFeGlzdGluZyhcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdFxuKTogUHJvbWlzZTxTaWduSW5XaXRoUGhvbmVOdW1iZXJSZXNwb25zZT4ge1xuICBjb25zdCBhcGlSZXF1ZXN0OiBWZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nUmVxdWVzdCA9IHtcbiAgICAuLi5yZXF1ZXN0LFxuICAgIG9wZXJhdGlvbjogJ1JFQVVUSCdcbiAgfTtcbiAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdDxcbiAgICBWZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nUmVxdWVzdCxcbiAgICBTaWduSW5XaXRoUGhvbmVOdW1iZXJSZXNwb25zZVxuICA+KFxuICAgIGF1dGgsXG4gICAgSHR0cE1ldGhvZC5QT1NULFxuICAgIEVuZHBvaW50LlNJR05fSU5fV0lUSF9QSE9ORV9OVU1CRVIsXG4gICAgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIGFwaVJlcXVlc3QpLFxuICAgIFZFUklGWV9QSE9ORV9OVU1CRVJfRk9SX0VYSVNUSU5HX0VSUk9SX01BUF9cbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBQcm92aWRlcklkLCBTaWduSW5NZXRob2QgfSBmcm9tICcuLi8uLi9tb2RlbC9lbnVtcyc7XG5cbmltcG9ydCB7IFBob25lT3JPYXV0aFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7XG4gIGxpbmtXaXRoUGhvbmVOdW1iZXIsXG4gIHNpZ25JbldpdGhQaG9uZU51bWJlcixcbiAgU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdCxcbiAgdmVyaWZ5UGhvbmVOdW1iZXJGb3JFeGlzdGluZ1xufSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vc21zJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgSWRUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgQXV0aENyZWRlbnRpYWwgfSBmcm9tICcuL2F1dGhfY3JlZGVudGlhbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGhvbmVBdXRoQ3JlZGVudGlhbFBhcmFtZXRlcnMge1xuICB2ZXJpZmljYXRpb25JZD86IHN0cmluZztcbiAgdmVyaWZpY2F0aW9uQ29kZT86IHN0cmluZztcbiAgcGhvbmVOdW1iZXI/OiBzdHJpbmc7XG4gIHRlbXBvcmFyeVByb29mPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIFJlcHJlc2VudHMgdGhlIGNyZWRlbnRpYWxzIHJldHVybmVkIGJ5IHtAbGluayBQaG9uZUF1dGhQcm92aWRlcn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgUGhvbmVBdXRoQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcbiAgcHJpdmF0ZSBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IHBhcmFtczogUGhvbmVBdXRoQ3JlZGVudGlhbFBhcmFtZXRlcnMpIHtcbiAgICBzdXBlcihQcm92aWRlcklkLlBIT05FLCBTaWduSW5NZXRob2QuUEhPTkUpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBzdGF0aWMgX2Zyb21WZXJpZmljYXRpb24oXG4gICAgdmVyaWZpY2F0aW9uSWQ6IHN0cmluZyxcbiAgICB2ZXJpZmljYXRpb25Db2RlOiBzdHJpbmdcbiAgKTogUGhvbmVBdXRoQ3JlZGVudGlhbCB7XG4gICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHsgdmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUgfSk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIHN0YXRpYyBfZnJvbVRva2VuUmVzcG9uc2UoXG4gICAgcGhvbmVOdW1iZXI6IHN0cmluZyxcbiAgICB0ZW1wb3JhcnlQcm9vZjogc3RyaW5nXG4gICk6IFBob25lQXV0aENyZWRlbnRpYWwge1xuICAgIHJldHVybiBuZXcgUGhvbmVBdXRoQ3JlZGVudGlhbCh7IHBob25lTnVtYmVyLCB0ZW1wb3JhcnlQcm9vZiB9KTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgX2dldElkVG9rZW5SZXNwb25zZShhdXRoOiBBdXRoSW50ZXJuYWwpOiBQcm9taXNlPFBob25lT3JPYXV0aFRva2VuUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gc2lnbkluV2l0aFBob25lTnVtYmVyKGF1dGgsIHRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBfbGlua1RvSWRUb2tlbihcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgaWRUb2tlbjogc3RyaW5nXG4gICk6IFByb21pc2U8SWRUb2tlblJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIGxpbmtXaXRoUGhvbmVOdW1iZXIoYXV0aCwge1xuICAgICAgaWRUb2tlbixcbiAgICAgIC4uLnRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KClcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgX2dldFJlYXV0aGVudGljYXRpb25SZXNvbHZlcihhdXRoOiBBdXRoSW50ZXJuYWwpOiBQcm9taXNlPElkVG9rZW5SZXNwb25zZT4ge1xuICAgIHJldHVybiB2ZXJpZnlQaG9uZU51bWJlckZvckV4aXN0aW5nKGF1dGgsIHRoaXMuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KCkpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBfbWFrZVZlcmlmaWNhdGlvblJlcXVlc3QoKTogU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdCB7XG4gICAgY29uc3QgeyB0ZW1wb3JhcnlQcm9vZiwgcGhvbmVOdW1iZXIsIHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlIH0gPVxuICAgICAgdGhpcy5wYXJhbXM7XG4gICAgaWYgKHRlbXBvcmFyeVByb29mICYmIHBob25lTnVtYmVyKSB7XG4gICAgICByZXR1cm4geyB0ZW1wb3JhcnlQcm9vZiwgcGhvbmVOdW1iZXIgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc2Vzc2lvbkluZm86IHZlcmlmaWNhdGlvbklkLFxuICAgICAgY29kZTogdmVyaWZpY2F0aW9uQ29kZVxuICAgIH07XG4gIH1cblxuICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gKi9cbiAgdG9KU09OKCk6IG9iamVjdCB7XG4gICAgY29uc3Qgb2JqOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkXG4gICAgfTtcbiAgICBpZiAodGhpcy5wYXJhbXMucGhvbmVOdW1iZXIpIHtcbiAgICAgIG9iai5waG9uZU51bWJlciA9IHRoaXMucGFyYW1zLnBob25lTnVtYmVyO1xuICAgIH1cbiAgICBpZiAodGhpcy5wYXJhbXMudGVtcG9yYXJ5UHJvb2YpIHtcbiAgICAgIG9iai50ZW1wb3JhcnlQcm9vZiA9IHRoaXMucGFyYW1zLnRlbXBvcmFyeVByb29mO1xuICAgIH1cbiAgICBpZiAodGhpcy5wYXJhbXMudmVyaWZpY2F0aW9uQ29kZSkge1xuICAgICAgb2JqLnZlcmlmaWNhdGlvbkNvZGUgPSB0aGlzLnBhcmFtcy52ZXJpZmljYXRpb25Db2RlO1xuICAgIH1cbiAgICBpZiAodGhpcy5wYXJhbXMudmVyaWZpY2F0aW9uSWQpIHtcbiAgICAgIG9iai52ZXJpZmljYXRpb25JZCA9IHRoaXMucGFyYW1zLnZlcmlmaWNhdGlvbklkO1xuICAgIH1cblxuICAgIHJldHVybiBvYmo7XG4gIH1cblxuICAvKiogR2VuZXJhdGVzIGEgcGhvbmUgY3JlZGVudGlhbCBiYXNlZCBvbiBhIHBsYWluIG9iamVjdCBvciBhIEpTT04gc3RyaW5nLiAqL1xuICBzdGF0aWMgZnJvbUpTT04oanNvbjogb2JqZWN0IHwgc3RyaW5nKTogUGhvbmVBdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIGlmICh0eXBlb2YganNvbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGpzb24gPSBKU09OLnBhcnNlKGpzb24pO1xuICAgIH1cblxuICAgIGNvbnN0IHsgdmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUsIHBob25lTnVtYmVyLCB0ZW1wb3JhcnlQcm9vZiB9ID1cbiAgICAgIGpzb24gYXMgeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfTtcbiAgICBpZiAoXG4gICAgICAhdmVyaWZpY2F0aW9uQ29kZSAmJlxuICAgICAgIXZlcmlmaWNhdGlvbklkICYmXG4gICAgICAhcGhvbmVOdW1iZXIgJiZcbiAgICAgICF0ZW1wb3JhcnlQcm9vZlxuICAgICkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBQaG9uZUF1dGhDcmVkZW50aWFsKHtcbiAgICAgIHZlcmlmaWNhdGlvbklkLFxuICAgICAgdmVyaWZpY2F0aW9uQ29kZSxcbiAgICAgIHBob25lTnVtYmVyLFxuICAgICAgdGVtcG9yYXJ5UHJvb2ZcbiAgICB9KTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGV4dHJhY3RRdWVyeXN0cmluZywgcXVlcnlzdHJpbmdEZWNvZGUgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBBY3Rpb25Db2RlT3BlcmF0aW9uIH0gZnJvbSAnLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgeyBfYXNzZXJ0IH0gZnJvbSAnLi91dGlsL2Fzc2VydCc7XG5cbi8qKlxuICogRW51bXMgZm9yIGZpZWxkcyBpbiBVUkwgcXVlcnkgc3RyaW5nLlxuICpcbiAqIEBlbnVtIHtzdHJpbmd9XG4gKi9cbmNvbnN0IGVudW0gUXVlcnlGaWVsZCB7XG4gIEFQSV9LRVkgPSAnYXBpS2V5JyxcbiAgQ09ERSA9ICdvb2JDb2RlJyxcbiAgQ09OVElOVUVfVVJMID0gJ2NvbnRpbnVlVXJsJyxcbiAgTEFOR1VBR0VfQ09ERSA9ICdsYW5ndWFnZUNvZGUnLFxuICBNT0RFID0gJ21vZGUnLFxuICBURU5BTlRfSUQgPSAndGVuYW50SWQnXG59XG5cbi8qKlxuICogTWFwcyB0aGUgbW9kZSBzdHJpbmcgaW4gYWN0aW9uIGNvZGUgVVJMIHRvIEFjdGlvbiBDb2RlIEluZm8gb3BlcmF0aW9uLlxuICpcbiAqIEBwYXJhbSBtb2RlXG4gKi9cbmZ1bmN0aW9uIHBhcnNlTW9kZShtb2RlOiBzdHJpbmcgfCBudWxsKTogQWN0aW9uQ29kZU9wZXJhdGlvbiB8IG51bGwge1xuICBzd2l0Y2ggKG1vZGUpIHtcbiAgICBjYXNlICdyZWNvdmVyRW1haWwnOlxuICAgICAgcmV0dXJuIEFjdGlvbkNvZGVPcGVyYXRpb24uUkVDT1ZFUl9FTUFJTDtcbiAgICBjYXNlICdyZXNldFBhc3N3b3JkJzpcbiAgICAgIHJldHVybiBBY3Rpb25Db2RlT3BlcmF0aW9uLlBBU1NXT1JEX1JFU0VUO1xuICAgIGNhc2UgJ3NpZ25Jbic6XG4gICAgICByZXR1cm4gQWN0aW9uQ29kZU9wZXJhdGlvbi5FTUFJTF9TSUdOSU47XG4gICAgY2FzZSAndmVyaWZ5RW1haWwnOlxuICAgICAgcmV0dXJuIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0VNQUlMO1xuICAgIGNhc2UgJ3ZlcmlmeUFuZENoYW5nZUVtYWlsJzpcbiAgICAgIHJldHVybiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMO1xuICAgIGNhc2UgJ3JldmVydFNlY29uZEZhY3RvckFkZGl0aW9uJzpcbiAgICAgIHJldHVybiBBY3Rpb25Db2RlT3BlcmF0aW9uLlJFVkVSVF9TRUNPTkRfRkFDVE9SX0FERElUSU9OO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBwYXJzZSBGREwgbGlua3NcbiAqXG4gKiBAcGFyYW0gdXJsXG4gKi9cbmZ1bmN0aW9uIHBhcnNlRGVlcExpbmsodXJsOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBsaW5rID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKHVybCkpWydsaW5rJ107XG5cbiAgLy8gRG91YmxlIGxpbmsgY2FzZSAoYXV0b21hdGljIHJlZGlyZWN0KS5cbiAgY29uc3QgZG91YmxlRGVlcExpbmsgPSBsaW5rXG4gICAgPyBxdWVyeXN0cmluZ0RlY29kZShleHRyYWN0UXVlcnlzdHJpbmcobGluaykpWydkZWVwX2xpbmtfaWQnXVxuICAgIDogbnVsbDtcbiAgLy8gaU9TIGN1c3RvbSBzY2hlbWUgbGlua3MuXG4gIGNvbnN0IGlPU0RlZXBMaW5rID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKHVybCkpW1xuICAgICdkZWVwX2xpbmtfaWQnXG4gIF07XG4gIGNvbnN0IGlPU0RvdWJsZURlZXBMaW5rID0gaU9TRGVlcExpbmtcbiAgICA/IHF1ZXJ5c3RyaW5nRGVjb2RlKGV4dHJhY3RRdWVyeXN0cmluZyhpT1NEZWVwTGluaykpWydsaW5rJ11cbiAgICA6IG51bGw7XG4gIHJldHVybiBpT1NEb3VibGVEZWVwTGluayB8fCBpT1NEZWVwTGluayB8fCBkb3VibGVEZWVwTGluayB8fCBsaW5rIHx8IHVybDtcbn1cblxuLyoqXG4gKiBBIHV0aWxpdHkgY2xhc3MgdG8gcGFyc2UgZW1haWwgYWN0aW9uIFVSTHMgc3VjaCBhcyBwYXNzd29yZCByZXNldCwgZW1haWwgdmVyaWZpY2F0aW9uLFxuICogZW1haWwgbGluayBzaWduIGluLCBldGMuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgQWN0aW9uQ29kZVVSTCB7XG4gIC8qKlxuICAgKiBUaGUgQVBJIGtleSBvZiB0aGUgZW1haWwgYWN0aW9uIGxpbmsuXG4gICAqL1xuICByZWFkb25seSBhcGlLZXk6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBhY3Rpb24gY29kZSBvZiB0aGUgZW1haWwgYWN0aW9uIGxpbmsuXG4gICAqL1xuICByZWFkb25seSBjb2RlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgY29udGludWUgVVJMIG9mIHRoZSBlbWFpbCBhY3Rpb24gbGluay4gTnVsbCBpZiBub3QgcHJvdmlkZWQuXG4gICAqL1xuICByZWFkb25seSBjb250aW51ZVVybDogc3RyaW5nIHwgbnVsbDtcbiAgLyoqXG4gICAqIFRoZSBsYW5ndWFnZSBjb2RlIG9mIHRoZSBlbWFpbCBhY3Rpb24gbGluay4gTnVsbCBpZiBub3QgcHJvdmlkZWQuXG4gICAqL1xuICByZWFkb25seSBsYW5ndWFnZUNvZGU6IHN0cmluZyB8IG51bGw7XG4gIC8qKlxuICAgKiBUaGUgYWN0aW9uIHBlcmZvcm1lZCBieSB0aGUgZW1haWwgYWN0aW9uIGxpbmsuIEl0IHJldHVybnMgZnJvbSBvbmUgb2YgdGhlIHR5cGVzIGZyb21cbiAgICoge0BsaW5rIEFjdGlvbkNvZGVJbmZvfVxuICAgKi9cbiAgcmVhZG9ubHkgb3BlcmF0aW9uOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgdGVuYW50IElEIG9mIHRoZSBlbWFpbCBhY3Rpb24gbGluay4gTnVsbCBpZiB0aGUgZW1haWwgYWN0aW9uIGlzIGZyb20gdGhlIHBhcmVudCBwcm9qZWN0LlxuICAgKi9cbiAgcmVhZG9ubHkgdGVuYW50SWQ6IHN0cmluZyB8IG51bGw7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBhY3Rpb25MaW5rIC0gVGhlIGxpbmsgZnJvbSB3aGljaCB0byBleHRyYWN0IHRoZSBVUkwuXG4gICAqIEByZXR1cm5zIFRoZSB7QGxpbmsgQWN0aW9uQ29kZVVSTH0gb2JqZWN0LCBvciBudWxsIGlmIHRoZSBsaW5rIGlzIGludmFsaWQuXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAgY29uc3RydWN0b3IoYWN0aW9uTGluazogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2VhcmNoUGFyYW1zID0gcXVlcnlzdHJpbmdEZWNvZGUoZXh0cmFjdFF1ZXJ5c3RyaW5nKGFjdGlvbkxpbmspKTtcbiAgICBjb25zdCBhcGlLZXkgPSBzZWFyY2hQYXJhbXNbUXVlcnlGaWVsZC5BUElfS0VZXSA/PyBudWxsO1xuICAgIGNvbnN0IGNvZGUgPSBzZWFyY2hQYXJhbXNbUXVlcnlGaWVsZC5DT0RFXSA/PyBudWxsO1xuICAgIGNvbnN0IG9wZXJhdGlvbiA9IHBhcnNlTW9kZShzZWFyY2hQYXJhbXNbUXVlcnlGaWVsZC5NT0RFXSA/PyBudWxsKTtcbiAgICAvLyBWYWxpZGF0ZSBBUEkga2V5LCBjb2RlIGFuZCBtb2RlLlxuICAgIF9hc3NlcnQoYXBpS2V5ICYmIGNvZGUgJiYgb3BlcmF0aW9uLCBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SKTtcbiAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICB0aGlzLm9wZXJhdGlvbiA9IG9wZXJhdGlvbjtcbiAgICB0aGlzLmNvZGUgPSBjb2RlO1xuICAgIHRoaXMuY29udGludWVVcmwgPSBzZWFyY2hQYXJhbXNbUXVlcnlGaWVsZC5DT05USU5VRV9VUkxdID8/IG51bGw7XG4gICAgdGhpcy5sYW5ndWFnZUNvZGUgPSBzZWFyY2hQYXJhbXNbUXVlcnlGaWVsZC5MQU5HVUFHRV9DT0RFXSA/PyBudWxsO1xuICAgIHRoaXMudGVuYW50SWQgPSBzZWFyY2hQYXJhbXNbUXVlcnlGaWVsZC5URU5BTlRfSURdID8/IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2VzIHRoZSBlbWFpbCBhY3Rpb24gbGluayBzdHJpbmcgYW5kIHJldHVybnMgYW4ge0BsaW5rIEFjdGlvbkNvZGVVUkx9IGlmIHRoZSBsaW5rIGlzIHZhbGlkLFxuICAgKiBvdGhlcndpc2UgcmV0dXJucyBudWxsLlxuICAgKlxuICAgKiBAcGFyYW0gbGluayAgLSBUaGUgZW1haWwgYWN0aW9uIGxpbmsgc3RyaW5nLlxuICAgKiBAcmV0dXJucyBUaGUge0BsaW5rIEFjdGlvbkNvZGVVUkx9IG9iamVjdCwgb3IgbnVsbCBpZiB0aGUgbGluayBpcyBpbnZhbGlkLlxuICAgKlxuICAgKiBAcHVibGljXG4gICAqL1xuICBzdGF0aWMgcGFyc2VMaW5rKGxpbms6IHN0cmluZyk6IEFjdGlvbkNvZGVVUkwgfCBudWxsIHtcbiAgICBjb25zdCBhY3Rpb25MaW5rID0gcGFyc2VEZWVwTGluayhsaW5rKTtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIG5ldyBBY3Rpb25Db2RlVVJMKGFjdGlvbkxpbmspO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogUGFyc2VzIHRoZSBlbWFpbCBhY3Rpb24gbGluayBzdHJpbmcgYW5kIHJldHVybnMgYW4ge0BsaW5rIEFjdGlvbkNvZGVVUkx9IGlmXG4gKiB0aGUgbGluayBpcyB2YWxpZCwgb3RoZXJ3aXNlIHJldHVybnMgbnVsbC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUFjdGlvbkNvZGVVUkwobGluazogc3RyaW5nKTogQWN0aW9uQ29kZVVSTCB8IG51bGwge1xuICByZXR1cm4gQWN0aW9uQ29kZVVSTC5wYXJzZUxpbmsobGluayk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgUHJvdmlkZXJJZCwgU2lnbkluTWV0aG9kIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuaW1wb3J0IHsgQXV0aFByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHsgQWN0aW9uQ29kZVVSTCB9IGZyb20gJy4uL2FjdGlvbl9jb2RlX3VybCc7XG5pbXBvcnQgeyBFbWFpbEF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vY3JlZGVudGlhbHMvZW1haWwnO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5pbXBvcnQgeyBfYXNzZXJ0IH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuXG4vKipcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIHtAbGluayBFbWFpbEF1dGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjbGFzcyBFbWFpbEF1dGhQcm92aWRlciBpbXBsZW1lbnRzIEF1dGhQcm92aWRlciB7XG4gIC8qKlxuICAgKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5QQVNTV09SRCwgZXZlbiBmb3IgZW1haWwgbGluay5cbiAgICovXG4gIHN0YXRpYyByZWFkb25seSBQUk9WSURFUl9JRDogJ3Bhc3N3b3JkJyA9IFByb3ZpZGVySWQuUEFTU1dPUkQ7XG4gIC8qKlxuICAgKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX1BBU1NXT1JELlxuICAgKi9cbiAgc3RhdGljIHJlYWRvbmx5IEVNQUlMX1BBU1NXT1JEX1NJR05fSU5fTUVUSE9EOiAncGFzc3dvcmQnID1cbiAgICBTaWduSW5NZXRob2QuRU1BSUxfUEFTU1dPUkQ7XG4gIC8qKlxuICAgKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX0xJTksuXG4gICAqL1xuICBzdGF0aWMgcmVhZG9ubHkgRU1BSUxfTElOS19TSUdOX0lOX01FVEhPRDogJ2VtYWlsTGluaycgPVxuICAgIFNpZ25Jbk1ldGhvZC5FTUFJTF9MSU5LO1xuICAvKipcbiAgICogQWx3YXlzIHNldCB0byB7QGxpbmsgUHJvdmlkZXJJZH0uUEFTU1dPUkQsIGV2ZW4gZm9yIGVtYWlsIGxpbmsuXG4gICAqL1xuICByZWFkb25seSBwcm92aWRlcklkID0gRW1haWxBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQ7XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSB1c2luZyBhbiBlbWFpbCBhbmQgcGFzc3dvcmQuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogY29uc3QgYXV0aENyZWRlbnRpYWwgPSBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsKGVtYWlsLCBwYXNzd29yZCk7XG4gICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgYXV0aENyZWRlbnRpYWwpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gZW1haWwgLSBFbWFpbCBhZGRyZXNzLlxuICAgKiBAcGFyYW0gcGFzc3dvcmQgLSBVc2VyIGFjY291bnQgcGFzc3dvcmQuXG4gICAqIEByZXR1cm5zIFRoZSBhdXRoIHByb3ZpZGVyIGNyZWRlbnRpYWwuXG4gICAqL1xuICBzdGF0aWMgY3JlZGVudGlhbChlbWFpbDogc3RyaW5nLCBwYXNzd29yZDogc3RyaW5nKTogRW1haWxBdXRoQ3JlZGVudGlhbCB7XG4gICAgcmV0dXJuIEVtYWlsQXV0aENyZWRlbnRpYWwuX2Zyb21FbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZCk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IHVzaW5nIGFuIGVtYWlsIGFuZCBhbiBlbWFpbCBsaW5rIGFmdGVyIGEgc2lnbiBpbiB3aXRoXG4gICAqIGVtYWlsIGxpbmsgb3BlcmF0aW9uLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gRW1haWxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbFdpdGhMaW5rKGF1dGgsIGVtYWlsLCBlbWFpbExpbmspO1xuICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGgsIGF1dGhDcmVkZW50aWFsKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogYXdhaXQgc2VuZFNpZ25JbkxpbmtUb0VtYWlsKGF1dGgsIGVtYWlsKTtcbiAgICogLy8gT2J0YWluIGVtYWlsTGluayBmcm9tIHVzZXIuXG4gICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbCwgZW1haWxMaW5rKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZSB1c2VkIHRvIHZlcmlmeSB0aGUgbGluay5cbiAgICogQHBhcmFtIGVtYWlsIC0gRW1haWwgYWRkcmVzcy5cbiAgICogQHBhcmFtIGVtYWlsTGluayAtIFNpZ24taW4gZW1haWwgbGluay5cbiAgICogQHJldHVybnMgLSBUaGUgYXV0aCBwcm92aWRlciBjcmVkZW50aWFsLlxuICAgKi9cbiAgc3RhdGljIGNyZWRlbnRpYWxXaXRoTGluayhcbiAgICBlbWFpbDogc3RyaW5nLFxuICAgIGVtYWlsTGluazogc3RyaW5nXG4gICk6IEVtYWlsQXV0aENyZWRlbnRpYWwge1xuICAgIGNvbnN0IGFjdGlvbkNvZGVVcmwgPSBBY3Rpb25Db2RlVVJMLnBhcnNlTGluayhlbWFpbExpbmspO1xuICAgIF9hc3NlcnQoYWN0aW9uQ29kZVVybCwgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUik7XG5cbiAgICByZXR1cm4gRW1haWxBdXRoQ3JlZGVudGlhbC5fZnJvbUVtYWlsQW5kQ29kZShcbiAgICAgIGVtYWlsLFxuICAgICAgYWN0aW9uQ29kZVVybC5jb2RlLFxuICAgICAgYWN0aW9uQ29kZVVybC50ZW5hbnRJZFxuICAgICk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBdXRoUHJvdmlkZXIgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG4vKipcbiAqIE1hcCBvZiBPQXV0aCBDdXN0b20gUGFyYW1ldGVycy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCB0eXBlIEN1c3RvbVBhcmFtZXRlcnMgPSBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4vKipcbiAqIFRoZSBiYXNlIGNsYXNzIGZvciBhbGwgRmVkZXJhdGVkIHByb3ZpZGVycyAoT0F1dGggKGluY2x1ZGluZyBPSURDKSwgU0FNTCkuXG4gKlxuICogVGhpcyBjbGFzcyBpcyBub3QgbWVhbnQgdG8gYmUgaW5zdGFudGlhdGVkIGRpcmVjdGx5LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEZlZGVyYXRlZEF1dGhQcm92aWRlciBpbXBsZW1lbnRzIEF1dGhQcm92aWRlciB7XG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgZGVmYXVsdExhbmd1YWdlQ29kZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBjdXN0b21QYXJhbWV0ZXJzOiBDdXN0b21QYXJhbWV0ZXJzID0ge307XG5cbiAgLyoqXG4gICAqIENvbnN0cnVjdG9yIGZvciBnZW5lcmljIE9BdXRoIHByb3ZpZGVycy5cbiAgICpcbiAgICogQHBhcmFtIHByb3ZpZGVySWQgLSBQcm92aWRlciBmb3Igd2hpY2ggY3JlZGVudGlhbHMgc2hvdWxkIGJlIGdlbmVyYXRlZC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHJlYWRvbmx5IHByb3ZpZGVySWQ6IHN0cmluZykge31cblxuICAvKipcbiAgICogU2V0IHRoZSBsYW5ndWFnZSBnb2RlLlxuICAgKlxuICAgKiBAcGFyYW0gbGFuZ3VhZ2VDb2RlIC0gbGFuZ3VhZ2UgY29kZVxuICAgKi9cbiAgc2V0RGVmYXVsdExhbmd1YWdlKGxhbmd1YWdlQ29kZTogc3RyaW5nIHwgbnVsbCk6IHZvaWQge1xuICAgIHRoaXMuZGVmYXVsdExhbmd1YWdlQ29kZSA9IGxhbmd1YWdlQ29kZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBPQXV0aCBjdXN0b20gcGFyYW1ldGVycyB0byBwYXNzIGluIGFuIE9BdXRoIHJlcXVlc3QgZm9yIHBvcHVwIGFuZCByZWRpcmVjdCBzaWduLWluXG4gICAqIG9wZXJhdGlvbnMuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIEZvciBhIGRldGFpbGVkIGxpc3QsIGNoZWNrIHRoZSByZXNlcnZlZCByZXF1aXJlZCBPQXV0aCAyLjAgcGFyYW1ldGVycyBzdWNoIGFzIGBjbGllbnRfaWRgLFxuICAgKiBgcmVkaXJlY3RfdXJpYCwgYHNjb3BlYCwgYHJlc3BvbnNlX3R5cGVgLCBhbmQgYHN0YXRlYCBhcmUgbm90IGFsbG93ZWQgYW5kIHdpbGwgYmUgaWdub3JlZC5cbiAgICpcbiAgICogQHBhcmFtIGN1c3RvbU9BdXRoUGFyYW1ldGVycyAtIFRoZSBjdXN0b20gT0F1dGggcGFyYW1ldGVycyB0byBwYXNzIGluIHRoZSBPQXV0aCByZXF1ZXN0LlxuICAgKi9cbiAgc2V0Q3VzdG9tUGFyYW1ldGVycyhjdXN0b21PQXV0aFBhcmFtZXRlcnM6IEN1c3RvbVBhcmFtZXRlcnMpOiBBdXRoUHJvdmlkZXIge1xuICAgIHRoaXMuY3VzdG9tUGFyYW1ldGVycyA9IGN1c3RvbU9BdXRoUGFyYW1ldGVycztcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSB0aGUgY3VycmVudCBsaXN0IG9mIHtAbGluayBDdXN0b21QYXJhbWV0ZXJzfS5cbiAgICovXG4gIGdldEN1c3RvbVBhcmFtZXRlcnMoKTogQ3VzdG9tUGFyYW1ldGVycyB7XG4gICAgcmV0dXJuIHRoaXMuY3VzdG9tUGFyYW1ldGVycztcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEF1dGhQcm92aWRlciwgVXNlckNyZWRlbnRpYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5pbXBvcnQgeyBfYXNzZXJ0IH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5cbmltcG9ydCB7IE9BdXRoQ3JlZGVudGlhbCwgT0F1dGhDcmVkZW50aWFsUGFyYW1zIH0gZnJvbSAnLi4vY3JlZGVudGlhbHMvb2F1dGgnO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgU2lnbkluV2l0aElkcFJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vLi4vaW50ZXJuYWwnO1xuaW1wb3J0IHsgRmVkZXJhdGVkQXV0aFByb3ZpZGVyIH0gZnJvbSAnLi9mZWRlcmF0ZWQnO1xuXG4vKipcbiAqIERlZmluZXMgdGhlIG9wdGlvbnMgZm9yIGluaXRpYWxpemluZyBhbiB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAcmVtYXJrc1xuICogRm9yIElEIHRva2VucyB3aXRoIG5vbmNlIGNsYWltLCB0aGUgcmF3IG5vbmNlIGhhcyB0byBhbHNvIGJlIHByb3ZpZGVkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBPQXV0aENyZWRlbnRpYWxPcHRpb25zIHtcbiAgLyoqXG4gICAqIFRoZSBPQXV0aCBJRCB0b2tlbiB1c2VkIHRvIGluaXRpYWxpemUgdGhlIHtAbGluayBPQXV0aENyZWRlbnRpYWx9LlxuICAgKi9cbiAgaWRUb2tlbj86IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBPQXV0aCBhY2Nlc3MgdG9rZW4gdXNlZCB0byBpbml0aWFsaXplIHRoZSB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfS5cbiAgICovXG4gIGFjY2Vzc1Rva2VuPzogc3RyaW5nO1xuICAvKipcbiAgICogVGhlIHJhdyBub25jZSBhc3NvY2lhdGVkIHdpdGggdGhlIElEIHRva2VuLlxuICAgKlxuICAgKiBAcmVtYXJrc1xuICAgKiBJdCBpcyByZXF1aXJlZCB3aGVuIGFuIElEIHRva2VuIHdpdGggYSBub25jZSBmaWVsZCBpcyBwcm92aWRlZC4gVGhlIFNIQS0yNTYgaGFzaCBvZiB0aGVcbiAgICogcmF3IG5vbmNlIG11c3QgbWF0Y2ggdGhlIG5vbmNlIGZpZWxkIGluIHRoZSBJRCB0b2tlbi5cbiAgICovXG4gIHJhd05vbmNlPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIENvbW1vbiBjb2RlIHRvIGFsbCBPQXV0aCBwcm92aWRlcnMuIFRoaXMgaXMgc2VwYXJhdGUgZnJvbSB0aGVcbiAqIHtAbGluayBPQXV0aFByb3ZpZGVyfSBzbyB0aGF0IGNoaWxkIHByb3ZpZGVycyAobGlrZVxuICoge0BsaW5rIEdvb2dsZUF1dGhQcm92aWRlcn0pIGRvbid0IGluaGVyaXQgdGhlIGBjcmVkZW50aWFsYCBpbnN0YW5jZSBtZXRob2QuXG4gKiBJbnN0ZWFkLCB0aGV5IHJlbHkgb24gYSBzdGF0aWMgYGNyZWRlbnRpYWxgIG1ldGhvZC5cbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJhc2VPQXV0aFByb3ZpZGVyXG4gIGV4dGVuZHMgRmVkZXJhdGVkQXV0aFByb3ZpZGVyXG4gIGltcGxlbWVudHMgQXV0aFByb3ZpZGVyXG57XG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgcHJpdmF0ZSBzY29wZXM6IHN0cmluZ1tdID0gW107XG5cbiAgLyoqXG4gICAqIEFkZCBhbiBPQXV0aCBzY29wZSB0byB0aGUgY3JlZGVudGlhbC5cbiAgICpcbiAgICogQHBhcmFtIHNjb3BlIC0gUHJvdmlkZXIgT0F1dGggc2NvcGUgdG8gYWRkLlxuICAgKi9cbiAgYWRkU2NvcGUoc2NvcGU6IHN0cmluZyk6IEF1dGhQcm92aWRlciB7XG4gICAgLy8gSWYgbm90IGFscmVhZHkgYWRkZWQsIGFkZCBzY29wZSB0byBsaXN0LlxuICAgIGlmICghdGhpcy5zY29wZXMuaW5jbHVkZXMoc2NvcGUpKSB7XG4gICAgICB0aGlzLnNjb3Blcy5wdXNoKHNjb3BlKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmUgdGhlIGN1cnJlbnQgbGlzdCBvZiBPQXV0aCBzY29wZXMuXG4gICAqL1xuICBnZXRTY29wZXMoKTogc3RyaW5nW10ge1xuICAgIHJldHVybiBbLi4udGhpcy5zY29wZXNdO1xuICB9XG59XG5cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgZ2VuZXJpYyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcignZ29vZ2xlLmNvbScpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxuICpcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xuICogaWYgKHJlc3VsdCkge1xuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgT0F1dGggQWNjZXNzIFRva2VuIGZvciB0aGUgcHJvdmlkZXIuXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBwcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChhdXRoLCByZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgT0F1dGhQcm92aWRlcignZ29vZ2xlLmNvbScpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcbiAqXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqIC8vIFRoaXMgZ2l2ZXMgeW91IGEgT0F1dGggQWNjZXNzIFRva2VuIGZvciB0aGUgcHJvdmlkZXIuXG4gKiBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIGBgYFxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgT0F1dGhQcm92aWRlciBleHRlbmRzIEJhc2VPQXV0aFByb3ZpZGVyIHtcbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIEpTT04gc3RyaW5nIG9yIGEgcGxhaW4gb2JqZWN0LlxuICAgKiBAcGFyYW0ganNvbiAtIEEgcGxhaW4gb2JqZWN0IG9yIGEgSlNPTiBzdHJpbmdcbiAgICovXG4gIHN0YXRpYyBjcmVkZW50aWFsRnJvbUpTT04oanNvbjogb2JqZWN0IHwgc3RyaW5nKTogT0F1dGhDcmVkZW50aWFsIHtcbiAgICBjb25zdCBvYmogPSB0eXBlb2YganNvbiA9PT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKGpzb24pIDoganNvbjtcbiAgICBfYXNzZXJ0KFxuICAgICAgJ3Byb3ZpZGVySWQnIGluIG9iaiAmJiAnc2lnbkluTWV0aG9kJyBpbiBvYmosXG4gICAgICBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SXG4gICAgKTtcbiAgICByZXR1cm4gT0F1dGhDcmVkZW50aWFsLl9mcm9tUGFyYW1zKG9iaik7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSBnZW5lcmljIE9BdXRoIHByb3ZpZGVyJ3MgYWNjZXNzIHRva2VuIG9yIElEIHRva2VuLlxuICAgKlxuICAgKiBAcmVtYXJrc1xuICAgKiBUaGUgcmF3IG5vbmNlIGlzIHJlcXVpcmVkIHdoZW4gYW4gSUQgdG9rZW4gd2l0aCBhIG5vbmNlIGZpZWxkIGlzIHByb3ZpZGVkLiBUaGUgU0hBLTI1NiBoYXNoIG9mXG4gICAqIHRoZSByYXcgbm9uY2UgbXVzdCBtYXRjaCB0aGUgbm9uY2UgZmllbGQgaW4gdGhlIElEIHRva2VuLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIGBnb29nbGVVc2VyYCBmcm9tIHRoZSBvbnN1Y2Nlc3MgR29vZ2xlIFNpZ24gSW4gY2FsbGJhY2suXG4gICAqIC8vIEluaXRpYWxpemUgYSBnZW5lcmF0ZSBPQXV0aCBwcm92aWRlciB3aXRoIGEgYGdvb2dsZS5jb21gIHByb3ZpZGVySWQuXG4gICAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IE9BdXRoUHJvdmlkZXIoJ2dvb2dsZS5jb20nKTtcbiAgICogY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWwoe1xuICAgKiAgIGlkVG9rZW46IGdvb2dsZVVzZXIuZ2V0QXV0aFJlc3BvbnNlKCkuaWRfdG9rZW4sXG4gICAqIH0pO1xuICAgKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChjcmVkZW50aWFsKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBwYXJhbXMgLSBFaXRoZXIgdGhlIG9wdGlvbnMgb2JqZWN0IGNvbnRhaW5pbmcgdGhlIElEIHRva2VuLCBhY2Nlc3MgdG9rZW4gYW5kIHJhdyBub25jZVxuICAgKiBvciB0aGUgSUQgdG9rZW4gc3RyaW5nLlxuICAgKi9cbiAgY3JlZGVudGlhbChwYXJhbXM6IE9BdXRoQ3JlZGVudGlhbE9wdGlvbnMpOiBPQXV0aENyZWRlbnRpYWwge1xuICAgIHJldHVybiB0aGlzLl9jcmVkZW50aWFsKHsgLi4ucGFyYW1zLCBub25jZTogcGFyYW1zLnJhd05vbmNlIH0pO1xuICB9XG5cbiAgLyoqIEFuIGludGVybmFsIGNyZWRlbnRpYWwgbWV0aG9kIHRoYXQgYWNjZXB0cyBtb3JlIHBlcm1pc3NpdmUgb3B0aW9ucyAqL1xuICBwcml2YXRlIF9jcmVkZW50aWFsKFxuICAgIHBhcmFtczogT21pdDxPQXV0aENyZWRlbnRpYWxQYXJhbXMsICdzaWduSW5NZXRob2QnIHwgJ3Byb3ZpZGVySWQnPlxuICApOiBPQXV0aENyZWRlbnRpYWwge1xuICAgIF9hc3NlcnQocGFyYW1zLmlkVG9rZW4gfHwgcGFyYW1zLmFjY2Vzc1Rva2VuLCBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SKTtcbiAgICAvLyBGb3IgT0F1dGhDcmVkZW50aWFsLCBzaWduIGluIG1ldGhvZCBpcyBzYW1lIGFzIHByb3ZpZGVySWQuXG4gICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyh7XG4gICAgICAuLi5wYXJhbXMsXG4gICAgICBwcm92aWRlcklkOiB0aGlzLnByb3ZpZGVySWQsXG4gICAgICBzaWduSW5NZXRob2Q6IHRoaXMucHJvdmlkZXJJZFxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICpcbiAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICovXG4gIHN0YXRpYyBjcmVkZW50aWFsRnJvbVJlc3VsdChcbiAgICB1c2VyQ3JlZGVudGlhbDogVXNlckNyZWRlbnRpYWxcbiAgKTogT0F1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgcmV0dXJuIE9BdXRoUHJvdmlkZXIub2F1dGhDcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdChcbiAgICAgIHVzZXJDcmVkZW50aWFsIGFzIFVzZXJDcmVkZW50aWFsSW50ZXJuYWxcbiAgICApO1xuICB9XG4gIC8qKlxuICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgKi9cbiAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3I6IEZpcmViYXNlRXJyb3IpOiBPQXV0aENyZWRlbnRpYWwgfCBudWxsIHtcbiAgICByZXR1cm4gT0F1dGhQcm92aWRlci5vYXV0aENyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KFxuICAgICAgKGVycm9yLmN1c3RvbURhdGEgfHwge30pIGFzIFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIG9hdXRoQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3Qoe1xuICAgIF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlXG4gIH06IFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlKTogT0F1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgaWYgKCF0b2tlblJlc3BvbnNlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCB7XG4gICAgICBvYXV0aElkVG9rZW4sXG4gICAgICBvYXV0aEFjY2Vzc1Rva2VuLFxuICAgICAgb2F1dGhUb2tlblNlY3JldCxcbiAgICAgIHBlbmRpbmdUb2tlbixcbiAgICAgIG5vbmNlLFxuICAgICAgcHJvdmlkZXJJZFxuICAgIH0gPSB0b2tlblJlc3BvbnNlIGFzIFNpZ25JbldpdGhJZHBSZXNwb25zZTtcbiAgICBpZiAoXG4gICAgICAhb2F1dGhBY2Nlc3NUb2tlbiAmJlxuICAgICAgIW9hdXRoVG9rZW5TZWNyZXQgJiZcbiAgICAgICFvYXV0aElkVG9rZW4gJiZcbiAgICAgICFwZW5kaW5nVG9rZW5cbiAgICApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlmICghcHJvdmlkZXJJZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBuZXcgT0F1dGhQcm92aWRlcihwcm92aWRlcklkKS5fY3JlZGVudGlhbCh7XG4gICAgICAgIGlkVG9rZW46IG9hdXRoSWRUb2tlbixcbiAgICAgICAgYWNjZXNzVG9rZW46IG9hdXRoQWNjZXNzVG9rZW4sXG4gICAgICAgIG5vbmNlLFxuICAgICAgICBwZW5kaW5nVG9rZW5cbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFVzZXJDcmVkZW50aWFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IEZpcmViYXNlRXJyb3IgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbmltcG9ydCB7IFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgT0F1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vY3JlZGVudGlhbHMvb2F1dGgnO1xuaW1wb3J0IHsgQmFzZU9BdXRoUHJvdmlkZXIgfSBmcm9tICcuL29hdXRoJztcbmltcG9ydCB7IFByb3ZpZGVySWQsIFNpZ25Jbk1ldGhvZCB9IGZyb20gJy4uLy4uL21vZGVsL2VudW1zJztcblxuLyoqXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhbiB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmb3Ige0BsaW5rIFByb3ZpZGVySWR9LkZBQ0VCT09LLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IEZhY2Vib29rQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHJlc3VsdCk7XG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcG9wdXAuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKlxuICogLy8gVGhlIHNpZ25lZC1pbiB1c2VyIGluZm8uXG4gKiBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogYGBgXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgRmFjZWJvb2tBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XG4gIC8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LkZBQ0VCT09LLiAqL1xuICBzdGF0aWMgcmVhZG9ubHkgRkFDRUJPT0tfU0lHTl9JTl9NRVRIT0Q6ICdmYWNlYm9vay5jb20nID1cbiAgICBTaWduSW5NZXRob2QuRkFDRUJPT0s7XG4gIC8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5GQUNFQk9PSy4gKi9cbiAgc3RhdGljIHJlYWRvbmx5IFBST1ZJREVSX0lEOiAnZmFjZWJvb2suY29tJyA9IFByb3ZpZGVySWQuRkFDRUJPT0s7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoUHJvdmlkZXJJZC5GQUNFQk9PSyk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGNyZWRlbnRpYWwgZm9yIEZhY2Vib29rLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIGBldmVudGAgZnJvbSB0aGUgRmFjZWJvb2sgYXV0aC5hdXRoUmVzcG9uc2VDaGFuZ2UgY2FsbGJhY2suXG4gICAqIGNvbnN0IGNyZWRlbnRpYWwgPSBGYWNlYm9va0F1dGhQcm92aWRlci5jcmVkZW50aWFsKGV2ZW50LmF1dGhSZXNwb25zZS5hY2Nlc3NUb2tlbik7XG4gICAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGNyZWRlbnRpYWwpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gRmFjZWJvb2sgYWNjZXNzIHRva2VuLlxuICAgKi9cbiAgc3RhdGljIGNyZWRlbnRpYWwoYWNjZXNzVG9rZW46IHN0cmluZyk6IE9BdXRoQ3JlZGVudGlhbCB7XG4gICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyh7XG4gICAgICBwcm92aWRlcklkOiBGYWNlYm9va0F1dGhQcm92aWRlci5QUk9WSURFUl9JRCxcbiAgICAgIHNpZ25Jbk1ldGhvZDogRmFjZWJvb2tBdXRoUHJvdmlkZXIuRkFDRUJPT0tfU0lHTl9JTl9NRVRIT0QsXG4gICAgICBhY2Nlc3NUb2tlblxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfS5cbiAgICpcbiAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICovXG4gIHN0YXRpYyBjcmVkZW50aWFsRnJvbVJlc3VsdChcbiAgICB1c2VyQ3JlZGVudGlhbDogVXNlckNyZWRlbnRpYWxcbiAgKTogT0F1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgcmV0dXJuIEZhY2Vib29rQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KFxuICAgICAgdXNlckNyZWRlbnRpYWwgYXMgVXNlckNyZWRlbnRpYWxJbnRlcm5hbFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcbiAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICovXG4gIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yOiBGaXJlYmFzZUVycm9yKTogT0F1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgcmV0dXJuIEZhY2Vib29rQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KFxuICAgICAgKGVycm9yLmN1c3RvbURhdGEgfHwge30pIGFzIFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHtcbiAgICBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZVxuICB9OiBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZSk6IE9BdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIGlmICghdG9rZW5SZXNwb25zZSB8fCAhKCdvYXV0aEFjY2Vzc1Rva2VuJyBpbiB0b2tlblJlc3BvbnNlKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKCF0b2tlblJlc3BvbnNlLm9hdXRoQWNjZXNzVG9rZW4pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gRmFjZWJvb2tBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh0b2tlblJlc3BvbnNlLm9hdXRoQWNjZXNzVG9rZW4pO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuaW1wb3J0IHsgU2lnbkluV2l0aElkcFJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vYXBpL2F1dGhlbnRpY2F0aW9uL2lkcCc7XG5pbXBvcnQgeyBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IFVzZXJDcmVkZW50aWFsSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC91c2VyJztcbmltcG9ydCB7IE9BdXRoQ3JlZGVudGlhbCB9IGZyb20gJy4uL2NyZWRlbnRpYWxzL29hdXRoJztcbmltcG9ydCB7IEJhc2VPQXV0aFByb3ZpZGVyIH0gZnJvbSAnLi9vYXV0aCc7XG5pbXBvcnQgeyBQcm92aWRlcklkLCBTaWduSW5NZXRob2QgfSBmcm9tICcuLi8uLi9tb2RlbC9lbnVtcyc7XG5cbi8qKlxuICogUHJvdmlkZXIgZm9yIGdlbmVyYXRpbmcgYW4gYW4ge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZm9yIHtAbGluayBQcm92aWRlcklkfS5HT09HTEUuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEdvb2dsZUF1dGhQcm92aWRlcigpO1xuICogLy8gU3RhcnQgYSBzaWduIGluIHByb2Nlc3MgZm9yIGFuIHVuYXV0aGVudGljYXRlZCB1c2VyLlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdlbWFpbCcpO1xuICogYXdhaXQgc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyKTtcbiAqIC8vIFRoaXMgd2lsbCB0cmlnZ2VyIGEgZnVsbCBwYWdlIHJlZGlyZWN0IGF3YXkgZnJvbSB5b3VyIGFwcFxuICpcbiAqIC8vIEFmdGVyIHJldHVybmluZyBmcm9tIHRoZSByZWRpcmVjdCB3aGVuIHlvdXIgYXBwIGluaXRpYWxpemVzIHlvdSBjYW4gb2J0YWluIHRoZSByZXN1bHRcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFJlZGlyZWN0UmVzdWx0KGF1dGgpO1xuICogaWYgKHJlc3VsdCkge1xuICogICAvLyBUaGlzIGlzIHRoZSBzaWduZWQtaW4gdXNlclxuICogICBjb25zdCB1c2VyID0gcmVzdWx0LnVzZXI7XG4gKiAgIC8vIFRoaXMgZ2l2ZXMgeW91IGEgR29vZ2xlIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogICBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7XG4gKiBwcm92aWRlci5hZGRTY29wZSgncHJvZmlsZScpO1xuICogcHJvdmlkZXIuYWRkU2NvcGUoJ2VtYWlsJyk7XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xuICpcbiAqIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBHb29nbGUgQWNjZXNzIFRva2VuLlxuICogY29uc3QgY3JlZGVudGlhbCA9IEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogYGBgXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgR29vZ2xlQXV0aFByb3ZpZGVyIGV4dGVuZHMgQmFzZU9BdXRoUHJvdmlkZXIge1xuICAvKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5HT09HTEUuICovXG4gIHN0YXRpYyByZWFkb25seSBHT09HTEVfU0lHTl9JTl9NRVRIT0Q6ICdnb29nbGUuY29tJyA9IFNpZ25Jbk1ldGhvZC5HT09HTEU7XG4gIC8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5HT09HTEUuICovXG4gIHN0YXRpYyByZWFkb25seSBQUk9WSURFUl9JRDogJ2dvb2dsZS5jb20nID0gUHJvdmlkZXJJZC5HT09HTEU7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoUHJvdmlkZXJJZC5HT09HTEUpO1xuICAgIHRoaXMuYWRkU2NvcGUoJ3Byb2ZpbGUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgR29vZ2xlLiBBdCBsZWFzdCBvbmUgb2YgSUQgdG9rZW4gYW5kIGFjY2VzcyB0b2tlbiBpcyByZXF1aXJlZC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiAvLyBcXGBnb29nbGVVc2VyXFxgIGZyb20gdGhlIG9uc3VjY2VzcyBHb29nbGUgU2lnbiBJbiBjYWxsYmFjay5cbiAgICogY29uc3QgY3JlZGVudGlhbCA9IEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKGdvb2dsZVVzZXIuZ2V0QXV0aFJlc3BvbnNlKCkuaWRfdG9rZW4pO1xuICAgKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoQ3JlZGVudGlhbChjcmVkZW50aWFsKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBpZFRva2VuIC0gR29vZ2xlIElEIHRva2VuLlxuICAgKiBAcGFyYW0gYWNjZXNzVG9rZW4gLSBHb29nbGUgYWNjZXNzIHRva2VuLlxuICAgKi9cbiAgc3RhdGljIGNyZWRlbnRpYWwoXG4gICAgaWRUb2tlbj86IHN0cmluZyB8IG51bGwsXG4gICAgYWNjZXNzVG9rZW4/OiBzdHJpbmcgfCBudWxsXG4gICk6IE9BdXRoQ3JlZGVudGlhbCB7XG4gICAgcmV0dXJuIE9BdXRoQ3JlZGVudGlhbC5fZnJvbVBhcmFtcyh7XG4gICAgICBwcm92aWRlcklkOiBHb29nbGVBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQsXG4gICAgICBzaWduSW5NZXRob2Q6IEdvb2dsZUF1dGhQcm92aWRlci5HT09HTEVfU0lHTl9JTl9NRVRIT0QsXG4gICAgICBpZFRva2VuLFxuICAgICAgYWNjZXNzVG9rZW5cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXG4gICAqXG4gICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAqL1xuICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQoXG4gICAgdXNlckNyZWRlbnRpYWw6IFVzZXJDcmVkZW50aWFsXG4gICk6IE9BdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIHJldHVybiBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoXG4gICAgICB1c2VyQ3JlZGVudGlhbCBhcyBVc2VyQ3JlZGVudGlhbEludGVybmFsXG4gICAgKTtcbiAgfVxuICAvKipcbiAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgQXV0aEVycm9yfSB3aGljaCB3YXNcbiAgICogdGhyb3duIGR1cmluZyBhIHNpZ24taW4sIGxpbmssIG9yIHJlYXV0aGVudGljYXRlIG9wZXJhdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICovXG4gIHN0YXRpYyBjcmVkZW50aWFsRnJvbUVycm9yKGVycm9yOiBGaXJlYmFzZUVycm9yKTogT0F1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgcmV0dXJuIEdvb2dsZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdChcbiAgICAgIChlcnJvci5jdXN0b21EYXRhIHx8IHt9KSBhcyBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZVxuICAgICk7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBjcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdCh7XG4gICAgX3Rva2VuUmVzcG9uc2U6IHRva2VuUmVzcG9uc2VcbiAgfTogVGFnZ2VkV2l0aFRva2VuUmVzcG9uc2UpOiBPQXV0aENyZWRlbnRpYWwgfCBudWxsIHtcbiAgICBpZiAoIXRva2VuUmVzcG9uc2UpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHsgb2F1dGhJZFRva2VuLCBvYXV0aEFjY2Vzc1Rva2VuIH0gPVxuICAgICAgdG9rZW5SZXNwb25zZSBhcyBTaWduSW5XaXRoSWRwUmVzcG9uc2U7XG4gICAgaWYgKCFvYXV0aElkVG9rZW4gJiYgIW9hdXRoQWNjZXNzVG9rZW4pIHtcbiAgICAgIC8vIFRoaXMgY291bGQgYmUgYW4gb2F1dGggMSBjcmVkZW50aWFsIG9yIGEgcGhvbmUgY3JlZGVudGlhbFxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbChvYXV0aElkVG9rZW4sIG9hdXRoQWNjZXNzVG9rZW4pO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuaW1wb3J0IHsgVGFnZ2VkV2l0aFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9tb2RlbC9pZF90b2tlbic7XG5pbXBvcnQgeyBVc2VyQ3JlZGVudGlhbEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBPQXV0aENyZWRlbnRpYWwgfSBmcm9tICcuLi9jcmVkZW50aWFscy9vYXV0aCc7XG5pbXBvcnQgeyBCYXNlT0F1dGhQcm92aWRlciB9IGZyb20gJy4vb2F1dGgnO1xuaW1wb3J0IHsgUHJvdmlkZXJJZCwgU2lnbkluTWV0aG9kIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG4vKipcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIGFuIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZvciB7QGxpbmsgUHJvdmlkZXJJZH0uR0lUSFVCLlxuICpcbiAqIEByZW1hcmtzXG4gKiBHaXRIdWIgcmVxdWlyZXMgYW4gT0F1dGggMi4wIHJlZGlyZWN0LCBzbyB5b3UgY2FuIGVpdGhlciBoYW5kbGUgdGhlIHJlZGlyZWN0IGRpcmVjdGx5LCBvciB1c2VcbiAqIHRoZSB7QGxpbmsgc2lnbkluV2l0aFBvcHVwfSBoYW5kbGVyOlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBHaXRodWJBdXRoUHJvdmlkZXIoKTtcbiAqIC8vIFN0YXJ0IGEgc2lnbiBpbiBwcm9jZXNzIGZvciBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdyZXBvJyk7XG4gKiBhd2FpdCBzaWduSW5XaXRoUmVkaXJlY3QoYXV0aCwgcHJvdmlkZXIpO1xuICogLy8gVGhpcyB3aWxsIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXG4gKlxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XG4gKiBpZiAocmVzdWx0KSB7XG4gKiAgIC8vIFRoaXMgaXMgdGhlIHNpZ25lZC1pbiB1c2VyXG4gKiAgIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqICAgLy8gVGhpcyBnaXZlcyB5b3UgYSBHaXRodWIgQWNjZXNzIFRva2VuLlxuICogICBjb25zdCBjcmVkZW50aWFsID0gR2l0aHViQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHJlc3VsdCk7XG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIH1cbiAqIGBgYFxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcG9wdXAuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBHaXRodWJBdXRoUHJvdmlkZXIoKTtcbiAqIHByb3ZpZGVyLmFkZFNjb3BlKCdyZXBvJyk7XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xuICpcbiAqIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBHaXRodWIgQWNjZXNzIFRva2VuLlxuICogY29uc3QgY3JlZGVudGlhbCA9IEdpdGh1YkF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVJlc3VsdChyZXN1bHQpO1xuICogY29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xuICogYGBgXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjbGFzcyBHaXRodWJBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XG4gIC8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LkdJVEhVQi4gKi9cbiAgc3RhdGljIHJlYWRvbmx5IEdJVEhVQl9TSUdOX0lOX01FVEhPRDogJ2dpdGh1Yi5jb20nID0gU2lnbkluTWV0aG9kLkdJVEhVQjtcbiAgLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LkdJVEhVQi4gKi9cbiAgc3RhdGljIHJlYWRvbmx5IFBST1ZJREVSX0lEOiAnZ2l0aHViLmNvbScgPSBQcm92aWRlcklkLkdJVEhVQjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihQcm92aWRlcklkLkdJVEhVQik7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGNyZWRlbnRpYWwgZm9yIEdpdGh1Yi5cbiAgICpcbiAgICogQHBhcmFtIGFjY2Vzc1Rva2VuIC0gR2l0aHViIGFjY2VzcyB0b2tlbi5cbiAgICovXG4gIHN0YXRpYyBjcmVkZW50aWFsKGFjY2Vzc1Rva2VuOiBzdHJpbmcpOiBPQXV0aENyZWRlbnRpYWwge1xuICAgIHJldHVybiBPQXV0aENyZWRlbnRpYWwuX2Zyb21QYXJhbXMoe1xuICAgICAgcHJvdmlkZXJJZDogR2l0aHViQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lELFxuICAgICAgc2lnbkluTWV0aG9kOiBHaXRodWJBdXRoUHJvdmlkZXIuR0lUSFVCX1NJR05fSU5fTUVUSE9ELFxuICAgICAgYWNjZXNzVG9rZW5cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXG4gICAqXG4gICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAqL1xuICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQoXG4gICAgdXNlckNyZWRlbnRpYWw6IFVzZXJDcmVkZW50aWFsXG4gICk6IE9BdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIHJldHVybiBHaXRodWJBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoXG4gICAgICB1c2VyQ3JlZGVudGlhbCBhcyBVc2VyQ3JlZGVudGlhbEludGVybmFsXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgKi9cbiAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3I6IEZpcmViYXNlRXJyb3IpOiBPQXV0aENyZWRlbnRpYWwgfCBudWxsIHtcbiAgICByZXR1cm4gR2l0aHViQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KFxuICAgICAgKGVycm9yLmN1c3RvbURhdGEgfHwge30pIGFzIFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHtcbiAgICBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZVxuICB9OiBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZSk6IE9BdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIGlmICghdG9rZW5SZXNwb25zZSB8fCAhKCdvYXV0aEFjY2Vzc1Rva2VuJyBpbiB0b2tlblJlc3BvbnNlKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKCF0b2tlblJlc3BvbnNlLm9hdXRoQWNjZXNzVG9rZW4pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gR2l0aHViQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodG9rZW5SZXNwb25zZS5vYXV0aEFjY2Vzc1Rva2VuKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgU0FNTCBjcmVkZW50aWFscyByZXR1cm5lZCBieSBhbiB7QGxpbmsgU0FNTEF1dGhQcm92aWRlcn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5cbmltcG9ydCB7XG4gIHNpZ25JbldpdGhJZHAsXG4gIFNpZ25JbldpdGhJZHBSZXF1ZXN0XG59IGZyb20gJy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi9pZHAnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBJZFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9tb2RlbC9pZF90b2tlbic7XG5pbXBvcnQgeyBBdXRoQ3JlZGVudGlhbCB9IGZyb20gJy4vYXV0aF9jcmVkZW50aWFsJztcblxuY29uc3QgSURQX1JFUVVFU1RfVVJJID0gJ2h0dHA6Ly9sb2NhbGhvc3QnO1xuXG4vKipcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIFNBTUxBdXRoQ3JlZGVudGlhbCBleHRlbmRzIEF1dGhDcmVkZW50aWFsIHtcbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBwcml2YXRlIGNvbnN0cnVjdG9yKFxuICAgIHByb3ZpZGVySWQ6IHN0cmluZyxcbiAgICBwcml2YXRlIHJlYWRvbmx5IHBlbmRpbmdUb2tlbjogc3RyaW5nXG4gICkge1xuICAgIHN1cGVyKHByb3ZpZGVySWQsIHByb3ZpZGVySWQpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBfZ2V0SWRUb2tlblJlc3BvbnNlKGF1dGg6IEF1dGhJbnRlcm5hbCk6IFByb21pc2U8SWRUb2tlblJlc3BvbnNlPiB7XG4gICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIF9saW5rVG9JZFRva2VuKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBpZFRva2VuOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxJZFRva2VuUmVzcG9uc2U+IHtcbiAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5idWlsZFJlcXVlc3QoKTtcbiAgICByZXF1ZXN0LmlkVG9rZW4gPSBpZFRva2VuO1xuICAgIHJldHVybiBzaWduSW5XaXRoSWRwKGF1dGgsIHJlcXVlc3QpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBfZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGg6IEF1dGhJbnRlcm5hbCk6IFByb21pc2U8SWRUb2tlblJlc3BvbnNlPiB7XG4gICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KCk7XG4gICAgcmVxdWVzdC5hdXRvQ3JlYXRlID0gZmFsc2U7XG4gICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgcmVxdWVzdCk7XG4gIH1cblxuICAvKioge0Bpbmhlcml0ZG9jIEF1dGhDcmVkZW50aWFsLnRvSlNPTn0gICovXG4gIHRvSlNPTigpOiBvYmplY3Qge1xuICAgIHJldHVybiB7XG4gICAgICBzaWduSW5NZXRob2Q6IHRoaXMuc2lnbkluTWV0aG9kLFxuICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm92aWRlcklkLFxuICAgICAgcGVuZGluZ1Rva2VuOiB0aGlzLnBlbmRpbmdUb2tlblxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogU3RhdGljIG1ldGhvZCB0byBkZXNlcmlhbGl6ZSBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgYW4gb2JqZWN0IGludG8gYW5cbiAgICoge0BsaW5rICBBdXRoQ3JlZGVudGlhbH0uXG4gICAqXG4gICAqIEBwYXJhbSBqc29uIC0gSW5wdXQgY2FuIGJlIGVpdGhlciBPYmplY3Qgb3IgdGhlIHN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QuXG4gICAqIFdoZW4gc3RyaW5nIGlzIHByb3ZpZGVkLCBKU09OLnBhcnNlIHdvdWxkIGJlIGNhbGxlZCBmaXJzdC5cbiAgICpcbiAgICogQHJldHVybnMgSWYgdGhlIEpTT04gaW5wdXQgZG9lcyBub3QgcmVwcmVzZW50IGFuIHtAbGluayAgQXV0aENyZWRlbnRpYWx9LCBudWxsIGlzIHJldHVybmVkLlxuICAgKi9cbiAgc3RhdGljIGZyb21KU09OKGpzb246IHN0cmluZyB8IG9iamVjdCk6IFNBTUxBdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIGNvbnN0IG9iaiA9IHR5cGVvZiBqc29uID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2UoanNvbikgOiBqc29uO1xuICAgIGNvbnN0IHsgcHJvdmlkZXJJZCwgc2lnbkluTWV0aG9kLCBwZW5kaW5nVG9rZW4gfTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9XG4gICAgICBvYmo7XG4gICAgaWYgKFxuICAgICAgIXByb3ZpZGVySWQgfHxcbiAgICAgICFzaWduSW5NZXRob2QgfHxcbiAgICAgICFwZW5kaW5nVG9rZW4gfHxcbiAgICAgIHByb3ZpZGVySWQgIT09IHNpZ25Jbk1ldGhvZFxuICAgICkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBTQU1MQXV0aENyZWRlbnRpYWwocHJvdmlkZXJJZCwgcGVuZGluZ1Rva2VuKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXIgc3RhdGljIG1ldGhvZCB0byBhdm9pZCBleHBvc2luZyB0aGUgY29uc3RydWN0b3IgdG8gZW5kIHVzZXJzLlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICovXG4gIHN0YXRpYyBfY3JlYXRlKHByb3ZpZGVySWQ6IHN0cmluZywgcGVuZGluZ1Rva2VuOiBzdHJpbmcpOiBTQU1MQXV0aENyZWRlbnRpYWwge1xuICAgIHJldHVybiBuZXcgU0FNTEF1dGhDcmVkZW50aWFsKHByb3ZpZGVySWQsIHBlbmRpbmdUb2tlbik7XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkUmVxdWVzdCgpOiBTaWduSW5XaXRoSWRwUmVxdWVzdCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlcXVlc3RVcmk6IElEUF9SRVFVRVNUX1VSSSxcbiAgICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxuICAgICAgcGVuZGluZ1Rva2VuOiB0aGlzLnBlbmRpbmdUb2tlblxuICAgIH07XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBGaXJlYmFzZUVycm9yIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgU2lnbkluV2l0aElkcFJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vYXBpL2F1dGhlbnRpY2F0aW9uL2lkcCc7XG5pbXBvcnQgeyBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IFVzZXJDcmVkZW50aWFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IFVzZXJDcmVkZW50aWFsSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC91c2VyJztcbmltcG9ydCB7IEF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vY3JlZGVudGlhbHMnO1xuaW1wb3J0IHsgU0FNTEF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vY3JlZGVudGlhbHMvc2FtbCc7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IF9hc3NlcnQgfSBmcm9tICcuLi91dGlsL2Fzc2VydCc7XG5pbXBvcnQgeyBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIgfSBmcm9tICcuL2ZlZGVyYXRlZCc7XG5cbmNvbnN0IFNBTUxfUFJPVklERVJfUFJFRklYID0gJ3NhbWwuJztcblxuLyoqXG4gKiBBbiB7QGxpbmsgQXV0aFByb3ZpZGVyfSBmb3IgU0FNTC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBjbGFzcyBTQU1MQXV0aFByb3ZpZGVyIGV4dGVuZHMgRmVkZXJhdGVkQXV0aFByb3ZpZGVyIHtcbiAgLyoqXG4gICAqIENvbnN0cnVjdG9yLiBUaGUgcHJvdmlkZXJJZCBtdXN0IHN0YXJ0IHdpdGggXCJzYW1sLlwiXG4gICAqIEBwYXJhbSBwcm92aWRlcklkIC0gU0FNTCBwcm92aWRlciBJRC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHByb3ZpZGVySWQ6IHN0cmluZykge1xuICAgIF9hc3NlcnQoXG4gICAgICBwcm92aWRlcklkLnN0YXJ0c1dpdGgoU0FNTF9QUk9WSURFUl9QUkVGSVgpLFxuICAgICAgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUlxuICAgICk7XG4gICAgc3VwZXIocHJvdmlkZXJJZCk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIGFuIHtAbGluayBBdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0gYWZ0ZXIgYVxuICAgKiBzdWNjZXNzZnVsIFNBTUwgZmxvdyBjb21wbGV0ZXMuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqXG4gICAqIEZvciBleGFtcGxlLCB0byBnZXQgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSwgeW91IGNvdWxkIHdyaXRlIHRoZVxuICAgKiBmb2xsb3dpbmcgY29kZTpcbiAgICpcbiAgICogYGBganNcbiAgICogY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgc2FtbFByb3ZpZGVyKTtcbiAgICogY29uc3QgY3JlZGVudGlhbCA9IFNBTUxBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQodXNlckNyZWRlbnRpYWwpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIHVzZXJDcmVkZW50aWFsIC0gVGhlIHVzZXIgY3JlZGVudGlhbC5cbiAgICovXG4gIHN0YXRpYyBjcmVkZW50aWFsRnJvbVJlc3VsdChcbiAgICB1c2VyQ3JlZGVudGlhbDogVXNlckNyZWRlbnRpYWxcbiAgKTogQXV0aENyZWRlbnRpYWwgfCBudWxsIHtcbiAgICByZXR1cm4gU0FNTEF1dGhQcm92aWRlci5zYW1sQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3QoXG4gICAgICB1c2VyQ3JlZGVudGlhbCBhcyBVc2VyQ3JlZGVudGlhbEludGVybmFsXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIHRvIGV4dHJhY3QgdGhlIHVuZGVybHlpbmcge0BsaW5rIE9BdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBBdXRoRXJyb3J9IHdoaWNoIHdhc1xuICAgKiB0aHJvd24gZHVyaW5nIGEgc2lnbi1pbiwgbGluaywgb3IgcmVhdXRoZW50aWNhdGUgb3BlcmF0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgKi9cbiAgc3RhdGljIGNyZWRlbnRpYWxGcm9tRXJyb3IoZXJyb3I6IEZpcmViYXNlRXJyb3IpOiBBdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIHJldHVybiBTQU1MQXV0aFByb3ZpZGVyLnNhbWxDcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdChcbiAgICAgIChlcnJvci5jdXN0b21EYXRhIHx8IHt9KSBhcyBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiB7QGxpbmsgQXV0aENyZWRlbnRpYWx9IGZyb20gYSBKU09OIHN0cmluZyBvciBhIHBsYWluIG9iamVjdC5cbiAgICogQHBhcmFtIGpzb24gLSBBIHBsYWluIG9iamVjdCBvciBhIEpTT04gc3RyaW5nXG4gICAqL1xuICBzdGF0aWMgY3JlZGVudGlhbEZyb21KU09OKGpzb246IHN0cmluZyB8IG9iamVjdCk6IEF1dGhDcmVkZW50aWFsIHtcbiAgICBjb25zdCBjcmVkZW50aWFsID0gU0FNTEF1dGhDcmVkZW50aWFsLmZyb21KU09OKGpzb24pO1xuICAgIF9hc3NlcnQoY3JlZGVudGlhbCwgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUik7XG4gICAgcmV0dXJuIGNyZWRlbnRpYWw7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBzYW1sQ3JlZGVudGlhbEZyb21UYWdnZWRPYmplY3Qoe1xuICAgIF90b2tlblJlc3BvbnNlOiB0b2tlblJlc3BvbnNlXG4gIH06IFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlKTogU0FNTEF1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgaWYgKCF0b2tlblJlc3BvbnNlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCB7IHBlbmRpbmdUb2tlbiwgcHJvdmlkZXJJZCB9ID0gdG9rZW5SZXNwb25zZSBhcyBTaWduSW5XaXRoSWRwUmVzcG9uc2U7XG5cbiAgICBpZiAoIXBlbmRpbmdUb2tlbiB8fCAhcHJvdmlkZXJJZCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBTQU1MQXV0aENyZWRlbnRpYWwuX2NyZWF0ZShwcm92aWRlcklkLCBwZW5kaW5nVG9rZW4pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIFR3aXR0ZXIgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBVc2VyQ3JlZGVudGlhbCB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQgeyBGaXJlYmFzZUVycm9yIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5pbXBvcnQgeyBTaWduSW5XaXRoSWRwUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vaWRwJztcbmltcG9ydCB7IFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgT0F1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vY3JlZGVudGlhbHMvb2F1dGgnO1xuaW1wb3J0IHsgQmFzZU9BdXRoUHJvdmlkZXIgfSBmcm9tICcuL29hdXRoJztcbmltcG9ydCB7IFByb3ZpZGVySWQsIFNpZ25Jbk1ldGhvZCB9IGZyb20gJy4uLy4uL21vZGVsL2VudW1zJztcblxuLyoqXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhbiB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmb3Ige0BsaW5rIFByb3ZpZGVySWR9LlRXSVRURVIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSByZWRpcmVjdC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFR3aXR0ZXJBdXRoUHJvdmlkZXIoKTtcbiAqIC8vIFN0YXJ0IGEgc2lnbiBpbiBwcm9jZXNzIGZvciBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIFR3aXR0ZXIgQWNjZXNzIFRva2VuIGFuZCBTZWNyZXQuXG4gKiAgIGNvbnN0IGNyZWRlbnRpYWwgPSBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHJlc3VsdCk7XG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqICAgY29uc3Qgc2VjcmV0ID0gY3JlZGVudGlhbC5zZWNyZXQ7XG4gKiB9XG4gKiBgYGBcbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgVHdpdHRlckF1dGhQcm92aWRlcigpO1xuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aFBvcHVwKGF1dGgsIHByb3ZpZGVyKTtcbiAqXG4gKiAvLyBUaGUgc2lnbmVkLWluIHVzZXIgaW5mby5cbiAqIGNvbnN0IHVzZXIgPSByZXN1bHQudXNlcjtcbiAqIC8vIFRoaXMgZ2l2ZXMgeW91IGEgVHdpdHRlciBBY2Nlc3MgVG9rZW4gYW5kIFNlY3JldC5cbiAqIGNvbnN0IGNyZWRlbnRpYWwgPSBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KHJlc3VsdCk7XG4gKiBjb25zdCB0b2tlbiA9IGNyZWRlbnRpYWwuYWNjZXNzVG9rZW47XG4gKiBjb25zdCBzZWNyZXQgPSBjcmVkZW50aWFsLnNlY3JldDtcbiAqIGBgYFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIFR3aXR0ZXJBdXRoUHJvdmlkZXIgZXh0ZW5kcyBCYXNlT0F1dGhQcm92aWRlciB7XG4gIC8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBTaWduSW5NZXRob2R9LlRXSVRURVIuICovXG4gIHN0YXRpYyByZWFkb25seSBUV0lUVEVSX1NJR05fSU5fTUVUSE9EOiAndHdpdHRlci5jb20nID0gU2lnbkluTWV0aG9kLlRXSVRURVI7XG4gIC8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5UV0lUVEVSLiAqL1xuICBzdGF0aWMgcmVhZG9ubHkgUFJPVklERVJfSUQ6ICd0d2l0dGVyLmNvbScgPSBQcm92aWRlcklkLlRXSVRURVI7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoUHJvdmlkZXJJZC5UV0lUVEVSKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgY3JlZGVudGlhbCBmb3IgVHdpdHRlci5cbiAgICpcbiAgICogQHBhcmFtIHRva2VuIC0gVHdpdHRlciBhY2Nlc3MgdG9rZW4uXG4gICAqIEBwYXJhbSBzZWNyZXQgLSBUd2l0dGVyIHNlY3JldC5cbiAgICovXG4gIHN0YXRpYyBjcmVkZW50aWFsKHRva2VuOiBzdHJpbmcsIHNlY3JldDogc3RyaW5nKTogT0F1dGhDcmVkZW50aWFsIHtcbiAgICByZXR1cm4gT0F1dGhDcmVkZW50aWFsLl9mcm9tUGFyYW1zKHtcbiAgICAgIHByb3ZpZGVySWQ6IFR3aXR0ZXJBdXRoUHJvdmlkZXIuUFJPVklERVJfSUQsXG4gICAgICBzaWduSW5NZXRob2Q6IFR3aXR0ZXJBdXRoUHJvdmlkZXIuVFdJVFRFUl9TSUdOX0lOX01FVEhPRCxcbiAgICAgIG9hdXRoVG9rZW46IHRva2VuLFxuICAgICAgb2F1dGhUb2tlblNlY3JldDogc2VjcmV0XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVXNlZCB0byBleHRyYWN0IHRoZSB1bmRlcmx5aW5nIHtAbGluayBPQXV0aENyZWRlbnRpYWx9IGZyb20gYSB7QGxpbmsgVXNlckNyZWRlbnRpYWx9LlxuICAgKlxuICAgKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICAgKi9cbiAgc3RhdGljIGNyZWRlbnRpYWxGcm9tUmVzdWx0KFxuICAgIHVzZXJDcmVkZW50aWFsOiBVc2VyQ3JlZGVudGlhbFxuICApOiBPQXV0aENyZWRlbnRpYWwgfCBudWxsIHtcbiAgICByZXR1cm4gVHdpdHRlckF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbVRhZ2dlZE9iamVjdChcbiAgICAgIHVzZXJDcmVkZW50aWFsIGFzIFVzZXJDcmVkZW50aWFsSW50ZXJuYWxcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgdG8gZXh0cmFjdCB0aGUgdW5kZXJseWluZyB7QGxpbmsgT0F1dGhDcmVkZW50aWFsfSBmcm9tIGEge0BsaW5rIEF1dGhFcnJvcn0gd2hpY2ggd2FzXG4gICAqIHRocm93biBkdXJpbmcgYSBzaWduLWluLCBsaW5rLCBvciByZWF1dGhlbnRpY2F0ZSBvcGVyYXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAqL1xuICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcjogRmlyZWJhc2VFcnJvcik6IE9BdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIHJldHVybiBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KFxuICAgICAgKGVycm9yLmN1c3RvbURhdGEgfHwge30pIGFzIFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHtcbiAgICBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZVxuICB9OiBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZSk6IE9BdXRoQ3JlZGVudGlhbCB8IG51bGwge1xuICAgIGlmICghdG9rZW5SZXNwb25zZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHsgb2F1dGhBY2Nlc3NUb2tlbiwgb2F1dGhUb2tlblNlY3JldCB9ID1cbiAgICAgIHRva2VuUmVzcG9uc2UgYXMgU2lnbkluV2l0aElkcFJlc3BvbnNlO1xuICAgIGlmICghb2F1dGhBY2Nlc3NUb2tlbiB8fCAhb2F1dGhUb2tlblNlY3JldCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBUd2l0dGVyQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwob2F1dGhBY2Nlc3NUb2tlbiwgb2F1dGhUb2tlblNlY3JldCk7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBFbmRwb2ludCxcbiAgSHR0cE1ldGhvZCxcbiAgUmVjYXB0Y2hhQ2xpZW50VHlwZSxcbiAgUmVjYXB0Y2hhVmVyc2lvbixcbiAgX2FkZFRpZElmTmVjZXNzYXJ5LFxuICBfcGVyZm9ybVNpZ25JblJlcXVlc3Rcbn0gZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IHsgSWRUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgQXV0aCB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2lnblVwUmVxdWVzdCB7XG4gIHJldHVyblNlY3VyZVRva2VuPzogYm9vbGVhbjtcbiAgZW1haWw/OiBzdHJpbmc7XG4gIHBhc3N3b3JkPzogc3RyaW5nO1xuICB0ZW5hbnRJZD86IHN0cmluZztcbiAgY2FwdGNoYVJlc3BvbnNlPzogc3RyaW5nO1xuICBjbGllbnRUeXBlPzogUmVjYXB0Y2hhQ2xpZW50VHlwZTtcbiAgcmVjYXB0Y2hhVmVyc2lvbj86IFJlY2FwdGNoYVZlcnNpb247XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2lnblVwUmVzcG9uc2UgZXh0ZW5kcyBJZFRva2VuUmVzcG9uc2Uge1xuICBkaXNwbGF5TmFtZT86IHN0cmluZztcbiAgZW1haWw/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduVXAoXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFNpZ25VcFJlcXVlc3Rcbik6IFByb21pc2U8U2lnblVwUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdDxTaWduVXBSZXF1ZXN0LCBTaWduVXBSZXNwb25zZT4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuU0lHTl9VUCxcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBQaG9uZU9yT2F1dGhUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vYXBpL2F1dGhlbnRpY2F0aW9uL21mYSc7XG5pbXBvcnQgeyBJZFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9tb2RlbC9pZF90b2tlbic7XG5pbXBvcnQgeyBVc2VySW50ZXJuYWwsIFVzZXJDcmVkZW50aWFsSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC91c2VyJztcbmltcG9ydCB7IFVzZXJJbXBsIH0gZnJvbSAnLi91c2VyX2ltcGwnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBPcGVyYXRpb25UeXBlLCBQcm92aWRlcklkIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG5pbnRlcmZhY2UgVXNlckNyZWRlbnRpYWxQYXJhbXMge1xuICByZWFkb25seSB1c2VyOiBVc2VySW50ZXJuYWw7XG4gIHJlYWRvbmx5IHByb3ZpZGVySWQ6IFByb3ZpZGVySWQgfCBzdHJpbmcgfCBudWxsO1xuICByZWFkb25seSBfdG9rZW5SZXNwb25zZT86IFBob25lT3JPYXV0aFRva2VuUmVzcG9uc2U7XG4gIHJlYWRvbmx5IG9wZXJhdGlvblR5cGU6IE9wZXJhdGlvblR5cGU7XG59XG5cbmV4cG9ydCBjbGFzcyBVc2VyQ3JlZGVudGlhbEltcGxcbiAgaW1wbGVtZW50cyBVc2VyQ3JlZGVudGlhbEludGVybmFsLCBVc2VyQ3JlZGVudGlhbFBhcmFtc1xue1xuICByZWFkb25seSB1c2VyOiBVc2VySW50ZXJuYWw7XG4gIHJlYWRvbmx5IHByb3ZpZGVySWQ6IFByb3ZpZGVySWQgfCBzdHJpbmcgfCBudWxsO1xuICByZWFkb25seSBfdG9rZW5SZXNwb25zZTogUGhvbmVPck9hdXRoVG9rZW5SZXNwb25zZSB8IHVuZGVmaW5lZDtcbiAgcmVhZG9ubHkgb3BlcmF0aW9uVHlwZTogT3BlcmF0aW9uVHlwZTtcblxuICBjb25zdHJ1Y3RvcihwYXJhbXM6IFVzZXJDcmVkZW50aWFsUGFyYW1zKSB7XG4gICAgdGhpcy51c2VyID0gcGFyYW1zLnVzZXI7XG4gICAgdGhpcy5wcm92aWRlcklkID0gcGFyYW1zLnByb3ZpZGVySWQ7XG4gICAgdGhpcy5fdG9rZW5SZXNwb25zZSA9IHBhcmFtcy5fdG9rZW5SZXNwb25zZTtcbiAgICB0aGlzLm9wZXJhdGlvblR5cGUgPSBwYXJhbXMub3BlcmF0aW9uVHlwZTtcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBfZnJvbUlkVG9rZW5SZXNwb25zZShcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgb3BlcmF0aW9uVHlwZTogT3BlcmF0aW9uVHlwZSxcbiAgICBpZFRva2VuUmVzcG9uc2U6IElkVG9rZW5SZXNwb25zZSxcbiAgICBpc0Fub255bW91czogYm9vbGVhbiA9IGZhbHNlXG4gICk6IFByb21pc2U8VXNlckNyZWRlbnRpYWxJbnRlcm5hbD4ge1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VySW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShcbiAgICAgIGF1dGgsXG4gICAgICBpZFRva2VuUmVzcG9uc2UsXG4gICAgICBpc0Fub255bW91c1xuICAgICk7XG4gICAgY29uc3QgcHJvdmlkZXJJZCA9IHByb3ZpZGVySWRGb3JSZXNwb25zZShpZFRva2VuUmVzcG9uc2UpO1xuICAgIGNvbnN0IHVzZXJDcmVkID0gbmV3IFVzZXJDcmVkZW50aWFsSW1wbCh7XG4gICAgICB1c2VyLFxuICAgICAgcHJvdmlkZXJJZCxcbiAgICAgIF90b2tlblJlc3BvbnNlOiBpZFRva2VuUmVzcG9uc2UsXG4gICAgICBvcGVyYXRpb25UeXBlXG4gICAgfSk7XG4gICAgcmV0dXJuIHVzZXJDcmVkO1xuICB9XG5cbiAgc3RhdGljIGFzeW5jIF9mb3JPcGVyYXRpb24oXG4gICAgdXNlcjogVXNlckludGVybmFsLFxuICAgIG9wZXJhdGlvblR5cGU6IE9wZXJhdGlvblR5cGUsXG4gICAgcmVzcG9uc2U6IFBob25lT3JPYXV0aFRva2VuUmVzcG9uc2VcbiAgKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbEltcGw+IHtcbiAgICBhd2FpdCB1c2VyLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShyZXNwb25zZSwgLyogcmVsb2FkICovIHRydWUpO1xuICAgIGNvbnN0IHByb3ZpZGVySWQgPSBwcm92aWRlcklkRm9yUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgIHJldHVybiBuZXcgVXNlckNyZWRlbnRpYWxJbXBsKHtcbiAgICAgIHVzZXIsXG4gICAgICBwcm92aWRlcklkLFxuICAgICAgX3Rva2VuUmVzcG9uc2U6IHJlc3BvbnNlLFxuICAgICAgb3BlcmF0aW9uVHlwZVxuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHByb3ZpZGVySWRGb3JSZXNwb25zZShcbiAgcmVzcG9uc2U6IElkVG9rZW5SZXNwb25zZVxuKTogUHJvdmlkZXJJZCB8IHN0cmluZyB8IG51bGwge1xuICBpZiAocmVzcG9uc2UucHJvdmlkZXJJZCkge1xuICAgIHJldHVybiByZXNwb25zZS5wcm92aWRlcklkO1xuICB9XG5cbiAgaWYgKCdwaG9uZU51bWJlcicgaW4gcmVzcG9uc2UpIHtcbiAgICByZXR1cm4gUHJvdmlkZXJJZC5QSE9ORTtcbiAgfVxuXG4gIHJldHVybiBudWxsO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEF1dGgsIFVzZXJDcmVkZW50aWFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IHNpZ25VcCB9IGZyb20gJy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi9zaWduX3VwJztcbmltcG9ydCB7IFVzZXJJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbXBsIH0gZnJvbSAnLi4vdXNlci91c2VyX2NyZWRlbnRpYWxfaW1wbCc7XG5pbXBvcnQgeyBfY2FzdEF1dGggfSBmcm9tICcuLi9hdXRoL2F1dGhfaW1wbCc7XG5pbXBvcnQgeyBPcGVyYXRpb25UeXBlIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IHNpZ25zIGluIGFzIGFuIGFub255bW91cyB1c2VyLlxuICpcbiAqIEByZW1hcmtzXG4gKiBJZiB0aGVyZSBpcyBhbHJlYWR5IGFuIGFub255bW91cyB1c2VyIHNpZ25lZCBpbiwgdGhhdCB1c2VyIHdpbGwgYmUgcmV0dXJuZWQ7IG90aGVyd2lzZSwgYVxuICogbmV3IGFub255bW91cyB1c2VyIGlkZW50aXR5IHdpbGwgYmUgY3JlYXRlZCBhbmQgcmV0dXJuZWQuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25JbkFub255bW91c2x5KGF1dGg6IEF1dGgpOiBQcm9taXNlPFVzZXJDcmVkZW50aWFsPiB7XG4gIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgYXdhaXQgYXV0aEludGVybmFsLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gIGlmIChhdXRoSW50ZXJuYWwuY3VycmVudFVzZXI/LmlzQW5vbnltb3VzKSB7XG4gICAgLy8gSWYgYW4gYW5vbnltb3VzIHVzZXIgaXMgYWxyZWFkeSBzaWduZWQgaW4sIG5vIG5lZWQgdG8gc2lnbiB0aGVtIGluIGFnYWluLlxuICAgIHJldHVybiBuZXcgVXNlckNyZWRlbnRpYWxJbXBsKHtcbiAgICAgIHVzZXI6IGF1dGhJbnRlcm5hbC5jdXJyZW50VXNlciBhcyBVc2VySW50ZXJuYWwsXG4gICAgICBwcm92aWRlcklkOiBudWxsLFxuICAgICAgb3BlcmF0aW9uVHlwZTogT3BlcmF0aW9uVHlwZS5TSUdOX0lOXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzaWduVXAoYXV0aEludGVybmFsLCB7XG4gICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcbiAgfSk7XG4gIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgVXNlckNyZWRlbnRpYWxJbXBsLl9mcm9tSWRUb2tlblJlc3BvbnNlKFxuICAgIGF1dGhJbnRlcm5hbCxcbiAgICBPcGVyYXRpb25UeXBlLlNJR05fSU4sXG4gICAgcmVzcG9uc2UsXG4gICAgdHJ1ZVxuICApO1xuICBhd2FpdCBhdXRoSW50ZXJuYWwuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xuICByZXR1cm4gdXNlckNyZWRlbnRpYWw7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgTXVsdGlGYWN0b3JFcnJvciBhcyBNdWx0aUZhY3RvckVycm9yUHVibGljIH0gZnJvbSAnLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IEZpcmViYXNlRXJyb3IgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7IElkVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9jb3JlL2Vycm9ycyc7XG5pbXBvcnQgeyBVc2VySW50ZXJuYWwgfSBmcm9tICcuLi9tb2RlbC91c2VyJztcbmltcG9ydCB7IEF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vY29yZS9jcmVkZW50aWFscyc7XG5pbXBvcnQgeyBJZFRva2VuTWZhUmVzcG9uc2UgfSBmcm9tICcuLi9hcGkvYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IE9wZXJhdGlvblR5cGUgfSBmcm9tICcuLi9tb2RlbC9lbnVtcyc7XG5cbmV4cG9ydCB0eXBlIE11bHRpRmFjdG9yRXJyb3JEYXRhID0gTXVsdGlGYWN0b3JFcnJvclB1YmxpY1snY3VzdG9tRGF0YSddICYge1xuICBfc2VydmVyUmVzcG9uc2U6IElkVG9rZW5NZmFSZXNwb25zZTtcbn07XG5cbmV4cG9ydCBjbGFzcyBNdWx0aUZhY3RvckVycm9yXG4gIGV4dGVuZHMgRmlyZWJhc2VFcnJvclxuICBpbXBsZW1lbnRzIE11bHRpRmFjdG9yRXJyb3JQdWJsaWNcbntcbiAgcmVhZG9ubHkgY3VzdG9tRGF0YTogTXVsdGlGYWN0b3JFcnJvckRhdGE7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcihcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgZXJyb3I6IEZpcmViYXNlRXJyb3IsXG4gICAgcmVhZG9ubHkgb3BlcmF0aW9uVHlwZTogT3BlcmF0aW9uVHlwZSxcbiAgICByZWFkb25seSB1c2VyPzogVXNlckludGVybmFsXG4gICkge1xuICAgIHN1cGVyKGVycm9yLmNvZGUsIGVycm9yLm1lc3NhZ2UpO1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9NaWNyb3NvZnQvVHlwZVNjcmlwdC13aWtpL2Jsb2IvbWFzdGVyL0JyZWFraW5nLUNoYW5nZXMubWQjZXh0ZW5kaW5nLWJ1aWx0LWlucy1saWtlLWVycm9yLWFycmF5LWFuZC1tYXAtbWF5LW5vLWxvbmdlci13b3JrXG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIE11bHRpRmFjdG9yRXJyb3IucHJvdG90eXBlKTtcbiAgICB0aGlzLmN1c3RvbURhdGEgPSB7XG4gICAgICBhcHBOYW1lOiBhdXRoLm5hbWUsXG4gICAgICB0ZW5hbnRJZDogYXV0aC50ZW5hbnRJZCA/PyB1bmRlZmluZWQsXG4gICAgICBfc2VydmVyUmVzcG9uc2U6IGVycm9yLmN1c3RvbURhdGEhLl9zZXJ2ZXJSZXNwb25zZSBhcyBJZFRva2VuTWZhUmVzcG9uc2UsXG4gICAgICBvcGVyYXRpb25UeXBlXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBfZnJvbUVycm9yQW5kT3BlcmF0aW9uKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBlcnJvcjogRmlyZWJhc2VFcnJvcixcbiAgICBvcGVyYXRpb25UeXBlOiBPcGVyYXRpb25UeXBlLFxuICAgIHVzZXI/OiBVc2VySW50ZXJuYWxcbiAgKTogTXVsdGlGYWN0b3JFcnJvciB7XG4gICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvckVycm9yKGF1dGgsIGVycm9yLCBvcGVyYXRpb25UeXBlLCB1c2VyKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX3Byb2Nlc3NDcmVkZW50aWFsU2F2aW5nTWZhQ29udGV4dElmTmVjZXNzYXJ5KFxuICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gIG9wZXJhdGlvblR5cGU6IE9wZXJhdGlvblR5cGUsXG4gIGNyZWRlbnRpYWw6IEF1dGhDcmVkZW50aWFsLFxuICB1c2VyPzogVXNlckludGVybmFsXG4pOiBQcm9taXNlPElkVG9rZW5SZXNwb25zZT4ge1xuICBjb25zdCBpZFRva2VuUHJvdmlkZXIgPVxuICAgIG9wZXJhdGlvblR5cGUgPT09IE9wZXJhdGlvblR5cGUuUkVBVVRIRU5USUNBVEVcbiAgICAgID8gY3JlZGVudGlhbC5fZ2V0UmVhdXRoZW50aWNhdGlvblJlc29sdmVyKGF1dGgpXG4gICAgICA6IGNyZWRlbnRpYWwuX2dldElkVG9rZW5SZXNwb25zZShhdXRoKTtcblxuICByZXR1cm4gaWRUb2tlblByb3ZpZGVyLmNhdGNoKGVycm9yID0+IHtcbiAgICBpZiAoZXJyb3IuY29kZSA9PT0gYGF1dGgvJHtBdXRoRXJyb3JDb2RlLk1GQV9SRVFVSVJFRH1gKSB7XG4gICAgICB0aHJvdyBNdWx0aUZhY3RvckVycm9yLl9mcm9tRXJyb3JBbmRPcGVyYXRpb24oXG4gICAgICAgIGF1dGgsXG4gICAgICAgIGVycm9yLFxuICAgICAgICBvcGVyYXRpb25UeXBlLFxuICAgICAgICB1c2VyXG4gICAgICApO1xuICAgIH1cblxuICAgIHRocm93IGVycm9yO1xuICB9KTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5leHBvcnQgaW50ZXJmYWNlIFByb3ZpZGVyQXNzb2NpYXRlZE9iamVjdCB7XG4gIHByb3ZpZGVySWQ/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogVGFrZXMgYSBzZXQgb2YgVXNlckluZm8gcHJvdmlkZXIgZGF0YSBhbmQgY29udmVydHMgaXQgdG8gYSBzZXQgb2YgbmFtZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHByb3ZpZGVyRGF0YUFzTmFtZXM8VCBleHRlbmRzIFByb3ZpZGVyQXNzb2NpYXRlZE9iamVjdD4oXG4gIHByb3ZpZGVyRGF0YTogVFtdXG4pOiBTZXQ8c3RyaW5nPiB7XG4gIHJldHVybiBuZXcgU2V0KFxuICAgIHByb3ZpZGVyRGF0YVxuICAgICAgLm1hcCgoeyBwcm92aWRlcklkIH0pID0+IHByb3ZpZGVySWQpXG4gICAgICAuZmlsdGVyKHBpZCA9PiAhIXBpZCkgYXMgc3RyaW5nW11cbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHsgZGVsZXRlTGlua2VkQWNjb3VudHMgfSBmcm9tICcuLi8uLi9hcGkvYWNjb3VudF9tYW5hZ2VtZW50L2FjY291bnQnO1xuaW1wb3J0IHsgVXNlckludGVybmFsLCBVc2VyQ3JlZGVudGlhbEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBBdXRoQ3JlZGVudGlhbCB9IGZyb20gJy4uL2NyZWRlbnRpYWxzJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9lcnJvcnMnO1xuaW1wb3J0IHsgX2Fzc2VydCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IHByb3ZpZGVyRGF0YUFzTmFtZXMgfSBmcm9tICcuLi91dGlsL3Byb3ZpZGVycyc7XG5pbXBvcnQgeyBfbG9nb3V0SWZJbnZhbGlkYXRlZCB9IGZyb20gJy4vaW52YWxpZGF0aW9uJztcbmltcG9ydCB7IF9yZWxvYWRXaXRob3V0U2F2aW5nIH0gZnJvbSAnLi9yZWxvYWQnO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbXBsIH0gZnJvbSAnLi91c2VyX2NyZWRlbnRpYWxfaW1wbCc7XG5pbXBvcnQgeyBnZXRNb2R1bGFySW5zdGFuY2UgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBPcGVyYXRpb25UeXBlLCBQcm92aWRlcklkIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG4vKipcbiAqIFVubGlua3MgYSBwcm92aWRlciBmcm9tIGEgdXNlciBhY2NvdW50LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvdmlkZXJJZCAtIFRoZSBwcm92aWRlciB0byB1bmxpbmsuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdW5saW5rKHVzZXI6IFVzZXIsIHByb3ZpZGVySWQ6IHN0cmluZyk6IFByb21pc2U8VXNlcj4ge1xuICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikgYXMgVXNlckludGVybmFsO1xuICBhd2FpdCBfYXNzZXJ0TGlua2VkU3RhdHVzKHRydWUsIHVzZXJJbnRlcm5hbCwgcHJvdmlkZXJJZCk7XG4gIGNvbnN0IHsgcHJvdmlkZXJVc2VySW5mbyB9ID0gYXdhaXQgZGVsZXRlTGlua2VkQWNjb3VudHModXNlckludGVybmFsLmF1dGgsIHtcbiAgICBpZFRva2VuOiBhd2FpdCB1c2VySW50ZXJuYWwuZ2V0SWRUb2tlbigpLFxuICAgIGRlbGV0ZVByb3ZpZGVyOiBbcHJvdmlkZXJJZF1cbiAgfSk7XG5cbiAgY29uc3QgcHJvdmlkZXJzTGVmdCA9IHByb3ZpZGVyRGF0YUFzTmFtZXMocHJvdmlkZXJVc2VySW5mbyB8fCBbXSk7XG5cbiAgdXNlckludGVybmFsLnByb3ZpZGVyRGF0YSA9IHVzZXJJbnRlcm5hbC5wcm92aWRlckRhdGEuZmlsdGVyKHBkID0+XG4gICAgcHJvdmlkZXJzTGVmdC5oYXMocGQucHJvdmlkZXJJZClcbiAgKTtcbiAgaWYgKCFwcm92aWRlcnNMZWZ0LmhhcyhQcm92aWRlcklkLlBIT05FKSkge1xuICAgIHVzZXJJbnRlcm5hbC5waG9uZU51bWJlciA9IG51bGw7XG4gIH1cblxuICBhd2FpdCB1c2VySW50ZXJuYWwuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlckludGVybmFsKTtcbiAgcmV0dXJuIHVzZXJJbnRlcm5hbDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF9saW5rKFxuICB1c2VyOiBVc2VySW50ZXJuYWwsXG4gIGNyZWRlbnRpYWw6IEF1dGhDcmVkZW50aWFsLFxuICBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZVxuKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbEludGVybmFsPiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2xvZ291dElmSW52YWxpZGF0ZWQoXG4gICAgdXNlcixcbiAgICBjcmVkZW50aWFsLl9saW5rVG9JZFRva2VuKHVzZXIuYXV0aCwgYXdhaXQgdXNlci5nZXRJZFRva2VuKCkpLFxuICAgIGJ5cGFzc0F1dGhTdGF0ZVxuICApO1xuICByZXR1cm4gVXNlckNyZWRlbnRpYWxJbXBsLl9mb3JPcGVyYXRpb24odXNlciwgT3BlcmF0aW9uVHlwZS5MSU5LLCByZXNwb25zZSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfYXNzZXJ0TGlua2VkU3RhdHVzKFxuICBleHBlY3RlZDogYm9vbGVhbixcbiAgdXNlcjogVXNlckludGVybmFsLFxuICBwcm92aWRlcjogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgX3JlbG9hZFdpdGhvdXRTYXZpbmcodXNlcik7XG4gIGNvbnN0IHByb3ZpZGVySWRzID0gcHJvdmlkZXJEYXRhQXNOYW1lcyh1c2VyLnByb3ZpZGVyRGF0YSk7XG5cbiAgY29uc3QgY29kZSA9XG4gICAgZXhwZWN0ZWQgPT09IGZhbHNlXG4gICAgICA/IEF1dGhFcnJvckNvZGUuUFJPVklERVJfQUxSRUFEWV9MSU5LRURcbiAgICAgIDogQXV0aEVycm9yQ29kZS5OT19TVUNIX1BST1ZJREVSO1xuICBfYXNzZXJ0KHByb3ZpZGVySWRzLmhhcyhwcm92aWRlcikgPT09IGV4cGVjdGVkLCB1c2VyLmF1dGgsIGNvZGUpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEZpcmViYXNlRXJyb3IgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBfcHJvY2Vzc0NyZWRlbnRpYWxTYXZpbmdNZmFDb250ZXh0SWZOZWNlc3NhcnkgfSBmcm9tICcuLi8uLi9tZmEvbWZhX2Vycm9yJztcbmltcG9ydCB7IE9wZXJhdGlvblR5cGUgfSBmcm9tICcuLi8uLi9tb2RlbC9lbnVtcyc7XG5pbXBvcnQgeyBVc2VySW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC91c2VyJztcbmltcG9ydCB7IEF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vY3JlZGVudGlhbHMnO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5pbXBvcnQgeyBfYXNzZXJ0LCBfZmFpbCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IF9wYXJzZVRva2VuIH0gZnJvbSAnLi9pZF90b2tlbl9yZXN1bHQnO1xuaW1wb3J0IHsgX2xvZ291dElmSW52YWxpZGF0ZWQgfSBmcm9tICcuL2ludmFsaWRhdGlvbic7XG5pbXBvcnQgeyBVc2VyQ3JlZGVudGlhbEltcGwgfSBmcm9tICcuL3VzZXJfY3JlZGVudGlhbF9pbXBsJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF9yZWF1dGhlbnRpY2F0ZShcbiAgdXNlcjogVXNlckludGVybmFsLFxuICBjcmVkZW50aWFsOiBBdXRoQ3JlZGVudGlhbCxcbiAgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2Vcbik6IFByb21pc2U8VXNlckNyZWRlbnRpYWxJbXBsPiB7XG4gIGNvbnN0IHsgYXV0aCB9ID0gdXNlcjtcbiAgY29uc3Qgb3BlcmF0aW9uVHlwZSA9IE9wZXJhdGlvblR5cGUuUkVBVVRIRU5USUNBVEU7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKFxuICAgICAgdXNlcixcbiAgICAgIF9wcm9jZXNzQ3JlZGVudGlhbFNhdmluZ01mYUNvbnRleHRJZk5lY2Vzc2FyeShcbiAgICAgICAgYXV0aCxcbiAgICAgICAgb3BlcmF0aW9uVHlwZSxcbiAgICAgICAgY3JlZGVudGlhbCxcbiAgICAgICAgdXNlclxuICAgICAgKSxcbiAgICAgIGJ5cGFzc0F1dGhTdGF0ZVxuICAgICk7XG4gICAgX2Fzc2VydChyZXNwb25zZS5pZFRva2VuLCBhdXRoLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgICBjb25zdCBwYXJzZWQgPSBfcGFyc2VUb2tlbihyZXNwb25zZS5pZFRva2VuKTtcbiAgICBfYXNzZXJ0KHBhcnNlZCwgYXV0aCwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG5cbiAgICBjb25zdCB7IHN1YjogbG9jYWxJZCB9ID0gcGFyc2VkO1xuICAgIF9hc3NlcnQodXNlci51aWQgPT09IGxvY2FsSWQsIGF1dGgsIEF1dGhFcnJvckNvZGUuVVNFUl9NSVNNQVRDSCk7XG5cbiAgICByZXR1cm4gVXNlckNyZWRlbnRpYWxJbXBsLl9mb3JPcGVyYXRpb24odXNlciwgb3BlcmF0aW9uVHlwZSwgcmVzcG9uc2UpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gQ29udmVydCB1c2VyIGRlbGV0ZWQgZXJyb3IgaW50byB1c2VyIG1pc21hdGNoXG4gICAgaWYgKChlIGFzIEZpcmViYXNlRXJyb3IpPy5jb2RlID09PSBgYXV0aC8ke0F1dGhFcnJvckNvZGUuVVNFUl9ERUxFVEVEfWApIHtcbiAgICAgIF9mYWlsKGF1dGgsIEF1dGhFcnJvckNvZGUuVVNFUl9NSVNNQVRDSCk7XG4gICAgfVxuICAgIHRocm93IGU7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBVc2VyQ3JlZGVudGlhbCwgQXV0aCwgVXNlciB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCB7IF9wcm9jZXNzQ3JlZGVudGlhbFNhdmluZ01mYUNvbnRleHRJZk5lY2Vzc2FyeSB9IGZyb20gJy4uLy4uL21mYS9tZmFfZXJyb3InO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBVc2VySW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC91c2VyJztcbmltcG9ydCB7IEF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vY3JlZGVudGlhbHMnO1xuaW1wb3J0IHsgX2Fzc2VydExpbmtlZFN0YXR1cywgX2xpbmsgfSBmcm9tICcuLi91c2VyL2xpbmtfdW5saW5rJztcbmltcG9ydCB7IF9yZWF1dGhlbnRpY2F0ZSB9IGZyb20gJy4uL3VzZXIvcmVhdXRoZW50aWNhdGUnO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbXBsIH0gZnJvbSAnLi4vdXNlci91c2VyX2NyZWRlbnRpYWxfaW1wbCc7XG5pbXBvcnQgeyBfY2FzdEF1dGggfSBmcm9tICcuLi9hdXRoL2F1dGhfaW1wbCc7XG5pbXBvcnQgeyBnZXRNb2R1bGFySW5zdGFuY2UgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBPcGVyYXRpb25UeXBlIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX3NpZ25JbldpdGhDcmVkZW50aWFsKFxuICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gIGNyZWRlbnRpYWw6IEF1dGhDcmVkZW50aWFsLFxuICBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZVxuKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD4ge1xuICBjb25zdCBvcGVyYXRpb25UeXBlID0gT3BlcmF0aW9uVHlwZS5TSUdOX0lOO1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IF9wcm9jZXNzQ3JlZGVudGlhbFNhdmluZ01mYUNvbnRleHRJZk5lY2Vzc2FyeShcbiAgICBhdXRoLFxuICAgIG9wZXJhdGlvblR5cGUsXG4gICAgY3JlZGVudGlhbFxuICApO1xuICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IFVzZXJDcmVkZW50aWFsSW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShcbiAgICBhdXRoLFxuICAgIG9wZXJhdGlvblR5cGUsXG4gICAgcmVzcG9uc2VcbiAgKTtcblxuICBpZiAoIWJ5cGFzc0F1dGhTdGF0ZSkge1xuICAgIGF3YWl0IGF1dGguX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xuICB9XG4gIHJldHVybiB1c2VyQ3JlZGVudGlhbDtcbn1cblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB3aXRoIHRoZSBnaXZlbiBjcmVkZW50aWFscy5cbiAqXG4gKiBAcmVtYXJrc1xuICogQW4ge0BsaW5rIEF1dGhQcm92aWRlcn0gY2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIGNyZWRlbnRpYWwuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGNyZWRlbnRpYWwgLSBUaGUgYXV0aCBjcmVkZW50aWFsLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhDcmVkZW50aWFsKFxuICBhdXRoOiBBdXRoLFxuICBjcmVkZW50aWFsOiBBdXRoQ3JlZGVudGlhbFxuKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD4ge1xuICByZXR1cm4gX3NpZ25JbldpdGhDcmVkZW50aWFsKF9jYXN0QXV0aChhdXRoKSwgY3JlZGVudGlhbCk7XG59XG5cbi8qKlxuICogTGlua3MgdGhlIHVzZXIgYWNjb3VudCB3aXRoIHRoZSBnaXZlbiBjcmVkZW50aWFscy5cbiAqXG4gKiBAcmVtYXJrc1xuICogQW4ge0BsaW5rIEF1dGhQcm92aWRlcn0gY2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIGNyZWRlbnRpYWwuXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBjcmVkZW50aWFsIC0gVGhlIGF1dGggY3JlZGVudGlhbC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rV2l0aENyZWRlbnRpYWwoXG4gIHVzZXI6IFVzZXIsXG4gIGNyZWRlbnRpYWw6IEF1dGhDcmVkZW50aWFsXG4pOiBQcm9taXNlPFVzZXJDcmVkZW50aWFsPiB7XG4gIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSBhcyBVc2VySW50ZXJuYWw7XG5cbiAgYXdhaXQgX2Fzc2VydExpbmtlZFN0YXR1cyhmYWxzZSwgdXNlckludGVybmFsLCBjcmVkZW50aWFsLnByb3ZpZGVySWQpO1xuXG4gIHJldHVybiBfbGluayh1c2VySW50ZXJuYWwsIGNyZWRlbnRpYWwpO1xufVxuXG4vKipcbiAqIFJlLWF1dGhlbnRpY2F0ZXMgYSB1c2VyIHVzaW5nIGEgZnJlc2ggY3JlZGVudGlhbC5cbiAqXG4gKiBAcmVtYXJrc1xuICogVXNlIGJlZm9yZSBvcGVyYXRpb25zIHN1Y2ggYXMge0BsaW5rIHVwZGF0ZVBhc3N3b3JkfSB0aGF0IHJlcXVpcmUgdG9rZW5zIGZyb20gcmVjZW50IHNpZ24taW5cbiAqIGF0dGVtcHRzLiBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCB0byByZWNvdmVyIGZyb20gYSBgQ1JFREVOVElBTF9UT09fT0xEX0xPR0lOX0FHQUlOYCBlcnJvclxuICogb3IgYSBgVE9LRU5fRVhQSVJFRGAgZXJyb3IuXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBjcmVkZW50aWFsIC0gVGhlIGF1dGggY3JlZGVudGlhbC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsKFxuICB1c2VyOiBVc2VyLFxuICBjcmVkZW50aWFsOiBBdXRoQ3JlZGVudGlhbFxuKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD4ge1xuICByZXR1cm4gX3JlYXV0aGVudGljYXRlKGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSBhcyBVc2VySW50ZXJuYWwsIGNyZWRlbnRpYWwpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEVuZHBvaW50LFxuICBIdHRwTWV0aG9kLFxuICBfYWRkVGlkSWZOZWNlc3NhcnksXG4gIF9wZXJmb3JtU2lnbkluUmVxdWVzdFxufSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgeyBJZFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9tb2RlbC9pZF90b2tlbic7XG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBTaWduSW5XaXRoQ3VzdG9tVG9rZW5SZXF1ZXN0IHtcbiAgdG9rZW46IHN0cmluZztcbiAgcmV0dXJuU2VjdXJlVG9rZW46IGJvb2xlYW47XG4gIHRlbmFudElkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNpZ25JbldpdGhDdXN0b21Ub2tlblJlc3BvbnNlIGV4dGVuZHMgSWRUb2tlblJlc3BvbnNlIHt9XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoQ3VzdG9tVG9rZW4oXG4gIGF1dGg6IEF1dGgsXG4gIHJlcXVlc3Q6IFNpZ25JbldpdGhDdXN0b21Ub2tlblJlcXVlc3Rcbik6IFByb21pc2U8U2lnbkluV2l0aEN1c3RvbVRva2VuUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtU2lnbkluUmVxdWVzdDxcbiAgICBTaWduSW5XaXRoQ3VzdG9tVG9rZW5SZXF1ZXN0LFxuICAgIFNpZ25JbldpdGhDdXN0b21Ub2tlblJlc3BvbnNlXG4gID4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuU0lHTl9JTl9XSVRIX0NVU1RPTV9UT0tFTixcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBdXRoLCBVc2VyQ3JlZGVudGlhbCB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCB7IHNpZ25JbldpdGhDdXN0b21Ub2tlbiBhcyBnZXRJZFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vY3VzdG9tX3Rva2VuJztcbmltcG9ydCB7IElkVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IFVzZXJDcmVkZW50aWFsSW1wbCB9IGZyb20gJy4uL3VzZXIvdXNlcl9jcmVkZW50aWFsX2ltcGwnO1xuaW1wb3J0IHsgX2Nhc3RBdXRoIH0gZnJvbSAnLi4vYXV0aC9hdXRoX2ltcGwnO1xuaW1wb3J0IHsgT3BlcmF0aW9uVHlwZSB9IGZyb20gJy4uLy4uL21vZGVsL2VudW1zJztcblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhIGN1c3RvbSB0b2tlbi5cbiAqXG4gKiBAcmVtYXJrc1xuICogQ3VzdG9tIHRva2VucyBhcmUgdXNlZCB0byBpbnRlZ3JhdGUgRmlyZWJhc2UgQXV0aCB3aXRoIGV4aXN0aW5nIGF1dGggc3lzdGVtcywgYW5kIG11c3RcbiAqIGJlIGdlbmVyYXRlZCBieSBhbiBhdXRoIGJhY2tlbmQgdXNpbmcgdGhlXG4gKiB7QGxpbmsgaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL2RvY3MvcmVmZXJlbmNlL2FkbWluL25vZGUvYWRtaW4uYXV0aC5BdXRoI2NyZWF0ZWN1c3RvbXRva2VuIHwgY3JlYXRlQ3VzdG9tVG9rZW59XG4gKiBtZXRob2QgaW4gdGhlIHtAbGluayBodHRwczovL2ZpcmViYXNlLmdvb2dsZS5jb20vZG9jcy9hdXRoL2FkbWluIHwgQWRtaW4gU0RLfSAuXG4gKlxuICogRmFpbHMgd2l0aCBhbiBlcnJvciBpZiB0aGUgdG9rZW4gaXMgaW52YWxpZCwgZXhwaXJlZCwgb3Igbm90IGFjY2VwdGVkIGJ5IHRoZSBGaXJlYmFzZSBBdXRoIHNlcnZpY2UuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGN1c3RvbVRva2VuIC0gVGhlIGN1c3RvbSB0b2tlbiB0byBzaWduIGluIHdpdGguXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2lnbkluV2l0aEN1c3RvbVRva2VuKFxuICBhdXRoOiBBdXRoLFxuICBjdXN0b21Ub2tlbjogc3RyaW5nXG4pOiBQcm9taXNlPFVzZXJDcmVkZW50aWFsPiB7XG4gIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgY29uc3QgcmVzcG9uc2U6IElkVG9rZW5SZXNwb25zZSA9IGF3YWl0IGdldElkVG9rZW5SZXNwb25zZShhdXRoSW50ZXJuYWwsIHtcbiAgICB0b2tlbjogY3VzdG9tVG9rZW4sXG4gICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcbiAgfSk7XG4gIGNvbnN0IGNyZWQgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoXG4gICAgYXV0aEludGVybmFsLFxuICAgIE9wZXJhdGlvblR5cGUuU0lHTl9JTixcbiAgICByZXNwb25zZVxuICApO1xuICBhd2FpdCBhdXRoSW50ZXJuYWwuX3VwZGF0ZUN1cnJlbnRVc2VyKGNyZWQudXNlcik7XG4gIHJldHVybiBjcmVkO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEZhY3RvcklkLFxuICBNdWx0aUZhY3RvckluZm8sXG4gIFBob25lTXVsdGlGYWN0b3JJbmZvLFxuICBUb3RwTXVsdGlGYWN0b3JJbmZvXG59IGZyb20gJy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQge1xuICBQaG9uZU1mYUVucm9sbG1lbnQsXG4gIE1mYUVucm9sbG1lbnQsXG4gIFRvdHBNZmFFbnJvbGxtZW50XG59IGZyb20gJy4uL2FwaS9hY2NvdW50X21hbmFnZW1lbnQvbWZhJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9jb3JlL2Vycm9ycyc7XG5pbXBvcnQgeyBfZmFpbCB9IGZyb20gJy4uL2NvcmUvdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vbW9kZWwvYXV0aCc7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBNdWx0aUZhY3RvckluZm9JbXBsIGltcGxlbWVudHMgTXVsdGlGYWN0b3JJbmZvIHtcbiAgcmVhZG9ubHkgdWlkOiBzdHJpbmc7XG4gIHJlYWRvbmx5IGRpc3BsYXlOYW1lPzogc3RyaW5nIHwgbnVsbDtcbiAgcmVhZG9ubHkgZW5yb2xsbWVudFRpbWU6IHN0cmluZztcblxuICBwcm90ZWN0ZWQgY29uc3RydWN0b3IocmVhZG9ubHkgZmFjdG9ySWQ6IEZhY3RvcklkLCByZXNwb25zZTogTWZhRW5yb2xsbWVudCkge1xuICAgIHRoaXMudWlkID0gcmVzcG9uc2UubWZhRW5yb2xsbWVudElkO1xuICAgIHRoaXMuZW5yb2xsbWVudFRpbWUgPSBuZXcgRGF0ZShyZXNwb25zZS5lbnJvbGxlZEF0KS50b1VUQ1N0cmluZygpO1xuICAgIHRoaXMuZGlzcGxheU5hbWUgPSByZXNwb25zZS5kaXNwbGF5TmFtZTtcbiAgfVxuXG4gIHN0YXRpYyBfZnJvbVNlcnZlclJlc3BvbnNlKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBlbnJvbGxtZW50OiBNZmFFbnJvbGxtZW50XG4gICk6IE11bHRpRmFjdG9ySW5mb0ltcGwge1xuICAgIGlmICgncGhvbmVJbmZvJyBpbiBlbnJvbGxtZW50KSB7XG4gICAgICByZXR1cm4gUGhvbmVNdWx0aUZhY3RvckluZm9JbXBsLl9mcm9tU2VydmVyUmVzcG9uc2UoYXV0aCwgZW5yb2xsbWVudCk7XG4gICAgfSBlbHNlIGlmICgndG90cEluZm8nIGluIGVucm9sbG1lbnQpIHtcbiAgICAgIHJldHVybiBUb3RwTXVsdGlGYWN0b3JJbmZvSW1wbC5fZnJvbVNlcnZlclJlc3BvbnNlKGF1dGgsIGVucm9sbG1lbnQpO1xuICAgIH1cbiAgICByZXR1cm4gX2ZhaWwoYXV0aCwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFBob25lTXVsdGlGYWN0b3JJbmZvSW1wbFxuICBleHRlbmRzIE11bHRpRmFjdG9ySW5mb0ltcGxcbiAgaW1wbGVtZW50cyBQaG9uZU11bHRpRmFjdG9ySW5mb1xue1xuICByZWFkb25seSBwaG9uZU51bWJlcjogc3RyaW5nO1xuXG4gIHByaXZhdGUgY29uc3RydWN0b3IocmVzcG9uc2U6IFBob25lTWZhRW5yb2xsbWVudCkge1xuICAgIHN1cGVyKEZhY3RvcklkLlBIT05FLCByZXNwb25zZSk7XG4gICAgdGhpcy5waG9uZU51bWJlciA9IHJlc3BvbnNlLnBob25lSW5mbztcbiAgfVxuXG4gIHN0YXRpYyBfZnJvbVNlcnZlclJlc3BvbnNlKFxuICAgIF9hdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgZW5yb2xsbWVudDogTWZhRW5yb2xsbWVudFxuICApOiBQaG9uZU11bHRpRmFjdG9ySW5mb0ltcGwge1xuICAgIHJldHVybiBuZXcgUGhvbmVNdWx0aUZhY3RvckluZm9JbXBsKGVucm9sbG1lbnQgYXMgUGhvbmVNZmFFbnJvbGxtZW50KTtcbiAgfVxufVxuZXhwb3J0IGNsYXNzIFRvdHBNdWx0aUZhY3RvckluZm9JbXBsXG4gIGV4dGVuZHMgTXVsdGlGYWN0b3JJbmZvSW1wbFxuICBpbXBsZW1lbnRzIFRvdHBNdWx0aUZhY3RvckluZm9cbntcbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcihyZXNwb25zZTogVG90cE1mYUVucm9sbG1lbnQpIHtcbiAgICBzdXBlcihGYWN0b3JJZC5UT1RQLCByZXNwb25zZSk7XG4gIH1cblxuICBzdGF0aWMgX2Zyb21TZXJ2ZXJSZXNwb25zZShcbiAgICBfYXV0aDogQXV0aEludGVybmFsLFxuICAgIGVucm9sbG1lbnQ6IE1mYUVucm9sbG1lbnRcbiAgKTogVG90cE11bHRpRmFjdG9ySW5mb0ltcGwge1xuICAgIHJldHVybiBuZXcgVG90cE11bHRpRmFjdG9ySW5mb0ltcGwoZW5yb2xsbWVudCBhcyBUb3RwTWZhRW5yb2xsbWVudCk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBY3Rpb25Db2RlU2V0dGluZ3MsIEF1dGggfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5pbXBvcnQgeyBHZXRPb2JDb2RlUmVxdWVzdCB9IGZyb20gJy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi9lbWFpbF9hbmRfcGFzc3dvcmQnO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9ycyc7XG5pbXBvcnQgeyBfYXNzZXJ0IH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuXG5leHBvcnQgZnVuY3Rpb24gX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdChcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogR2V0T29iQ29kZVJlcXVlc3QsXG4gIGFjdGlvbkNvZGVTZXR0aW5nczogQWN0aW9uQ29kZVNldHRpbmdzXG4pOiB2b2lkIHtcbiAgX2Fzc2VydChcbiAgICBhY3Rpb25Db2RlU2V0dGluZ3MudXJsPy5sZW5ndGggPiAwLFxuICAgIGF1dGgsXG4gICAgQXV0aEVycm9yQ29kZS5JTlZBTElEX0NPTlRJTlVFX1VSSVxuICApO1xuICBfYXNzZXJ0KFxuICAgIHR5cGVvZiBhY3Rpb25Db2RlU2V0dGluZ3MuZHluYW1pY0xpbmtEb21haW4gPT09ICd1bmRlZmluZWQnIHx8XG4gICAgICBhY3Rpb25Db2RlU2V0dGluZ3MuZHluYW1pY0xpbmtEb21haW4ubGVuZ3RoID4gMCxcbiAgICBhdXRoLFxuICAgIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9EWU5BTUlDX0xJTktfRE9NQUlOXG4gICk7XG5cbiAgcmVxdWVzdC5jb250aW51ZVVybCA9IGFjdGlvbkNvZGVTZXR0aW5ncy51cmw7XG4gIHJlcXVlc3QuZHluYW1pY0xpbmtEb21haW4gPSBhY3Rpb25Db2RlU2V0dGluZ3MuZHluYW1pY0xpbmtEb21haW47XG4gIHJlcXVlc3QuY2FuSGFuZGxlQ29kZUluQXBwID0gYWN0aW9uQ29kZVNldHRpbmdzLmhhbmRsZUNvZGVJbkFwcDtcblxuICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzLmlPUykge1xuICAgIF9hc3NlcnQoXG4gICAgICBhY3Rpb25Db2RlU2V0dGluZ3MuaU9TLmJ1bmRsZUlkLmxlbmd0aCA+IDAsXG4gICAgICBhdXRoLFxuICAgICAgQXV0aEVycm9yQ29kZS5NSVNTSU5HX0lPU19CVU5ETEVfSURcbiAgICApO1xuICAgIHJlcXVlc3QuaU9TQnVuZGxlSWQgPSBhY3Rpb25Db2RlU2V0dGluZ3MuaU9TLmJ1bmRsZUlkO1xuICB9XG5cbiAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncy5hbmRyb2lkKSB7XG4gICAgX2Fzc2VydChcbiAgICAgIGFjdGlvbkNvZGVTZXR0aW5ncy5hbmRyb2lkLnBhY2thZ2VOYW1lLmxlbmd0aCA+IDAsXG4gICAgICBhdXRoLFxuICAgICAgQXV0aEVycm9yQ29kZS5NSVNTSU5HX0FORFJPSURfUEFDS0FHRV9OQU1FXG4gICAgKTtcbiAgICByZXF1ZXN0LmFuZHJvaWRJbnN0YWxsQXBwID0gYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQuaW5zdGFsbEFwcDtcbiAgICByZXF1ZXN0LmFuZHJvaWRNaW5pbXVtVmVyc2lvbkNvZGUgPVxuICAgICAgYWN0aW9uQ29kZVNldHRpbmdzLmFuZHJvaWQubWluaW11bVZlcnNpb247XG4gICAgcmVxdWVzdC5hbmRyb2lkUGFja2FnZU5hbWUgPSBhY3Rpb25Db2RlU2V0dGluZ3MuYW5kcm9pZC5wYWNrYWdlTmFtZTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEFjdGlvbkNvZGVJbmZvLFxuICBBY3Rpb25Db2RlT3BlcmF0aW9uLFxuICBBY3Rpb25Db2RlU2V0dGluZ3MsXG4gIEF1dGgsXG4gIFVzZXJDcmVkZW50aWFsXG59IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCAqIGFzIGFjY291bnQgZnJvbSAnLi4vLi4vYXBpL2FjY291bnRfbWFuYWdlbWVudC9lbWFpbF9hbmRfcGFzc3dvcmQnO1xuaW1wb3J0ICogYXMgYXV0aGVudGljYXRpb24gZnJvbSAnLi4vLi4vYXBpL2F1dGhlbnRpY2F0aW9uL2VtYWlsX2FuZF9wYXNzd29yZCc7XG5pbXBvcnQgeyBzaWduVXAsIFNpZ25VcFJlcXVlc3QgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vc2lnbl91cCc7XG5pbXBvcnQgeyBNdWx0aUZhY3RvckluZm9JbXBsIH0gZnJvbSAnLi4vLi4vbWZhL21mYV9pbmZvJztcbmltcG9ydCB7IEVtYWlsQXV0aFByb3ZpZGVyIH0gZnJvbSAnLi4vcHJvdmlkZXJzL2VtYWlsJztcbmltcG9ydCB7IFVzZXJDcmVkZW50aWFsSW1wbCB9IGZyb20gJy4uL3VzZXIvdXNlcl9jcmVkZW50aWFsX2ltcGwnO1xuaW1wb3J0IHsgX2Fzc2VydCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QgfSBmcm9tICcuL2FjdGlvbl9jb2RlX3NldHRpbmdzJztcbmltcG9ydCB7IHNpZ25JbldpdGhDcmVkZW50aWFsIH0gZnJvbSAnLi9jcmVkZW50aWFsJztcbmltcG9ydCB7IF9jYXN0QXV0aCB9IGZyb20gJy4uL2F1dGgvYXV0aF9pbXBsJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9lcnJvcnMnO1xuaW1wb3J0IHsgZ2V0TW9kdWxhckluc3RhbmNlIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgT3BlcmF0aW9uVHlwZSB9IGZyb20gJy4uLy4uL21vZGVsL2VudW1zJztcbmltcG9ydCB7IGluamVjdFJlY2FwdGNoYUZpZWxkcyB9IGZyb20gJy4uLy4uL3BsYXRmb3JtX2Jyb3dzZXIvcmVjYXB0Y2hhL3JlY2FwdGNoYV9lbnRlcnByaXNlX3ZlcmlmaWVyJztcbmltcG9ydCB7IElkVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IFJlY2FwdGNoYUFjdGlvbk5hbWUsIFJlY2FwdGNoYUNsaWVudFR5cGUgfSBmcm9tICcuLi8uLi9hcGknO1xuXG4vKipcbiAqIFNlbmRzIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG8gdGhlIGdpdmVuIGVtYWlsIGFkZHJlc3MuXG4gKlxuICogQHJlbWFya3NcbiAqIFRvIGNvbXBsZXRlIHRoZSBwYXNzd29yZCByZXNldCwgY2FsbCB7QGxpbmsgY29uZmlybVBhc3N3b3JkUmVzZXR9IHdpdGggdGhlIGNvZGUgc3VwcGxpZWQgaW5cbiAqIHRoZSBlbWFpbCBzZW50IHRvIHRoZSB1c2VyLCBhbG9uZyB3aXRoIHRoZSBuZXcgcGFzc3dvcmQgc3BlY2lmaWVkIGJ5IHRoZSB1c2VyLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBjb25zdCBhY3Rpb25Db2RlU2V0dGluZ3MgPSB7XG4gKiAgIHVybDogJ2h0dHBzOi8vd3d3LmV4YW1wbGUuY29tLz9lbWFpbD11c2VyQGV4YW1wbGUuY29tJyxcbiAqICAgaU9TOiB7XG4gKiAgICAgIGJ1bmRsZUlkOiAnY29tLmV4YW1wbGUuaW9zJ1xuICogICB9LFxuICogICBhbmRyb2lkOiB7XG4gKiAgICAgcGFja2FnZU5hbWU6ICdjb20uZXhhbXBsZS5hbmRyb2lkJyxcbiAqICAgICBpbnN0YWxsQXBwOiB0cnVlLFxuICogICAgIG1pbmltdW1WZXJzaW9uOiAnMTInXG4gKiAgIH0sXG4gKiAgIGhhbmRsZUNvZGVJbkFwcDogdHJ1ZVxuICogfTtcbiAqIGF3YWl0IHNlbmRQYXNzd29yZFJlc2V0RW1haWwoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xuICogLy8gT2J0YWluIGNvZGUgZnJvbSB1c2VyLlxuICogYXdhaXQgY29uZmlybVBhc3N3b3JkUmVzZXQoJ3VzZXJAZXhhbXBsZS5jb20nLCBjb2RlKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBlbWFpbCAtIFRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cbiAqIEBwYXJhbSBhY3Rpb25Db2RlU2V0dGluZ3MgLSBUaGUge0BsaW5rIEFjdGlvbkNvZGVTZXR0aW5nc30uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChcbiAgYXV0aDogQXV0aCxcbiAgZW1haWw6IHN0cmluZyxcbiAgYWN0aW9uQ29kZVNldHRpbmdzPzogQWN0aW9uQ29kZVNldHRpbmdzXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICBjb25zdCByZXF1ZXN0OiBhdXRoZW50aWNhdGlvbi5QYXNzd29yZFJlc2V0UmVxdWVzdCA9IHtcbiAgICByZXF1ZXN0VHlwZTogQWN0aW9uQ29kZU9wZXJhdGlvbi5QQVNTV09SRF9SRVNFVCxcbiAgICBlbWFpbCxcbiAgICBjbGllbnRUeXBlOiBSZWNhcHRjaGFDbGllbnRUeXBlLldFQlxuICB9O1xuICBpZiAoYXV0aEludGVybmFsLl9nZXRSZWNhcHRjaGFDb25maWcoKT8uZW1haWxQYXNzd29yZEVuYWJsZWQpIHtcbiAgICBjb25zdCByZXF1ZXN0V2l0aFJlY2FwdGNoYSA9IGF3YWl0IGluamVjdFJlY2FwdGNoYUZpZWxkcyhcbiAgICAgIGF1dGhJbnRlcm5hbCxcbiAgICAgIHJlcXVlc3QsXG4gICAgICBSZWNhcHRjaGFBY3Rpb25OYW1lLkdFVF9PT0JfQ09ERSxcbiAgICAgIHRydWVcbiAgICApO1xuICAgIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MpIHtcbiAgICAgIF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QoXG4gICAgICAgIGF1dGhJbnRlcm5hbCxcbiAgICAgICAgcmVxdWVzdFdpdGhSZWNhcHRjaGEsXG4gICAgICAgIGFjdGlvbkNvZGVTZXR0aW5nc1xuICAgICAgKTtcbiAgICB9XG4gICAgYXdhaXQgYXV0aGVudGljYXRpb24uc2VuZFBhc3N3b3JkUmVzZXRFbWFpbChcbiAgICAgIGF1dGhJbnRlcm5hbCxcbiAgICAgIHJlcXVlc3RXaXRoUmVjYXB0Y2hhXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAoYWN0aW9uQ29kZVNldHRpbmdzKSB7XG4gICAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KFxuICAgICAgICBhdXRoSW50ZXJuYWwsXG4gICAgICAgIHJlcXVlc3QsXG4gICAgICAgIGFjdGlvbkNvZGVTZXR0aW5nc1xuICAgICAgKTtcbiAgICB9XG4gICAgYXdhaXQgYXV0aGVudGljYXRpb25cbiAgICAgIC5zZW5kUGFzc3dvcmRSZXNldEVtYWlsKGF1dGhJbnRlcm5hbCwgcmVxdWVzdClcbiAgICAgIC5jYXRjaChhc3luYyBlcnJvciA9PiB7XG4gICAgICAgIGlmIChlcnJvci5jb2RlID09PSBgYXV0aC8ke0F1dGhFcnJvckNvZGUuTUlTU0lOR19SRUNBUFRDSEFfVE9LRU59YCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgJ1Bhc3N3b3JkIHJlc2V0cyBhcmUgcHJvdGVjdGVkIGJ5IHJlQ0FQVENIQSBmb3IgdGhpcyBwcm9qZWN0LiBBdXRvbWF0aWNhbGx5IHRyaWdnZXJpbmcgdGhlIHJlQ0FQVENIQSBmbG93IGFuZCByZXN0YXJ0aW5nIHRoZSBwYXNzd29yZCByZXNldCBmbG93LidcbiAgICAgICAgICApO1xuICAgICAgICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhID0gYXdhaXQgaW5qZWN0UmVjYXB0Y2hhRmllbGRzKFxuICAgICAgICAgICAgYXV0aEludGVybmFsLFxuICAgICAgICAgICAgcmVxdWVzdCxcbiAgICAgICAgICAgIFJlY2FwdGNoYUFjdGlvbk5hbWUuR0VUX09PQl9DT0RFLFxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgICAgICAgICAgX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdChcbiAgICAgICAgICAgICAgYXV0aEludGVybmFsLFxuICAgICAgICAgICAgICByZXF1ZXN0V2l0aFJlY2FwdGNoYSxcbiAgICAgICAgICAgICAgYWN0aW9uQ29kZVNldHRpbmdzXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhd2FpdCBhdXRoZW50aWNhdGlvbi5zZW5kUGFzc3dvcmRSZXNldEVtYWlsKFxuICAgICAgICAgICAgYXV0aEludGVybmFsLFxuICAgICAgICAgICAgcmVxdWVzdFdpdGhSZWNhcHRjaGFcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogQ29tcGxldGVzIHRoZSBwYXNzd29yZCByZXNldCBwcm9jZXNzLCBnaXZlbiBhIGNvbmZpcm1hdGlvbiBjb2RlIGFuZCBuZXcgcGFzc3dvcmQuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIG9vYkNvZGUgLSBBIGNvbmZpcm1hdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXG4gKiBAcGFyYW0gbmV3UGFzc3dvcmQgLSBUaGUgbmV3IHBhc3N3b3JkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbmZpcm1QYXNzd29yZFJlc2V0KFxuICBhdXRoOiBBdXRoLFxuICBvb2JDb2RlOiBzdHJpbmcsXG4gIG5ld1Bhc3N3b3JkOiBzdHJpbmdcbik6IFByb21pc2U8dm9pZD4ge1xuICBhd2FpdCBhY2NvdW50LnJlc2V0UGFzc3dvcmQoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCB7XG4gICAgb29iQ29kZSxcbiAgICBuZXdQYXNzd29yZFxuICB9KTtcbiAgLy8gRG8gbm90IHJldHVybiB0aGUgZW1haWwuXG59XG5cbi8qKlxuICogQXBwbGllcyBhIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIgYnkgZW1haWwgb3Igb3RoZXIgb3V0LW9mLWJhbmQgbWVjaGFuaXNtLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBvb2JDb2RlIC0gQSB2ZXJpZmljYXRpb24gY29kZSBzZW50IHRvIHRoZSB1c2VyLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFwcGx5QWN0aW9uQ29kZShcbiAgYXV0aDogQXV0aCxcbiAgb29iQ29kZTogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgYWNjb3VudC5hcHBseUFjdGlvbkNvZGUoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCB7IG9vYkNvZGUgfSk7XG59XG5cbi8qKlxuICogQ2hlY2tzIGEgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlciBieSBlbWFpbCBvciBvdGhlciBvdXQtb2YtYmFuZCBtZWNoYW5pc20uXG4gKlxuICogQHJldHVybnMgbWV0YWRhdGEgYWJvdXQgdGhlIGNvZGUuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIG9vYkNvZGUgLSBBIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tBY3Rpb25Db2RlKFxuICBhdXRoOiBBdXRoLFxuICBvb2JDb2RlOiBzdHJpbmdcbik6IFByb21pc2U8QWN0aW9uQ29kZUluZm8+IHtcbiAgY29uc3QgYXV0aE1vZHVsYXIgPSBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCk7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYWNjb3VudC5yZXNldFBhc3N3b3JkKGF1dGhNb2R1bGFyLCB7IG9vYkNvZGUgfSk7XG5cbiAgLy8gRW1haWwgY291bGQgYmUgZW1wdHkgb25seSBpZiB0aGUgcmVxdWVzdCB0eXBlIGlzIEVNQUlMX1NJR05JTiBvclxuICAvLyBWRVJJRllfQU5EX0NIQU5HRV9FTUFJTC5cbiAgLy8gTmV3IGVtYWlsIHNob3VsZCBub3QgYmUgZW1wdHkgaWYgdGhlIHJlcXVlc3QgdHlwZSBpc1xuICAvLyBWRVJJRllfQU5EX0NIQU5HRV9FTUFJTC5cbiAgLy8gTXVsdGktZmFjdG9yIGluZm8gY291bGQgbm90IGJlIGVtcHR5IGlmIHRoZSByZXF1ZXN0IHR5cGUgaXNcbiAgLy8gUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT04uXG4gIGNvbnN0IG9wZXJhdGlvbiA9IHJlc3BvbnNlLnJlcXVlc3RUeXBlO1xuICBfYXNzZXJ0KG9wZXJhdGlvbiwgYXV0aE1vZHVsYXIsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICBzd2l0Y2ggKG9wZXJhdGlvbikge1xuICAgIGNhc2UgQWN0aW9uQ29kZU9wZXJhdGlvbi5FTUFJTF9TSUdOSU46XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0FORF9DSEFOR0VfRU1BSUw6XG4gICAgICBfYXNzZXJ0KHJlc3BvbnNlLm5ld0VtYWlsLCBhdXRoTW9kdWxhciwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gICAgICBicmVhaztcbiAgICBjYXNlIEFjdGlvbkNvZGVPcGVyYXRpb24uUkVWRVJUX1NFQ09ORF9GQUNUT1JfQURESVRJT046XG4gICAgICBfYXNzZXJ0KHJlc3BvbnNlLm1mYUluZm8sIGF1dGhNb2R1bGFyLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgICAvLyBmYWxsIHRocm91Z2hcbiAgICBkZWZhdWx0OlxuICAgICAgX2Fzc2VydChyZXNwb25zZS5lbWFpbCwgYXV0aE1vZHVsYXIsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICB9XG5cbiAgLy8gVGhlIG11bHRpLWZhY3RvciBpbmZvIGZvciByZXZlcnQgc2Vjb25kIGZhY3RvciBhZGRpdGlvblxuICBsZXQgbXVsdGlGYWN0b3JJbmZvOiBNdWx0aUZhY3RvckluZm9JbXBsIHwgbnVsbCA9IG51bGw7XG4gIGlmIChyZXNwb25zZS5tZmFJbmZvKSB7XG4gICAgbXVsdGlGYWN0b3JJbmZvID0gTXVsdGlGYWN0b3JJbmZvSW1wbC5fZnJvbVNlcnZlclJlc3BvbnNlKFxuICAgICAgX2Nhc3RBdXRoKGF1dGhNb2R1bGFyKSxcbiAgICAgIHJlc3BvbnNlLm1mYUluZm9cbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBkYXRhOiB7XG4gICAgICBlbWFpbDpcbiAgICAgICAgKHJlc3BvbnNlLnJlcXVlc3RUeXBlID09PSBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMXG4gICAgICAgICAgPyByZXNwb25zZS5uZXdFbWFpbFxuICAgICAgICAgIDogcmVzcG9uc2UuZW1haWwpIHx8IG51bGwsXG4gICAgICBwcmV2aW91c0VtYWlsOlxuICAgICAgICAocmVzcG9uc2UucmVxdWVzdFR5cGUgPT09IEFjdGlvbkNvZGVPcGVyYXRpb24uVkVSSUZZX0FORF9DSEFOR0VfRU1BSUxcbiAgICAgICAgICA/IHJlc3BvbnNlLmVtYWlsXG4gICAgICAgICAgOiByZXNwb25zZS5uZXdFbWFpbCkgfHwgbnVsbCxcbiAgICAgIG11bHRpRmFjdG9ySW5mb1xuICAgIH0sXG4gICAgb3BlcmF0aW9uXG4gIH07XG59XG5cbi8qKlxuICogQ2hlY2tzIGEgcGFzc3dvcmQgcmVzZXQgY29kZSBzZW50IHRvIHRoZSB1c2VyIGJ5IGVtYWlsIG9yIG90aGVyIG91dC1vZi1iYW5kIG1lY2hhbmlzbS5cbiAqXG4gKiBAcmV0dXJucyB0aGUgdXNlcidzIGVtYWlsIGFkZHJlc3MgaWYgdmFsaWQuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGNvZGUgLSBBIHZlcmlmaWNhdGlvbiBjb2RlIHNlbnQgdG8gdGhlIHVzZXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5UGFzc3dvcmRSZXNldENvZGUoXG4gIGF1dGg6IEF1dGgsXG4gIGNvZGU6IHN0cmluZ1xuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBjaGVja0FjdGlvbkNvZGUoZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLCBjb2RlKTtcbiAgLy8gRW1haWwgc2hvdWxkIGFsd2F5cyBiZSBwcmVzZW50IHNpbmNlIGEgY29kZSB3YXMgc2VudCB0byBpdFxuICByZXR1cm4gZGF0YS5lbWFpbCE7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB1c2VyIGFjY291bnQgYXNzb2NpYXRlZCB3aXRoIHRoZSBzcGVjaWZpZWQgZW1haWwgYWRkcmVzcyBhbmQgcGFzc3dvcmQuXG4gKlxuICogQHJlbWFya3NcbiAqIE9uIHN1Y2Nlc3NmdWwgY3JlYXRpb24gb2YgdGhlIHVzZXIgYWNjb3VudCwgdGhpcyB1c2VyIHdpbGwgYWxzbyBiZSBzaWduZWQgaW4gdG8geW91ciBhcHBsaWNhdGlvbi5cbiAqXG4gKiBVc2VyIGFjY291bnQgY3JlYXRpb24gY2FuIGZhaWwgaWYgdGhlIGFjY291bnQgYWxyZWFkeSBleGlzdHMgb3IgdGhlIHBhc3N3b3JkIGlzIGludmFsaWQuXG4gKlxuICogTm90ZTogVGhlIGVtYWlsIGFkZHJlc3MgYWN0cyBhcyBhIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGUgdXNlciBhbmQgZW5hYmxlcyBhbiBlbWFpbC1iYXNlZFxuICogcGFzc3dvcmQgcmVzZXQuIFRoaXMgZnVuY3Rpb24gd2lsbCBjcmVhdGUgYSBuZXcgdXNlciBhY2NvdW50IGFuZCBzZXQgdGhlIGluaXRpYWwgdXNlciBwYXNzd29yZC5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKiBAcGFyYW0gcGFzc3dvcmQgLSBUaGUgdXNlcidzIGNob3NlbiBwYXNzd29yZC5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQoXG4gIGF1dGg6IEF1dGgsXG4gIGVtYWlsOiBzdHJpbmcsXG4gIHBhc3N3b3JkOiBzdHJpbmdcbik6IFByb21pc2U8VXNlckNyZWRlbnRpYWw+IHtcbiAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICBjb25zdCByZXF1ZXN0OiBTaWduVXBSZXF1ZXN0ID0ge1xuICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlLFxuICAgIGVtYWlsLFxuICAgIHBhc3N3b3JkLFxuICAgIGNsaWVudFR5cGU6IFJlY2FwdGNoYUNsaWVudFR5cGUuV0VCXG4gIH07XG4gIGxldCBzaWduVXBSZXNwb25zZTogUHJvbWlzZTxJZFRva2VuUmVzcG9uc2U+O1xuICBpZiAoYXV0aEludGVybmFsLl9nZXRSZWNhcHRjaGFDb25maWcoKT8uZW1haWxQYXNzd29yZEVuYWJsZWQpIHtcbiAgICBjb25zdCByZXF1ZXN0V2l0aFJlY2FwdGNoYSA9IGF3YWl0IGluamVjdFJlY2FwdGNoYUZpZWxkcyhcbiAgICAgIGF1dGhJbnRlcm5hbCxcbiAgICAgIHJlcXVlc3QsXG4gICAgICBSZWNhcHRjaGFBY3Rpb25OYW1lLlNJR05fVVBfUEFTU1dPUkRcbiAgICApO1xuICAgIHNpZ25VcFJlc3BvbnNlID0gc2lnblVwKGF1dGhJbnRlcm5hbCwgcmVxdWVzdFdpdGhSZWNhcHRjaGEpO1xuICB9IGVsc2Uge1xuICAgIHNpZ25VcFJlc3BvbnNlID0gc2lnblVwKGF1dGhJbnRlcm5hbCwgcmVxdWVzdCkuY2F0Y2goYXN5bmMgZXJyb3IgPT4ge1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09IGBhdXRoLyR7QXV0aEVycm9yQ29kZS5NSVNTSU5HX1JFQ0FQVENIQV9UT0tFTn1gKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICdTaWduLXVwIGlzIHByb3RlY3RlZCBieSByZUNBUFRDSEEgZm9yIHRoaXMgcHJvamVjdC4gQXV0b21hdGljYWxseSB0cmlnZ2VyaW5nIHRoZSByZUNBUFRDSEEgZmxvdyBhbmQgcmVzdGFydGluZyB0aGUgc2lnbi11cCBmbG93LidcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgcmVxdWVzdFdpdGhSZWNhcHRjaGEgPSBhd2FpdCBpbmplY3RSZWNhcHRjaGFGaWVsZHMoXG4gICAgICAgICAgYXV0aEludGVybmFsLFxuICAgICAgICAgIHJlcXVlc3QsXG4gICAgICAgICAgUmVjYXB0Y2hhQWN0aW9uTmFtZS5TSUdOX1VQX1BBU1NXT1JEXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBzaWduVXAoYXV0aEludGVybmFsLCByZXF1ZXN0V2l0aFJlY2FwdGNoYSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzaWduVXBSZXNwb25zZS5jYXRjaChlcnJvciA9PiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgfSk7XG5cbiAgY29uc3QgdXNlckNyZWRlbnRpYWwgPSBhd2FpdCBVc2VyQ3JlZGVudGlhbEltcGwuX2Zyb21JZFRva2VuUmVzcG9uc2UoXG4gICAgYXV0aEludGVybmFsLFxuICAgIE9wZXJhdGlvblR5cGUuU0lHTl9JTixcbiAgICByZXNwb25zZVxuICApO1xuICBhd2FpdCBhdXRoSW50ZXJuYWwuX3VwZGF0ZUN1cnJlbnRVc2VyKHVzZXJDcmVkZW50aWFsLnVzZXIpO1xuXG4gIHJldHVybiB1c2VyQ3JlZGVudGlhbDtcbn1cblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhbiBlbWFpbCBhbmQgcGFzc3dvcmQuXG4gKlxuICogQHJlbWFya3NcbiAqIEZhaWxzIHdpdGggYW4gZXJyb3IgaWYgdGhlIGVtYWlsIGFkZHJlc3MgYW5kIHBhc3N3b3JkIGRvIG5vdCBtYXRjaC5cbiAqXG4gKiBOb3RlOiBUaGUgdXNlcidzIHBhc3N3b3JkIGlzIE5PVCB0aGUgcGFzc3dvcmQgdXNlZCB0byBhY2Nlc3MgdGhlIHVzZXIncyBlbWFpbCBhY2NvdW50LiBUaGVcbiAqIGVtYWlsIGFkZHJlc3Mgc2VydmVzIGFzIGEgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSB1c2VyLCBhbmQgdGhlIHBhc3N3b3JkIGlzIHVzZWQgdG8gYWNjZXNzXG4gKiB0aGUgdXNlcidzIGFjY291bnQgaW4geW91ciBGaXJlYmFzZSBwcm9qZWN0LiBTZWUgYWxzbzoge0BsaW5rIGNyZWF0ZVVzZXJXaXRoRW1haWxBbmRQYXNzd29yZH0uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXJzIGVtYWlsIGFkZHJlc3MuXG4gKiBAcGFyYW0gcGFzc3dvcmQgLSBUaGUgdXNlcnMgcGFzc3dvcmQuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQoXG4gIGF1dGg6IEF1dGgsXG4gIGVtYWlsOiBzdHJpbmcsXG4gIHBhc3N3b3JkOiBzdHJpbmdcbik6IFByb21pc2U8VXNlckNyZWRlbnRpYWw+IHtcbiAgcmV0dXJuIHNpZ25JbldpdGhDcmVkZW50aWFsKFxuICAgIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSxcbiAgICBFbWFpbEF1dGhQcm92aWRlci5jcmVkZW50aWFsKGVtYWlsLCBwYXNzd29yZClcbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBBY3Rpb25Db2RlT3BlcmF0aW9uLFxuICBBY3Rpb25Db2RlU2V0dGluZ3MsXG4gIEF1dGgsXG4gIFVzZXJDcmVkZW50aWFsXG59IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCAqIGFzIGFwaSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vZW1haWxfYW5kX3Bhc3N3b3JkJztcbmltcG9ydCB7IEFjdGlvbkNvZGVVUkwgfSBmcm9tICcuLi9hY3Rpb25fY29kZV91cmwnO1xuaW1wb3J0IHsgRW1haWxBdXRoUHJvdmlkZXIgfSBmcm9tICcuLi9wcm92aWRlcnMvZW1haWwnO1xuaW1wb3J0IHsgX2dldEN1cnJlbnRVcmwgfSBmcm9tICcuLi91dGlsL2xvY2F0aW9uJztcbmltcG9ydCB7IF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QgfSBmcm9tICcuL2FjdGlvbl9jb2RlX3NldHRpbmdzJztcbmltcG9ydCB7IHNpZ25JbldpdGhDcmVkZW50aWFsIH0gZnJvbSAnLi9jcmVkZW50aWFsJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9lcnJvcnMnO1xuaW1wb3J0IHsgX2Fzc2VydCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IGdldE1vZHVsYXJJbnN0YW5jZSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IF9jYXN0QXV0aCB9IGZyb20gJy4uL2F1dGgvYXV0aF9pbXBsJztcbmltcG9ydCB7IGluamVjdFJlY2FwdGNoYUZpZWxkcyB9IGZyb20gJy4uLy4uL3BsYXRmb3JtX2Jyb3dzZXIvcmVjYXB0Y2hhL3JlY2FwdGNoYV9lbnRlcnByaXNlX3ZlcmlmaWVyJztcbmltcG9ydCB7IFJlY2FwdGNoYUFjdGlvbk5hbWUsIFJlY2FwdGNoYUNsaWVudFR5cGUgfSBmcm9tICcuLi8uLi9hcGknO1xuXG4vKipcbiAqIFNlbmRzIGEgc2lnbi1pbiBlbWFpbCBsaW5rIHRvIHRoZSB1c2VyIHdpdGggdGhlIHNwZWNpZmllZCBlbWFpbC5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhlIHNpZ24taW4gb3BlcmF0aW9uIGhhcyB0byBhbHdheXMgYmUgY29tcGxldGVkIGluIHRoZSBhcHAgdW5saWtlIG90aGVyIG91dCBvZiBiYW5kIGVtYWlsXG4gKiBhY3Rpb25zIChwYXNzd29yZCByZXNldCBhbmQgZW1haWwgdmVyaWZpY2F0aW9ucykuIFRoaXMgaXMgYmVjYXVzZSwgYXQgdGhlIGVuZCBvZiB0aGUgZmxvdyxcbiAqIHRoZSB1c2VyIGlzIGV4cGVjdGVkIHRvIGJlIHNpZ25lZCBpbiBhbmQgdGhlaXIgQXV0aCBzdGF0ZSBwZXJzaXN0ZWQgd2l0aGluIHRoZSBhcHAuXG4gKlxuICogVG8gY29tcGxldGUgc2lnbiBpbiB3aXRoIHRoZSBlbWFpbCBsaW5rLCBjYWxsIHtAbGluayBzaWduSW5XaXRoRW1haWxMaW5rfSB3aXRoIHRoZSBlbWFpbFxuICogYWRkcmVzcyBhbmQgdGhlIGVtYWlsIGxpbmsgc3VwcGxpZWQgaW4gdGhlIGVtYWlsIHNlbnQgdG8gdGhlIHVzZXIuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxuICogICBpT1M6IHtcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXG4gKiAgIH0sXG4gKiAgIGFuZHJvaWQ6IHtcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcbiAqICAgfSxcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXG4gKiB9O1xuICogYXdhaXQgc2VuZFNpZ25JbkxpbmtUb0VtYWlsKGF1dGgsICd1c2VyQGV4YW1wbGUuY29tJywgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAqIC8vIE9idGFpbiBlbWFpbExpbmsgZnJvbSB0aGUgdXNlci5cbiAqIGlmKGlzU2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbExpbmspKSB7XG4gKiAgIGF3YWl0IHNpZ25JbldpdGhFbWFpbExpbmsoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBlbWFpbExpbmspO1xuICogfVxuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGhJbnRlcm5hbCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gZW1haWwgLSBUaGUgdXNlcidzIGVtYWlsIGFkZHJlc3MuXG4gKiBAcGFyYW0gYWN0aW9uQ29kZVNldHRpbmdzIC0gVGhlIHtAbGluayBBY3Rpb25Db2RlU2V0dGluZ3N9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNlbmRTaWduSW5MaW5rVG9FbWFpbChcbiAgYXV0aDogQXV0aCxcbiAgZW1haWw6IHN0cmluZyxcbiAgYWN0aW9uQ29kZVNldHRpbmdzOiBBY3Rpb25Db2RlU2V0dGluZ3Ncbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBhdXRoSW50ZXJuYWwgPSBfY2FzdEF1dGgoYXV0aCk7XG4gIGNvbnN0IHJlcXVlc3Q6IGFwaS5FbWFpbFNpZ25JblJlcXVlc3QgPSB7XG4gICAgcmVxdWVzdFR5cGU6IEFjdGlvbkNvZGVPcGVyYXRpb24uRU1BSUxfU0lHTklOLFxuICAgIGVtYWlsLFxuICAgIGNsaWVudFR5cGU6IFJlY2FwdGNoYUNsaWVudFR5cGUuV0VCXG4gIH07XG4gIGZ1bmN0aW9uIHNldEFjdGlvbkNvZGVTZXR0aW5ncyhcbiAgICByZXF1ZXN0OiBhcGkuRW1haWxTaWduSW5SZXF1ZXN0LFxuICAgIGFjdGlvbkNvZGVTZXR0aW5nczogQWN0aW9uQ29kZVNldHRpbmdzXG4gICk6IHZvaWQge1xuICAgIF9hc3NlcnQoXG4gICAgICBhY3Rpb25Db2RlU2V0dGluZ3MuaGFuZGxlQ29kZUluQXBwLFxuICAgICAgYXV0aEludGVybmFsLFxuICAgICAgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUlxuICAgICk7XG4gICAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgICAgX3NldEFjdGlvbkNvZGVTZXR0aW5nc09uUmVxdWVzdChcbiAgICAgICAgYXV0aEludGVybmFsLFxuICAgICAgICByZXF1ZXN0LFxuICAgICAgICBhY3Rpb25Db2RlU2V0dGluZ3NcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIGlmIChhdXRoSW50ZXJuYWwuX2dldFJlY2FwdGNoYUNvbmZpZygpPy5lbWFpbFBhc3N3b3JkRW5hYmxlZCkge1xuICAgIGNvbnN0IHJlcXVlc3RXaXRoUmVjYXB0Y2hhID0gYXdhaXQgaW5qZWN0UmVjYXB0Y2hhRmllbGRzKFxuICAgICAgYXV0aEludGVybmFsLFxuICAgICAgcmVxdWVzdCxcbiAgICAgIFJlY2FwdGNoYUFjdGlvbk5hbWUuR0VUX09PQl9DT0RFLFxuICAgICAgdHJ1ZVxuICAgICk7XG4gICAgc2V0QWN0aW9uQ29kZVNldHRpbmdzKHJlcXVlc3RXaXRoUmVjYXB0Y2hhLCBhY3Rpb25Db2RlU2V0dGluZ3MpO1xuICAgIGF3YWl0IGFwaS5zZW5kU2lnbkluTGlua1RvRW1haWwoYXV0aEludGVybmFsLCByZXF1ZXN0V2l0aFJlY2FwdGNoYSk7XG4gIH0gZWxzZSB7XG4gICAgc2V0QWN0aW9uQ29kZVNldHRpbmdzKHJlcXVlc3QsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gICAgYXdhaXQgYXBpXG4gICAgICAuc2VuZFNpZ25JbkxpbmtUb0VtYWlsKGF1dGhJbnRlcm5hbCwgcmVxdWVzdClcbiAgICAgIC5jYXRjaChhc3luYyBlcnJvciA9PiB7XG4gICAgICAgIGlmIChlcnJvci5jb2RlID09PSBgYXV0aC8ke0F1dGhFcnJvckNvZGUuTUlTU0lOR19SRUNBUFRDSEFfVE9LRU59YCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgJ0VtYWlsIGxpbmsgc2lnbi1pbiBpcyBwcm90ZWN0ZWQgYnkgcmVDQVBUQ0hBIGZvciB0aGlzIHByb2plY3QuIEF1dG9tYXRpY2FsbHkgdHJpZ2dlcmluZyB0aGUgcmVDQVBUQ0hBIGZsb3cgYW5kIHJlc3RhcnRpbmcgdGhlIHNpZ24taW4gZmxvdy4nXG4gICAgICAgICAgKTtcbiAgICAgICAgICBjb25zdCByZXF1ZXN0V2l0aFJlY2FwdGNoYSA9IGF3YWl0IGluamVjdFJlY2FwdGNoYUZpZWxkcyhcbiAgICAgICAgICAgIGF1dGhJbnRlcm5hbCxcbiAgICAgICAgICAgIHJlcXVlc3QsXG4gICAgICAgICAgICBSZWNhcHRjaGFBY3Rpb25OYW1lLkdFVF9PT0JfQ09ERSxcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgICApO1xuICAgICAgICAgIHNldEFjdGlvbkNvZGVTZXR0aW5ncyhyZXF1ZXN0V2l0aFJlY2FwdGNoYSwgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAgICAgICAgICBhd2FpdCBhcGkuc2VuZFNpZ25JbkxpbmtUb0VtYWlsKGF1dGhJbnRlcm5hbCwgcmVxdWVzdFdpdGhSZWNhcHRjaGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGFuIGluY29taW5nIGxpbmsgaXMgYSBzaWduLWluIHdpdGggZW1haWwgbGluayBzdWl0YWJsZSBmb3Ige0BsaW5rIHNpZ25JbldpdGhFbWFpbExpbmt9LlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBlbWFpbExpbmsgLSBUaGUgbGluayBzZW50IHRvIHRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc1NpZ25JbldpdGhFbWFpbExpbmsoYXV0aDogQXV0aCwgZW1haWxMaW5rOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3QgYWN0aW9uQ29kZVVybCA9IEFjdGlvbkNvZGVVUkwucGFyc2VMaW5rKGVtYWlsTGluayk7XG4gIHJldHVybiBhY3Rpb25Db2RlVXJsPy5vcGVyYXRpb24gPT09IEFjdGlvbkNvZGVPcGVyYXRpb24uRU1BSUxfU0lHTklOO1xufVxuXG4vKipcbiAqIEFzeW5jaHJvbm91c2x5IHNpZ25zIGluIHVzaW5nIGFuIGVtYWlsIGFuZCBzaWduLWluIGVtYWlsIGxpbmsuXG4gKlxuICogQHJlbWFya3NcbiAqIElmIG5vIGxpbmsgaXMgcGFzc2VkLCB0aGUgbGluayBpcyBpbmZlcnJlZCBmcm9tIHRoZSBjdXJyZW50IFVSTC5cbiAqXG4gKiBGYWlscyB3aXRoIGFuIGVycm9yIGlmIHRoZSBlbWFpbCBhZGRyZXNzIGlzIGludmFsaWQgb3IgT1RQIGluIGVtYWlsIGxpbmsgZXhwaXJlcy5cbiAqXG4gKiBOb3RlOiBDb25maXJtIHRoZSBsaW5rIGlzIGEgc2lnbi1pbiBlbWFpbCBsaW5rIGJlZm9yZSBjYWxsaW5nIHRoaXMgbWV0aG9kIGZpcmViYXNlLmF1dGguQXV0aC5pc1NpZ25JbldpdGhFbWFpbExpbmsuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxuICogICBpT1M6IHtcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXG4gKiAgIH0sXG4gKiAgIGFuZHJvaWQ6IHtcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcbiAqICAgfSxcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXG4gKiB9O1xuICogYXdhaXQgc2VuZFNpZ25JbkxpbmtUb0VtYWlsKGF1dGgsICd1c2VyQGV4YW1wbGUuY29tJywgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAqIC8vIE9idGFpbiBlbWFpbExpbmsgZnJvbSB0aGUgdXNlci5cbiAqIGlmKGlzU2lnbkluV2l0aEVtYWlsTGluayhhdXRoLCBlbWFpbExpbmspKSB7XG4gKiAgIGF3YWl0IHNpZ25JbldpdGhFbWFpbExpbmsoYXV0aCwgJ3VzZXJAZXhhbXBsZS5jb20nLCBlbWFpbExpbmspO1xuICogfVxuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxuICogQHBhcmFtIGVtYWlsTGluayAtIFRoZSBsaW5rIHNlbnQgdG8gdGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhFbWFpbExpbmsoXG4gIGF1dGg6IEF1dGgsXG4gIGVtYWlsOiBzdHJpbmcsXG4gIGVtYWlsTGluaz86IHN0cmluZ1xuKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD4ge1xuICBjb25zdCBhdXRoTW9kdWxhciA9IGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKTtcbiAgY29uc3QgY3JlZGVudGlhbCA9IEVtYWlsQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxXaXRoTGluayhcbiAgICBlbWFpbCxcbiAgICBlbWFpbExpbmsgfHwgX2dldEN1cnJlbnRVcmwoKVxuICApO1xuICAvLyBDaGVjayBpZiB0aGUgdGVuYW50IElEIGluIHRoZSBlbWFpbCBsaW5rIG1hdGNoZXMgdGhlIHRlbmFudCBJRCBvbiBBdXRoXG4gIC8vIGluc3RhbmNlLlxuICBfYXNzZXJ0KFxuICAgIGNyZWRlbnRpYWwuX3RlbmFudElkID09PSAoYXV0aE1vZHVsYXIudGVuYW50SWQgfHwgbnVsbCksXG4gICAgYXV0aE1vZHVsYXIsXG4gICAgQXV0aEVycm9yQ29kZS5URU5BTlRfSURfTUlTTUFUQ0hcbiAgKTtcbiAgcmV0dXJuIHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGhNb2R1bGFyLCBjcmVkZW50aWFsKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBFbmRwb2ludCxcbiAgSHR0cE1ldGhvZCxcbiAgX2FkZFRpZElmTmVjZXNzYXJ5LFxuICBfcGVyZm9ybUFwaVJlcXVlc3Rcbn0gZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IHsgQXV0aCB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlQXV0aFVyaVJlcXVlc3Qge1xuICBpZGVudGlmaWVyOiBzdHJpbmc7XG4gIGNvbnRpbnVlVXJpOiBzdHJpbmc7XG4gIHRlbmFudElkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENyZWF0ZUF1dGhVcmlSZXNwb25zZSB7XG4gIHNpZ25pbk1ldGhvZHM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXV0aFVyaShcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogQ3JlYXRlQXV0aFVyaVJlcXVlc3Rcbik6IFByb21pc2U8Q3JlYXRlQXV0aFVyaVJlc3BvbnNlPiB7XG4gIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3Q8Q3JlYXRlQXV0aFVyaVJlcXVlc3QsIENyZWF0ZUF1dGhVcmlSZXNwb25zZT4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuQ1JFQVRFX0FVVEhfVVJJLFxuICAgIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KVxuICApO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEFjdGlvbkNvZGVPcGVyYXRpb24sXG4gIEFjdGlvbkNvZGVTZXR0aW5ncyxcbiAgQXV0aCxcbiAgVXNlclxufSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5pbXBvcnQge1xuICBjcmVhdGVBdXRoVXJpLFxuICBDcmVhdGVBdXRoVXJpUmVxdWVzdFxufSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vY3JlYXRlX2F1dGhfdXJpJztcbmltcG9ydCAqIGFzIGFwaSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vZW1haWxfYW5kX3Bhc3N3b3JkJztcbmltcG9ydCB7IFVzZXJJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgX2dldEN1cnJlbnRVcmwsIF9pc0h0dHBPckh0dHBzIH0gZnJvbSAnLi4vdXRpbC9sb2NhdGlvbic7XG5pbXBvcnQgeyBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0IH0gZnJvbSAnLi9hY3Rpb25fY29kZV9zZXR0aW5ncyc7XG5pbXBvcnQgeyBnZXRNb2R1bGFySW5zdGFuY2UgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbi8qKlxuICogR2V0cyB0aGUgbGlzdCBvZiBwb3NzaWJsZSBzaWduIGluIG1ldGhvZHMgZm9yIHRoZSBnaXZlbiBlbWFpbCBhZGRyZXNzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBkaWZmZXJlbnRpYXRlIG1ldGhvZHMgb2Ygc2lnbi1pbiBmb3IgdGhlIHNhbWUgcHJvdmlkZXIsIGVnLlxuICoge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aGljaCBoYXMgMiBtZXRob2RzIG9mIHNpZ24taW4sXG4gKiB7QGxpbmsgU2lnbkluTWV0aG9kfS5FTUFJTF9QQVNTV09SRCBhbmRcbiAqIHtAbGluayBTaWduSW5NZXRob2R9LkVNQUlMX0xJTksuXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIGVtYWlsIC0gVGhlIHVzZXIncyBlbWFpbCBhZGRyZXNzLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoU2lnbkluTWV0aG9kc0ZvckVtYWlsKFxuICBhdXRoOiBBdXRoLFxuICBlbWFpbDogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gIC8vIGNyZWF0ZUF1dGhVcmkgcmV0dXJucyBhbiBlcnJvciBpZiBjb250aW51ZSBVUkkgaXMgbm90IGh0dHAgb3IgaHR0cHMuXG4gIC8vIEZvciBlbnZpcm9ubWVudHMgbGlrZSBDb3Jkb3ZhLCBDaHJvbWUgZXh0ZW5zaW9ucywgbmF0aXZlIGZyYW1ld29ya3MsIGZpbGVcbiAgLy8gc3lzdGVtcywgZXRjLCB1c2UgaHR0cDovL2xvY2FsaG9zdCBhcyBjb250aW51ZSBVUkwuXG4gIGNvbnN0IGNvbnRpbnVlVXJpID0gX2lzSHR0cE9ySHR0cHMoKSA/IF9nZXRDdXJyZW50VXJsKCkgOiAnaHR0cDovL2xvY2FsaG9zdCc7XG4gIGNvbnN0IHJlcXVlc3Q6IENyZWF0ZUF1dGhVcmlSZXF1ZXN0ID0ge1xuICAgIGlkZW50aWZpZXI6IGVtYWlsLFxuICAgIGNvbnRpbnVlVXJpXG4gIH07XG5cbiAgY29uc3QgeyBzaWduaW5NZXRob2RzIH0gPSBhd2FpdCBjcmVhdGVBdXRoVXJpKFxuICAgIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKSxcbiAgICByZXF1ZXN0XG4gICk7XG5cbiAgcmV0dXJuIHNpZ25pbk1ldGhvZHMgfHwgW107XG59XG5cbi8qKlxuICogU2VuZHMgYSB2ZXJpZmljYXRpb24gZW1haWwgdG8gYSB1c2VyLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGUgdmVyaWZpY2F0aW9uIHByb2Nlc3MgaXMgY29tcGxldGVkIGJ5IGNhbGxpbmcge0BsaW5rIGFwcGx5QWN0aW9uQ29kZX0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxuICogICBpT1M6IHtcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXG4gKiAgIH0sXG4gKiAgIGFuZHJvaWQ6IHtcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcbiAqICAgfSxcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXG4gKiB9O1xuICogYXdhaXQgc2VuZEVtYWlsVmVyaWZpY2F0aW9uKHVzZXIsIGFjdGlvbkNvZGVTZXR0aW5ncyk7XG4gKiAvLyBPYnRhaW4gY29kZSBmcm9tIHRoZSB1c2VyLlxuICogYXdhaXQgYXBwbHlBY3Rpb25Db2RlKGF1dGgsIGNvZGUpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBhY3Rpb25Db2RlU2V0dGluZ3MgLSBUaGUge0BsaW5rIEFjdGlvbkNvZGVTZXR0aW5nc30uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VuZEVtYWlsVmVyaWZpY2F0aW9uKFxuICB1c2VyOiBVc2VyLFxuICBhY3Rpb25Db2RlU2V0dGluZ3M/OiBBY3Rpb25Db2RlU2V0dGluZ3MgfCBudWxsXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpIGFzIFVzZXJJbnRlcm5hbDtcbiAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpO1xuICBjb25zdCByZXF1ZXN0OiBhcGkuVmVyaWZ5RW1haWxSZXF1ZXN0ID0ge1xuICAgIHJlcXVlc3RUeXBlOiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9FTUFJTCxcbiAgICBpZFRva2VuXG4gIH07XG4gIGlmIChhY3Rpb25Db2RlU2V0dGluZ3MpIHtcbiAgICBfc2V0QWN0aW9uQ29kZVNldHRpbmdzT25SZXF1ZXN0KFxuICAgICAgdXNlckludGVybmFsLmF1dGgsXG4gICAgICByZXF1ZXN0LFxuICAgICAgYWN0aW9uQ29kZVNldHRpbmdzXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IHsgZW1haWwgfSA9IGF3YWl0IGFwaS5zZW5kRW1haWxWZXJpZmljYXRpb24odXNlckludGVybmFsLmF1dGgsIHJlcXVlc3QpO1xuXG4gIGlmIChlbWFpbCAhPT0gdXNlci5lbWFpbCkge1xuICAgIGF3YWl0IHVzZXIucmVsb2FkKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBTZW5kcyBhIHZlcmlmaWNhdGlvbiBlbWFpbCB0byBhIG5ldyBlbWFpbCBhZGRyZXNzLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGUgdXNlcidzIGVtYWlsIHdpbGwgYmUgdXBkYXRlZCB0byB0aGUgbmV3IG9uZSBhZnRlciBiZWluZyB2ZXJpZmllZC5cbiAqXG4gKiBJZiB5b3UgaGF2ZSBhIGN1c3RvbSBlbWFpbCBhY3Rpb24gaGFuZGxlciwgeW91IGNhbiBjb21wbGV0ZSB0aGUgdmVyaWZpY2F0aW9uIHByb2Nlc3MgYnkgY2FsbGluZ1xuICoge0BsaW5rIGFwcGx5QWN0aW9uQ29kZX0uXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGNvbnN0IGFjdGlvbkNvZGVTZXR0aW5ncyA9IHtcbiAqICAgdXJsOiAnaHR0cHM6Ly93d3cuZXhhbXBsZS5jb20vP2VtYWlsPXVzZXJAZXhhbXBsZS5jb20nLFxuICogICBpT1M6IHtcbiAqICAgICAgYnVuZGxlSWQ6ICdjb20uZXhhbXBsZS5pb3MnXG4gKiAgIH0sXG4gKiAgIGFuZHJvaWQ6IHtcbiAqICAgICBwYWNrYWdlTmFtZTogJ2NvbS5leGFtcGxlLmFuZHJvaWQnLFxuICogICAgIGluc3RhbGxBcHA6IHRydWUsXG4gKiAgICAgbWluaW11bVZlcnNpb246ICcxMidcbiAqICAgfSxcbiAqICAgaGFuZGxlQ29kZUluQXBwOiB0cnVlXG4gKiB9O1xuICogYXdhaXQgdmVyaWZ5QmVmb3JlVXBkYXRlRW1haWwodXNlciwgJ25ld2VtYWlsQGV4YW1wbGUuY29tJywgYWN0aW9uQ29kZVNldHRpbmdzKTtcbiAqIC8vIE9idGFpbiBjb2RlIGZyb20gdGhlIHVzZXIuXG4gKiBhd2FpdCBhcHBseUFjdGlvbkNvZGUoYXV0aCwgY29kZSk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIG5ld0VtYWlsIC0gVGhlIG5ldyBlbWFpbCBhZGRyZXNzIHRvIGJlIHZlcmlmaWVkIGJlZm9yZSB1cGRhdGUuXG4gKiBAcGFyYW0gYWN0aW9uQ29kZVNldHRpbmdzIC0gVGhlIHtAbGluayBBY3Rpb25Db2RlU2V0dGluZ3N9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUJlZm9yZVVwZGF0ZUVtYWlsKFxuICB1c2VyOiBVc2VyLFxuICBuZXdFbWFpbDogc3RyaW5nLFxuICBhY3Rpb25Db2RlU2V0dGluZ3M/OiBBY3Rpb25Db2RlU2V0dGluZ3MgfCBudWxsXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpIGFzIFVzZXJJbnRlcm5hbDtcbiAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpO1xuICBjb25zdCByZXF1ZXN0OiBhcGkuVmVyaWZ5QW5kQ2hhbmdlRW1haWxSZXF1ZXN0ID0ge1xuICAgIHJlcXVlc3RUeXBlOiBBY3Rpb25Db2RlT3BlcmF0aW9uLlZFUklGWV9BTkRfQ0hBTkdFX0VNQUlMLFxuICAgIGlkVG9rZW4sXG4gICAgbmV3RW1haWxcbiAgfTtcbiAgaWYgKGFjdGlvbkNvZGVTZXR0aW5ncykge1xuICAgIF9zZXRBY3Rpb25Db2RlU2V0dGluZ3NPblJlcXVlc3QoXG4gICAgICB1c2VySW50ZXJuYWwuYXV0aCxcbiAgICAgIHJlcXVlc3QsXG4gICAgICBhY3Rpb25Db2RlU2V0dGluZ3NcbiAgICApO1xuICB9XG5cbiAgY29uc3QgeyBlbWFpbCB9ID0gYXdhaXQgYXBpLnZlcmlmeUFuZENoYW5nZUVtYWlsKHVzZXJJbnRlcm5hbC5hdXRoLCByZXF1ZXN0KTtcblxuICBpZiAoZW1haWwgIT09IHVzZXIuZW1haWwpIHtcbiAgICAvLyBJZiB0aGUgbG9jYWwgY29weSBvZiB0aGUgZW1haWwgb24gdXNlciBpcyBvdXRkYXRlZCwgcmVsb2FkIHRoZVxuICAgIC8vIHVzZXIuXG4gICAgYXdhaXQgdXNlci5yZWxvYWQoKTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEVuZHBvaW50LCBIdHRwTWV0aG9kLCBfcGVyZm9ybUFwaVJlcXVlc3QgfSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgeyBJZFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9tb2RlbC9pZF90b2tlbic7XG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBVcGRhdGVQcm9maWxlUmVxdWVzdCB7XG4gIGlkVG9rZW46IHN0cmluZztcbiAgZGlzcGxheU5hbWU/OiBzdHJpbmcgfCBudWxsO1xuICBwaG90b1VybD86IHN0cmluZyB8IG51bGw7XG4gIHJldHVyblNlY3VyZVRva2VuOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZGF0ZVByb2ZpbGVSZXNwb25zZSBleHRlbmRzIElkVG9rZW5SZXNwb25zZSB7XG4gIGRpc3BsYXlOYW1lPzogc3RyaW5nIHwgbnVsbDtcbiAgcGhvdG9Vcmw/OiBzdHJpbmcgfCBudWxsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHJvZmlsZShcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogVXBkYXRlUHJvZmlsZVJlcXVlc3Rcbik6IFByb21pc2U8VXBkYXRlUHJvZmlsZVJlc3BvbnNlPiB7XG4gIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3Q8VXBkYXRlUHJvZmlsZVJlcXVlc3QsIFVwZGF0ZVByb2ZpbGVSZXNwb25zZT4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuU0VUX0FDQ09VTlRfSU5GTyxcbiAgICByZXF1ZXN0XG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCB7XG4gIHVwZGF0ZUVtYWlsUGFzc3dvcmQgYXMgYXBpVXBkYXRlRW1haWxQYXNzd29yZCxcbiAgVXBkYXRlRW1haWxQYXNzd29yZFJlcXVlc3Rcbn0gZnJvbSAnLi4vLi4vYXBpL2FjY291bnRfbWFuYWdlbWVudC9lbWFpbF9hbmRfcGFzc3dvcmQnO1xuaW1wb3J0IHsgdXBkYXRlUHJvZmlsZSBhcyBhcGlVcGRhdGVQcm9maWxlIH0gZnJvbSAnLi4vLi4vYXBpL2FjY291bnRfbWFuYWdlbWVudC9wcm9maWxlJztcbmltcG9ydCB7IFVzZXJJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgX2xvZ291dElmSW52YWxpZGF0ZWQgfSBmcm9tICcuL2ludmFsaWRhdGlvbic7XG5pbXBvcnQgeyBnZXRNb2R1bGFySW5zdGFuY2UgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBQcm92aWRlcklkIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG4vKipcbiAqIFVwZGF0ZXMgYSB1c2VyJ3MgcHJvZmlsZSBkYXRhLlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvZmlsZSAtIFRoZSBwcm9maWxlJ3MgYGRpc3BsYXlOYW1lYCBhbmQgYHBob3RvVVJMYCB0byB1cGRhdGUuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlUHJvZmlsZShcbiAgdXNlcjogVXNlcixcbiAge1xuICAgIGRpc3BsYXlOYW1lLFxuICAgIHBob3RvVVJMOiBwaG90b1VybFxuICB9OiB7IGRpc3BsYXlOYW1lPzogc3RyaW5nIHwgbnVsbDsgcGhvdG9VUkw/OiBzdHJpbmcgfCBudWxsIH1cbik6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoZGlzcGxheU5hbWUgPT09IHVuZGVmaW5lZCAmJiBwaG90b1VybCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpIGFzIFVzZXJJbnRlcm5hbDtcbiAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXJJbnRlcm5hbC5nZXRJZFRva2VuKCk7XG4gIGNvbnN0IHByb2ZpbGVSZXF1ZXN0ID0ge1xuICAgIGlkVG9rZW4sXG4gICAgZGlzcGxheU5hbWUsXG4gICAgcGhvdG9VcmwsXG4gICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWVcbiAgfTtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZChcbiAgICB1c2VySW50ZXJuYWwsXG4gICAgYXBpVXBkYXRlUHJvZmlsZSh1c2VySW50ZXJuYWwuYXV0aCwgcHJvZmlsZVJlcXVlc3QpXG4gICk7XG5cbiAgdXNlckludGVybmFsLmRpc3BsYXlOYW1lID0gcmVzcG9uc2UuZGlzcGxheU5hbWUgfHwgbnVsbDtcbiAgdXNlckludGVybmFsLnBob3RvVVJMID0gcmVzcG9uc2UucGhvdG9VcmwgfHwgbnVsbDtcblxuICAvLyBVcGRhdGUgdGhlIHBhc3N3b3JkIHByb3ZpZGVyIGFzIHdlbGxcbiAgY29uc3QgcGFzc3dvcmRQcm92aWRlciA9IHVzZXJJbnRlcm5hbC5wcm92aWRlckRhdGEuZmluZChcbiAgICAoeyBwcm92aWRlcklkIH0pID0+IHByb3ZpZGVySWQgPT09IFByb3ZpZGVySWQuUEFTU1dPUkRcbiAgKTtcbiAgaWYgKHBhc3N3b3JkUHJvdmlkZXIpIHtcbiAgICBwYXNzd29yZFByb3ZpZGVyLmRpc3BsYXlOYW1lID0gdXNlckludGVybmFsLmRpc3BsYXlOYW1lO1xuICAgIHBhc3N3b3JkUHJvdmlkZXIucGhvdG9VUkwgPSB1c2VySW50ZXJuYWwucGhvdG9VUkw7XG4gIH1cblxuICBhd2FpdCB1c2VySW50ZXJuYWwuX3VwZGF0ZVRva2Vuc0lmTmVjZXNzYXJ5KHJlc3BvbnNlKTtcbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSB1c2VyJ3MgZW1haWwgYWRkcmVzcy5cbiAqXG4gKiBAcmVtYXJrc1xuICogQW4gZW1haWwgd2lsbCBiZSBzZW50IHRvIHRoZSBvcmlnaW5hbCBlbWFpbCBhZGRyZXNzIChpZiBpdCB3YXMgc2V0KSB0aGF0IGFsbG93cyB0byByZXZva2UgdGhlXG4gKiBlbWFpbCBhZGRyZXNzIGNoYW5nZSwgaW4gb3JkZXIgdG8gcHJvdGVjdCB0aGVtIGZyb20gYWNjb3VudCBoaWphY2tpbmcuXG4gKlxuICogSW1wb3J0YW50OiB0aGlzIGlzIGEgc2VjdXJpdHkgc2Vuc2l0aXZlIG9wZXJhdGlvbiB0aGF0IHJlcXVpcmVzIHRoZSB1c2VyIHRvIGhhdmUgcmVjZW50bHkgc2lnbmVkXG4gKiBpbi4gSWYgdGhpcyByZXF1aXJlbWVudCBpc24ndCBtZXQsIGFzayB0aGUgdXNlciB0byBhdXRoZW50aWNhdGUgYWdhaW4gYW5kIHRoZW4gY2FsbFxuICoge0BsaW5rIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWx9LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gbmV3RW1haWwgLSBUaGUgbmV3IGVtYWlsIGFkZHJlc3MuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlRW1haWwodXNlcjogVXNlciwgbmV3RW1haWw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICByZXR1cm4gdXBkYXRlRW1haWxPclBhc3N3b3JkKFxuICAgIGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSBhcyBVc2VySW50ZXJuYWwsXG4gICAgbmV3RW1haWwsXG4gICAgbnVsbFxuICApO1xufVxuXG4vKipcbiAqIFVwZGF0ZXMgdGhlIHVzZXIncyBwYXNzd29yZC5cbiAqXG4gKiBAcmVtYXJrc1xuICogSW1wb3J0YW50OiB0aGlzIGlzIGEgc2VjdXJpdHkgc2Vuc2l0aXZlIG9wZXJhdGlvbiB0aGF0IHJlcXVpcmVzIHRoZSB1c2VyIHRvIGhhdmUgcmVjZW50bHkgc2lnbmVkXG4gKiBpbi4gSWYgdGhpcyByZXF1aXJlbWVudCBpc24ndCBtZXQsIGFzayB0aGUgdXNlciB0byBhdXRoZW50aWNhdGUgYWdhaW4gYW5kIHRoZW4gY2FsbFxuICoge0BsaW5rIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWx9LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gbmV3UGFzc3dvcmQgLSBUaGUgbmV3IHBhc3N3b3JkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVBhc3N3b3JkKHVzZXI6IFVzZXIsIG5ld1Bhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgcmV0dXJuIHVwZGF0ZUVtYWlsT3JQYXNzd29yZChcbiAgICBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikgYXMgVXNlckludGVybmFsLFxuICAgIG51bGwsXG4gICAgbmV3UGFzc3dvcmRcbiAgKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gdXBkYXRlRW1haWxPclBhc3N3b3JkKFxuICB1c2VyOiBVc2VySW50ZXJuYWwsXG4gIGVtYWlsOiBzdHJpbmcgfCBudWxsLFxuICBwYXNzd29yZDogc3RyaW5nIHwgbnVsbFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgYXV0aCB9ID0gdXNlcjtcbiAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHVzZXIuZ2V0SWRUb2tlbigpO1xuICBjb25zdCByZXF1ZXN0OiBVcGRhdGVFbWFpbFBhc3N3b3JkUmVxdWVzdCA9IHtcbiAgICBpZFRva2VuLFxuICAgIHJldHVyblNlY3VyZVRva2VuOiB0cnVlXG4gIH07XG5cbiAgaWYgKGVtYWlsKSB7XG4gICAgcmVxdWVzdC5lbWFpbCA9IGVtYWlsO1xuICB9XG5cbiAgaWYgKHBhc3N3b3JkKSB7XG4gICAgcmVxdWVzdC5wYXNzd29yZCA9IHBhc3N3b3JkO1xuICB9XG5cbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBfbG9nb3V0SWZJbnZhbGlkYXRlZChcbiAgICB1c2VyLFxuICAgIGFwaVVwZGF0ZUVtYWlsUGFzc3dvcmQoYXV0aCwgcmVxdWVzdClcbiAgKTtcbiAgYXdhaXQgdXNlci5fdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkocmVzcG9uc2UsIC8qIHJlbG9hZCAqLyB0cnVlKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBZGRpdGlvbmFsVXNlckluZm8sIFVzZXJDcmVkZW50aWFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IElkVG9rZW5SZXNwb25zZSwgSWRUb2tlblJlc3BvbnNlS2luZCB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IF9wYXJzZVRva2VuIH0gZnJvbSAnLi9pZF90b2tlbl9yZXN1bHQnO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgUHJvdmlkZXJJZCB9IGZyb20gJy4uLy4uL21vZGVsL2VudW1zJztcblxuLyoqXG4gKiBQYXJzZSB0aGUgYEFkZGl0aW9uYWxVc2VySW5mb2AgZnJvbSB0aGUgSUQgdG9rZW4gcmVzcG9uc2UuXG4gKlxuICovXG5leHBvcnQgZnVuY3Rpb24gX2Zyb21JZFRva2VuUmVzcG9uc2UoXG4gIGlkVG9rZW5SZXNwb25zZT86IElkVG9rZW5SZXNwb25zZVxuKTogQWRkaXRpb25hbFVzZXJJbmZvIHwgbnVsbCB7XG4gIGlmICghaWRUb2tlblJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgeyBwcm92aWRlcklkIH0gPSBpZFRva2VuUmVzcG9uc2U7XG4gIGNvbnN0IHByb2ZpbGUgPSBpZFRva2VuUmVzcG9uc2UucmF3VXNlckluZm9cbiAgICA/IEpTT04ucGFyc2UoaWRUb2tlblJlc3BvbnNlLnJhd1VzZXJJbmZvKVxuICAgIDoge307XG4gIGNvbnN0IGlzTmV3VXNlciA9XG4gICAgaWRUb2tlblJlc3BvbnNlLmlzTmV3VXNlciB8fFxuICAgIGlkVG9rZW5SZXNwb25zZS5raW5kID09PSBJZFRva2VuUmVzcG9uc2VLaW5kLlNpZ251cE5ld1VzZXI7XG4gIGlmICghcHJvdmlkZXJJZCAmJiBpZFRva2VuUmVzcG9uc2U/LmlkVG9rZW4pIHtcbiAgICBjb25zdCBzaWduSW5Qcm92aWRlciA9IF9wYXJzZVRva2VuKGlkVG9rZW5SZXNwb25zZS5pZFRva2VuKT8uZmlyZWJhc2U/LltcbiAgICAgICdzaWduX2luX3Byb3ZpZGVyJ1xuICAgIF07XG4gICAgaWYgKHNpZ25JblByb3ZpZGVyKSB7XG4gICAgICBjb25zdCBmaWx0ZXJlZFByb3ZpZGVySWQgPVxuICAgICAgICBzaWduSW5Qcm92aWRlciAhPT0gUHJvdmlkZXJJZC5BTk9OWU1PVVMgJiZcbiAgICAgICAgc2lnbkluUHJvdmlkZXIgIT09IFByb3ZpZGVySWQuQ1VTVE9NXG4gICAgICAgICAgPyAoc2lnbkluUHJvdmlkZXIgYXMgUHJvdmlkZXJJZClcbiAgICAgICAgICA6IG51bGw7XG4gICAgICAvLyBVc2VzIGdlbmVyaWMgY2xhc3MgaW4gYWNjb3JkYW5jZSB3aXRoIHRoZSBsZWdhY3kgU0RLLlxuICAgICAgcmV0dXJuIG5ldyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgZmlsdGVyZWRQcm92aWRlcklkKTtcbiAgICB9XG4gIH1cbiAgaWYgKCFwcm92aWRlcklkKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgc3dpdGNoIChwcm92aWRlcklkKSB7XG4gICAgY2FzZSBQcm92aWRlcklkLkZBQ0VCT09LOlxuICAgICAgcmV0dXJuIG5ldyBGYWNlYm9va0FkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUpO1xuICAgIGNhc2UgUHJvdmlkZXJJZC5HSVRIVUI6XG4gICAgICByZXR1cm4gbmV3IEdpdGh1YkFkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUpO1xuICAgIGNhc2UgUHJvdmlkZXJJZC5HT09HTEU6XG4gICAgICByZXR1cm4gbmV3IEdvb2dsZUFkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb2ZpbGUpO1xuICAgIGNhc2UgUHJvdmlkZXJJZC5UV0lUVEVSOlxuICAgICAgcmV0dXJuIG5ldyBUd2l0dGVyQWRkaXRpb25hbFVzZXJJbmZvKFxuICAgICAgICBpc05ld1VzZXIsXG4gICAgICAgIHByb2ZpbGUsXG4gICAgICAgIGlkVG9rZW5SZXNwb25zZS5zY3JlZW5OYW1lIHx8IG51bGxcbiAgICAgICk7XG4gICAgY2FzZSBQcm92aWRlcklkLkNVU1RPTTpcbiAgICBjYXNlIFByb3ZpZGVySWQuQU5PTllNT1VTOlxuICAgICAgcmV0dXJuIG5ldyBHZW5lcmljQWRkaXRpb25hbFVzZXJJbmZvKGlzTmV3VXNlciwgbnVsbCk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBuZXcgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyhpc05ld1VzZXIsIHByb3ZpZGVySWQsIHByb2ZpbGUpO1xuICB9XG59XG5cbmNsYXNzIEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8gaW1wbGVtZW50cyBBZGRpdGlvbmFsVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihcbiAgICByZWFkb25seSBpc05ld1VzZXI6IGJvb2xlYW4sXG4gICAgcmVhZG9ubHkgcHJvdmlkZXJJZDogUHJvdmlkZXJJZCB8IHN0cmluZyB8IG51bGwsXG4gICAgcmVhZG9ubHkgcHJvZmlsZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSB7fVxuICApIHt9XG59XG5cbmNsYXNzIEZlZGVyYXRlZEFkZGl0aW9uYWxVc2VySW5mb1dpdGhVc2VybmFtZSBleHRlbmRzIEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihcbiAgICBpc05ld1VzZXI6IGJvb2xlYW4sXG4gICAgcHJvdmlkZXJJZDogUHJvdmlkZXJJZCxcbiAgICBwcm9maWxlOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgICByZWFkb25seSB1c2VybmFtZTogc3RyaW5nIHwgbnVsbFxuICApIHtcbiAgICBzdXBlcihpc05ld1VzZXIsIHByb3ZpZGVySWQsIHByb2ZpbGUpO1xuICB9XG59XG5cbmNsYXNzIEZhY2Vib29rQWRkaXRpb25hbFVzZXJJbmZvIGV4dGVuZHMgR2VuZXJpY0FkZGl0aW9uYWxVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKGlzTmV3VXNlcjogYm9vbGVhbiwgcHJvZmlsZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICBzdXBlcihpc05ld1VzZXIsIFByb3ZpZGVySWQuRkFDRUJPT0ssIHByb2ZpbGUpO1xuICB9XG59XG5cbmNsYXNzIEdpdGh1YkFkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEZlZGVyYXRlZEFkZGl0aW9uYWxVc2VySW5mb1dpdGhVc2VybmFtZSB7XG4gIGNvbnN0cnVjdG9yKGlzTmV3VXNlcjogYm9vbGVhbiwgcHJvZmlsZTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIHtcbiAgICBzdXBlcihcbiAgICAgIGlzTmV3VXNlcixcbiAgICAgIFByb3ZpZGVySWQuR0lUSFVCLFxuICAgICAgcHJvZmlsZSxcbiAgICAgIHR5cGVvZiBwcm9maWxlPy5sb2dpbiA9PT0gJ3N0cmluZycgPyBwcm9maWxlPy5sb2dpbiA6IG51bGxcbiAgICApO1xuICB9XG59XG5cbmNsYXNzIEdvb2dsZUFkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEdlbmVyaWNBZGRpdGlvbmFsVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcihpc05ld1VzZXI6IGJvb2xlYW4sIHByb2ZpbGU6IFJlY29yZDxzdHJpbmcsIHVua25vd24+KSB7XG4gICAgc3VwZXIoaXNOZXdVc2VyLCBQcm92aWRlcklkLkdPT0dMRSwgcHJvZmlsZSk7XG4gIH1cbn1cblxuY2xhc3MgVHdpdHRlckFkZGl0aW9uYWxVc2VySW5mbyBleHRlbmRzIEZlZGVyYXRlZEFkZGl0aW9uYWxVc2VySW5mb1dpdGhVc2VybmFtZSB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGlzTmV3VXNlcjogYm9vbGVhbixcbiAgICBwcm9maWxlOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPixcbiAgICBzY3JlZW5OYW1lOiBzdHJpbmcgfCBudWxsXG4gICkge1xuICAgIHN1cGVyKGlzTmV3VXNlciwgUHJvdmlkZXJJZC5UV0lUVEVSLCBwcm9maWxlLCBzY3JlZW5OYW1lKTtcbiAgfVxufVxuXG4vKipcbiAqIEV4dHJhY3RzIHByb3ZpZGVyIHNwZWNpZmljIHtAbGluayBBZGRpdGlvbmFsVXNlckluZm99IGZvciB0aGUgZ2l2ZW4gY3JlZGVudGlhbC5cbiAqXG4gKiBAcGFyYW0gdXNlckNyZWRlbnRpYWwgLSBUaGUgdXNlciBjcmVkZW50aWFsLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFkZGl0aW9uYWxVc2VySW5mbyhcbiAgdXNlckNyZWRlbnRpYWw6IFVzZXJDcmVkZW50aWFsXG4pOiBBZGRpdGlvbmFsVXNlckluZm8gfCBudWxsIHtcbiAgY29uc3QgeyB1c2VyLCBfdG9rZW5SZXNwb25zZSB9ID0gdXNlckNyZWRlbnRpYWwgYXMgVXNlckNyZWRlbnRpYWxJbnRlcm5hbDtcbiAgaWYgKHVzZXIuaXNBbm9ueW1vdXMgJiYgIV90b2tlblJlc3BvbnNlKSB7XG4gICAgLy8gSGFuZGxlIHRoZSBzcGVjaWFsIGNhc2Ugd2hlcmUgc2lnbkluQW5vbnltb3VzbHkoKSBnZXRzIGNhbGxlZCB0d2ljZS5cbiAgICAvLyBObyBuZXR3b3JrIGNhbGwgaXMgbWFkZSBzbyB0aGVyZSdzIG5vdGhpbmcgdG8gYWN0dWFsbHkgZmlsbCB0aGlzIGluXG4gICAgcmV0dXJuIHtcbiAgICAgIHByb3ZpZGVySWQ6IG51bGwsXG4gICAgICBpc05ld1VzZXI6IGZhbHNlLFxuICAgICAgcHJvZmlsZTogbnVsbFxuICAgIH07XG4gIH1cblxuICByZXR1cm4gX2Zyb21JZFRva2VuUmVzcG9uc2UoX3Rva2VuUmVzcG9uc2UpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGdldE1vZHVsYXJJbnN0YW5jZSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7XG4gIEF1dGgsXG4gIE5leHRPck9ic2VydmVyLFxuICBQZXJzaXN0ZW5jZSxcbiAgVXNlcixcbiAgQ29tcGxldGVGbixcbiAgRXJyb3JGbixcbiAgVW5zdWJzY3JpYmVcbn0gZnJvbSAnLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IF9jYXN0QXV0aCB9IGZyb20gJy4uL2NvcmUvYXV0aC9hdXRoX2ltcGwnO1xuXG5leHBvcnQge1xuICBkZWJ1Z0Vycm9yTWFwLFxuICBwcm9kRXJyb3JNYXAsXG4gIEFVVEhfRVJST1JfQ09ERVNfTUFQX0RPX05PVF9VU0VfSU5URVJOQUxMWSBhcyBBdXRoRXJyb3JDb2Rlc1xufSBmcm9tICcuL2Vycm9ycyc7XG5cbi8vIE5vbi1vcHRpb25hbCBhdXRoIG1ldGhvZHMuXG4vKipcbiAqIENoYW5nZXMgdGhlIHR5cGUgb2YgcGVyc2lzdGVuY2Ugb24gdGhlIHtAbGluayBBdXRofSBpbnN0YW5jZSBmb3IgdGhlIGN1cnJlbnRseSBzYXZlZFxuICogYEF1dGhgIHNlc3Npb24gYW5kIGFwcGxpZXMgdGhpcyB0eXBlIG9mIHBlcnNpc3RlbmNlIGZvciBmdXR1cmUgc2lnbi1pbiByZXF1ZXN0cywgaW5jbHVkaW5nXG4gKiBzaWduLWluIHdpdGggcmVkaXJlY3QgcmVxdWVzdHMuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgbWFrZXMgaXQgZWFzeSBmb3IgYSB1c2VyIHNpZ25pbmcgaW4gdG8gc3BlY2lmeSB3aGV0aGVyIHRoZWlyIHNlc3Npb24gc2hvdWxkIGJlXG4gKiByZW1lbWJlcmVkIG9yIG5vdC4gSXQgYWxzbyBtYWtlcyBpdCBlYXNpZXIgdG8gbmV2ZXIgcGVyc2lzdCB0aGUgYEF1dGhgIHN0YXRlIGZvciBhcHBsaWNhdGlvbnNcbiAqIHRoYXQgYXJlIHNoYXJlZCBieSBvdGhlciB1c2VycyBvciBoYXZlIHNlbnNpdGl2ZSBkYXRhLlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiBzZXRQZXJzaXN0ZW5jZShhdXRoLCBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBwZXJzaXN0ZW5jZSAtIFRoZSB7QGxpbmsgUGVyc2lzdGVuY2V9IHRvIHVzZS5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVzb2x2ZXMgb25jZSB0aGUgcGVyc2lzdGVuY2UgY2hhbmdlIGhhcyBjb21wbGV0ZWRcbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRQZXJzaXN0ZW5jZShcbiAgYXV0aDogQXV0aCxcbiAgcGVyc2lzdGVuY2U6IFBlcnNpc3RlbmNlXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5zZXRQZXJzaXN0ZW5jZShwZXJzaXN0ZW5jZSk7XG59XG5cbi8qKlxuICogTG9hZHMgdGhlIHJlQ0FQVENIQSBjb25maWd1cmF0aW9uIGludG8gdGhlIGBBdXRoYCBpbnN0YW5jZS5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhpcyB3aWxsIGxvYWQgdGhlIHJlQ0FQVENIQSBjb25maWcsIHdoaWNoIGluZGljYXRlcyB3aGV0aGVyIHRoZSByZUNBUFRDSEFcbiAqIHZlcmlmaWNhdGlvbiBmbG93IHNob3VsZCBiZSB0cmlnZ2VyZWQgZm9yIGVhY2ggYXV0aCBwcm92aWRlciwgaW50byB0aGVcbiAqIGN1cnJlbnQgQXV0aCBzZXNzaW9uLlxuICpcbiAqIElmIGluaXRpYWxpemVSZWNhcHRjaGFDb25maWcoKSBpcyBub3QgaW52b2tlZCwgdGhlIGF1dGggZmxvdyB3aWxsIGFsd2F5cyBzdGFydFxuICogd2l0aG91dCByZUNBUFRDSEEgdmVyaWZpY2F0aW9uLiBJZiB0aGUgcHJvdmlkZXIgaXMgY29uZmlndXJlZCB0byByZXF1aXJlIHJlQ0FQVENIQVxuICogdmVyaWZpY2F0aW9uLCB0aGUgU0RLIHdpbGwgdHJhbnNwYXJlbnRseSBsb2FkIHRoZSByZUNBUFRDSEEgY29uZmlnIGFuZCByZXN0YXJ0IHRoZVxuICogYXV0aCBmbG93cy5cbiAqXG4gKiBUaHVzLCBieSBjYWxsaW5nIHRoaXMgb3B0aW9uYWwgbWV0aG9kLCB5b3Ugd2lsbCByZWR1Y2UgdGhlIGxhdGVuY3kgb2YgZnV0dXJlIGF1dGggZmxvd3MuXG4gKiBMb2FkaW5nIHRoZSByZUNBUFRDSEEgY29uZmlnIGVhcmx5IHdpbGwgYWxzbyBlbmhhbmNlIHRoZSBzaWduYWwgY29sbGVjdGVkIGJ5IHJlQ0FQVENIQS5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogaW5pdGlhbGl6ZVJlY2FwdGNoYUNvbmZpZyhhdXRoKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplUmVjYXB0Y2hhQ29uZmlnKGF1dGg6IEF1dGgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICByZXR1cm4gYXV0aEludGVybmFsLmluaXRpYWxpemVSZWNhcHRjaGFDb25maWcoKTtcbn1cblxuLyoqXG4gKiBBZGRzIGFuIG9ic2VydmVyIGZvciBjaGFuZ2VzIHRvIHRoZSBzaWduZWQtaW4gdXNlcidzIElEIHRva2VuLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIGluY2x1ZGVzIHNpZ24taW4sIHNpZ24tb3V0LCBhbmQgdG9rZW4gcmVmcmVzaCBldmVudHMuXG4gKiBUaGlzIHdpbGwgbm90IGJlIHRyaWdnZXJlZCBhdXRvbWF0aWNhbGx5IHVwb24gSUQgdG9rZW4gZXhwaXJhdGlvbi4gVXNlIHtAbGluayBVc2VyLmdldElkVG9rZW59IHRvIHJlZnJlc2ggdGhlIElEIHRva2VuLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBuZXh0T3JPYnNlcnZlciAtIGNhbGxiYWNrIHRyaWdnZXJlZCBvbiBjaGFuZ2UuXG4gKiBAcGFyYW0gZXJyb3IgLSBEZXByZWNhdGVkLiBUaGlzIGNhbGxiYWNrIGlzIG5ldmVyIHRyaWdnZXJlZC4gRXJyb3JzXG4gKiBvbiBzaWduaW5nIGluL291dCBjYW4gYmUgY2F1Z2h0IGluIHByb21pc2VzIHJldHVybmVkIGZyb21cbiAqIHNpZ24taW4vc2lnbi1vdXQgZnVuY3Rpb25zLlxuICogQHBhcmFtIGNvbXBsZXRlZCAtIERlcHJlY2F0ZWQuIFRoaXMgY2FsbGJhY2sgaXMgbmV2ZXIgdHJpZ2dlcmVkLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG9uSWRUb2tlbkNoYW5nZWQoXG4gIGF1dGg6IEF1dGgsXG4gIG5leHRPck9ic2VydmVyOiBOZXh0T3JPYnNlcnZlcjxVc2VyPixcbiAgZXJyb3I/OiBFcnJvckZuLFxuICBjb21wbGV0ZWQ/OiBDb21wbGV0ZUZuXG4pOiBVbnN1YnNjcmliZSB7XG4gIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkub25JZFRva2VuQ2hhbmdlZChcbiAgICBuZXh0T3JPYnNlcnZlcixcbiAgICBlcnJvcixcbiAgICBjb21wbGV0ZWRcbiAgKTtcbn1cbi8qKlxuICogQWRkcyBhIGJsb2NraW5nIGNhbGxiYWNrIHRoYXQgcnVucyBiZWZvcmUgYW4gYXV0aCBzdGF0ZSBjaGFuZ2VcbiAqIHNldHMgYSBuZXcgdXNlci5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gY2FsbGJhY2sgLSBjYWxsYmFjayB0cmlnZ2VyZWQgYmVmb3JlIG5ldyB1c2VyIHZhbHVlIGlzIHNldC5cbiAqICAgSWYgdGhpcyB0aHJvd3MsIGl0IGJsb2NrcyB0aGUgdXNlciBmcm9tIGJlaW5nIHNldC5cbiAqIEBwYXJhbSBvbkFib3J0IC0gY2FsbGJhY2sgdHJpZ2dlcmVkIGlmIGEgbGF0ZXIgYGJlZm9yZUF1dGhTdGF0ZUNoYW5nZWQoKWBcbiAqICAgY2FsbGJhY2sgdGhyb3dzLCBhbGxvd2luZyB5b3UgdG8gdW5kbyBhbnkgc2lkZSBlZmZlY3RzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYmVmb3JlQXV0aFN0YXRlQ2hhbmdlZChcbiAgYXV0aDogQXV0aCxcbiAgY2FsbGJhY2s6ICh1c2VyOiBVc2VyIHwgbnVsbCkgPT4gdm9pZCB8IFByb21pc2U8dm9pZD4sXG4gIG9uQWJvcnQ/OiAoKSA9PiB2b2lkXG4pOiBVbnN1YnNjcmliZSB7XG4gIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkuYmVmb3JlQXV0aFN0YXRlQ2hhbmdlZChjYWxsYmFjaywgb25BYm9ydCk7XG59XG4vKipcbiAqIEFkZHMgYW4gb2JzZXJ2ZXIgZm9yIGNoYW5nZXMgdG8gdGhlIHVzZXIncyBzaWduLWluIHN0YXRlLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUbyBrZWVwIHRoZSBvbGQgYmVoYXZpb3IsIHNlZSB7QGxpbmsgb25JZFRva2VuQ2hhbmdlZH0uXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIG5leHRPck9ic2VydmVyIC0gY2FsbGJhY2sgdHJpZ2dlcmVkIG9uIGNoYW5nZS5cbiAqIEBwYXJhbSBlcnJvciAtIERlcHJlY2F0ZWQuIFRoaXMgY2FsbGJhY2sgaXMgbmV2ZXIgdHJpZ2dlcmVkLiBFcnJvcnNcbiAqIG9uIHNpZ25pbmcgaW4vb3V0IGNhbiBiZSBjYXVnaHQgaW4gcHJvbWlzZXMgcmV0dXJuZWQgZnJvbVxuICogc2lnbi1pbi9zaWduLW91dCBmdW5jdGlvbnMuXG4gKiBAcGFyYW0gY29tcGxldGVkIC0gRGVwcmVjYXRlZC4gVGhpcyBjYWxsYmFjayBpcyBuZXZlciB0cmlnZ2VyZWQuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gb25BdXRoU3RhdGVDaGFuZ2VkKFxuICBhdXRoOiBBdXRoLFxuICBuZXh0T3JPYnNlcnZlcjogTmV4dE9yT2JzZXJ2ZXI8VXNlcj4sXG4gIGVycm9yPzogRXJyb3JGbixcbiAgY29tcGxldGVkPzogQ29tcGxldGVGblxuKTogVW5zdWJzY3JpYmUge1xuICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpLm9uQXV0aFN0YXRlQ2hhbmdlZChcbiAgICBuZXh0T3JPYnNlcnZlcixcbiAgICBlcnJvcixcbiAgICBjb21wbGV0ZWRcbiAgKTtcbn1cbi8qKlxuICogU2V0cyB0aGUgY3VycmVudCBsYW5ndWFnZSB0byB0aGUgZGVmYXVsdCBkZXZpY2UvYnJvd3NlciBwcmVmZXJlbmNlLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VEZXZpY2VMYW5ndWFnZShhdXRoOiBBdXRoKTogdm9pZCB7XG4gIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS51c2VEZXZpY2VMYW5ndWFnZSgpO1xufVxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzZXRzIHRoZSBwcm92aWRlZCB1c2VyIGFzIHtAbGluayBBdXRoLmN1cnJlbnRVc2VyfSBvbiB0aGVcbiAqIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqXG4gKiBAcmVtYXJrc1xuICogQSBuZXcgaW5zdGFuY2UgY29weSBvZiB0aGUgdXNlciBwcm92aWRlZCB3aWxsIGJlIG1hZGUgYW5kIHNldCBhcyBjdXJyZW50VXNlci5cbiAqXG4gKiBUaGlzIHdpbGwgdHJpZ2dlciB7QGxpbmsgb25BdXRoU3RhdGVDaGFuZ2VkfSBhbmQge0BsaW5rIG9uSWRUb2tlbkNoYW5nZWR9IGxpc3RlbmVyc1xuICogbGlrZSBvdGhlciBzaWduIGluIG1ldGhvZHMuXG4gKlxuICogVGhlIG9wZXJhdGlvbiBmYWlscyB3aXRoIGFuIGVycm9yIGlmIHRoZSB1c2VyIHRvIGJlIHVwZGF0ZWQgYmVsb25ncyB0byBhIGRpZmZlcmVudCBGaXJlYmFzZVxuICogcHJvamVjdC5cbiAqXG4gKiBAcGFyYW0gYXV0aCAtIFRoZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gKiBAcGFyYW0gdXNlciAtIFRoZSBuZXcge0BsaW5rIFVzZXJ9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRVc2VyKFxuICBhdXRoOiBBdXRoLFxuICB1c2VyOiBVc2VyIHwgbnVsbFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIHJldHVybiBnZXRNb2R1bGFySW5zdGFuY2UoYXV0aCkudXBkYXRlQ3VycmVudFVzZXIodXNlcik7XG59XG4vKipcbiAqIFNpZ25zIG91dCB0aGUgY3VycmVudCB1c2VyLlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaWduT3V0KGF1dGg6IEF1dGgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgcmV0dXJuIGdldE1vZHVsYXJJbnN0YW5jZShhdXRoKS5zaWduT3V0KCk7XG59XG5cbmV4cG9ydCB7IGluaXRpYWxpemVBdXRoIH0gZnJvbSAnLi9hdXRoL2luaXRpYWxpemUnO1xuZXhwb3J0IHsgY29ubmVjdEF1dGhFbXVsYXRvciB9IGZyb20gJy4vYXV0aC9lbXVsYXRvcic7XG5cbi8vIGNyZWRlbnRpYWxzXG5leHBvcnQgeyBBdXRoQ3JlZGVudGlhbCB9IGZyb20gJy4vY3JlZGVudGlhbHMnO1xuZXhwb3J0IHsgRW1haWxBdXRoQ3JlZGVudGlhbCB9IGZyb20gJy4vY3JlZGVudGlhbHMvZW1haWwnO1xuZXhwb3J0IHsgT0F1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi9jcmVkZW50aWFscy9vYXV0aCc7XG5leHBvcnQgeyBQaG9uZUF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi9jcmVkZW50aWFscy9waG9uZSc7XG5cbi8vIHBlcnNpc3RlbmNlXG5leHBvcnQgeyBpbk1lbW9yeVBlcnNpc3RlbmNlIH0gZnJvbSAnLi9wZXJzaXN0ZW5jZS9pbl9tZW1vcnknO1xuXG4vLyBwcm92aWRlcnNcbmV4cG9ydCB7IEVtYWlsQXV0aFByb3ZpZGVyIH0gZnJvbSAnLi9wcm92aWRlcnMvZW1haWwnO1xuZXhwb3J0IHsgRmFjZWJvb2tBdXRoUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9mYWNlYm9vayc7XG5leHBvcnQgeyBDdXN0b21QYXJhbWV0ZXJzIH0gZnJvbSAnLi9wcm92aWRlcnMvZmVkZXJhdGVkJztcbmV4cG9ydCB7IEdvb2dsZUF1dGhQcm92aWRlciB9IGZyb20gJy4vcHJvdmlkZXJzL2dvb2dsZSc7XG5leHBvcnQgeyBHaXRodWJBdXRoUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9naXRodWInO1xuZXhwb3J0IHsgT0F1dGhQcm92aWRlciwgT0F1dGhDcmVkZW50aWFsT3B0aW9ucyB9IGZyb20gJy4vcHJvdmlkZXJzL29hdXRoJztcbmV4cG9ydCB7IFNBTUxBdXRoUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy9zYW1sJztcbmV4cG9ydCB7IFR3aXR0ZXJBdXRoUHJvdmlkZXIgfSBmcm9tICcuL3Byb3ZpZGVycy90d2l0dGVyJztcblxuLy8gc3RyYXRlZ2llc1xuZXhwb3J0IHsgc2lnbkluQW5vbnltb3VzbHkgfSBmcm9tICcuL3N0cmF0ZWdpZXMvYW5vbnltb3VzJztcbmV4cG9ydCB7XG4gIHNpZ25JbldpdGhDcmVkZW50aWFsLFxuICBsaW5rV2l0aENyZWRlbnRpYWwsXG4gIHJlYXV0aGVudGljYXRlV2l0aENyZWRlbnRpYWxcbn0gZnJvbSAnLi9zdHJhdGVnaWVzL2NyZWRlbnRpYWwnO1xuZXhwb3J0IHsgc2lnbkluV2l0aEN1c3RvbVRva2VuIH0gZnJvbSAnLi9zdHJhdGVnaWVzL2N1c3RvbV90b2tlbic7XG5leHBvcnQge1xuICBzZW5kUGFzc3dvcmRSZXNldEVtYWlsLFxuICBjb25maXJtUGFzc3dvcmRSZXNldCxcbiAgYXBwbHlBY3Rpb25Db2RlLFxuICBjaGVja0FjdGlvbkNvZGUsXG4gIHZlcmlmeVBhc3N3b3JkUmVzZXRDb2RlLFxuICBjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQsXG4gIHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkXG59IGZyb20gJy4vc3RyYXRlZ2llcy9lbWFpbF9hbmRfcGFzc3dvcmQnO1xuZXhwb3J0IHtcbiAgc2VuZFNpZ25JbkxpbmtUb0VtYWlsLFxuICBpc1NpZ25JbldpdGhFbWFpbExpbmssXG4gIHNpZ25JbldpdGhFbWFpbExpbmtcbn0gZnJvbSAnLi9zdHJhdGVnaWVzL2VtYWlsX2xpbmsnO1xuZXhwb3J0IHtcbiAgZmV0Y2hTaWduSW5NZXRob2RzRm9yRW1haWwsXG4gIHNlbmRFbWFpbFZlcmlmaWNhdGlvbixcbiAgdmVyaWZ5QmVmb3JlVXBkYXRlRW1haWxcbn0gZnJvbSAnLi9zdHJhdGVnaWVzL2VtYWlsJztcblxuLy8gY29yZVxuZXhwb3J0IHsgQWN0aW9uQ29kZVVSTCwgcGFyc2VBY3Rpb25Db2RlVVJMIH0gZnJvbSAnLi9hY3Rpb25fY29kZV91cmwnO1xuXG4vLyB1c2VyXG5leHBvcnQge1xuICB1cGRhdGVQcm9maWxlLFxuICB1cGRhdGVFbWFpbCxcbiAgdXBkYXRlUGFzc3dvcmRcbn0gZnJvbSAnLi91c2VyL2FjY291bnRfaW5mbyc7XG5leHBvcnQgeyBnZXRJZFRva2VuLCBnZXRJZFRva2VuUmVzdWx0IH0gZnJvbSAnLi91c2VyL2lkX3Rva2VuX3Jlc3VsdCc7XG5leHBvcnQgeyB1bmxpbmsgfSBmcm9tICcuL3VzZXIvbGlua191bmxpbmsnO1xuZXhwb3J0IHsgZ2V0QWRkaXRpb25hbFVzZXJJbmZvIH0gZnJvbSAnLi91c2VyL2FkZGl0aW9uYWxfdXNlcl9pbmZvJztcblxuLy8gTm9uLW9wdGlvbmFsIHVzZXIgbWV0aG9kcy5cbmV4cG9ydCB7IHJlbG9hZCB9IGZyb20gJy4vdXNlci9yZWxvYWQnO1xuLyoqXG4gKiBEZWxldGVzIGFuZCBzaWducyBvdXQgdGhlIHVzZXIuXG4gKlxuICogQHJlbWFya3NcbiAqIEltcG9ydGFudDogdGhpcyBpcyBhIHNlY3VyaXR5LXNlbnNpdGl2ZSBvcGVyYXRpb24gdGhhdCByZXF1aXJlcyB0aGUgdXNlciB0byBoYXZlIHJlY2VudGx5XG4gKiBzaWduZWQgaW4uIElmIHRoaXMgcmVxdWlyZW1lbnQgaXNuJ3QgbWV0LCBhc2sgdGhlIHVzZXIgdG8gYXV0aGVudGljYXRlIGFnYWluIGFuZCB0aGVuIGNhbGxcbiAqIHtAbGluayByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVVzZXIodXNlcjogVXNlcik6IFByb21pc2U8dm9pZD4ge1xuICByZXR1cm4gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpLmRlbGV0ZSgpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFVzZXJJbnRlcm5hbCB9IGZyb20gJy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgTXVsdGlGYWN0b3JTZXNzaW9uIH0gZnJvbSAnLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuZXhwb3J0IGNvbnN0IGVudW0gTXVsdGlGYWN0b3JTZXNzaW9uVHlwZSB7XG4gIEVOUk9MTCA9ICdlbnJvbGwnLFxuICBTSUdOX0lOID0gJ3NpZ25pbidcbn1cblxuaW50ZXJmYWNlIFNlcmlhbGl6ZWRNdWx0aUZhY3RvclNlc3Npb24ge1xuICBtdWx0aUZhY3RvclNlc3Npb246IHtcbiAgICBpZFRva2VuPzogc3RyaW5nO1xuICAgIHBlbmRpbmdDcmVkZW50aWFsPzogc3RyaW5nO1xuICB9O1xufVxuXG5leHBvcnQgY2xhc3MgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbCBpbXBsZW1lbnRzIE11bHRpRmFjdG9yU2Vzc2lvbiB7XG4gIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgcmVhZG9ubHkgdHlwZTogTXVsdGlGYWN0b3JTZXNzaW9uVHlwZSxcbiAgICByZWFkb25seSBjcmVkZW50aWFsOiBzdHJpbmcsXG4gICAgcmVhZG9ubHkgdXNlcj86IFVzZXJJbnRlcm5hbFxuICApIHt9XG5cbiAgc3RhdGljIF9mcm9tSWR0b2tlbihcbiAgICBpZFRva2VuOiBzdHJpbmcsXG4gICAgdXNlcj86IFVzZXJJbnRlcm5hbFxuICApOiBNdWx0aUZhY3RvclNlc3Npb25JbXBsIHtcbiAgICByZXR1cm4gbmV3IE11bHRpRmFjdG9yU2Vzc2lvbkltcGwoXG4gICAgICBNdWx0aUZhY3RvclNlc3Npb25UeXBlLkVOUk9MTCxcbiAgICAgIGlkVG9rZW4sXG4gICAgICB1c2VyXG4gICAgKTtcbiAgfVxuXG4gIHN0YXRpYyBfZnJvbU1mYVBlbmRpbmdDcmVkZW50aWFsKFxuICAgIG1mYVBlbmRpbmdDcmVkZW50aWFsOiBzdHJpbmdcbiAgKTogTXVsdGlGYWN0b3JTZXNzaW9uSW1wbCB7XG4gICAgcmV0dXJuIG5ldyBNdWx0aUZhY3RvclNlc3Npb25JbXBsKFxuICAgICAgTXVsdGlGYWN0b3JTZXNzaW9uVHlwZS5TSUdOX0lOLFxuICAgICAgbWZhUGVuZGluZ0NyZWRlbnRpYWxcbiAgICApO1xuICB9XG5cbiAgdG9KU09OKCk6IFNlcmlhbGl6ZWRNdWx0aUZhY3RvclNlc3Npb24ge1xuICAgIGNvbnN0IGtleSA9XG4gICAgICB0aGlzLnR5cGUgPT09IE11bHRpRmFjdG9yU2Vzc2lvblR5cGUuRU5ST0xMXG4gICAgICAgID8gJ2lkVG9rZW4nXG4gICAgICAgIDogJ3BlbmRpbmdDcmVkZW50aWFsJztcbiAgICByZXR1cm4ge1xuICAgICAgbXVsdGlGYWN0b3JTZXNzaW9uOiB7XG4gICAgICAgIFtrZXldOiB0aGlzLmNyZWRlbnRpYWxcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgc3RhdGljIGZyb21KU09OKFxuICAgIG9iajogUGFydGlhbDxTZXJpYWxpemVkTXVsdGlGYWN0b3JTZXNzaW9uPlxuICApOiBNdWx0aUZhY3RvclNlc3Npb25JbXBsIHwgbnVsbCB7XG4gICAgaWYgKG9iaj8ubXVsdGlGYWN0b3JTZXNzaW9uKSB7XG4gICAgICBpZiAob2JqLm11bHRpRmFjdG9yU2Vzc2lvbj8ucGVuZGluZ0NyZWRlbnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIE11bHRpRmFjdG9yU2Vzc2lvbkltcGwuX2Zyb21NZmFQZW5kaW5nQ3JlZGVudGlhbChcbiAgICAgICAgICBvYmoubXVsdGlGYWN0b3JTZXNzaW9uLnBlbmRpbmdDcmVkZW50aWFsXG4gICAgICAgICk7XG4gICAgICB9IGVsc2UgaWYgKG9iai5tdWx0aUZhY3RvclNlc3Npb24/LmlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIE11bHRpRmFjdG9yU2Vzc2lvbkltcGwuX2Zyb21JZHRva2VuKFxuICAgICAgICAgIG9iai5tdWx0aUZhY3RvclNlc3Npb24uaWRUb2tlblxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEF1dGgsXG4gIE11bHRpRmFjdG9yUmVzb2x2ZXIsXG4gIFVzZXJDcmVkZW50aWFsLFxuICBNdWx0aUZhY3RvckVycm9yXG59IGZyb20gJy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCB7IF9jYXN0QXV0aCB9IGZyb20gJy4uL2NvcmUvYXV0aC9hdXRoX2ltcGwnO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2NvcmUvZXJyb3JzJztcbmltcG9ydCB7IFVzZXJDcmVkZW50aWFsSW1wbCB9IGZyb20gJy4uL2NvcmUvdXNlci91c2VyX2NyZWRlbnRpYWxfaW1wbCc7XG5pbXBvcnQgeyBfYXNzZXJ0LCBfZmFpbCB9IGZyb20gJy4uL2NvcmUvdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbnRlcm5hbCB9IGZyb20gJy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsIH0gZnJvbSAnLi9tZmFfYXNzZXJ0aW9uJztcbmltcG9ydCB7IE11bHRpRmFjdG9yRXJyb3IgYXMgTXVsdGlGYWN0b3JFcnJvckludGVybmFsIH0gZnJvbSAnLi9tZmFfZXJyb3InO1xuaW1wb3J0IHsgTXVsdGlGYWN0b3JJbmZvSW1wbCB9IGZyb20gJy4vbWZhX2luZm8nO1xuaW1wb3J0IHsgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbCB9IGZyb20gJy4vbWZhX3Nlc3Npb24nO1xuaW1wb3J0IHsgZ2V0TW9kdWxhckluc3RhbmNlIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgT3BlcmF0aW9uVHlwZSB9IGZyb20gJy4uL21vZGVsL2VudW1zJztcblxuZXhwb3J0IGNsYXNzIE11bHRpRmFjdG9yUmVzb2x2ZXJJbXBsIGltcGxlbWVudHMgTXVsdGlGYWN0b3JSZXNvbHZlciB7XG4gIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgcmVhZG9ubHkgc2Vzc2lvbjogTXVsdGlGYWN0b3JTZXNzaW9uSW1wbCxcbiAgICByZWFkb25seSBoaW50czogTXVsdGlGYWN0b3JJbmZvSW1wbFtdLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgc2lnbkluUmVzb2x2ZXI6IChcbiAgICAgIGFzc2VydGlvbjogTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsXG4gICAgKSA9PiBQcm9taXNlPFVzZXJDcmVkZW50aWFsSW50ZXJuYWw+XG4gICkge31cblxuICAvKiogQGludGVybmFsICovXG4gIHN0YXRpYyBfZnJvbUVycm9yKFxuICAgIGF1dGhFeHRlcm46IEF1dGgsXG4gICAgZXJyb3I6IE11bHRpRmFjdG9yRXJyb3JJbnRlcm5hbFxuICApOiBNdWx0aUZhY3RvclJlc29sdmVySW1wbCB7XG4gICAgY29uc3QgYXV0aCA9IF9jYXN0QXV0aChhdXRoRXh0ZXJuKTtcbiAgICBjb25zdCBzZXJ2ZXJSZXNwb25zZSA9IGVycm9yLmN1c3RvbURhdGEuX3NlcnZlclJlc3BvbnNlO1xuICAgIGNvbnN0IGhpbnRzID0gKHNlcnZlclJlc3BvbnNlLm1mYUluZm8gfHwgW10pLm1hcChlbnJvbGxtZW50ID0+XG4gICAgICBNdWx0aUZhY3RvckluZm9JbXBsLl9mcm9tU2VydmVyUmVzcG9uc2UoYXV0aCwgZW5yb2xsbWVudClcbiAgICApO1xuXG4gICAgX2Fzc2VydChcbiAgICAgIHNlcnZlclJlc3BvbnNlLm1mYVBlbmRpbmdDcmVkZW50aWFsLFxuICAgICAgYXV0aCxcbiAgICAgIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1JcbiAgICApO1xuICAgIGNvbnN0IHNlc3Npb24gPSBNdWx0aUZhY3RvclNlc3Npb25JbXBsLl9mcm9tTWZhUGVuZGluZ0NyZWRlbnRpYWwoXG4gICAgICBzZXJ2ZXJSZXNwb25zZS5tZmFQZW5kaW5nQ3JlZGVudGlhbFxuICAgICk7XG5cbiAgICByZXR1cm4gbmV3IE11bHRpRmFjdG9yUmVzb2x2ZXJJbXBsKFxuICAgICAgc2Vzc2lvbixcbiAgICAgIGhpbnRzLFxuICAgICAgYXN5bmMgKFxuICAgICAgICBhc3NlcnRpb246IE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbFxuICAgICAgKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbEludGVybmFsPiA9PiB7XG4gICAgICAgIGNvbnN0IG1mYVJlc3BvbnNlID0gYXdhaXQgYXNzZXJ0aW9uLl9wcm9jZXNzKGF1dGgsIHNlc3Npb24pO1xuICAgICAgICAvLyBDbGVhciBvdXQgdGhlIHVubmVlZGVkIGZpZWxkcyBmcm9tIHRoZSBvbGQgbG9naW4gcmVzcG9uc2VcbiAgICAgICAgZGVsZXRlIHNlcnZlclJlc3BvbnNlLm1mYUluZm87XG4gICAgICAgIGRlbGV0ZSBzZXJ2ZXJSZXNwb25zZS5tZmFQZW5kaW5nQ3JlZGVudGlhbDtcblxuICAgICAgICAvLyBVc2UgaW4gdGhlIG5ldyB0b2tlbiAmIHJlZnJlc2ggdG9rZW4gaW4gdGhlIG9sZCByZXNwb25zZVxuICAgICAgICBjb25zdCBpZFRva2VuUmVzcG9uc2UgPSB7XG4gICAgICAgICAgLi4uc2VydmVyUmVzcG9uc2UsXG4gICAgICAgICAgaWRUb2tlbjogbWZhUmVzcG9uc2UuaWRUb2tlbixcbiAgICAgICAgICByZWZyZXNoVG9rZW46IG1mYVJlc3BvbnNlLnJlZnJlc2hUb2tlblxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFRPRE86IHdlIHNob3VsZCBjb2xsYXBzZSB0aGlzIHN3aXRjaCBzdGF0ZW1lbnQgaW50byBVc2VyQ3JlZGVudGlhbEltcGwuX2Zvck9wZXJhdGlvbiBhbmQgaGF2ZSBpdCBzdXBwb3J0IHRoZSBTSUdOX0lOIGNhc2VcbiAgICAgICAgc3dpdGNoIChlcnJvci5vcGVyYXRpb25UeXBlKSB7XG4gICAgICAgICAgY2FzZSBPcGVyYXRpb25UeXBlLlNJR05fSU46XG4gICAgICAgICAgICBjb25zdCB1c2VyQ3JlZGVudGlhbCA9XG4gICAgICAgICAgICAgIGF3YWl0IFVzZXJDcmVkZW50aWFsSW1wbC5fZnJvbUlkVG9rZW5SZXNwb25zZShcbiAgICAgICAgICAgICAgICBhdXRoLFxuICAgICAgICAgICAgICAgIGVycm9yLm9wZXJhdGlvblR5cGUsXG4gICAgICAgICAgICAgICAgaWRUb2tlblJlc3BvbnNlXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhd2FpdCBhdXRoLl91cGRhdGVDdXJyZW50VXNlcih1c2VyQ3JlZGVudGlhbC51c2VyKTtcbiAgICAgICAgICAgIHJldHVybiB1c2VyQ3JlZGVudGlhbDtcbiAgICAgICAgICBjYXNlIE9wZXJhdGlvblR5cGUuUkVBVVRIRU5USUNBVEU6XG4gICAgICAgICAgICBfYXNzZXJ0KGVycm9yLnVzZXIsIGF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICAgICAgICAgICAgcmV0dXJuIFVzZXJDcmVkZW50aWFsSW1wbC5fZm9yT3BlcmF0aW9uKFxuICAgICAgICAgICAgICBlcnJvci51c2VyLFxuICAgICAgICAgICAgICBlcnJvci5vcGVyYXRpb25UeXBlLFxuICAgICAgICAgICAgICBpZFRva2VuUmVzcG9uc2VcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIF9mYWlsKGF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIHJlc29sdmVTaWduSW4oXG4gICAgYXNzZXJ0aW9uRXh0ZXJuOiBNdWx0aUZhY3RvckFzc2VydGlvbkltcGxcbiAgKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD4ge1xuICAgIGNvbnN0IGFzc2VydGlvbiA9IGFzc2VydGlvbkV4dGVybiBhcyBNdWx0aUZhY3RvckFzc2VydGlvbkltcGw7XG4gICAgcmV0dXJuIHRoaXMuc2lnbkluUmVzb2x2ZXIoYXNzZXJ0aW9uKTtcbiAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVzIGEge0BsaW5rIE11bHRpRmFjdG9yUmVzb2x2ZXJ9IHN1aXRhYmxlIGZvciBjb21wbGV0aW9uIG9mIGFcbiAqIG11bHRpLWZhY3RvciBmbG93LlxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBlcnJvciAtIFRoZSB7QGxpbmsgTXVsdGlGYWN0b3JFcnJvcn0gcmFpc2VkIGR1cmluZyBhIHNpZ24taW4sIG9yXG4gKiByZWF1dGhlbnRpY2F0aW9uIG9wZXJhdGlvbi5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRNdWx0aUZhY3RvclJlc29sdmVyKFxuICBhdXRoOiBBdXRoLFxuICBlcnJvcjogTXVsdGlGYWN0b3JFcnJvclxuKTogTXVsdGlGYWN0b3JSZXNvbHZlciB7XG4gIGNvbnN0IGF1dGhNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKGF1dGgpO1xuICBjb25zdCBlcnJvckludGVybmFsID0gZXJyb3IgYXMgTXVsdGlGYWN0b3JFcnJvckludGVybmFsO1xuICBfYXNzZXJ0KFxuICAgIGVycm9yLmN1c3RvbURhdGEub3BlcmF0aW9uVHlwZSxcbiAgICBhdXRoTW9kdWxhcixcbiAgICBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SXG4gICk7XG4gIF9hc3NlcnQoXG4gICAgZXJyb3JJbnRlcm5hbC5jdXN0b21EYXRhLl9zZXJ2ZXJSZXNwb25zZT8ubWZhUGVuZGluZ0NyZWRlbnRpYWwsXG4gICAgYXV0aE1vZHVsYXIsXG4gICAgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUlxuICApO1xuXG4gIHJldHVybiBNdWx0aUZhY3RvclJlc29sdmVySW1wbC5fZnJvbUVycm9yKGF1dGhNb2R1bGFyLCBlcnJvckludGVybmFsKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBFbmRwb2ludCxcbiAgSHR0cE1ldGhvZCxcbiAgX2FkZFRpZElmTmVjZXNzYXJ5LFxuICBfcGVyZm9ybUFwaVJlcXVlc3Rcbn0gZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IHsgU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdCB9IGZyb20gJy4uL2F1dGhlbnRpY2F0aW9uL3Ntcyc7XG5pbXBvcnQgeyBGaW5hbGl6ZU1mYVJlc3BvbnNlIH0gZnJvbSAnLi4vYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuXG4vKipcbiAqIE1GQSBJbmZvIGFzIHJldHVybmVkIGJ5IHRoZSBBUEkuXG4gKi9cbmludGVyZmFjZSBCYXNlTWZhRW5yb2xsbWVudCB7XG4gIG1mYUVucm9sbG1lbnRJZDogc3RyaW5nO1xuICBlbnJvbGxlZEF0OiBudW1iZXI7XG4gIGRpc3BsYXlOYW1lPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIEFuIE1GQSBwcm92aWRlZCBieSBTTVMgdmVyaWZpY2F0aW9uLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFBob25lTWZhRW5yb2xsbWVudCBleHRlbmRzIEJhc2VNZmFFbnJvbGxtZW50IHtcbiAgcGhvbmVJbmZvOiBzdHJpbmc7XG59XG5cbi8qKlxuICogQW4gTUZBIHByb3ZpZGVkIGJ5IFRPVFAgKFRpbWUtYmFzZWQgT25lIFRpbWUgUGFzc3dvcmQpLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRvdHBNZmFFbnJvbGxtZW50IGV4dGVuZHMgQmFzZU1mYUVucm9sbG1lbnQge31cblxuLyoqXG4gKiBNZmFFbnJvbGxtZW50IGNhbiBiZSBhbnkgc3VidHlwZSBvZiBCYXNlTWZhRW5yb2xsbWVudCwgY3VycmVudGx5IG9ubHkgUGhvbmVNZmFFbnJvbGxtZW50IGFuZCBUb3RwTWZhRW5yb2xsbWVudCBhcmUgc3VwcG9ydGVkLlxuICovXG5leHBvcnQgdHlwZSBNZmFFbnJvbGxtZW50ID0gUGhvbmVNZmFFbnJvbGxtZW50IHwgVG90cE1mYUVucm9sbG1lbnQ7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RhcnRQaG9uZU1mYUVucm9sbG1lbnRSZXF1ZXN0IHtcbiAgaWRUb2tlbjogc3RyaW5nO1xuICBwaG9uZUVucm9sbG1lbnRJbmZvOiB7XG4gICAgcGhvbmVOdW1iZXI6IHN0cmluZztcbiAgICByZWNhcHRjaGFUb2tlbjogc3RyaW5nO1xuICB9O1xuICB0ZW5hbnRJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFydFBob25lTWZhRW5yb2xsbWVudFJlc3BvbnNlIHtcbiAgcGhvbmVTZXNzaW9uSW5mbzoge1xuICAgIHNlc3Npb25JbmZvOiBzdHJpbmc7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdGFydEVucm9sbFBob25lTWZhKFxuICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gIHJlcXVlc3Q6IFN0YXJ0UGhvbmVNZmFFbnJvbGxtZW50UmVxdWVzdFxuKTogUHJvbWlzZTxTdGFydFBob25lTWZhRW5yb2xsbWVudFJlc3BvbnNlPiB7XG4gIHJldHVybiBfcGVyZm9ybUFwaVJlcXVlc3Q8XG4gICAgU3RhcnRQaG9uZU1mYUVucm9sbG1lbnRSZXF1ZXN0LFxuICAgIFN0YXJ0UGhvbmVNZmFFbnJvbGxtZW50UmVzcG9uc2VcbiAgPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5TVEFSVF9NRkFfRU5ST0xMTUVOVCxcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaW5hbGl6ZVBob25lTWZhRW5yb2xsbWVudFJlcXVlc3Qge1xuICBpZFRva2VuOiBzdHJpbmc7XG4gIHBob25lVmVyaWZpY2F0aW9uSW5mbzogU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdDtcbiAgZGlzcGxheU5hbWU/OiBzdHJpbmcgfCBudWxsO1xuICB0ZW5hbnRJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaW5hbGl6ZVBob25lTWZhRW5yb2xsbWVudFJlc3BvbnNlXG4gIGV4dGVuZHMgRmluYWxpemVNZmFSZXNwb25zZSB7fVxuXG5leHBvcnQgZnVuY3Rpb24gZmluYWxpemVFbnJvbGxQaG9uZU1mYShcbiAgYXV0aDogQXV0aEludGVybmFsLFxuICByZXF1ZXN0OiBGaW5hbGl6ZVBob25lTWZhRW5yb2xsbWVudFJlcXVlc3Rcbik6IFByb21pc2U8RmluYWxpemVQaG9uZU1mYUVucm9sbG1lbnRSZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0PFxuICAgIEZpbmFsaXplUGhvbmVNZmFFbnJvbGxtZW50UmVxdWVzdCxcbiAgICBGaW5hbGl6ZVBob25lTWZhRW5yb2xsbWVudFJlc3BvbnNlXG4gID4oXG4gICAgYXV0aCxcbiAgICBIdHRwTWV0aG9kLlBPU1QsXG4gICAgRW5kcG9pbnQuRklOQUxJWkVfTUZBX0VOUk9MTE1FTlQsXG4gICAgX2FkZFRpZElmTmVjZXNzYXJ5KGF1dGgsIHJlcXVlc3QpXG4gICk7XG59XG5leHBvcnQgaW50ZXJmYWNlIFN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXF1ZXN0IHtcbiAgaWRUb2tlbjogc3RyaW5nO1xuICB0b3RwRW5yb2xsbWVudEluZm86IHt9O1xuICB0ZW5hbnRJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFydFRvdHBNZmFFbnJvbGxtZW50UmVzcG9uc2Uge1xuICB0b3RwU2Vzc2lvbkluZm86IHtcbiAgICBzaGFyZWRTZWNyZXRLZXk6IHN0cmluZztcbiAgICB2ZXJpZmljYXRpb25Db2RlTGVuZ3RoOiBudW1iZXI7XG4gICAgaGFzaGluZ0FsZ29yaXRobTogc3RyaW5nO1xuICAgIHBlcmlvZFNlYzogbnVtYmVyO1xuICAgIHNlc3Npb25JbmZvOiBzdHJpbmc7XG4gICAgZmluYWxpemVFbnJvbGxtZW50VGltZTogbnVtYmVyO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RhcnRFbnJvbGxUb3RwTWZhKFxuICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gIHJlcXVlc3Q6IFN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXF1ZXN0XG4pOiBQcm9taXNlPFN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0PFxuICAgIFN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXF1ZXN0LFxuICAgIFN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXNwb25zZVxuICA+KFxuICAgIGF1dGgsXG4gICAgSHR0cE1ldGhvZC5QT1NULFxuICAgIEVuZHBvaW50LlNUQVJUX01GQV9FTlJPTExNRU5ULFxuICAgIF9hZGRUaWRJZk5lY2Vzc2FyeShhdXRoLCByZXF1ZXN0KVxuICApO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRvdHBWZXJpZmljYXRpb25JbmZvIHtcbiAgc2Vzc2lvbkluZm86IHN0cmluZztcbiAgdmVyaWZpY2F0aW9uQ29kZTogc3RyaW5nO1xufVxuZXhwb3J0IGludGVyZmFjZSBGaW5hbGl6ZVRvdHBNZmFFbnJvbGxtZW50UmVxdWVzdCB7XG4gIGlkVG9rZW46IHN0cmluZztcbiAgdG90cFZlcmlmaWNhdGlvbkluZm86IFRvdHBWZXJpZmljYXRpb25JbmZvO1xuICBkaXNwbGF5TmFtZT86IHN0cmluZyB8IG51bGw7XG4gIHRlbmFudElkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpbmFsaXplVG90cE1mYUVucm9sbG1lbnRSZXNwb25zZVxuICBleHRlbmRzIEZpbmFsaXplTWZhUmVzcG9uc2Uge31cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmFsaXplRW5yb2xsVG90cE1mYShcbiAgYXV0aDogQXV0aEludGVybmFsLFxuICByZXF1ZXN0OiBGaW5hbGl6ZVRvdHBNZmFFbnJvbGxtZW50UmVxdWVzdFxuKTogUHJvbWlzZTxGaW5hbGl6ZVRvdHBNZmFFbnJvbGxtZW50UmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdDxcbiAgICBGaW5hbGl6ZVRvdHBNZmFFbnJvbGxtZW50UmVxdWVzdCxcbiAgICBGaW5hbGl6ZVRvdHBNZmFFbnJvbGxtZW50UmVzcG9uc2VcbiAgPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5GSU5BTElaRV9NRkFfRU5ST0xMTUVOVCxcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXaXRoZHJhd01mYVJlcXVlc3Qge1xuICBpZFRva2VuOiBzdHJpbmc7XG4gIG1mYUVucm9sbG1lbnRJZDogc3RyaW5nO1xuICB0ZW5hbnRJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXaXRoZHJhd01mYVJlc3BvbnNlIGV4dGVuZHMgRmluYWxpemVNZmFSZXNwb25zZSB7fVxuXG5leHBvcnQgZnVuY3Rpb24gd2l0aGRyYXdNZmEoXG4gIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgcmVxdWVzdDogV2l0aGRyYXdNZmFSZXF1ZXN0XG4pOiBQcm9taXNlPFdpdGhkcmF3TWZhUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdDxXaXRoZHJhd01mYVJlcXVlc3QsIFdpdGhkcmF3TWZhUmVzcG9uc2U+KFxuICAgIGF1dGgsXG4gICAgSHR0cE1ldGhvZC5QT1NULFxuICAgIEVuZHBvaW50LldJVEhEUkFXX01GQSxcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHtcbiAgTXVsdGlGYWN0b3JBc3NlcnRpb24sXG4gIE11bHRpRmFjdG9ySW5mbyxcbiAgTXVsdGlGYWN0b3JTZXNzaW9uLFxuICBNdWx0aUZhY3RvclVzZXIsXG4gIFVzZXJcbn0gZnJvbSAnLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHsgd2l0aGRyYXdNZmEgfSBmcm9tICcuLi9hcGkvYWNjb3VudF9tYW5hZ2VtZW50L21mYSc7XG5pbXBvcnQgeyBfbG9nb3V0SWZJbnZhbGlkYXRlZCB9IGZyb20gJy4uL2NvcmUvdXNlci9pbnZhbGlkYXRpb24nO1xuaW1wb3J0IHsgVXNlckludGVybmFsIH0gZnJvbSAnLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwgfSBmcm9tICcuL21mYV9hc3NlcnRpb24nO1xuaW1wb3J0IHsgTXVsdGlGYWN0b3JJbmZvSW1wbCB9IGZyb20gJy4vbWZhX2luZm8nO1xuaW1wb3J0IHsgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbCB9IGZyb20gJy4vbWZhX3Nlc3Npb24nO1xuaW1wb3J0IHsgZ2V0TW9kdWxhckluc3RhbmNlIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5leHBvcnQgY2xhc3MgTXVsdGlGYWN0b3JVc2VySW1wbCBpbXBsZW1lbnRzIE11bHRpRmFjdG9yVXNlciB7XG4gIGVucm9sbGVkRmFjdG9yczogTXVsdGlGYWN0b3JJbmZvW10gPSBbXTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKHJlYWRvbmx5IHVzZXI6IFVzZXJJbnRlcm5hbCkge1xuICAgIHVzZXIuX29uUmVsb2FkKHVzZXJJbmZvID0+IHtcbiAgICAgIGlmICh1c2VySW5mby5tZmFJbmZvKSB7XG4gICAgICAgIHRoaXMuZW5yb2xsZWRGYWN0b3JzID0gdXNlckluZm8ubWZhSW5mby5tYXAoZW5yb2xsbWVudCA9PlxuICAgICAgICAgIE11bHRpRmFjdG9ySW5mb0ltcGwuX2Zyb21TZXJ2ZXJSZXNwb25zZSh1c2VyLmF1dGgsIGVucm9sbG1lbnQpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBzdGF0aWMgX2Zyb21Vc2VyKHVzZXI6IFVzZXJJbnRlcm5hbCk6IE11bHRpRmFjdG9yVXNlckltcGwge1xuICAgIHJldHVybiBuZXcgTXVsdGlGYWN0b3JVc2VySW1wbCh1c2VyKTtcbiAgfVxuXG4gIGFzeW5jIGdldFNlc3Npb24oKTogUHJvbWlzZTxNdWx0aUZhY3RvclNlc3Npb24+IHtcbiAgICByZXR1cm4gTXVsdGlGYWN0b3JTZXNzaW9uSW1wbC5fZnJvbUlkdG9rZW4oXG4gICAgICBhd2FpdCB0aGlzLnVzZXIuZ2V0SWRUb2tlbigpLFxuICAgICAgdGhpcy51c2VyXG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIGVucm9sbChcbiAgICBhc3NlcnRpb25FeHRlcm46IE11bHRpRmFjdG9yQXNzZXJ0aW9uLFxuICAgIGRpc3BsYXlOYW1lPzogc3RyaW5nIHwgbnVsbFxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBhc3NlcnRpb24gPSBhc3NlcnRpb25FeHRlcm4gYXMgTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsO1xuICAgIGNvbnN0IHNlc3Npb24gPSAoYXdhaXQgdGhpcy5nZXRTZXNzaW9uKCkpIGFzIE11bHRpRmFjdG9yU2Vzc2lvbkltcGw7XG4gICAgY29uc3QgZmluYWxpemVNZmFSZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKFxuICAgICAgdGhpcy51c2VyLFxuICAgICAgYXNzZXJ0aW9uLl9wcm9jZXNzKHRoaXMudXNlci5hdXRoLCBzZXNzaW9uLCBkaXNwbGF5TmFtZSlcbiAgICApO1xuICAgIC8vIE5ldyB0b2tlbnMgd2lsbCBiZSBpc3N1ZWQgYWZ0ZXIgZW5yb2xsbWVudCBvZiB0aGUgbmV3IHNlY29uZCBmYWN0b3JzLlxuICAgIC8vIFRoZXkgbmVlZCB0byBiZSB1cGRhdGVkIG9uIHRoZSB1c2VyLlxuICAgIGF3YWl0IHRoaXMudXNlci5fdXBkYXRlVG9rZW5zSWZOZWNlc3NhcnkoZmluYWxpemVNZmFSZXNwb25zZSk7XG4gICAgLy8gVGhlIHVzZXIgbmVlZHMgdG8gYmUgcmVsb2FkZWQgdG8gZ2V0IHRoZSBuZXcgbXVsdGktZmFjdG9yIGluZm9ybWF0aW9uXG4gICAgLy8gZnJvbSBzZXJ2ZXIuIFVTRVJfUkVMT0FERUQgZXZlbnQgd2lsbCBiZSB0cmlnZ2VyZWQgYW5kIGBlbnJvbGxlZEZhY3RvcnNgXG4gICAgLy8gd2lsbCBiZSB1cGRhdGVkLlxuICAgIHJldHVybiB0aGlzLnVzZXIucmVsb2FkKCk7XG4gIH1cblxuICBhc3luYyB1bmVucm9sbChpbmZvT3JVaWQ6IE11bHRpRmFjdG9ySW5mbyB8IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IG1mYUVucm9sbG1lbnRJZCA9XG4gICAgICB0eXBlb2YgaW5mb09yVWlkID09PSAnc3RyaW5nJyA/IGluZm9PclVpZCA6IGluZm9PclVpZC51aWQ7XG4gICAgY29uc3QgaWRUb2tlbiA9IGF3YWl0IHRoaXMudXNlci5nZXRJZFRva2VuKCk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGlkVG9rZW5SZXNwb25zZSA9IGF3YWl0IF9sb2dvdXRJZkludmFsaWRhdGVkKFxuICAgICAgICB0aGlzLnVzZXIsXG4gICAgICAgIHdpdGhkcmF3TWZhKHRoaXMudXNlci5hdXRoLCB7XG4gICAgICAgICAgaWRUb2tlbixcbiAgICAgICAgICBtZmFFbnJvbGxtZW50SWRcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICAvLyBSZW1vdmUgdGhlIHNlY29uZCBmYWN0b3IgZnJvbSB0aGUgdXNlcidzIGxpc3QuXG4gICAgICB0aGlzLmVucm9sbGVkRmFjdG9ycyA9IHRoaXMuZW5yb2xsZWRGYWN0b3JzLmZpbHRlcihcbiAgICAgICAgKHsgdWlkIH0pID0+IHVpZCAhPT0gbWZhRW5yb2xsbWVudElkXG4gICAgICApO1xuICAgICAgLy8gRGVwZW5kaW5nIG9uIHdoZXRoZXIgdGhlIGJhY2tlbmQgZGVjaWRlZCB0byByZXZva2UgdGhlIHVzZXIncyBzZXNzaW9uLFxuICAgICAgLy8gdGhlIHRva2VuUmVzcG9uc2UgbWF5IGJlIGVtcHR5LiBJZiB0aGUgdG9rZW5zIHdlcmUgbm90IHVwZGF0ZWQgKGFuZCB0aGV5XG4gICAgICAvLyBhcmUgbm93IGludmFsaWQpLCByZWxvYWRpbmcgdGhlIHVzZXIgd2lsbCBkaXNjb3ZlciB0aGlzIGFuZCBpbnZhbGlkYXRlXG4gICAgICAvLyB0aGUgdXNlcidzIHN0YXRlIGFjY29yZGluZ2x5LlxuICAgICAgYXdhaXQgdGhpcy51c2VyLl91cGRhdGVUb2tlbnNJZk5lY2Vzc2FyeShpZFRva2VuUmVzcG9uc2UpO1xuICAgICAgYXdhaXQgdGhpcy51c2VyLnJlbG9hZCgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9XG59XG5cbmNvbnN0IG11bHRpRmFjdG9yVXNlckNhY2hlID0gbmV3IFdlYWtNYXA8VXNlciwgTXVsdGlGYWN0b3JVc2VyPigpO1xuXG4vKipcbiAqIFRoZSB7QGxpbmsgTXVsdGlGYWN0b3JVc2VyfSBjb3JyZXNwb25kaW5nIHRvIHRoZSB1c2VyLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIGlzIHVzZWQgdG8gYWNjZXNzIGFsbCBtdWx0aS1mYWN0b3IgcHJvcGVydGllcyBhbmQgb3BlcmF0aW9ucyByZWxhdGVkIHRvIHRoZSB1c2VyLlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gbXVsdGlGYWN0b3IodXNlcjogVXNlcik6IE11bHRpRmFjdG9yVXNlciB7XG4gIGNvbnN0IHVzZXJNb2R1bGFyID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpO1xuICBpZiAoIW11bHRpRmFjdG9yVXNlckNhY2hlLmhhcyh1c2VyTW9kdWxhcikpIHtcbiAgICBtdWx0aUZhY3RvclVzZXJDYWNoZS5zZXQoXG4gICAgICB1c2VyTW9kdWxhcixcbiAgICAgIE11bHRpRmFjdG9yVXNlckltcGwuX2Zyb21Vc2VyKHVzZXJNb2R1bGFyIGFzIFVzZXJJbnRlcm5hbClcbiAgICApO1xuICB9XG4gIHJldHVybiBtdWx0aUZhY3RvclVzZXJDYWNoZS5nZXQodXNlck1vZHVsYXIpITtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgUGVyc2lzdGVuY2UgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5leHBvcnQgY29uc3QgZW51bSBQZXJzaXN0ZW5jZVR5cGUge1xuICBTRVNTSU9OID0gJ1NFU1NJT04nLFxuICBMT0NBTCA9ICdMT0NBTCcsXG4gIE5PTkUgPSAnTk9ORSdcbn1cblxuZXhwb3J0IHR5cGUgUGVyc2lzdGVkQmxvYiA9IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuXG5leHBvcnQgaW50ZXJmYWNlIEluc3RhbnRpYXRvcjxUPiB7XG4gIChibG9iOiBQZXJzaXN0ZWRCbG9iKTogVDtcbn1cblxuZXhwb3J0IHR5cGUgUGVyc2lzdGVuY2VWYWx1ZSA9IFBlcnNpc3RlZEJsb2IgfCBzdHJpbmc7XG5cbmV4cG9ydCBjb25zdCBTVE9SQUdFX0FWQUlMQUJMRV9LRVkgPSAnX19zYWsnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN0b3JhZ2VFdmVudExpc3RlbmVyIHtcbiAgKHZhbHVlOiBQZXJzaXN0ZW5jZVZhbHVlIHwgbnVsbCk6IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGVyc2lzdGVuY2VJbnRlcm5hbCBleHRlbmRzIFBlcnNpc3RlbmNlIHtcbiAgdHlwZTogUGVyc2lzdGVuY2VUeXBlO1xuICBfaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPjtcbiAgX3NldChrZXk6IHN0cmluZywgdmFsdWU6IFBlcnNpc3RlbmNlVmFsdWUpOiBQcm9taXNlPHZvaWQ+O1xuICBfZ2V0PFQgZXh0ZW5kcyBQZXJzaXN0ZW5jZVZhbHVlPihrZXk6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+O1xuICBfcmVtb3ZlKGtleTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPjtcbiAgX2FkZExpc3RlbmVyKGtleTogc3RyaW5nLCBsaXN0ZW5lcjogU3RvcmFnZUV2ZW50TGlzdGVuZXIpOiB2b2lkO1xuICBfcmVtb3ZlTGlzdGVuZXIoa2V5OiBzdHJpbmcsIGxpc3RlbmVyOiBTdG9yYWdlRXZlbnRMaXN0ZW5lcik6IHZvaWQ7XG4gIC8vIFNob3VsZCB0aGlzIHBlcnNpc3RlbmNlIGFsbG93IG1pZ3JhdGlvbiB1cCB0aGUgY2hvc2VuIGhpZXJhcmNoeT9cbiAgX3Nob3VsZEFsbG93TWlncmF0aW9uPzogYm9vbGVhbjtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBQZXJzaXN0ZW5jZVZhbHVlLFxuICBTVE9SQUdFX0FWQUlMQUJMRV9LRVksXG4gIFBlcnNpc3RlbmNlVHlwZVxufSBmcm9tICcuLi8uLi9jb3JlL3BlcnNpc3RlbmNlJztcblxuLy8gVGhlcmUgYXJlIHR3byBkaWZmZXJlbnQgYnJvd3NlciBwZXJzaXN0ZW5jZSB0eXBlczogbG9jYWwgYW5kIHNlc3Npb24uXG4vLyBCb3RoIGhhdmUgdGhlIHNhbWUgaW1wbGVtZW50YXRpb24gYnV0IHVzZSBhIGRpZmZlcmVudCB1bmRlcmx5aW5nIHN0b3JhZ2Vcbi8vIG9iamVjdC5cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJyb3dzZXJQZXJzaXN0ZW5jZUNsYXNzIHtcbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKFxuICAgIHByb3RlY3RlZCByZWFkb25seSBzdG9yYWdlUmV0cmlldmVyOiAoKSA9PiBTdG9yYWdlLFxuICAgIHJlYWRvbmx5IHR5cGU6IFBlcnNpc3RlbmNlVHlwZVxuICApIHt9XG5cbiAgX2lzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoIXRoaXMuc3RvcmFnZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKFNUT1JBR0VfQVZBSUxBQkxFX0tFWSwgJzEnKTtcbiAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKFNUT1JBR0VfQVZBSUxBQkxFX0tFWSk7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRydWUpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgX3NldChrZXk6IHN0cmluZywgdmFsdWU6IFBlcnNpc3RlbmNlVmFsdWUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9XG5cbiAgX2dldDxUIGV4dGVuZHMgUGVyc2lzdGVuY2VWYWx1ZT4oa2V5OiBzdHJpbmcpOiBQcm9taXNlPFQgfCBudWxsPiB7XG4gICAgY29uc3QganNvbiA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShqc29uID8gSlNPTi5wYXJzZShqc29uKSA6IG51bGwpO1xuICB9XG5cbiAgX3JlbW92ZShrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldCBzdG9yYWdlKCk6IFN0b3JhZ2Uge1xuICAgIHJldHVybiB0aGlzLnN0b3JhZ2VSZXRyaWV2ZXIoKTtcbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFBlcnNpc3RlbmNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHsgZ2V0VUEgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQge1xuICBfaXNTYWZhcmksXG4gIF9pc0lPUyxcbiAgX2lzSWZyYW1lLFxuICBfaXNNb2JpbGVCcm93c2VyLFxuICBfaXNJRTEwXG59IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9icm93c2VyJztcbmltcG9ydCB7XG4gIFBlcnNpc3RlbmNlSW50ZXJuYWwgYXMgSW50ZXJuYWxQZXJzaXN0ZW5jZSxcbiAgUGVyc2lzdGVuY2VUeXBlLFxuICBQZXJzaXN0ZW5jZVZhbHVlLFxuICBTdG9yYWdlRXZlbnRMaXN0ZW5lclxufSBmcm9tICcuLi8uLi9jb3JlL3BlcnNpc3RlbmNlJztcbmltcG9ydCB7IEJyb3dzZXJQZXJzaXN0ZW5jZUNsYXNzIH0gZnJvbSAnLi9icm93c2VyJztcblxuZnVuY3Rpb24gX2lmcmFtZUNhbm5vdFN5bmNXZWJTdG9yYWdlKCk6IGJvb2xlYW4ge1xuICBjb25zdCB1YSA9IGdldFVBKCk7XG4gIHJldHVybiBfaXNTYWZhcmkodWEpIHx8IF9pc0lPUyh1YSk7XG59XG5cbi8vIFRoZSBwb2xsaW5nIHBlcmlvZCBpbiBjYXNlIGV2ZW50cyBhcmUgbm90IHN1cHBvcnRlZFxuZXhwb3J0IGNvbnN0IF9QT0xMSU5HX0lOVEVSVkFMX01TID0gMTAwMDtcblxuLy8gVGhlIElFIDEwIGxvY2FsU3RvcmFnZSBjcm9zcyB0YWIgc3luY2hyb25pemF0aW9uIGRlbGF5IGluIG1pbGxpc2Vjb25kc1xuY29uc3QgSUUxMF9MT0NBTF9TVE9SQUdFX1NZTkNfREVMQVkgPSAxMDtcblxuY2xhc3MgQnJvd3NlckxvY2FsUGVyc2lzdGVuY2VcbiAgZXh0ZW5kcyBCcm93c2VyUGVyc2lzdGVuY2VDbGFzc1xuICBpbXBsZW1lbnRzIEludGVybmFsUGVyc2lzdGVuY2VcbntcbiAgc3RhdGljIHR5cGU6ICdMT0NBTCcgPSAnTE9DQUwnO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCgpID0+IHdpbmRvdy5sb2NhbFN0b3JhZ2UsIFBlcnNpc3RlbmNlVHlwZS5MT0NBTCk7XG4gIH1cblxuICBwcml2YXRlIHJlYWRvbmx5IGJvdW5kRXZlbnRIYW5kbGVyID0gKFxuICAgIGV2ZW50OiBTdG9yYWdlRXZlbnQsXG4gICAgcG9sbD86IGJvb2xlYW5cbiAgKTogdm9pZCA9PiB0aGlzLm9uU3RvcmFnZUV2ZW50KGV2ZW50LCBwb2xsKTtcbiAgcHJpdmF0ZSByZWFkb25seSBsaXN0ZW5lcnM6IFJlY29yZDxzdHJpbmcsIFNldDxTdG9yYWdlRXZlbnRMaXN0ZW5lcj4+ID0ge307XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9jYWxDYWNoZTogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgbnVsbD4gPSB7fTtcbiAgLy8gc2V0VGltZW91dCByZXR1cm4gdmFsdWUgaXMgcGxhdGZvcm0gc3BlY2lmaWNcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgcHJpdmF0ZSBwb2xsVGltZXI6IGFueSB8IG51bGwgPSBudWxsO1xuXG4gIC8vIFNhZmFyaSBvciBpT1MgYnJvd3NlciBhbmQgZW1iZWRkZWQgaW4gYW4gaWZyYW1lLlxuICBwcml2YXRlIHJlYWRvbmx5IHNhZmFyaUxvY2FsU3RvcmFnZU5vdFN5bmNlZCA9XG4gICAgX2lmcmFtZUNhbm5vdFN5bmNXZWJTdG9yYWdlKCkgJiYgX2lzSWZyYW1lKCk7XG4gIC8vIFdoZXRoZXIgdG8gdXNlIHBvbGxpbmcgaW5zdGVhZCBvZiBkZXBlbmRpbmcgb24gd2luZG93IGV2ZW50c1xuICBwcml2YXRlIHJlYWRvbmx5IGZhbGxiYWNrVG9Qb2xsaW5nID0gX2lzTW9iaWxlQnJvd3NlcigpO1xuICByZWFkb25seSBfc2hvdWxkQWxsb3dNaWdyYXRpb24gPSB0cnVlO1xuXG4gIHByaXZhdGUgZm9yQWxsQ2hhbmdlZEtleXMoXG4gICAgY2I6IChrZXk6IHN0cmluZywgb2xkVmFsdWU6IHN0cmluZyB8IG51bGwsIG5ld1ZhbHVlOiBzdHJpbmcgfCBudWxsKSA9PiB2b2lkXG4gICk6IHZvaWQge1xuICAgIC8vIENoZWNrIGFsbCBrZXlzIHdpdGggbGlzdGVuZXJzIG9uIHRoZW0uXG4gICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpKSB7XG4gICAgICAvLyBHZXQgdmFsdWUgZnJvbSBsb2NhbFN0b3JhZ2UuXG4gICAgICBjb25zdCBuZXdWYWx1ZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XG4gICAgICBjb25zdCBvbGRWYWx1ZSA9IHRoaXMubG9jYWxDYWNoZVtrZXldO1xuICAgICAgLy8gSWYgbG9jYWwgbWFwIHZhbHVlIGRvZXMgbm90IG1hdGNoLCB0cmlnZ2VyIGxpc3RlbmVyIHdpdGggc3RvcmFnZSBldmVudC5cbiAgICAgIC8vIERpZmZlcmVudGlhdGUgdGhpcyBzaW11bGF0ZWQgZXZlbnQgZnJvbSB0aGUgcmVhbCBzdG9yYWdlIGV2ZW50LlxuICAgICAgaWYgKG5ld1ZhbHVlICE9PSBvbGRWYWx1ZSkge1xuICAgICAgICBjYihrZXksIG9sZFZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBvblN0b3JhZ2VFdmVudChldmVudDogU3RvcmFnZUV2ZW50LCBwb2xsID0gZmFsc2UpOiB2b2lkIHtcbiAgICAvLyBLZXkgd291bGQgYmUgbnVsbCBpbiBzb21lIHNpdHVhdGlvbnMsIGxpa2Ugd2hlbiBsb2NhbFN0b3JhZ2UgaXMgY2xlYXJlZFxuICAgIGlmICghZXZlbnQua2V5KSB7XG4gICAgICB0aGlzLmZvckFsbENoYW5nZWRLZXlzKFxuICAgICAgICAoa2V5OiBzdHJpbmcsIF9vbGRWYWx1ZTogc3RyaW5nIHwgbnVsbCwgbmV3VmFsdWU6IHN0cmluZyB8IG51bGwpID0+IHtcbiAgICAgICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycyhrZXksIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBrZXkgPSBldmVudC5rZXk7XG5cbiAgICAvLyBDaGVjayB0aGUgbWVjaGFuaXNtIGhvdyB0aGlzIGV2ZW50IHdhcyBkZXRlY3RlZC5cbiAgICAvLyBUaGUgZmlyc3QgZXZlbnQgd2lsbCBkaWN0YXRlIHRoZSBtZWNoYW5pc20gdG8gYmUgdXNlZC5cbiAgICBpZiAocG9sbCkge1xuICAgICAgLy8gRW52aXJvbm1lbnQgZGV0ZWN0cyBzdG9yYWdlIGNoYW5nZXMgdmlhIHBvbGxpbmcuXG4gICAgICAvLyBSZW1vdmUgc3RvcmFnZSBldmVudCBsaXN0ZW5lciB0byBwcmV2ZW50IHBvc3NpYmxlIGV2ZW50IGR1cGxpY2F0aW9uLlxuICAgICAgdGhpcy5kZXRhY2hMaXN0ZW5lcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBFbnZpcm9ubWVudCBkZXRlY3RzIHN0b3JhZ2UgY2hhbmdlcyB2aWEgc3RvcmFnZSBldmVudCBsaXN0ZW5lci5cbiAgICAgIC8vIFJlbW92ZSBwb2xsaW5nIGxpc3RlbmVyIHRvIHByZXZlbnQgcG9zc2libGUgZXZlbnQgZHVwbGljYXRpb24uXG4gICAgICB0aGlzLnN0b3BQb2xsaW5nKCk7XG4gICAgfVxuXG4gICAgLy8gU2FmYXJpIGVtYmVkZGVkIGlmcmFtZS4gU3RvcmFnZSBldmVudCB3aWxsIHRyaWdnZXIgd2l0aCB0aGUgZGVsdGFcbiAgICAvLyBjaGFuZ2VzIGJ1dCBubyBjaGFuZ2VzIHdpbGwgYmUgYXBwbGllZCB0byB0aGUgaWZyYW1lIGxvY2FsU3RvcmFnZS5cbiAgICBpZiAodGhpcy5zYWZhcmlMb2NhbFN0b3JhZ2VOb3RTeW5jZWQpIHtcbiAgICAgIC8vIEdldCBjdXJyZW50IGlmcmFtZSBwYWdlIHZhbHVlLlxuICAgICAgY29uc3Qgc3RvcmVkVmFsdWUgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgLy8gVmFsdWUgbm90IHN5bmNocm9uaXplZCwgc3luY2hyb25pemUgbWFudWFsbHkuXG4gICAgICBpZiAoZXZlbnQubmV3VmFsdWUgIT09IHN0b3JlZFZhbHVlKSB7XG4gICAgICAgIGlmIChldmVudC5uZXdWYWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgIC8vIFZhbHVlIGNoYW5nZWQgZnJvbSBjdXJyZW50IHZhbHVlLlxuICAgICAgICAgIHRoaXMuc3RvcmFnZS5zZXRJdGVtKGtleSwgZXZlbnQubmV3VmFsdWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEN1cnJlbnQgdmFsdWUgZGVsZXRlZC5cbiAgICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHRoaXMubG9jYWxDYWNoZVtrZXldID09PSBldmVudC5uZXdWYWx1ZSAmJiAhcG9sbCkge1xuICAgICAgICAvLyBBbHJlYWR5IGRldGVjdGVkIGFuZCBwcm9jZXNzZWQsIGRvIG5vdCB0cmlnZ2VyIGxpc3RlbmVycyBhZ2Fpbi5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHRyaWdnZXJMaXN0ZW5lcnMgPSAoKTogdm9pZCA9PiB7XG4gICAgICAvLyBLZWVwIGxvY2FsIG1hcCB1cCB0byBkYXRlIGluIGNhc2Ugc3RvcmFnZSBldmVudCBpcyB0cmlnZ2VyZWQgYmVmb3JlXG4gICAgICAvLyBwb2xsLlxuICAgICAgY29uc3Qgc3RvcmVkVmFsdWUgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgICAgaWYgKCFwb2xsICYmIHRoaXMubG9jYWxDYWNoZVtrZXldID09PSBzdG9yZWRWYWx1ZSkge1xuICAgICAgICAvLyBSZWFsIHN0b3JhZ2UgZXZlbnQgd2hpY2ggaGFzIGFscmVhZHkgYmVlbiBkZXRlY3RlZCwgZG8gbm90aGluZy5cbiAgICAgICAgLy8gVGhpcyBzZWVtcyB0byB0cmlnZ2VyIGluIHNvbWUgSUUgYnJvd3NlcnMgZm9yIHNvbWUgcmVhc29uLlxuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLm5vdGlmeUxpc3RlbmVycyhrZXksIHN0b3JlZFZhbHVlKTtcbiAgICB9O1xuXG4gICAgY29uc3Qgc3RvcmVkVmFsdWUgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgIGlmIChcbiAgICAgIF9pc0lFMTAoKSAmJlxuICAgICAgc3RvcmVkVmFsdWUgIT09IGV2ZW50Lm5ld1ZhbHVlICYmXG4gICAgICBldmVudC5uZXdWYWx1ZSAhPT0gZXZlbnQub2xkVmFsdWVcbiAgICApIHtcbiAgICAgIC8vIElFIDEwIGhhcyB0aGlzIHdlaXJkIGJ1ZyB3aGVyZSBhIHN0b3JhZ2UgZXZlbnQgd291bGQgdHJpZ2dlciB3aXRoIHRoZVxuICAgICAgLy8gY29ycmVjdCBrZXksIG9sZFZhbHVlIGFuZCBuZXdWYWx1ZSBidXQgbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KSBkb2VzXG4gICAgICAvLyBub3QgeWllbGQgdGhlIHVwZGF0ZWQgdmFsdWUgdW50aWwgYSBmZXcgbWlsbGlzZWNvbmRzLiBUaGlzIGVuc3VyZXNcbiAgICAgIC8vIHRoaXMgcmVjb3ZlcnMgZnJvbSB0aGF0IHNpdHVhdGlvbi5cbiAgICAgIHNldFRpbWVvdXQodHJpZ2dlckxpc3RlbmVycywgSUUxMF9MT0NBTF9TVE9SQUdFX1NZTkNfREVMQVkpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0cmlnZ2VyTGlzdGVuZXJzKCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBub3RpZnlMaXN0ZW5lcnMoa2V5OiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCBudWxsKTogdm9pZCB7XG4gICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSB2YWx1ZTtcbiAgICBjb25zdCBsaXN0ZW5lcnMgPSB0aGlzLmxpc3RlbmVyc1trZXldO1xuICAgIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgQXJyYXkuZnJvbShsaXN0ZW5lcnMpKSB7XG4gICAgICAgIGxpc3RlbmVyKHZhbHVlID8gSlNPTi5wYXJzZSh2YWx1ZSkgOiB2YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdGFydFBvbGxpbmcoKTogdm9pZCB7XG4gICAgdGhpcy5zdG9wUG9sbGluZygpO1xuXG4gICAgdGhpcy5wb2xsVGltZXIgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICB0aGlzLmZvckFsbENoYW5nZWRLZXlzKFxuICAgICAgICAoa2V5OiBzdHJpbmcsIG9sZFZhbHVlOiBzdHJpbmcgfCBudWxsLCBuZXdWYWx1ZTogc3RyaW5nIHwgbnVsbCkgPT4ge1xuICAgICAgICAgIHRoaXMub25TdG9yYWdlRXZlbnQoXG4gICAgICAgICAgICBuZXcgU3RvcmFnZUV2ZW50KCdzdG9yYWdlJywge1xuICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgIG9sZFZhbHVlLFxuICAgICAgICAgICAgICBuZXdWYWx1ZVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAvKiBwb2xsICovIHRydWVcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICApO1xuICAgIH0sIF9QT0xMSU5HX0lOVEVSVkFMX01TKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RvcFBvbGxpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMucG9sbFRpbWVyKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMucG9sbFRpbWVyKTtcbiAgICAgIHRoaXMucG9sbFRpbWVyID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGF0dGFjaExpc3RlbmVyKCk6IHZvaWQge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XG4gIH1cblxuICBwcml2YXRlIGRldGFjaExpc3RlbmVyKCk6IHZvaWQge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XG4gIH1cblxuICBfYWRkTGlzdGVuZXIoa2V5OiBzdHJpbmcsIGxpc3RlbmVyOiBTdG9yYWdlRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmxpc3RlbmVycykubGVuZ3RoID09PSAwKSB7XG4gICAgICAvLyBXaGV0aGVyIGJyb3dzZXIgY2FuIGRldGVjdCBzdG9yYWdlIGV2ZW50IHdoZW4gaXQgaGFkIGFscmVhZHkgYmVlbiBwdXNoZWQgdG8gdGhlIGJhY2tncm91bmQuXG4gICAgICAvLyBUaGlzIG1heSBoYXBwZW4gaW4gc29tZSBtb2JpbGUgYnJvd3NlcnMuIEEgbG9jYWxTdG9yYWdlIGNoYW5nZSBpbiB0aGUgZm9yZWdyb3VuZCB3aW5kb3dcbiAgICAgIC8vIHdpbGwgbm90IGJlIGRldGVjdGVkIGluIHRoZSBiYWNrZ3JvdW5kIHdpbmRvdyB2aWEgdGhlIHN0b3JhZ2UgZXZlbnQuXG4gICAgICAvLyBUaGlzIHdhcyBkZXRlY3RlZCBpbiBpT1MgNy54IG1vYmlsZSBicm93c2Vyc1xuICAgICAgaWYgKHRoaXMuZmFsbGJhY2tUb1BvbGxpbmcpIHtcbiAgICAgICAgdGhpcy5zdGFydFBvbGxpbmcoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYXR0YWNoTGlzdGVuZXIoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKCF0aGlzLmxpc3RlbmVyc1trZXldKSB7XG4gICAgICB0aGlzLmxpc3RlbmVyc1trZXldID0gbmV3IFNldCgpO1xuICAgICAgLy8gUG9wdWxhdGUgdGhlIGNhY2hlIHRvIGF2b2lkIHNwdXJpb3VzbHkgdHJpZ2dlcmluZyBvbiBmaXJzdCBwb2xsLlxuICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShrZXkpO1xuICAgIH1cbiAgICB0aGlzLmxpc3RlbmVyc1trZXldLmFkZChsaXN0ZW5lcik7XG4gIH1cblxuICBfcmVtb3ZlTGlzdGVuZXIoa2V5OiBzdHJpbmcsIGxpc3RlbmVyOiBTdG9yYWdlRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuICAgIGlmICh0aGlzLmxpc3RlbmVyc1trZXldKSB7XG4gICAgICB0aGlzLmxpc3RlbmVyc1trZXldLmRlbGV0ZShsaXN0ZW5lcik7XG5cbiAgICAgIGlmICh0aGlzLmxpc3RlbmVyc1trZXldLnNpemUgPT09IDApIHtcbiAgICAgICAgZGVsZXRlIHRoaXMubGlzdGVuZXJzW2tleV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuZGV0YWNoTGlzdGVuZXIoKTtcbiAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcbiAgICB9XG4gIH1cblxuICAvLyBVcGRhdGUgbG9jYWwgY2FjaGUgb24gYmFzZSBvcGVyYXRpb25zOlxuXG4gIGFzeW5jIF9zZXQoa2V5OiBzdHJpbmcsIHZhbHVlOiBQZXJzaXN0ZW5jZVZhbHVlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgYXdhaXQgc3VwZXIuX3NldChrZXksIHZhbHVlKTtcbiAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgfVxuXG4gIGFzeW5jIF9nZXQ8VCBleHRlbmRzIFBlcnNpc3RlbmNlVmFsdWU+KGtleTogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICAgIGNvbnN0IHZhbHVlID0gYXdhaXQgc3VwZXIuX2dldDxUPihrZXkpO1xuICAgIHRoaXMubG9jYWxDYWNoZVtrZXldID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIGFzeW5jIF9yZW1vdmUoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCBzdXBlci5fcmVtb3ZlKGtleSk7XG4gICAgZGVsZXRlIHRoaXMubG9jYWxDYWNoZVtrZXldO1xuICB9XG59XG5cbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBlcnNpc3RlbmNlfSBvZiB0eXBlIGBMT0NBTGAgdXNpbmcgYGxvY2FsU3RvcmFnZWBcbiAqIGZvciB0aGUgdW5kZXJseWluZyBzdG9yYWdlLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IGJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlOiBQZXJzaXN0ZW5jZSA9IEJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlO1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFBlcnNpc3RlbmNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHtcbiAgUGVyc2lzdGVuY2VJbnRlcm5hbCBhcyBJbnRlcm5hbFBlcnNpc3RlbmNlLFxuICBQZXJzaXN0ZW5jZVR5cGUsXG4gIFN0b3JhZ2VFdmVudExpc3RlbmVyXG59IGZyb20gJy4uLy4uL2NvcmUvcGVyc2lzdGVuY2UnO1xuaW1wb3J0IHsgQnJvd3NlclBlcnNpc3RlbmNlQ2xhc3MgfSBmcm9tICcuL2Jyb3dzZXInO1xuXG5jbGFzcyBCcm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlXG4gIGV4dGVuZHMgQnJvd3NlclBlcnNpc3RlbmNlQ2xhc3NcbiAgaW1wbGVtZW50cyBJbnRlcm5hbFBlcnNpc3RlbmNlXG57XG4gIHN0YXRpYyB0eXBlOiAnU0VTU0lPTicgPSAnU0VTU0lPTic7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKCkgPT4gd2luZG93LnNlc3Npb25TdG9yYWdlLCBQZXJzaXN0ZW5jZVR5cGUuU0VTU0lPTik7XG4gIH1cblxuICBfYWRkTGlzdGVuZXIoX2tleTogc3RyaW5nLCBfbGlzdGVuZXI6IFN0b3JhZ2VFdmVudExpc3RlbmVyKTogdm9pZCB7XG4gICAgLy8gTGlzdGVuZXJzIGFyZSBub3Qgc3VwcG9ydGVkIGZvciBzZXNzaW9uIHN0b3JhZ2Ugc2luY2UgaXQgY2Fubm90IGJlIHNoYXJlZCBhY3Jvc3Mgd2luZG93c1xuICAgIHJldHVybjtcbiAgfVxuXG4gIF9yZW1vdmVMaXN0ZW5lcihfa2V5OiBzdHJpbmcsIF9saXN0ZW5lcjogU3RvcmFnZUV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcbiAgICAvLyBMaXN0ZW5lcnMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIHNlc3Npb24gc3RvcmFnZSBzaW5jZSBpdCBjYW5ub3QgYmUgc2hhcmVkIGFjcm9zcyB3aW5kb3dzXG4gICAgcmV0dXJuO1xuICB9XG59XG5cbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2Yge0BsaW5rIFBlcnNpc3RlbmNlfSBvZiBgU0VTU0lPTmAgdXNpbmcgYHNlc3Npb25TdG9yYWdlYFxuICogZm9yIHRoZSB1bmRlcmx5aW5nIHN0b3JhZ2UuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZTogUGVyc2lzdGVuY2UgPSBCcm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlO1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKiBUT0RPOiByZW1vdmUgdGhpcyBvbmNlIHRzbGliIGhhcyBhIHBvbHlmaWxsIGZvciBQcm9taXNlLmFsbFNldHRsZWQgKi9cbmludGVyZmFjZSBQcm9taXNlRnVsZmlsbGVkUmVzdWx0PFQ+IHtcbiAgZnVsZmlsbGVkOiB0cnVlO1xuICB2YWx1ZTogVDtcbn1cblxuaW50ZXJmYWNlIFByb21pc2VSZWplY3RlZFJlc3VsdCB7XG4gIGZ1bGZpbGxlZDogZmFsc2U7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIHJlYXNvbjogYW55O1xufVxuXG5leHBvcnQgdHlwZSBQcm9taXNlU2V0dGxlZFJlc3VsdDxUPiA9XG4gIHwgUHJvbWlzZUZ1bGZpbGxlZFJlc3VsdDxUPlxuICB8IFByb21pc2VSZWplY3RlZFJlc3VsdDtcblxuLyoqXG4gKiBTaGltIGZvciBQcm9taXNlLmFsbFNldHRsZWQsIG5vdGUgdGhlIHNsaWdodGx5IGRpZmZlcmVudCBmb3JtYXQgb2YgYGZ1bGZpbGxlZGAgdnMgYHN0YXR1c2AuXG4gKlxuICogQHBhcmFtIHByb21pc2VzIC0gQXJyYXkgb2YgcHJvbWlzZXMgdG8gd2FpdCBvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9hbGxTZXR0bGVkPFQ+KFxuICBwcm9taXNlczogQXJyYXk8UHJvbWlzZTxUPj5cbik6IFByb21pc2U8QXJyYXk8UHJvbWlzZVNldHRsZWRSZXN1bHQ8VD4+PiB7XG4gIHJldHVybiBQcm9taXNlLmFsbChcbiAgICBwcm9taXNlcy5tYXAoYXN5bmMgcHJvbWlzZSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGF3YWl0IHByb21pc2U7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZnVsZmlsbGVkOiB0cnVlLFxuICAgICAgICAgIHZhbHVlXG4gICAgICAgIH0gYXMgUHJvbWlzZUZ1bGZpbGxlZFJlc3VsdDxUPjtcbiAgICAgIH0gY2F0Y2ggKHJlYXNvbikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZ1bGZpbGxlZDogZmFsc2UsXG4gICAgICAgICAgcmVhc29uXG4gICAgICAgIH0gYXMgUHJvbWlzZVJlamVjdGVkUmVzdWx0O1xuICAgICAgfVxuICAgIH0pXG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgUmVjZWl2ZXJIYW5kbGVyLFxuICBfRXZlbnRUeXBlLFxuICBfUmVjZWl2ZXJSZXNwb25zZSxcbiAgU2VuZGVyTWVzc2FnZUV2ZW50LFxuICBfU3RhdHVzLFxuICBfU2VuZGVyUmVxdWVzdFxufSBmcm9tICcuL2luZGV4JztcbmltcG9ydCB7IF9hbGxTZXR0bGVkIH0gZnJvbSAnLi9wcm9taXNlJztcblxuLyoqXG4gKiBJbnRlcmZhY2UgY2xhc3MgZm9yIHJlY2VpdmluZyBtZXNzYWdlcy5cbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBSZWNlaXZlciB7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IHJlY2VpdmVyczogUmVjZWl2ZXJbXSA9IFtdO1xuICBwcml2YXRlIHJlYWRvbmx5IGJvdW5kRXZlbnRIYW5kbGVyOiBFdmVudExpc3RlbmVyO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgaGFuZGxlcnNNYXA6IHtcbiAgICAvLyBUeXBlc2NyaXB0IGRvZXNuJ3QgaGF2ZSBleGlzdGVudGlhbCB0eXBlcyA6KFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgW2V2ZW50VHlwZTogc3RyaW5nXTogU2V0PFJlY2VpdmVySGFuZGxlcjxhbnksIGFueT4+O1xuICB9ID0ge307XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBldmVudFRhcmdldDogRXZlbnRUYXJnZXQpIHtcbiAgICB0aGlzLmJvdW5kRXZlbnRIYW5kbGVyID0gdGhpcy5oYW5kbGVFdmVudC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9idGFpbiBhbiBpbnN0YW5jZSBvZiBhIFJlY2VpdmVyIGZvciBhIGdpdmVuIGV2ZW50IHRhcmdldCwgaWYgbm9uZSBleGlzdHMgaXQgd2lsbCBiZSBjcmVhdGVkLlxuICAgKlxuICAgKiBAcGFyYW0gZXZlbnRUYXJnZXQgLSBBbiBldmVudCB0YXJnZXQgKHN1Y2ggYXMgd2luZG93IG9yIHNlbGYpIHRocm91Z2ggd2hpY2ggdGhlIHVuZGVybHlpbmdcbiAgICogbWVzc2FnZXMgd2lsbCBiZSByZWNlaXZlZC5cbiAgICovXG4gIHN0YXRpYyBfZ2V0SW5zdGFuY2UoZXZlbnRUYXJnZXQ6IEV2ZW50VGFyZ2V0KTogUmVjZWl2ZXIge1xuICAgIC8vIFRoZSByZXN1bHRzIGFyZSBzdG9yZWQgaW4gYW4gYXJyYXkgc2luY2Ugb2JqZWN0cyBjYW4ndCBiZSBrZXlzIGZvciBvdGhlclxuICAgIC8vIG9iamVjdHMuIEluIGFkZGl0aW9uLCBzZXR0aW5nIGEgdW5pcXVlIHByb3BlcnR5IG9uIGFuIGV2ZW50IHRhcmdldCBhcyBhXG4gICAgLy8gaGFzaCBtYXAga2V5IG1heSBub3QgYmUgYWxsb3dlZCBkdWUgdG8gQ09SUyByZXN0cmljdGlvbnMuXG4gICAgY29uc3QgZXhpc3RpbmdJbnN0YW5jZSA9IHRoaXMucmVjZWl2ZXJzLmZpbmQocmVjZWl2ZXIgPT5cbiAgICAgIHJlY2VpdmVyLmlzTGlzdGVuaW5ndG8oZXZlbnRUYXJnZXQpXG4gICAgKTtcbiAgICBpZiAoZXhpc3RpbmdJbnN0YW5jZSkge1xuICAgICAgcmV0dXJuIGV4aXN0aW5nSW5zdGFuY2U7XG4gICAgfVxuICAgIGNvbnN0IG5ld0luc3RhbmNlID0gbmV3IFJlY2VpdmVyKGV2ZW50VGFyZ2V0KTtcbiAgICB0aGlzLnJlY2VpdmVycy5wdXNoKG5ld0luc3RhbmNlKTtcbiAgICByZXR1cm4gbmV3SW5zdGFuY2U7XG4gIH1cblxuICBwcml2YXRlIGlzTGlzdGVuaW5ndG8oZXZlbnRUYXJnZXQ6IEV2ZW50VGFyZ2V0KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZXZlbnRUYXJnZXQgPT09IGV2ZW50VGFyZ2V0O1xuICB9XG5cbiAgLyoqXG4gICAqIEZhbnMgb3V0IGEgTWVzc2FnZUV2ZW50IHRvIHRoZSBhcHByb3ByaWF0ZSBsaXN0ZW5lcnMuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIFNlbmRzIGFuIHtAbGluayBTdGF0dXMuQUNLfSB1cG9uIHJlY2VpcHQgYW5kIGEge0BsaW5rIFN0YXR1cy5ET05FfSBvbmNlIGFsbCBoYW5kbGVycyBoYXZlXG4gICAqIGZpbmlzaGVkIHByb2Nlc3NpbmcuXG4gICAqXG4gICAqIEBwYXJhbSBldmVudCAtIFRoZSBNZXNzYWdlRXZlbnQuXG4gICAqXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGhhbmRsZUV2ZW50PFxuICAgIFQgZXh0ZW5kcyBfUmVjZWl2ZXJSZXNwb25zZSxcbiAgICBTIGV4dGVuZHMgX1NlbmRlclJlcXVlc3RcbiAgPihldmVudDogRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBtZXNzYWdlRXZlbnQgPSBldmVudCBhcyBNZXNzYWdlRXZlbnQ8U2VuZGVyTWVzc2FnZUV2ZW50PFM+PjtcbiAgICBjb25zdCB7IGV2ZW50SWQsIGV2ZW50VHlwZSwgZGF0YSB9ID0gbWVzc2FnZUV2ZW50LmRhdGE7XG5cbiAgICBjb25zdCBoYW5kbGVyczogU2V0PFJlY2VpdmVySGFuZGxlcjxULCBTPj4gfCB1bmRlZmluZWQgPVxuICAgICAgdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdO1xuICAgIGlmICghaGFuZGxlcnM/LnNpemUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBtZXNzYWdlRXZlbnQucG9ydHNbMF0ucG9zdE1lc3NhZ2Uoe1xuICAgICAgc3RhdHVzOiBfU3RhdHVzLkFDSyxcbiAgICAgIGV2ZW50SWQsXG4gICAgICBldmVudFR5cGVcbiAgICB9KTtcblxuICAgIGNvbnN0IHByb21pc2VzID0gQXJyYXkuZnJvbShoYW5kbGVycykubWFwKGFzeW5jIGhhbmRsZXIgPT5cbiAgICAgIGhhbmRsZXIobWVzc2FnZUV2ZW50Lm9yaWdpbiwgZGF0YSlcbiAgICApO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgX2FsbFNldHRsZWQocHJvbWlzZXMpO1xuICAgIG1lc3NhZ2VFdmVudC5wb3J0c1swXS5wb3N0TWVzc2FnZSh7XG4gICAgICBzdGF0dXM6IF9TdGF0dXMuRE9ORSxcbiAgICAgIGV2ZW50SWQsXG4gICAgICBldmVudFR5cGUsXG4gICAgICByZXNwb25zZVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFN1YnNjcmliZSBhbiBldmVudCBoYW5kbGVyIGZvciBhIHBhcnRpY3VsYXIgZXZlbnQuXG4gICAqXG4gICAqIEBwYXJhbSBldmVudFR5cGUgLSBFdmVudCBuYW1lIHRvIHN1YnNjcmliZSB0by5cbiAgICogQHBhcmFtIGV2ZW50SGFuZGxlciAtIFRoZSBldmVudCBoYW5kbGVyIHdoaWNoIHNob3VsZCByZWNlaXZlIHRoZSBldmVudHMuXG4gICAqXG4gICAqL1xuICBfc3Vic2NyaWJlPFQgZXh0ZW5kcyBfUmVjZWl2ZXJSZXNwb25zZSwgUyBleHRlbmRzIF9TZW5kZXJSZXF1ZXN0PihcbiAgICBldmVudFR5cGU6IF9FdmVudFR5cGUsXG4gICAgZXZlbnRIYW5kbGVyOiBSZWNlaXZlckhhbmRsZXI8VCwgUz5cbiAgKTogdm9pZCB7XG4gICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuaGFuZGxlcnNNYXApLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5ldmVudFRhcmdldC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5ib3VuZEV2ZW50SGFuZGxlcik7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0pIHtcbiAgICAgIHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXSA9IG5ldyBTZXQoKTtcbiAgICB9XG5cbiAgICB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0uYWRkKGV2ZW50SGFuZGxlcik7XG4gIH1cblxuICAvKipcbiAgICogVW5zdWJzY3JpYmUgYW4gZXZlbnQgaGFuZGxlciBmcm9tIGEgcGFydGljdWxhciBldmVudC5cbiAgICpcbiAgICogQHBhcmFtIGV2ZW50VHlwZSAtIEV2ZW50IG5hbWUgdG8gdW5zdWJzY3JpYmUgZnJvbS5cbiAgICogQHBhcmFtIGV2ZW50SGFuZGxlciAtIE9wdGlub2FsIGV2ZW50IGhhbmRsZXIsIGlmIG5vbmUgcHJvdmlkZWQsIHVuc3Vic2NyaWJlIGFsbCBoYW5kbGVycyBvbiB0aGlzIGV2ZW50LlxuICAgKlxuICAgKi9cbiAgX3Vuc3Vic2NyaWJlPFQgZXh0ZW5kcyBfUmVjZWl2ZXJSZXNwb25zZSwgUyBleHRlbmRzIF9TZW5kZXJSZXF1ZXN0PihcbiAgICBldmVudFR5cGU6IF9FdmVudFR5cGUsXG4gICAgZXZlbnRIYW5kbGVyPzogUmVjZWl2ZXJIYW5kbGVyPFQsIFM+XG4gICk6IHZvaWQge1xuICAgIGlmICh0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0gJiYgZXZlbnRIYW5kbGVyKSB7XG4gICAgICB0aGlzLmhhbmRsZXJzTWFwW2V2ZW50VHlwZV0uZGVsZXRlKGV2ZW50SGFuZGxlcik7XG4gICAgfVxuICAgIGlmICghZXZlbnRIYW5kbGVyIHx8IHRoaXMuaGFuZGxlcnNNYXBbZXZlbnRUeXBlXS5zaXplID09PSAwKSB7XG4gICAgICBkZWxldGUgdGhpcy5oYW5kbGVyc01hcFtldmVudFR5cGVdO1xuICAgIH1cblxuICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmhhbmRsZXJzTWFwKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuZXZlbnRUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuYm91bmRFdmVudEhhbmRsZXIpO1xuICAgIH1cbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBfZ2VuZXJhdGVFdmVudElkKHByZWZpeCA9ICcnLCBkaWdpdHMgPSAxMCk6IHN0cmluZyB7XG4gIGxldCByYW5kb20gPSAnJztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaWdpdHM7IGkrKykge1xuICAgIHJhbmRvbSArPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMCk7XG4gIH1cbiAgcmV0dXJuIHByZWZpeCArIHJhbmRvbTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBfZ2VuZXJhdGVFdmVudElkIH0gZnJvbSAnLi4vLi4vY29yZS91dGlsL2V2ZW50X2lkJztcbmltcG9ydCB7XG4gIF9TZW5kZXJSZXF1ZXN0LFxuICBfRXZlbnRUeXBlLFxuICBSZWNlaXZlck1lc3NhZ2VFdmVudCxcbiAgX01lc3NhZ2VFcnJvcixcbiAgU2VuZGVyTWVzc2FnZUV2ZW50LFxuICBfU3RhdHVzLFxuICBfUmVjZWl2ZXJNZXNzYWdlUmVzcG9uc2UsXG4gIF9SZWNlaXZlclJlc3BvbnNlLFxuICBfVGltZW91dER1cmF0aW9uXG59IGZyb20gJy4vaW5kZXgnO1xuXG5pbnRlcmZhY2UgTWVzc2FnZUhhbmRsZXIge1xuICBtZXNzYWdlQ2hhbm5lbDogTWVzc2FnZUNoYW5uZWw7XG4gIG9uTWVzc2FnZTogRXZlbnRMaXN0ZW5lck9yRXZlbnRMaXN0ZW5lck9iamVjdDtcbn1cblxuLyoqXG4gKiBJbnRlcmZhY2UgZm9yIHNlbmRpbmcgbWVzc2FnZXMgYW5kIHdhaXRpbmcgZm9yIGEgY29tcGxldGlvbiByZXNwb25zZS5cbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBTZW5kZXIge1xuICBwcml2YXRlIHJlYWRvbmx5IGhhbmRsZXJzID0gbmV3IFNldDxNZXNzYWdlSGFuZGxlcj4oKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IHRhcmdldDogU2VydmljZVdvcmtlcikge31cblxuICAvKipcbiAgICogVW5zdWJzY3JpYmUgdGhlIGhhbmRsZXIgYW5kIHJlbW92ZSBpdCBmcm9tIG91ciB0cmFja2luZyBTZXQuXG4gICAqXG4gICAqIEBwYXJhbSBoYW5kbGVyIC0gVGhlIGhhbmRsZXIgdG8gdW5zdWJzY3JpYmUuXG4gICAqL1xuICBwcml2YXRlIHJlbW92ZU1lc3NhZ2VIYW5kbGVyKGhhbmRsZXI6IE1lc3NhZ2VIYW5kbGVyKTogdm9pZCB7XG4gICAgaWYgKGhhbmRsZXIubWVzc2FnZUNoYW5uZWwpIHtcbiAgICAgIGhhbmRsZXIubWVzc2FnZUNoYW5uZWwucG9ydDEucmVtb3ZlRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ21lc3NhZ2UnLFxuICAgICAgICBoYW5kbGVyLm9uTWVzc2FnZVxuICAgICAgKTtcbiAgICAgIGhhbmRsZXIubWVzc2FnZUNoYW5uZWwucG9ydDEuY2xvc2UoKTtcbiAgICB9XG4gICAgdGhpcy5oYW5kbGVycy5kZWxldGUoaGFuZGxlcik7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBhIG1lc3NhZ2UgdG8gdGhlIFJlY2VpdmVyIGxvY2F0ZWQgYXQge0BsaW5rIHRhcmdldH0uXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIFdlJ2xsIGZpcnN0IHdhaXQgYSBiaXQgZm9yIGFuIEFDSyAsIGlmIHdlIGdldCBvbmUgd2Ugd2lsbCB3YWl0IHNpZ25pZmljYW50bHkgbG9uZ2VyIHVudGlsIHRoZVxuICAgKiByZWNlaXZlciBoYXMgaGFkIGEgY2hhbmNlIHRvIGZ1bGx5IHByb2Nlc3MgdGhlIGV2ZW50LlxuICAgKlxuICAgKiBAcGFyYW0gZXZlbnRUeXBlIC0gVHlwZSBvZiBldmVudCB0byBzZW5kLlxuICAgKiBAcGFyYW0gZGF0YSAtIFRoZSBwYXlsb2FkIG9mIHRoZSBldmVudC5cbiAgICogQHBhcmFtIHRpbWVvdXQgLSBUaW1lb3V0IGZvciB3YWl0aW5nIG9uIGFuIEFDSyBmcm9tIHRoZSByZWNlaXZlci5cbiAgICpcbiAgICogQHJldHVybnMgQW4gYXJyYXkgb2Ygc2V0dGxlZCBwcm9taXNlcyBmcm9tIGFsbCB0aGUgaGFuZGxlcnMgdGhhdCB3ZXJlIGxpc3RlbmluZyBvbiB0aGUgcmVjZWl2ZXIuXG4gICAqL1xuICBhc3luYyBfc2VuZDxUIGV4dGVuZHMgX1JlY2VpdmVyUmVzcG9uc2UsIFMgZXh0ZW5kcyBfU2VuZGVyUmVxdWVzdD4oXG4gICAgZXZlbnRUeXBlOiBfRXZlbnRUeXBlLFxuICAgIGRhdGE6IFMsXG4gICAgdGltZW91dCA9IF9UaW1lb3V0RHVyYXRpb24uQUNLXG4gICk6IFByb21pc2U8X1JlY2VpdmVyTWVzc2FnZVJlc3BvbnNlPFQ+PiB7XG4gICAgY29uc3QgbWVzc2FnZUNoYW5uZWwgPVxuICAgICAgdHlwZW9mIE1lc3NhZ2VDaGFubmVsICE9PSAndW5kZWZpbmVkJyA/IG5ldyBNZXNzYWdlQ2hhbm5lbCgpIDogbnVsbDtcbiAgICBpZiAoIW1lc3NhZ2VDaGFubmVsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoX01lc3NhZ2VFcnJvci5DT05ORUNUSU9OX1VOQVZBSUxBQkxFKTtcbiAgICB9XG4gICAgLy8gTm9kZSB0aW1lcnMgYW5kIGJyb3dzZXIgdGltZXJzIHJldHVybiBmdW5kYW1lbnRhbGx5IGRpZmZlcmVudCB0eXBlcy5cbiAgICAvLyBXZSBkb24ndCBhY3R1YWxseSBjYXJlIHdoYXQgdGhlIHZhbHVlIGlzIGJ1dCBUUyB3b24ndCBhY2NlcHQgdW5rbm93biBhbmRcbiAgICAvLyB3ZSBjYW4ndCBjYXN0IHByb3Blcmx5IGluIGJvdGggZW52aXJvbm1lbnRzLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgbGV0IGNvbXBsZXRpb25UaW1lcjogYW55O1xuICAgIGxldCBoYW5kbGVyOiBNZXNzYWdlSGFuZGxlcjtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8X1JlY2VpdmVyTWVzc2FnZVJlc3BvbnNlPFQ+PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCBldmVudElkID0gX2dlbmVyYXRlRXZlbnRJZCgnJywgMjApO1xuICAgICAgbWVzc2FnZUNoYW5uZWwucG9ydDEuc3RhcnQoKTtcbiAgICAgIGNvbnN0IGFja1RpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHJlamVjdChuZXcgRXJyb3IoX01lc3NhZ2VFcnJvci5VTlNVUFBPUlRFRF9FVkVOVCkpO1xuICAgICAgfSwgdGltZW91dCk7XG4gICAgICBoYW5kbGVyID0ge1xuICAgICAgICBtZXNzYWdlQ2hhbm5lbCxcbiAgICAgICAgb25NZXNzYWdlKGV2ZW50OiBFdmVudCk6IHZvaWQge1xuICAgICAgICAgIGNvbnN0IG1lc3NhZ2VFdmVudCA9IGV2ZW50IGFzIE1lc3NhZ2VFdmVudDxSZWNlaXZlck1lc3NhZ2VFdmVudDxUPj47XG4gICAgICAgICAgaWYgKG1lc3NhZ2VFdmVudC5kYXRhLmV2ZW50SWQgIT09IGV2ZW50SWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgc3dpdGNoIChtZXNzYWdlRXZlbnQuZGF0YS5zdGF0dXMpIHtcbiAgICAgICAgICAgIGNhc2UgX1N0YXR1cy5BQ0s6XG4gICAgICAgICAgICAgIC8vIFRoZSByZWNlaXZlciBzaG91bGQgQUNLIGZpcnN0LlxuICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoYWNrVGltZXIpO1xuICAgICAgICAgICAgICBjb21wbGV0aW9uVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKF9NZXNzYWdlRXJyb3IuVElNRU9VVCkpO1xuICAgICAgICAgICAgICB9LCBfVGltZW91dER1cmF0aW9uLkNPTVBMRVRJT04pO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgX1N0YXR1cy5ET05FOlxuICAgICAgICAgICAgICAvLyBPbmNlIHRoZSByZWNlaXZlcidzIGhhbmRsZXJzIGFyZSBmaW5pc2hlZCB3ZSB3aWxsIGdldCB0aGUgcmVzdWx0cy5cbiAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGNvbXBsZXRpb25UaW1lcik7XG4gICAgICAgICAgICAgIHJlc29sdmUobWVzc2FnZUV2ZW50LmRhdGEucmVzcG9uc2UpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgIGNsZWFyVGltZW91dChhY2tUaW1lcik7XG4gICAgICAgICAgICAgIGNsZWFyVGltZW91dChjb21wbGV0aW9uVGltZXIpO1xuICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKF9NZXNzYWdlRXJyb3IuSU5WQUxJRF9SRVNQT05TRSkpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB0aGlzLmhhbmRsZXJzLmFkZChoYW5kbGVyKTtcbiAgICAgIG1lc3NhZ2VDaGFubmVsLnBvcnQxLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBoYW5kbGVyLm9uTWVzc2FnZSk7XG4gICAgICB0aGlzLnRhcmdldC5wb3N0TWVzc2FnZShcbiAgICAgICAge1xuICAgICAgICAgIGV2ZW50VHlwZSxcbiAgICAgICAgICBldmVudElkLFxuICAgICAgICAgIGRhdGFcbiAgICAgICAgfSBhcyBTZW5kZXJNZXNzYWdlRXZlbnQ8Uz4sXG4gICAgICAgIFttZXNzYWdlQ2hhbm5lbC5wb3J0Ml1cbiAgICAgICk7XG4gICAgfSkuZmluYWxseSgoKSA9PiB7XG4gICAgICBpZiAoaGFuZGxlcikge1xuICAgICAgICB0aGlzLnJlbW92ZU1lc3NhZ2VIYW5kbGVyKGhhbmRsZXIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgUmVjYXB0Y2hhLCBHcmVDQVBUQ0hBVG9wTGV2ZWwgfSBmcm9tICcuL3JlY2FwdGNoYS9yZWNhcHRjaGEnO1xuXG4vKipcbiAqIEEgc3BlY2lhbGl6ZWQgd2luZG93IHR5cGUgdGhhdCBtZWxkcyB0aGUgbm9ybWFsIHdpbmRvdyB0eXBlIHBsdXMgdGhlXG4gKiB2YXJpb3VzIGJpdHMgd2UgbmVlZC4gVGhlIHRocmVlIGRpZmZlcmVudCBibG9ja3MgdGhhdCBhcmUgJidkIHRvZ2V0aGVyXG4gKiBjYW50IGJlIGRlZmluZWQgaW4gdGhlIHNhbWUgYmxvY2sgdG9nZXRoZXIuXG4gKi9cbmV4cG9ydCB0eXBlIEF1dGhXaW5kb3cgPSB7XG4gIC8vIFN0YW5kYXJkIHdpbmRvdyB0eXBlc1xuICBbVCBpbiBrZXlvZiBXaW5kb3ddOiBXaW5kb3dbVF07XG59ICYge1xuICAvLyBBbnkga25vd24gLyBuYW1lZCBwcm9wZXJ0aWVzIHdlIHdhbnQgdG8gYWRkXG4gIGdyZWNhcHRjaGE/OiBSZWNhcHRjaGEgfCBHcmVDQVBUQ0hBVG9wTGV2ZWw7XG4gIC8qIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovXG4gIF9fX2pzbD86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIGdhcGk/OiB0eXBlb2YgZ2FwaTtcbn0gJiB7XG4gIC8vIEEgZmluYWwgY2F0Y2gtYWxsIGZvciBjYWxsYmFja3MgKHdoaWNoIHdpbGwgaGF2ZSByYW5kb20gbmFtZXMpIHRoYXRcbiAgLy8gd2Ugd2lsbCBzdGljayBvbiB0aGUgd2luZG93LlxuICBbY2FsbGJhY2s6IHN0cmluZ106ICguLi5hcmdzOiB1bmtub3duW10pID0+IHZvaWQ7XG59O1xuXG4vKipcbiAqIExhenkgYWNjZXNzb3IgZm9yIHdpbmRvdywgc2luY2UgdGhlIGNvbXBhdCBsYXllciB3b24ndCB0cmVlIHNoYWtlIHRoaXMgb3V0LFxuICogd2UgbmVlZCB0byBtYWtlIHN1cmUgbm90IHRvIG1lc3Mgd2l0aCB3aW5kb3cgdW5sZXNzIHdlIGhhdmUgdG9cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF93aW5kb3coKTogQXV0aFdpbmRvdyB7XG4gIHJldHVybiB3aW5kb3cgYXMgdW5rbm93biBhcyBBdXRoV2luZG93O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX3NldFdpbmRvd0xvY2F0aW9uKHVybDogc3RyaW5nKTogdm9pZCB7XG4gIF93aW5kb3coKS5sb2NhdGlvbi5ocmVmID0gdXJsO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTEMuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBfd2luZG93IH0gZnJvbSAnLi4vYXV0aF93aW5kb3cnO1xuXG5leHBvcnQgZnVuY3Rpb24gX2lzV29ya2VyKCk6IGJvb2xlYW4ge1xuICByZXR1cm4gKFxuICAgIHR5cGVvZiBfd2luZG93KClbJ1dvcmtlckdsb2JhbFNjb3BlJ10gIT09ICd1bmRlZmluZWQnICYmXG4gICAgdHlwZW9mIF93aW5kb3coKVsnaW1wb3J0U2NyaXB0cyddID09PSAnZnVuY3Rpb24nXG4gICk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfZ2V0QWN0aXZlU2VydmljZVdvcmtlcigpOiBQcm9taXNlPFNlcnZpY2VXb3JrZXIgfCBudWxsPiB7XG4gIGlmICghbmF2aWdhdG9yPy5zZXJ2aWNlV29ya2VyKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZWdpc3RyYXRpb24gPSBhd2FpdCBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWFkeTtcbiAgICByZXR1cm4gcmVnaXN0cmF0aW9uLmFjdGl2ZTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9nZXRTZXJ2aWNlV29ya2VyQ29udHJvbGxlcigpOiBTZXJ2aWNlV29ya2VyIHwgbnVsbCB7XG4gIHJldHVybiBuYXZpZ2F0b3I/LnNlcnZpY2VXb3JrZXI/LmNvbnRyb2xsZXIgfHwgbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9nZXRXb3JrZXJHbG9iYWxTY29wZSgpOiBTZXJ2aWNlV29ya2VyIHwgbnVsbCB7XG4gIHJldHVybiBfaXNXb3JrZXIoKSA/IChzZWxmIGFzIHVua25vd24gYXMgU2VydmljZVdvcmtlcikgOiBudWxsO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFBlcnNpc3RlbmNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7XG4gIFBlcnNpc3RlZEJsb2IsXG4gIFBlcnNpc3RlbmNlSW50ZXJuYWwgYXMgSW50ZXJuYWxQZXJzaXN0ZW5jZSxcbiAgUGVyc2lzdGVuY2VUeXBlLFxuICBQZXJzaXN0ZW5jZVZhbHVlLFxuICBTdG9yYWdlRXZlbnRMaXN0ZW5lcixcbiAgU1RPUkFHRV9BVkFJTEFCTEVfS0VZXG59IGZyb20gJy4uLy4uL2NvcmUvcGVyc2lzdGVuY2UvJztcbmltcG9ydCB7XG4gIF9FdmVudFR5cGUsXG4gIF9QaW5nUmVzcG9uc2UsXG4gIEtleUNoYW5nZWRSZXNwb25zZSxcbiAgS2V5Q2hhbmdlZFJlcXVlc3QsXG4gIFBpbmdSZXF1ZXN0LFxuICBfVGltZW91dER1cmF0aW9uXG59IGZyb20gJy4uL21lc3NhZ2VjaGFubmVsL2luZGV4JztcbmltcG9ydCB7IFJlY2VpdmVyIH0gZnJvbSAnLi4vbWVzc2FnZWNoYW5uZWwvcmVjZWl2ZXInO1xuaW1wb3J0IHsgU2VuZGVyIH0gZnJvbSAnLi4vbWVzc2FnZWNoYW5uZWwvc2VuZGVyJztcbmltcG9ydCB7XG4gIF9pc1dvcmtlcixcbiAgX2dldEFjdGl2ZVNlcnZpY2VXb3JrZXIsXG4gIF9nZXRTZXJ2aWNlV29ya2VyQ29udHJvbGxlcixcbiAgX2dldFdvcmtlckdsb2JhbFNjb3BlXG59IGZyb20gJy4uL3V0aWwvd29ya2VyJztcblxuZXhwb3J0IGNvbnN0IERCX05BTUUgPSAnZmlyZWJhc2VMb2NhbFN0b3JhZ2VEYic7XG5jb25zdCBEQl9WRVJTSU9OID0gMTtcbmNvbnN0IERCX09CSkVDVFNUT1JFX05BTUUgPSAnZmlyZWJhc2VMb2NhbFN0b3JhZ2UnO1xuY29uc3QgREJfREFUQV9LRVlQQVRIID0gJ2ZiYXNlX2tleSc7XG5cbmludGVyZmFjZSBEQk9iamVjdCB7XG4gIFtEQl9EQVRBX0tFWVBBVEhdOiBzdHJpbmc7XG4gIHZhbHVlOiBQZXJzaXN0ZWRCbG9iO1xufVxuXG4vKipcbiAqIFByb21pc2Ugd3JhcHBlciBmb3IgSURCUmVxdWVzdFxuICpcbiAqIFVuZm9ydHVuYXRlbHkgd2UgY2FuJ3QgY2xlYW5seSBleHRlbmQgUHJvbWlzZTxUPiBzaW5jZSBwcm9taXNlcyBhcmUgbm90IGNhbGxhYmxlIGluIEVTNlxuICpcbiAqL1xuY2xhc3MgREJQcm9taXNlPFQ+IHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSByZXF1ZXN0OiBJREJSZXF1ZXN0KSB7fVxuXG4gIHRvUHJvbWlzZSgpOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2U8VD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgdGhpcy5yZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCAoKSA9PiB7XG4gICAgICAgIHJlc29sdmUodGhpcy5yZXF1ZXN0LnJlc3VsdCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMucmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsICgpID0+IHtcbiAgICAgICAgcmVqZWN0KHRoaXMucmVxdWVzdC5lcnJvcik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXRPYmplY3RTdG9yZShkYjogSURCRGF0YWJhc2UsIGlzUmVhZFdyaXRlOiBib29sZWFuKTogSURCT2JqZWN0U3RvcmUge1xuICByZXR1cm4gZGJcbiAgICAudHJhbnNhY3Rpb24oW0RCX09CSkVDVFNUT1JFX05BTUVdLCBpc1JlYWRXcml0ZSA/ICdyZWFkd3JpdGUnIDogJ3JlYWRvbmx5JylcbiAgICAub2JqZWN0U3RvcmUoREJfT0JKRUNUU1RPUkVfTkFNRSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfY2xlYXJEYXRhYmFzZShkYjogSURCRGF0YWJhc2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3Qgb2JqZWN0U3RvcmUgPSBnZXRPYmplY3RTdG9yZShkYiwgdHJ1ZSk7XG4gIHJldHVybiBuZXcgREJQcm9taXNlPHZvaWQ+KG9iamVjdFN0b3JlLmNsZWFyKCkpLnRvUHJvbWlzZSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2RlbGV0ZURhdGFiYXNlKCk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKERCX05BTUUpO1xuICByZXR1cm4gbmV3IERCUHJvbWlzZTx2b2lkPihyZXF1ZXN0KS50b1Byb21pc2UoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9vcGVuRGF0YWJhc2UoKTogUHJvbWlzZTxJREJEYXRhYmFzZT4ge1xuICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oREJfTkFNRSwgREJfVkVSU0lPTik7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsICgpID0+IHtcbiAgICAgIHJlamVjdChyZXF1ZXN0LmVycm9yKTtcbiAgICB9KTtcblxuICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcigndXBncmFkZW5lZWRlZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGRiID0gcmVxdWVzdC5yZXN1bHQ7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGRiLmNyZWF0ZU9iamVjdFN0b3JlKERCX09CSkVDVFNUT1JFX05BTUUsIHsga2V5UGF0aDogREJfREFUQV9LRVlQQVRIIH0pO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZWplY3QoZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkYjogSURCRGF0YWJhc2UgPSByZXF1ZXN0LnJlc3VsdDtcbiAgICAgIC8vIFN0cmFuZ2UgYnVnIHRoYXQgb2NjdXJzIGluIEZpcmVmb3ggd2hlbiBtdWx0aXBsZSB0YWJzIGFyZSBvcGVuZWQgYXQgdGhlXG4gICAgICAvLyBzYW1lIHRpbWUuIFRoZSBvbmx5IHdheSB0byByZWNvdmVyIHNlZW1zIHRvIGJlIGRlbGV0aW5nIHRoZSBkYXRhYmFzZVxuICAgICAgLy8gYW5kIHJlLWluaXRpYWxpemluZyBpdC5cbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1qcy1zZGsvaXNzdWVzLzYzNFxuXG4gICAgICBpZiAoIWRiLm9iamVjdFN0b3JlTmFtZXMuY29udGFpbnMoREJfT0JKRUNUU1RPUkVfTkFNRSkpIHtcbiAgICAgICAgLy8gTmVlZCB0byBjbG9zZSB0aGUgZGF0YWJhc2Ugb3IgZWxzZSB5b3UgZ2V0IGEgYGJsb2NrZWRgIGV2ZW50XG4gICAgICAgIGRiLmNsb3NlKCk7XG4gICAgICAgIGF3YWl0IF9kZWxldGVEYXRhYmFzZSgpO1xuICAgICAgICByZXNvbHZlKGF3YWl0IF9vcGVuRGF0YWJhc2UoKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKGRiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfcHV0T2JqZWN0KFxuICBkYjogSURCRGF0YWJhc2UsXG4gIGtleTogc3RyaW5nLFxuICB2YWx1ZTogUGVyc2lzdGVuY2VWYWx1ZSB8IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgdHJ1ZSkucHV0KHtcbiAgICBbREJfREFUQV9LRVlQQVRIXToga2V5LFxuICAgIHZhbHVlXG4gIH0pO1xuICByZXR1cm4gbmV3IERCUHJvbWlzZTx2b2lkPihyZXF1ZXN0KS50b1Byb21pc2UoKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0T2JqZWN0KFxuICBkYjogSURCRGF0YWJhc2UsXG4gIGtleTogc3RyaW5nXG4pOiBQcm9taXNlPFBlcnNpc3RlZEJsb2IgfCBudWxsPiB7XG4gIGNvbnN0IHJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgZmFsc2UpLmdldChrZXkpO1xuICBjb25zdCBkYXRhID0gYXdhaXQgbmV3IERCUHJvbWlzZTxEQk9iamVjdCB8IHVuZGVmaW5lZD4ocmVxdWVzdCkudG9Qcm9taXNlKCk7XG4gIHJldHVybiBkYXRhID09PSB1bmRlZmluZWQgPyBudWxsIDogZGF0YS52YWx1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9kZWxldGVPYmplY3QoZGI6IElEQkRhdGFiYXNlLCBrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCByZXF1ZXN0ID0gZ2V0T2JqZWN0U3RvcmUoZGIsIHRydWUpLmRlbGV0ZShrZXkpO1xuICByZXR1cm4gbmV3IERCUHJvbWlzZTx2b2lkPihyZXF1ZXN0KS50b1Byb21pc2UoKTtcbn1cblxuZXhwb3J0IGNvbnN0IF9QT0xMSU5HX0lOVEVSVkFMX01TID0gODAwO1xuZXhwb3J0IGNvbnN0IF9UUkFOU0FDVElPTl9SRVRSWV9DT1VOVCA9IDM7XG5cbmNsYXNzIEluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UgaW1wbGVtZW50cyBJbnRlcm5hbFBlcnNpc3RlbmNlIHtcbiAgc3RhdGljIHR5cGU6ICdMT0NBTCcgPSAnTE9DQUwnO1xuXG4gIHR5cGUgPSBQZXJzaXN0ZW5jZVR5cGUuTE9DQUw7XG4gIGRiPzogSURCRGF0YWJhc2U7XG4gIHJlYWRvbmx5IF9zaG91bGRBbGxvd01pZ3JhdGlvbiA9IHRydWU7XG5cbiAgcHJpdmF0ZSByZWFkb25seSBsaXN0ZW5lcnM6IFJlY29yZDxzdHJpbmcsIFNldDxTdG9yYWdlRXZlbnRMaXN0ZW5lcj4+ID0ge307XG4gIHByaXZhdGUgcmVhZG9ubHkgbG9jYWxDYWNoZTogUmVjb3JkPHN0cmluZywgUGVyc2lzdGVuY2VWYWx1ZSB8IG51bGw+ID0ge307XG4gIC8vIHNldFRpbWVvdXQgcmV0dXJuIHZhbHVlIGlzIHBsYXRmb3JtIHNwZWNpZmljXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gIHByaXZhdGUgcG9sbFRpbWVyOiBhbnkgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBwZW5kaW5nV3JpdGVzID0gMDtcblxuICBwcml2YXRlIHJlY2VpdmVyOiBSZWNlaXZlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHNlbmRlcjogU2VuZGVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlID0gZmFsc2U7XG4gIHByaXZhdGUgYWN0aXZlU2VydmljZVdvcmtlcjogU2VydmljZVdvcmtlciB8IG51bGwgPSBudWxsO1xuICAvLyBWaXNpYmxlIGZvciB0ZXN0aW5nIG9ubHlcbiAgcmVhZG9ubHkgX3dvcmtlckluaXRpYWxpemF0aW9uUHJvbWlzZTogUHJvbWlzZTx2b2lkPjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBGaXJlICYgZm9yZ2V0IHRoZSBzZXJ2aWNlIHdvcmtlciByZWdpc3RyYXRpb24gYXMgaXQgbWF5IG5ldmVyIHJlc29sdmVcbiAgICB0aGlzLl93b3JrZXJJbml0aWFsaXphdGlvblByb21pc2UgPVxuICAgICAgdGhpcy5pbml0aWFsaXplU2VydmljZVdvcmtlck1lc3NhZ2luZygpLnRoZW4oXG4gICAgICAgICgpID0+IHt9LFxuICAgICAgICAoKSA9PiB7fVxuICAgICAgKTtcbiAgfVxuXG4gIGFzeW5jIF9vcGVuRGIoKTogUHJvbWlzZTxJREJEYXRhYmFzZT4ge1xuICAgIGlmICh0aGlzLmRiKSB7XG4gICAgICByZXR1cm4gdGhpcy5kYjtcbiAgICB9XG4gICAgdGhpcy5kYiA9IGF3YWl0IF9vcGVuRGF0YWJhc2UoKTtcbiAgICByZXR1cm4gdGhpcy5kYjtcbiAgfVxuXG4gIGFzeW5jIF93aXRoUmV0cmllczxUPihvcDogKGRiOiBJREJEYXRhYmFzZSkgPT4gUHJvbWlzZTxUPik6IFByb21pc2U8VD4ge1xuICAgIGxldCBudW1BdHRlbXB0cyA9IDA7XG5cbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZGIgPSBhd2FpdCB0aGlzLl9vcGVuRGIoKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IG9wKGRiKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgaWYgKG51bUF0dGVtcHRzKysgPiBfVFJBTlNBQ1RJT05fUkVUUllfQ09VTlQpIHtcbiAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRiKSB7XG4gICAgICAgICAgdGhpcy5kYi5jbG9zZSgpO1xuICAgICAgICAgIHRoaXMuZGIgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVE9ETzogY29uc2lkZXIgYWRkaW5nIGV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSW5kZXhlZERCIGV2ZW50cyBkbyBub3QgcHJvcGFnYXRlIGZyb20gdGhlIG1haW4gd2luZG93IHRvIHRoZSB3b3JrZXIgY29udGV4dC4gIFdlIHJlbHkgb24gYVxuICAgKiBwb3N0TWVzc2FnZSBpbnRlcmZhY2UgdG8gc2VuZCB0aGVzZSBldmVudHMgdG8gdGhlIHdvcmtlciBvdXJzZWx2ZXMuXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGluaXRpYWxpemVTZXJ2aWNlV29ya2VyTWVzc2FnaW5nKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBfaXNXb3JrZXIoKSA/IHRoaXMuaW5pdGlhbGl6ZVJlY2VpdmVyKCkgOiB0aGlzLmluaXRpYWxpemVTZW5kZXIoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcyB0aGUgd29ya2VyIHdlIHNob3VsZCBsaXN0ZW4gdG8gZXZlbnRzIGZyb20gdGhlIG1haW4gd2luZG93LlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplUmVjZWl2ZXIoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5yZWNlaXZlciA9IFJlY2VpdmVyLl9nZXRJbnN0YW5jZShfZ2V0V29ya2VyR2xvYmFsU2NvcGUoKSEpO1xuICAgIC8vIFJlZnJlc2ggZnJvbSBwZXJzaXN0ZW5jZSBpZiB3ZSByZWNlaXZlIGEgS2V5Q2hhbmdlZCBtZXNzYWdlLlxuICAgIHRoaXMucmVjZWl2ZXIuX3N1YnNjcmliZShcbiAgICAgIF9FdmVudFR5cGUuS0VZX0NIQU5HRUQsXG4gICAgICBhc3luYyAoX29yaWdpbjogc3RyaW5nLCBkYXRhOiBLZXlDaGFuZ2VkUmVxdWVzdCkgPT4ge1xuICAgICAgICBjb25zdCBrZXlzID0gYXdhaXQgdGhpcy5fcG9sbCgpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGtleVByb2Nlc3NlZDoga2V5cy5pbmNsdWRlcyhkYXRhLmtleSlcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICApO1xuICAgIC8vIExldCB0aGUgc2VuZGVyIGtub3cgdGhhdCB3ZSBhcmUgbGlzdGVuaW5nIHNvIHRoZXkgZ2l2ZSB1cyBtb3JlIHRpbWVvdXQuXG4gICAgdGhpcy5yZWNlaXZlci5fc3Vic2NyaWJlKFxuICAgICAgX0V2ZW50VHlwZS5QSU5HLFxuICAgICAgYXN5bmMgKF9vcmlnaW46IHN0cmluZywgX2RhdGE6IFBpbmdSZXF1ZXN0KSA9PiB7XG4gICAgICAgIHJldHVybiBbX0V2ZW50VHlwZS5LRVlfQ0hBTkdFRF07XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcyB0aGUgbWFpbiB3aW5kb3csIHdlIHNob3VsZCBsZXQgdGhlIHdvcmtlciBrbm93IHdoZW4ga2V5cyBjaGFuZ2UgKHNldCBhbmQgcmVtb3ZlKS5cbiAgICpcbiAgICogQHJlbWFya3NcbiAgICoge0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9TZXJ2aWNlV29ya2VyQ29udGFpbmVyL3JlYWR5IHwgU2VydmljZVdvcmtlckNvbnRhaW5lci5yZWFkeX1cbiAgICogbWF5IG5vdCByZXNvbHZlLlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBpbml0aWFsaXplU2VuZGVyKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGVyZSdzIGFuIGFjdGl2ZSBzZXJ2aWNlIHdvcmtlci5cbiAgICB0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIgPSBhd2FpdCBfZ2V0QWN0aXZlU2VydmljZVdvcmtlcigpO1xuICAgIGlmICghdGhpcy5hY3RpdmVTZXJ2aWNlV29ya2VyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuc2VuZGVyID0gbmV3IFNlbmRlcih0aGlzLmFjdGl2ZVNlcnZpY2VXb3JrZXIpO1xuICAgIC8vIFBpbmcgdGhlIHNlcnZpY2Ugd29ya2VyIHRvIGNoZWNrIHdoYXQgZXZlbnRzIHRoZXkgY2FuIGhhbmRsZS5cbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgdGhpcy5zZW5kZXIuX3NlbmQ8X1BpbmdSZXNwb25zZSwgUGluZ1JlcXVlc3Q+KFxuICAgICAgX0V2ZW50VHlwZS5QSU5HLFxuICAgICAge30sXG4gICAgICBfVGltZW91dER1cmF0aW9uLkxPTkdfQUNLXG4gICAgKTtcbiAgICBpZiAoIXJlc3VsdHMpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgcmVzdWx0c1swXT8uZnVsZmlsbGVkICYmXG4gICAgICByZXN1bHRzWzBdPy52YWx1ZS5pbmNsdWRlcyhfRXZlbnRUeXBlLktFWV9DSEFOR0VEKVxuICAgICkge1xuICAgICAgdGhpcy5zZXJ2aWNlV29ya2VyUmVjZWl2ZXJBdmFpbGFibGUgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBMZXQgdGhlIHdvcmtlciBrbm93IGFib3V0IGEgY2hhbmdlZCBrZXksIHRoZSBleGFjdCBrZXkgZG9lc24ndCB0ZWNobmljYWxseSBtYXR0ZXIgc2luY2UgdGhlXG4gICAqIHdvcmtlciB3aWxsIGp1c3QgdHJpZ2dlciBhIGZ1bGwgc3luYyBhbnl3YXkuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIEZvciBub3csIHdlIG9ubHkgc3VwcG9ydCBvbmUgc2VydmljZSB3b3JrZXIgcGVyIHBhZ2UuXG4gICAqXG4gICAqIEBwYXJhbSBrZXkgLSBTdG9yYWdlIGtleSB3aGljaCBjaGFuZ2VkLlxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBub3RpZnlTZXJ2aWNlV29ya2VyKGtleTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKFxuICAgICAgIXRoaXMuc2VuZGVyIHx8XG4gICAgICAhdGhpcy5hY3RpdmVTZXJ2aWNlV29ya2VyIHx8XG4gICAgICBfZ2V0U2VydmljZVdvcmtlckNvbnRyb2xsZXIoKSAhPT0gdGhpcy5hY3RpdmVTZXJ2aWNlV29ya2VyXG4gICAgKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLnNlbmRlci5fc2VuZDxLZXlDaGFuZ2VkUmVzcG9uc2UsIEtleUNoYW5nZWRSZXF1ZXN0PihcbiAgICAgICAgX0V2ZW50VHlwZS5LRVlfQ0hBTkdFRCxcbiAgICAgICAgeyBrZXkgfSxcbiAgICAgICAgLy8gVXNlIGxvbmcgdGltZW91dCBpZiByZWNlaXZlciBoYXMgcHJldmlvdXNseSByZXNwb25kZWQgdG8gYSBwaW5nIGZyb20gdXMuXG4gICAgICAgIHRoaXMuc2VydmljZVdvcmtlclJlY2VpdmVyQXZhaWxhYmxlXG4gICAgICAgICAgPyBfVGltZW91dER1cmF0aW9uLkxPTkdfQUNLXG4gICAgICAgICAgOiBfVGltZW91dER1cmF0aW9uLkFDS1xuICAgICAgKTtcbiAgICB9IGNhdGNoIHtcbiAgICAgIC8vIFRoaXMgaXMgYSBiZXN0IGVmZm9ydCBhcHByb2FjaC4gSWdub3JlIGVycm9ycy5cbiAgICB9XG4gIH1cblxuICBhc3luYyBfaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghaW5kZXhlZERCKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRiID0gYXdhaXQgX29wZW5EYXRhYmFzZSgpO1xuICAgICAgYXdhaXQgX3B1dE9iamVjdChkYiwgU1RPUkFHRV9BVkFJTEFCTEVfS0VZLCAnMScpO1xuICAgICAgYXdhaXQgX2RlbGV0ZU9iamVjdChkYiwgU1RPUkFHRV9BVkFJTEFCTEVfS0VZKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2gge31cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIF93aXRoUGVuZGluZ1dyaXRlKHdyaXRlOiAoKSA9PiBQcm9taXNlPHZvaWQ+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5wZW5kaW5nV3JpdGVzKys7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHdyaXRlKCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMucGVuZGluZ1dyaXRlcy0tO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIF9zZXQoa2V5OiBzdHJpbmcsIHZhbHVlOiBQZXJzaXN0ZW5jZVZhbHVlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMuX3dpdGhQZW5kaW5nV3JpdGUoYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgdGhpcy5fd2l0aFJldHJpZXMoKGRiOiBJREJEYXRhYmFzZSkgPT4gX3B1dE9iamVjdChkYiwga2V5LCB2YWx1ZSkpO1xuICAgICAgdGhpcy5sb2NhbENhY2hlW2tleV0gPSB2YWx1ZTtcbiAgICAgIHJldHVybiB0aGlzLm5vdGlmeVNlcnZpY2VXb3JrZXIoa2V5KTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIF9nZXQ8VCBleHRlbmRzIFBlcnNpc3RlbmNlVmFsdWU+KGtleTogc3RyaW5nKTogUHJvbWlzZTxUIHwgbnVsbD4ge1xuICAgIGNvbnN0IG9iaiA9IChhd2FpdCB0aGlzLl93aXRoUmV0cmllcygoZGI6IElEQkRhdGFiYXNlKSA9PlxuICAgICAgZ2V0T2JqZWN0KGRiLCBrZXkpXG4gICAgKSkgYXMgVDtcbiAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IG9iajtcbiAgICByZXR1cm4gb2JqO1xuICB9XG5cbiAgYXN5bmMgX3JlbW92ZShrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLl93aXRoUGVuZGluZ1dyaXRlKGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IHRoaXMuX3dpdGhSZXRyaWVzKChkYjogSURCRGF0YWJhc2UpID0+IF9kZWxldGVPYmplY3QoZGIsIGtleSkpO1xuICAgICAgZGVsZXRlIHRoaXMubG9jYWxDYWNoZVtrZXldO1xuICAgICAgcmV0dXJuIHRoaXMubm90aWZ5U2VydmljZVdvcmtlcihrZXkpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBfcG9sbCgpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgLy8gVE9ETzogY2hlY2sgaWYgd2UgbmVlZCB0byBmYWxsYmFjayBpZiBnZXRBbGwgaXMgbm90IHN1cHBvcnRlZFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuX3dpdGhSZXRyaWVzKChkYjogSURCRGF0YWJhc2UpID0+IHtcbiAgICAgIGNvbnN0IGdldEFsbFJlcXVlc3QgPSBnZXRPYmplY3RTdG9yZShkYiwgZmFsc2UpLmdldEFsbCgpO1xuICAgICAgcmV0dXJuIG5ldyBEQlByb21pc2U8REJPYmplY3RbXSB8IG51bGw+KGdldEFsbFJlcXVlc3QpLnRvUHJvbWlzZSgpO1xuICAgIH0pO1xuXG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICAvLyBJZiB3ZSBoYXZlIHBlbmRpbmcgd3JpdGVzIGluIHByb2dyZXNzIGFib3J0LCB3ZSdsbCBnZXQgcGlja2VkIHVwIG9uIHRoZSBuZXh0IHBvbGxcbiAgICBpZiAodGhpcy5wZW5kaW5nV3JpdGVzICE9PSAwKSB7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgY29uc3Qga2V5cyA9IFtdO1xuICAgIGNvbnN0IGtleXNJblJlc3VsdCA9IG5ldyBTZXQoKTtcbiAgICBmb3IgKGNvbnN0IHsgZmJhc2Vfa2V5OiBrZXksIHZhbHVlIH0gb2YgcmVzdWx0KSB7XG4gICAgICBrZXlzSW5SZXN1bHQuYWRkKGtleSk7XG4gICAgICBpZiAoSlNPTi5zdHJpbmdpZnkodGhpcy5sb2NhbENhY2hlW2tleV0pICE9PSBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpIHtcbiAgICAgICAgdGhpcy5ub3RpZnlMaXN0ZW5lcnMoa2V5LCB2YWx1ZSBhcyBQZXJzaXN0ZW5jZVZhbHVlKTtcbiAgICAgICAga2V5cy5wdXNoKGtleSk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAoY29uc3QgbG9jYWxLZXkgb2YgT2JqZWN0LmtleXModGhpcy5sb2NhbENhY2hlKSkge1xuICAgICAgaWYgKHRoaXMubG9jYWxDYWNoZVtsb2NhbEtleV0gJiYgIWtleXNJblJlc3VsdC5oYXMobG9jYWxLZXkpKSB7XG4gICAgICAgIC8vIERlbGV0ZWRcbiAgICAgICAgdGhpcy5ub3RpZnlMaXN0ZW5lcnMobG9jYWxLZXksIG51bGwpO1xuICAgICAgICBrZXlzLnB1c2gobG9jYWxLZXkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ga2V5cztcbiAgfVxuXG4gIHByaXZhdGUgbm90aWZ5TGlzdGVuZXJzKFxuICAgIGtleTogc3RyaW5nLFxuICAgIG5ld1ZhbHVlOiBQZXJzaXN0ZW5jZVZhbHVlIHwgbnVsbFxuICApOiB2b2lkIHtcbiAgICB0aGlzLmxvY2FsQ2FjaGVba2V5XSA9IG5ld1ZhbHVlO1xuICAgIGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzW2tleV07XG4gICAgaWYgKGxpc3RlbmVycykge1xuICAgICAgZm9yIChjb25zdCBsaXN0ZW5lciBvZiBBcnJheS5mcm9tKGxpc3RlbmVycykpIHtcbiAgICAgICAgbGlzdGVuZXIobmV3VmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhcnRQb2xsaW5nKCk6IHZvaWQge1xuICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcblxuICAgIHRoaXMucG9sbFRpbWVyID0gc2V0SW50ZXJ2YWwoXG4gICAgICBhc3luYyAoKSA9PiB0aGlzLl9wb2xsKCksXG4gICAgICBfUE9MTElOR19JTlRFUlZBTF9NU1xuICAgICk7XG4gIH1cblxuICBwcml2YXRlIHN0b3BQb2xsaW5nKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLnBvbGxUaW1lcikge1xuICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnBvbGxUaW1lcik7XG4gICAgICB0aGlzLnBvbGxUaW1lciA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgX2FkZExpc3RlbmVyKGtleTogc3RyaW5nLCBsaXN0ZW5lcjogU3RvcmFnZUV2ZW50TGlzdGVuZXIpOiB2b2lkIHtcbiAgICBpZiAoT2JqZWN0LmtleXModGhpcy5saXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdGhpcy5zdGFydFBvbGxpbmcoKTtcbiAgICB9XG4gICAgaWYgKCF0aGlzLmxpc3RlbmVyc1trZXldKSB7XG4gICAgICB0aGlzLmxpc3RlbmVyc1trZXldID0gbmV3IFNldCgpO1xuICAgICAgLy8gUG9wdWxhdGUgdGhlIGNhY2hlIHRvIGF2b2lkIHNwdXJpb3VzbHkgdHJpZ2dlcmluZyBvbiBmaXJzdCBwb2xsLlxuICAgICAgdm9pZCB0aGlzLl9nZXQoa2V5KTsgLy8gVGhpcyBjYW4gaGFwcGVuIGluIHRoZSBiYWNrZ3JvdW5kIGFzeW5jIGFuZCB3ZSBjYW4gcmV0dXJuIGltbWVkaWF0ZWx5LlxuICAgIH1cbiAgICB0aGlzLmxpc3RlbmVyc1trZXldLmFkZChsaXN0ZW5lcik7XG4gIH1cblxuICBfcmVtb3ZlTGlzdGVuZXIoa2V5OiBzdHJpbmcsIGxpc3RlbmVyOiBTdG9yYWdlRXZlbnRMaXN0ZW5lcik6IHZvaWQge1xuICAgIGlmICh0aGlzLmxpc3RlbmVyc1trZXldKSB7XG4gICAgICB0aGlzLmxpc3RlbmVyc1trZXldLmRlbGV0ZShsaXN0ZW5lcik7XG5cbiAgICAgIGlmICh0aGlzLmxpc3RlbmVyc1trZXldLnNpemUgPT09IDApIHtcbiAgICAgICAgZGVsZXRlIHRoaXMubGlzdGVuZXJzW2tleV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKE9iamVjdC5rZXlzKHRoaXMubGlzdGVuZXJzKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHRoaXMuc3RvcFBvbGxpbmcoKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBBbiBpbXBsZW1lbnRhdGlvbiBvZiB7QGxpbmsgUGVyc2lzdGVuY2V9IG9mIHR5cGUgYExPQ0FMYCB1c2luZyBgaW5kZXhlZERCYFxuICogZm9yIHRoZSB1bmRlcmx5aW5nIHN0b3JhZ2UuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY29uc3QgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZTogUGVyc2lzdGVuY2UgPSBJbmRleGVkREJMb2NhbFBlcnNpc3RlbmNlO1xuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIF9wZXJmb3JtQXBpUmVxdWVzdCxcbiAgRW5kcG9pbnQsXG4gIEh0dHBNZXRob2QsXG4gIF9hZGRUaWRJZk5lY2Vzc2FyeVxufSBmcm9tICcuLi9pbmRleCc7XG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IElkVG9rZW5SZXNwb25zZSB9IGZyb20gJy4uLy4uL21vZGVsL2lkX3Rva2VuJztcbmltcG9ydCB7IE1mYUVucm9sbG1lbnQgfSBmcm9tICcuLi9hY2NvdW50X21hbmFnZW1lbnQvbWZhJztcbmltcG9ydCB7IFNpZ25JbldpdGhJZHBSZXNwb25zZSB9IGZyb20gJy4vaWRwJztcbmltcG9ydCB7XG4gIFNpZ25JbldpdGhQaG9uZU51bWJlclJlcXVlc3QsXG4gIFNpZ25JbldpdGhQaG9uZU51bWJlclJlc3BvbnNlXG59IGZyb20gJy4vc21zJztcblxuZXhwb3J0IGludGVyZmFjZSBGaW5hbGl6ZU1mYVJlc3BvbnNlIHtcbiAgaWRUb2tlbjogc3RyaW5nO1xuICByZWZyZXNoVG9rZW46IHN0cmluZztcbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJZFRva2VuTWZhUmVzcG9uc2UgZXh0ZW5kcyBJZFRva2VuUmVzcG9uc2Uge1xuICBtZmFQZW5kaW5nQ3JlZGVudGlhbD86IHN0cmluZztcbiAgbWZhSW5mbz86IE1mYUVucm9sbG1lbnRbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFydFBob25lTWZhU2lnbkluUmVxdWVzdCB7XG4gIG1mYVBlbmRpbmdDcmVkZW50aWFsOiBzdHJpbmc7XG4gIG1mYUVucm9sbG1lbnRJZDogc3RyaW5nO1xuICBwaG9uZVNpZ25JbkluZm86IHtcbiAgICByZWNhcHRjaGFUb2tlbjogc3RyaW5nO1xuICB9O1xuICB0ZW5hbnRJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFydFBob25lTWZhU2lnbkluUmVzcG9uc2Uge1xuICBwaG9uZVJlc3BvbnNlSW5mbzoge1xuICAgIHNlc3Npb25JbmZvOiBzdHJpbmc7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdGFydFNpZ25JblBob25lTWZhKFxuICBhdXRoOiBBdXRoLFxuICByZXF1ZXN0OiBTdGFydFBob25lTWZhU2lnbkluUmVxdWVzdFxuKTogUHJvbWlzZTxTdGFydFBob25lTWZhU2lnbkluUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdDxcbiAgICBTdGFydFBob25lTWZhU2lnbkluUmVxdWVzdCxcbiAgICBTdGFydFBob25lTWZhU2lnbkluUmVzcG9uc2VcbiAgPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5TVEFSVF9NRkFfU0lHTl9JTixcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaW5hbGl6ZVBob25lTWZhU2lnbkluUmVxdWVzdCB7XG4gIG1mYVBlbmRpbmdDcmVkZW50aWFsOiBzdHJpbmc7XG4gIHBob25lVmVyaWZpY2F0aW9uSW5mbzogU2lnbkluV2l0aFBob25lTnVtYmVyUmVxdWVzdDtcbiAgdGVuYW50SWQ/OiBzdHJpbmc7XG59XG5cbi8vIFRPVFAgTUZBIFNpZ24gaW4gb25seSBoYXMgYSBmaW5hbGl6ZSBwaGFzZS4gUGhvbmUgTUZBIGhhcyBhIHN0YXJ0IHBoYXNlIHRvIGluaXRpYXRlIHNlbmRpbmcgYW5cbi8vIFNNUyBhbmQgYSBmaW5hbGl6ZSBwaGFzZSB0byBjb21wbGV0ZSBzaWduIGluLiBXaXRoIFRPVFAsIHRoZSB1c2VyIGFscmVhZHkgaGFzIHRoZSBPVFAgaW4gdGhlXG4vLyBUT1RQL0F1dGhlbnRpY2F0b3IgYXBwLlxuZXhwb3J0IGludGVyZmFjZSBGaW5hbGl6ZVRvdHBNZmFTaWduSW5SZXF1ZXN0IHtcbiAgbWZhUGVuZGluZ0NyZWRlbnRpYWw6IHN0cmluZztcbiAgdG90cFZlcmlmaWNhdGlvbkluZm86IHsgdmVyaWZpY2F0aW9uQ29kZTogc3RyaW5nIH07XG4gIHRlbmFudElkPzogc3RyaW5nO1xuICBtZmFFbnJvbGxtZW50SWQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaW5hbGl6ZVBob25lTWZhU2lnbkluUmVzcG9uc2UgZXh0ZW5kcyBGaW5hbGl6ZU1mYVJlc3BvbnNlIHt9XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmluYWxpemVUb3RwTWZhU2lnbkluUmVzcG9uc2UgZXh0ZW5kcyBGaW5hbGl6ZU1mYVJlc3BvbnNlIHt9XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5hbGl6ZVNpZ25JblBob25lTWZhKFxuICBhdXRoOiBBdXRoLFxuICByZXF1ZXN0OiBGaW5hbGl6ZVBob25lTWZhU2lnbkluUmVxdWVzdFxuKTogUHJvbWlzZTxGaW5hbGl6ZVBob25lTWZhU2lnbkluUmVzcG9uc2U+IHtcbiAgcmV0dXJuIF9wZXJmb3JtQXBpUmVxdWVzdDxcbiAgICBGaW5hbGl6ZVBob25lTWZhU2lnbkluUmVxdWVzdCxcbiAgICBGaW5hbGl6ZVBob25lTWZhU2lnbkluUmVzcG9uc2VcbiAgPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5GSU5BTElaRV9NRkFfU0lHTl9JTixcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmFsaXplU2lnbkluVG90cE1mYShcbiAgYXV0aDogQXV0aCxcbiAgcmVxdWVzdDogRmluYWxpemVUb3RwTWZhU2lnbkluUmVxdWVzdFxuKTogUHJvbWlzZTxGaW5hbGl6ZVRvdHBNZmFTaWduSW5SZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0PFxuICAgIEZpbmFsaXplVG90cE1mYVNpZ25JblJlcXVlc3QsXG4gICAgRmluYWxpemVUb3RwTWZhU2lnbkluUmVzcG9uc2VcbiAgPihcbiAgICBhdXRoLFxuICAgIEh0dHBNZXRob2QuUE9TVCxcbiAgICBFbmRwb2ludC5GSU5BTElaRV9NRkFfU0lHTl9JTixcbiAgICBfYWRkVGlkSWZOZWNlc3NhcnkoYXV0aCwgcmVxdWVzdClcbiAgKTtcbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IHR5cGUgUGhvbmVPck9hdXRoVG9rZW5SZXNwb25zZSA9XG4gIHwgU2lnbkluV2l0aFBob25lTnVtYmVyUmVzcG9uc2VcbiAgfCBTaWduSW5XaXRoSWRwUmVzcG9uc2VcbiAgfCBJZFRva2VuUmVzcG9uc2U7XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uLy4uL2NvcmUvZXJyb3JzJztcbmltcG9ydCB7IF9hc3NlcnQgfSBmcm9tICcuLi8uLi9jb3JlL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgUmVjYXB0Y2hhUGFyYW1ldGVycyB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQge1xuICBSZWNhcHRjaGEsXG4gIEdyZUNBUFRDSEFUb3BMZXZlbCxcbiAgR3JlQ0FQVENIQVJlbmRlck9wdGlvbixcbiAgR3JlQ0FQVENIQVxufSBmcm9tICcuL3JlY2FwdGNoYSc7XG5cbmV4cG9ydCBjb25zdCBfU09MVkVfVElNRV9NUyA9IDUwMDtcbmV4cG9ydCBjb25zdCBfRVhQSVJBVElPTl9USU1FX01TID0gNjBfMDAwO1xuZXhwb3J0IGNvbnN0IF9XSURHRVRfSURfU1RBUlQgPSAxXzAwMF8wMDBfMDAwXzAwMDtcblxuZXhwb3J0IGludGVyZmFjZSBXaWRnZXQge1xuICBnZXRSZXNwb25zZTogKCkgPT4gc3RyaW5nIHwgbnVsbDtcbiAgZGVsZXRlOiAoKSA9PiB2b2lkO1xuICBleGVjdXRlOiAoKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgTW9ja1JlQ2FwdGNoYSBpbXBsZW1lbnRzIFJlY2FwdGNoYSB7XG4gIHByaXZhdGUgY291bnRlciA9IF9XSURHRVRfSURfU1RBUlQ7XG4gIF93aWRnZXRzID0gbmV3IE1hcDxudW1iZXIsIFdpZGdldD4oKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGF1dGg6IEF1dGhJbnRlcm5hbCkge31cblxuICByZW5kZXIoXG4gICAgY29udGFpbmVyOiBzdHJpbmcgfCBIVE1MRWxlbWVudCxcbiAgICBwYXJhbWV0ZXJzPzogUmVjYXB0Y2hhUGFyYW1ldGVyc1xuICApOiBudW1iZXIge1xuICAgIGNvbnN0IGlkID0gdGhpcy5jb3VudGVyO1xuICAgIHRoaXMuX3dpZGdldHMuc2V0KFxuICAgICAgaWQsXG4gICAgICBuZXcgTW9ja1dpZGdldChjb250YWluZXIsIHRoaXMuYXV0aC5uYW1lLCBwYXJhbWV0ZXJzIHx8IHt9KVxuICAgICk7XG4gICAgdGhpcy5jb3VudGVyKys7XG4gICAgcmV0dXJuIGlkO1xuICB9XG5cbiAgcmVzZXQob3B0V2lkZ2V0SWQ/OiBudW1iZXIpOiB2b2lkIHtcbiAgICBjb25zdCBpZCA9IG9wdFdpZGdldElkIHx8IF9XSURHRVRfSURfU1RBUlQ7XG4gICAgdm9pZCB0aGlzLl93aWRnZXRzLmdldChpZCk/LmRlbGV0ZSgpO1xuICAgIHRoaXMuX3dpZGdldHMuZGVsZXRlKGlkKTtcbiAgfVxuXG4gIGdldFJlc3BvbnNlKG9wdFdpZGdldElkPzogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBpZCA9IG9wdFdpZGdldElkIHx8IF9XSURHRVRfSURfU1RBUlQ7XG4gICAgcmV0dXJuIHRoaXMuX3dpZGdldHMuZ2V0KGlkKT8uZ2V0UmVzcG9uc2UoKSB8fCAnJztcbiAgfVxuXG4gIGFzeW5jIGV4ZWN1dGUob3B0V2lkZ2V0SWQ/OiBudW1iZXIgfCBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGlkOiBudW1iZXIgPSAob3B0V2lkZ2V0SWQgYXMgbnVtYmVyKSB8fCBfV0lER0VUX0lEX1NUQVJUO1xuICAgIHZvaWQgdGhpcy5fd2lkZ2V0cy5nZXQoaWQpPy5leGVjdXRlKCk7XG4gICAgcmV0dXJuICcnO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBNb2NrR3JlQ0FQVENIQVRvcExldmVsIGltcGxlbWVudHMgR3JlQ0FQVENIQVRvcExldmVsIHtcbiAgZW50ZXJwcmlzZTogR3JlQ0FQVENIQSA9IG5ldyBNb2NrR3JlQ0FQVENIQSgpO1xuICByZWFkeShjYWxsYmFjazogKCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIGNhbGxiYWNrKCk7XG4gIH1cblxuICBleGVjdXRlKFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBfc2l0ZUtleTogc3RyaW5nLFxuICAgIF9vcHRpb25zOiB7IGFjdGlvbjogc3RyaW5nIH1cbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCd0b2tlbicpO1xuICB9XG4gIHJlbmRlcihcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gICAgX2NvbnRhaW5lcjogc3RyaW5nIHwgSFRNTEVsZW1lbnQsXG4gICAgX3BhcmFtZXRlcnM6IEdyZUNBUFRDSEFSZW5kZXJPcHRpb25cbiAgKTogc3RyaW5nIHtcbiAgICByZXR1cm4gJyc7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIE1vY2tHcmVDQVBUQ0hBIGltcGxlbWVudHMgR3JlQ0FQVENIQSB7XG4gIHJlYWR5KGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgY2FsbGJhY2soKTtcbiAgfVxuXG4gIGV4ZWN1dGUoXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFyc1xuICAgIF9zaXRlS2V5OiBzdHJpbmcsXG4gICAgX29wdGlvbnM6IHsgYWN0aW9uOiBzdHJpbmcgfVxuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoJ3Rva2VuJyk7XG4gIH1cbiAgcmVuZGVyKFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICBfY29udGFpbmVyOiBzdHJpbmcgfCBIVE1MRWxlbWVudCxcbiAgICBfcGFyYW1ldGVyczogR3JlQ0FQVENIQVJlbmRlck9wdGlvblxuICApOiBzdHJpbmcge1xuICAgIHJldHVybiAnJztcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTW9ja1dpZGdldCB7XG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgcHJpdmF0ZSByZWFkb25seSBpc1Zpc2libGU6IGJvb2xlYW47XG4gIHByaXZhdGUgdGltZXJJZDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgZGVsZXRlZCA9IGZhbHNlO1xuICBwcml2YXRlIHJlc3BvbnNlVG9rZW46IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHJlYWRvbmx5IGNsaWNrSGFuZGxlciA9ICgpOiB2b2lkID0+IHtcbiAgICB0aGlzLmV4ZWN1dGUoKTtcbiAgfTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBjb250YWluZXJPcklkOiBzdHJpbmcgfCBIVE1MRWxlbWVudCxcbiAgICBhcHBOYW1lOiBzdHJpbmcsXG4gICAgcHJpdmF0ZSByZWFkb25seSBwYXJhbXM6IFJlY2FwdGNoYVBhcmFtZXRlcnNcbiAgKSB7XG4gICAgY29uc3QgY29udGFpbmVyID1cbiAgICAgIHR5cGVvZiBjb250YWluZXJPcklkID09PSAnc3RyaW5nJ1xuICAgICAgICA/IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbnRhaW5lck9ySWQpXG4gICAgICAgIDogY29udGFpbmVyT3JJZDtcbiAgICBfYXNzZXJ0KGNvbnRhaW5lciwgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUiwgeyBhcHBOYW1lIH0pO1xuXG4gICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgdGhpcy5pc1Zpc2libGUgPSB0aGlzLnBhcmFtcy5zaXplICE9PSAnaW52aXNpYmxlJztcbiAgICBpZiAodGhpcy5pc1Zpc2libGUpIHtcbiAgICAgIHRoaXMuZXhlY3V0ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2tIYW5kbGVyKTtcbiAgICB9XG4gIH1cblxuICBnZXRSZXNwb25zZSgpOiBzdHJpbmcgfCBudWxsIHtcbiAgICB0aGlzLmNoZWNrSWZEZWxldGVkKCk7XG4gICAgcmV0dXJuIHRoaXMucmVzcG9uc2VUb2tlbjtcbiAgfVxuXG4gIGRlbGV0ZSgpOiB2b2lkIHtcbiAgICB0aGlzLmNoZWNrSWZEZWxldGVkKCk7XG4gICAgdGhpcy5kZWxldGVkID0gdHJ1ZTtcbiAgICBpZiAodGhpcy50aW1lcklkKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lcklkKTtcbiAgICAgIHRoaXMudGltZXJJZCA9IG51bGw7XG4gICAgfVxuICAgIHRoaXMuY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGlja0hhbmRsZXIpO1xuICB9XG5cbiAgZXhlY3V0ZSgpOiB2b2lkIHtcbiAgICB0aGlzLmNoZWNrSWZEZWxldGVkKCk7XG4gICAgaWYgKHRoaXMudGltZXJJZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMudGltZXJJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMucmVzcG9uc2VUb2tlbiA9IGdlbmVyYXRlUmFuZG9tQWxwaGFOdW1lcmljU3RyaW5nKDUwKTtcbiAgICAgIGNvbnN0IHsgY2FsbGJhY2ssICdleHBpcmVkLWNhbGxiYWNrJzogZXhwaXJlZENhbGxiYWNrIH0gPSB0aGlzLnBhcmFtcztcbiAgICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNhbGxiYWNrKHRoaXMucmVzcG9uc2VUb2tlbik7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICB9XG5cbiAgICAgIHRoaXMudGltZXJJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy50aW1lcklkID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZXNwb25zZVRva2VuID0gbnVsbDtcbiAgICAgICAgaWYgKGV4cGlyZWRDYWxsYmFjaykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBleHBpcmVkQ2FsbGJhY2soKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuaXNWaXNpYmxlKSB7XG4gICAgICAgICAgdGhpcy5leGVjdXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sIF9FWFBJUkFUSU9OX1RJTUVfTVMpO1xuICAgIH0sIF9TT0xWRV9USU1FX01TKTtcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tJZkRlbGV0ZWQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuZGVsZXRlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdyZUNBUFRDSEEgbW9jayB3YXMgYWxyZWFkeSBkZWxldGVkIScpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVJhbmRvbUFscGhhTnVtZXJpY1N0cmluZyhsZW46IG51bWJlcik6IHN0cmluZyB7XG4gIGNvbnN0IGNoYXJzID0gW107XG4gIGNvbnN0IGFsbG93ZWRDaGFycyA9XG4gICAgJzEyMzQ1Njc4OTBhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ekFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJztcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgIGNoYXJzLnB1c2goXG4gICAgICBhbGxvd2VkQ2hhcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFsbG93ZWRDaGFycy5sZW5ndGgpKVxuICAgICk7XG4gIH1cbiAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IHF1ZXJ5c3RyaW5nIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9lcnJvcnMnO1xuaW1wb3J0IHsgX2Fzc2VydCwgX2NyZWF0ZUVycm9yIH0gZnJvbSAnLi4vLi4vY29yZS91dGlsL2Fzc2VydCc7XG5pbXBvcnQgeyBEZWxheSB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9kZWxheSc7XG5pbXBvcnQgeyBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7IF93aW5kb3cgfSBmcm9tICcuLi9hdXRoX3dpbmRvdyc7XG5pbXBvcnQgKiBhcyBqc0hlbHBlcnMgZnJvbSAnLi4vbG9hZF9qcyc7XG5pbXBvcnQgeyBSZWNhcHRjaGEsIGlzVjIgfSBmcm9tICcuL3JlY2FwdGNoYSc7XG5pbXBvcnQgeyBNb2NrUmVDYXB0Y2hhIH0gZnJvbSAnLi9yZWNhcHRjaGFfbW9jayc7XG5cbi8vIFJlQ2FwdGNoYSB3aWxsIGxvYWQgdXNpbmcgdGhlIHNhbWUgY2FsbGJhY2ssIHNvIHRoZSBjYWxsYmFjayBmdW5jdGlvbiBuZWVkc1xuLy8gdG8gYmUga2VwdCBhcm91bmRcbmV4cG9ydCBjb25zdCBfSlNMT0FEX0NBTExCQUNLID0ganNIZWxwZXJzLl9nZW5lcmF0ZUNhbGxiYWNrTmFtZSgncmNiJyk7XG5jb25zdCBORVRXT1JLX1RJTUVPVVRfREVMQVkgPSBuZXcgRGVsYXkoMzAwMDAsIDYwMDAwKTtcbmNvbnN0IFJFQ0FQVENIQV9CQVNFID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVjYXB0Y2hhL2FwaS5qcz8nO1xuXG4vKipcbiAqIFdlIG5lZWQgdG8gbWFyayB0aGlzIGludGVyZmFjZSBhcyBpbnRlcm5hbCBleHBsaWNpdGx5IHRvIGV4Y2x1ZGUgaXQgaW4gdGhlIHB1YmxpYyB0eXBpbmdzLCBiZWNhdXNlXG4gKiBpdCByZWZlcmVuY2VzIEF1dGhJbnRlcm5hbCB3aGljaCBoYXMgYSBjaXJjdWxhciBkZXBlbmRlbmN5IHdpdGggVXNlckludGVybmFsLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlQ2FwdGNoYUxvYWRlciB7XG4gIGxvYWQoYXV0aDogQXV0aEludGVybmFsLCBobD86IHN0cmluZyk6IFByb21pc2U8UmVjYXB0Y2hhPjtcbiAgY2xlYXJlZE9uZUluc3RhbmNlKCk6IHZvaWQ7XG59XG5cbi8qKlxuICogTG9hZGVyIGZvciB0aGUgR1JlQ2FwdGNoYSBsaWJyYXJ5LiBUaGVyZSBzaG91bGQgb25seSBldmVyIGJlIG9uZSBvZiB0aGlzLlxuICovXG5leHBvcnQgY2xhc3MgUmVDYXB0Y2hhTG9hZGVySW1wbCBpbXBsZW1lbnRzIFJlQ2FwdGNoYUxvYWRlciB7XG4gIHByaXZhdGUgaG9zdExhbmd1YWdlID0gJyc7XG4gIHByaXZhdGUgY291bnRlciA9IDA7XG4gIC8qKlxuICAgKiBDaGVjayBmb3IgYHJlbmRlcigpYCBtZXRob2QuIGB3aW5kb3cuZ3JlY2FwdGNoYWAgd2lsbCBleGlzdCBpZiB0aGUgRW50ZXJwcmlzZVxuICAgKiB2ZXJzaW9uIG9mIHRoZSBSZUNBUFRDSEEgc2NyaXB0IHdhcyBsb2FkZWQgYnkgc29tZW9uZSBlbHNlIChlLmcuIEFwcCBDaGVjaykgYnV0XG4gICAqIGB3aW5kb3cuZ3JlY2FwdGNoYS5yZW5kZXIoKWAgd2lsbCBub3QuIEFub3RoZXIgbG9hZCB3aWxsIGFkZCBpdC5cbiAgICovXG4gIHByaXZhdGUgcmVhZG9ubHkgbGlicmFyeVNlcGFyYXRlbHlMb2FkZWQgPSAhIV93aW5kb3coKS5ncmVjYXB0Y2hhPy5yZW5kZXI7XG5cbiAgbG9hZChhdXRoOiBBdXRoSW50ZXJuYWwsIGhsID0gJycpOiBQcm9taXNlPFJlY2FwdGNoYT4ge1xuICAgIF9hc3NlcnQoaXNIb3N0TGFuZ3VhZ2VWYWxpZChobCksIGF1dGgsIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IpO1xuXG4gICAgaWYgKHRoaXMuc2hvdWxkUmVzb2x2ZUltbWVkaWF0ZWx5KGhsKSAmJiBpc1YyKF93aW5kb3coKS5ncmVjYXB0Y2hhKSkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShfd2luZG93KCkuZ3JlY2FwdGNoYSEgYXMgUmVjYXB0Y2hhKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPFJlY2FwdGNoYT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgbmV0d29ya1RpbWVvdXQgPSBfd2luZG93KCkuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHJlamVjdChfY3JlYXRlRXJyb3IoYXV0aCwgQXV0aEVycm9yQ29kZS5ORVRXT1JLX1JFUVVFU1RfRkFJTEVEKSk7XG4gICAgICB9LCBORVRXT1JLX1RJTUVPVVRfREVMQVkuZ2V0KCkpO1xuXG4gICAgICBfd2luZG93KClbX0pTTE9BRF9DQUxMQkFDS10gPSAoKSA9PiB7XG4gICAgICAgIF93aW5kb3coKS5jbGVhclRpbWVvdXQobmV0d29ya1RpbWVvdXQpO1xuICAgICAgICBkZWxldGUgX3dpbmRvdygpW19KU0xPQURfQ0FMTEJBQ0tdO1xuXG4gICAgICAgIGNvbnN0IHJlY2FwdGNoYSA9IF93aW5kb3coKS5ncmVjYXB0Y2hhIGFzIFJlY2FwdGNoYTtcblxuICAgICAgICBpZiAoIXJlY2FwdGNoYSB8fCAhaXNWMihyZWNhcHRjaGEpKSB7XG4gICAgICAgICAgcmVqZWN0KF9jcmVhdGVFcnJvcihhdXRoLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gV3JhcCB0aGUgZ3JlcHRjaGEgcmVuZGVyIGZ1bmN0aW9uIHNvIHRoYXQgd2Uga25vdyBpZiB0aGUgZGV2ZWxvcGVyIGhhc1xuICAgICAgICAvLyBjYWxsZWQgaXQgc2VwYXJhdGVseVxuICAgICAgICBjb25zdCByZW5kZXIgPSByZWNhcHRjaGEucmVuZGVyO1xuICAgICAgICByZWNhcHRjaGEucmVuZGVyID0gKGNvbnRhaW5lciwgcGFyYW1zKSA9PiB7XG4gICAgICAgICAgY29uc3Qgd2lkZ2V0SWQgPSByZW5kZXIoY29udGFpbmVyLCBwYXJhbXMpO1xuICAgICAgICAgIHRoaXMuY291bnRlcisrO1xuICAgICAgICAgIHJldHVybiB3aWRnZXRJZDtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmhvc3RMYW5ndWFnZSA9IGhsO1xuICAgICAgICByZXNvbHZlKHJlY2FwdGNoYSk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCB1cmwgPSBgJHtSRUNBUFRDSEFfQkFTRX0/JHtxdWVyeXN0cmluZyh7XG4gICAgICAgIG9ubG9hZDogX0pTTE9BRF9DQUxMQkFDSyxcbiAgICAgICAgcmVuZGVyOiAnZXhwbGljaXQnLFxuICAgICAgICBobFxuICAgICAgfSl9YDtcblxuICAgICAganNIZWxwZXJzLl9sb2FkSlModXJsKS5jYXRjaCgoKSA9PiB7XG4gICAgICAgIGNsZWFyVGltZW91dChuZXR3b3JrVGltZW91dCk7XG4gICAgICAgIHJlamVjdChfY3JlYXRlRXJyb3IoYXV0aCwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUikpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBjbGVhcmVkT25lSW5zdGFuY2UoKTogdm9pZCB7XG4gICAgdGhpcy5jb3VudGVyLS07XG4gIH1cblxuICBwcml2YXRlIHNob3VsZFJlc29sdmVJbW1lZGlhdGVseShobDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgLy8gV2UgY2FuIHJlc29sdmUgaW1tZWRpYXRlbHkgaWY6XG4gICAgLy8gICDigKIgZ3JlY2FwdGNoYSBpcyBhbHJlYWR5IGRlZmluZWQgQU5EIChcbiAgICAvLyAgICAgMS4gdGhlIHJlcXVlc3RlZCBsYW5ndWFnZSBjb2RlcyBhcmUgdGhlIHNhbWUgT1JcbiAgICAvLyAgICAgMi4gdGhlcmUgZXhpc3RzIGFscmVhZHkgYSBSZUNhcHRjaGEgb24gdGhlIHBhZ2VcbiAgICAvLyAgICAgMy4gdGhlIGxpYnJhcnkgd2FzIGFscmVhZHkgbG9hZGVkIGJ5IHRoZSBhcHBcbiAgICAvLyBJbiBjYXNlcyAoMikgYW5kICgzKSwgd2UgX2Nhbid0XyByZWxvYWQgYXMgaXQgd291bGQgYnJlYWsgdGhlIHJlY2FwdGNoYXNcbiAgICAvLyB0aGF0IGFyZSBhbHJlYWR5IGluIHRoZSBwYWdlXG4gICAgcmV0dXJuIChcbiAgICAgICEhX3dpbmRvdygpLmdyZWNhcHRjaGE/LnJlbmRlciAmJlxuICAgICAgKGhsID09PSB0aGlzLmhvc3RMYW5ndWFnZSB8fFxuICAgICAgICB0aGlzLmNvdW50ZXIgPiAwIHx8XG4gICAgICAgIHRoaXMubGlicmFyeVNlcGFyYXRlbHlMb2FkZWQpXG4gICAgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpc0hvc3RMYW5ndWFnZVZhbGlkKGhsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIGhsLmxlbmd0aCA8PSA2ICYmIC9eXFxzKlthLXpBLVowLTlcXC1dKlxccyokLy50ZXN0KGhsKTtcbn1cblxuZXhwb3J0IGNsYXNzIE1vY2tSZUNhcHRjaGFMb2FkZXJJbXBsIGltcGxlbWVudHMgUmVDYXB0Y2hhTG9hZGVyIHtcbiAgYXN5bmMgbG9hZChhdXRoOiBBdXRoSW50ZXJuYWwpOiBQcm9taXNlPFJlY2FwdGNoYT4ge1xuICAgIHJldHVybiBuZXcgTW9ja1JlQ2FwdGNoYShhdXRoKTtcbiAgfVxuXG4gIGNsZWFyZWRPbmVJbnN0YW5jZSgpOiB2b2lkIHt9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgQXV0aCwgUmVjYXB0Y2hhUGFyYW1ldGVycyB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQgeyBnZXRSZWNhcHRjaGFQYXJhbXMgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vcmVjYXB0Y2hhJztcbmltcG9ydCB7IF9jYXN0QXV0aCB9IGZyb20gJy4uLy4uL2NvcmUvYXV0aC9hdXRoX2ltcGwnO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uLy4uL2NvcmUvZXJyb3JzJztcbmltcG9ydCB7IF9hc3NlcnQgfSBmcm9tICcuLi8uLi9jb3JlL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IF9pc0h0dHBPckh0dHBzIH0gZnJvbSAnLi4vLi4vY29yZS91dGlsL2xvY2F0aW9uJztcbmltcG9ydCB7IEFwcGxpY2F0aW9uVmVyaWZpZXJJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2FwcGxpY2F0aW9uX3ZlcmlmaWVyJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgX3dpbmRvdyB9IGZyb20gJy4uL2F1dGhfd2luZG93JztcbmltcG9ydCB7IF9pc1dvcmtlciB9IGZyb20gJy4uL3V0aWwvd29ya2VyJztcbmltcG9ydCB7IFJlY2FwdGNoYSB9IGZyb20gJy4vcmVjYXB0Y2hhJztcbmltcG9ydCB7XG4gIE1vY2tSZUNhcHRjaGFMb2FkZXJJbXBsLFxuICBSZUNhcHRjaGFMb2FkZXIsXG4gIFJlQ2FwdGNoYUxvYWRlckltcGxcbn0gZnJvbSAnLi9yZWNhcHRjaGFfbG9hZGVyJztcblxuZXhwb3J0IGNvbnN0IFJFQ0FQVENIQV9WRVJJRklFUl9UWVBFID0gJ3JlY2FwdGNoYSc7XG5cbmNvbnN0IERFRkFVTFRfUEFSQU1TOiBSZWNhcHRjaGFQYXJhbWV0ZXJzID0ge1xuICB0aGVtZTogJ2xpZ2h0JyxcbiAgdHlwZTogJ2ltYWdlJ1xufTtcblxudHlwZSBUb2tlbkNhbGxiYWNrID0gKHRva2VuOiBzdHJpbmcpID0+IHZvaWQ7XG5cbi8qKlxuICogQW4ge0BsaW5rIGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vcmVjYXB0Y2hhLyB8IHJlQ0FQVENIQX0tYmFzZWQgYXBwbGljYXRpb24gdmVyaWZpZXIuXG4gKlxuICogQHJlbWFya3NcbiAqIGBSZWNhcHRjaGFWZXJpZmllcmAgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgUmVjYXB0Y2hhVmVyaWZpZXIgaW1wbGVtZW50cyBBcHBsaWNhdGlvblZlcmlmaWVySW50ZXJuYWwge1xuICAvKipcbiAgICogVGhlIGFwcGxpY2F0aW9uIHZlcmlmaWVyIHR5cGUuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIEZvciBhIHJlQ0FQVENIQSB2ZXJpZmllciwgdGhpcyBpcyAncmVjYXB0Y2hhJy5cbiAgICovXG4gIHJlYWRvbmx5IHR5cGUgPSBSRUNBUFRDSEFfVkVSSUZJRVJfVFlQRTtcbiAgcHJpdmF0ZSBkZXN0cm95ZWQgPSBmYWxzZTtcbiAgcHJpdmF0ZSB3aWRnZXRJZDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgcmVhZG9ubHkgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgcHJpdmF0ZSByZWFkb25seSBpc0ludmlzaWJsZTogYm9vbGVhbjtcbiAgcHJpdmF0ZSByZWFkb25seSB0b2tlbkNoYW5nZUxpc3RlbmVycyA9IG5ldyBTZXQ8VG9rZW5DYWxsYmFjaz4oKTtcbiAgcHJpdmF0ZSByZW5kZXJQcm9taXNlOiBQcm9taXNlPG51bWJlcj4gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZWFkb25seSBhdXRoOiBBdXRoSW50ZXJuYWw7XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICByZWFkb25seSBfcmVjYXB0Y2hhTG9hZGVyOiBSZUNhcHRjaGFMb2FkZXI7XG4gIHByaXZhdGUgcmVjYXB0Y2hhOiBSZWNhcHRjaGEgfCBudWxsID0gbnVsbDtcblxuICAvKipcbiAgICogQHBhcmFtIGF1dGhFeHRlcm4gLSBUaGUgY29ycmVzcG9uZGluZyBGaXJlYmFzZSB7QGxpbmsgQXV0aH0gaW5zdGFuY2UuXG4gICAqXG4gICAqIEBwYXJhbSBjb250YWluZXJPcklkIC0gVGhlIHJlQ0FQVENIQSBjb250YWluZXIgcGFyYW1ldGVyLlxuICAgKlxuICAgKiBAcmVtYXJrc1xuICAgKiBUaGlzIGhhcyBkaWZmZXJlbnQgbWVhbmluZyBkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgcmVDQVBUQ0hBIGlzIGhpZGRlbiBvciB2aXNpYmxlLiBGb3IgYVxuICAgKiB2aXNpYmxlIHJlQ0FQVENIQSB0aGUgY29udGFpbmVyIG11c3QgYmUgZW1wdHkuIElmIGEgc3RyaW5nIGlzIHVzZWQsIGl0IGhhcyB0byBjb3JyZXNwb25kIHRvXG4gICAqIGFuIGVsZW1lbnQgSUQuIFRoZSBjb3JyZXNwb25kaW5nIGVsZW1lbnQgbXVzdCBhbHNvIG11c3QgYmUgaW4gdGhlIERPTSBhdCB0aGUgdGltZSBvZlxuICAgKiBpbml0aWFsaXphdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHBhcmFtZXRlcnMgLSBUaGUgb3B0aW9uYWwgcmVDQVBUQ0hBIHBhcmFtZXRlcnMuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIENoZWNrIHRoZSByZUNBUFRDSEEgZG9jcyBmb3IgYSBjb21wcmVoZW5zaXZlIGxpc3QuIEFsbCBwYXJhbWV0ZXJzIGFyZSBhY2NlcHRlZCBleGNlcHQgZm9yXG4gICAqIHRoZSBzaXRla2V5LiBGaXJlYmFzZSBBdXRoIGJhY2tlbmQgcHJvdmlzaW9ucyBhIHJlQ0FQVENIQSBmb3IgZWFjaCBwcm9qZWN0IGFuZCB3aWxsXG4gICAqIGNvbmZpZ3VyZSB0aGlzIHVwb24gcmVuZGVyaW5nLiBGb3IgYW4gaW52aXNpYmxlIHJlQ0FQVENIQSwgYSBzaXplIGtleSBtdXN0IGhhdmUgdGhlIHZhbHVlXG4gICAqICdpbnZpc2libGUnLlxuICAgKi9cbiAgY29uc3RydWN0b3IoXG4gICAgYXV0aEV4dGVybjogQXV0aCxcbiAgICBjb250YWluZXJPcklkOiBIVE1MRWxlbWVudCB8IHN0cmluZyxcbiAgICBwcml2YXRlIHJlYWRvbmx5IHBhcmFtZXRlcnM6IFJlY2FwdGNoYVBhcmFtZXRlcnMgPSB7XG4gICAgICAuLi5ERUZBVUxUX1BBUkFNU1xuICAgIH1cbiAgKSB7XG4gICAgdGhpcy5hdXRoID0gX2Nhc3RBdXRoKGF1dGhFeHRlcm4pO1xuICAgIHRoaXMuaXNJbnZpc2libGUgPSB0aGlzLnBhcmFtZXRlcnMuc2l6ZSA9PT0gJ2ludmlzaWJsZSc7XG4gICAgX2Fzc2VydChcbiAgICAgIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcsXG4gICAgICB0aGlzLmF1dGgsXG4gICAgICBBdXRoRXJyb3JDb2RlLk9QRVJBVElPTl9OT1RfU1VQUE9SVEVEXG4gICAgKTtcbiAgICBjb25zdCBjb250YWluZXIgPVxuICAgICAgdHlwZW9mIGNvbnRhaW5lck9ySWQgPT09ICdzdHJpbmcnXG4gICAgICAgID8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY29udGFpbmVyT3JJZClcbiAgICAgICAgOiBjb250YWluZXJPcklkO1xuICAgIF9hc3NlcnQoY29udGFpbmVyLCB0aGlzLmF1dGgsIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1IpO1xuXG4gICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XG4gICAgdGhpcy5wYXJhbWV0ZXJzLmNhbGxiYWNrID0gdGhpcy5tYWtlVG9rZW5DYWxsYmFjayh0aGlzLnBhcmFtZXRlcnMuY2FsbGJhY2spO1xuXG4gICAgdGhpcy5fcmVjYXB0Y2hhTG9hZGVyID0gdGhpcy5hdXRoLnNldHRpbmdzLmFwcFZlcmlmaWNhdGlvbkRpc2FibGVkRm9yVGVzdGluZ1xuICAgICAgPyBuZXcgTW9ja1JlQ2FwdGNoYUxvYWRlckltcGwoKVxuICAgICAgOiBuZXcgUmVDYXB0Y2hhTG9hZGVySW1wbCgpO1xuXG4gICAgdGhpcy52YWxpZGF0ZVN0YXJ0aW5nU3RhdGUoKTtcbiAgICAvLyBUT0RPOiBGaWd1cmUgb3V0IGlmIHNkayB2ZXJzaW9uIGlzIG5lZWRlZFxuICB9XG5cbiAgLyoqXG4gICAqIFdhaXRzIGZvciB0aGUgdXNlciB0byBzb2x2ZSB0aGUgcmVDQVBUQ0hBIGFuZCByZXNvbHZlcyB3aXRoIHRoZSByZUNBUFRDSEEgdG9rZW4uXG4gICAqXG4gICAqIEByZXR1cm5zIEEgUHJvbWlzZSBmb3IgdGhlIHJlQ0FQVENIQSB0b2tlbi5cbiAgICovXG4gIGFzeW5jIHZlcmlmeSgpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRoaXMuYXNzZXJ0Tm90RGVzdHJveWVkKCk7XG4gICAgY29uc3QgaWQgPSBhd2FpdCB0aGlzLnJlbmRlcigpO1xuICAgIGNvbnN0IHJlY2FwdGNoYSA9IHRoaXMuZ2V0QXNzZXJ0ZWRSZWNhcHRjaGEoKTtcblxuICAgIGNvbnN0IHJlc3BvbnNlID0gcmVjYXB0Y2hhLmdldFJlc3BvbnNlKGlkKTtcbiAgICBpZiAocmVzcG9uc2UpIHtcbiAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFByb21pc2U8c3RyaW5nPihyZXNvbHZlID0+IHtcbiAgICAgIGNvbnN0IHRva2VuQ2hhbmdlID0gKHRva2VuOiBzdHJpbmcpOiB2b2lkID0+IHtcbiAgICAgICAgaWYgKCF0b2tlbikge1xuICAgICAgICAgIHJldHVybjsgLy8gSWdub3JlIHRva2VuIGV4cGlyYXRpb25zLlxuICAgICAgICB9XG4gICAgICAgIHRoaXMudG9rZW5DaGFuZ2VMaXN0ZW5lcnMuZGVsZXRlKHRva2VuQ2hhbmdlKTtcbiAgICAgICAgcmVzb2x2ZSh0b2tlbik7XG4gICAgICB9O1xuXG4gICAgICB0aGlzLnRva2VuQ2hhbmdlTGlzdGVuZXJzLmFkZCh0b2tlbkNoYW5nZSk7XG4gICAgICBpZiAodGhpcy5pc0ludmlzaWJsZSkge1xuICAgICAgICByZWNhcHRjaGEuZXhlY3V0ZShpZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyB0aGUgcmVDQVBUQ0hBIHdpZGdldCBvbiB0aGUgcGFnZS5cbiAgICpcbiAgICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2l0aCB0aGUgcmVDQVBUQ0hBIHdpZGdldCBJRC5cbiAgICovXG4gIHJlbmRlcigpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmFzc2VydE5vdERlc3Ryb3llZCgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIFRoaXMgbWV0aG9kIHJldHVybnMgYSBwcm9taXNlLiBTaW5jZSBpdCdzIG5vdCBhc3luYyAod2Ugd2FudCB0byByZXR1cm4gdGhlXG4gICAgICAvLyBfc2FtZV8gcHJvbWlzZSBpZiByZW5kZXJpbmcgaXMgc3RpbGwgb2NjdXJyaW5nKSwgdGhlIEFQSSBzdXJmYWNlIHNob3VsZFxuICAgICAgLy8gcmVqZWN0IHdpdGggdGhlIGVycm9yIHJhdGhlciB0aGFuIGp1c3QgdGhyb3dcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5yZW5kZXJQcm9taXNlKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXJQcm9taXNlO1xuICAgIH1cblxuICAgIHRoaXMucmVuZGVyUHJvbWlzZSA9IHRoaXMubWFrZVJlbmRlclByb21pc2UoKS5jYXRjaChlID0+IHtcbiAgICAgIHRoaXMucmVuZGVyUHJvbWlzZSA9IG51bGw7XG4gICAgICB0aHJvdyBlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMucmVuZGVyUHJvbWlzZTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgX3Jlc2V0KCk6IHZvaWQge1xuICAgIHRoaXMuYXNzZXJ0Tm90RGVzdHJveWVkKCk7XG4gICAgaWYgKHRoaXMud2lkZ2V0SWQgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuZ2V0QXNzZXJ0ZWRSZWNhcHRjaGEoKS5yZXNldCh0aGlzLndpZGdldElkKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXJzIHRoZSByZUNBUFRDSEEgd2lkZ2V0IGZyb20gdGhlIHBhZ2UgYW5kIGRlc3Ryb3lzIHRoZSBpbnN0YW5jZS5cbiAgICovXG4gIGNsZWFyKCk6IHZvaWQge1xuICAgIHRoaXMuYXNzZXJ0Tm90RGVzdHJveWVkKCk7XG4gICAgdGhpcy5kZXN0cm95ZWQgPSB0cnVlO1xuICAgIHRoaXMuX3JlY2FwdGNoYUxvYWRlci5jbGVhcmVkT25lSW5zdGFuY2UoKTtcbiAgICBpZiAoIXRoaXMuaXNJbnZpc2libGUpIHtcbiAgICAgIHRoaXMuY29udGFpbmVyLmNoaWxkTm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgdGhpcy5jb250YWluZXIucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHZhbGlkYXRlU3RhcnRpbmdTdGF0ZSgpOiB2b2lkIHtcbiAgICBfYXNzZXJ0KCF0aGlzLnBhcmFtZXRlcnMuc2l0ZWtleSwgdGhpcy5hdXRoLCBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SKTtcbiAgICBfYXNzZXJ0KFxuICAgICAgdGhpcy5pc0ludmlzaWJsZSB8fCAhdGhpcy5jb250YWluZXIuaGFzQ2hpbGROb2RlcygpLFxuICAgICAgdGhpcy5hdXRoLFxuICAgICAgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUlxuICAgICk7XG4gICAgX2Fzc2VydChcbiAgICAgIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCcsXG4gICAgICB0aGlzLmF1dGgsXG4gICAgICBBdXRoRXJyb3JDb2RlLk9QRVJBVElPTl9OT1RfU1VQUE9SVEVEXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgbWFrZVRva2VuQ2FsbGJhY2soXG4gICAgZXhpc3Rpbmc6IFRva2VuQ2FsbGJhY2sgfCBzdHJpbmcgfCB1bmRlZmluZWRcbiAgKTogVG9rZW5DYWxsYmFjayB7XG4gICAgcmV0dXJuIHRva2VuID0+IHtcbiAgICAgIHRoaXMudG9rZW5DaGFuZ2VMaXN0ZW5lcnMuZm9yRWFjaChsaXN0ZW5lciA9PiBsaXN0ZW5lcih0b2tlbikpO1xuICAgICAgaWYgKHR5cGVvZiBleGlzdGluZyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBleGlzdGluZyh0b2tlbik7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBleGlzdGluZyA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgY29uc3QgZ2xvYmFsRnVuYyA9IF93aW5kb3coKVtleGlzdGluZ107XG4gICAgICAgIGlmICh0eXBlb2YgZ2xvYmFsRnVuYyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGdsb2JhbEZ1bmModG9rZW4pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXNzZXJ0Tm90RGVzdHJveWVkKCk6IHZvaWQge1xuICAgIF9hc3NlcnQoIXRoaXMuZGVzdHJveWVkLCB0aGlzLmF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBtYWtlUmVuZGVyUHJvbWlzZSgpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIGF3YWl0IHRoaXMuaW5pdCgpO1xuICAgIGlmICghdGhpcy53aWRnZXRJZCkge1xuICAgICAgbGV0IGNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyO1xuICAgICAgaWYgKCF0aGlzLmlzSW52aXNpYmxlKSB7XG4gICAgICAgIGNvbnN0IGd1YXJhbnRlZWRFbXB0eSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZ3VhcmFudGVlZEVtcHR5KTtcbiAgICAgICAgY29udGFpbmVyID0gZ3VhcmFudGVlZEVtcHR5O1xuICAgICAgfVxuXG4gICAgICB0aGlzLndpZGdldElkID0gdGhpcy5nZXRBc3NlcnRlZFJlY2FwdGNoYSgpLnJlbmRlcihcbiAgICAgICAgY29udGFpbmVyLFxuICAgICAgICB0aGlzLnBhcmFtZXRlcnNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMud2lkZ2V0SWQ7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGluaXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgX2Fzc2VydChcbiAgICAgIF9pc0h0dHBPckh0dHBzKCkgJiYgIV9pc1dvcmtlcigpLFxuICAgICAgdGhpcy5hdXRoLFxuICAgICAgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUlxuICAgICk7XG5cbiAgICBhd2FpdCBkb21SZWFkeSgpO1xuICAgIHRoaXMucmVjYXB0Y2hhID0gYXdhaXQgdGhpcy5fcmVjYXB0Y2hhTG9hZGVyLmxvYWQoXG4gICAgICB0aGlzLmF1dGgsXG4gICAgICB0aGlzLmF1dGgubGFuZ3VhZ2VDb2RlIHx8IHVuZGVmaW5lZFxuICAgICk7XG5cbiAgICBjb25zdCBzaXRlS2V5ID0gYXdhaXQgZ2V0UmVjYXB0Y2hhUGFyYW1zKHRoaXMuYXV0aCk7XG4gICAgX2Fzc2VydChzaXRlS2V5LCB0aGlzLmF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICAgIHRoaXMucGFyYW1ldGVycy5zaXRla2V5ID0gc2l0ZUtleTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0QXNzZXJ0ZWRSZWNhcHRjaGEoKTogUmVjYXB0Y2hhIHtcbiAgICBfYXNzZXJ0KHRoaXMucmVjYXB0Y2hhLCB0aGlzLmF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICAgIHJldHVybiB0aGlzLnJlY2FwdGNoYTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkb21SZWFkeSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgbGV0IHJlc29sdmVyOiAoKCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcbiAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KHJlc29sdmUgPT4ge1xuICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnY29tcGxldGUnKSB7XG4gICAgICByZXNvbHZlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRG9jdW1lbnQgbm90IHJlYWR5LCB3YWl0IGZvciBsb2FkIGJlZm9yZSByZXNvbHZpbmcuXG4gICAgLy8gU2F2ZSByZXNvbHZlciwgc28gd2UgY2FuIHJlbW92ZSBsaXN0ZW5lciBpbiBjYXNlIGl0IHdhcyBleHRlcm5hbGx5XG4gICAgLy8gY2FuY2VsbGVkLlxuICAgIHJlc29sdmVyID0gKCkgPT4gcmVzb2x2ZSgpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgcmVzb2x2ZXIpO1xuICB9KS5jYXRjaChlID0+IHtcbiAgICBpZiAocmVzb2x2ZXIpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgcmVzb2x2ZXIpO1xuICAgIH1cblxuICAgIHRocm93IGU7XG4gIH0pO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEFwcGxpY2F0aW9uVmVyaWZpZXIsXG4gIEF1dGgsXG4gIENvbmZpcm1hdGlvblJlc3VsdCxcbiAgUGhvbmVJbmZvT3B0aW9ucyxcbiAgVXNlcixcbiAgVXNlckNyZWRlbnRpYWxcbn0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHsgc3RhcnRFbnJvbGxQaG9uZU1mYSB9IGZyb20gJy4uLy4uL2FwaS9hY2NvdW50X21hbmFnZW1lbnQvbWZhJztcbmltcG9ydCB7IHN0YXJ0U2lnbkluUGhvbmVNZmEgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IHNlbmRQaG9uZVZlcmlmaWNhdGlvbkNvZGUgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vc21zJztcbmltcG9ydCB7IEFwcGxpY2F0aW9uVmVyaWZpZXJJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2FwcGxpY2F0aW9uX3ZlcmlmaWVyJztcbmltcG9ydCB7IFBob25lQXV0aENyZWRlbnRpYWwgfSBmcm9tICcuLi8uLi9jb3JlL2NyZWRlbnRpYWxzL3Bob25lJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi8uLi9jb3JlL2Vycm9ycyc7XG5pbXBvcnQgeyBfYXNzZXJ0TGlua2VkU3RhdHVzLCBfbGluayB9IGZyb20gJy4uLy4uL2NvcmUvdXNlci9saW5rX3VubGluayc7XG5pbXBvcnQgeyBfYXNzZXJ0IH0gZnJvbSAnLi4vLi4vY29yZS91dGlsL2Fzc2VydCc7XG5pbXBvcnQgeyBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7XG4gIGxpbmtXaXRoQ3JlZGVudGlhbCxcbiAgcmVhdXRoZW50aWNhdGVXaXRoQ3JlZGVudGlhbCxcbiAgc2lnbkluV2l0aENyZWRlbnRpYWxcbn0gZnJvbSAnLi4vLi4vY29yZS9zdHJhdGVnaWVzL2NyZWRlbnRpYWwnO1xuaW1wb3J0IHtcbiAgTXVsdGlGYWN0b3JTZXNzaW9uSW1wbCxcbiAgTXVsdGlGYWN0b3JTZXNzaW9uVHlwZVxufSBmcm9tICcuLi8uLi9tZmEvbWZhX3Nlc3Npb24nO1xuaW1wb3J0IHsgVXNlckludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBSRUNBUFRDSEFfVkVSSUZJRVJfVFlQRSB9IGZyb20gJy4uL3JlY2FwdGNoYS9yZWNhcHRjaGFfdmVyaWZpZXInO1xuaW1wb3J0IHsgX2Nhc3RBdXRoIH0gZnJvbSAnLi4vLi4vY29yZS9hdXRoL2F1dGhfaW1wbCc7XG5pbXBvcnQgeyBnZXRNb2R1bGFySW5zdGFuY2UgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBQcm92aWRlcklkIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG5pbnRlcmZhY2UgT25Db25maXJtYXRpb25DYWxsYmFjayB7XG4gIChjcmVkZW50aWFsOiBQaG9uZUF1dGhDcmVkZW50aWFsKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD47XG59XG5cbmNsYXNzIENvbmZpcm1hdGlvblJlc3VsdEltcGwgaW1wbGVtZW50cyBDb25maXJtYXRpb25SZXN1bHQge1xuICBjb25zdHJ1Y3RvcihcbiAgICByZWFkb25seSB2ZXJpZmljYXRpb25JZDogc3RyaW5nLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgb25Db25maXJtYXRpb246IE9uQ29uZmlybWF0aW9uQ2FsbGJhY2tcbiAgKSB7fVxuXG4gIGNvbmZpcm0odmVyaWZpY2F0aW9uQ29kZTogc3RyaW5nKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD4ge1xuICAgIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gUGhvbmVBdXRoQ3JlZGVudGlhbC5fZnJvbVZlcmlmaWNhdGlvbihcbiAgICAgIHRoaXMudmVyaWZpY2F0aW9uSWQsXG4gICAgICB2ZXJpZmljYXRpb25Db2RlXG4gICAgKTtcbiAgICByZXR1cm4gdGhpcy5vbkNvbmZpcm1hdGlvbihhdXRoQ3JlZGVudGlhbCk7XG4gIH1cbn1cblxuLyoqXG4gKiBBc3luY2hyb25vdXNseSBzaWducyBpbiB1c2luZyBhIHBob25lIG51bWJlci5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhpcyBtZXRob2Qgc2VuZHMgYSBjb2RlIHZpYSBTTVMgdG8gdGhlIGdpdmVuXG4gKiBwaG9uZSBudW1iZXIsIGFuZCByZXR1cm5zIGEge0BsaW5rIENvbmZpcm1hdGlvblJlc3VsdH0uIEFmdGVyIHRoZSB1c2VyXG4gKiBwcm92aWRlcyB0aGUgY29kZSBzZW50IHRvIHRoZWlyIHBob25lLCBjYWxsIHtAbGluayBDb25maXJtYXRpb25SZXN1bHQuY29uZmlybX1cbiAqIHdpdGggdGhlIGNvZGUgdG8gc2lnbiB0aGUgdXNlciBpbi5cbiAqXG4gKiBGb3IgYWJ1c2UgcHJldmVudGlvbiwgdGhpcyBtZXRob2QgYWxzbyByZXF1aXJlcyBhIHtAbGluayBBcHBsaWNhdGlvblZlcmlmaWVyfS5cbiAqIFRoaXMgU0RLIGluY2x1ZGVzIGEgcmVDQVBUQ0hBLWJhc2VkIGltcGxlbWVudGF0aW9uLCB7QGxpbmsgUmVjYXB0Y2hhVmVyaWZpZXJ9LlxuICogVGhpcyBmdW5jdGlvbiBjYW4gd29yayBvbiBvdGhlciBwbGF0Zm9ybXMgdGhhdCBkbyBub3Qgc3VwcG9ydCB0aGVcbiAqIHtAbGluayBSZWNhcHRjaGFWZXJpZmllcn0gKGxpa2UgUmVhY3QgTmF0aXZlKSwgYnV0IHlvdSBuZWVkIHRvIHVzZSBhXG4gKiB0aGlyZC1wYXJ0eSB7QGxpbmsgQXBwbGljYXRpb25WZXJpZmllcn0gaW1wbGVtZW50YXRpb24uXG4gKlxuICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vICdyZWNhcHRjaGEtY29udGFpbmVyJyBpcyB0aGUgSUQgb2YgYW4gZWxlbWVudCBpbiB0aGUgRE9NLlxuICogY29uc3QgYXBwbGljYXRpb25WZXJpZmllciA9IG5ldyBmaXJlYmFzZS5hdXRoLlJlY2FwdGNoYVZlcmlmaWVyKCdyZWNhcHRjaGEtY29udGFpbmVyJyk7XG4gKiBjb25zdCBjb25maXJtYXRpb25SZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUGhvbmVOdW1iZXIoYXV0aCwgcGhvbmVOdW1iZXIsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xuICogLy8gT2J0YWluIGEgdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxuICogY29uc3QgY3JlZGVudGlhbCA9IGF3YWl0IGNvbmZpcm1hdGlvblJlc3VsdC5jb25maXJtKHZlcmlmaWNhdGlvbkNvZGUpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIGF1dGggLSBUaGUge0BsaW5rIEF1dGh9IGluc3RhbmNlLlxuICogQHBhcmFtIHBob25lTnVtYmVyIC0gVGhlIHVzZXIncyBwaG9uZSBudW1iZXIgaW4gRS4xNjQgZm9ybWF0IChlLmcuICsxNjUwNTU1MDEwMSkuXG4gKiBAcGFyYW0gYXBwVmVyaWZpZXIgLSBUaGUge0BsaW5rIEFwcGxpY2F0aW9uVmVyaWZpZXJ9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNpZ25JbldpdGhQaG9uZU51bWJlcihcbiAgYXV0aDogQXV0aCxcbiAgcGhvbmVOdW1iZXI6IHN0cmluZyxcbiAgYXBwVmVyaWZpZXI6IEFwcGxpY2F0aW9uVmVyaWZpZXJcbik6IFByb21pc2U8Q29uZmlybWF0aW9uUmVzdWx0PiB7XG4gIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBfdmVyaWZ5UGhvbmVOdW1iZXIoXG4gICAgYXV0aEludGVybmFsLFxuICAgIHBob25lTnVtYmVyLFxuICAgIGdldE1vZHVsYXJJbnN0YW5jZShhcHBWZXJpZmllciBhcyBBcHBsaWNhdGlvblZlcmlmaWVySW50ZXJuYWwpXG4gICk7XG4gIHJldHVybiBuZXcgQ29uZmlybWF0aW9uUmVzdWx0SW1wbCh2ZXJpZmljYXRpb25JZCwgY3JlZCA9PlxuICAgIHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGhJbnRlcm5hbCwgY3JlZClcbiAgKTtcbn1cblxuLyoqXG4gKiBMaW5rcyB0aGUgdXNlciBhY2NvdW50IHdpdGggdGhlIGdpdmVuIHBob25lIG51bWJlci5cbiAqXG4gKiBAcmVtYXJrc1xuICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQuXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBwaG9uZU51bWJlciAtIFRoZSB1c2VyJ3MgcGhvbmUgbnVtYmVyIGluIEUuMTY0IGZvcm1hdCAoZS5nLiArMTY1MDU1NTAxMDEpLlxuICogQHBhcmFtIGFwcFZlcmlmaWVyIC0gVGhlIHtAbGluayBBcHBsaWNhdGlvblZlcmlmaWVyfS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rV2l0aFBob25lTnVtYmVyKFxuICB1c2VyOiBVc2VyLFxuICBwaG9uZU51bWJlcjogc3RyaW5nLFxuICBhcHBWZXJpZmllcjogQXBwbGljYXRpb25WZXJpZmllclxuKTogUHJvbWlzZTxDb25maXJtYXRpb25SZXN1bHQ+IHtcbiAgY29uc3QgdXNlckludGVybmFsID0gZ2V0TW9kdWxhckluc3RhbmNlKHVzZXIpIGFzIFVzZXJJbnRlcm5hbDtcbiAgYXdhaXQgX2Fzc2VydExpbmtlZFN0YXR1cyhmYWxzZSwgdXNlckludGVybmFsLCBQcm92aWRlcklkLlBIT05FKTtcbiAgY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBfdmVyaWZ5UGhvbmVOdW1iZXIoXG4gICAgdXNlckludGVybmFsLmF1dGgsXG4gICAgcGhvbmVOdW1iZXIsXG4gICAgZ2V0TW9kdWxhckluc3RhbmNlKGFwcFZlcmlmaWVyIGFzIEFwcGxpY2F0aW9uVmVyaWZpZXJJbnRlcm5hbClcbiAgKTtcbiAgcmV0dXJuIG5ldyBDb25maXJtYXRpb25SZXN1bHRJbXBsKHZlcmlmaWNhdGlvbklkLCBjcmVkID0+XG4gICAgbGlua1dpdGhDcmVkZW50aWFsKHVzZXJJbnRlcm5hbCwgY3JlZClcbiAgKTtcbn1cblxuLyoqXG4gKiBSZS1hdXRoZW50aWNhdGVzIGEgdXNlciB1c2luZyBhIGZyZXNoIHBob25lIGNyZWRlbnRpYWwuXG4gKlxuICogQHJlbWFya3NcbiAqIFVzZSBiZWZvcmUgb3BlcmF0aW9ucyBzdWNoIGFzIHtAbGluayB1cGRhdGVQYXNzd29yZH0gdGhhdCByZXF1aXJlIHRva2VucyBmcm9tIHJlY2VudCBzaWduLWluIGF0dGVtcHRzLlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcGhvbmVOdW1iZXIgLSBUaGUgdXNlcidzIHBob25lIG51bWJlciBpbiBFLjE2NCBmb3JtYXQgKGUuZy4gKzE2NTA1NTUwMTAxKS5cbiAqIEBwYXJhbSBhcHBWZXJpZmllciAtIFRoZSB7QGxpbmsgQXBwbGljYXRpb25WZXJpZmllcn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVhdXRoZW50aWNhdGVXaXRoUGhvbmVOdW1iZXIoXG4gIHVzZXI6IFVzZXIsXG4gIHBob25lTnVtYmVyOiBzdHJpbmcsXG4gIGFwcFZlcmlmaWVyOiBBcHBsaWNhdGlvblZlcmlmaWVyXG4pOiBQcm9taXNlPENvbmZpcm1hdGlvblJlc3VsdD4ge1xuICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikgYXMgVXNlckludGVybmFsO1xuICBjb25zdCB2ZXJpZmljYXRpb25JZCA9IGF3YWl0IF92ZXJpZnlQaG9uZU51bWJlcihcbiAgICB1c2VySW50ZXJuYWwuYXV0aCxcbiAgICBwaG9uZU51bWJlcixcbiAgICBnZXRNb2R1bGFySW5zdGFuY2UoYXBwVmVyaWZpZXIgYXMgQXBwbGljYXRpb25WZXJpZmllckludGVybmFsKVxuICApO1xuICByZXR1cm4gbmV3IENvbmZpcm1hdGlvblJlc3VsdEltcGwodmVyaWZpY2F0aW9uSWQsIGNyZWQgPT5cbiAgICByZWF1dGhlbnRpY2F0ZVdpdGhDcmVkZW50aWFsKHVzZXJJbnRlcm5hbCwgY3JlZClcbiAgKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgdmVyaWZpY2F0aW9uIElEIHRvIGJlIHVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCB0aGUgU01TIGNvZGUgdGhhdCBpcyBzZW50LlxuICpcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF92ZXJpZnlQaG9uZU51bWJlcihcbiAgYXV0aDogQXV0aEludGVybmFsLFxuICBvcHRpb25zOiBQaG9uZUluZm9PcHRpb25zIHwgc3RyaW5nLFxuICB2ZXJpZmllcjogQXBwbGljYXRpb25WZXJpZmllckludGVybmFsXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCByZWNhcHRjaGFUb2tlbiA9IGF3YWl0IHZlcmlmaWVyLnZlcmlmeSgpO1xuXG4gIHRyeSB7XG4gICAgX2Fzc2VydChcbiAgICAgIHR5cGVvZiByZWNhcHRjaGFUb2tlbiA9PT0gJ3N0cmluZycsXG4gICAgICBhdXRoLFxuICAgICAgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUlxuICAgICk7XG4gICAgX2Fzc2VydChcbiAgICAgIHZlcmlmaWVyLnR5cGUgPT09IFJFQ0FQVENIQV9WRVJJRklFUl9UWVBFLFxuICAgICAgYXV0aCxcbiAgICAgIEF1dGhFcnJvckNvZGUuQVJHVU1FTlRfRVJST1JcbiAgICApO1xuXG4gICAgbGV0IHBob25lSW5mb09wdGlvbnM6IFBob25lSW5mb09wdGlvbnM7XG5cbiAgICBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XG4gICAgICBwaG9uZUluZm9PcHRpb25zID0ge1xuICAgICAgICBwaG9uZU51bWJlcjogb3B0aW9uc1xuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGhvbmVJbmZvT3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgfVxuXG4gICAgaWYgKCdzZXNzaW9uJyBpbiBwaG9uZUluZm9PcHRpb25zKSB7XG4gICAgICBjb25zdCBzZXNzaW9uID0gcGhvbmVJbmZvT3B0aW9ucy5zZXNzaW9uIGFzIE11bHRpRmFjdG9yU2Vzc2lvbkltcGw7XG5cbiAgICAgIGlmICgncGhvbmVOdW1iZXInIGluIHBob25lSW5mb09wdGlvbnMpIHtcbiAgICAgICAgX2Fzc2VydChcbiAgICAgICAgICBzZXNzaW9uLnR5cGUgPT09IE11bHRpRmFjdG9yU2Vzc2lvblR5cGUuRU5ST0xMLFxuICAgICAgICAgIGF1dGgsXG4gICAgICAgICAgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUlxuICAgICAgICApO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHN0YXJ0RW5yb2xsUGhvbmVNZmEoYXV0aCwge1xuICAgICAgICAgIGlkVG9rZW46IHNlc3Npb24uY3JlZGVudGlhbCxcbiAgICAgICAgICBwaG9uZUVucm9sbG1lbnRJbmZvOiB7XG4gICAgICAgICAgICBwaG9uZU51bWJlcjogcGhvbmVJbmZvT3B0aW9ucy5waG9uZU51bWJlcixcbiAgICAgICAgICAgIHJlY2FwdGNoYVRva2VuXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnBob25lU2Vzc2lvbkluZm8uc2Vzc2lvbkluZm87XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBfYXNzZXJ0KFxuICAgICAgICAgIHNlc3Npb24udHlwZSA9PT0gTXVsdGlGYWN0b3JTZXNzaW9uVHlwZS5TSUdOX0lOLFxuICAgICAgICAgIGF1dGgsXG4gICAgICAgICAgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUlxuICAgICAgICApO1xuICAgICAgICBjb25zdCBtZmFFbnJvbGxtZW50SWQgPVxuICAgICAgICAgIHBob25lSW5mb09wdGlvbnMubXVsdGlGYWN0b3JIaW50Py51aWQgfHxcbiAgICAgICAgICBwaG9uZUluZm9PcHRpb25zLm11bHRpRmFjdG9yVWlkO1xuICAgICAgICBfYXNzZXJ0KG1mYUVucm9sbG1lbnRJZCwgYXV0aCwgQXV0aEVycm9yQ29kZS5NSVNTSU5HX01GQV9JTkZPKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdGFydFNpZ25JblBob25lTWZhKGF1dGgsIHtcbiAgICAgICAgICBtZmFQZW5kaW5nQ3JlZGVudGlhbDogc2Vzc2lvbi5jcmVkZW50aWFsLFxuICAgICAgICAgIG1mYUVucm9sbG1lbnRJZCxcbiAgICAgICAgICBwaG9uZVNpZ25JbkluZm86IHtcbiAgICAgICAgICAgIHJlY2FwdGNoYVRva2VuXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnBob25lUmVzcG9uc2VJbmZvLnNlc3Npb25JbmZvO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB7IHNlc3Npb25JbmZvIH0gPSBhd2FpdCBzZW5kUGhvbmVWZXJpZmljYXRpb25Db2RlKGF1dGgsIHtcbiAgICAgICAgcGhvbmVOdW1iZXI6IHBob25lSW5mb09wdGlvbnMucGhvbmVOdW1iZXIsXG4gICAgICAgIHJlY2FwdGNoYVRva2VuXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBzZXNzaW9uSW5mbztcbiAgICB9XG4gIH0gZmluYWxseSB7XG4gICAgdmVyaWZpZXIuX3Jlc2V0KCk7XG4gIH1cbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSB1c2VyJ3MgcGhvbmUgbnVtYmVyLlxuICpcbiAqIEByZW1hcmtzXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgXG4gKiAvLyAncmVjYXB0Y2hhLWNvbnRhaW5lcicgaXMgdGhlIElEIG9mIGFuIGVsZW1lbnQgaW4gdGhlIERPTS5cbiAqIGNvbnN0IGFwcGxpY2F0aW9uVmVyaWZpZXIgPSBuZXcgUmVjYXB0Y2hhVmVyaWZpZXIoJ3JlY2FwdGNoYS1jb250YWluZXInKTtcbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IFBob25lQXV0aFByb3ZpZGVyKGF1dGgpO1xuICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcignKzE2NTA1NTUwMTAxJywgYXBwbGljYXRpb25WZXJpZmllcik7XG4gKiAvLyBPYnRhaW4gdGhlIHZlcmlmaWNhdGlvbkNvZGUgZnJvbSB0aGUgdXNlci5cbiAqIGNvbnN0IHBob25lQ3JlZGVudGlhbCA9IFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpO1xuICogYXdhaXQgdXBkYXRlUGhvbmVOdW1iZXIodXNlciwgcGhvbmVDcmVkZW50aWFsKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gY3JlZGVudGlhbCAtIEEgY3JlZGVudGlhbCBhdXRoZW50aWNhdGluZyB0aGUgbmV3IHBob25lIG51bWJlci5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQaG9uZU51bWJlcihcbiAgdXNlcjogVXNlcixcbiAgY3JlZGVudGlhbDogUGhvbmVBdXRoQ3JlZGVudGlhbFxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGF3YWl0IF9saW5rKGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSBhcyBVc2VySW50ZXJuYWwsIGNyZWRlbnRpYWwpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEF1dGgsXG4gIFBob25lSW5mb09wdGlvbnMsXG4gIEFwcGxpY2F0aW9uVmVyaWZpZXIsXG4gIFVzZXJDcmVkZW50aWFsXG59IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCB7IFNpZ25JbldpdGhQaG9uZU51bWJlclJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vYXBpL2F1dGhlbnRpY2F0aW9uL3Ntcyc7XG5pbXBvcnQgeyBBcHBsaWNhdGlvblZlcmlmaWVySW50ZXJuYWwgYXMgQXBwbGljYXRpb25WZXJpZmllckludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXBwbGljYXRpb25fdmVyaWZpZXInO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIGFzIEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbnRlcm5hbCBhcyBVc2VyQ3JlZGVudGlhbEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBQaG9uZUF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vLi4vY29yZS9jcmVkZW50aWFscy9waG9uZSc7XG5pbXBvcnQgeyBfdmVyaWZ5UGhvbmVOdW1iZXIgfSBmcm9tICcuLi9zdHJhdGVnaWVzL3Bob25lJztcbmltcG9ydCB7IF9jYXN0QXV0aCB9IGZyb20gJy4uLy4uL2NvcmUvYXV0aC9hdXRoX2ltcGwnO1xuaW1wb3J0IHsgQXV0aENyZWRlbnRpYWwgfSBmcm9tICcuLi8uLi9jb3JlJztcbmltcG9ydCB7IEZpcmViYXNlRXJyb3IsIGdldE1vZHVsYXJJbnN0YW5jZSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgUHJvdmlkZXJJZCwgU2lnbkluTWV0aG9kIH0gZnJvbSAnLi4vLi4vbW9kZWwvZW51bXMnO1xuXG4vKipcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIGFuIHtAbGluayBQaG9uZUF1dGhDcmVkZW50aWFsfS5cbiAqXG4gKiBAcmVtYXJrc1xuICogYFBob25lQXV0aFByb3ZpZGVyYCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gJ3JlY2FwdGNoYS1jb250YWluZXInIGlzIHRoZSBJRCBvZiBhbiBlbGVtZW50IGluIHRoZSBET00uXG4gKiBjb25zdCBhcHBsaWNhdGlvblZlcmlmaWVyID0gbmV3IFJlY2FwdGNoYVZlcmlmaWVyKCdyZWNhcHRjaGEtY29udGFpbmVyJyk7XG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcbiAqIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgcHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXIoJysxNjUwNTU1MDEwMScsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xuICogLy8gT2J0YWluIHRoZSB2ZXJpZmljYXRpb25Db2RlIGZyb20gdGhlIHVzZXIuXG4gKiBjb25zdCBwaG9uZUNyZWRlbnRpYWwgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsKHZlcmlmaWNhdGlvbklkLCB2ZXJpZmljYXRpb25Db2RlKTtcbiAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgcGhvbmVDcmVkZW50aWFsKTtcbiAqIGBgYFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIFBob25lQXV0aFByb3ZpZGVyIHtcbiAgLyoqIEFsd2F5cyBzZXQgdG8ge0BsaW5rIFByb3ZpZGVySWR9LlBIT05FLiAqL1xuICBzdGF0aWMgcmVhZG9ubHkgUFJPVklERVJfSUQ6ICdwaG9uZScgPSBQcm92aWRlcklkLlBIT05FO1xuICAvKiogQWx3YXlzIHNldCB0byB7QGxpbmsgU2lnbkluTWV0aG9kfS5QSE9ORS4gKi9cbiAgc3RhdGljIHJlYWRvbmx5IFBIT05FX1NJR05fSU5fTUVUSE9EOiAncGhvbmUnID0gU2lnbkluTWV0aG9kLlBIT05FO1xuXG4gIC8qKiBBbHdheXMgc2V0IHRvIHtAbGluayBQcm92aWRlcklkfS5QSE9ORS4gKi9cbiAgcmVhZG9ubHkgcHJvdmlkZXJJZCA9IFBob25lQXV0aFByb3ZpZGVyLlBST1ZJREVSX0lEO1xuICBwcml2YXRlIHJlYWRvbmx5IGF1dGg6IEF1dGhJbnRlcm5hbDtcblxuICAvKipcbiAgICogQHBhcmFtIGF1dGggLSBUaGUgRmlyZWJhc2Uge0BsaW5rIEF1dGh9IGluc3RhbmNlIGluIHdoaWNoIHNpZ24taW5zIHNob3VsZCBvY2N1ci5cbiAgICpcbiAgICovXG4gIGNvbnN0cnVjdG9yKGF1dGg6IEF1dGgpIHtcbiAgICB0aGlzLmF1dGggPSBfY2FzdEF1dGgoYXV0aCk7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogU3RhcnRzIGEgcGhvbmUgbnVtYmVyIGF1dGhlbnRpY2F0aW9uIGZsb3cgYnkgc2VuZGluZyBhIHZlcmlmaWNhdGlvbiBjb2RlIHRvIHRoZSBnaXZlbiBwaG9uZVxuICAgKiBudW1iZXIuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogY29uc3QgcHJvdmlkZXIgPSBuZXcgUGhvbmVBdXRoUHJvdmlkZXIoYXV0aCk7XG4gICAqIGNvbnN0IHZlcmlmaWNhdGlvbklkID0gYXdhaXQgcHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXIocGhvbmVOdW1iZXIsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xuICAgKiAvLyBPYnRhaW4gdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxuICAgKiBjb25zdCBhdXRoQ3JlZGVudGlhbCA9IFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodmVyaWZpY2F0aW9uSWQsIHZlcmlmaWNhdGlvbkNvZGUpO1xuICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGF3YWl0IHNpZ25JbldpdGhDcmVkZW50aWFsKGF1dGgsIGF1dGhDcmVkZW50aWFsKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIEFuIGFsdGVybmF0aXZlIGZsb3cgaXMgcHJvdmlkZWQgdXNpbmcgdGhlIGBzaWduSW5XaXRoUGhvbmVOdW1iZXJgIG1ldGhvZC5cbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCBjb25maXJtYXRpb25SZXN1bHQgPSBzaWduSW5XaXRoUGhvbmVOdW1iZXIoYXV0aCwgcGhvbmVOdW1iZXIsIGFwcGxpY2F0aW9uVmVyaWZpZXIpO1xuICAgKiAvLyBPYnRhaW4gdmVyaWZpY2F0aW9uQ29kZSBmcm9tIHRoZSB1c2VyLlxuICAgKiBjb25zdCB1c2VyQ3JlZGVudGlhbCA9IGNvbmZpcm1hdGlvblJlc3VsdC5jb25maXJtKHZlcmlmaWNhdGlvbkNvZGUpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIHBob25lSW5mb09wdGlvbnMgLSBUaGUgdXNlcidzIHtAbGluayBQaG9uZUluZm9PcHRpb25zfS4gVGhlIHBob25lIG51bWJlciBzaG91bGQgYmUgaW5cbiAgICogRS4xNjQgZm9ybWF0IChlLmcuICsxNjUwNTU1MDEwMSkuXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvblZlcmlmaWVyIC0gRm9yIGFidXNlIHByZXZlbnRpb24sIHRoaXMgbWV0aG9kIGFsc28gcmVxdWlyZXMgYVxuICAgKiB7QGxpbmsgQXBwbGljYXRpb25WZXJpZmllcn0uIFRoaXMgU0RLIGluY2x1ZGVzIGEgcmVDQVBUQ0hBLWJhc2VkIGltcGxlbWVudGF0aW9uLFxuICAgKiB7QGxpbmsgUmVjYXB0Y2hhVmVyaWZpZXJ9LlxuICAgKlxuICAgKiBAcmV0dXJucyBBIFByb21pc2UgZm9yIGEgdmVyaWZpY2F0aW9uIElEIHRoYXQgY2FuIGJlIHBhc3NlZCB0b1xuICAgKiB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbH0gdG8gaWRlbnRpZnkgdGhpcyBmbG93Li5cbiAgICovXG4gIHZlcmlmeVBob25lTnVtYmVyKFxuICAgIHBob25lT3B0aW9uczogUGhvbmVJbmZvT3B0aW9ucyB8IHN0cmluZyxcbiAgICBhcHBsaWNhdGlvblZlcmlmaWVyOiBBcHBsaWNhdGlvblZlcmlmaWVyXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgcmV0dXJuIF92ZXJpZnlQaG9uZU51bWJlcihcbiAgICAgIHRoaXMuYXV0aCxcbiAgICAgIHBob25lT3B0aW9ucyxcbiAgICAgIGdldE1vZHVsYXJJbnN0YW5jZShhcHBsaWNhdGlvblZlcmlmaWVyIGFzIEFwcGxpY2F0aW9uVmVyaWZpZXJJbnRlcm5hbClcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBwaG9uZSBhdXRoIGNyZWRlbnRpYWwsIGdpdmVuIHRoZSB2ZXJpZmljYXRpb24gSUQgZnJvbVxuICAgKiB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIudmVyaWZ5UGhvbmVOdW1iZXJ9IGFuZCB0aGUgY29kZSB0aGF0IHdhcyBzZW50IHRvIHRoZSB1c2VyJ3NcbiAgICogbW9iaWxlIGRldmljZS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcbiAgICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcihwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XG4gICAqIC8vIE9idGFpbiB2ZXJpZmljYXRpb25Db2RlIGZyb20gdGhlIHVzZXIuXG4gICAqIGNvbnN0IGF1dGhDcmVkZW50aWFsID0gUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbCh2ZXJpZmljYXRpb25JZCwgdmVyaWZpY2F0aW9uQ29kZSk7XG4gICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gc2lnbkluV2l0aENyZWRlbnRpYWwoYXV0aCwgYXV0aENyZWRlbnRpYWwpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogQW4gYWx0ZXJuYXRpdmUgZmxvdyBpcyBwcm92aWRlZCB1c2luZyB0aGUgYHNpZ25JbldpdGhQaG9uZU51bWJlcmAgbWV0aG9kLlxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIGNvbnN0IGNvbmZpcm1hdGlvblJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQaG9uZU51bWJlcihhdXRoLCBwaG9uZU51bWJlciwgYXBwbGljYXRpb25WZXJpZmllcik7XG4gICAqIC8vIE9idGFpbiB2ZXJpZmljYXRpb25Db2RlIGZyb20gdGhlIHVzZXIuXG4gICAqIGNvbnN0IHVzZXJDcmVkZW50aWFsID0gYXdhaXQgY29uZmlybWF0aW9uUmVzdWx0LmNvbmZpcm0odmVyaWZpY2F0aW9uQ29kZSk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gdmVyaWZpY2F0aW9uSWQgLSBUaGUgdmVyaWZpY2F0aW9uIElEIHJldHVybmVkIGZyb20ge0BsaW5rIFBob25lQXV0aFByb3ZpZGVyLnZlcmlmeVBob25lTnVtYmVyfS5cbiAgICogQHBhcmFtIHZlcmlmaWNhdGlvbkNvZGUgLSBUaGUgdmVyaWZpY2F0aW9uIGNvZGUgc2VudCB0byB0aGUgdXNlcidzIG1vYmlsZSBkZXZpY2UuXG4gICAqXG4gICAqIEByZXR1cm5zIFRoZSBhdXRoIHByb3ZpZGVyIGNyZWRlbnRpYWwuXG4gICAqL1xuICBzdGF0aWMgY3JlZGVudGlhbChcbiAgICB2ZXJpZmljYXRpb25JZDogc3RyaW5nLFxuICAgIHZlcmlmaWNhdGlvbkNvZGU6IHN0cmluZ1xuICApOiBQaG9uZUF1dGhDcmVkZW50aWFsIHtcbiAgICByZXR1cm4gUGhvbmVBdXRoQ3JlZGVudGlhbC5fZnJvbVZlcmlmaWNhdGlvbihcbiAgICAgIHZlcmlmaWNhdGlvbklkLFxuICAgICAgdmVyaWZpY2F0aW9uQ29kZVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIGFuIHtAbGluayBBdXRoQ3JlZGVudGlhbH0gZnJvbSBhIHtAbGluayBVc2VyQ3JlZGVudGlhbH0uXG4gICAqIEBwYXJhbSB1c2VyQ3JlZGVudGlhbCAtIFRoZSB1c2VyIGNyZWRlbnRpYWwuXG4gICAqL1xuICBzdGF0aWMgY3JlZGVudGlhbEZyb21SZXN1bHQoXG4gICAgdXNlckNyZWRlbnRpYWw6IFVzZXJDcmVkZW50aWFsXG4gICk6IEF1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgY29uc3QgY3JlZGVudGlhbCA9IHVzZXJDcmVkZW50aWFsIGFzIFVzZXJDcmVkZW50aWFsSW50ZXJuYWw7XG4gICAgcmV0dXJuIFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KGNyZWRlbnRpYWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYW4ge0BsaW5rIEF1dGhDcmVkZW50aWFsfSB3aGVuIHBhc3NlZCBhbiBlcnJvci5cbiAgICpcbiAgICogQHJlbWFya3NcbiAgICpcbiAgICogVGhpcyBtZXRob2Qgd29ya3MgZm9yIGVycm9ycyBsaWtlXG4gICAqIGBhdXRoL2FjY291bnQtZXhpc3RzLXdpdGgtZGlmZmVyZW50LWNyZWRlbnRpYWxzYC4gVGhpcyBpcyB1c2VmdWwgZm9yXG4gICAqIHJlY292ZXJpbmcgd2hlbiBhdHRlbXB0aW5nIHRvIHNldCBhIHVzZXIncyBwaG9uZSBudW1iZXIgYnV0IHRoZSBudW1iZXJcbiAgICogaW4gcXVlc3Rpb24gaXMgYWxyZWFkeSB0aWVkIHRvIGFub3RoZXIgYWNjb3VudC4gRm9yIGV4YW1wbGUsIHRoZSBmb2xsb3dpbmdcbiAgICogY29kZSB0cmllcyB0byB1cGRhdGUgdGhlIGN1cnJlbnQgdXNlcidzIHBob25lIG51bWJlciwgYW5kIGlmIHRoYXRcbiAgICogZmFpbHMsIGxpbmtzIHRoZSB1c2VyIHdpdGggdGhlIGFjY291bnQgYXNzb2NpYXRlZCB3aXRoIHRoYXQgbnVtYmVyOlxuICAgKlxuICAgKiBgYGBqc1xuICAgKiBjb25zdCBwcm92aWRlciA9IG5ldyBQaG9uZUF1dGhQcm92aWRlcihhdXRoKTtcbiAgICogY29uc3QgdmVyaWZpY2F0aW9uSWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlQaG9uZU51bWJlcihudW1iZXIsIHZlcmlmaWVyKTtcbiAgICogdHJ5IHtcbiAgICogICBjb25zdCBjb2RlID0gJyc7IC8vIFByb21wdCB0aGUgdXNlciBmb3IgdGhlIHZlcmlmaWNhdGlvbiBjb2RlXG4gICAqICAgYXdhaXQgdXBkYXRlUGhvbmVOdW1iZXIoXG4gICAqICAgICAgIGF1dGguY3VycmVudFVzZXIsXG4gICAqICAgICAgIFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWwodmVyaWZpY2F0aW9uSWQsIGNvZGUpKTtcbiAgICogfSBjYXRjaCAoZSkge1xuICAgKiAgIGlmICgoZSBhcyBGaXJlYmFzZUVycm9yKT8uY29kZSA9PT0gJ2F1dGgvYWNjb3VudC1leGlzdHMtd2l0aC1kaWZmZXJlbnQtY3JlZGVudGlhbCcpIHtcbiAgICogICAgIGNvbnN0IGNyZWQgPSBQaG9uZUF1dGhQcm92aWRlci5jcmVkZW50aWFsRnJvbUVycm9yKGUpO1xuICAgKiAgICAgYXdhaXQgbGlua1dpdGhDcmVkZW50aWFsKGF1dGguY3VycmVudFVzZXIsIGNyZWQpO1xuICAgKiAgIH1cbiAgICogfVxuICAgKlxuICAgKiAvLyBBdCB0aGlzIHBvaW50LCBhdXRoLmN1cnJlbnRVc2VyLnBob25lTnVtYmVyID09PSBudW1iZXIuXG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gZXJyb3IgLSBUaGUgZXJyb3IgdG8gZ2VuZXJhdGUgYSBjcmVkZW50aWFsIGZyb20uXG4gICAqL1xuICBzdGF0aWMgY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcjogRmlyZWJhc2VFcnJvcik6IEF1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgcmV0dXJuIFBob25lQXV0aFByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KFxuICAgICAgKGVycm9yLmN1c3RvbURhdGEgfHwge30pIGFzIFRhZ2dlZFdpdGhUb2tlblJlc3BvbnNlXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGNyZWRlbnRpYWxGcm9tVGFnZ2VkT2JqZWN0KHtcbiAgICBfdG9rZW5SZXNwb25zZTogdG9rZW5SZXNwb25zZVxuICB9OiBUYWdnZWRXaXRoVG9rZW5SZXNwb25zZSk6IEF1dGhDcmVkZW50aWFsIHwgbnVsbCB7XG4gICAgaWYgKCF0b2tlblJlc3BvbnNlKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgeyBwaG9uZU51bWJlciwgdGVtcG9yYXJ5UHJvb2YgfSA9XG4gICAgICB0b2tlblJlc3BvbnNlIGFzIFNpZ25JbldpdGhQaG9uZU51bWJlclJlc3BvbnNlO1xuICAgIGlmIChwaG9uZU51bWJlciAmJiB0ZW1wb3JhcnlQcm9vZikge1xuICAgICAgcmV0dXJuIFBob25lQXV0aENyZWRlbnRpYWwuX2Zyb21Ub2tlblJlc3BvbnNlKFxuICAgICAgICBwaG9uZU51bWJlcixcbiAgICAgICAgdGVtcG9yYXJ5UHJvb2ZcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgUG9wdXBSZWRpcmVjdFJlc29sdmVyIH0gZnJvbSAnLi4vLi4vbW9kZWwvcHVibGljX3R5cGVzJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9wb3B1cF9yZWRpcmVjdCc7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IF9hc3NlcnQgfSBmcm9tICcuL2Fzc2VydCc7XG5pbXBvcnQgeyBfZ2V0SW5zdGFuY2UgfSBmcm9tICcuL2luc3RhbnRpYXRvcic7XG5cbi8qKlxuICogQ2hvb3NlcyBhIHBvcHVwL3JlZGlyZWN0IHJlc29sdmVyIHRvIHVzZS4gVGhpcyBwcmVmZXJzIHRoZSBvdmVycmlkZSAod2hpY2hcbiAqIGlzIGRpcmVjdGx5IHBhc3NlZCBpbiksIGFuZCBmYWxscyBiYWNrIHRvIHRoZSBwcm9wZXJ0eSBzZXQgb24gdGhlIGF1dGhcbiAqIG9iamVjdC4gSWYgbmVpdGhlciBhcmUgYXZhaWxhYmxlLCB0aGlzIGZ1bmN0aW9uIGVycm9ycyB3LyBhbiBhcmd1bWVudCBlcnJvci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF93aXRoRGVmYXVsdFJlc29sdmVyKFxuICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gIHJlc29sdmVyT3ZlcnJpZGU6IFBvcHVwUmVkaXJlY3RSZXNvbHZlciB8IHVuZGVmaW5lZFxuKTogUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWwge1xuICBpZiAocmVzb2x2ZXJPdmVycmlkZSkge1xuICAgIHJldHVybiBfZ2V0SW5zdGFuY2UocmVzb2x2ZXJPdmVycmlkZSk7XG4gIH1cblxuICBfYXNzZXJ0KGF1dGguX3BvcHVwUmVkaXJlY3RSZXNvbHZlciwgYXV0aCwgQXV0aEVycm9yQ29kZS5BUkdVTUVOVF9FUlJPUik7XG5cbiAgcmV0dXJuIGF1dGguX3BvcHVwUmVkaXJlY3RSZXNvbHZlcjtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQge1xuICBzaWduSW5XaXRoSWRwLFxuICBTaWduSW5XaXRoSWRwUmVxdWVzdFxufSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vaWRwJztcbmltcG9ydCB7IFBob25lT3JPYXV0aFRva2VuUmVzcG9uc2UgfSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgSWRUb2tlblJlc3BvbnNlIH0gZnJvbSAnLi4vLi4vbW9kZWwvaWRfdG9rZW4nO1xuaW1wb3J0IHsgVXNlckludGVybmFsLCBVc2VyQ3JlZGVudGlhbEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBBdXRoQ3JlZGVudGlhbCB9IGZyb20gJy4uL2NyZWRlbnRpYWxzJztcbmltcG9ydCB7IF9saW5rIGFzIF9saW5rVXNlciB9IGZyb20gJy4uL3VzZXIvbGlua191bmxpbmsnO1xuaW1wb3J0IHsgX3JlYXV0aGVudGljYXRlIH0gZnJvbSAnLi4vdXNlci9yZWF1dGhlbnRpY2F0ZSc7XG5pbXBvcnQgeyBfYXNzZXJ0IH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgX3NpZ25JbldpdGhDcmVkZW50aWFsIH0gZnJvbSAnLi9jcmVkZW50aWFsJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9lcnJvcnMnO1xuaW1wb3J0IHsgUHJvdmlkZXJJZCB9IGZyb20gJy4uLy4uL21vZGVsL2VudW1zJztcblxuZXhwb3J0IGludGVyZmFjZSBJZHBUYXNrUGFyYW1zIHtcbiAgYXV0aDogQXV0aEludGVybmFsO1xuICByZXF1ZXN0VXJpOiBzdHJpbmc7XG4gIHNlc3Npb25JZD86IHN0cmluZztcbiAgdGVuYW50SWQ/OiBzdHJpbmc7XG4gIHBvc3RCb2R5Pzogc3RyaW5nO1xuICBwZW5kaW5nVG9rZW4/OiBzdHJpbmc7XG4gIHVzZXI/OiBVc2VySW50ZXJuYWw7XG4gIGJ5cGFzc0F1dGhTdGF0ZT86IGJvb2xlYW47XG59XG5cbmV4cG9ydCB0eXBlIElkcFRhc2sgPSAoXG4gIHBhcmFtczogSWRwVGFza1BhcmFtc1xuKSA9PiBQcm9taXNlPFVzZXJDcmVkZW50aWFsSW50ZXJuYWw+O1xuXG5jbGFzcyBJZHBDcmVkZW50aWFsIGV4dGVuZHMgQXV0aENyZWRlbnRpYWwge1xuICBjb25zdHJ1Y3RvcihyZWFkb25seSBwYXJhbXM6IElkcFRhc2tQYXJhbXMpIHtcbiAgICBzdXBlcihQcm92aWRlcklkLkNVU1RPTSwgUHJvdmlkZXJJZC5DVVNUT00pO1xuICB9XG5cbiAgX2dldElkVG9rZW5SZXNwb25zZShhdXRoOiBBdXRoSW50ZXJuYWwpOiBQcm9taXNlPFBob25lT3JPYXV0aFRva2VuUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCB0aGlzLl9idWlsZElkcFJlcXVlc3QoKSk7XG4gIH1cblxuICBfbGlua1RvSWRUb2tlbihcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgaWRUb2tlbjogc3RyaW5nXG4gICk6IFByb21pc2U8SWRUb2tlblJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIHNpZ25JbldpdGhJZHAoYXV0aCwgdGhpcy5fYnVpbGRJZHBSZXF1ZXN0KGlkVG9rZW4pKTtcbiAgfVxuXG4gIF9nZXRSZWF1dGhlbnRpY2F0aW9uUmVzb2x2ZXIoYXV0aDogQXV0aEludGVybmFsKTogUHJvbWlzZTxJZFRva2VuUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gc2lnbkluV2l0aElkcChhdXRoLCB0aGlzLl9idWlsZElkcFJlcXVlc3QoKSk7XG4gIH1cblxuICBwcml2YXRlIF9idWlsZElkcFJlcXVlc3QoaWRUb2tlbj86IHN0cmluZyk6IFNpZ25JbldpdGhJZHBSZXF1ZXN0IHtcbiAgICBjb25zdCByZXF1ZXN0OiBTaWduSW5XaXRoSWRwUmVxdWVzdCA9IHtcbiAgICAgIHJlcXVlc3RVcmk6IHRoaXMucGFyYW1zLnJlcXVlc3RVcmksXG4gICAgICBzZXNzaW9uSWQ6IHRoaXMucGFyYW1zLnNlc3Npb25JZCxcbiAgICAgIHBvc3RCb2R5OiB0aGlzLnBhcmFtcy5wb3N0Qm9keSxcbiAgICAgIHRlbmFudElkOiB0aGlzLnBhcmFtcy50ZW5hbnRJZCxcbiAgICAgIHBlbmRpbmdUb2tlbjogdGhpcy5wYXJhbXMucGVuZGluZ1Rva2VuLFxuICAgICAgcmV0dXJuU2VjdXJlVG9rZW46IHRydWUsXG4gICAgICByZXR1cm5JZHBDcmVkZW50aWFsOiB0cnVlXG4gICAgfTtcblxuICAgIGlmIChpZFRva2VuKSB7XG4gICAgICByZXF1ZXN0LmlkVG9rZW4gPSBpZFRva2VuO1xuICAgIH1cblxuICAgIHJldHVybiByZXF1ZXN0O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfc2lnbkluKFxuICBwYXJhbXM6IElkcFRhc2tQYXJhbXNcbik6IFByb21pc2U8VXNlckNyZWRlbnRpYWxJbnRlcm5hbD4ge1xuICByZXR1cm4gX3NpZ25JbldpdGhDcmVkZW50aWFsKFxuICAgIHBhcmFtcy5hdXRoLFxuICAgIG5ldyBJZHBDcmVkZW50aWFsKHBhcmFtcyksXG4gICAgcGFyYW1zLmJ5cGFzc0F1dGhTdGF0ZVxuICApIGFzIFByb21pc2U8VXNlckNyZWRlbnRpYWxJbnRlcm5hbD47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfcmVhdXRoKFxuICBwYXJhbXM6IElkcFRhc2tQYXJhbXNcbik6IFByb21pc2U8VXNlckNyZWRlbnRpYWxJbnRlcm5hbD4ge1xuICBjb25zdCB7IGF1dGgsIHVzZXIgfSA9IHBhcmFtcztcbiAgX2Fzc2VydCh1c2VyLCBhdXRoLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgcmV0dXJuIF9yZWF1dGhlbnRpY2F0ZShcbiAgICB1c2VyLFxuICAgIG5ldyBJZHBDcmVkZW50aWFsKHBhcmFtcyksXG4gICAgcGFyYW1zLmJ5cGFzc0F1dGhTdGF0ZVxuICApO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX2xpbmsoXG4gIHBhcmFtczogSWRwVGFza1BhcmFtc1xuKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbEludGVybmFsPiB7XG4gIGNvbnN0IHsgYXV0aCwgdXNlciB9ID0gcGFyYW1zO1xuICBfYXNzZXJ0KHVzZXIsIGF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICByZXR1cm4gX2xpbmtVc2VyKHVzZXIsIG5ldyBJZHBDcmVkZW50aWFsKHBhcmFtcyksIHBhcmFtcy5ieXBhc3NBdXRoU3RhdGUpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEZpcmViYXNlRXJyb3IgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5cbmltcG9ydCB7XG4gIEF1dGhFdmVudCxcbiAgQXV0aEV2ZW50Q29uc3VtZXIsXG4gIEF1dGhFdmVudFR5cGUsXG4gIEV2ZW50TWFuYWdlcixcbiAgUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWxcbn0gZnJvbSAnLi4vLi4vbW9kZWwvcG9wdXBfcmVkaXJlY3QnO1xuaW1wb3J0IHsgVXNlckludGVybmFsLCBVc2VyQ3JlZGVudGlhbEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IGRlYnVnQXNzZXJ0LCBfZmFpbCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7XG4gIF9saW5rLFxuICBfcmVhdXRoLFxuICBfc2lnbkluLFxuICBJZHBUYXNrLFxuICBJZHBUYXNrUGFyYW1zXG59IGZyb20gJy4uL3N0cmF0ZWdpZXMvaWRwJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuXG5pbnRlcmZhY2UgUGVuZGluZ1Byb21pc2Uge1xuICByZXNvbHZlOiAoY3JlZDogVXNlckNyZWRlbnRpYWxJbnRlcm5hbCB8IG51bGwpID0+IHZvaWQ7XG4gIHJlamVjdDogKGVycm9yOiBFcnJvcikgPT4gdm9pZDtcbn1cblxuLyoqXG4gKiBQb3B1cCBldmVudCBtYW5hZ2VyLiBIYW5kbGVzIHRoZSBwb3B1cCdzIGVudGlyZSBsaWZlY3ljbGU7IGxpc3RlbnMgdG8gYXV0aFxuICogZXZlbnRzXG4gKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFBvcHVwUmVkaXJlY3RPcGVyYXRpb25cbiAgaW1wbGVtZW50cyBBdXRoRXZlbnRDb25zdW1lclxue1xuICBwcml2YXRlIHBlbmRpbmdQcm9taXNlOiBQZW5kaW5nUHJvbWlzZSB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGV2ZW50TWFuYWdlcjogRXZlbnRNYW5hZ2VyIHwgbnVsbCA9IG51bGw7XG4gIHJlYWRvbmx5IGZpbHRlcjogQXV0aEV2ZW50VHlwZVtdO1xuXG4gIGFic3RyYWN0IGV2ZW50SWQ6IHN0cmluZyB8IG51bGw7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBmaWx0ZXI6IEF1dGhFdmVudFR5cGUgfCBBdXRoRXZlbnRUeXBlW10sXG4gICAgcHJvdGVjdGVkIHJlYWRvbmx5IHJlc29sdmVyOiBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJJbnRlcm5hbCxcbiAgICBwcm90ZWN0ZWQgdXNlcj86IFVzZXJJbnRlcm5hbCxcbiAgICBwcm90ZWN0ZWQgcmVhZG9ubHkgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2VcbiAgKSB7XG4gICAgdGhpcy5maWx0ZXIgPSBBcnJheS5pc0FycmF5KGZpbHRlcikgPyBmaWx0ZXIgOiBbZmlsdGVyXTtcbiAgfVxuXG4gIGFic3RyYWN0IG9uRXhlY3V0aW9uKCk6IFByb21pc2U8dm9pZD47XG5cbiAgZXhlY3V0ZSgpOiBQcm9taXNlPFVzZXJDcmVkZW50aWFsSW50ZXJuYWwgfCBudWxsPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPFVzZXJDcmVkZW50aWFsSW50ZXJuYWwgfCBudWxsPihcbiAgICAgIGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgdGhpcy5wZW5kaW5nUHJvbWlzZSA9IHsgcmVzb2x2ZSwgcmVqZWN0IH07XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB0aGlzLmV2ZW50TWFuYWdlciA9IGF3YWl0IHRoaXMucmVzb2x2ZXIuX2luaXRpYWxpemUodGhpcy5hdXRoKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLm9uRXhlY3V0aW9uKCk7XG4gICAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIucmVnaXN0ZXJDb25zdW1lcih0aGlzKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIHRoaXMucmVqZWN0KGUgYXMgRXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIG9uQXV0aEV2ZW50KGV2ZW50OiBBdXRoRXZlbnQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IHVybFJlc3BvbnNlLCBzZXNzaW9uSWQsIHBvc3RCb2R5LCB0ZW5hbnRJZCwgZXJyb3IsIHR5cGUgfSA9IGV2ZW50O1xuICAgIGlmIChlcnJvcikge1xuICAgICAgdGhpcy5yZWplY3QoZXJyb3IpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHBhcmFtczogSWRwVGFza1BhcmFtcyA9IHtcbiAgICAgIGF1dGg6IHRoaXMuYXV0aCxcbiAgICAgIHJlcXVlc3RVcmk6IHVybFJlc3BvbnNlISxcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbklkISxcbiAgICAgIHRlbmFudElkOiB0ZW5hbnRJZCB8fCB1bmRlZmluZWQsXG4gICAgICBwb3N0Qm9keTogcG9zdEJvZHkgfHwgdW5kZWZpbmVkLFxuICAgICAgdXNlcjogdGhpcy51c2VyLFxuICAgICAgYnlwYXNzQXV0aFN0YXRlOiB0aGlzLmJ5cGFzc0F1dGhTdGF0ZVxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgdGhpcy5yZXNvbHZlKGF3YWl0IHRoaXMuZ2V0SWRwVGFzayh0eXBlKShwYXJhbXMpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aGlzLnJlamVjdChlIGFzIEVycm9yKTtcbiAgICB9XG4gIH1cblxuICBvbkVycm9yKGVycm9yOiBGaXJlYmFzZUVycm9yKTogdm9pZCB7XG4gICAgdGhpcy5yZWplY3QoZXJyb3IpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRJZHBUYXNrKHR5cGU6IEF1dGhFdmVudFR5cGUpOiBJZHBUYXNrIHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgQXV0aEV2ZW50VHlwZS5TSUdOX0lOX1ZJQV9QT1BVUDpcbiAgICAgIGNhc2UgQXV0aEV2ZW50VHlwZS5TSUdOX0lOX1ZJQV9SRURJUkVDVDpcbiAgICAgICAgcmV0dXJuIF9zaWduSW47XG4gICAgICBjYXNlIEF1dGhFdmVudFR5cGUuTElOS19WSUFfUE9QVVA6XG4gICAgICBjYXNlIEF1dGhFdmVudFR5cGUuTElOS19WSUFfUkVESVJFQ1Q6XG4gICAgICAgIHJldHVybiBfbGluaztcbiAgICAgIGNhc2UgQXV0aEV2ZW50VHlwZS5SRUFVVEhfVklBX1BPUFVQOlxuICAgICAgY2FzZSBBdXRoRXZlbnRUeXBlLlJFQVVUSF9WSUFfUkVESVJFQ1Q6XG4gICAgICAgIHJldHVybiBfcmVhdXRoO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgX2ZhaWwodGhpcy5hdXRoLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgICB9XG4gIH1cblxuICBwcm90ZWN0ZWQgcmVzb2x2ZShjcmVkOiBVc2VyQ3JlZGVudGlhbEludGVybmFsIHwgbnVsbCk6IHZvaWQge1xuICAgIGRlYnVnQXNzZXJ0KHRoaXMucGVuZGluZ1Byb21pc2UsICdQZW5kaW5nIHByb21pc2Ugd2FzIG5ldmVyIHNldCcpO1xuICAgIHRoaXMucGVuZGluZ1Byb21pc2UucmVzb2x2ZShjcmVkKTtcbiAgICB0aGlzLnVucmVnaXN0ZXJBbmRDbGVhblVwKCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgcmVqZWN0KGVycm9yOiBFcnJvcik6IHZvaWQge1xuICAgIGRlYnVnQXNzZXJ0KHRoaXMucGVuZGluZ1Byb21pc2UsICdQZW5kaW5nIHByb21pc2Ugd2FzIG5ldmVyIHNldCcpO1xuICAgIHRoaXMucGVuZGluZ1Byb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICB0aGlzLnVucmVnaXN0ZXJBbmRDbGVhblVwKCk7XG4gIH1cblxuICBwcml2YXRlIHVucmVnaXN0ZXJBbmRDbGVhblVwKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmV2ZW50TWFuYWdlcikge1xuICAgICAgdGhpcy5ldmVudE1hbmFnZXIudW5yZWdpc3RlckNvbnN1bWVyKHRoaXMpO1xuICAgIH1cblxuICAgIHRoaXMucGVuZGluZ1Byb21pc2UgPSBudWxsO1xuICAgIHRoaXMuY2xlYW5VcCgpO1xuICB9XG5cbiAgYWJzdHJhY3QgY2xlYW5VcCgpOiB2b2lkO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEF1dGgsXG4gIEF1dGhQcm92aWRlcixcbiAgUG9wdXBSZWRpcmVjdFJlc29sdmVyLFxuICBVc2VyLFxuICBVc2VyQ3JlZGVudGlhbFxufSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5pbXBvcnQgeyBfY2FzdEF1dGggfSBmcm9tICcuLi8uLi9jb3JlL2F1dGgvYXV0aF9pbXBsJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi8uLi9jb3JlL2Vycm9ycyc7XG5pbXBvcnQge1xuICBfYXNzZXJ0LFxuICBkZWJ1Z0Fzc2VydCxcbiAgX2NyZWF0ZUVycm9yLFxuICBfYXNzZXJ0SW5zdGFuY2VPZlxufSBmcm9tICcuLi8uLi9jb3JlL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IERlbGF5IH0gZnJvbSAnLi4vLi4vY29yZS91dGlsL2RlbGF5JztcbmltcG9ydCB7IF9nZW5lcmF0ZUV2ZW50SWQgfSBmcm9tICcuLi8uLi9jb3JlL3V0aWwvZXZlbnRfaWQnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQge1xuICBBdXRoRXZlbnRUeXBlLFxuICBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJJbnRlcm5hbFxufSBmcm9tICcuLi8uLi9tb2RlbC9wb3B1cF9yZWRpcmVjdCc7XG5pbXBvcnQgeyBVc2VySW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC91c2VyJztcbmltcG9ydCB7IF93aXRoRGVmYXVsdFJlc29sdmVyIH0gZnJvbSAnLi4vLi4vY29yZS91dGlsL3Jlc29sdmVyJztcbmltcG9ydCB7IEF1dGhQb3B1cCB9IGZyb20gJy4uL3V0aWwvcG9wdXAnO1xuaW1wb3J0IHsgQWJzdHJhY3RQb3B1cFJlZGlyZWN0T3BlcmF0aW9uIH0gZnJvbSAnLi4vLi4vY29yZS9zdHJhdGVnaWVzL2Fic3RyYWN0X3BvcHVwX3JlZGlyZWN0X29wZXJhdGlvbic7XG5pbXBvcnQgeyBGZWRlcmF0ZWRBdXRoUHJvdmlkZXIgfSBmcm9tICcuLi8uLi9jb3JlL3Byb3ZpZGVycy9mZWRlcmF0ZWQnO1xuaW1wb3J0IHsgZ2V0TW9kdWxhckluc3RhbmNlIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKlxuICogVGhlIGV2ZW50IHRpbWVvdXQgaXMgdGhlIHNhbWUgb24gbW9iaWxlIGFuZCBkZXNrdG9wLCBubyBuZWVkIGZvciBEZWxheS4gU2V0IHRoaXMgdG8gOHMgc2luY2VcbiAqIGJsb2NraW5nIGZ1bmN0aW9ucyBjYW4gdGFrZSB1cHRvIDdzIHRvIGNvbXBsZXRlIHNpZ24gaW4sIGFzIGRvY3VtZW50ZWQgaW46XG4gKiBodHRwczovL2Nsb3VkLmdvb2dsZS5jb20vaWRlbnRpdHktcGxhdGZvcm0vZG9jcy9ibG9ja2luZy1mdW5jdGlvbnMjdW5kZXJzdGFuZGluZ19ibG9ja2luZ19mdW5jdGlvbnNcbiAqIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL2F1dGgvZXh0ZW5kLXdpdGgtYmxvY2tpbmctZnVuY3Rpb25zI3VuZGVyc3RhbmRpbmdfYmxvY2tpbmdfZnVuY3Rpb25zXG4gKi9cbmV4cG9ydCBjb25zdCBlbnVtIF9UaW1lb3V0IHtcbiAgQVVUSF9FVkVOVCA9IDgwMDBcbn1cbmV4cG9ydCBjb25zdCBfUE9MTF9XSU5ET1dfQ0xPU0VfVElNRU9VVCA9IG5ldyBEZWxheSgyMDAwLCAxMDAwMCk7XG5cbi8qKlxuICogQXV0aGVudGljYXRlcyBhIEZpcmViYXNlIGNsaWVudCB1c2luZyBhIHBvcHVwLWJhc2VkIE9BdXRoIGF1dGhlbnRpY2F0aW9uIGZsb3cuXG4gKlxuICogQHJlbWFya3NcbiAqIElmIHN1Y2NlZWRzLCByZXR1cm5zIHRoZSBzaWduZWQgaW4gdXNlciBhbG9uZyB3aXRoIHRoZSBwcm92aWRlcidzIGNyZWRlbnRpYWwuIElmIHNpZ24gaW4gd2FzXG4gKiB1bnN1Y2Nlc3NmdWwsIHJldHVybnMgYW4gZXJyb3Igb2JqZWN0IGNvbnRhaW5pbmcgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgZXJyb3IuXG4gKlxuICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgYSBwb3B1cC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEZhY2Vib29rQXV0aFByb3ZpZGVyKCk7XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBzaWduSW5XaXRoUG9wdXAoYXV0aCwgcHJvdmlkZXIpO1xuICpcbiAqIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxuICogY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogLy8gVGhpcyBnaXZlcyB5b3UgYSBGYWNlYm9vayBBY2Nlc3MgVG9rZW4uXG4gKiBjb25zdCBjcmVkZW50aWFsID0gcHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQoYXV0aCwgcmVzdWx0KTtcbiAqIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxuICogTm9uLU9BdXRoIHByb3ZpZGVycyBsaWtlIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gd2lsbCB0aHJvdyBhbiBlcnJvci5cbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaWduSW5XaXRoUG9wdXAoXG4gIGF1dGg6IEF1dGgsXG4gIHByb3ZpZGVyOiBBdXRoUHJvdmlkZXIsXG4gIHJlc29sdmVyPzogUG9wdXBSZWRpcmVjdFJlc29sdmVyXG4pOiBQcm9taXNlPFVzZXJDcmVkZW50aWFsPiB7XG4gIGNvbnN0IGF1dGhJbnRlcm5hbCA9IF9jYXN0QXV0aChhdXRoKTtcbiAgX2Fzc2VydEluc3RhbmNlT2YoYXV0aCwgcHJvdmlkZXIsIEZlZGVyYXRlZEF1dGhQcm92aWRlcik7XG4gIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcihhdXRoSW50ZXJuYWwsIHJlc29sdmVyKTtcbiAgY29uc3QgYWN0aW9uID0gbmV3IFBvcHVwT3BlcmF0aW9uKFxuICAgIGF1dGhJbnRlcm5hbCxcbiAgICBBdXRoRXZlbnRUeXBlLlNJR05fSU5fVklBX1BPUFVQLFxuICAgIHByb3ZpZGVyLFxuICAgIHJlc29sdmVySW50ZXJuYWxcbiAgKTtcbiAgcmV0dXJuIGFjdGlvbi5leGVjdXRlTm90TnVsbCgpO1xufVxuXG4vKipcbiAqIFJlYXV0aGVudGljYXRlcyB0aGUgY3VycmVudCB1c2VyIHdpdGggdGhlIHNwZWNpZmllZCB7QGxpbmsgT0F1dGhQcm92aWRlcn0gdXNpbmcgYSBwb3AtdXAgYmFzZWRcbiAqIE9BdXRoIGZsb3cuXG4gKlxuICogQHJlbWFya3NcbiAqIElmIHRoZSByZWF1dGhlbnRpY2F0aW9uIGlzIHN1Y2Nlc3NmdWwsIHRoZSByZXR1cm5lZCByZXN1bHQgd2lsbCBjb250YWluIHRoZSB1c2VyIGFuZCB0aGVcbiAqIHByb3ZpZGVyJ3MgY3JlZGVudGlhbC5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHBvcHVwLlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBSZWF1dGhlbnRpY2F0ZSB1c2luZyBhIHBvcHVwLlxuICogYXdhaXQgcmVhdXRoZW50aWNhdGVXaXRoUG9wdXAocmVzdWx0LnVzZXIsIHByb3ZpZGVyKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvdmlkZXIgLSBUaGUgcHJvdmlkZXIgdG8gYXV0aGVudGljYXRlLiBUaGUgcHJvdmlkZXIgaGFzIHRvIGJlIGFuIHtAbGluayBPQXV0aFByb3ZpZGVyfS5cbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcbiAqIGlmIGFscmVhZHkgc3VwcGxpZWQgdG8ge0BsaW5rIGluaXRpYWxpemVBdXRofSBvciBwcm92aWRlZCBieSB7QGxpbmsgZ2V0QXV0aH0uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVhdXRoZW50aWNhdGVXaXRoUG9wdXAoXG4gIHVzZXI6IFVzZXIsXG4gIHByb3ZpZGVyOiBBdXRoUHJvdmlkZXIsXG4gIHJlc29sdmVyPzogUG9wdXBSZWRpcmVjdFJlc29sdmVyXG4pOiBQcm9taXNlPFVzZXJDcmVkZW50aWFsPiB7XG4gIGNvbnN0IHVzZXJJbnRlcm5hbCA9IGdldE1vZHVsYXJJbnN0YW5jZSh1c2VyKSBhcyBVc2VySW50ZXJuYWw7XG4gIF9hc3NlcnRJbnN0YW5jZU9mKHVzZXJJbnRlcm5hbC5hdXRoLCBwcm92aWRlciwgRmVkZXJhdGVkQXV0aFByb3ZpZGVyKTtcbiAgY29uc3QgcmVzb2x2ZXJJbnRlcm5hbCA9IF93aXRoRGVmYXVsdFJlc29sdmVyKHVzZXJJbnRlcm5hbC5hdXRoLCByZXNvbHZlcik7XG4gIGNvbnN0IGFjdGlvbiA9IG5ldyBQb3B1cE9wZXJhdGlvbihcbiAgICB1c2VySW50ZXJuYWwuYXV0aCxcbiAgICBBdXRoRXZlbnRUeXBlLlJFQVVUSF9WSUFfUE9QVVAsXG4gICAgcHJvdmlkZXIsXG4gICAgcmVzb2x2ZXJJbnRlcm5hbCxcbiAgICB1c2VySW50ZXJuYWxcbiAgKTtcbiAgcmV0dXJuIGFjdGlvbi5leGVjdXRlTm90TnVsbCgpO1xufVxuXG4vKipcbiAqIExpbmtzIHRoZSBhdXRoZW50aWNhdGVkIHByb3ZpZGVyIHRvIHRoZSB1c2VyIGFjY291bnQgdXNpbmcgYSBwb3AtdXAgYmFzZWQgT0F1dGggZmxvdy5cbiAqXG4gKiBAcmVtYXJrc1xuICogSWYgdGhlIGxpbmtpbmcgaXMgc3VjY2Vzc2Z1bCwgdGhlIHJldHVybmVkIHJlc3VsdCB3aWxsIGNvbnRhaW4gdGhlIHVzZXIgYW5kIHRoZSBwcm92aWRlcidzIGNyZWRlbnRpYWwuXG4gKlxuICogVGhpcyBtZXRob2QgZG9lcyBub3Qgd29yayBpbiBhIE5vZGUuanMgZW52aXJvbm1lbnQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIFNpZ24gaW4gdXNpbmcgc29tZSBvdGhlciBwcm92aWRlci5cbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKGF1dGgsIGVtYWlsLCBwYXNzd29yZCk7XG4gKiAvLyBMaW5rIHVzaW5nIGEgcG9wdXAuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogYXdhaXQgbGlua1dpdGhQb3B1cChyZXN1bHQudXNlciwgcHJvdmlkZXIpO1xuICogYGBgXG4gKlxuICogQHBhcmFtIHVzZXIgLSBUaGUgdXNlci5cbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxuICogTm9uLU9BdXRoIHByb3ZpZGVycyBsaWtlIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gd2lsbCB0aHJvdyBhbiBlcnJvci5cbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaW5rV2l0aFBvcHVwKFxuICB1c2VyOiBVc2VyLFxuICBwcm92aWRlcjogQXV0aFByb3ZpZGVyLFxuICByZXNvbHZlcj86IFBvcHVwUmVkaXJlY3RSZXNvbHZlclxuKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD4ge1xuICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikgYXMgVXNlckludGVybmFsO1xuICBfYXNzZXJ0SW5zdGFuY2VPZih1c2VySW50ZXJuYWwuYXV0aCwgcHJvdmlkZXIsIEZlZGVyYXRlZEF1dGhQcm92aWRlcik7XG4gIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcih1c2VySW50ZXJuYWwuYXV0aCwgcmVzb2x2ZXIpO1xuXG4gIGNvbnN0IGFjdGlvbiA9IG5ldyBQb3B1cE9wZXJhdGlvbihcbiAgICB1c2VySW50ZXJuYWwuYXV0aCxcbiAgICBBdXRoRXZlbnRUeXBlLkxJTktfVklBX1BPUFVQLFxuICAgIHByb3ZpZGVyLFxuICAgIHJlc29sdmVySW50ZXJuYWwsXG4gICAgdXNlckludGVybmFsXG4gICk7XG4gIHJldHVybiBhY3Rpb24uZXhlY3V0ZU5vdE51bGwoKTtcbn1cblxuLyoqXG4gKiBQb3B1cCBldmVudCBtYW5hZ2VyLiBIYW5kbGVzIHRoZSBwb3B1cCdzIGVudGlyZSBsaWZlY3ljbGU7IGxpc3RlbnMgdG8gYXV0aFxuICogZXZlbnRzXG4gKlxuICovXG5jbGFzcyBQb3B1cE9wZXJhdGlvbiBleHRlbmRzIEFic3RyYWN0UG9wdXBSZWRpcmVjdE9wZXJhdGlvbiB7XG4gIC8vIE9ubHkgb25lIHBvcHVwIGlzIGV2ZXIgc2hvd24gYXQgb25jZS4gVGhlIGxpZmVjeWNsZSBvZiB0aGUgY3VycmVudCBwb3B1cFxuICAvLyBjYW4gYmUgbWFuYWdlZCAvIGNhbmNlbGxlZCBieSB0aGUgY29uc3RydWN0b3IuXG4gIHByaXZhdGUgc3RhdGljIGN1cnJlbnRQb3B1cEFjdGlvbjogUG9wdXBPcGVyYXRpb24gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBhdXRoV2luZG93OiBBdXRoUG9wdXAgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBwb2xsSWQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBmaWx0ZXI6IEF1dGhFdmVudFR5cGUsXG4gICAgcHJpdmF0ZSByZWFkb25seSBwcm92aWRlcjogQXV0aFByb3ZpZGVyLFxuICAgIHJlc29sdmVyOiBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJJbnRlcm5hbCxcbiAgICB1c2VyPzogVXNlckludGVybmFsXG4gICkge1xuICAgIHN1cGVyKGF1dGgsIGZpbHRlciwgcmVzb2x2ZXIsIHVzZXIpO1xuICAgIGlmIChQb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24pIHtcbiAgICAgIFBvcHVwT3BlcmF0aW9uLmN1cnJlbnRQb3B1cEFjdGlvbi5jYW5jZWwoKTtcbiAgICB9XG5cbiAgICBQb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24gPSB0aGlzO1xuICB9XG5cbiAgYXN5bmMgZXhlY3V0ZU5vdE51bGwoKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbD4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZXhlY3V0ZSgpO1xuICAgIF9hc3NlcnQocmVzdWx0LCB0aGlzLmF1dGgsIEF1dGhFcnJvckNvZGUuSU5URVJOQUxfRVJST1IpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBhc3luYyBvbkV4ZWN1dGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBkZWJ1Z0Fzc2VydChcbiAgICAgIHRoaXMuZmlsdGVyLmxlbmd0aCA9PT0gMSxcbiAgICAgICdQb3B1cCBvcGVyYXRpb25zIG9ubHkgaGFuZGxlIG9uZSBldmVudCdcbiAgICApO1xuICAgIGNvbnN0IGV2ZW50SWQgPSBfZ2VuZXJhdGVFdmVudElkKCk7XG4gICAgdGhpcy5hdXRoV2luZG93ID0gYXdhaXQgdGhpcy5yZXNvbHZlci5fb3BlblBvcHVwKFxuICAgICAgdGhpcy5hdXRoLFxuICAgICAgdGhpcy5wcm92aWRlcixcbiAgICAgIHRoaXMuZmlsdGVyWzBdLCAvLyBUaGVyZSdzIGFsd2F5cyBvbmUsIHNlZSBjb25zdHJ1Y3RvclxuICAgICAgZXZlbnRJZFxuICAgICk7XG4gICAgdGhpcy5hdXRoV2luZG93LmFzc29jaWF0ZWRFdmVudCA9IGV2ZW50SWQ7XG5cbiAgICAvLyBDaGVjayBmb3Igd2ViIHN0b3JhZ2Ugc3VwcG9ydCBhbmQgb3JpZ2luIHZhbGlkYXRpb24gX2FmdGVyXyB0aGUgcG9wdXAgaXNcbiAgICAvLyBsb2FkZWQuIFRoZXNlIG9wZXJhdGlvbnMgYXJlIHNsb3cgKH4xIHNlY29uZCBvciBzbykgUmF0aGVyIHRoYW5cbiAgICAvLyB3YWl0aW5nIG9uIHRoZW0gYmVmb3JlIG9wZW5pbmcgdGhlIHdpbmRvdywgb3B0aW1pc3RpY2FsbHkgb3BlbiB0aGUgcG9wdXBcbiAgICAvLyBhbmQgY2hlY2sgZm9yIHN0b3JhZ2Ugc3VwcG9ydCBhdCB0aGUgc2FtZSB0aW1lLiBJZiBzdG9yYWdlIHN1cHBvcnQgaXNcbiAgICAvLyBub3QgYXZhaWxhYmxlLCB0aGlzIHdpbGwgY2F1c2UgdGhlIHdob2xlIHRoaW5nIHRvIHJlamVjdCBwcm9wZXJseS4gSXRcbiAgICAvLyB3aWxsIGFsc28gY2xvc2UgdGhlIHBvcHVwLCBidXQgc2luY2UgdGhlIHByb21pc2UgaGFzIGFscmVhZHkgcmVqZWN0ZWQsXG4gICAgLy8gdGhlIHBvcHVwIGNsb3NlZCBieSB1c2VyIHBvbGwgd2lsbCByZWplY3QgaW50byB0aGUgdm9pZC5cbiAgICB0aGlzLnJlc29sdmVyLl9vcmlnaW5WYWxpZGF0aW9uKHRoaXMuYXV0aCkuY2F0Y2goZSA9PiB7XG4gICAgICB0aGlzLnJlamVjdChlKTtcbiAgICB9KTtcblxuICAgIHRoaXMucmVzb2x2ZXIuX2lzSWZyYW1lV2ViU3RvcmFnZVN1cHBvcnRlZCh0aGlzLmF1dGgsIGlzU3VwcG9ydGVkID0+IHtcbiAgICAgIGlmICghaXNTdXBwb3J0ZWQpIHtcbiAgICAgICAgdGhpcy5yZWplY3QoXG4gICAgICAgICAgX2NyZWF0ZUVycm9yKHRoaXMuYXV0aCwgQXV0aEVycm9yQ29kZS5XRUJfU1RPUkFHRV9VTlNVUFBPUlRFRClcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEhhbmRsZSB1c2VyIGNsb3N1cmUuIE5vdGljZSB0aGlzIGRvZXMgKm5vdCogdXNlIGF3YWl0XG4gICAgdGhpcy5wb2xsVXNlckNhbmNlbGxhdGlvbigpO1xuICB9XG5cbiAgZ2V0IGV2ZW50SWQoKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuYXV0aFdpbmRvdz8uYXNzb2NpYXRlZEV2ZW50IHx8IG51bGw7XG4gIH1cblxuICBjYW5jZWwoKTogdm9pZCB7XG4gICAgdGhpcy5yZWplY3QoX2NyZWF0ZUVycm9yKHRoaXMuYXV0aCwgQXV0aEVycm9yQ29kZS5FWFBJUkVEX1BPUFVQX1JFUVVFU1QpKTtcbiAgfVxuXG4gIGNsZWFuVXAoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuYXV0aFdpbmRvdykge1xuICAgICAgdGhpcy5hdXRoV2luZG93LmNsb3NlKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucG9sbElkKSB7XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMucG9sbElkKTtcbiAgICB9XG5cbiAgICB0aGlzLmF1dGhXaW5kb3cgPSBudWxsO1xuICAgIHRoaXMucG9sbElkID0gbnVsbDtcbiAgICBQb3B1cE9wZXJhdGlvbi5jdXJyZW50UG9wdXBBY3Rpb24gPSBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBwb2xsVXNlckNhbmNlbGxhdGlvbigpOiB2b2lkIHtcbiAgICBjb25zdCBwb2xsID0gKCk6IHZvaWQgPT4ge1xuICAgICAgaWYgKHRoaXMuYXV0aFdpbmRvdz8ud2luZG93Py5jbG9zZWQpIHtcbiAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhlcmUgaXMgc3VmZmljaWVudCB0aW1lIGZvciB3aGF0ZXZlciBhY3Rpb24gdG9cbiAgICAgICAgLy8gY29tcGxldGUuIFRoZSB3aW5kb3cgY291bGQgaGF2ZSBjbG9zZWQgYnV0IHRoZSBzaWduIGluIG5ldHdvcmtcbiAgICAgICAgLy8gY2FsbCBjb3VsZCBzdGlsbCBiZSBpbiBmbGlnaHQuIFRoaXMgaXMgc3BlY2lmaWNhbGx5IHRydWUgZm9yXG4gICAgICAgIC8vIEZpcmVmb3ggb3IgaWYgdGhlIG9wZW5lciBpcyBpbiBhbiBpZnJhbWUsIGluIHdoaWNoIGNhc2UgdGhlIG9hdXRoXG4gICAgICAgIC8vIGhlbHBlciBjbG9zZXMgdGhlIHBvcHVwLlxuICAgICAgICB0aGlzLnBvbGxJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLnBvbGxJZCA9IG51bGw7XG4gICAgICAgICAgdGhpcy5yZWplY3QoXG4gICAgICAgICAgICBfY3JlYXRlRXJyb3IodGhpcy5hdXRoLCBBdXRoRXJyb3JDb2RlLlBPUFVQX0NMT1NFRF9CWV9VU0VSKVxuICAgICAgICAgICk7XG4gICAgICAgIH0sIF9UaW1lb3V0LkFVVEhfRVZFTlQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMucG9sbElkID0gd2luZG93LnNldFRpbWVvdXQocG9sbCwgX1BPTExfV0lORE9XX0NMT1NFX1RJTUVPVVQuZ2V0KCkpO1xuICAgIH07XG5cbiAgICBwb2xsKCk7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7XG4gIEF1dGhFdmVudCxcbiAgQXV0aEV2ZW50VHlwZSxcbiAgUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWxcbn0gZnJvbSAnLi4vLi4vbW9kZWwvcG9wdXBfcmVkaXJlY3QnO1xuaW1wb3J0IHsgVXNlckNyZWRlbnRpYWxJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL3VzZXInO1xuaW1wb3J0IHsgUGVyc2lzdGVuY2VJbnRlcm5hbCB9IGZyb20gJy4uL3BlcnNpc3RlbmNlJztcbmltcG9ydCB7IF9wZXJzaXN0ZW5jZUtleU5hbWUgfSBmcm9tICcuLi9wZXJzaXN0ZW5jZS9wZXJzaXN0ZW5jZV91c2VyX21hbmFnZXInO1xuaW1wb3J0IHsgX2dldEluc3RhbmNlIH0gZnJvbSAnLi4vdXRpbC9pbnN0YW50aWF0b3InO1xuaW1wb3J0IHsgQWJzdHJhY3RQb3B1cFJlZGlyZWN0T3BlcmF0aW9uIH0gZnJvbSAnLi9hYnN0cmFjdF9wb3B1cF9yZWRpcmVjdF9vcGVyYXRpb24nO1xuXG5jb25zdCBQRU5ESU5HX1JFRElSRUNUX0tFWSA9ICdwZW5kaW5nUmVkaXJlY3QnO1xuXG4vLyBXZSBvbmx5IGdldCBvbmUgcmVkaXJlY3Qgb3V0Y29tZSBmb3IgYW55IG9uZSBhdXRoLCBzbyBqdXN0IHN0b3JlIGl0XG4vLyBpbiBoZXJlLlxuY29uc3QgcmVkaXJlY3RPdXRjb21lTWFwOiBNYXA8XG4gIHN0cmluZyxcbiAgKCkgPT4gUHJvbWlzZTxVc2VyQ3JlZGVudGlhbEludGVybmFsIHwgbnVsbD5cbj4gPSBuZXcgTWFwKCk7XG5cbmV4cG9ydCBjbGFzcyBSZWRpcmVjdEFjdGlvbiBleHRlbmRzIEFic3RyYWN0UG9wdXBSZWRpcmVjdE9wZXJhdGlvbiB7XG4gIGV2ZW50SWQgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICByZXNvbHZlcjogUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWwsXG4gICAgYnlwYXNzQXV0aFN0YXRlID0gZmFsc2VcbiAgKSB7XG4gICAgc3VwZXIoXG4gICAgICBhdXRoLFxuICAgICAgW1xuICAgICAgICBBdXRoRXZlbnRUeXBlLlNJR05fSU5fVklBX1JFRElSRUNULFxuICAgICAgICBBdXRoRXZlbnRUeXBlLkxJTktfVklBX1JFRElSRUNULFxuICAgICAgICBBdXRoRXZlbnRUeXBlLlJFQVVUSF9WSUFfUkVESVJFQ1QsXG4gICAgICAgIEF1dGhFdmVudFR5cGUuVU5LTk9XTlxuICAgICAgXSxcbiAgICAgIHJlc29sdmVyLFxuICAgICAgdW5kZWZpbmVkLFxuICAgICAgYnlwYXNzQXV0aFN0YXRlXG4gICAgKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPdmVycmlkZSB0aGUgZXhlY3V0ZSBmdW5jdGlvbjsgaWYgd2UgYWxyZWFkeSBoYXZlIGEgcmVkaXJlY3QgcmVzdWx0LCB0aGVuXG4gICAqIGp1c3QgcmV0dXJuIGl0LlxuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZSgpOiBQcm9taXNlPFVzZXJDcmVkZW50aWFsSW50ZXJuYWwgfCBudWxsPiB7XG4gICAgbGV0IHJlYWR5T3V0Y29tZSA9IHJlZGlyZWN0T3V0Y29tZU1hcC5nZXQodGhpcy5hdXRoLl9rZXkoKSk7XG4gICAgaWYgKCFyZWFkeU91dGNvbWUpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGhhc1BlbmRpbmdSZWRpcmVjdCA9IGF3YWl0IF9nZXRBbmRDbGVhclBlbmRpbmdSZWRpcmVjdFN0YXR1cyhcbiAgICAgICAgICB0aGlzLnJlc29sdmVyLFxuICAgICAgICAgIHRoaXMuYXV0aFxuICAgICAgICApO1xuICAgICAgICBjb25zdCByZXN1bHQgPSBoYXNQZW5kaW5nUmVkaXJlY3QgPyBhd2FpdCBzdXBlci5leGVjdXRlKCkgOiBudWxsO1xuICAgICAgICByZWFkeU91dGNvbWUgPSAoKSA9PiBQcm9taXNlLnJlc29sdmUocmVzdWx0KTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmVhZHlPdXRjb21lID0gKCkgPT4gUHJvbWlzZS5yZWplY3QoZSk7XG4gICAgICB9XG5cbiAgICAgIHJlZGlyZWN0T3V0Y29tZU1hcC5zZXQodGhpcy5hdXRoLl9rZXkoKSwgcmVhZHlPdXRjb21lKTtcbiAgICB9XG5cbiAgICAvLyBJZiB3ZSdyZSBub3QgYnlwYXNzaW5nIGF1dGggc3RhdGUsIHRoZSByZWFkeSBvdXRjb21lIHNob3VsZCBiZSBzZXQgdG9cbiAgICAvLyBudWxsLlxuICAgIGlmICghdGhpcy5ieXBhc3NBdXRoU3RhdGUpIHtcbiAgICAgIHJlZGlyZWN0T3V0Y29tZU1hcC5zZXQodGhpcy5hdXRoLl9rZXkoKSwgKCkgPT4gUHJvbWlzZS5yZXNvbHZlKG51bGwpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVhZHlPdXRjb21lKCk7XG4gIH1cblxuICBhc3luYyBvbkF1dGhFdmVudChldmVudDogQXV0aEV2ZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKGV2ZW50LnR5cGUgPT09IEF1dGhFdmVudFR5cGUuU0lHTl9JTl9WSUFfUkVESVJFQ1QpIHtcbiAgICAgIHJldHVybiBzdXBlci5vbkF1dGhFdmVudChldmVudCk7XG4gICAgfSBlbHNlIGlmIChldmVudC50eXBlID09PSBBdXRoRXZlbnRUeXBlLlVOS05PV04pIHtcbiAgICAgIC8vIFRoaXMgaXMgYSBzZW50aW5lbCB2YWx1ZSBpbmRpY2F0aW5nIHRoZXJlJ3Mgbm8gcGVuZGluZyByZWRpcmVjdFxuICAgICAgdGhpcy5yZXNvbHZlKG51bGwpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChldmVudC5ldmVudElkKSB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgdGhpcy5hdXRoLl9yZWRpcmVjdFVzZXJGb3JJZChldmVudC5ldmVudElkKTtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIHRoaXMudXNlciA9IHVzZXI7XG4gICAgICAgIHJldHVybiBzdXBlci5vbkF1dGhFdmVudChldmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJlc29sdmUobnVsbCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgb25FeGVjdXRpb24oKTogUHJvbWlzZTx2b2lkPiB7fVxuXG4gIGNsZWFuVXAoKTogdm9pZCB7fVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX2dldEFuZENsZWFyUGVuZGluZ1JlZGlyZWN0U3RhdHVzKFxuICByZXNvbHZlcjogUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWwsXG4gIGF1dGg6IEF1dGhJbnRlcm5hbFxuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IGtleSA9IHBlbmRpbmdSZWRpcmVjdEtleShhdXRoKTtcbiAgY29uc3QgcGVyc2lzdGVuY2UgPSByZXNvbHZlclBlcnNpc3RlbmNlKHJlc29sdmVyKTtcbiAgaWYgKCEoYXdhaXQgcGVyc2lzdGVuY2UuX2lzQXZhaWxhYmxlKCkpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGNvbnN0IGhhc1BlbmRpbmdSZWRpcmVjdCA9IChhd2FpdCBwZXJzaXN0ZW5jZS5fZ2V0KGtleSkpID09PSAndHJ1ZSc7XG4gIGF3YWl0IHBlcnNpc3RlbmNlLl9yZW1vdmUoa2V5KTtcbiAgcmV0dXJuIGhhc1BlbmRpbmdSZWRpcmVjdDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF9zZXRQZW5kaW5nUmVkaXJlY3RTdGF0dXMoXG4gIHJlc29sdmVyOiBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJJbnRlcm5hbCxcbiAgYXV0aDogQXV0aEludGVybmFsXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgcmV0dXJuIHJlc29sdmVyUGVyc2lzdGVuY2UocmVzb2x2ZXIpLl9zZXQocGVuZGluZ1JlZGlyZWN0S2V5KGF1dGgpLCAndHJ1ZScpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX2NsZWFyUmVkaXJlY3RPdXRjb21lcygpOiB2b2lkIHtcbiAgcmVkaXJlY3RPdXRjb21lTWFwLmNsZWFyKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfb3ZlcnJpZGVSZWRpcmVjdFJlc3VsdChcbiAgYXV0aDogQXV0aEludGVybmFsLFxuICByZXN1bHQ6ICgpID0+IFByb21pc2U8VXNlckNyZWRlbnRpYWxJbnRlcm5hbCB8IG51bGw+XG4pOiB2b2lkIHtcbiAgcmVkaXJlY3RPdXRjb21lTWFwLnNldChhdXRoLl9rZXkoKSwgcmVzdWx0KTtcbn1cblxuZnVuY3Rpb24gcmVzb2x2ZXJQZXJzaXN0ZW5jZShcbiAgcmVzb2x2ZXI6IFBvcHVwUmVkaXJlY3RSZXNvbHZlckludGVybmFsXG4pOiBQZXJzaXN0ZW5jZUludGVybmFsIHtcbiAgcmV0dXJuIF9nZXRJbnN0YW5jZShyZXNvbHZlci5fcmVkaXJlY3RQZXJzaXN0ZW5jZSk7XG59XG5cbmZ1bmN0aW9uIHBlbmRpbmdSZWRpcmVjdEtleShhdXRoOiBBdXRoSW50ZXJuYWwpOiBzdHJpbmcge1xuICByZXR1cm4gX3BlcnNpc3RlbmNlS2V5TmFtZShcbiAgICBQRU5ESU5HX1JFRElSRUNUX0tFWSxcbiAgICBhdXRoLmNvbmZpZy5hcGlLZXksXG4gICAgYXV0aC5uYW1lXG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgQXV0aCxcbiAgQXV0aFByb3ZpZGVyLFxuICBQb3B1cFJlZGlyZWN0UmVzb2x2ZXIsXG4gIFVzZXIsXG4gIFVzZXJDcmVkZW50aWFsXG59IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmltcG9ydCB7IF9jYXN0QXV0aCB9IGZyb20gJy4uLy4uL2NvcmUvYXV0aC9hdXRoX2ltcGwnO1xuaW1wb3J0IHsgX2Fzc2VydExpbmtlZFN0YXR1cyB9IGZyb20gJy4uLy4uL2NvcmUvdXNlci9saW5rX3VubGluayc7XG5pbXBvcnQgeyBfYXNzZXJ0SW5zdGFuY2VPZiB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgX2dlbmVyYXRlRXZlbnRJZCB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9ldmVudF9pZCc7XG5pbXBvcnQgeyBBdXRoRXZlbnRUeXBlIH0gZnJvbSAnLi4vLi4vbW9kZWwvcG9wdXBfcmVkaXJlY3QnO1xuaW1wb3J0IHsgVXNlckludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvdXNlcic7XG5pbXBvcnQgeyBfd2l0aERlZmF1bHRSZXNvbHZlciB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9yZXNvbHZlcic7XG5pbXBvcnQge1xuICBSZWRpcmVjdEFjdGlvbixcbiAgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1c1xufSBmcm9tICcuLi8uLi9jb3JlL3N0cmF0ZWdpZXMvcmVkaXJlY3QnO1xuaW1wb3J0IHsgRmVkZXJhdGVkQXV0aFByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vY29yZS9wcm92aWRlcnMvZmVkZXJhdGVkJztcbmltcG9ydCB7IGdldE1vZHVsYXJJbnN0YW5jZSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcblxuLyoqXG4gKiBBdXRoZW50aWNhdGVzIGEgRmlyZWJhc2UgY2xpZW50IHVzaW5nIGEgZnVsbC1wYWdlIHJlZGlyZWN0IGZsb3cuXG4gKlxuICogQHJlbWFya3NcbiAqIFRvIGhhbmRsZSB0aGUgcmVzdWx0cyBhbmQgZXJyb3JzIGZvciB0aGlzIG9wZXJhdGlvbiwgcmVmZXIgdG8ge0BsaW5rIGdldFJlZGlyZWN0UmVzdWx0fS5cbiAqIEZvbGxvdyB0aGUge0BsaW5rIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL2F1dGgvd2ViL3JlZGlyZWN0LWJlc3QtcHJhY3RpY2VzXG4gKiB8IGJlc3QgcHJhY3RpY2VzfSB3aGVuIHVzaW5nIHtAbGluayBzaWduSW5XaXRoUmVkaXJlY3R9LlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogLy8gWW91IGNhbiBhZGQgYWRkaXRpb25hbCBzY29wZXMgdG8gdGhlIHByb3ZpZGVyOlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIC8vIFN0YXJ0IGEgc2lnbiBpbiBwcm9jZXNzIGZvciBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIH1cbiAqIC8vIEFzIHRoaXMgQVBJIGNhbiBiZSB1c2VkIGZvciBzaWduLWluLCBsaW5raW5nIGFuZCByZWF1dGhlbnRpY2F0aW9uLFxuICogLy8gY2hlY2sgdGhlIG9wZXJhdGlvblR5cGUgdG8gZGV0ZXJtaW5lIHdoYXQgdHJpZ2dlcmVkIHRoaXMgcmVkaXJlY3RcbiAqIC8vIG9wZXJhdGlvbi5cbiAqIGNvbnN0IG9wZXJhdGlvblR5cGUgPSByZXN1bHQub3BlcmF0aW9uVHlwZTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSBwcm92aWRlciAtIFRoZSBwcm92aWRlciB0byBhdXRoZW50aWNhdGUuIFRoZSBwcm92aWRlciBoYXMgdG8gYmUgYW4ge0BsaW5rIE9BdXRoUHJvdmlkZXJ9LlxuICogTm9uLU9BdXRoIHByb3ZpZGVycyBsaWtlIHtAbGluayBFbWFpbEF1dGhQcm92aWRlcn0gd2lsbCB0aHJvdyBhbiBlcnJvci5cbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzaWduSW5XaXRoUmVkaXJlY3QoXG4gIGF1dGg6IEF1dGgsXG4gIHByb3ZpZGVyOiBBdXRoUHJvdmlkZXIsXG4gIHJlc29sdmVyPzogUG9wdXBSZWRpcmVjdFJlc29sdmVyXG4pOiBQcm9taXNlPG5ldmVyPiB7XG4gIHJldHVybiBfc2lnbkluV2l0aFJlZGlyZWN0KGF1dGgsIHByb3ZpZGVyLCByZXNvbHZlcikgYXMgUHJvbWlzZTxuZXZlcj47XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfc2lnbkluV2l0aFJlZGlyZWN0KFxuICBhdXRoOiBBdXRoLFxuICBwcm92aWRlcjogQXV0aFByb3ZpZGVyLFxuICByZXNvbHZlcj86IFBvcHVwUmVkaXJlY3RSZXNvbHZlclxuKTogUHJvbWlzZTx2b2lkIHwgbmV2ZXI+IHtcbiAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICBfYXNzZXJ0SW5zdGFuY2VPZihhdXRoLCBwcm92aWRlciwgRmVkZXJhdGVkQXV0aFByb3ZpZGVyKTtcbiAgLy8gV2FpdCBmb3IgYXV0aCBpbml0aWFsaXphdGlvbiB0byBjb21wbGV0ZSwgdGhpcyB3aWxsIHByb2Nlc3MgcGVuZGluZyByZWRpcmVjdHMgYW5kIGNsZWFyIHRoZVxuICAvLyBQRU5ESU5HX1JFRElSRUNUX0tFWSBpbiBwZXJzaXN0ZW5jZS4gVGhpcyBzaG91bGQgYmUgY29tcGxldGVkIGJlZm9yZSBzdGFydGluZyBhIG5ld1xuICAvLyByZWRpcmVjdCBhbmQgY3JlYXRpbmcgYSBQRU5ESU5HX1JFRElSRUNUX0tFWSBlbnRyeS5cbiAgYXdhaXQgYXV0aEludGVybmFsLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gIGNvbnN0IHJlc29sdmVySW50ZXJuYWwgPSBfd2l0aERlZmF1bHRSZXNvbHZlcihhdXRoSW50ZXJuYWwsIHJlc29sdmVyKTtcbiAgYXdhaXQgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlckludGVybmFsLCBhdXRoSW50ZXJuYWwpO1xuXG4gIHJldHVybiByZXNvbHZlckludGVybmFsLl9vcGVuUmVkaXJlY3QoXG4gICAgYXV0aEludGVybmFsLFxuICAgIHByb3ZpZGVyLFxuICAgIEF1dGhFdmVudFR5cGUuU0lHTl9JTl9WSUFfUkVESVJFQ1RcbiAgKTtcbn1cblxuLyoqXG4gKiBSZWF1dGhlbnRpY2F0ZXMgdGhlIGN1cnJlbnQgdXNlciB3aXRoIHRoZSBzcGVjaWZpZWQge0BsaW5rIE9BdXRoUHJvdmlkZXJ9IHVzaW5nIGEgZnVsbC1wYWdlIHJlZGlyZWN0IGZsb3cuXG4gKiBAcmVtYXJrc1xuICogVG8gaGFuZGxlIHRoZSByZXN1bHRzIGFuZCBlcnJvcnMgZm9yIHRoaXMgb3BlcmF0aW9uLCByZWZlciB0byB7QGxpbmsgZ2V0UmVkaXJlY3RSZXN1bHR9LlxuICogRm9sbG93IHRoZSB7QGxpbmsgaHR0cHM6Ly9maXJlYmFzZS5nb29nbGUuY29tL2RvY3MvYXV0aC93ZWIvcmVkaXJlY3QtYmVzdC1wcmFjdGljZXNcbiAqIHwgYmVzdCBwcmFjdGljZXN9IHdoZW4gdXNpbmcge0BsaW5rIHJlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0fS5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBhIHJlZGlyZWN0LlxuICogY29uc3QgcHJvdmlkZXIgPSBuZXcgRmFjZWJvb2tBdXRoUHJvdmlkZXIoKTtcbiAqIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIC8vIFJlYXV0aGVudGljYXRlIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBhd2FpdCByZWF1dGhlbnRpY2F0ZVdpdGhSZWRpcmVjdChyZXN1bHQudXNlciwgcHJvdmlkZXIpO1xuICogLy8gVGhpcyB3aWxsIGFnYWluIHRyaWdnZXIgYSBmdWxsIHBhZ2UgcmVkaXJlY3QgYXdheSBmcm9tIHlvdXIgYXBwXG4gKlxuICogLy8gQWZ0ZXIgcmV0dXJuaW5nIGZyb20gdGhlIHJlZGlyZWN0IHdoZW4geW91ciBhcHAgaW5pdGlhbGl6ZXMgeW91IGNhbiBvYnRhaW4gdGhlIHJlc3VsdFxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0UmVkaXJlY3RSZXN1bHQoYXV0aCk7XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyLlxuICogQHBhcmFtIHByb3ZpZGVyIC0gVGhlIHByb3ZpZGVyIHRvIGF1dGhlbnRpY2F0ZS4gVGhlIHByb3ZpZGVyIGhhcyB0byBiZSBhbiB7QGxpbmsgT0F1dGhQcm92aWRlcn0uXG4gKiBOb24tT0F1dGggcHJvdmlkZXJzIGxpa2Uge0BsaW5rIEVtYWlsQXV0aFByb3ZpZGVyfSB3aWxsIHRocm93IGFuIGVycm9yLlxuICogQHBhcmFtIHJlc29sdmVyIC0gQW4gaW5zdGFuY2Ugb2Yge0BsaW5rIFBvcHVwUmVkaXJlY3RSZXNvbHZlcn0sIG9wdGlvbmFsXG4gKiBpZiBhbHJlYWR5IHN1cHBsaWVkIHRvIHtAbGluayBpbml0aWFsaXplQXV0aH0gb3IgcHJvdmlkZWQgYnkge0BsaW5rIGdldEF1dGh9LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0KFxuICB1c2VyOiBVc2VyLFxuICBwcm92aWRlcjogQXV0aFByb3ZpZGVyLFxuICByZXNvbHZlcj86IFBvcHVwUmVkaXJlY3RSZXNvbHZlclxuKTogUHJvbWlzZTxuZXZlcj4ge1xuICByZXR1cm4gX3JlYXV0aGVudGljYXRlV2l0aFJlZGlyZWN0KFxuICAgIHVzZXIsXG4gICAgcHJvdmlkZXIsXG4gICAgcmVzb2x2ZXJcbiAgKSBhcyBQcm9taXNlPG5ldmVyPjtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfcmVhdXRoZW50aWNhdGVXaXRoUmVkaXJlY3QoXG4gIHVzZXI6IFVzZXIsXG4gIHByb3ZpZGVyOiBBdXRoUHJvdmlkZXIsXG4gIHJlc29sdmVyPzogUG9wdXBSZWRpcmVjdFJlc29sdmVyXG4pOiBQcm9taXNlPHZvaWQgfCBuZXZlcj4ge1xuICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikgYXMgVXNlckludGVybmFsO1xuICBfYXNzZXJ0SW5zdGFuY2VPZih1c2VySW50ZXJuYWwuYXV0aCwgcHJvdmlkZXIsIEZlZGVyYXRlZEF1dGhQcm92aWRlcik7XG4gIC8vIFdhaXQgZm9yIGF1dGggaW5pdGlhbGl6YXRpb24gdG8gY29tcGxldGUsIHRoaXMgd2lsbCBwcm9jZXNzIHBlbmRpbmcgcmVkaXJlY3RzIGFuZCBjbGVhciB0aGVcbiAgLy8gUEVORElOR19SRURJUkVDVF9LRVkgaW4gcGVyc2lzdGVuY2UuIFRoaXMgc2hvdWxkIGJlIGNvbXBsZXRlZCBiZWZvcmUgc3RhcnRpbmcgYSBuZXdcbiAgLy8gcmVkaXJlY3QgYW5kIGNyZWF0aW5nIGEgUEVORElOR19SRURJUkVDVF9LRVkgZW50cnkuXG4gIGF3YWl0IHVzZXJJbnRlcm5hbC5hdXRoLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gIC8vIEFsbG93IHRoZSByZXNvbHZlciB0byBlcnJvciBiZWZvcmUgcGVyc2lzdGluZyB0aGUgcmVkaXJlY3QgdXNlclxuICBjb25zdCByZXNvbHZlckludGVybmFsID0gX3dpdGhEZWZhdWx0UmVzb2x2ZXIodXNlckludGVybmFsLmF1dGgsIHJlc29sdmVyKTtcbiAgYXdhaXQgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlckludGVybmFsLCB1c2VySW50ZXJuYWwuYXV0aCk7XG5cbiAgY29uc3QgZXZlbnRJZCA9IGF3YWl0IHByZXBhcmVVc2VyRm9yUmVkaXJlY3QodXNlckludGVybmFsKTtcbiAgcmV0dXJuIHJlc29sdmVySW50ZXJuYWwuX29wZW5SZWRpcmVjdChcbiAgICB1c2VySW50ZXJuYWwuYXV0aCxcbiAgICBwcm92aWRlcixcbiAgICBBdXRoRXZlbnRUeXBlLlJFQVVUSF9WSUFfUkVESVJFQ1QsXG4gICAgZXZlbnRJZFxuICApO1xufVxuXG4vKipcbiAqIExpbmtzIHRoZSB7QGxpbmsgT0F1dGhQcm92aWRlcn0gdG8gdGhlIHVzZXIgYWNjb3VudCB1c2luZyBhIGZ1bGwtcGFnZSByZWRpcmVjdCBmbG93LlxuICogQHJlbWFya3NcbiAqIFRvIGhhbmRsZSB0aGUgcmVzdWx0cyBhbmQgZXJyb3JzIGZvciB0aGlzIG9wZXJhdGlvbiwgcmVmZXIgdG8ge0BsaW5rIGdldFJlZGlyZWN0UmVzdWx0fS5cbiAqIEZvbGxvdyB0aGUge0BsaW5rIGh0dHBzOi8vZmlyZWJhc2UuZ29vZ2xlLmNvbS9kb2NzL2F1dGgvd2ViL3JlZGlyZWN0LWJlc3QtcHJhY3RpY2VzXG4gKiB8IGJlc3QgcHJhY3RpY2VzfSB3aGVuIHVzaW5nIHtAbGluayBsaW5rV2l0aFJlZGlyZWN0fS5cbiAqXG4gKiBUaGlzIG1ldGhvZCBkb2VzIG5vdCB3b3JrIGluIGEgTm9kZS5qcyBlbnZpcm9ubWVudC5cbiAqXG4gKiBAZXhhbXBsZVxuICogYGBgamF2YXNjcmlwdFxuICogLy8gU2lnbiBpbiB1c2luZyBzb21lIG90aGVyIHByb3ZpZGVyLlxuICogY29uc3QgcmVzdWx0ID0gYXdhaXQgc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQoYXV0aCwgZW1haWwsIHBhc3N3b3JkKTtcbiAqIC8vIExpbmsgdXNpbmcgYSByZWRpcmVjdC5cbiAqIGNvbnN0IHByb3ZpZGVyID0gbmV3IEZhY2Vib29rQXV0aFByb3ZpZGVyKCk7XG4gKiBhd2FpdCBsaW5rV2l0aFJlZGlyZWN0KHJlc3VsdC51c2VyLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIHVzZXIuXG4gKiBAcGFyYW0gcHJvdmlkZXIgLSBUaGUgcHJvdmlkZXIgdG8gYXV0aGVudGljYXRlLiBUaGUgcHJvdmlkZXIgaGFzIHRvIGJlIGFuIHtAbGluayBPQXV0aFByb3ZpZGVyfS5cbiAqIE5vbi1PQXV0aCBwcm92aWRlcnMgbGlrZSB7QGxpbmsgRW1haWxBdXRoUHJvdmlkZXJ9IHdpbGwgdGhyb3cgYW4gZXJyb3IuXG4gKiBAcGFyYW0gcmVzb2x2ZXIgLSBBbiBpbnN0YW5jZSBvZiB7QGxpbmsgUG9wdXBSZWRpcmVjdFJlc29sdmVyfSwgb3B0aW9uYWxcbiAqIGlmIGFscmVhZHkgc3VwcGxpZWQgdG8ge0BsaW5rIGluaXRpYWxpemVBdXRofSBvciBwcm92aWRlZCBieSB7QGxpbmsgZ2V0QXV0aH0uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgZnVuY3Rpb24gbGlua1dpdGhSZWRpcmVjdChcbiAgdXNlcjogVXNlcixcbiAgcHJvdmlkZXI6IEF1dGhQcm92aWRlcixcbiAgcmVzb2x2ZXI/OiBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJcbik6IFByb21pc2U8bmV2ZXI+IHtcbiAgcmV0dXJuIF9saW5rV2l0aFJlZGlyZWN0KHVzZXIsIHByb3ZpZGVyLCByZXNvbHZlcikgYXMgUHJvbWlzZTxuZXZlcj47XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX2xpbmtXaXRoUmVkaXJlY3QoXG4gIHVzZXI6IFVzZXIsXG4gIHByb3ZpZGVyOiBBdXRoUHJvdmlkZXIsXG4gIHJlc29sdmVyPzogUG9wdXBSZWRpcmVjdFJlc29sdmVyXG4pOiBQcm9taXNlPHZvaWQgfCBuZXZlcj4ge1xuICBjb25zdCB1c2VySW50ZXJuYWwgPSBnZXRNb2R1bGFySW5zdGFuY2UodXNlcikgYXMgVXNlckludGVybmFsO1xuICBfYXNzZXJ0SW5zdGFuY2VPZih1c2VySW50ZXJuYWwuYXV0aCwgcHJvdmlkZXIsIEZlZGVyYXRlZEF1dGhQcm92aWRlcik7XG4gIC8vIFdhaXQgZm9yIGF1dGggaW5pdGlhbGl6YXRpb24gdG8gY29tcGxldGUsIHRoaXMgd2lsbCBwcm9jZXNzIHBlbmRpbmcgcmVkaXJlY3RzIGFuZCBjbGVhciB0aGVcbiAgLy8gUEVORElOR19SRURJUkVDVF9LRVkgaW4gcGVyc2lzdGVuY2UuIFRoaXMgc2hvdWxkIGJlIGNvbXBsZXRlZCBiZWZvcmUgc3RhcnRpbmcgYSBuZXdcbiAgLy8gcmVkaXJlY3QgYW5kIGNyZWF0aW5nIGEgUEVORElOR19SRURJUkVDVF9LRVkgZW50cnkuXG4gIGF3YWl0IHVzZXJJbnRlcm5hbC5hdXRoLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gIC8vIEFsbG93IHRoZSByZXNvbHZlciB0byBlcnJvciBiZWZvcmUgcGVyc2lzdGluZyB0aGUgcmVkaXJlY3QgdXNlclxuICBjb25zdCByZXNvbHZlckludGVybmFsID0gX3dpdGhEZWZhdWx0UmVzb2x2ZXIodXNlckludGVybmFsLmF1dGgsIHJlc29sdmVyKTtcbiAgYXdhaXQgX2Fzc2VydExpbmtlZFN0YXR1cyhmYWxzZSwgdXNlckludGVybmFsLCBwcm92aWRlci5wcm92aWRlcklkKTtcbiAgYXdhaXQgX3NldFBlbmRpbmdSZWRpcmVjdFN0YXR1cyhyZXNvbHZlckludGVybmFsLCB1c2VySW50ZXJuYWwuYXV0aCk7XG5cbiAgY29uc3QgZXZlbnRJZCA9IGF3YWl0IHByZXBhcmVVc2VyRm9yUmVkaXJlY3QodXNlckludGVybmFsKTtcbiAgcmV0dXJuIHJlc29sdmVySW50ZXJuYWwuX29wZW5SZWRpcmVjdChcbiAgICB1c2VySW50ZXJuYWwuYXV0aCxcbiAgICBwcm92aWRlcixcbiAgICBBdXRoRXZlbnRUeXBlLkxJTktfVklBX1JFRElSRUNULFxuICAgIGV2ZW50SWRcbiAgKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEge0BsaW5rIFVzZXJDcmVkZW50aWFsfSBmcm9tIHRoZSByZWRpcmVjdC1iYXNlZCBzaWduLWluIGZsb3cuXG4gKlxuICogQHJlbWFya3NcbiAqIElmIHNpZ24taW4gc3VjY2VlZGVkLCByZXR1cm5zIHRoZSBzaWduZWQgaW4gdXNlci4gSWYgc2lnbi1pbiB3YXMgdW5zdWNjZXNzZnVsLCBmYWlscyB3aXRoIGFuXG4gKiBlcnJvci4gSWYgbm8gcmVkaXJlY3Qgb3BlcmF0aW9uIHdhcyBjYWxsZWQsIHJldHVybnMgYG51bGxgLlxuICpcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGBqYXZhc2NyaXB0XG4gKiAvLyBTaWduIGluIHVzaW5nIGEgcmVkaXJlY3QuXG4gKiBjb25zdCBwcm92aWRlciA9IG5ldyBGYWNlYm9va0F1dGhQcm92aWRlcigpO1xuICogLy8gWW91IGNhbiBhZGQgYWRkaXRpb25hbCBzY29wZXMgdG8gdGhlIHByb3ZpZGVyOlxuICogcHJvdmlkZXIuYWRkU2NvcGUoJ3VzZXJfYmlydGhkYXknKTtcbiAqIC8vIFN0YXJ0IGEgc2lnbiBpbiBwcm9jZXNzIGZvciBhbiB1bmF1dGhlbnRpY2F0ZWQgdXNlci5cbiAqIGF3YWl0IHNpZ25JbldpdGhSZWRpcmVjdChhdXRoLCBwcm92aWRlcik7XG4gKiAvLyBUaGlzIHdpbGwgdHJpZ2dlciBhIGZ1bGwgcGFnZSByZWRpcmVjdCBhd2F5IGZyb20geW91ciBhcHBcbiAqXG4gKiAvLyBBZnRlciByZXR1cm5pbmcgZnJvbSB0aGUgcmVkaXJlY3Qgd2hlbiB5b3VyIGFwcCBpbml0aWFsaXplcyB5b3UgY2FuIG9idGFpbiB0aGUgcmVzdWx0XG4gKiBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRSZWRpcmVjdFJlc3VsdChhdXRoKTtcbiAqIGlmIChyZXN1bHQpIHtcbiAqICAgLy8gVGhpcyBpcyB0aGUgc2lnbmVkLWluIHVzZXJcbiAqICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xuICogICAvLyBUaGlzIGdpdmVzIHlvdSBhIEZhY2Vib29rIEFjY2VzcyBUb2tlbi5cbiAqICAgY29uc3QgY3JlZGVudGlhbCA9IHByb3ZpZGVyLmNyZWRlbnRpYWxGcm9tUmVzdWx0KGF1dGgsIHJlc3VsdCk7XG4gKiAgIGNvbnN0IHRva2VuID0gY3JlZGVudGlhbC5hY2Nlc3NUb2tlbjtcbiAqIH1cbiAqIC8vIEFzIHRoaXMgQVBJIGNhbiBiZSB1c2VkIGZvciBzaWduLWluLCBsaW5raW5nIGFuZCByZWF1dGhlbnRpY2F0aW9uLFxuICogLy8gY2hlY2sgdGhlIG9wZXJhdGlvblR5cGUgdG8gZGV0ZXJtaW5lIHdoYXQgdHJpZ2dlcmVkIHRoaXMgcmVkaXJlY3RcbiAqIC8vIG9wZXJhdGlvbi5cbiAqIGNvbnN0IG9wZXJhdGlvblR5cGUgPSByZXN1bHQub3BlcmF0aW9uVHlwZTtcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSBhdXRoIC0gVGhlIHtAbGluayBBdXRofSBpbnN0YW5jZS5cbiAqIEBwYXJhbSByZXNvbHZlciAtIEFuIGluc3RhbmNlIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9LCBvcHRpb25hbFxuICogaWYgYWxyZWFkeSBzdXBwbGllZCB0byB7QGxpbmsgaW5pdGlhbGl6ZUF1dGh9IG9yIHByb3ZpZGVkIGJ5IHtAbGluayBnZXRBdXRofS5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSZWRpcmVjdFJlc3VsdChcbiAgYXV0aDogQXV0aCxcbiAgcmVzb2x2ZXI/OiBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJcbik6IFByb21pc2U8VXNlckNyZWRlbnRpYWwgfCBudWxsPiB7XG4gIGF3YWl0IF9jYXN0QXV0aChhdXRoKS5faW5pdGlhbGl6YXRpb25Qcm9taXNlO1xuICByZXR1cm4gX2dldFJlZGlyZWN0UmVzdWx0KGF1dGgsIHJlc29sdmVyLCBmYWxzZSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfZ2V0UmVkaXJlY3RSZXN1bHQoXG4gIGF1dGg6IEF1dGgsXG4gIHJlc29sdmVyRXh0ZXJuPzogUG9wdXBSZWRpcmVjdFJlc29sdmVyLFxuICBieXBhc3NBdXRoU3RhdGUgPSBmYWxzZVxuKTogUHJvbWlzZTxVc2VyQ3JlZGVudGlhbCB8IG51bGw+IHtcbiAgY29uc3QgYXV0aEludGVybmFsID0gX2Nhc3RBdXRoKGF1dGgpO1xuICBjb25zdCByZXNvbHZlciA9IF93aXRoRGVmYXVsdFJlc29sdmVyKGF1dGhJbnRlcm5hbCwgcmVzb2x2ZXJFeHRlcm4pO1xuICBjb25zdCBhY3Rpb24gPSBuZXcgUmVkaXJlY3RBY3Rpb24oYXV0aEludGVybmFsLCByZXNvbHZlciwgYnlwYXNzQXV0aFN0YXRlKTtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYWN0aW9uLmV4ZWN1dGUoKTtcblxuICBpZiAocmVzdWx0ICYmICFieXBhc3NBdXRoU3RhdGUpIHtcbiAgICBkZWxldGUgcmVzdWx0LnVzZXIuX3JlZGlyZWN0RXZlbnRJZDtcbiAgICBhd2FpdCBhdXRoSW50ZXJuYWwuX3BlcnNpc3RVc2VySWZDdXJyZW50KHJlc3VsdC51c2VyIGFzIFVzZXJJbnRlcm5hbCk7XG4gICAgYXdhaXQgYXV0aEludGVybmFsLl9zZXRSZWRpcmVjdFVzZXIobnVsbCwgcmVzb2x2ZXJFeHRlcm4pO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcHJlcGFyZVVzZXJGb3JSZWRpcmVjdCh1c2VyOiBVc2VySW50ZXJuYWwpOiBQcm9taXNlPHN0cmluZz4ge1xuICBjb25zdCBldmVudElkID0gX2dlbmVyYXRlRXZlbnRJZChgJHt1c2VyLnVpZH06OjpgKTtcbiAgdXNlci5fcmVkaXJlY3RFdmVudElkID0gZXZlbnRJZDtcbiAgYXdhaXQgdXNlci5hdXRoLl9zZXRSZWRpcmVjdFVzZXIodXNlcik7XG4gIGF3YWl0IHVzZXIuYXV0aC5fcGVyc2lzdFVzZXJJZkN1cnJlbnQodXNlcik7XG4gIHJldHVybiBldmVudElkO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIEF1dGhFdmVudCxcbiAgQXV0aEV2ZW50Q29uc3VtZXIsXG4gIEF1dGhFdmVudFR5cGUsXG4gIEV2ZW50TWFuYWdlclxufSBmcm9tICcuLi8uLi9tb2RlbC9wb3B1cF9yZWRpcmVjdCc7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgX2NyZWF0ZUVycm9yIH0gZnJvbSAnLi4vdXRpbC9hc3NlcnQnO1xuXG4vLyBUaGUgYW1vdW50IG9mIHRpbWUgdG8gc3RvcmUgdGhlIFVJRHMgb2Ygc2VlbiBldmVudHM7IHRoaXMgaXNcbi8vIHNldCB0byAxMCBtaW4gYnkgZGVmYXVsdFxuY29uc3QgRVZFTlRfRFVQTElDQVRJT05fQ0FDSEVfRFVSQVRJT05fTVMgPSAxMCAqIDYwICogMTAwMDtcblxuZXhwb3J0IGNsYXNzIEF1dGhFdmVudE1hbmFnZXIgaW1wbGVtZW50cyBFdmVudE1hbmFnZXIge1xuICBwcml2YXRlIHJlYWRvbmx5IGNhY2hlZEV2ZW50VWlkczogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XG4gIHByaXZhdGUgcmVhZG9ubHkgY29uc3VtZXJzOiBTZXQ8QXV0aEV2ZW50Q29uc3VtZXI+ID0gbmV3IFNldCgpO1xuICBwcm90ZWN0ZWQgcXVldWVkUmVkaXJlY3RFdmVudDogQXV0aEV2ZW50IHwgbnVsbCA9IG51bGw7XG4gIHByb3RlY3RlZCBoYXNIYW5kbGVkUG90ZW50aWFsUmVkaXJlY3QgPSBmYWxzZTtcbiAgcHJpdmF0ZSBsYXN0UHJvY2Vzc2VkRXZlbnRUaW1lID0gRGF0ZS5ub3coKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGF1dGg6IEF1dGhJbnRlcm5hbCkge31cblxuICByZWdpc3RlckNvbnN1bWVyKGF1dGhFdmVudENvbnN1bWVyOiBBdXRoRXZlbnRDb25zdW1lcik6IHZvaWQge1xuICAgIHRoaXMuY29uc3VtZXJzLmFkZChhdXRoRXZlbnRDb25zdW1lcik7XG5cbiAgICBpZiAoXG4gICAgICB0aGlzLnF1ZXVlZFJlZGlyZWN0RXZlbnQgJiZcbiAgICAgIHRoaXMuaXNFdmVudEZvckNvbnN1bWVyKHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCwgYXV0aEV2ZW50Q29uc3VtZXIpXG4gICAgKSB7XG4gICAgICB0aGlzLnNlbmRUb0NvbnN1bWVyKHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCwgYXV0aEV2ZW50Q29uc3VtZXIpO1xuICAgICAgdGhpcy5zYXZlRXZlbnRUb0NhY2hlKHRoaXMucXVldWVkUmVkaXJlY3RFdmVudCk7XG4gICAgICB0aGlzLnF1ZXVlZFJlZGlyZWN0RXZlbnQgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHVucmVnaXN0ZXJDb25zdW1lcihhdXRoRXZlbnRDb25zdW1lcjogQXV0aEV2ZW50Q29uc3VtZXIpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnN1bWVycy5kZWxldGUoYXV0aEV2ZW50Q29uc3VtZXIpO1xuICB9XG5cbiAgb25FdmVudChldmVudDogQXV0aEV2ZW50KTogYm9vbGVhbiB7XG4gICAgLy8gQ2hlY2sgaWYgdGhlIGV2ZW50IGhhcyBhbHJlYWR5IGJlZW4gaGFuZGxlZFxuICAgIGlmICh0aGlzLmhhc0V2ZW50QmVlbkhhbmRsZWQoZXZlbnQpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgbGV0IGhhbmRsZWQgPSBmYWxzZTtcbiAgICB0aGlzLmNvbnN1bWVycy5mb3JFYWNoKGNvbnN1bWVyID0+IHtcbiAgICAgIGlmICh0aGlzLmlzRXZlbnRGb3JDb25zdW1lcihldmVudCwgY29uc3VtZXIpKSB7XG4gICAgICAgIGhhbmRsZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLnNlbmRUb0NvbnN1bWVyKGV2ZW50LCBjb25zdW1lcik7XG4gICAgICAgIHRoaXMuc2F2ZUV2ZW50VG9DYWNoZShldmVudCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAodGhpcy5oYXNIYW5kbGVkUG90ZW50aWFsUmVkaXJlY3QgfHwgIWlzUmVkaXJlY3RFdmVudChldmVudCkpIHtcbiAgICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgc2VlbiBhIHJlZGlyZWN0IGJlZm9yZSwgb3IgdGhpcyBpcyBhIHBvcHVwIGV2ZW50LFxuICAgICAgLy8gYmFpbCBub3dcbiAgICAgIHJldHVybiBoYW5kbGVkO1xuICAgIH1cblxuICAgIHRoaXMuaGFzSGFuZGxlZFBvdGVudGlhbFJlZGlyZWN0ID0gdHJ1ZTtcblxuICAgIC8vIElmIHRoZSByZWRpcmVjdCB3YXNuJ3QgaGFuZGxlZCwgaGFuZyBvbiB0byBpdFxuICAgIGlmICghaGFuZGxlZCkge1xuICAgICAgdGhpcy5xdWV1ZWRSZWRpcmVjdEV2ZW50ID0gZXZlbnQ7XG4gICAgICBoYW5kbGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gaGFuZGxlZDtcbiAgfVxuXG4gIHByaXZhdGUgc2VuZFRvQ29uc3VtZXIoZXZlbnQ6IEF1dGhFdmVudCwgY29uc3VtZXI6IEF1dGhFdmVudENvbnN1bWVyKTogdm9pZCB7XG4gICAgaWYgKGV2ZW50LmVycm9yICYmICFpc051bGxSZWRpcmVjdEV2ZW50KGV2ZW50KSkge1xuICAgICAgY29uc3QgY29kZSA9XG4gICAgICAgIChldmVudC5lcnJvci5jb2RlPy5zcGxpdCgnYXV0aC8nKVsxXSBhcyBBdXRoRXJyb3JDb2RlKSB8fFxuICAgICAgICBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SO1xuICAgICAgY29uc3VtZXIub25FcnJvcihfY3JlYXRlRXJyb3IodGhpcy5hdXRoLCBjb2RlKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN1bWVyLm9uQXV0aEV2ZW50KGV2ZW50KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGlzRXZlbnRGb3JDb25zdW1lcihcbiAgICBldmVudDogQXV0aEV2ZW50LFxuICAgIGNvbnN1bWVyOiBBdXRoRXZlbnRDb25zdW1lclxuICApOiBib29sZWFuIHtcbiAgICBjb25zdCBldmVudElkTWF0Y2hlcyA9XG4gICAgICBjb25zdW1lci5ldmVudElkID09PSBudWxsIHx8XG4gICAgICAoISFldmVudC5ldmVudElkICYmIGV2ZW50LmV2ZW50SWQgPT09IGNvbnN1bWVyLmV2ZW50SWQpO1xuICAgIHJldHVybiBjb25zdW1lci5maWx0ZXIuaW5jbHVkZXMoZXZlbnQudHlwZSkgJiYgZXZlbnRJZE1hdGNoZXM7XG4gIH1cblxuICBwcml2YXRlIGhhc0V2ZW50QmVlbkhhbmRsZWQoZXZlbnQ6IEF1dGhFdmVudCk6IGJvb2xlYW4ge1xuICAgIGlmIChcbiAgICAgIERhdGUubm93KCkgLSB0aGlzLmxhc3RQcm9jZXNzZWRFdmVudFRpbWUgPj1cbiAgICAgIEVWRU5UX0RVUExJQ0FUSU9OX0NBQ0hFX0RVUkFUSU9OX01TXG4gICAgKSB7XG4gICAgICB0aGlzLmNhY2hlZEV2ZW50VWlkcy5jbGVhcigpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNhY2hlZEV2ZW50VWlkcy5oYXMoZXZlbnRVaWQoZXZlbnQpKTtcbiAgfVxuXG4gIHByaXZhdGUgc2F2ZUV2ZW50VG9DYWNoZShldmVudDogQXV0aEV2ZW50KTogdm9pZCB7XG4gICAgdGhpcy5jYWNoZWRFdmVudFVpZHMuYWRkKGV2ZW50VWlkKGV2ZW50KSk7XG4gICAgdGhpcy5sYXN0UHJvY2Vzc2VkRXZlbnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBldmVudFVpZChlOiBBdXRoRXZlbnQpOiBzdHJpbmcge1xuICByZXR1cm4gW2UudHlwZSwgZS5ldmVudElkLCBlLnNlc3Npb25JZCwgZS50ZW5hbnRJZF0uZmlsdGVyKHYgPT4gdikuam9pbignLScpO1xufVxuXG5mdW5jdGlvbiBpc051bGxSZWRpcmVjdEV2ZW50KHsgdHlwZSwgZXJyb3IgfTogQXV0aEV2ZW50KTogYm9vbGVhbiB7XG4gIHJldHVybiAoXG4gICAgdHlwZSA9PT0gQXV0aEV2ZW50VHlwZS5VTktOT1dOICYmXG4gICAgZXJyb3I/LmNvZGUgPT09IGBhdXRoLyR7QXV0aEVycm9yQ29kZS5OT19BVVRIX0VWRU5UfWBcbiAgKTtcbn1cblxuZnVuY3Rpb24gaXNSZWRpcmVjdEV2ZW50KGV2ZW50OiBBdXRoRXZlbnQpOiBib29sZWFuIHtcbiAgc3dpdGNoIChldmVudC50eXBlKSB7XG4gICAgY2FzZSBBdXRoRXZlbnRUeXBlLlNJR05fSU5fVklBX1JFRElSRUNUOlxuICAgIGNhc2UgQXV0aEV2ZW50VHlwZS5MSU5LX1ZJQV9SRURJUkVDVDpcbiAgICBjYXNlIEF1dGhFdmVudFR5cGUuUkVBVVRIX1ZJQV9SRURJUkVDVDpcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIGNhc2UgQXV0aEV2ZW50VHlwZS5VTktOT1dOOlxuICAgICAgcmV0dXJuIGlzTnVsbFJlZGlyZWN0RXZlbnQoZXZlbnQpO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBfcGVyZm9ybUFwaVJlcXVlc3QsIEVuZHBvaW50LCBIdHRwTWV0aG9kIH0gZnJvbSAnLi4vaW5kZXgnO1xuaW1wb3J0IHsgQXV0aCB9IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2V0UHJvamVjdENvbmZpZ1JlcXVlc3Qge1xuICBhbmRyb2lkUGFja2FnZU5hbWU/OiBzdHJpbmc7XG4gIGlvc0J1bmRsZUlkPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdldFByb2plY3RDb25maWdSZXNwb25zZSB7XG4gIGF1dGhvcml6ZWREb21haW5zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF9nZXRQcm9qZWN0Q29uZmlnKFxuICBhdXRoOiBBdXRoLFxuICByZXF1ZXN0OiBHZXRQcm9qZWN0Q29uZmlnUmVxdWVzdCA9IHt9XG4pOiBQcm9taXNlPEdldFByb2plY3RDb25maWdSZXNwb25zZT4ge1xuICByZXR1cm4gX3BlcmZvcm1BcGlSZXF1ZXN0PEdldFByb2plY3RDb25maWdSZXF1ZXN0LCBHZXRQcm9qZWN0Q29uZmlnUmVzcG9uc2U+KFxuICAgIGF1dGgsXG4gICAgSHR0cE1ldGhvZC5HRVQsXG4gICAgRW5kcG9pbnQuR0VUX1BST0pFQ1RfQ09ORklHLFxuICAgIHJlcXVlc3RcbiAgKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBfZ2V0UHJvamVjdENvbmZpZyB9IGZyb20gJy4uLy4uL2FwaS9wcm9qZWN0X2NvbmZpZy9nZXRfcHJvamVjdF9jb25maWcnO1xuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IF9mYWlsIH0gZnJvbSAnLi9hc3NlcnQnO1xuaW1wb3J0IHsgX2dldEN1cnJlbnRVcmwgfSBmcm9tICcuL2xvY2F0aW9uJztcblxuY29uc3QgSVBfQUREUkVTU19SRUdFWCA9IC9eXFxkezEsM31cXC5cXGR7MSwzfVxcLlxcZHsxLDN9XFwuXFxkezEsM30kLztcbmNvbnN0IEhUVFBfUkVHRVggPSAvXmh0dHBzPy87XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBfdmFsaWRhdGVPcmlnaW4oYXV0aDogQXV0aEludGVybmFsKTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIFNraXAgb3JpZ2luIHZhbGlkYXRpb24gaWYgd2UgYXJlIGluIGFuIGVtdWxhdGVkIGVudmlyb25tZW50XG4gIGlmIChhdXRoLmNvbmZpZy5lbXVsYXRvcikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHsgYXV0aG9yaXplZERvbWFpbnMgfSA9IGF3YWl0IF9nZXRQcm9qZWN0Q29uZmlnKGF1dGgpO1xuXG4gIGZvciAoY29uc3QgZG9tYWluIG9mIGF1dGhvcml6ZWREb21haW5zKSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChtYXRjaERvbWFpbihkb21haW4pKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9IGNhdGNoIHtcbiAgICAgIC8vIERvIG5vdGhpbmcgaWYgdGhlcmUncyBhIFVSTCBlcnJvcjsganVzdCBjb250aW51ZSBzZWFyY2hpbmdcbiAgICB9XG4gIH1cblxuICAvLyBJbiB0aGUgb2xkIFNESywgdGhpcyBlcnJvciBhbHNvIHByb3ZpZGVzIGhlbHBmdWwgbWVzc2FnZXMuXG4gIF9mYWlsKGF1dGgsIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9PUklHSU4pO1xufVxuXG5mdW5jdGlvbiBtYXRjaERvbWFpbihleHBlY3RlZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IGN1cnJlbnRVcmwgPSBfZ2V0Q3VycmVudFVybCgpO1xuICBjb25zdCB7IHByb3RvY29sLCBob3N0bmFtZSB9ID0gbmV3IFVSTChjdXJyZW50VXJsKTtcbiAgaWYgKGV4cGVjdGVkLnN0YXJ0c1dpdGgoJ2Nocm9tZS1leHRlbnNpb246Ly8nKSkge1xuICAgIGNvbnN0IGNlVXJsID0gbmV3IFVSTChleHBlY3RlZCk7XG5cbiAgICBpZiAoY2VVcmwuaG9zdG5hbWUgPT09ICcnICYmIGhvc3RuYW1lID09PSAnJykge1xuICAgICAgLy8gRm9yIHNvbWUgcmVhc29uIHdlJ3JlIG5vdCBwYXJzaW5nIGNocm9tZSBVUkxzIHByb3Blcmx5XG4gICAgICByZXR1cm4gKFxuICAgICAgICBwcm90b2NvbCA9PT0gJ2Nocm9tZS1leHRlbnNpb246JyAmJlxuICAgICAgICBleHBlY3RlZC5yZXBsYWNlKCdjaHJvbWUtZXh0ZW5zaW9uOi8vJywgJycpID09PVxuICAgICAgICAgIGN1cnJlbnRVcmwucmVwbGFjZSgnY2hyb21lLWV4dGVuc2lvbjovLycsICcnKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJvdG9jb2wgPT09ICdjaHJvbWUtZXh0ZW5zaW9uOicgJiYgY2VVcmwuaG9zdG5hbWUgPT09IGhvc3RuYW1lO1xuICB9XG5cbiAgaWYgKCFIVFRQX1JFR0VYLnRlc3QocHJvdG9jb2wpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKElQX0FERFJFU1NfUkVHRVgudGVzdChleHBlY3RlZCkpIHtcbiAgICAvLyBUaGUgZG9tYWluIGhhcyB0byBiZSBleGFjdGx5IGVxdWFsIHRvIHRoZSBwYXR0ZXJuLCBhcyBhbiBJUCBkb21haW4gd2lsbFxuICAgIC8vIG9ubHkgY29udGFpbiB0aGUgSVAsIG5vIGV4dHJhIGNoYXJhY3Rlci5cbiAgICByZXR1cm4gaG9zdG5hbWUgPT09IGV4cGVjdGVkO1xuICB9XG5cbiAgLy8gRG90cyBpbiBwYXR0ZXJuIHNob3VsZCBiZSBlc2NhcGVkLlxuICBjb25zdCBlc2NhcGVkRG9tYWluUGF0dGVybiA9IGV4cGVjdGVkLnJlcGxhY2UoL1xcLi9nLCAnXFxcXC4nKTtcbiAgLy8gTm9uIGlwIGFkZHJlc3MgZG9tYWlucy5cbiAgLy8gZG9tYWluLmNvbSA9ICouZG9tYWluLmNvbSBPUiBkb21haW4uY29tXG4gIGNvbnN0IHJlID0gbmV3IFJlZ0V4cChcbiAgICAnXiguK1xcXFwuJyArIGVzY2FwZWREb21haW5QYXR0ZXJuICsgJ3wnICsgZXNjYXBlZERvbWFpblBhdHRlcm4gKyAnKSQnLFxuICAgICdpJ1xuICApO1xuICByZXR1cm4gcmUudGVzdChob3N0bmFtZSk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi8uLi9jb3JlL2Vycm9ycyc7XG5pbXBvcnQgeyBfY3JlYXRlRXJyb3IgfSBmcm9tICcuLi8uLi9jb3JlL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IERlbGF5IH0gZnJvbSAnLi4vLi4vY29yZS91dGlsL2RlbGF5JztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHsgX3dpbmRvdyB9IGZyb20gJy4uL2F1dGhfd2luZG93JztcbmltcG9ydCAqIGFzIGpzIGZyb20gJy4uL2xvYWRfanMnO1xuXG5jb25zdCBORVRXT1JLX1RJTUVPVVQgPSBuZXcgRGVsYXkoMzAwMDAsIDYwMDAwKTtcblxuLyoqXG4gKiBSZXNldCB1bmxhb2RlZCBHQXBpIG1vZHVsZXMuIElmIGdhcGkubG9hZCBmYWlscyBkdWUgdG8gYSBuZXR3b3JrIGVycm9yLFxuICogaXQgd2lsbCBzdG9wIHdvcmtpbmcgYWZ0ZXIgYSByZXRyaWFsLiBUaGlzIGlzIGEgaGFjayB0byBmaXggdGhpcyBpc3N1ZS5cbiAqL1xuZnVuY3Rpb24gcmVzZXRVbmxvYWRlZEdhcGlNb2R1bGVzKCk6IHZvaWQge1xuICAvLyBDbGVhciBsYXN0IGZhaWxlZCBnYXBpLmxvYWQgc3RhdGUgdG8gZm9yY2UgbmV4dCBnYXBpLmxvYWQgdG8gZmlyc3RcbiAgLy8gbG9hZCB0aGUgZmFpbGVkIGdhcGkuaWZyYW1lcyBtb2R1bGUuXG4gIC8vIEdldCBnYXBpeC5iZWFjb24gY29udGV4dC5cbiAgY29uc3QgYmVhY29uID0gX3dpbmRvdygpLl9fX2pzbDtcbiAgLy8gR2V0IGN1cnJlbnQgaGludC5cbiAgaWYgKGJlYWNvbj8uSCkge1xuICAgIC8vIEdldCBnYXBpIGhpbnQuXG4gICAgZm9yIChjb25zdCBoaW50IG9mIE9iamVjdC5rZXlzKGJlYWNvbi5IKSkge1xuICAgICAgLy8gUmVxdWVzdGVkIG1vZHVsZXMuXG4gICAgICBiZWFjb24uSFtoaW50XS5yID0gYmVhY29uLkhbaGludF0uciB8fCBbXTtcbiAgICAgIC8vIExvYWRlZCBtb2R1bGVzLlxuICAgICAgYmVhY29uLkhbaGludF0uTCA9IGJlYWNvbi5IW2hpbnRdLkwgfHwgW107XG4gICAgICAvLyBTZXQgcmVxdWVzdGVkIG1vZHVsZXMgdG8gYSBjb3B5IG9mIHRoZSBsb2FkZWQgbW9kdWxlcy5cbiAgICAgIGJlYWNvbi5IW2hpbnRdLnIgPSBbLi4uYmVhY29uLkhbaGludF0uTF07XG4gICAgICAvLyBDbGVhciBwZW5kaW5nIGNhbGxiYWNrcy5cbiAgICAgIGlmIChiZWFjb24uQ1ApIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiZWFjb24uQ1AubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAvLyBSZW1vdmUgYWxsIGZhaWxlZCBwZW5kaW5nIGNhbGxiYWNrcy5cbiAgICAgICAgICBiZWFjb24uQ1BbaV0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIGxvYWRHYXBpKGF1dGg6IEF1dGhJbnRlcm5hbCk6IFByb21pc2U8Z2FwaS5pZnJhbWVzLkNvbnRleHQ+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlPGdhcGkuaWZyYW1lcy5Db250ZXh0PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgLy8gRnVuY3Rpb24gdG8gcnVuIHdoZW4gZ2FwaS5sb2FkIGlzIHJlYWR5LlxuICAgIGZ1bmN0aW9uIGxvYWRHYXBpSWZyYW1lKCk6IHZvaWQge1xuICAgICAgLy8gVGhlIGRldmVsb3BlciBtYXkgaGF2ZSB0cmllZCB0byBwcmV2aW91c2x5IHJ1biBnYXBpLmxvYWQgYW5kIGZhaWxlZC5cbiAgICAgIC8vIFJ1biB0aGlzIHRvIGZpeCB0aGF0LlxuICAgICAgcmVzZXRVbmxvYWRlZEdhcGlNb2R1bGVzKCk7XG4gICAgICBnYXBpLmxvYWQoJ2dhcGkuaWZyYW1lcycsIHtcbiAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICByZXNvbHZlKGdhcGkuaWZyYW1lcy5nZXRDb250ZXh0KCkpO1xuICAgICAgICB9LFxuICAgICAgICBvbnRpbWVvdXQ6ICgpID0+IHtcbiAgICAgICAgICAvLyBUaGUgYWJvdmUgcmVzZXQgbWF5IGJlIHN1ZmZpY2llbnQsIGJ1dCBoYXZpbmcgdGhpcyByZXNldCBhZnRlclxuICAgICAgICAgIC8vIGZhaWx1cmUgZW5zdXJlcyB0aGF0IGlmIHRoZSBkZXZlbG9wZXIgY2FsbHMgZ2FwaS5sb2FkIGFmdGVyIHRoZVxuICAgICAgICAgIC8vIGNvbm5lY3Rpb24gaXMgcmUtZXN0YWJsaXNoZWQgYW5kIGJlZm9yZSBhbm90aGVyIGF0dGVtcHQgdG8gZW1iZWRcbiAgICAgICAgICAvLyB0aGUgaWZyYW1lLCBpdCB3b3VsZCB3b3JrIGFuZCB3b3VsZCBub3QgYmUgYnJva2VuIGJlY2F1c2Ugb2Ygb3VyXG4gICAgICAgICAgLy8gZmFpbGVkIGF0dGVtcHQuXG4gICAgICAgICAgLy8gVGltZW91dCB3aGVuIGdhcGkuaWZyYW1lcy5JZnJhbWUgbm90IGxvYWRlZC5cbiAgICAgICAgICByZXNldFVubG9hZGVkR2FwaU1vZHVsZXMoKTtcbiAgICAgICAgICByZWplY3QoX2NyZWF0ZUVycm9yKGF1dGgsIEF1dGhFcnJvckNvZGUuTkVUV09SS19SRVFVRVNUX0ZBSUxFRCkpO1xuICAgICAgICB9LFxuICAgICAgICB0aW1lb3V0OiBORVRXT1JLX1RJTUVPVVQuZ2V0KClcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChfd2luZG93KCkuZ2FwaT8uaWZyYW1lcz8uSWZyYW1lKSB7XG4gICAgICAvLyBJZiBnYXBpLmlmcmFtZXMuSWZyYW1lIGF2YWlsYWJsZSwgcmVzb2x2ZS5cbiAgICAgIHJlc29sdmUoZ2FwaS5pZnJhbWVzLmdldENvbnRleHQoKSk7XG4gICAgfSBlbHNlIGlmICghIV93aW5kb3coKS5nYXBpPy5sb2FkKSB7XG4gICAgICAvLyBHYXBpIGxvYWRlciByZWFkeSwgbG9hZCBnYXBpLmlmcmFtZXMuXG4gICAgICBsb2FkR2FwaUlmcmFtZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDcmVhdGUgYSBuZXcgaWZyYW1lIGNhbGxiYWNrIHdoZW4gdGhpcyBpcyBjYWxsZWQgc28gYXMgbm90IHRvIG92ZXJ3cml0ZVxuICAgICAgLy8gYW55IHByZXZpb3VzIGRlZmluZWQgY2FsbGJhY2suIFRoaXMgaGFwcGVucyBpZiB0aGlzIG1ldGhvZCBpcyBjYWxsZWRcbiAgICAgIC8vIG11bHRpcGxlIHRpbWVzIGluIHBhcmFsbGVsIGFuZCBjb3VsZCByZXN1bHQgaW4gdGhlIGxhdGVyIGNhbGxiYWNrXG4gICAgICAvLyBvdmVyd3JpdGluZyB0aGUgcHJldmlvdXMgb25lLiBUaGlzIHdvdWxkIGVuZCB1cCB3aXRoIGEgaWZyYW1lXG4gICAgICAvLyB0aW1lb3V0LlxuICAgICAgY29uc3QgY2JOYW1lID0ganMuX2dlbmVyYXRlQ2FsbGJhY2tOYW1lKCdpZnJhbWVmY2InKTtcbiAgICAgIC8vIEdBcGkgbG9hZGVyIG5vdCBhdmFpbGFibGUsIGR5bmFtaWNhbGx5IGxvYWQgcGxhdGZvcm0uanMuXG4gICAgICBfd2luZG93KClbY2JOYW1lXSA9ICgpID0+IHtcbiAgICAgICAgLy8gR0FwaSBsb2FkZXIgc2hvdWxkIGJlIHJlYWR5LlxuICAgICAgICBpZiAoISFnYXBpLmxvYWQpIHtcbiAgICAgICAgICBsb2FkR2FwaUlmcmFtZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEdhcGkgbG9hZGVyIGZhaWxlZCwgdGhyb3cgZXJyb3IuXG4gICAgICAgICAgcmVqZWN0KF9jcmVhdGVFcnJvcihhdXRoLCBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRUQpKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIC8vIExvYWQgR0FwaSBsb2FkZXIuXG4gICAgICByZXR1cm4ganNcbiAgICAgICAgLl9sb2FkSlMoYGh0dHBzOi8vYXBpcy5nb29nbGUuY29tL2pzL2FwaS5qcz9vbmxvYWQ9JHtjYk5hbWV9YClcbiAgICAgICAgLmNhdGNoKGUgPT4gcmVqZWN0KGUpKTtcbiAgICB9XG4gIH0pLmNhdGNoKGVycm9yID0+IHtcbiAgICAvLyBSZXNldCBjYWNoZWQgcHJvbWlzZSB0byBhbGxvdyBmb3IgcmV0cmlhbC5cbiAgICBjYWNoZWRHQXBpTG9hZGVyID0gbnVsbDtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfSk7XG59XG5cbmxldCBjYWNoZWRHQXBpTG9hZGVyOiBQcm9taXNlPGdhcGkuaWZyYW1lcy5Db250ZXh0PiB8IG51bGwgPSBudWxsO1xuZXhwb3J0IGZ1bmN0aW9uIF9sb2FkR2FwaShhdXRoOiBBdXRoSW50ZXJuYWwpOiBQcm9taXNlPGdhcGkuaWZyYW1lcy5Db250ZXh0PiB7XG4gIGNhY2hlZEdBcGlMb2FkZXIgPSBjYWNoZWRHQXBpTG9hZGVyIHx8IGxvYWRHYXBpKGF1dGgpO1xuICByZXR1cm4gY2FjaGVkR0FwaUxvYWRlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9yZXNldExvYWRlcigpOiB2b2lkIHtcbiAgY2FjaGVkR0FwaUxvYWRlciA9IG51bGw7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFNES19WRVJTSU9OIH0gZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5pbXBvcnQgeyBxdWVyeXN0cmluZyB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IERlZmF1bHRDb25maWcgfSBmcm9tICcuLi8uLi8uLi9pbnRlcm5hbCc7XG5cbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi8uLi9jb3JlL2Vycm9ycyc7XG5pbXBvcnQgeyBfYXNzZXJ0LCBfY3JlYXRlRXJyb3IgfSBmcm9tICcuLi8uLi9jb3JlL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IERlbGF5IH0gZnJvbSAnLi4vLi4vY29yZS91dGlsL2RlbGF5JztcbmltcG9ydCB7IF9lbXVsYXRvclVybCB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9lbXVsYXRvcic7XG5pbXBvcnQgeyBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7IF93aW5kb3cgfSBmcm9tICcuLi9hdXRoX3dpbmRvdyc7XG5pbXBvcnQgKiBhcyBnYXBpTG9hZGVyIGZyb20gJy4vZ2FwaSc7XG5cbmNvbnN0IFBJTkdfVElNRU9VVCA9IG5ldyBEZWxheSg1MDAwLCAxNTAwMCk7XG5jb25zdCBJRlJBTUVfUEFUSCA9ICdfXy9hdXRoL2lmcmFtZSc7XG5jb25zdCBFTVVMQVRFRF9JRlJBTUVfUEFUSCA9ICdlbXVsYXRvci9hdXRoL2lmcmFtZSc7XG5cbmNvbnN0IElGUkFNRV9BVFRSSUJVVEVTID0ge1xuICBzdHlsZToge1xuICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgIHRvcDogJy0xMDBweCcsXG4gICAgd2lkdGg6ICcxcHgnLFxuICAgIGhlaWdodDogJzFweCdcbiAgfSxcbiAgJ2FyaWEtaGlkZGVuJzogJ3RydWUnLFxuICB0YWJpbmRleDogJy0xJ1xufTtcblxuLy8gTWFwIGZyb20gYXBpSG9zdCB0byBlbmRwb2ludCBJRCBmb3IgcGFzc2luZyBpbnRvIGlmcmFtZS4gSW4gY3VycmVudCBTREssIGFwaUhvc3QgY2FuIGJlIHNldCB0b1xuLy8gYW55dGhpbmcgKG5vdCBmcm9tIGEgbGlzdCBvZiBlbmRwb2ludHMgd2l0aCBJRHMgYXMgaW4gbGVnYWN5KSwgc28gdGhpcyBpcyB0aGUgY2xvc2VzdCB3ZSBjYW4gZ2V0LlxuY29uc3QgRUlEX0ZST01fQVBJSE9TVCA9IG5ldyBNYXAoW1xuICBbRGVmYXVsdENvbmZpZy5BUElfSE9TVCwgJ3AnXSwgLy8gcHJvZHVjdGlvblxuICBbJ3N0YWdpbmctaWRlbnRpdHl0b29sa2l0LnNhbmRib3guZ29vZ2xlYXBpcy5jb20nLCAncyddLCAvLyBzdGFnaW5nXG4gIFsndGVzdC1pZGVudGl0eXRvb2xraXQuc2FuZGJveC5nb29nbGVhcGlzLmNvbScsICd0J10gLy8gdGVzdFxuXSk7XG5cbmZ1bmN0aW9uIGdldElmcmFtZVVybChhdXRoOiBBdXRoSW50ZXJuYWwpOiBzdHJpbmcge1xuICBjb25zdCBjb25maWcgPSBhdXRoLmNvbmZpZztcbiAgX2Fzc2VydChjb25maWcuYXV0aERvbWFpbiwgYXV0aCwgQXV0aEVycm9yQ29kZS5NSVNTSU5HX0FVVEhfRE9NQUlOKTtcbiAgY29uc3QgdXJsID0gY29uZmlnLmVtdWxhdG9yXG4gICAgPyBfZW11bGF0b3JVcmwoY29uZmlnLCBFTVVMQVRFRF9JRlJBTUVfUEFUSClcbiAgICA6IGBodHRwczovLyR7YXV0aC5jb25maWcuYXV0aERvbWFpbn0vJHtJRlJBTUVfUEFUSH1gO1xuXG4gIGNvbnN0IHBhcmFtczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICBhcGlLZXk6IGNvbmZpZy5hcGlLZXksXG4gICAgYXBwTmFtZTogYXV0aC5uYW1lLFxuICAgIHY6IFNES19WRVJTSU9OXG4gIH07XG4gIGNvbnN0IGVpZCA9IEVJRF9GUk9NX0FQSUhPU1QuZ2V0KGF1dGguY29uZmlnLmFwaUhvc3QpO1xuICBpZiAoZWlkKSB7XG4gICAgcGFyYW1zLmVpZCA9IGVpZDtcbiAgfVxuICBjb25zdCBmcmFtZXdvcmtzID0gYXV0aC5fZ2V0RnJhbWV3b3JrcygpO1xuICBpZiAoZnJhbWV3b3Jrcy5sZW5ndGgpIHtcbiAgICBwYXJhbXMuZncgPSBmcmFtZXdvcmtzLmpvaW4oJywnKTtcbiAgfVxuICByZXR1cm4gYCR7dXJsfT8ke3F1ZXJ5c3RyaW5nKHBhcmFtcykuc2xpY2UoMSl9YDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIF9vcGVuSWZyYW1lKFxuICBhdXRoOiBBdXRoSW50ZXJuYWxcbik6IFByb21pc2U8Z2FwaS5pZnJhbWVzLklmcmFtZT4ge1xuICBjb25zdCBjb250ZXh0ID0gYXdhaXQgZ2FwaUxvYWRlci5fbG9hZEdhcGkoYXV0aCk7XG4gIGNvbnN0IGdhcGkgPSBfd2luZG93KCkuZ2FwaTtcbiAgX2Fzc2VydChnYXBpLCBhdXRoLCBBdXRoRXJyb3JDb2RlLklOVEVSTkFMX0VSUk9SKTtcbiAgcmV0dXJuIGNvbnRleHQub3BlbihcbiAgICB7XG4gICAgICB3aGVyZTogZG9jdW1lbnQuYm9keSxcbiAgICAgIHVybDogZ2V0SWZyYW1lVXJsKGF1dGgpLFxuICAgICAgbWVzc2FnZUhhbmRsZXJzRmlsdGVyOiBnYXBpLmlmcmFtZXMuQ1JPU1NfT1JJR0lOX0lGUkFNRVNfRklMVEVSLFxuICAgICAgYXR0cmlidXRlczogSUZSQU1FX0FUVFJJQlVURVMsXG4gICAgICBkb250Y2xlYXI6IHRydWVcbiAgICB9LFxuICAgIChpZnJhbWU6IGdhcGkuaWZyYW1lcy5JZnJhbWUpID0+XG4gICAgICBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGF3YWl0IGlmcmFtZS5yZXN0eWxlKHtcbiAgICAgICAgICAvLyBQcmV2ZW50IGlmcmFtZSBmcm9tIGNsb3Npbmcgb24gbW91c2Ugb3V0LlxuICAgICAgICAgIHNldEhpZGVPbkxlYXZlOiBmYWxzZVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBuZXR3b3JrRXJyb3IgPSBfY3JlYXRlRXJyb3IoXG4gICAgICAgICAgYXV0aCxcbiAgICAgICAgICBBdXRoRXJyb3JDb2RlLk5FVFdPUktfUkVRVUVTVF9GQUlMRURcbiAgICAgICAgKTtcbiAgICAgICAgLy8gQ29uZmlybSBpZnJhbWUgaXMgY29ycmVjdGx5IGxvYWRlZC5cbiAgICAgICAgLy8gVG8gZmFsbGJhY2sgb24gZmFpbHVyZSwgc2V0IGEgdGltZW91dC5cbiAgICAgICAgY29uc3QgbmV0d29ya0Vycm9yVGltZXIgPSBfd2luZG93KCkuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgcmVqZWN0KG5ldHdvcmtFcnJvcik7XG4gICAgICAgIH0sIFBJTkdfVElNRU9VVC5nZXQoKSk7XG4gICAgICAgIC8vIENsZWFyIHRpbWVyIGFuZCByZXNvbHZlIHBlbmRpbmcgaWZyYW1lIHJlYWR5IHByb21pc2UuXG4gICAgICAgIGZ1bmN0aW9uIGNsZWFyVGltZXJBbmRSZXNvbHZlKCk6IHZvaWQge1xuICAgICAgICAgIF93aW5kb3coKS5jbGVhclRpbWVvdXQobmV0d29ya0Vycm9yVGltZXIpO1xuICAgICAgICAgIHJlc29sdmUoaWZyYW1lKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGlzIHJldHVybnMgYW4gSVRoZW5hYmxlLiBIb3dldmVyIHRoZSByZWplY3QgcGFydCBkb2VzIG5vdCBjYWxsXG4gICAgICAgIC8vIHdoZW4gdGhlIGlmcmFtZSBpcyBub3QgbG9hZGVkLlxuICAgICAgICBpZnJhbWUucGluZyhjbGVhclRpbWVyQW5kUmVzb2x2ZSkudGhlbihjbGVhclRpbWVyQW5kUmVzb2x2ZSwgKCkgPT4ge1xuICAgICAgICAgIHJlamVjdChuZXR3b3JrRXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICk7XG59XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQy5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGdldFVBIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9lcnJvcnMnO1xuaW1wb3J0IHsgX2Fzc2VydCB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHtcbiAgX2lzQ2hyb21lSU9TLFxuICBfaXNGaXJlZm94LFxuICBfaXNJT1NTdGFuZGFsb25lXG59IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9icm93c2VyJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uLy4uL21vZGVsL2F1dGgnO1xuXG5jb25zdCBCQVNFX1BPUFVQX09QVElPTlMgPSB7XG4gIGxvY2F0aW9uOiAneWVzJyxcbiAgcmVzaXphYmxlOiAneWVzJyxcbiAgc3RhdHVzYmFyOiAneWVzJyxcbiAgdG9vbGJhcjogJ25vJ1xufTtcblxuY29uc3QgREVGQVVMVF9XSURUSCA9IDUwMDtcbmNvbnN0IERFRkFVTFRfSEVJR0hUID0gNjAwO1xuY29uc3QgVEFSR0VUX0JMQU5LID0gJ19ibGFuayc7XG5cbmNvbnN0IEZJUkVGT1hfRU1QVFlfVVJMID0gJ2h0dHA6Ly9sb2NhbGhvc3QnO1xuXG5leHBvcnQgY2xhc3MgQXV0aFBvcHVwIHtcbiAgYXNzb2NpYXRlZEV2ZW50OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihyZWFkb25seSB3aW5kb3c6IFdpbmRvdyB8IG51bGwpIHt9XG5cbiAgY2xvc2UoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMud2luZG93KSB7XG4gICAgICB0cnkge1xuICAgICAgICB0aGlzLndpbmRvdy5jbG9zZSgpO1xuICAgICAgfSBjYXRjaCAoZSkge31cbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9vcGVuKFxuICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gIHVybD86IHN0cmluZyxcbiAgbmFtZT86IHN0cmluZyxcbiAgd2lkdGggPSBERUZBVUxUX1dJRFRILFxuICBoZWlnaHQgPSBERUZBVUxUX0hFSUdIVFxuKTogQXV0aFBvcHVwIHtcbiAgY29uc3QgdG9wID0gTWF0aC5tYXgoKHdpbmRvdy5zY3JlZW4uYXZhaWxIZWlnaHQgLSBoZWlnaHQpIC8gMiwgMCkudG9TdHJpbmcoKTtcbiAgY29uc3QgbGVmdCA9IE1hdGgubWF4KCh3aW5kb3cuc2NyZWVuLmF2YWlsV2lkdGggLSB3aWR0aCkgLyAyLCAwKS50b1N0cmluZygpO1xuICBsZXQgdGFyZ2V0ID0gJyc7XG5cbiAgY29uc3Qgb3B0aW9uczogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgICAuLi5CQVNFX1BPUFVQX09QVElPTlMsXG4gICAgd2lkdGg6IHdpZHRoLnRvU3RyaW5nKCksXG4gICAgaGVpZ2h0OiBoZWlnaHQudG9TdHJpbmcoKSxcbiAgICB0b3AsXG4gICAgbGVmdFxuICB9O1xuXG4gIC8vIENocm9tZSBpT1MgNyBhbmQgOCBpcyByZXR1cm5pbmcgYW4gdW5kZWZpbmVkIHBvcHVwIHdpbiB3aGVuIHRhcmdldCBpc1xuICAvLyBzcGVjaWZpZWQsIGV2ZW4gdGhvdWdoIHRoZSBwb3B1cCBpcyBub3QgbmVjZXNzYXJpbHkgYmxvY2tlZC5cbiAgY29uc3QgdWEgPSBnZXRVQSgpLnRvTG93ZXJDYXNlKCk7XG5cbiAgaWYgKG5hbWUpIHtcbiAgICB0YXJnZXQgPSBfaXNDaHJvbWVJT1ModWEpID8gVEFSR0VUX0JMQU5LIDogbmFtZTtcbiAgfVxuXG4gIGlmIChfaXNGaXJlZm94KHVhKSkge1xuICAgIC8vIEZpcmVmb3ggY29tcGxhaW5zIHdoZW4gaW52YWxpZCBVUkxzIGFyZSBwb3BwZWQgb3V0LiBIYWNreSB3YXkgdG8gYnlwYXNzLlxuICAgIHVybCA9IHVybCB8fCBGSVJFRk9YX0VNUFRZX1VSTDtcbiAgICAvLyBGaXJlZm94IGRpc2FibGVzIGJ5IGRlZmF1bHQgc2Nyb2xsaW5nIG9uIHBvcHVwIHdpbmRvd3MsIHdoaWNoIGNhbiBjcmVhdGVcbiAgICAvLyBpc3N1ZXMgd2hlbiB0aGUgdXNlciBoYXMgbWFueSBHb29nbGUgYWNjb3VudHMsIGZvciBpbnN0YW5jZS5cbiAgICBvcHRpb25zLnNjcm9sbGJhcnMgPSAneWVzJztcbiAgfVxuXG4gIGNvbnN0IG9wdGlvbnNTdHJpbmcgPSBPYmplY3QuZW50cmllcyhvcHRpb25zKS5yZWR1Y2UoXG4gICAgKGFjY3VtLCBba2V5LCB2YWx1ZV0pID0+IGAke2FjY3VtfSR7a2V5fT0ke3ZhbHVlfSxgLFxuICAgICcnXG4gICk7XG5cbiAgaWYgKF9pc0lPU1N0YW5kYWxvbmUodWEpICYmIHRhcmdldCAhPT0gJ19zZWxmJykge1xuICAgIG9wZW5Bc05ld1dpbmRvd0lPUyh1cmwgfHwgJycsIHRhcmdldCk7XG4gICAgcmV0dXJuIG5ldyBBdXRoUG9wdXAobnVsbCk7XG4gIH1cblxuICAvLyBhYm91dDpibGFuayBnZXR0aW5nIHNhbml0aXplZCBjYXVzaW5nIGJyb3dzZXJzIGxpa2UgSUUvRWRnZSB0byBkaXNwbGF5XG4gIC8vIGJyaWVmIGVycm9yIG1lc3NhZ2UgYmVmb3JlIHJlZGlyZWN0aW5nIHRvIGhhbmRsZXIuXG4gIGNvbnN0IG5ld1dpbiA9IHdpbmRvdy5vcGVuKHVybCB8fCAnJywgdGFyZ2V0LCBvcHRpb25zU3RyaW5nKTtcbiAgX2Fzc2VydChuZXdXaW4sIGF1dGgsIEF1dGhFcnJvckNvZGUuUE9QVVBfQkxPQ0tFRCk7XG5cbiAgLy8gRmxha3kgb24gSUUgZWRnZSwgZW5jYXBzdWxhdGUgd2l0aCBhIHRyeSBhbmQgY2F0Y2guXG4gIHRyeSB7XG4gICAgbmV3V2luLmZvY3VzKCk7XG4gIH0gY2F0Y2ggKGUpIHt9XG5cbiAgcmV0dXJuIG5ldyBBdXRoUG9wdXAobmV3V2luKTtcbn1cblxuZnVuY3Rpb24gb3BlbkFzTmV3V2luZG93SU9TKHVybDogc3RyaW5nLCB0YXJnZXQ6IHN0cmluZyk6IHZvaWQge1xuICBjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgZWwuaHJlZiA9IHVybDtcbiAgZWwudGFyZ2V0ID0gdGFyZ2V0O1xuICBjb25zdCBjbGljayA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50Jyk7XG4gIGNsaWNrLmluaXRNb3VzZUV2ZW50KFxuICAgICdjbGljaycsXG4gICAgdHJ1ZSxcbiAgICB0cnVlLFxuICAgIHdpbmRvdyxcbiAgICAxLFxuICAgIDAsXG4gICAgMCxcbiAgICAwLFxuICAgIDAsXG4gICAgZmFsc2UsXG4gICAgZmFsc2UsXG4gICAgZmFsc2UsXG4gICAgZmFsc2UsXG4gICAgMSxcbiAgICBudWxsXG4gICk7XG4gIGVsLmRpc3BhdGNoRXZlbnQoY2xpY2spO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFNES19WRVJTSU9OIH0gZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5pbXBvcnQgeyBBdXRoUHJvdmlkZXIgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgQXBpS2V5LCBBcHBOYW1lLCBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7IEF1dGhFdmVudFR5cGUgfSBmcm9tICcuLi8uLi9tb2RlbC9wb3B1cF9yZWRpcmVjdCc7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcbmltcG9ydCB7IF9hc3NlcnQgfSBmcm9tICcuL2Fzc2VydCc7XG5pbXBvcnQgeyBpc0VtcHR5LCBxdWVyeXN0cmluZyB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IF9lbXVsYXRvclVybCB9IGZyb20gJy4vZW11bGF0b3InO1xuaW1wb3J0IHsgRmVkZXJhdGVkQXV0aFByb3ZpZGVyIH0gZnJvbSAnLi4vcHJvdmlkZXJzL2ZlZGVyYXRlZCc7XG5pbXBvcnQgeyBCYXNlT0F1dGhQcm92aWRlciB9IGZyb20gJy4uL3Byb3ZpZGVycy9vYXV0aCc7XG5cbi8qKlxuICogVVJMIGZvciBBdXRoZW50aWNhdGlvbiB3aWRnZXQgd2hpY2ggd2lsbCBpbml0aWF0ZSB0aGUgT0F1dGggaGFuZHNoYWtlXG4gKlxuICogQGludGVybmFsXG4gKi9cbmNvbnN0IFdJREdFVF9QQVRIID0gJ19fL2F1dGgvaGFuZGxlcic7XG5cbi8qKlxuICogVVJMIGZvciBlbXVsYXRlZCBlbnZpcm9ubWVudFxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5jb25zdCBFTVVMQVRPUl9XSURHRVRfUEFUSCA9ICdlbXVsYXRvci9hdXRoL2hhbmRsZXInO1xuXG4vKipcbiAqIEZyYWdtZW50IG5hbWUgZm9yIHRoZSBBcHAgQ2hlY2sgdG9rZW4gdGhhdCBnZXRzIHBhc3NlZCB0byB0aGUgd2lkZ2V0XG4gKlxuICogQGludGVybmFsXG4gKi9cbmNvbnN0IEZJUkVCQVNFX0FQUF9DSEVDS19GUkFHTUVOVF9JRCA9IGVuY29kZVVSSUNvbXBvbmVudCgnZmFjJyk7XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvY29uc2lzdGVudC10eXBlLWRlZmluaXRpb25zXG50eXBlIFdpZGdldFBhcmFtcyA9IHtcbiAgYXBpS2V5OiBBcGlLZXk7XG4gIGFwcE5hbWU6IEFwcE5hbWU7XG4gIGF1dGhUeXBlOiBBdXRoRXZlbnRUeXBlO1xuICByZWRpcmVjdFVybD86IHN0cmluZztcbiAgdjogc3RyaW5nO1xuICBwcm92aWRlcklkPzogc3RyaW5nO1xuICBzY29wZXM/OiBzdHJpbmc7XG4gIGN1c3RvbVBhcmFtZXRlcnM/OiBzdHJpbmc7XG4gIGV2ZW50SWQ/OiBzdHJpbmc7XG4gIHRpZD86IHN0cmluZztcbn0gJiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB8IHVuZGVmaW5lZCB9O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX2dldFJlZGlyZWN0VXJsKFxuICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gIHByb3ZpZGVyOiBBdXRoUHJvdmlkZXIsXG4gIGF1dGhUeXBlOiBBdXRoRXZlbnRUeXBlLFxuICByZWRpcmVjdFVybD86IHN0cmluZyxcbiAgZXZlbnRJZD86IHN0cmluZyxcbiAgYWRkaXRpb25hbFBhcmFtcz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIF9hc3NlcnQoYXV0aC5jb25maWcuYXV0aERvbWFpbiwgYXV0aCwgQXV0aEVycm9yQ29kZS5NSVNTSU5HX0FVVEhfRE9NQUlOKTtcbiAgX2Fzc2VydChhdXRoLmNvbmZpZy5hcGlLZXksIGF1dGgsIEF1dGhFcnJvckNvZGUuSU5WQUxJRF9BUElfS0VZKTtcblxuICBjb25zdCBwYXJhbXM6IFdpZGdldFBhcmFtcyA9IHtcbiAgICBhcGlLZXk6IGF1dGguY29uZmlnLmFwaUtleSxcbiAgICBhcHBOYW1lOiBhdXRoLm5hbWUsXG4gICAgYXV0aFR5cGUsXG4gICAgcmVkaXJlY3RVcmwsXG4gICAgdjogU0RLX1ZFUlNJT04sXG4gICAgZXZlbnRJZFxuICB9O1xuXG4gIGlmIChwcm92aWRlciBpbnN0YW5jZW9mIEZlZGVyYXRlZEF1dGhQcm92aWRlcikge1xuICAgIHByb3ZpZGVyLnNldERlZmF1bHRMYW5ndWFnZShhdXRoLmxhbmd1YWdlQ29kZSk7XG4gICAgcGFyYW1zLnByb3ZpZGVySWQgPSBwcm92aWRlci5wcm92aWRlcklkIHx8ICcnO1xuICAgIGlmICghaXNFbXB0eShwcm92aWRlci5nZXRDdXN0b21QYXJhbWV0ZXJzKCkpKSB7XG4gICAgICBwYXJhbXMuY3VzdG9tUGFyYW1ldGVycyA9IEpTT04uc3RyaW5naWZ5KHByb3ZpZGVyLmdldEN1c3RvbVBhcmFtZXRlcnMoKSk7XG4gICAgfVxuXG4gICAgLy8gVE9ETyBzZXQgYWRkaXRpb25hbFBhcmFtcyBmcm9tIHRoZSBwcm92aWRlciBhcyB3ZWxsP1xuICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGFkZGl0aW9uYWxQYXJhbXMgfHwge30pKSB7XG4gICAgICBwYXJhbXNba2V5XSA9IHZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChwcm92aWRlciBpbnN0YW5jZW9mIEJhc2VPQXV0aFByb3ZpZGVyKSB7XG4gICAgY29uc3Qgc2NvcGVzID0gcHJvdmlkZXIuZ2V0U2NvcGVzKCkuZmlsdGVyKHNjb3BlID0+IHNjb3BlICE9PSAnJyk7XG4gICAgaWYgKHNjb3Blcy5sZW5ndGggPiAwKSB7XG4gICAgICBwYXJhbXMuc2NvcGVzID0gc2NvcGVzLmpvaW4oJywnKTtcbiAgICB9XG4gIH1cblxuICBpZiAoYXV0aC50ZW5hbnRJZCkge1xuICAgIHBhcmFtcy50aWQgPSBhdXRoLnRlbmFudElkO1xuICB9XG5cbiAgLy8gVE9ETzogbWF5YmUgc2V0IGVpZCBhcyBlbmRpcG9pbnRJZFxuICAvLyBUT0RPOiBtYXliZSBzZXQgZncgYXMgRnJhbWV3b3Jrcy5qb2luKFwiLFwiKVxuXG4gIGNvbnN0IHBhcmFtc0RpY3QgPSBwYXJhbXMgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgbnVtYmVyPjtcbiAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMocGFyYW1zRGljdCkpIHtcbiAgICBpZiAocGFyYW1zRGljdFtrZXldID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGRlbGV0ZSBwYXJhbXNEaWN0W2tleV07XG4gICAgfVxuICB9XG5cbiAgLy8gU2V0cyB0aGUgQXBwIENoZWNrIHRva2VuIHRvIHBhc3MgdG8gdGhlIHdpZGdldFxuICBjb25zdCBhcHBDaGVja1Rva2VuID0gYXdhaXQgYXV0aC5fZ2V0QXBwQ2hlY2tUb2tlbigpO1xuICBjb25zdCBhcHBDaGVja1Rva2VuRnJhZ21lbnQgPSBhcHBDaGVja1Rva2VuXG4gICAgPyBgIyR7RklSRUJBU0VfQVBQX0NIRUNLX0ZSQUdNRU5UX0lEfT0ke2VuY29kZVVSSUNvbXBvbmVudChhcHBDaGVja1Rva2VuKX1gXG4gICAgOiAnJztcblxuICAvLyBTdGFydCBhdCBpbmRleCAxIHRvIHNraXAgdGhlIGxlYWRpbmcgJyYnIGluIHRoZSBxdWVyeSBzdHJpbmdcbiAgcmV0dXJuIGAke2dldEhhbmRsZXJCYXNlKGF1dGgpfT8ke3F1ZXJ5c3RyaW5nKHBhcmFtc0RpY3QpLnNsaWNlKFxuICAgIDFcbiAgKX0ke2FwcENoZWNrVG9rZW5GcmFnbWVudH1gO1xufVxuXG5mdW5jdGlvbiBnZXRIYW5kbGVyQmFzZSh7IGNvbmZpZyB9OiBBdXRoSW50ZXJuYWwpOiBzdHJpbmcge1xuICBpZiAoIWNvbmZpZy5lbXVsYXRvcikge1xuICAgIHJldHVybiBgaHR0cHM6Ly8ke2NvbmZpZy5hdXRoRG9tYWlufS8ke1dJREdFVF9QQVRIfWA7XG4gIH1cblxuICByZXR1cm4gX2VtdWxhdG9yVXJsKGNvbmZpZywgRU1VTEFUT1JfV0lER0VUX1BBVEgpO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEF1dGhQcm92aWRlciwgUG9wdXBSZWRpcmVjdFJlc29sdmVyIH0gZnJvbSAnLi4vbW9kZWwvcHVibGljX3R5cGVzJztcblxuaW1wb3J0IHsgQXV0aEV2ZW50TWFuYWdlciB9IGZyb20gJy4uL2NvcmUvYXV0aC9hdXRoX2V2ZW50X21hbmFnZXInO1xuaW1wb3J0IHsgQXV0aEVycm9yQ29kZSB9IGZyb20gJy4uL2NvcmUvZXJyb3JzJztcbmltcG9ydCB7IF9hc3NlcnQsIGRlYnVnQXNzZXJ0LCBfZmFpbCB9IGZyb20gJy4uL2NvcmUvdXRpbC9hc3NlcnQnO1xuaW1wb3J0IHsgX2dlbmVyYXRlRXZlbnRJZCB9IGZyb20gJy4uL2NvcmUvdXRpbC9ldmVudF9pZCc7XG5pbXBvcnQgeyBfZ2V0Q3VycmVudFVybCB9IGZyb20gJy4uL2NvcmUvdXRpbC9sb2NhdGlvbic7XG5pbXBvcnQgeyBfdmFsaWRhdGVPcmlnaW4gfSBmcm9tICcuLi9jb3JlL3V0aWwvdmFsaWRhdGVfb3JpZ2luJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uL21vZGVsL2F1dGgnO1xuaW1wb3J0IHtcbiAgQXV0aEV2ZW50VHlwZSxcbiAgRXZlbnRNYW5hZ2VyLFxuICBHYXBpQXV0aEV2ZW50LFxuICBHYXBpT3V0Y29tZSxcbiAgUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWxcbn0gZnJvbSAnLi4vbW9kZWwvcG9wdXBfcmVkaXJlY3QnO1xuaW1wb3J0IHsgX3NldFdpbmRvd0xvY2F0aW9uIH0gZnJvbSAnLi9hdXRoX3dpbmRvdyc7XG5pbXBvcnQgeyBfb3BlbklmcmFtZSB9IGZyb20gJy4vaWZyYW1lL2lmcmFtZSc7XG5pbXBvcnQgeyBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlIH0gZnJvbSAnLi9wZXJzaXN0ZW5jZS9zZXNzaW9uX3N0b3JhZ2UnO1xuaW1wb3J0IHsgX29wZW4sIEF1dGhQb3B1cCB9IGZyb20gJy4vdXRpbC9wb3B1cCc7XG5pbXBvcnQgeyBfZ2V0UmVkaXJlY3RSZXN1bHQgfSBmcm9tICcuL3N0cmF0ZWdpZXMvcmVkaXJlY3QnO1xuaW1wb3J0IHsgX2dldFJlZGlyZWN0VXJsIH0gZnJvbSAnLi4vY29yZS91dGlsL2hhbmRsZXInO1xuaW1wb3J0IHsgX2lzSU9TLCBfaXNNb2JpbGVCcm93c2VyLCBfaXNTYWZhcmkgfSBmcm9tICcuLi9jb3JlL3V0aWwvYnJvd3Nlcic7XG5pbXBvcnQgeyBfb3ZlcnJpZGVSZWRpcmVjdFJlc3VsdCB9IGZyb20gJy4uL2NvcmUvc3RyYXRlZ2llcy9yZWRpcmVjdCc7XG5cbi8qKlxuICogVGhlIHNwZWNpYWwgd2ViIHN0b3JhZ2UgZXZlbnRcbiAqXG4gKi9cbmNvbnN0IFdFQl9TVE9SQUdFX1NVUFBPUlRfS0VZID0gJ3dlYlN0b3JhZ2VTdXBwb3J0JztcblxuaW50ZXJmYWNlIFdlYlN0b3JhZ2VTdXBwb3J0TWVzc2FnZSBleHRlbmRzIGdhcGkuaWZyYW1lcy5NZXNzYWdlIHtcbiAgW2luZGV4OiBudW1iZXJdOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPjtcbn1cblxuaW50ZXJmYWNlIE1hbmFnZXJPclByb21pc2Uge1xuICBtYW5hZ2VyPzogRXZlbnRNYW5hZ2VyO1xuICBwcm9taXNlPzogUHJvbWlzZTxFdmVudE1hbmFnZXI+O1xufVxuXG5jbGFzcyBCcm93c2VyUG9wdXBSZWRpcmVjdFJlc29sdmVyIGltcGxlbWVudHMgUG9wdXBSZWRpcmVjdFJlc29sdmVySW50ZXJuYWwge1xuICBwcml2YXRlIHJlYWRvbmx5IGV2ZW50TWFuYWdlcnM6IFJlY29yZDxzdHJpbmcsIE1hbmFnZXJPclByb21pc2U+ID0ge307XG4gIHByaXZhdGUgcmVhZG9ubHkgaWZyYW1lczogUmVjb3JkPHN0cmluZywgZ2FwaS5pZnJhbWVzLklmcmFtZT4gPSB7fTtcbiAgcHJpdmF0ZSByZWFkb25seSBvcmlnaW5WYWxpZGF0aW9uUHJvbWlzZXM6IFJlY29yZDxzdHJpbmcsIFByb21pc2U8dm9pZD4+ID0ge307XG5cbiAgcmVhZG9ubHkgX3JlZGlyZWN0UGVyc2lzdGVuY2UgPSBicm93c2VyU2Vzc2lvblBlcnNpc3RlbmNlO1xuXG4gIC8vIFdyYXBwaW5nIGluIGFzeW5jIGV2ZW4gdGhvdWdoIHdlIGRvbid0IGF3YWl0IGFueXdoZXJlIGluIG9yZGVyXG4gIC8vIHRvIG1ha2Ugc3VyZSBlcnJvcnMgYXJlIHJhaXNlZCBhcyBwcm9taXNlIHJlamVjdGlvbnNcbiAgYXN5bmMgX29wZW5Qb3B1cChcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgcHJvdmlkZXI6IEF1dGhQcm92aWRlcixcbiAgICBhdXRoVHlwZTogQXV0aEV2ZW50VHlwZSxcbiAgICBldmVudElkPzogc3RyaW5nXG4gICk6IFByb21pc2U8QXV0aFBvcHVwPiB7XG4gICAgZGVidWdBc3NlcnQoXG4gICAgICB0aGlzLmV2ZW50TWFuYWdlcnNbYXV0aC5fa2V5KCldPy5tYW5hZ2VyLFxuICAgICAgJ19pbml0aWFsaXplKCkgbm90IGNhbGxlZCBiZWZvcmUgX29wZW5Qb3B1cCgpJ1xuICAgICk7XG5cbiAgICBjb25zdCB1cmwgPSBhd2FpdCBfZ2V0UmVkaXJlY3RVcmwoXG4gICAgICBhdXRoLFxuICAgICAgcHJvdmlkZXIsXG4gICAgICBhdXRoVHlwZSxcbiAgICAgIF9nZXRDdXJyZW50VXJsKCksXG4gICAgICBldmVudElkXG4gICAgKTtcbiAgICByZXR1cm4gX29wZW4oYXV0aCwgdXJsLCBfZ2VuZXJhdGVFdmVudElkKCkpO1xuICB9XG5cbiAgYXN5bmMgX29wZW5SZWRpcmVjdChcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgcHJvdmlkZXI6IEF1dGhQcm92aWRlcixcbiAgICBhdXRoVHlwZTogQXV0aEV2ZW50VHlwZSxcbiAgICBldmVudElkPzogc3RyaW5nXG4gICk6IFByb21pc2U8bmV2ZXI+IHtcbiAgICBhd2FpdCB0aGlzLl9vcmlnaW5WYWxpZGF0aW9uKGF1dGgpO1xuICAgIGNvbnN0IHVybCA9IGF3YWl0IF9nZXRSZWRpcmVjdFVybChcbiAgICAgIGF1dGgsXG4gICAgICBwcm92aWRlcixcbiAgICAgIGF1dGhUeXBlLFxuICAgICAgX2dldEN1cnJlbnRVcmwoKSxcbiAgICAgIGV2ZW50SWRcbiAgICApO1xuICAgIF9zZXRXaW5kb3dMb2NhdGlvbih1cmwpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgoKSA9PiB7fSk7XG4gIH1cblxuICBfaW5pdGlhbGl6ZShhdXRoOiBBdXRoSW50ZXJuYWwpOiBQcm9taXNlPEV2ZW50TWFuYWdlcj4ge1xuICAgIGNvbnN0IGtleSA9IGF1dGguX2tleSgpO1xuICAgIGlmICh0aGlzLmV2ZW50TWFuYWdlcnNba2V5XSkge1xuICAgICAgY29uc3QgeyBtYW5hZ2VyLCBwcm9taXNlIH0gPSB0aGlzLmV2ZW50TWFuYWdlcnNba2V5XTtcbiAgICAgIGlmIChtYW5hZ2VyKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobWFuYWdlcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZWJ1Z0Fzc2VydChwcm9taXNlLCAnSWYgbWFuYWdlciBpcyBub3Qgc2V0LCBwcm9taXNlIHNob3VsZCBiZScpO1xuICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBwcm9taXNlID0gdGhpcy5pbml0QW5kR2V0TWFuYWdlcihhdXRoKTtcbiAgICB0aGlzLmV2ZW50TWFuYWdlcnNba2V5XSA9IHsgcHJvbWlzZSB9O1xuXG4gICAgLy8gSWYgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQsIHRoZSBrZXkgc2hvdWxkIGJlIHJlbW92ZWQgc28gdGhhdCB0aGVcbiAgICAvLyBvcGVyYXRpb24gY2FuIGJlIHJldHJpZWQgbGF0ZXIuXG4gICAgcHJvbWlzZS5jYXRjaCgoKSA9PiB7XG4gICAgICBkZWxldGUgdGhpcy5ldmVudE1hbmFnZXJzW2tleV07XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcHJvbWlzZTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaW5pdEFuZEdldE1hbmFnZXIoYXV0aDogQXV0aEludGVybmFsKTogUHJvbWlzZTxFdmVudE1hbmFnZXI+IHtcbiAgICBjb25zdCBpZnJhbWUgPSBhd2FpdCBfb3BlbklmcmFtZShhdXRoKTtcbiAgICBjb25zdCBtYW5hZ2VyID0gbmV3IEF1dGhFdmVudE1hbmFnZXIoYXV0aCk7XG4gICAgaWZyYW1lLnJlZ2lzdGVyPEdhcGlBdXRoRXZlbnQ+KFxuICAgICAgJ2F1dGhFdmVudCcsXG4gICAgICAoaWZyYW1lRXZlbnQ6IEdhcGlBdXRoRXZlbnQgfCBudWxsKSA9PiB7XG4gICAgICAgIF9hc3NlcnQoaWZyYW1lRXZlbnQ/LmF1dGhFdmVudCwgYXV0aCwgQXV0aEVycm9yQ29kZS5JTlZBTElEX0FVVEhfRVZFTlQpO1xuICAgICAgICAvLyBUT0RPOiBDb25zaWRlciBzcGxpdHRpbmcgcmVkaXJlY3QgYW5kIHBvcHVwIGV2ZW50cyBlYXJsaWVyIG9uXG5cbiAgICAgICAgY29uc3QgaGFuZGxlZCA9IG1hbmFnZXIub25FdmVudChpZnJhbWVFdmVudC5hdXRoRXZlbnQpO1xuICAgICAgICByZXR1cm4geyBzdGF0dXM6IGhhbmRsZWQgPyBHYXBpT3V0Y29tZS5BQ0sgOiBHYXBpT3V0Y29tZS5FUlJPUiB9O1xuICAgICAgfSxcbiAgICAgIGdhcGkuaWZyYW1lcy5DUk9TU19PUklHSU5fSUZSQU1FU19GSUxURVJcbiAgICApO1xuXG4gICAgdGhpcy5ldmVudE1hbmFnZXJzW2F1dGguX2tleSgpXSA9IHsgbWFuYWdlciB9O1xuICAgIHRoaXMuaWZyYW1lc1thdXRoLl9rZXkoKV0gPSBpZnJhbWU7XG4gICAgcmV0dXJuIG1hbmFnZXI7XG4gIH1cblxuICBfaXNJZnJhbWVXZWJTdG9yYWdlU3VwcG9ydGVkKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBjYjogKHN1cHBvcnRlZDogYm9vbGVhbikgPT4gdW5rbm93blxuICApOiB2b2lkIHtcbiAgICBjb25zdCBpZnJhbWUgPSB0aGlzLmlmcmFtZXNbYXV0aC5fa2V5KCldO1xuICAgIGlmcmFtZS5zZW5kPGdhcGkuaWZyYW1lcy5NZXNzYWdlLCBXZWJTdG9yYWdlU3VwcG9ydE1lc3NhZ2U+KFxuICAgICAgV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVksXG4gICAgICB7IHR5cGU6IFdFQl9TVE9SQUdFX1NVUFBPUlRfS0VZIH0sXG4gICAgICByZXN1bHQgPT4ge1xuICAgICAgICBjb25zdCBpc1N1cHBvcnRlZCA9IHJlc3VsdD8uWzBdPy5bV0VCX1NUT1JBR0VfU1VQUE9SVF9LRVldO1xuICAgICAgICBpZiAoaXNTdXBwb3J0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNiKCEhaXNTdXBwb3J0ZWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgX2ZhaWwoYXV0aCwgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUik7XG4gICAgICB9LFxuICAgICAgZ2FwaS5pZnJhbWVzLkNST1NTX09SSUdJTl9JRlJBTUVTX0ZJTFRFUlxuICAgICk7XG4gIH1cblxuICBfb3JpZ2luVmFsaWRhdGlvbihhdXRoOiBBdXRoSW50ZXJuYWwpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBrZXkgPSBhdXRoLl9rZXkoKTtcbiAgICBpZiAoIXRoaXMub3JpZ2luVmFsaWRhdGlvblByb21pc2VzW2tleV0pIHtcbiAgICAgIHRoaXMub3JpZ2luVmFsaWRhdGlvblByb21pc2VzW2tleV0gPSBfdmFsaWRhdGVPcmlnaW4oYXV0aCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMub3JpZ2luVmFsaWRhdGlvblByb21pc2VzW2tleV07XG4gIH1cblxuICBnZXQgX3Nob3VsZEluaXRQcm9hY3RpdmVseSgpOiBib29sZWFuIHtcbiAgICAvLyBNb2JpbGUgYnJvd3NlcnMgYW5kIFNhZmFyaSBuZWVkIHRvIG9wdGltaXN0aWNhbGx5IGluaXRpYWxpemVcbiAgICByZXR1cm4gX2lzTW9iaWxlQnJvd3NlcigpIHx8IF9pc1NhZmFyaSgpIHx8IF9pc0lPUygpO1xuICB9XG5cbiAgX2NvbXBsZXRlUmVkaXJlY3RGbiA9IF9nZXRSZWRpcmVjdFJlc3VsdDtcblxuICBfb3ZlcnJpZGVSZWRpcmVjdFJlc3VsdCA9IF9vdmVycmlkZVJlZGlyZWN0UmVzdWx0O1xufVxuXG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBQb3B1cFJlZGlyZWN0UmVzb2x2ZXJ9IHN1aXRhYmxlIGZvciBicm93c2VyXG4gKiBiYXNlZCBhcHBsaWNhdGlvbnMuXG4gKlxuICogQHJlbWFya3NcbiAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNvbnN0IGJyb3dzZXJQb3B1cFJlZGlyZWN0UmVzb2x2ZXI6IFBvcHVwUmVkaXJlY3RSZXNvbHZlciA9XG4gIEJyb3dzZXJQb3B1cFJlZGlyZWN0UmVzb2x2ZXI7XG4iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmltcG9ydCB7IEZhY3RvcklkLCBNdWx0aUZhY3RvckFzc2VydGlvbiB9IGZyb20gJy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQgeyBkZWJ1Z0ZhaWwgfSBmcm9tICcuLi9jb3JlL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IE11bHRpRmFjdG9yU2Vzc2lvbkltcGwsIE11bHRpRmFjdG9yU2Vzc2lvblR5cGUgfSBmcm9tICcuL21mYV9zZXNzaW9uJztcbmltcG9ydCB7IEZpbmFsaXplTWZhUmVzcG9uc2UgfSBmcm9tICcuLi9hcGkvYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IEF1dGhJbnRlcm5hbCB9IGZyb20gJy4uL21vZGVsL2F1dGgnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsIGltcGxlbWVudHMgTXVsdGlGYWN0b3JBc3NlcnRpb24ge1xuICBwcm90ZWN0ZWQgY29uc3RydWN0b3IocmVhZG9ubHkgZmFjdG9ySWQ6IEZhY3RvcklkKSB7fVxuXG4gIF9wcm9jZXNzKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBzZXNzaW9uOiBNdWx0aUZhY3RvclNlc3Npb25JbXBsLFxuICAgIGRpc3BsYXlOYW1lPzogc3RyaW5nIHwgbnVsbFxuICApOiBQcm9taXNlPEZpbmFsaXplTWZhUmVzcG9uc2U+IHtcbiAgICBzd2l0Y2ggKHNlc3Npb24udHlwZSkge1xuICAgICAgY2FzZSBNdWx0aUZhY3RvclNlc3Npb25UeXBlLkVOUk9MTDpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbmFsaXplRW5yb2xsKGF1dGgsIHNlc3Npb24uY3JlZGVudGlhbCwgZGlzcGxheU5hbWUpO1xuICAgICAgY2FzZSBNdWx0aUZhY3RvclNlc3Npb25UeXBlLlNJR05fSU46XG4gICAgICAgIHJldHVybiB0aGlzLl9maW5hbGl6ZVNpZ25JbihhdXRoLCBzZXNzaW9uLmNyZWRlbnRpYWwpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIGRlYnVnRmFpbCgndW5leHBlY3RlZCBNdWx0aUZhY3RvclNlc3Npb25UeXBlJyk7XG4gICAgfVxuICB9XG5cbiAgYWJzdHJhY3QgX2ZpbmFsaXplRW5yb2xsKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBpZFRva2VuOiBzdHJpbmcsXG4gICAgZGlzcGxheU5hbWU/OiBzdHJpbmcgfCBudWxsXG4gICk6IFByb21pc2U8RmluYWxpemVNZmFSZXNwb25zZT47XG4gIGFic3RyYWN0IF9maW5hbGl6ZVNpZ25JbihcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgbWZhUGVuZGluZ0NyZWRlbnRpYWw6IHN0cmluZ1xuICApOiBQcm9taXNlPEZpbmFsaXplTWZhUmVzcG9uc2U+O1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQge1xuICBGYWN0b3JJZCxcbiAgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvblxufSBmcm9tICcuLi8uLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuXG5pbXBvcnQgeyBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwgfSBmcm9tICcuLi8uLi8uLi9tZmEvbWZhX2Fzc2VydGlvbic7XG5pbXBvcnQgeyBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7IGZpbmFsaXplRW5yb2xsUGhvbmVNZmEgfSBmcm9tICcuLi8uLi8uLi9hcGkvYWNjb3VudF9tYW5hZ2VtZW50L21mYSc7XG5pbXBvcnQgeyBQaG9uZUF1dGhDcmVkZW50aWFsIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9jcmVkZW50aWFscy9waG9uZSc7XG5pbXBvcnQge1xuICBmaW5hbGl6ZVNpZ25JblBob25lTWZhLFxuICBGaW5hbGl6ZU1mYVJlc3BvbnNlXG59IGZyb20gJy4uLy4uLy4uL2FwaS9hdXRoZW50aWNhdGlvbi9tZmEnO1xuXG4vKipcbiAqIHtAaW5oZXJpdGRvYyBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9ufVxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsXG4gIGV4dGVuZHMgTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsXG4gIGltcGxlbWVudHMgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvblxue1xuICBwcml2YXRlIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgY3JlZGVudGlhbDogUGhvbmVBdXRoQ3JlZGVudGlhbCkge1xuICAgIHN1cGVyKEZhY3RvcklkLlBIT05FKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgc3RhdGljIF9mcm9tQ3JlZGVudGlhbChcbiAgICBjcmVkZW50aWFsOiBQaG9uZUF1dGhDcmVkZW50aWFsXG4gICk6IFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsIHtcbiAgICByZXR1cm4gbmV3IFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsKGNyZWRlbnRpYWwpO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBfZmluYWxpemVFbnJvbGwoXG4gICAgYXV0aDogQXV0aEludGVybmFsLFxuICAgIGlkVG9rZW46IHN0cmluZyxcbiAgICBkaXNwbGF5TmFtZT86IHN0cmluZyB8IG51bGxcbiAgKTogUHJvbWlzZTxGaW5hbGl6ZU1mYVJlc3BvbnNlPiB7XG4gICAgcmV0dXJuIGZpbmFsaXplRW5yb2xsUGhvbmVNZmEoYXV0aCwge1xuICAgICAgaWRUb2tlbixcbiAgICAgIGRpc3BsYXlOYW1lLFxuICAgICAgcGhvbmVWZXJpZmljYXRpb25JbmZvOiB0aGlzLmNyZWRlbnRpYWwuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KClcbiAgICB9KTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgX2ZpbmFsaXplU2lnbkluKFxuICAgIGF1dGg6IEF1dGhJbnRlcm5hbCxcbiAgICBtZmFQZW5kaW5nQ3JlZGVudGlhbDogc3RyaW5nXG4gICk6IFByb21pc2U8RmluYWxpemVNZmFSZXNwb25zZT4ge1xuICAgIHJldHVybiBmaW5hbGl6ZVNpZ25JblBob25lTWZhKGF1dGgsIHtcbiAgICAgIG1mYVBlbmRpbmdDcmVkZW50aWFsLFxuICAgICAgcGhvbmVWZXJpZmljYXRpb25JbmZvOiB0aGlzLmNyZWRlbnRpYWwuX21ha2VWZXJpZmljYXRpb25SZXF1ZXN0KClcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIGEge0BsaW5rIFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb259LlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIFBob25lTXVsdGlGYWN0b3JHZW5lcmF0b3Ige1xuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICAvKipcbiAgICogUHJvdmlkZXMgYSB7QGxpbmsgUGhvbmVNdWx0aUZhY3RvckFzc2VydGlvbn0gdG8gY29uZmlybSBvd25lcnNoaXAgb2YgdGhlIHBob25lIHNlY29uZCBmYWN0b3IuXG4gICAqXG4gICAqIEByZW1hcmtzXG4gICAqIFRoaXMgbWV0aG9kIGRvZXMgbm90IHdvcmsgaW4gYSBOb2RlLmpzIGVudmlyb25tZW50LlxuICAgKlxuICAgKiBAcGFyYW0gcGhvbmVBdXRoQ3JlZGVudGlhbCAtIEEgY3JlZGVudGlhbCBwcm92aWRlZCBieSB7QGxpbmsgUGhvbmVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbH0uXG4gICAqIEByZXR1cm5zIEEge0BsaW5rIFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb259IHdoaWNoIGNhbiBiZSB1c2VkIHdpdGhcbiAgICoge0BsaW5rIE11bHRpRmFjdG9yUmVzb2x2ZXIucmVzb2x2ZVNpZ25Jbn1cbiAgICovXG4gIHN0YXRpYyBhc3NlcnRpb24oY3JlZGVudGlhbDogUGhvbmVBdXRoQ3JlZGVudGlhbCk6IFBob25lTXVsdGlGYWN0b3JBc3NlcnRpb24ge1xuICAgIHJldHVybiBQaG9uZU11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbC5fZnJvbUNyZWRlbnRpYWwoY3JlZGVudGlhbCk7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGlkZW50aWZpZXIgb2YgdGhlIHBob25lIHNlY29uZCBmYWN0b3I6IGBwaG9uZWAuXG4gICAqL1xuICBzdGF0aWMgRkFDVE9SX0lEID0gJ3Bob25lJztcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHtcbiAgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uLFxuICBNdWx0aUZhY3RvclNlc3Npb24sXG4gIEZhY3RvcklkXG59IGZyb20gJy4uLy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQgeyBBdXRoSW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC9hdXRoJztcbmltcG9ydCB7XG4gIGZpbmFsaXplRW5yb2xsVG90cE1mYSxcbiAgc3RhcnRFbnJvbGxUb3RwTWZhLFxuICBTdGFydFRvdHBNZmFFbnJvbGxtZW50UmVzcG9uc2UsXG4gIFRvdHBWZXJpZmljYXRpb25JbmZvXG59IGZyb20gJy4uLy4uL2FwaS9hY2NvdW50X21hbmFnZW1lbnQvbWZhJztcbmltcG9ydCB7XG4gIEZpbmFsaXplTWZhUmVzcG9uc2UsXG4gIGZpbmFsaXplU2lnbkluVG90cE1mYVxufSBmcm9tICcuLi8uLi9hcGkvYXV0aGVudGljYXRpb24vbWZhJztcbmltcG9ydCB7IE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbCB9IGZyb20gJy4uLy4uL21mYS9tZmFfYXNzZXJ0aW9uJztcbmltcG9ydCB7IE11bHRpRmFjdG9yU2Vzc2lvbkltcGwgfSBmcm9tICcuLi9tZmFfc2Vzc2lvbic7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9lcnJvcnMnO1xuaW1wb3J0IHsgX2Fzc2VydCB9IGZyb20gJy4uLy4uL2NvcmUvdXRpbC9hc3NlcnQnO1xuXG4vKipcbiAqIFByb3ZpZGVyIGZvciBnZW5lcmF0aW5nIGEge0BsaW5rIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbn0uXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgVG90cE11bHRpRmFjdG9yR2VuZXJhdG9yIHtcbiAgLyoqXG4gICAqIFByb3ZpZGVzIGEge0BsaW5rIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbn0gdG8gY29uZmlybSBvd25lcnNoaXAgb2ZcbiAgICogdGhlIFRPVFAgKHRpbWUtYmFzZWQgb25lLXRpbWUgcGFzc3dvcmQpIHNlY29uZCBmYWN0b3IuXG4gICAqIFRoaXMgYXNzZXJ0aW9uIGlzIHVzZWQgdG8gY29tcGxldGUgZW5yb2xsbWVudCBpbiBUT1RQIHNlY29uZCBmYWN0b3IuXG4gICAqXG4gICAqIEBwYXJhbSBzZWNyZXQgQSB7QGxpbmsgVG90cFNlY3JldH0gY29udGFpbmluZyB0aGUgc2hhcmVkIHNlY3JldCBrZXkgYW5kIG90aGVyIFRPVFAgcGFyYW1ldGVycy5cbiAgICogQHBhcmFtIG9uZVRpbWVQYXNzd29yZCBPbmUtdGltZSBwYXNzd29yZCBmcm9tIFRPVFAgQXBwLlxuICAgKiBAcmV0dXJucyBBIHtAbGluayBUb3RwTXVsdGlGYWN0b3JBc3NlcnRpb259IHdoaWNoIGNhbiBiZSB1c2VkIHdpdGhcbiAgICoge0BsaW5rIE11bHRpRmFjdG9yVXNlci5lbnJvbGx9LlxuICAgKi9cbiAgc3RhdGljIGFzc2VydGlvbkZvckVucm9sbG1lbnQoXG4gICAgc2VjcmV0OiBUb3RwU2VjcmV0LFxuICAgIG9uZVRpbWVQYXNzd29yZDogc3RyaW5nXG4gICk6IFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbiB7XG4gICAgcmV0dXJuIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwuX2Zyb21TZWNyZXQoc2VjcmV0LCBvbmVUaW1lUGFzc3dvcmQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFByb3ZpZGVzIGEge0BsaW5rIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbn0gdG8gY29uZmlybSBvd25lcnNoaXAgb2YgdGhlIFRPVFAgc2Vjb25kIGZhY3Rvci5cbiAgICogVGhpcyBhc3NlcnRpb24gaXMgdXNlZCB0byBjb21wbGV0ZSBzaWduSW4gd2l0aCBUT1RQIGFzIHRoZSBzZWNvbmQgZmFjdG9yLlxuICAgKlxuICAgKiBAcGFyYW0gZW5yb2xsbWVudElkIGlkZW50aWZpZXMgdGhlIGVucm9sbGVkIFRPVFAgc2Vjb25kIGZhY3Rvci5cbiAgICogQHBhcmFtIG9uZVRpbWVQYXNzd29yZCBPbmUtdGltZSBwYXNzd29yZCBmcm9tIFRPVFAgQXBwLlxuICAgKiBAcmV0dXJucyBBIHtAbGluayBUb3RwTXVsdGlGYWN0b3JBc3NlcnRpb259IHdoaWNoIGNhbiBiZSB1c2VkIHdpdGhcbiAgICoge0BsaW5rIE11bHRpRmFjdG9yUmVzb2x2ZXIucmVzb2x2ZVNpZ25Jbn0uXG4gICAqL1xuICBzdGF0aWMgYXNzZXJ0aW9uRm9yU2lnbkluKFxuICAgIGVucm9sbG1lbnRJZDogc3RyaW5nLFxuICAgIG9uZVRpbWVQYXNzd29yZDogc3RyaW5nXG4gICk6IFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbiB7XG4gICAgcmV0dXJuIFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwuX2Zyb21FbnJvbGxtZW50SWQoXG4gICAgICBlbnJvbGxtZW50SWQsXG4gICAgICBvbmVUaW1lUGFzc3dvcmRcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSBwcm9taXNlIHRvIHtAbGluayBUb3RwU2VjcmV0fSB3aGljaCBjb250YWlucyB0aGUgVE9UUCBzaGFyZWQgc2VjcmV0IGtleSBhbmQgb3RoZXIgcGFyYW1ldGVycy5cbiAgICogQ3JlYXRlcyBhIFRPVFAgc2VjcmV0IGFzIHBhcnQgb2YgZW5yb2xsaW5nIGEgVE9UUCBzZWNvbmQgZmFjdG9yLlxuICAgKiBVc2VkIGZvciBnZW5lcmF0aW5nIGEgUVIgY29kZSBVUkwgb3IgaW5wdXR0aW5nIGludG8gYSBUT1RQIGFwcC5cbiAgICogVGhpcyBtZXRob2QgdXNlcyB0aGUgYXV0aCBpbnN0YW5jZSBjb3JyZXNwb25kaW5nIHRvIHRoZSB1c2VyIGluIHRoZSBtdWx0aUZhY3RvclNlc3Npb24uXG4gICAqXG4gICAqIEBwYXJhbSBzZXNzaW9uIFRoZSB7QGxpbmsgTXVsdGlGYWN0b3JTZXNzaW9ufSB0aGF0IHRoZSB1c2VyIGlzIHBhcnQgb2YuXG4gICAqIEByZXR1cm5zIEEgcHJvbWlzZSB0byB7QGxpbmsgVG90cFNlY3JldH0uXG4gICAqL1xuICBzdGF0aWMgYXN5bmMgZ2VuZXJhdGVTZWNyZXQoXG4gICAgc2Vzc2lvbjogTXVsdGlGYWN0b3JTZXNzaW9uXG4gICk6IFByb21pc2U8VG90cFNlY3JldD4ge1xuICAgIGNvbnN0IG1mYVNlc3Npb24gPSBzZXNzaW9uIGFzIE11bHRpRmFjdG9yU2Vzc2lvbkltcGw7XG4gICAgX2Fzc2VydChcbiAgICAgIHR5cGVvZiBtZmFTZXNzaW9uLnVzZXI/LmF1dGggIT09ICd1bmRlZmluZWQnLFxuICAgICAgQXV0aEVycm9yQ29kZS5JTlRFUk5BTF9FUlJPUlxuICAgICk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBzdGFydEVucm9sbFRvdHBNZmEobWZhU2Vzc2lvbi51c2VyLmF1dGgsIHtcbiAgICAgIGlkVG9rZW46IG1mYVNlc3Npb24uY3JlZGVudGlhbCxcbiAgICAgIHRvdHBFbnJvbGxtZW50SW5mbzoge31cbiAgICB9KTtcbiAgICByZXR1cm4gVG90cFNlY3JldC5fZnJvbVN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXNwb25zZShcbiAgICAgIHJlc3BvbnNlLFxuICAgICAgbWZhU2Vzc2lvbi51c2VyLmF1dGhcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBpZGVudGlmaWVyIG9mIHRoZSBUT1RQIHNlY29uZCBmYWN0b3I6IGB0b3RwYC5cbiAgICovXG4gIHN0YXRpYyBGQUNUT1JfSUQ6ICd0b3RwJyA9IEZhY3RvcklkLlRPVFA7XG59XG5cbmV4cG9ydCBjbGFzcyBUb3RwTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsXG4gIGV4dGVuZHMgTXVsdGlGYWN0b3JBc3NlcnRpb25JbXBsXG4gIGltcGxlbWVudHMgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uXG57XG4gIGNvbnN0cnVjdG9yKFxuICAgIHJlYWRvbmx5IG90cDogc3RyaW5nLFxuICAgIHJlYWRvbmx5IGVucm9sbG1lbnRJZD86IHN0cmluZyxcbiAgICByZWFkb25seSBzZWNyZXQ/OiBUb3RwU2VjcmV0XG4gICkge1xuICAgIHN1cGVyKEZhY3RvcklkLlRPVFApO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBzdGF0aWMgX2Zyb21TZWNyZXQoXG4gICAgc2VjcmV0OiBUb3RwU2VjcmV0LFxuICAgIG90cDogc3RyaW5nXG4gICk6IFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwge1xuICAgIHJldHVybiBuZXcgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbChvdHAsIHVuZGVmaW5lZCwgc2VjcmV0KTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgc3RhdGljIF9mcm9tRW5yb2xsbWVudElkKFxuICAgIGVucm9sbG1lbnRJZDogc3RyaW5nLFxuICAgIG90cDogc3RyaW5nXG4gICk6IFRvdHBNdWx0aUZhY3RvckFzc2VydGlvbkltcGwge1xuICAgIHJldHVybiBuZXcgVG90cE11bHRpRmFjdG9yQXNzZXJ0aW9uSW1wbChvdHAsIGVucm9sbG1lbnRJZCk7XG4gIH1cblxuICAvKiogQGludGVybmFsICovXG4gIGFzeW5jIF9maW5hbGl6ZUVucm9sbChcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWwsXG4gICAgaWRUb2tlbjogc3RyaW5nLFxuICAgIGRpc3BsYXlOYW1lPzogc3RyaW5nIHwgbnVsbFxuICApOiBQcm9taXNlPEZpbmFsaXplTWZhUmVzcG9uc2U+IHtcbiAgICBfYXNzZXJ0KFxuICAgICAgdHlwZW9mIHRoaXMuc2VjcmV0ICE9PSAndW5kZWZpbmVkJyxcbiAgICAgIGF1dGgsXG4gICAgICBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SXG4gICAgKTtcbiAgICByZXR1cm4gZmluYWxpemVFbnJvbGxUb3RwTWZhKGF1dGgsIHtcbiAgICAgIGlkVG9rZW4sXG4gICAgICBkaXNwbGF5TmFtZSxcbiAgICAgIHRvdHBWZXJpZmljYXRpb25JbmZvOiB0aGlzLnNlY3JldC5fbWFrZVRvdHBWZXJpZmljYXRpb25JbmZvKHRoaXMub3RwKVxuICAgIH0pO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBhc3luYyBfZmluYWxpemVTaWduSW4oXG4gICAgYXV0aDogQXV0aEludGVybmFsLFxuICAgIG1mYVBlbmRpbmdDcmVkZW50aWFsOiBzdHJpbmdcbiAgKTogUHJvbWlzZTxGaW5hbGl6ZU1mYVJlc3BvbnNlPiB7XG4gICAgX2Fzc2VydChcbiAgICAgIHRoaXMuZW5yb2xsbWVudElkICE9PSB1bmRlZmluZWQgJiYgdGhpcy5vdHAgIT09IHVuZGVmaW5lZCxcbiAgICAgIGF1dGgsXG4gICAgICBBdXRoRXJyb3JDb2RlLkFSR1VNRU5UX0VSUk9SXG4gICAgKTtcbiAgICBjb25zdCB0b3RwVmVyaWZpY2F0aW9uSW5mbyA9IHsgdmVyaWZpY2F0aW9uQ29kZTogdGhpcy5vdHAgfTtcbiAgICByZXR1cm4gZmluYWxpemVTaWduSW5Ub3RwTWZhKGF1dGgsIHtcbiAgICAgIG1mYVBlbmRpbmdDcmVkZW50aWFsLFxuICAgICAgbWZhRW5yb2xsbWVudElkOiB0aGlzLmVucm9sbG1lbnRJZCxcbiAgICAgIHRvdHBWZXJpZmljYXRpb25JbmZvXG4gICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlciBmb3IgZ2VuZXJhdGluZyBhIHtAbGluayBUb3RwTXVsdGlGYWN0b3JBc3NlcnRpb259LlxuICpcbiAqIFN0b3JlcyB0aGUgc2hhcmVkIHNlY3JldCBrZXkgYW5kIG90aGVyIHBhcmFtZXRlcnMgdG8gZ2VuZXJhdGUgdGltZS1iYXNlZCBPVFBzLlxuICogSW1wbGVtZW50cyBtZXRob2RzIHRvIHJldHJpZXZlIHRoZSBzaGFyZWQgc2VjcmV0IGtleSBhbmQgZ2VuZXJhdGUgYSBRUiBjb2RlIFVSTC5cbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGNsYXNzIFRvdHBTZWNyZXQge1xuICAvKipcbiAgICogU2hhcmVkIHNlY3JldCBrZXkvc2VlZCB1c2VkIGZvciBlbnJvbGxpbmcgaW4gVE9UUCBNRkEgYW5kIGdlbmVyYXRpbmcgT1RQcy5cbiAgICovXG4gIHJlYWRvbmx5IHNlY3JldEtleTogc3RyaW5nO1xuICAvKipcbiAgICogSGFzaGluZyBhbGdvcml0aG0gdXNlZC5cbiAgICovXG4gIHJlYWRvbmx5IGhhc2hpbmdBbGdvcml0aG06IHN0cmluZztcbiAgLyoqXG4gICAqIExlbmd0aCBvZiB0aGUgb25lLXRpbWUgcGFzc3dvcmRzIHRvIGJlIGdlbmVyYXRlZC5cbiAgICovXG4gIHJlYWRvbmx5IGNvZGVMZW5ndGg6IG51bWJlcjtcbiAgLyoqXG4gICAqIFRoZSBpbnRlcnZhbCAoaW4gc2Vjb25kcykgd2hlbiB0aGUgT1RQIGNvZGVzIHNob3VsZCBjaGFuZ2UuXG4gICAqL1xuICByZWFkb25seSBjb2RlSW50ZXJ2YWxTZWNvbmRzOiBudW1iZXI7XG4gIC8qKlxuICAgKiBUaGUgdGltZXN0YW1wIChVVEMgc3RyaW5nKSBieSB3aGljaCBUT1RQIGVucm9sbG1lbnQgc2hvdWxkIGJlIGNvbXBsZXRlZC5cbiAgICovXG4gIC8vIFRoaXMgY2FuIGJlIHVzZWQgYnkgY2FsbGVycyB0byBzaG93IGEgY291bnRkb3duIG9mIHdoZW4gdG8gZW50ZXIgT1RQIGNvZGUgYnkuXG4gIHJlYWRvbmx5IGVucm9sbG1lbnRDb21wbGV0aW9uRGVhZGxpbmU6IHN0cmluZztcblxuICAvLyBUaGUgcHVibGljIG1lbWJlcnMgYXJlIGRlY2xhcmVkIG91dHNpZGUgdGhlIGNvbnN0cnVjdG9yIHNvIHRoZSBkb2NzIGNhbiBiZSBnZW5lcmF0ZWQuXG4gIHByaXZhdGUgY29uc3RydWN0b3IoXG4gICAgc2VjcmV0S2V5OiBzdHJpbmcsXG4gICAgaGFzaGluZ0FsZ29yaXRobTogc3RyaW5nLFxuICAgIGNvZGVMZW5ndGg6IG51bWJlcixcbiAgICBjb2RlSW50ZXJ2YWxTZWNvbmRzOiBudW1iZXIsXG4gICAgZW5yb2xsbWVudENvbXBsZXRpb25EZWFkbGluZTogc3RyaW5nLFxuICAgIHByaXZhdGUgcmVhZG9ubHkgc2Vzc2lvbkluZm86IHN0cmluZyxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGF1dGg6IEF1dGhJbnRlcm5hbFxuICApIHtcbiAgICB0aGlzLnNlY3JldEtleSA9IHNlY3JldEtleTtcbiAgICB0aGlzLmhhc2hpbmdBbGdvcml0aG0gPSBoYXNoaW5nQWxnb3JpdGhtO1xuICAgIHRoaXMuY29kZUxlbmd0aCA9IGNvZGVMZW5ndGg7XG4gICAgdGhpcy5jb2RlSW50ZXJ2YWxTZWNvbmRzID0gY29kZUludGVydmFsU2Vjb25kcztcbiAgICB0aGlzLmVucm9sbG1lbnRDb21wbGV0aW9uRGVhZGxpbmUgPSBlbnJvbGxtZW50Q29tcGxldGlvbkRlYWRsaW5lO1xuICB9XG5cbiAgLyoqIEBpbnRlcm5hbCAqL1xuICBzdGF0aWMgX2Zyb21TdGFydFRvdHBNZmFFbnJvbGxtZW50UmVzcG9uc2UoXG4gICAgcmVzcG9uc2U6IFN0YXJ0VG90cE1mYUVucm9sbG1lbnRSZXNwb25zZSxcbiAgICBhdXRoOiBBdXRoSW50ZXJuYWxcbiAgKTogVG90cFNlY3JldCB7XG4gICAgcmV0dXJuIG5ldyBUb3RwU2VjcmV0KFxuICAgICAgcmVzcG9uc2UudG90cFNlc3Npb25JbmZvLnNoYXJlZFNlY3JldEtleSxcbiAgICAgIHJlc3BvbnNlLnRvdHBTZXNzaW9uSW5mby5oYXNoaW5nQWxnb3JpdGhtLFxuICAgICAgcmVzcG9uc2UudG90cFNlc3Npb25JbmZvLnZlcmlmaWNhdGlvbkNvZGVMZW5ndGgsXG4gICAgICByZXNwb25zZS50b3RwU2Vzc2lvbkluZm8ucGVyaW9kU2VjLFxuICAgICAgbmV3IERhdGUocmVzcG9uc2UudG90cFNlc3Npb25JbmZvLmZpbmFsaXplRW5yb2xsbWVudFRpbWUpLnRvVVRDU3RyaW5nKCksXG4gICAgICByZXNwb25zZS50b3RwU2Vzc2lvbkluZm8uc2Vzc2lvbkluZm8sXG4gICAgICBhdXRoXG4gICAgKTtcbiAgfVxuXG4gIC8qKiBAaW50ZXJuYWwgKi9cbiAgX21ha2VUb3RwVmVyaWZpY2F0aW9uSW5mbyhvdHA6IHN0cmluZyk6IFRvdHBWZXJpZmljYXRpb25JbmZvIHtcbiAgICByZXR1cm4geyBzZXNzaW9uSW5mbzogdGhpcy5zZXNzaW9uSW5mbywgdmVyaWZpY2F0aW9uQ29kZTogb3RwIH07XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIFFSIGNvZGUgVVJMIGFzIGRlc2NyaWJlZCBpblxuICAgKiBodHRwczovL2dpdGh1Yi5jb20vZ29vZ2xlL2dvb2dsZS1hdXRoZW50aWNhdG9yL3dpa2kvS2V5LVVyaS1Gb3JtYXRcbiAgICogVGhpcyBjYW4gYmUgZGlzcGxheWVkIHRvIHRoZSB1c2VyIGFzIGEgUVIgY29kZSB0byBiZSBzY2FubmVkIGludG8gYSBUT1RQIGFwcCBsaWtlIEdvb2dsZSBBdXRoZW50aWNhdG9yLlxuICAgKiBJZiB0aGUgb3B0aW9uYWwgcGFyYW1ldGVycyBhcmUgdW5zcGVjaWZpZWQsIGFuIGFjY291bnROYW1lIG9mIDx1c2VyRW1haWw+IGFuZCBpc3N1ZXIgb2YgPGZpcmViYXNlQXBwTmFtZT4gYXJlIHVzZWQuXG4gICAqXG4gICAqIEBwYXJhbSBhY2NvdW50TmFtZSB0aGUgbmFtZSBvZiB0aGUgYWNjb3VudC9hcHAgYWxvbmcgd2l0aCBhIHVzZXIgaWRlbnRpZmllci5cbiAgICogQHBhcmFtIGlzc3VlciBpc3N1ZXIgb2YgdGhlIFRPVFAgKGxpa2VseSB0aGUgYXBwIG5hbWUpLlxuICAgKiBAcmV0dXJucyBBIFFSIGNvZGUgVVJMIHN0cmluZy5cbiAgICovXG4gIGdlbmVyYXRlUXJDb2RlVXJsKGFjY291bnROYW1lPzogc3RyaW5nLCBpc3N1ZXI/OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGxldCB1c2VEZWZhdWx0cyA9IGZhbHNlO1xuICAgIGlmIChfaXNFbXB0eVN0cmluZyhhY2NvdW50TmFtZSkgfHwgX2lzRW1wdHlTdHJpbmcoaXNzdWVyKSkge1xuICAgICAgdXNlRGVmYXVsdHMgPSB0cnVlO1xuICAgIH1cbiAgICBpZiAodXNlRGVmYXVsdHMpIHtcbiAgICAgIGlmIChfaXNFbXB0eVN0cmluZyhhY2NvdW50TmFtZSkpIHtcbiAgICAgICAgYWNjb3VudE5hbWUgPSB0aGlzLmF1dGguY3VycmVudFVzZXI/LmVtYWlsIHx8ICd1bmtub3dudXNlcic7XG4gICAgICB9XG4gICAgICBpZiAoX2lzRW1wdHlTdHJpbmcoaXNzdWVyKSkge1xuICAgICAgICBpc3N1ZXIgPSB0aGlzLmF1dGgubmFtZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGBvdHBhdXRoOi8vdG90cC8ke2lzc3Vlcn06JHthY2NvdW50TmFtZX0/c2VjcmV0PSR7dGhpcy5zZWNyZXRLZXl9Jmlzc3Vlcj0ke2lzc3Vlcn0mYWxnb3JpdGhtPSR7dGhpcy5oYXNoaW5nQWxnb3JpdGhtfSZkaWdpdHM9JHt0aGlzLmNvZGVMZW5ndGh9YDtcbiAgfVxufVxuXG4vKiogQGludGVybmFsICovXG5mdW5jdGlvbiBfaXNFbXB0eVN0cmluZyhpbnB1dD86IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gdHlwZW9mIGlucHV0ID09PSAndW5kZWZpbmVkJyB8fCBpbnB1dD8ubGVuZ3RoID09PSAwO1xufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFVuc3Vic2NyaWJlIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuaW1wb3J0IHsgRmlyZWJhc2VBdXRoSW50ZXJuYWwgfSBmcm9tICdAZmlyZWJhc2UvYXV0aC1pbnRlcm9wLXR5cGVzJztcblxuaW1wb3J0IHsgQXV0aEludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBVc2VySW50ZXJuYWwgfSBmcm9tICcuLi8uLi9tb2RlbC91c2VyJztcbmltcG9ydCB7IF9hc3NlcnQgfSBmcm9tICcuLi91dGlsL2Fzc2VydCc7XG5pbXBvcnQgeyBBdXRoRXJyb3JDb2RlIH0gZnJvbSAnLi4vZXJyb3JzJztcblxuaW50ZXJmYWNlIFRva2VuTGlzdGVuZXIge1xuICAodG9rOiBzdHJpbmcgfCBudWxsKTogdW5rbm93bjtcbn1cblxuZXhwb3J0IGNsYXNzIEF1dGhJbnRlcm9wIGltcGxlbWVudHMgRmlyZWJhc2VBdXRoSW50ZXJuYWwge1xuICBwcml2YXRlIHJlYWRvbmx5IGludGVybmFsTGlzdGVuZXJzOiBNYXA8VG9rZW5MaXN0ZW5lciwgVW5zdWJzY3JpYmU+ID1cbiAgICBuZXcgTWFwKCk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBhdXRoOiBBdXRoSW50ZXJuYWwpIHt9XG5cbiAgZ2V0VWlkKCk6IHN0cmluZyB8IG51bGwge1xuICAgIHRoaXMuYXNzZXJ0QXV0aENvbmZpZ3VyZWQoKTtcbiAgICByZXR1cm4gdGhpcy5hdXRoLmN1cnJlbnRVc2VyPy51aWQgfHwgbnVsbDtcbiAgfVxuXG4gIGFzeW5jIGdldFRva2VuKFxuICAgIGZvcmNlUmVmcmVzaD86IGJvb2xlYW5cbiAgKTogUHJvbWlzZTx7IGFjY2Vzc1Rva2VuOiBzdHJpbmcgfSB8IG51bGw+IHtcbiAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XG4gICAgYXdhaXQgdGhpcy5hdXRoLl9pbml0aWFsaXphdGlvblByb21pc2U7XG4gICAgaWYgKCF0aGlzLmF1dGguY3VycmVudFVzZXIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXdhaXQgdGhpcy5hdXRoLmN1cnJlbnRVc2VyLmdldElkVG9rZW4oZm9yY2VSZWZyZXNoKTtcbiAgICByZXR1cm4geyBhY2Nlc3NUb2tlbiB9O1xuICB9XG5cbiAgYWRkQXV0aFRva2VuTGlzdGVuZXIobGlzdGVuZXI6IFRva2VuTGlzdGVuZXIpOiB2b2lkIHtcbiAgICB0aGlzLmFzc2VydEF1dGhDb25maWd1cmVkKCk7XG4gICAgaWYgKHRoaXMuaW50ZXJuYWxMaXN0ZW5lcnMuaGFzKGxpc3RlbmVyKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gdGhpcy5hdXRoLm9uSWRUb2tlbkNoYW5nZWQodXNlciA9PiB7XG4gICAgICBsaXN0ZW5lcihcbiAgICAgICAgKHVzZXIgYXMgVXNlckludGVybmFsIHwgbnVsbCk/LnN0c1Rva2VuTWFuYWdlci5hY2Nlc3NUb2tlbiB8fCBudWxsXG4gICAgICApO1xuICAgIH0pO1xuICAgIHRoaXMuaW50ZXJuYWxMaXN0ZW5lcnMuc2V0KGxpc3RlbmVyLCB1bnN1YnNjcmliZSk7XG4gICAgdGhpcy51cGRhdGVQcm9hY3RpdmVSZWZyZXNoKCk7XG4gIH1cblxuICByZW1vdmVBdXRoVG9rZW5MaXN0ZW5lcihsaXN0ZW5lcjogVG9rZW5MaXN0ZW5lcik6IHZvaWQge1xuICAgIHRoaXMuYXNzZXJ0QXV0aENvbmZpZ3VyZWQoKTtcbiAgICBjb25zdCB1bnN1YnNjcmliZSA9IHRoaXMuaW50ZXJuYWxMaXN0ZW5lcnMuZ2V0KGxpc3RlbmVyKTtcbiAgICBpZiAoIXVuc3Vic2NyaWJlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5pbnRlcm5hbExpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpO1xuICAgIHVuc3Vic2NyaWJlKCk7XG4gICAgdGhpcy51cGRhdGVQcm9hY3RpdmVSZWZyZXNoKCk7XG4gIH1cblxuICBwcml2YXRlIGFzc2VydEF1dGhDb25maWd1cmVkKCk6IHZvaWQge1xuICAgIF9hc3NlcnQoXG4gICAgICB0aGlzLmF1dGguX2luaXRpYWxpemF0aW9uUHJvbWlzZSxcbiAgICAgIEF1dGhFcnJvckNvZGUuREVQRU5ERU5UX1NES19JTklUX0JFRk9SRV9BVVRIXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlUHJvYWN0aXZlUmVmcmVzaCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5pbnRlcm5hbExpc3RlbmVycy5zaXplID4gMCkge1xuICAgICAgdGhpcy5hdXRoLl9zdGFydFByb2FjdGl2ZVJlZnJlc2goKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5hdXRoLl9zdG9wUHJvYWN0aXZlUmVmcmVzaCgpO1xuICAgIH1cbiAgfVxufVxuIiwgIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IF9yZWdpc3RlckNvbXBvbmVudCwgcmVnaXN0ZXJWZXJzaW9uIH0gZnJvbSAnQGZpcmViYXNlL2FwcCc7XG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIENvbXBvbmVudFR5cGUsXG4gIEluc3RhbnRpYXRpb25Nb2RlXG59IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuXG5pbXBvcnQgeyBuYW1lLCB2ZXJzaW9uIH0gZnJvbSAnLi4vLi4vLi4vcGFja2FnZS5qc29uJztcbmltcG9ydCB7IEF1dGhFcnJvckNvZGUgfSBmcm9tICcuLi9lcnJvcnMnO1xuaW1wb3J0IHsgX2Fzc2VydCB9IGZyb20gJy4uL3V0aWwvYXNzZXJ0JztcbmltcG9ydCB7IF9nZXRDbGllbnRWZXJzaW9uLCBDbGllbnRQbGF0Zm9ybSB9IGZyb20gJy4uL3V0aWwvdmVyc2lvbic7XG5pbXBvcnQgeyBfY2FzdEF1dGgsIEF1dGhJbXBsLCBEZWZhdWx0Q29uZmlnIH0gZnJvbSAnLi9hdXRoX2ltcGwnO1xuaW1wb3J0IHsgQXV0aEludGVyb3AgfSBmcm9tICcuL2ZpcmViYXNlX2ludGVybmFsJztcbmltcG9ydCB7IENvbmZpZ0ludGVybmFsIH0gZnJvbSAnLi4vLi4vbW9kZWwvYXV0aCc7XG5pbXBvcnQgeyBEZXBlbmRlbmNpZXMgfSBmcm9tICcuLi8uLi9tb2RlbC9wdWJsaWNfdHlwZXMnO1xuaW1wb3J0IHsgX2luaXRpYWxpemVBdXRoSW5zdGFuY2UgfSBmcm9tICcuL2luaXRpYWxpemUnO1xuXG5leHBvcnQgY29uc3QgZW51bSBfQ29tcG9uZW50TmFtZSB7XG4gIEFVVEggPSAnYXV0aCcsXG4gIEFVVEhfSU5URVJOQUwgPSAnYXV0aC1pbnRlcm5hbCdcbn1cblxuZnVuY3Rpb24gZ2V0VmVyc2lvbkZvclBsYXRmb3JtKFxuICBjbGllbnRQbGF0Zm9ybTogQ2xpZW50UGxhdGZvcm1cbik6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gIHN3aXRjaCAoY2xpZW50UGxhdGZvcm0pIHtcbiAgICBjYXNlIENsaWVudFBsYXRmb3JtLk5PREU6XG4gICAgICByZXR1cm4gJ25vZGUnO1xuICAgIGNhc2UgQ2xpZW50UGxhdGZvcm0uUkVBQ1RfTkFUSVZFOlxuICAgICAgcmV0dXJuICdybic7XG4gICAgY2FzZSBDbGllbnRQbGF0Zm9ybS5XT1JLRVI6XG4gICAgICByZXR1cm4gJ3dlYndvcmtlcic7XG4gICAgY2FzZSBDbGllbnRQbGF0Zm9ybS5DT1JET1ZBOlxuICAgICAgcmV0dXJuICdjb3Jkb3ZhJztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG4vKiogQGludGVybmFsICovXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJBdXRoKGNsaWVudFBsYXRmb3JtOiBDbGllbnRQbGF0Zm9ybSk6IHZvaWQge1xuICBfcmVnaXN0ZXJDb21wb25lbnQoXG4gICAgbmV3IENvbXBvbmVudChcbiAgICAgIF9Db21wb25lbnROYW1lLkFVVEgsXG4gICAgICAoY29udGFpbmVyLCB7IG9wdGlvbnM6IGRlcHMgfTogeyBvcHRpb25zPzogRGVwZW5kZW5jaWVzIH0pID0+IHtcbiAgICAgICAgY29uc3QgYXBwID0gY29udGFpbmVyLmdldFByb3ZpZGVyKCdhcHAnKS5nZXRJbW1lZGlhdGUoKSE7XG4gICAgICAgIGNvbnN0IGhlYXJ0YmVhdFNlcnZpY2VQcm92aWRlciA9XG4gICAgICAgICAgY29udGFpbmVyLmdldFByb3ZpZGVyPCdoZWFydGJlYXQnPignaGVhcnRiZWF0Jyk7XG4gICAgICAgIGNvbnN0IGFwcENoZWNrU2VydmljZVByb3ZpZGVyID1cbiAgICAgICAgICBjb250YWluZXIuZ2V0UHJvdmlkZXI8J2FwcC1jaGVjay1pbnRlcm5hbCc+KCdhcHAtY2hlY2staW50ZXJuYWwnKTtcbiAgICAgICAgY29uc3QgeyBhcGlLZXksIGF1dGhEb21haW4gfSA9IGFwcC5vcHRpb25zO1xuXG4gICAgICAgIF9hc3NlcnQoXG4gICAgICAgICAgYXBpS2V5ICYmICFhcGlLZXkuaW5jbHVkZXMoJzonKSxcbiAgICAgICAgICBBdXRoRXJyb3JDb2RlLklOVkFMSURfQVBJX0tFWSxcbiAgICAgICAgICB7IGFwcE5hbWU6IGFwcC5uYW1lIH1cbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBjb25maWc6IENvbmZpZ0ludGVybmFsID0ge1xuICAgICAgICAgIGFwaUtleSxcbiAgICAgICAgICBhdXRoRG9tYWluLFxuICAgICAgICAgIGNsaWVudFBsYXRmb3JtLFxuICAgICAgICAgIGFwaUhvc3Q6IERlZmF1bHRDb25maWcuQVBJX0hPU1QsXG4gICAgICAgICAgdG9rZW5BcGlIb3N0OiBEZWZhdWx0Q29uZmlnLlRPS0VOX0FQSV9IT1NULFxuICAgICAgICAgIGFwaVNjaGVtZTogRGVmYXVsdENvbmZpZy5BUElfU0NIRU1FLFxuICAgICAgICAgIHNka0NsaWVudFZlcnNpb246IF9nZXRDbGllbnRWZXJzaW9uKGNsaWVudFBsYXRmb3JtKVxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGF1dGhJbnN0YW5jZSA9IG5ldyBBdXRoSW1wbChcbiAgICAgICAgICBhcHAsXG4gICAgICAgICAgaGVhcnRiZWF0U2VydmljZVByb3ZpZGVyLFxuICAgICAgICAgIGFwcENoZWNrU2VydmljZVByb3ZpZGVyLFxuICAgICAgICAgIGNvbmZpZ1xuICAgICAgICApO1xuICAgICAgICBfaW5pdGlhbGl6ZUF1dGhJbnN0YW5jZShhdXRoSW5zdGFuY2UsIGRlcHMpO1xuXG4gICAgICAgIHJldHVybiBhdXRoSW5zdGFuY2U7XG4gICAgICB9LFxuICAgICAgQ29tcG9uZW50VHlwZS5QVUJMSUNcbiAgICApXG4gICAgICAvKipcbiAgICAgICAqIEF1dGggY2FuIG9ubHkgYmUgaW5pdGlhbGl6ZWQgYnkgZXhwbGljaXRseSBjYWxsaW5nIGdldEF1dGgoKSBvciBpbml0aWFsaXplQXV0aCgpXG4gICAgICAgKiBGb3Igd2h5IHdlIGRvIHRoaXMsIFNlZSBnby9maXJlYmFzZS1uZXh0LWF1dGgtaW5pdFxuICAgICAgICovXG4gICAgICAuc2V0SW5zdGFudGlhdGlvbk1vZGUoSW5zdGFudGlhdGlvbk1vZGUuRVhQTElDSVQpXG4gICAgICAvKipcbiAgICAgICAqIEJlY2F1c2UgYWxsIGZpcmViYXNlIHByb2R1Y3RzIHRoYXQgZGVwZW5kIG9uIGF1dGggZGVwZW5kIG9uIGF1dGgtaW50ZXJuYWwgZGlyZWN0bHksXG4gICAgICAgKiB3ZSBuZWVkIHRvIGluaXRpYWxpemUgYXV0aC1pbnRlcm5hbCBhZnRlciBhdXRoIGlzIGluaXRpYWxpemVkIHRvIG1ha2UgaXQgYXZhaWxhYmxlIHRvIG90aGVyIGZpcmViYXNlIHByb2R1Y3RzLlxuICAgICAgICovXG4gICAgICAuc2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2soXG4gICAgICAgIChjb250YWluZXIsIF9pbnN0YW5jZUlkZW50aWZpZXIsIF9pbnN0YW5jZSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGF1dGhJbnRlcm5hbFByb3ZpZGVyID0gY29udGFpbmVyLmdldFByb3ZpZGVyKFxuICAgICAgICAgICAgX0NvbXBvbmVudE5hbWUuQVVUSF9JTlRFUk5BTFxuICAgICAgICAgICk7XG4gICAgICAgICAgYXV0aEludGVybmFsUHJvdmlkZXIuaW5pdGlhbGl6ZSgpO1xuICAgICAgICB9XG4gICAgICApXG4gICk7XG5cbiAgX3JlZ2lzdGVyQ29tcG9uZW50KFxuICAgIG5ldyBDb21wb25lbnQoXG4gICAgICBfQ29tcG9uZW50TmFtZS5BVVRIX0lOVEVSTkFMLFxuICAgICAgY29udGFpbmVyID0+IHtcbiAgICAgICAgY29uc3QgYXV0aCA9IF9jYXN0QXV0aChcbiAgICAgICAgICBjb250YWluZXIuZ2V0UHJvdmlkZXIoX0NvbXBvbmVudE5hbWUuQVVUSCkuZ2V0SW1tZWRpYXRlKCkhXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiAoYXV0aCA9PiBuZXcgQXV0aEludGVyb3AoYXV0aCkpKGF1dGgpO1xuICAgICAgfSxcbiAgICAgIENvbXBvbmVudFR5cGUuUFJJVkFURVxuICAgICkuc2V0SW5zdGFudGlhdGlvbk1vZGUoSW5zdGFudGlhdGlvbk1vZGUuRVhQTElDSVQpXG4gICk7XG5cbiAgcmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sIGdldFZlcnNpb25Gb3JQbGF0Zm9ybShjbGllbnRQbGF0Zm9ybSkpO1xuICAvLyBCVUlMRF9UQVJHRVQgd2lsbCBiZSByZXBsYWNlZCBieSB2YWx1ZXMgbGlrZSBlc201LCBlc20yMDE3LCBjanM1LCBldGMgZHVyaW5nIHRoZSBjb21waWxhdGlvblxuICByZWdpc3RlclZlcnNpb24obmFtZSwgdmVyc2lvbiwgJ19fQlVJTERfVEFSR0VUX18nKTtcbn1cbiIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBGaXJlYmFzZUFwcCwgZ2V0QXBwLCBfZ2V0UHJvdmlkZXIgfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcblxuaW1wb3J0IHtcbiAgaW5pdGlhbGl6ZUF1dGgsXG4gIGJlZm9yZUF1dGhTdGF0ZUNoYW5nZWQsXG4gIG9uSWRUb2tlbkNoYW5nZWQsXG4gIGNvbm5lY3RBdXRoRW11bGF0b3Jcbn0gZnJvbSAnLi4nO1xuaW1wb3J0IHsgcmVnaXN0ZXJBdXRoIH0gZnJvbSAnLi4vY29yZS9hdXRoL3JlZ2lzdGVyJztcbmltcG9ydCB7IENsaWVudFBsYXRmb3JtIH0gZnJvbSAnLi4vY29yZS91dGlsL3ZlcnNpb24nO1xuaW1wb3J0IHsgYnJvd3NlckxvY2FsUGVyc2lzdGVuY2UgfSBmcm9tICcuL3BlcnNpc3RlbmNlL2xvY2FsX3N0b3JhZ2UnO1xuaW1wb3J0IHsgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZSB9IGZyb20gJy4vcGVyc2lzdGVuY2Uvc2Vzc2lvbl9zdG9yYWdlJztcbmltcG9ydCB7IGluZGV4ZWREQkxvY2FsUGVyc2lzdGVuY2UgfSBmcm9tICcuL3BlcnNpc3RlbmNlL2luZGV4ZWRfZGInO1xuaW1wb3J0IHsgYnJvd3NlclBvcHVwUmVkaXJlY3RSZXNvbHZlciB9IGZyb20gJy4vcG9wdXBfcmVkaXJlY3QnO1xuaW1wb3J0IHsgQXV0aCwgVXNlciB9IGZyb20gJy4uL21vZGVsL3B1YmxpY190eXBlcyc7XG5pbXBvcnQgeyBnZXREZWZhdWx0RW11bGF0b3JIb3N0LCBnZXRFeHBlcmltZW50YWxTZXR0aW5nIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG5jb25zdCBERUZBVUxUX0lEX1RPS0VOX01BWF9BR0UgPSA1ICogNjA7XG5jb25zdCBhdXRoSWRUb2tlbk1heEFnZSA9XG4gIGdldEV4cGVyaW1lbnRhbFNldHRpbmcoJ2F1dGhJZFRva2VuTWF4QWdlJykgfHwgREVGQVVMVF9JRF9UT0tFTl9NQVhfQUdFO1xuXG5sZXQgbGFzdFBvc3RlZElkVG9rZW46IHN0cmluZyB8IHVuZGVmaW5lZCB8IG51bGwgPSBudWxsO1xuXG5jb25zdCBtaW50Q29va2llRmFjdG9yeSA9ICh1cmw6IHN0cmluZykgPT4gYXN5bmMgKHVzZXI6IFVzZXIgfCBudWxsKSA9PiB7XG4gIGNvbnN0IGlkVG9rZW5SZXN1bHQgPSB1c2VyICYmIChhd2FpdCB1c2VyLmdldElkVG9rZW5SZXN1bHQoKSk7XG4gIGNvbnN0IGlkVG9rZW5BZ2UgPVxuICAgIGlkVG9rZW5SZXN1bHQgJiZcbiAgICAobmV3IERhdGUoKS5nZXRUaW1lKCkgLSBEYXRlLnBhcnNlKGlkVG9rZW5SZXN1bHQuaXNzdWVkQXRUaW1lKSkgLyAxXzAwMDtcbiAgaWYgKGlkVG9rZW5BZ2UgJiYgaWRUb2tlbkFnZSA+IGF1dGhJZFRva2VuTWF4QWdlKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIC8vIFNwZWNpZmljYWxseSB0cmlwIG51bGwgPT4gdW5kZWZpbmVkIHdoZW4gbG9nZ2VkIG91dCwgdG8gZGVsZXRlIGFueSBleGlzdGluZyBjb29raWVcbiAgY29uc3QgaWRUb2tlbiA9IGlkVG9rZW5SZXN1bHQ/LnRva2VuO1xuICBpZiAobGFzdFBvc3RlZElkVG9rZW4gPT09IGlkVG9rZW4pIHtcbiAgICByZXR1cm47XG4gIH1cbiAgbGFzdFBvc3RlZElkVG9rZW4gPSBpZFRva2VuO1xuICBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICBtZXRob2Q6IGlkVG9rZW4gPyAnUE9TVCcgOiAnREVMRVRFJyxcbiAgICBoZWFkZXJzOiBpZFRva2VuXG4gICAgICA/IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHtpZFRva2VufWBcbiAgICAgICAgfVxuICAgICAgOiB7fVxuICB9KTtcbn07XG5cbi8qKlxuICogUmV0dXJucyB0aGUgQXV0aCBpbnN0YW5jZSBhc3NvY2lhdGVkIHdpdGggdGhlIHByb3ZpZGVkIHtAbGluayBAZmlyZWJhc2UvYXBwI0ZpcmViYXNlQXBwfS5cbiAqIElmIG5vIGluc3RhbmNlIGV4aXN0cywgaW5pdGlhbGl6ZXMgYW4gQXV0aCBpbnN0YW5jZSB3aXRoIHBsYXRmb3JtLXNwZWNpZmljIGRlZmF1bHQgZGVwZW5kZW5jaWVzLlxuICpcbiAqIEBwYXJhbSBhcHAgLSBUaGUgRmlyZWJhc2UgQXBwLlxuICpcbiAqIEBwdWJsaWNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEF1dGgoYXBwOiBGaXJlYmFzZUFwcCA9IGdldEFwcCgpKTogQXV0aCB7XG4gIGNvbnN0IHByb3ZpZGVyID0gX2dldFByb3ZpZGVyKGFwcCwgJ2F1dGgnKTtcblxuICBpZiAocHJvdmlkZXIuaXNJbml0aWFsaXplZCgpKSB7XG4gICAgcmV0dXJuIHByb3ZpZGVyLmdldEltbWVkaWF0ZSgpO1xuICB9XG5cbiAgY29uc3QgYXV0aCA9IGluaXRpYWxpemVBdXRoKGFwcCwge1xuICAgIHBvcHVwUmVkaXJlY3RSZXNvbHZlcjogYnJvd3NlclBvcHVwUmVkaXJlY3RSZXNvbHZlcixcbiAgICBwZXJzaXN0ZW5jZTogW1xuICAgICAgaW5kZXhlZERCTG9jYWxQZXJzaXN0ZW5jZSxcbiAgICAgIGJyb3dzZXJMb2NhbFBlcnNpc3RlbmNlLFxuICAgICAgYnJvd3NlclNlc3Npb25QZXJzaXN0ZW5jZVxuICAgIF1cbiAgfSk7XG5cbiAgY29uc3QgYXV0aFRva2VuU3luY1VybCA9IGdldEV4cGVyaW1lbnRhbFNldHRpbmcoJ2F1dGhUb2tlblN5bmNVUkwnKTtcbiAgaWYgKGF1dGhUb2tlblN5bmNVcmwpIHtcbiAgICBjb25zdCBtaW50Q29va2llID0gbWludENvb2tpZUZhY3RvcnkoYXV0aFRva2VuU3luY1VybCk7XG4gICAgYmVmb3JlQXV0aFN0YXRlQ2hhbmdlZChhdXRoLCBtaW50Q29va2llLCAoKSA9PlxuICAgICAgbWludENvb2tpZShhdXRoLmN1cnJlbnRVc2VyKVxuICAgICk7XG4gICAgb25JZFRva2VuQ2hhbmdlZChhdXRoLCB1c2VyID0+IG1pbnRDb29raWUodXNlcikpO1xuICB9XG5cbiAgY29uc3QgYXV0aEVtdWxhdG9ySG9zdCA9IGdldERlZmF1bHRFbXVsYXRvckhvc3QoJ2F1dGgnKTtcbiAgaWYgKGF1dGhFbXVsYXRvckhvc3QpIHtcbiAgICBjb25uZWN0QXV0aEVtdWxhdG9yKGF1dGgsIGBodHRwOi8vJHthdXRoRW11bGF0b3JIb3N0fWApO1xuICB9XG5cbiAgcmV0dXJuIGF1dGg7XG59XG5cbnJlZ2lzdGVyQXV0aChDbGllbnRQbGF0Zm9ybS5CUk9XU0VSKTtcbiIsICJpbXBvcnQgeyBTdG9yYWdlUmVmZXJlbmNlLCBnZXRTdG9yYWdlLCByZWYgfSBmcm9tICdmaXJlYmFzZS9zdG9yYWdlJztcclxuaW1wb3J0IHsgaW5pdGlhbGl6ZUFwcCB9IGZyb20gXCJmaXJlYmFzZS9hcHBcIjtcclxuaW1wb3J0IHsgR29vZ2xlQXV0aFByb3ZpZGVyLCBzaWduSW5XaXRoUG9wdXAsIGdldEF1dGgsIG9uQXV0aFN0YXRlQ2hhbmdlZCwgc2lnbkluV2l0aFJlZGlyZWN0fSBmcm9tICdmaXJlYmFzZS9hdXRoJztcclxuXHJcblxyXG4vL0luc2VydCB5b3VyIGZpcmViYXNlQ29uZmlnIEtleSFcclxuZXhwb3J0IGNvbnN0IGZpcmViYXNlQ29uZmlnID0ge1xyXG5cdGFwaUtleTogXCJBSXphU3lEZEFZdE9wU0FHMU1RV3FZNnpIV2JCU3ZxT0NCcWtFRHNcIixcclxuXHRhdXRoRG9tYWluOiBcImZsaW50LTRjMTBkLmZpcmViYXNlYXBwLmNvbVwiLFxyXG5cdHByb2plY3RJZDogXCJmbGludC00YzEwZFwiLFxyXG5cdHN0b3JhZ2VCdWNrZXQ6IFwiZmxpbnQtNGMxMGQuYXBwc3BvdC5jb21cIixcclxuXHRtZXNzYWdpbmdTZW5kZXJJZDogXCI4NDc0NTQwNDA1MDBcIixcclxuXHRhcHBJZDogXCIxOjg0NzQ1NDA0MDUwMDp3ZWI6ODEyOTgzNjlkZTkxZjE0M2QxYzJlMVwiXHJcbn07XHJcblxyXG5cclxuLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZVxyXG5leHBvcnQgY29uc3QgYXBwID0gaW5pdGlhbGl6ZUFwcChmaXJlYmFzZUNvbmZpZyk7XHJcbmV4cG9ydCBjb25zdCBzdG9yYWdlID0gZ2V0U3RvcmFnZSgpO1xyXG5leHBvcnQgY29uc3Qgc3RvcmFnZVJlZiA9IHJlZihzdG9yYWdlKTtcclxuXHJcbmV4cG9ydCBjb25zdCB2YXVsdFJlZjogU3RvcmFnZVJlZmVyZW5jZSA9IHJlZihzdG9yYWdlUmVmLCAndmF1bHRzJyk7XHJcblxyXG5cclxuY29uc3QgcHJvdmlkZXIgPSBuZXcgR29vZ2xlQXV0aFByb3ZpZGVyKCk7XHJcblxyXG5jb25zdCBhdXRoID0gZ2V0QXV0aChhcHApO1xyXG5cclxuXHJcbnNpZ25JbldpdGhQb3B1cChhdXRoLCBwcm92aWRlcilcclxuICAudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAvLyBUaGlzIGdpdmVzIHlvdSBhIEdvb2dsZSBBY2Nlc3MgVG9rZW4uIFlvdSBjYW4gdXNlIGl0IHRvIGFjY2VzcyB0aGUgR29vZ2xlIEFQSS5cclxuICAgIGNvbnN0IGNyZWRlbnRpYWwgPSBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21SZXN1bHQocmVzdWx0KTtcclxuXHJcblx0aWYoY3JlZGVudGlhbD8uYWNjZXNzVG9rZW4pe1xyXG5cdFx0Y29uc3QgdG9rZW4gPSBjcmVkZW50aWFsLmFjY2Vzc1Rva2VuO1xyXG5cdH1cclxuXHRcclxuICAgIC8vIFRoZSBzaWduZWQtaW4gdXNlciBpbmZvLlxyXG4gICAgY29uc3QgdXNlciA9IHJlc3VsdC51c2VyO1xyXG4gICAgLy8gSWRQIGRhdGEgYXZhaWxhYmxlIHVzaW5nIGdldEFkZGl0aW9uYWxVc2VySW5mbyhyZXN1bHQpXHJcbiAgICAvLyAuLi5cclxuICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIC8vIEhhbmRsZSBFcnJvcnMgaGVyZS5cclxuICAgIGNvbnN0IGVycm9yQ29kZSA9IGVycm9yLmNvZGU7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlO1xyXG4gICAgLy8gVGhlIGVtYWlsIG9mIHRoZSB1c2VyJ3MgYWNjb3VudCB1c2VkLlxyXG4gICAgY29uc3QgZW1haWwgPSBlcnJvci5jdXN0b21EYXRhLmVtYWlsO1xyXG4gICAgLy8gVGhlIEF1dGhDcmVkZW50aWFsIHR5cGUgdGhhdCB3YXMgdXNlZC5cclxuICAgIGNvbnN0IGNyZWRlbnRpYWwgPSBHb29nbGVBdXRoUHJvdmlkZXIuY3JlZGVudGlhbEZyb21FcnJvcihlcnJvcik7XHJcbiAgICAvLyAuLi5cclxuICB9KTsiLCAiaW1wb3J0IHsgQXBwLCAgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IEZsaW50UGx1Z2luIGZyb20gJ21haW4nO1xyXG5pbXBvcnQgeyB2YXVsdFJlZiB9IGZyb20gJ2ZpcmViYXNlLXRvb2xzJztcclxuaW1wb3J0IHsgTGlzdFJlc3VsdCwgbGlzdEFsbCB9IGZyb20gJ2ZpcmViYXNlL3N0b3JhZ2UnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBGbGludFBsdWdpblNldHRpbmdzIHtcclxuXHRyZW1vdGVDb25uZWN0ZWRWYXVsdDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogRmxpbnRQbHVnaW5TZXR0aW5ncyA9IHtcclxuXHRyZW1vdGVDb25uZWN0ZWRWYXVsdDogJ2RlZmF1bHQnXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBGbGludFNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBGbGludFBsdWdpbjtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogRmxpbnRQbHVnaW4pIHtcclxuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgI2ZldGNoVmF1bHRPcHRpb25zKCkge1xyXG5cdFx0Y29uc3QgdmF1bHRMaXN0OiBMaXN0UmVzdWx0ID0gYXdhaXQgbGlzdEFsbCh2YXVsdFJlZik7XHJcblxyXG5cdFx0bGV0IEFMTF9GSVJFQkFTRV9WQVVMVFM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHZhdWx0TGlzdC5wcmVmaXhlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRjb25zdCB2YXVsdE5hbWUgPSBgJHt2YXVsdExpc3QucHJlZml4ZXNbaV19YC5zcGxpdCgnLycpLnBvcCgpO1xyXG5cdFx0XHRpZiAodmF1bHROYW1lKSB7XHJcblx0XHRcdFx0QUxMX0ZJUkVCQVNFX1ZBVUxUU1t2YXVsdE5hbWVdID0gdmF1bHROYW1lO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gQUxMX0ZJUkVCQVNFX1ZBVUxUUztcclxuXHR9XHJcblxyXG5cdGFzeW5jIGRpc3BsYXkoKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cdFx0Y29uc3QgYWxsVmF1bHRPcHRpb25zID0gYXdhaXQgdGhpcy4jZmV0Y2hWYXVsdE9wdGlvbnMoKTtcclxuXHJcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZSgnQ3VycmVudCBDb25uZWN0ZWQgUmVtb3RlIFZhdWx0JylcclxuXHRcdFx0LnNldERlc2MoJ0FjdGl2ZSBGaXJlYmFzZSBWYXVsdCcpXHJcblxyXG5cdFx0XHQuYWRkRHJvcGRvd24ob3B0aW9ucyA9PiBvcHRpb25zXHJcblx0XHRcdFx0LmFkZE9wdGlvbnMoYWxsVmF1bHRPcHRpb25zKVxyXG5cdFx0XHRcdC5vbkNoYW5nZShhc3luYyAobmFtZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXRSZW1vdGVEZXNpbnRhdGlvbihuYW1lKTtcclxuXHRcdFx0XHR9KSk7XHJcblxyXG5cdH1cclxufVxyXG5cclxuaW1wb3J0IHsgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfRVhBTVBMRSA9IFwiZXhhbXBsZS12aWV3XCI7XHJcblxyXG5leHBvcnQgY2xhc3MgRXhhbXBsZVZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XHJcblx0Y29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZikge1xyXG5cdFx0c3VwZXIobGVhZik7XHJcblx0fVxyXG5cclxuXHRnZXRWaWV3VHlwZSgpIHtcclxuXHRcdHJldHVybiBWSUVXX1RZUEVfRVhBTVBMRTtcclxuXHR9XHJcblxyXG5cdGdldERpc3BsYXlUZXh0KCkge1xyXG5cdFx0cmV0dXJuIFwiRXhhbXBsZSB2aWV3XCI7XHJcblx0fVxyXG5cclxuXHRhc3luYyBvbk9wZW4oKSB7XHJcblx0XHQvL2NvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xyXG5cdFx0Y29uc3QgY29udGFpbmVyID0gdGhpcy5jb250YWluZXJFbC5jaGlsZHJlblsxXTtcclxuXHRcdGNvbnRhaW5lci5lbXB0eSgpO1xyXG5cdFx0Y29udGFpbmVyLmNyZWF0ZUVsKFwiaDRcIiwgeyB0ZXh0OiBcIkV4YW1wbGUgdmlld1wiIH0pO1xyXG5cdFx0Y29udGFpbmVyLmNyZWF0ZUVsKFwiYnJcIik7XHJcblx0XHRjb250YWluZXIuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIk90aGVyIHNhbXBsZSB0ZXh0XCIgfSk7XHJcblx0XHRjb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIk1vcmUgc2FtcGxlIHRleHRcIiB9KTtcclxuXHJcblx0fVxyXG5cclxuXHRhc3luYyBvbkNsb3NlKCkge1xyXG5cdFx0Ly8gTm90aGluZyB0byBjbGVhbiB1cC5cclxuXHR9XHJcbn1cclxuXHJcblxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUF1RTs7O0FHaUJ2RSxJQUFNQyxzQkFBb0IsU0FBVSxLQUFXO0FBRTdDLFFBQU0sTUFBZ0IsQ0FBQTtBQUN0QixNQUFJLElBQUk7QUFDUixXQUFTLElBQUksR0FBRyxJQUFJLElBQUksUUFBUSxLQUFLO0FBQ25DLFFBQUksSUFBSSxJQUFJLFdBQVcsQ0FBQztBQUN4QixRQUFJLElBQUksS0FBSztBQUNYLFVBQUksR0FBRyxJQUFJO0lBQ1osV0FBVSxJQUFJLE1BQU07QUFDbkIsVUFBSSxHQUFHLElBQUssS0FBSyxJQUFLO0FBQ3RCLFVBQUksR0FBRyxJQUFLLElBQUksS0FBTTtJQUN2QixZQUNFLElBQUksV0FBWSxTQUNqQixJQUFJLElBQUksSUFBSSxXQUNYLElBQUksV0FBVyxJQUFJLENBQUMsSUFBSSxXQUFZLE9BQ3JDO0FBRUEsVUFBSSxVQUFZLElBQUksU0FBVyxPQUFPLElBQUksV0FBVyxFQUFFLENBQUMsSUFBSTtBQUM1RCxVQUFJLEdBQUcsSUFBSyxLQUFLLEtBQU07QUFDdkIsVUFBSSxHQUFHLElBQU0sS0FBSyxLQUFNLEtB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OUQ7SUFBQTs7RUFBQSxHQUE4RDs7RUFHOUQ7SUFBQTs7RUFBQSxHQUFzRDtFQUN0RDtJQUFBOztFQUFBLEdBQTBFOztFQUcxRTtJQUFBOztFQUFBLEdBQXNFO0VBQ3RFO0lBQUE7O0VBQUEsR0FBdUU7RUFDdkU7SUFBQTs7RUFBQSxHQUN5Qzs7RUFHekM7SUFBQTs7RUFBQSxHQUE0RDs7RUFHNUQ7SUFBQTs7RUFBQSxHQUF5RDtFQUN6RDtJQUFBOztFQUFBLEdBQzJDO0VBRTNDO0lBQUE7O0VBQUEsR0FBOEQ7RUFDOUQ7SUFBQTs7RUFBQSxHQUE4RDs7RUFFOUQ7SUFBQTs7RUFBQSxHQUE0RDs7RUFHNUQ7SUFBQTs7RUFBQSxHQUM4QztFQUM5QztJQUFBOztFQUFBLEdBQTBEO0VBQzFEO0lBQUE7O0VBQUEsR0FBd0Q7RUFDeEQ7SUFBQTs7RUFBQSxHQUF5RDs7RUFHekQ7SUFBQTs7RUFBQSxHQUMyQzs7RUFHM0M7SUFBQTs7RUFBQSxHQUFzRDtFQUN0RDtJQUFBOztFQUFBLEdBQXNFO0VBQ3RFO0lBQUE7O0VBQUEsR0FBeUU7RUFDekU7SUFBQTs7RUFBQSxHQUFzRTtFQUN0RTtJQUFBOztFQUFBLEdBQXlEOzs7O0VBS3pEO0lBQUE7O0VBQUEsR0FDNEM7RUFDNUM7SUFBQTs7RUFBQSxHQUFvRTs7RUFHcEU7SUFBQTs7RUFBQSxHQUE0RTs7RUFHNUU7SUFBQTs7RUFBQSxHQUFzRTs7RUFHdEU7SUFBQTs7RUFBQSxHQUNtQztFQUNuQztJQUFBOztFQUFBLEdBQXdFO0VBQ3hFO0lBQUE7O0VBQUEsR0FBdUU7RUFDdkU7SUFBQTs7RUFBQSxHQUNtQztFQUNuQztJQUFBOztFQUFBLEdBQzhDO0VBQzlDO0lBQUE7O0VBQUEsR0FDNEM7O0VBRzVDO0lBQUE7O0VBQUEsR0FBNEU7O0VBRzVFO0lBQUE7O0VBQUEsR0FBd0U7RUFDeEU7SUFBQTs7RUFBQSxHQUE0RTtFQUM1RTtJQUFBOztFQUFBLEdBQTRFO0VBQzVFO0lBQUE7O0VBQUEsR0FDd0M7RUFDeEM7SUFBQTs7RUFBQSxHQUFvRTtFQUNwRTtJQUFBOztF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QkFBNEIsTUFBTSxvQkFBb0I7QUFFNUQsUUFBSSwwQkFBMEIsVUFBVSxHQUFHO0FBQzFDLFVBQUksd0JBQU8sbUJBQW1CO0FBQUEsSUFDL0I7QUFDQSxXQUFPLDBCQUEwQjtBQUFBLE1BQU8sQ0FBQyxVQUN4QyxNQUFNLE1BQU0sWUFBWSxFQUFFLFNBQVMsTUFBTSxZQUFZLENBQUM7QUFBQSxJQUN2RDtBQUFBLEVBQ0Q7QUFBQTtBQUFBLEVBR0EsaUJBQWlCLE9BQXNCLElBQWlCO0FBQ3ZELE9BQUcsU0FBUyxPQUFPLEVBQUUsTUFBTSxNQUFNLE1BQU0sQ0FBQztBQUN4QyxPQUFHLFNBQVMsU0FBUyxFQUFFLE1BQU0sTUFBTSxJQUFJLENBQUM7QUFBQSxFQUN6QztBQUFBO0FBQUEsRUFHQSxNQUFNLG1CQUFtQixPQUFzQixLQUFpQztBQUMvRSxRQUFJLHdCQUFPLFlBQVksTUFBTSxPQUFPO0FBR3BDLHNCQUFrQixNQUFNO0FBRXhCLFNBQUssT0FBTyxxQkFBcUIsTUFBTSxLQUFLO0FBQUEsRUFHN0M7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgInN0cmluZ1RvQnl0ZUFycmF5IiwgIm5hbWUiLCAicXVlcnlzdHJpbmciLCAibmFtZSIsICJwcm92aWRlciIsICJMb2dMZXZlbCIsICJuYW1lIiwgIm5hbWUiLCAidmVyc2lvbiIsICJ0YXJnZXQiLCAicHJvdmlkZXIiLCAiREVGQVVMVF9FTlRSWV9OQU1FIiwgImFwcE5hbWUiLCAiYXBwQ29tcGF0TmFtZSIsICJhbmFseXRpY3NOYW1lIiwgImFuYWx5dGljc0NvbXBhdE5hbWUiLCAiYXBwQ2hlY2tOYW1lIiwgImFwcENoZWNrQ29tcGF0TmFtZSIsICJhdXRoTmFtZSIsICJhdXRoQ29tcGF0TmFtZSIsICJkYXRhYmFzZU5hbWUiLCAiZGF0YWJhc2VDb21wYXROYW1lIiwgImZ1bmN0aW9uc05hbWUiLCAiZnVuY3Rpb25zQ29tcGF0TmFtZSIsICJpbnN0YWxsYXRpb25zTmFtZSIsICJpbnN0YWxsYXRpb25zQ29tcGF0TmFtZSIsICJtZXNzYWdpbmdOYW1lIiwgIm1lc3NhZ2luZ0NvbXBhdE5hbWUiLCAicGVyZm9ybWFuY2VOYW1lIiwgInBlcmZvcm1hbmNlQ29tcGF0TmFtZSIsICJyZW1vdGVDb25maWdOYW1lIiwgInJlbW90ZUNvbmZpZ0NvbXBhdE5hbWUiLCAic3RvcmFnZU5hbWUiLCAic3RvcmFnZUNvbXBhdE5hbWUiLCAiZmlyZXN0b3JlTmFtZSIsICJmaXJlc3RvcmVDb21wYXROYW1lIiwgInBhY2thZ2VOYW1lIiwgImFwcCIsICJhcHAiLCAibmFtZSIsICJuYW1lIiwgIkRFRkFVTFRfRU5UUllfTkFNRSIsICJhcHAiLCAidmVyc2lvbiIsICJhcHAiLCAibmFtZSIsICJ2ZXJzaW9uIiwgIlN0b3JhZ2VFcnJvckNvZGUiLCAibmFtZSIsICJ2ZXJzaW9uIiwgImNhbmNlbGVkIiwgInN0b3AiLCAiRXJyb3JDb2RlIiwgImdldEJsb2IiLCAiQmxvYkJ1aWxkZXIiLCAic3RhcnQiLCAiZ2V0TWV0YWRhdGEiLCAibGlzdCIsICJkZWxldGVPYmplY3QiLCAidXJsIiwgInJlZiIsICJnZXRNZXRhZGF0YSIsICJmYnNBc3luYyIsICJuYW1lIiwgInVwbG9hZEJ5dGVzUmVzdW1hYmxlIiwgInJlZiIsICJsaXN0QWxsIiwgInJlZiIsICJsaXN0IiwgInJlcXVlc3RzTGlzdCIsICJnZXREb3dubG9hZFVSTCIsICJyZWYiLCAicmVxdWVzdHNHZXREb3dubG9hZFVybCIsICJkZWxldGVPYmplY3QiLCAicmVxdWVzdHNEZWxldGVPYmplY3QiLCAiX2dldENoaWxkIiwgImNvbm5lY3RTdG9yYWdlRW11bGF0b3IiLCAic3RvcmFnZSIsICJhcHAiLCAiYXV0aCIsICJyZWYiLCAidXBsb2FkQnl0ZXNSZXN1bWFibGVJbnRlcm5hbCIsICJyZWYiLCAibGlzdEFsbEludGVybmFsIiwgImdldERvd25sb2FkVVJMSW50ZXJuYWwiLCAiZGVsZXRlT2JqZWN0SW50ZXJuYWwiLCAicmVmSW50ZXJuYWwiLCAiYXBwIiwgInN0b3JhZ2UiLCAiY29ubmVjdEVtdWxhdG9ySW50ZXJuYWwiLCAiYXBwIiwgIm5hbWUiLCAidmVyc2lvbiIsICJuYW1lIiwgInZlcnNpb24iLCAiYXV0aCIsICJmYWN0b3J5IiwgImF1dGgiLCAiYXV0aCIsICJwcm92aWRlciIsICJyZWxvYWQiLCAibmFtZSIsICJhdXRoIiwgImF1dGgiLCAianNIZWxwZXJzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5fbG9hZEpTIiwgImFwcCIsICJwcm92aWRlciIsICJhdXRoIiwgImF1dGgiLCAic2lnbkluV2l0aEVtYWlsTGluayIsICJhdXRoIiwgIklEUF9SRVFVRVNUX1VSSSIsICJzaWduSW5XaXRoUGhvbmVOdW1iZXIiLCAibGlua1dpdGhQaG9uZU51bWJlciIsICJhdXRoIiwgImF1dGgiLCAiX2xpbmsiLCAiYXV0aCIsICJhdXRoIiwgImF1dGgiLCAiX1BPTExJTkdfSU5URVJWQUxfTVMiLCAia2V5IiwgInN0b3JlZFZhbHVlIiwgIkRCX05BTUUiLCAiREJfVkVSU0lPTiIsICJhdXRoIiwgImpzSGVscGVycy5fZ2VuZXJhdGVDYWxsYmFja05hbWUiLCAiYXV0aCIsICJhdXRoIiwgIl9saW5rVXNlciIsICJwcm92aWRlciIsICJhdXRoIiwgInByb3ZpZGVyIiwgImF1dGgiLCAiYXV0aCIsICJhdXRoIiwgImpzLl9nZW5lcmF0ZUNhbGxiYWNrTmFtZSIsICJqc1xyXG4gICAgICAgICAgICAgICAgLl9sb2FkSlMiLCAiZ2FwaUxvYWRlci5fbG9hZEdhcGkiLCAiZ2FwaSIsICJ3aW5kb3ciLCAibmFtZSIsICJwcm92aWRlciIsICJwcm9taXNlIiwgImFwcCIsICJ2ZXJzaW9uIiwgInJlbW90ZVZhdWx0TmFtZSIsICJyZXR1cm5lZEZpbGUiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJhcHAiLCAibmFtZSIsICJhcHAiXQp9Cg==
